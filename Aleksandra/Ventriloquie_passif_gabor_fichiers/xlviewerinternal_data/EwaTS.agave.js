'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1027:function(z,t,a){a.d(t,"a",function(){return b});z=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(z.a)(c,"AddInDataTransferObject",null,[]);class b{constructor(h,r,e){this.pcc=h;this.Qgh=r;this.Rgh=e}get fC(){return this.pcc}get wyh(){return this.Qgh}get xyh(){return this.Rgh}static wQb(h){return(h=h.b7)?Object.assign(new c,{tabs:h.fC.toArray(),id:h.wyh,title:h.xyh}):null}}Object(z.a)(b,
"OneLineRibbonExtensibility",null,[])},1048:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.Vsl=1]="notReady";b[b.Dul=2]="storeDisabled";b[b.Bml=3]="invokeFailure";b[b.jul=4]="serviceDisabled";b[b.Jkl=5]="builtinAddinDetails"})(c||(c={}));Object(z.b)("AddinDetailsQueryError",c)},1050:function(z,t,a){a.d(t,"a",function(){return c});a.d(t,"b",function(){return b});const c=h=>{let r=null;switch(h){case 0:r="omex";break;case 1:r="spcatalog";break;case 2:r=
"spapp";break;case 3:r="filesystem";break;case 4:r="exchange";break;case 6:r="registry";break;case 7:r="inmemory";break;case 8:r="uploadfiledevcatalog";break;case 9:r="hardcodedpreinstall";break;case 10:r="excatalog";break;case 16:r="wopicatalog"}return r},b=h=>{let r=-1;switch(h.toLowerCase()){case "omex":r=0;break;case "spcatalog":r=1;break;case "spapp":r=2;break;case "filesystem":r=3;break;case "exchange":r=4;break;case "registry":r=6;break;case "inmemory":r=7;break;case "uploadfiledevcatalog":r=
8;break;case "hardcodedpreinstall":r=9;break;case "excatalog":r=10;break;case "wopicatalog":r=16}return r}},1051:function(z,t,a){a.d(t,"a",function(){return h});var c=a(6),b=a(60);const h=(r,e)=>b.a.n2d(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,c.AFrameworkApplication.fa.Lj("MaxRetriesForLoadingScript",0),r,e)},1111:function(z,t,a){t=a(483);a=a(1452);a=a.Mw?a.default:a;"string"===typeof a&&(a=[[z.i,a,""]]);t(a,{insert:"head",bD:!1});z.exports=a.FH||{}},1112:function(z,t,a){a.d(t,
"a",function(){return c});z=a(0);var c;(function(b){b[b.DIj=0]="myAddins";b[b.fGh=1]="adminManaged";b[b.Atl=2]="popular"})(c||(c={}));Object(z.b)("AddinCollectionType",c)},1113:function(z,t,a){a.d(t,"a",function(){return b});z=a(0);var c=a(12);class b{constructor(){this.Lxf={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.Ixf={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ia(1633),c.a.instance.ia(1637)],
["tabformulas"]:["Ribbon.Formulas",c.a.instance.ia(1634),c.a.instance.ia(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ia(1635),c.a.instance.ia(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ia(1636),c.a.instance.ia(1640)]};this.$wc=null}get fva(){return"SourceControlId"}get kY(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}OPi(){if(!this.$wc){this.$wc={};for(const h of Object.keys(this.Lxf))this.$wc[h]=this.Lxf[h];for(const h of Object.keys(this.Ixf))this.$wc[h]=this.Ixf[h][0]}}}
Object(z.a)(b,"AddinCommandsStringProvider",null,[899])},1115:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{constructor(){this.i0a=0;this.Fua=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.TDc=!1;this.ITf=this.Gva=null}}Object(z.a)(c,"AddInCommandsNotificationParameters",null,[])},1117:function(z,t,a){a.d(t,"a",function(){return c});const c=b=>b.la.lh(34)},1161:function(z,t,a){a.d(t,"a",function(){return R});z=a(0);var c=a(42),b=a(15),h=a(142),r=a(169),
e=a(17),k=a(482),m=a(22);class x extends Sys.UI.Control{constructor(J,aa,S,C){super(document.createElement("div"));this.U2=this.S2=this.sF=this.dSa=this.MQ=this.oDa=this.REa=null;this.QCb=this.bEa=!1;this.content=this.gy=null;this.gda=0;this.F$e=null;this.f4=0;this.Kqg=null;this.EX=()=>{this.dismiss();return!0};this.BZe=J;this.AUe=aa;this.k_=S;this.mK=C;this.en=aa.ownerDocument;this.tDc=this.BC=this.kDb=!1}get e7(){this.REa||(this.REa=this.en.createElement("div"),this.REa.id=this.hp("WACCalloutOuter"),
this.REa.className="WACCalloutOuter",this.REa.setAttribute(k.a.hk,k.a.DVa),this.REa.style.width=this.gda+"px");return this.REa}get rJb(){if(!this.oDa){this.oDa=this.en.createElement("div");this.oDa.id=this.hp("WACCalloutBeakContainer");this.oDa.className="WACCalloutBeakContainer";var J="CalloutBeakTopFilled_32x16x32";if(5===this.f4||6===this.f4||4===this.f4)J="CalloutBeakBottomFilled_32x16x32";J=r.a(32,16,J,"WACCalloutBeak",!0,"");this.oDa.appendChild(J)}return this.oDa}set rJb(J){this.oDa=J}get e1a(){return this.kDb}get title(){return this.gy}set title(J){this.gy!==
J&&(this.gy=J,this.S2&&(this.S2.innerText=this.gy))}get BC(){return this.bEa}set BC(J){this.bEa!==J&&(this.bEa=J,this.MQ&&(this.MQ.contains(this.sF)&&!this.bEa?this.MQ.removeChild(this.sF):!this.MQ.contains(this.sF)&&this.bEa&&this.Z1e()))}get tDc(){return this.QCb}set tDc(J){this.QCb!==J&&(this.QCb=J,this.MQ&&(this.MQ.contains(this.S2)&&!this.QCb?this.MQ.removeChild(this.S2):!this.MQ.contains(this.S2)&&this.QCb&&this.t3e()))}show(){this.kDb||(this.M5h(),this.Cu(),this.AUe.appendChild(this.e7),this.e7.style.display=
"Block",this.EGk(),this.kDb=!0,this.Kqg&&this.Kqg())}dismiss(){this.kDb&&(this.yfa(),this.AUe.removeChild(this.e7),this.kDb=!1,this.mK&&this.mK())}dispose(){this.dismiss();this.S2=this.sF=this.dSa=this.oDa=this.MQ=this.REa=null;Sys.Component.prototype.dispose.call(this)}hp(J){return this.get_element().id+J}M5h(){this.MQ=this.en.createElement("div");this.MQ.id=this.hp("WACCalloutHeader");this.MQ.className="WACCalloutHeader";this.BC&&this.Z1e();this.tDc&&this.t3e();this.dSa=this.en.createElement("div");
this.dSa.id=this.hp("WACCalloutContent");this.dSa.className="WACCalloutContent";this.dSa.style.width=190<this.gda?this.gda-26+"px":"164px";this.dSa.appendChild(this.content);this.e7.appendChild(this.rJb);this.e7.appendChild(this.MQ);this.e7.appendChild(this.dSa)}Z1e(){this.sF=this.en.createElement("a");this.sF.className="WACCalloutCloseAnchor";this.sF.id=this.hp("WACCalloutCloseAnchor");this.sF.href="#";this.MQ.appendChild(this.sF);const J=r.a(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,Object(m.a)("DialogClose"));this.sF.appendChild(J)}t3e(){this.S2=this.en.createElement("div");this.S2.className="WACCalloutTitle UIFontBold";this.S2.style.width=190<this.gda?this.gda-30+"px":"160px";this.S2.id=this.hp("WACCalloutTitle");this.S2.innerText=this.title;this.MQ.contains(this.sF)?this.MQ.insertBefore(this.S2,this.sF):this.MQ.appendChild(this.S2)}EGk(){var J=this.BZe;let aa;if(1===this.f4){var S=this.F$e.y+16;aa=-16}else 2===this.f4||3===this.f4||0===this.f4?(S=J.y+J.height+15,aa=-15):
(S=J.y-this.e7.clientHeight-15-2,aa=this.e7.clientHeight-1);this.e7.style.top=S+"px";this.rJb.style.top=aa+"px";1===this.f4?(J=this.F$e.x-16,this.e7.style.left="50%",this.e7.style.marginLeft=-this.gda/2+"px",S=Sys.UI.DomElement.getBounds(this.e7),this.rJb.style.left=J-S.x+"px"):(S=J.x+this.BZe.width/2,2===this.f4||5===this.f4?(J=20,S-=36):0===this.f4||4===this.f4?(J=this.gda/2-16,S-=this.gda/2):(J=this.gda-20-32,S=S-this.gda+36),this.e7.style.left=S+"px",this.rJb.style.left=J+"px")}Cu(){this.BC&&
!this.U2&&(this.U2=this.EX,this.k_.xa(e.a.click,this.sF,this.U2,null))}yfa(){this.BC&&this.U2&&(this.k_.Qa(e.a.click,this.sF,this.U2),this.U2=null)}}Object(z.a)(x,"Callout",Sys.UI.Control,[565]);class n extends x{constructor(J,aa,S,C,L,V){super(J,S,L.u8,void 0===V?null:V);this.DSe=0;this.vj=()=>{this.dismiss();return!0};this.gda=this.WPi(C);this.wdb=aa;this.Km=L;this.OZk=7;this.At=this.wdb.ownerDocument.createElement("div");this.At.className="ModalCalloutControlOverlay";this.At.tabIndex=0;this.wdb.insertBefore(this.At,
this.wdb.firstChild)}show(){this.e1a||(this.Km.$Rc(),this.Km.K_(!1),this.At.style.zIndex=String(this.Km.kea),super.show(),this.Hp(),this.DSe=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.OZk))}dismiss(){this.e1a&&(this.Km.OX(!1),this.to(),this.wdb&&this.wdb.contains(this.At)&&this.wdb.removeChild(this.At),super.dismiss(),window.clearTimeout(this.DSe))}Hp(){this.Km.XFa(Object(h.a)(this,this.dismiss,"dismiss"));this.Km.CJ.xa(e.a.click,this.At,this.vj)}to(){this.Km.Zub(Object(h.a)(this,
this.dismiss,"dismiss"));this.Km.CJ.Qa(e.a.click,this.At,this.vj)}WPi(J){let aa=0;switch(J){case 0:aa=190;break;case 1:aa=250;break;case 2:aa=300;break;case 3:aa=360}return aa}}Object(z.a)(n,"ModalCallout",x,[]);var u=a(533),v=a(182);class w extends n{constructor(J,aa,S,C,L,V){super(J,aa,S,C,L,void 0===V?null:V);this.mhc=null}show(){if(!this.e1a){const J=Object.assign(new u.a,{onShow:()=>{n.prototype.show.call(this)}});v.a.VI().then(aa=>{const S=aa.externalNotification();this.mhc=aa.addNotification(S,
J);return null},aa=>{b.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",aa);return null})}}dismiss(){this.e1a&&this.mhc&&(v.a.VI().then(J=>{J.removeNotification(this.mhc);return this.mhc=null},J=>{b.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null}),super.dismiss())}}Object(z.a)(w,"ReactManagedModalCallout",n,[]);var l=a(6);class y{static z7h(J,aa,S){var C=void 0===C?null:C;return l.AFrameworkApplication.ra.$g.xY?new w(J,aa,S,3,
l.AFrameworkApplication.ra,C):new n(J,aa,S,3,l.AFrameworkApplication.ra,C)}}Object(z.a)(y,"ModalCalloutControlFactory",null,[]);var B=a(84),A=a(1046),E=a(676),N=a(1047),D=a(188),U=a(68),K=a(59),M=a(1027),O=a(910);class R{static get jfb(){return R.T8||(R.T8=c.a.instance.Ho("Common.Utils.IAriaNotifier"))}static fkf(J,aa,S,C){R.KT&&R.KT.e1a&&R.KT.dismiss();R.KT=y.z7h(aa,J,J);R.KT.content=S;O.b(C)||(R.KT.title=C,R.KT.tDc=!0);J=new Sys.UI.Bounds(0,0,U.a.ySb(),U.a.xSb());R.KT.f4=R.sGi(J,aa,R.KT.gda);R.KT.show();
R.jfb&&R.jfb.fBa(S.innerText,!0)}static xyd(J,aa,S,C){C=void 0===C?null:C;v.a.VI().then(L=>{let V=null;R.kFb&&(L.removeNotification(R.kFb),R.kFb=null);const X=L.callout(Object.assign(new A.a,{target:J,title:aa,content:S,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new N.a,{onDismiss:()=>{L.removeNotification(V)},directionalHint:null!=C?C:null})})),la=Object.assign(new u.a,{expirationOptions:Object.assign(new E.a,{displayTimeoutSeconds:7,onExpire:()=>
{L.removeNotification(R.kFb)}})});V=R.kFb=L.addNotification(X,la);return null},L=>{b.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null})}static Ise(J,aa){aa=void 0===aa?null:aa;R.KT&&R.KT.e1a&&R.KT.dismiss();const S=new D.a;S.RPa=!1;S.Ph=0;S.cE(B.a.jvj,Object(m.a)("DialogError"),O.b(J)?R.XFf():J,aa)}static Jse(J){R.KT&&R.KT.e1a&&R.KT.dismiss();b.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",J.errorCode));const aa=
O.b(J.description)?R.XFf():J.description,S=new D.a;let C=null;J.Fua?(S.Ph=1,S.ri(1,J.buttonText),S.Oia(1)):S.Ph=0;C=L=>{1===L?J.Fua():J.Gva&&J.Gva()};S.RPa=!1;0===J.i0a?S.cE(J.errorCode,J.title?J.title:Object(m.a)("DialogError"),aa,C):1===J.i0a?S.iW(J.title?J.title:Object(m.a)("DialogWarning"),aa,C):S.HBa(J.title?J.title:Object(m.a)("DialogInfo"),aa,C)}static sGi(J,aa,S){let C=4;const L=J.x+J.width-aa.x-aa.width;aa.x-J.x+aa.width/2<=S/2?C=5:L+aa.width/2<=S/2&&(C=6);return C}static XNk(J,aa,S,C){C=
void 0===C?!1:C;(aa=M.a.wQb(aa))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(aa,L=>{L&&(C||R.xyd(L,S,J,5))})}static YNk(J,aa,S){S=void 0===S?!1:S;R.XNk(aa.startedNode?aa.startedNode.description:String.format(Object(m.a)("NewAddInLoadedContent"),J),aa,aa.startedNode?aa.startedNode.title:String.format(Object(m.a)("NewAddInLoadedTitle"),J),S)}static WNk(J,aa,S,C){if(R.S7g)J=String.format(Object(m.a)("ErrorLoadingAddInsContentOuterString"),
String.format(Object(m.a)("ErrorLoadingAddInsContentInnerString"),S,C,Object(m.a)("InsertionDialogRefresh"))),R.xyd(aa,Object(m.a)("ErrorLoadingAddInsTitle"),J,1);else{aa=K.a.Qv(aa);var L=Object(m.a)("ErrorLoadingAddInsContentOuterString").split("{0}"),V=document.createElement("span");V.innerText=L[0];var X=document.createElement("span");X.innerText=String.format(Object(m.a)("ErrorLoadingAddInsContentInnerString"),S,C,Object(m.a)("InsertionDialogRefresh"));X.className="UIFontBold";S=document.createElement("span");
S.innerText=L[1];C=document.createElement("div");Sys.UI.DomElement.addCssClass(C,"ModalCalloutControl");C.appendChild(V);C.appendChild(X);C.appendChild(S);R.fkf(J,aa,C,Object(m.a)("ErrorLoadingAddInsTitle"))}}static CPk(J,aa,S,C){R.S7g?R.xyd(aa,S,C):(aa=K.a.Qv(aa),R.fkf(J,aa,R.vQh(C),S))}static vQh(J){const aa=document.createElement("div");Sys.UI.DomElement.addCssClass(aa,"ModalCalloutControl");aa.innerText=J;return aa}static XFf(){return Object(m.a)("InternalError")+" "+Object(m.a)("InternalError_Directive")}static get S7g(){return l.AFrameworkApplication.ra.$g.Oq&&
l.AFrameworkApplication.ra.$g.xY}}R.KT=null;R.kFb=null;R.T8=null;Object(z.a)(R,"AddInCommandsNotificationFactory",null,[])},1163:function(z,t,a){a.r(t);a.d(t,"DynamicRibbon",function(){return l});z=a(0);var c=a(15),b=a(181),h=a(126),r=a(928),e=a(949);class k{constructor(){this.dataFields=this.samplingPolicy=this.name=null}}Object(z.a)(k,"TelemetryEvent",null,[]);class m{constructor(y,B,A,E){this.Sz=!1;this._id=y;this.IG=B;this.uda=A;this.Kj=E}get enabled(){return this.Sz}set enabled(y){const {DynamicRibbon:B}=
a(1163);var A=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;const E=this.Kj.PrimaryMarketplace.MarketplaceRef,N=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null,D=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,A,null,null,null,E);A={["addinSolutionId"]:D,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,A,N,null,null,E),["ownerAddinStoreType"]:A,["ribbonControlType"]:"Button",
["toggle"]:y};b.a.sendTelemetryEvent(Object.assign(new k,{name:B.X0c+"ControlUpdate",dataFields:h.a.Pm(A)}));this.Sz=y;this.uda.TU(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.IG,["PrivacyCompliantSolutionId"]:D,["SourceControlId"]:this.id,["MethodData"]:this.Sz})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(y){switch(y){case 3:return this.enabled;case 2:return this.id;
case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertyGetAsync(y){y=this.invokePropertyGet(y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}invokePropertySet(y,B){switch(y){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertySetAsync(y,B){this.invokePropertySet(y,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(y,
B){switch(y){case 5:return this.dDk(B);case 1:return this.vRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokeMethodAsync(y,B){y=this.invokeMethod(y,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}dDk(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");this.setEnabled(y);return null}vRa(){this._OnAccess();return null}}Object(z.a)(m,"RibbonButton",null,[]);class x{constructor(y,B,A,E){this._id=y;this.IG=B;this.uda=A;
this.Kj=E}get id(){return this._id}setVisibility(y){const {DynamicRibbon:B}=a(1163),A=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;var E=this.Kj.PrimaryMarketplace.MarketplaceRef;const N=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null,D=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,A,N,null,null,E);E={["addinSolutionId"]:D,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,
A,N,null,null,E),["ownerAddinStoreType"]:A,["ribbonControlType"]:"Tab",["toggle"]:y};b.a.sendTelemetryEvent(Object.assign(new k,{name:B.X0c+"ControlUpdate",dataFields:h.a.Pm(E)}));this.uda.TU(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.IG,["PrivacyCompliantSolutionId"]:D,["StoreType"]:A,["SourceControlId"]:this.id,["MethodData"]:y})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(y){switch(y){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);
}invokePropertyGetAsync(y){y=this.invokePropertyGet(y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}invokePropertySet(y){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertySetAsync(y,B){this.invokePropertySet(y,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(y,B){switch(y){case 3:return this.nHk(B);case 1:return this.vRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokeMethodAsync(y,
B){y=this.invokeMethod(y,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}nHk(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");this.setVisibility(y);return null}vRa(){this._OnAccess();return null}}Object(z.a)(x,"RibbonTab",null,[]);var n=a(1262),u=a(177),v=a(1576),w;(function(y){y[y.static=0]="static";y[y.dynamic=1]="dynamic"})(w||(w={}));Object(z.b)("RibbonExtensionGenerateType",w);class l{constructor(y,B,A,E,N){this.IG=y;this.zx=A;this.uda=E;this.Kj=
N;this.rBb=this.zx.Dl;this.nI=this.rBb.getOsfControl(B);this.mph=this.nI.getManifest()}get buttons(){return null}executeRequestCreate(y){try{var B=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;const E=this.Kj.PrimaryMarketplace.MarketplaceRef,N=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null;var A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,B,N,null,null,E);const D={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,
B,N,null,null,E),["ownerAddinStoreType"]:this.Kj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new k,{name:l.X0c+"ExecuteRequestCreate",dataFields:h.a.Pm(D)}));const U=u.a.Rp(y);y={};B={};B[r.a.lYa]=this.nI;B[r.a.mYa]=U;B[r.a.QCd]=this.Kj;y[r.a.oOb]=3;y[r.a.Gfa]=this.IG;y[r.a.Ivc]=A;y[r.a.Ffa]=B;this.uda.TU(-1014260128,y);let K=l.bzc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,K)}catch(E){A=l.bzc("ExecuteRequestCreate",!1,E.toString()),
c.ULS.sendTraceTag(538572825,0,50,A)}return null}executeRequestUpdate(y){try{var B=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;const E=this.Kj.PrimaryMarketplace.MarketplaceRef,N=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null;var A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,B,N,null,null,E);const D={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,
B,N,null,null,E),["ownerAddinStoreType"]:this.Kj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new k,{name:l.X0c+"ExecuteRequestUpdate",dataFields:h.a.Pm(D)}));const U=u.a.Rp(y);y={};B={};B[r.a.lYa]=this.nI;B[r.a.mYa]=U;B[r.a.QCd]=this.Kj;y[r.a.oOb]=3;y[r.a.Gfa]=this.IG;y[r.a.Ivc]=A;y[r.a.Ffa]=B;this.uda.TU(-1014260128,y);let K=l.bzc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,K)}catch(E){A=l.bzc("ExecuteRequestUpdate",!1,E.toString()),
c.ULS.sendTraceTag(538572823,0,50,A)}return null}getButton(y){let B=null;if(!this.MYf())return this.ikf();if(y&&0<y.length){if(!this.$ef(y))return this.Akf(y);B=new m(y,this.IG,this.uda,this.Kj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}getTab(y){let B=null;if(!this.MYf())return this.ikf();if(this.nI.getOwnerAddinControlRecreated())return this.K6h();if(y&&0<y.length){if(!this.$ef(y))return this.Akf(y);B=new x(y,this.IG,this.uda,this.Kj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(y){switch(y){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);
}invokePropertyGetAsync(y){y=this.invokePropertyGet(y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}invokePropertySet(y){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertySetAsync(y,B){this.invokePropertySet(y,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(y){switch(y){case 1:return this.vRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokeMethodAsync(y,B){switch(y){case 7:return this.fti(B);
case 6:return this.gti(B);case 3:return this.VFi(B);case 5:return this.TXi(B)}y=this.invokeMethod(y,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}fti(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.executeRequestCreate(y)}gti(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.executeRequestUpdate(y)}VFi(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.getButton(y)}TXi(y){y=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.getTab(y)}vRa(){this._OnAccess();return null}Akf(y){return n.a(e.a.$1h,u.a.ia(1771)+y)}ikf(){return n.a(e.a.Wtk,u.a.ia(1767))}K6h(){return n.a(e.a.hostRestartNeeded,u.a.ia(1772))}MYf(){var y=this.nI.getSharedRuntimeId();y=!!y&&0<y.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",y));return y}$ef(y){const B=this.mph.getRibbonExtensionControlMap();return y in
B||this.ZVh(y)}ZVh(y){var B=this.Kwi();if(B){B=B.Trf;for(const A of B.tabs){if(A.id===y)return!0;for(const E of A.groups)for(const N of E.controls){if(N.id===y)return!0;if("Menu"===N.type){B=N;for(const D of B.items)if(D.id===y)return!0}}}}return!1}Kwi(){return v.a.getInstance().mwa(this.Kj.PrimaryMarketplace.MarketplaceType,this.Kj.PrimaryMarketplace.SolutionId,w.dynamic)}static bzc(y,B,A){const E={};E.methodName="DynamicRibbon."+y;E.result=B?"Succeeded":"Failed";E.message=A;return u.a.Ci(E)}}l.X0c=
"Office.Online.Extensibility.Ribbon.";Object(z.a)(l,"DynamicRibbon",null,[])},1252:function(z,t,a){a.d(t,"a",function(){return c});const c=(b,h)=>{let r=!1;b&&(b=h.osfControl,(h=b.getManifest())&&h.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(r=!0));return r}},1258:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.nua=this.sQa=this.YLd=this.vSb=this.fKa=this.xwe=null}}Object(z.a)(c,"AppsForOfficeOauthResult",
null,[])},1259:function(z,t,a){a.r(t);a.d(t,"WebExtensionView",function(){return E});z=a(0);var c=a(94),b=a(153);t=a(376);var h=a(29),r=a(19),e=a(274),k=a(55),m=a(287),x=a(1117),n=a(461),u=a(73),v=a(63),w=a(16),l=a(69),y=a(95),B=a(5),A=a(1111);a.n(A);Object(y.b)(B.Ug,{Ek:"singleton"})(N=>Lo(function*(){const D=yield y.a.resolve(B.Nb,N);return new E(D,new n.FloatingObjectBlockManager(D,D.ea,D.pa.$G,3,0),D.Cl.appendChild(D.Cl.ownerDocument.createElement("div")))}));class E extends t.a{constructor(N,
D,U){super(U,N);this.iKa=this.hashCode=null;this.Prc=!1;this.lx=(K,M)=>{M.mj.hash===this.hashCode&&this.iKa&&(B.xb.Aa()?y.a.nh(B.xb):Object(b.a)(a(939).DdaFacade,this.$.la.lh(35))).$Ok(this.iKa.InstanceId)};this.onBlockCacheItemChanged=(K,M)=>{switch(M.mj.block.state){case 1:case 3:case 5:this.rBa(M)}};this.vp=()=>{this.SSc(!0)};this.onActiveItemChanging=(K,M)=>{this.isVisible&&this.R9a(M.IB);this.clearCache()};this.onActiveItemChanged=(K,M)=>{this.dYg(M.ma,!!M.IB)};this.mJ=()=>{this.$.ea.uNa()};
this.x$a=D;this.domElement.classList.add(h.yb);this.domElement.classList.add(r.a.oH);U.tabIndex=0;this.dYg(this.$.ma,!1);this.oj.Ba("mousedown",this.mJ);this.oj.Ba("contextmenu",K=>{l.g(K)});this.$.sa.mX(this.onActiveItemChanging);this.$.Yh.mX(this.onActiveItemChanging);this.$.Yh.pn(this.onActiveItemChanged);this.$.sa.pn(this.onActiveItemChanged);this.za.kz(this.onBlockCacheItemChanged);this.za.aU(this.lx);this.za.iy(this.vp);this.aA(this.Urb)}get za(){return this.x$a}dispose(){this.$&&(this.$.sa.W1(this.onActiveItemChanging),
this.$.Yh.W1(this.onActiveItemChanging),this.$.Yh.Gn(this.onActiveItemChanged),this.$.sa.Gn(this.onActiveItemChanged));this.x$a&&(this.x$a.Vy(this.onBlockCacheItemChanged),this.x$a.MV(this.lx),this.x$a.px(this.vp));this.$E(this.Urb);this.clearCache();c.a.dh(this.x$a);this.x$a=null;w.DOMElementExtensions.$m(this.domElement);super.dispose()}zOg(N){w.DOMElementExtensions.$m(w.DOMElementExtensions.getElementById(this.domElement,N.id));this.domElement.appendChild(N)}yUb(){if(this.iKa&&!this.Prc){var N=
(B.xb.Aa()?y.a.nh(B.xb):Object(b.a)(a(939).DdaFacade,m.a(this.$))).es(this.iKa.InstanceId);N&&(N.resize(this.iKa.Width,this.iKa.Height),N.Ba(this.domElement),N.showHide(!0),this.Prc=!0)}}PXb(){return!0}rBa(N){this.iKa=N.mj.block.Pj;this.Prc=!1;this.yUb()}R9a(N){this.$.ea.c6&&N&&(N.VA||(N.VA=new e.a),N.VA.xn=new k.a(this.domElement.scrollLeft,this.domElement.scrollTop),N.VA.H2b=20)}clearCache(){this.za.Pub(this.hashCode,"ClearCacheWebExtensionView");this.iKa=this.hashCode=null;this.Prc=!1}dYg(N,D){if(this.isVisible=
!!N&&u.n(N))this.hashCode=this.za.QFa(N,v.a.SAd,this.hashCode,!1),this.GYc(D)}static iJb(N){if(!x.a(N)){const D=N.Cl;N.la.Hh(34,new E(N,new n.FloatingObjectBlockManager(N,N.ea,N.pa.$G,3,0),D.appendChild(D.ownerDocument.createElement("div"))))}}}Object(z.a)(E,"WebExtensionView",t.a,[846,4,2]);String(A);window.___1710439874574_closurehack=A},1262:function(z,t,a){a.d(t,"a",function(){return c});const c=(b,h)=>OfficeExtension.WacRuntime.Utility.createPromise((r,e)=>{e(OfficeExtension.WacRuntime.Utility.createRichApiException(b,
h))})},1377:function(z,t,a){a.r(t);a.d(t,"CustomFunctionsInstaller",function(){return Xa});z=a(0);var c=a(2),b=a(15),h=a(6),r=a(183),e=a(210),k=a(153),m=a(216),x=a(64),n=a(39),u=a(256),v=a(123),w=a(622);class l{constructor(da){da=da.split("|");this.IG=da[1];this.nkd=da[2];this.sve=da[3]}get solutionId(){return this.IG}get solutionVersion(){return this.nkd}get needToRestoreManifest(){return this.sve===OSF.StoreTypeEnum.Registry.toString()}}Object(z.a)(l,"AddinStoreInfo",null,[]);class y{}Object(z.a)(y,
"CustomFunctionRegistrationInfos",null,[]);var B=a(224),A=a(76);const E=(da,Ea,qa)=>N(da,Ea,B.a.none,A.a.current,qa),N=(da,Ea,qa,za,ma)=>{qa=da.continueWith(()=>{Ea(da)},3,qa,za);qa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ma)},4);return qa},D=(da,Ea,qa)=>U(da,Ea,B.a.none,A.a.current,qa),U=(da,Ea,qa,za,ma)=>{qa=da.kB(()=>Ea(da),3,qa,za);qa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ma)},4);return n.TaskExtensions.G2c(qa)},K=(da,Ea,qa)=>M(da,Ea,B.a.none,A.a.current,qa),M=(da,Ea,
qa,za,ma)=>{qa=da.kB(()=>Ea(da),3,qa,za);qa.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,ma)},4);return qa},O=(da,Ea,qa)=>R(da,Ea,B.a.none,A.a.current,qa),R=(da,Ea,qa,za,ma)=>{qa=da.kB(()=>Ea(da),3,qa,za);qa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ma)},4);return n.TaskExtensions.G2c(qa)},J=(da,Ea,qa)=>aa(da,Ea,B.a.none,A.a.current,qa),aa=(da,Ea,qa,za,ma)=>{qa=da.continueWith(()=>{Ea(da)},3,qa,za);qa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ma)},4);return qa},S=(da,Ea)=>
{K(a(1377).CustomFunctionsInstaller.EIf("CustomFunctionsRuntimeLogging"),qa=>{if(qa.result&&window.console)switch(qa=C(da.severity)+" "+da.message+Ea,da.severity){case 2:window.console.log&&window.console.log(qa);break;case 0:window.console.info&&window.console.info(qa);break;case 1:window.console.error&&window.console.error(qa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},C=da=>{switch(da){case 0:return"Medium";case 1:return"Unexpected";
case 2:return"Verbose";default:return""}};var L=a(1252);class V{}Object(z.a)(V,"InstallationInfo",null,[]);class X{}Object(z.a)(X,"UninstallationInfo",null,[]);var la=a(32),Va=a(83),na=a(41),db=a(36),ja=a(1),ea=a(28),Z=a(264),ba=a(607),ya=a(67);class Qa{constructor(da,Ea){this.Fjd=da;this._message=Ea}get severity(){return this.Fjd}get message(){return this._message}}Object(z.a)(Qa,"CustomFunctionLog",null,[]);var va=a(5),Ia=a(91),Sa=a(95);class Xa{constructor(da,Ea,qa){this.ioa=!1;this.oP={};this.$=
da;this.ut=Ea;this.QTd().UAa();this.indexedDB=qa;this.indexedDB.zl()&&(this.ioa=!0,this.indexedDB.initialize(Xa.Xmb,Xa.Ymb))}get X5(){return this.ut.X5}OVf(da,Ea,qa,za){if(za.invariantNamespace)for(let ma=0;ma<za.invariantNamespace.length;++ma){const Da=za.invariantNamespace.charAt(ma);if("."!==Da&&"_"!==Da&&"a">Da&&"z"<Da&&"A">Da&&"Z"<Da&&"0">Da&&"9"<Da)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Da}', Position=${ma}.`),
Error.create("InvariantNamespace validation failed");}return D(this.HRh(qa,za.manifest),()=>D(this.hge(da),ma=>{let Da=ma.result;return(null===Da||void 0===Da?0:Da.isDynamicMetadata)?this.ohe(da,Ea,Da,!1,!1,!1):D(this.Zel(da,Ea,za),Ua=>{Da=new V;Da.addinId=qa;Da.locale=za.locale;Da.addinInvariantNamespace=za.invariantNamespace;Da.addinNamespace=za.namespace;Da.addinTitle=za.title;Da.isXllCompatible=za.isXllCompatible;Da.metadataContent=JSON.stringify(JSON.parse(Ua.result));return this.ohe(da,Ea,Da,
!1,Xa.gui(za.osfControl.getStoreType()),L.a(this.$,za))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}PVf(da,Ea,qa,za){if(!Xa.w_d(qa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return D(this.hge(da),ma=>{ma=ma.result;if(!ma&&(ma=na.a.wj(this.X5,da),!ma))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Ea,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ma.metadataContent=JSON.stringify(JSON.parse(qa));ma.isDynamicMetadata=!0;return this.ohe(da,Ea,ma,!0,!0,za)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Y3g(da,
Ea){this.ut.Xva();const qa=Object(c.a)(new X,{solutionId:da}),za=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Ea,null)}.`;return D(this.bie(da),()=>D(this.jie(da),()=>this.dze(this.ut,da,Ea,qa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),za)}Zel(da,Ea,qa){const za=new r.a;OSF.OUtil.xhrGet(qa.metadataUrl,ma=>{ma?za.setResult(ma):za.setException(Error.create("Invalid manifest"))},
ma=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Ea,null)}. ErrorCode: ${ma}.`);za.XC()});return za.task}QTd(){return D(this.hTc(),da=>{const Ea=da.result;if(!Ea.length)return ya.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");da=new e.a;const qa=[];for(let za=
0;za<Ea.length;za++){const ma=Object(k.a)(String,Ea[za]);da.add(K(this.hge(ma),Da=>{if(Da=Da.result){const Ua=na.a.wj(this.oP,Da.addinId);Ua&&Ua===Da.metadataContent||(this.oP[Da.addinId]=Da.metadataContent,this.X5[ma]=Da,qa.push(Da))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return O(ya.Task.WhenAllEnumerable(da),()=>{if(qa.length){const za=new y;za.registrationInfos=qa;return this.roc(this.ut,Ea,za)}b.ULS.sendTraceTag(537163546,
0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return ya.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}QVf(){var da=new r.a;const Ea=[],qa=[];Object.keys(this.X5).forEach(za=>{za=Object(k.a)(String,za);const ma=na.a.wj(this.X5,za);Ea.push(ma);qa.push(za)});if(!qa.length)return da.setResult(!0),da.task;da=Object(c.a)(new y,
{registrationInfos:Ea});return this.roc(this.ut,qa,da)}hTc(){return K(this.tMd(w.a.zeb),da=>{da=da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}J$g(da){return this.upe(w.a.zeb,Sys.Serialization.JavaScriptSerializer.serialize(da))}hge(da){return D(this.tMd(w.a.tlb(da)),Ea=>{Ea=Ea.result||
"";return 0<Ea.length?ya.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(Ea,!0)):ya.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}Pel(da,Ea){return D(this.Ntf(da),()=>D(this.upe(w.a.tlb(da),Sys.Serialization.JavaScriptSerializer.serialize(Ea)),()=>Xa.vpe(w.a.MQd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}bie(da){return D(this.EDg(da),
()=>D(this.bEg(w.a.tlb(da)),()=>D(this.hTc(),Ea=>Ea.result.length?ya.Task.Ua(!0):Xa.vpe(w.a.MQd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}aBg(da){return this.tMd(w.a.slb(da))}G$g(da,Ea){return D(this.Ntf(da),
()=>this.upe(w.a.slb(da),Ea),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}jie(da){return D(this.EDg(da),()=>this.bEg(w.a.slb(da)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}Ntf(da){return D(this.hTc(),Ea=>{Ea=Ea.result;const qa=da.toLowerCase();if(Ea.includes(qa))return ya.Task.Ua(!0);Ea.push(qa);return this.J$g(Ea)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}EDg(da){return D(this.hTc(),
Ea=>{Ea=Ea.result;const qa=da.toLowerCase();return Ea.includes(qa)?(Ea.splice(Array.indexOf(Ea,qa),1),this.J$g(Ea)):ya.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}HRh(da,Ea){if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return da=new OSF.AddinIdInfo(da),da.needToRestoreManifest()?this.G$g(da.getSolutionId(),Ea):ya.Task.Ua(!0);da=new l(da);return da.needToRestoreManifest?this.G$g(da.solutionId,
Ea):ya.Task.Ua(!0)}stk(da){if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const qa=new OSF.AddinIdInfo(da);return qa.needToRestoreManifest()?K(this.aBg(qa.getSolutionId()),za=>{(za=za.result)&&OSF.OsfManifestManager.cacheManifestFromXml(qa.getSolutionId(),qa.getSolutionVersion(),za,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ya.Task.Ua(!0)}const Ea=new l(da);return Ea.needToRestoreManifest?
K(this.aBg(Ea.solutionId),qa=>{(qa=qa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ea.solutionId,Ea.solutionVersion,qa,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ya.Task.Ua(!0)}bEg(da){return this.ioa?this.indexedDB.kBd(da):Xa.qkk(da)}upe(da,Ea){return this.ioa?this.indexedDB.WAa(new ba.a(da,Ea)):Xa.vpe(da,Ea)}tMd(da){return this.ioa?this.indexedDB.Twa(da):Xa.EIf(da)}ohe(da,Ea,qa,za,ma,Da){const Ua=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,
Ea,null)}.`;return n.TaskExtensions.G2c(K(this.phe(this.ut,da,Ea,qa,!1,za,Da),()=>ma?this.Pel(da,qa):ya.Task.Ua(!0),Ua))}phe(da,Ea,qa,za,ma,Da,Ua){if(!Da&&(Da=na.a.wj(this.oP,za.addinId))&&Da===za.metadataContent)return ya.Task.Ua(!0);this.oP[za.addinId]=za.metadataContent;this.X5[Ea]=za;Ua||da.n4b(Ea);da.Xva();return D(this.uhk(Ea,qa,za),()=>this.Jee(za.addinId,ma),"Failed to register functions for customfunction addin")}uhk(da,Ea,qa){const za=new r.a,ma=this.aWa(qa);return this.Tfa(Da=>{S(Xa.bNb,
da);(Da=Da.Result)&&204===Da.ResponseStatusCode?za.setResult(!0):(delete this.oP[qa.addinId],delete this.X5[da],E(this.bie(da),()=>{E(this.jie(da),()=>{this.wUg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${da}. Received status code ${Da?Da.ResponseStatusCode.toString():"Unknown"}.`),za.setResult(!1))},Da=>{Da=v.a.kk(Da.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,
Ea,null)}. Errors: ${db.a.ei(Da)}.`);S(Xa.aNb,da);delete this.oP[qa.addinId];delete this.X5[da];za.setResult(!1)},ma,za,!0)}roc(da,Ea,qa){const za=new r.a,ma=la.a.ih.$j.m;Ea.forEach(Ua=>{Ua=Object(k.a)(String,Ua);da.Eef(Ua)});da.Xva();const Da=this.ktd(qa);return this.Tfa(Ua=>{S(Xa.bNb,Sys.Serialization.JavaScriptSerializer.serialize(Ea));Ua=Ua.Result;let ka=!0,xa=[];if(null===Ua||void 0===Ua?0:Ua.ResponseBody){var Fb=Sys.Serialization.JavaScriptSerializer.deserialize(Ua.ResponseBody.toString());
Array.isArray(Fb.value)&&(xa=Fb.value)}Fb=new e.a;for(let bb=0;bb<xa.length;bb++)if(!xa[bb]){ka=!1;const Ja=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Ua.ResponseStatusCode}.`;Fb.add(D(this.bie(Ea[bb]),()=>{delete this.oP[qa.registrationInfos[bb].addinId];delete this.X5[Ea[bb]];return this.jie(Ea[bb])},Ja))}J(ya.Task.WhenAllEnumerable(Fb),()=>{E(this.Jee("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${la.a.ih.$j.m-
ma} Millisecond.`);ka?za.setResult(ka):J(this.wUg(),()=>{za.setResult(ka)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Ua=>{Ua=v.a.kk(Ua.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${db.a.ei(Ua)}.`);
S(Xa.aNb,Sys.Serialization.JavaScriptSerializer.serialize(Ea));for(Ua=0;Ua<qa.registrationInfos.length;Ua++)delete this.oP[qa.registrationInfos[Ua].addinId],delete this.X5[Ea[Ua]];za.setResult(!1)},Da,za,!0)}dze(da,Ea,qa,za){return D(this.Z4k(da,Ea,qa,za),()=>this.Jee(za.solutionId,!1),"Failed to unregister functions for customfunction addin")}Z4k(da,Ea,qa,za){const ma=new r.a;da.n4b(Ea);(da=na.a.wj(this.X5,Ea))&&delete this.oP[da.addinId];delete this.X5[Ea];za=this.Atd(za);return this.Tfa(()=>{S(Xa.jAd,
Ea);ma.setResult(!0)},Da=>{Da=v.a.kk(Da.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,qa,null)}. Errors: ${db.a.ei(Da)}.`);S(Xa.iAd,Ea);ma.setResult(!1)},za,ma,!1)}Tfa(da,Ea,qa,za,ma){const Da=this.$.userOperationManager,Ua=this.$.pa;let ka=null,xa=null,Fb=null;const bb=()=>{if(Da.gXa()||0<Ua.ta.Ufa||0<Ua.$G.Ufa)return!1;ka&&Da.su(ka);xa&&Ua.hL(xa);
Fb&&Ua.pZ(Fb);const Ja=qa.request;Da.WO(new m.a(507,0,(mb,sa,oa)=>{S(ma?Xa.hAd:Xa.kAd,Ja.RequestBody);return x.h(Ua.ta,"ExecuteRichApiRequest",qa,Z.c(mb,da),Z.b(sa,Ea),oa,null,0)},Ja.RequestFlags&1&&256!==(Ja.RequestFlags&256)?64:80));return!0};bb()||(ka=()=>{bb()},xa=()=>{bb()},Fb=()=>{bb()},Da.kw(ka),Ua.yI(xa),Ua.pX(Fb));return za.task}aWa(da){const Ea={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ea.RequestBody=JSON.stringify(da);Ea.RequestFlags=1;Ea.RequestFlags|=
256;da=this.$.pa.ta.$a(1);da.request=Ea;return da}ktd(da){const Ea={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ea.RequestBody=JSON.stringify(da);Ea.RequestFlags=1;Ea.RequestFlags|=256;da=this.$.pa.ta.$a(1);da.request=Ea;return da}Atd(da){const Ea={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ea.RequestBody=JSON.stringify(da);Ea.RequestFlags=1;Ea.RequestFlags|=256;da=this.$.pa.ta.$a(1);da.request=Ea;return da}Jee(da,Ea){const qa=
Object(Ia.d)(Sa.a.resolve(va.Wc,{va:1}));return U(qa,()=>{qa.result.Vke();return da&&Ea?this.stk(da):ya.Task.Ua(!0)},this.$.ya,u.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}wUg(){const da=new Va.a(1949669462,0,this.$.ii,0,null);return this.$.Ma.qh(da)}static EIf(da){try{return ya.Task.Ua(localStorage.getItem(da))}catch(Ea){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${Ea.message||
"Unknown"}`),ya.Task.Ua(null)}}static vpe(da,Ea){try{return localStorage.setItem(da,Ea),ya.Task.Ua(!0)}catch(qa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${qa.message||"Unknown"}`),ya.Task.Ua(!1)}}static qkk(da){try{return localStorage.removeItem(da),ya.Task.Ua(!0)}catch(Ea){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${Ea.message||
"Unknown"}`),ya.Task.Ua(!1)}}static gui(da){return ea.a.equals(da,"registry",!0)||ea.a.equals(da,"uploadfiledevcatalog",!0)||h.AFrameworkApplication.userNameUnknown||h.AFrameworkApplication.limitedEdit}static w_d(da){if(!da)return!1;try{JSON.parse(da)}catch(Ea){return!1}return!0}}Xa.Xmb="CustomFunctionCache";Xa.Ymb="CustomFunction";Xa.hAd=new Qa(2,"CustomFunctions [Registration] [Begin] SolutionId=");Xa.bNb=new Qa(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Xa.aNb=new Qa(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Xa.kAd=new Qa(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Xa.jAd=new Qa(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Xa.iAd=new Qa(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(z.a)(Xa,"CustomFunctionsInstaller",null,[890])},1378:function(z,t,a){a.r(t);a.d(t,"CustomFunctionsLegacyInstaller",function(){return V});z=a(0);var c=a(2),b=a(15),h=a(1161),r=a(183),e=a(153),k=a(216),m=a(64),x=a(77),n=a(39),u=a(123),v=a(622),w=a(1252);class l{constructor(X){X=
X.split("|");this.IG=X[1];this.nkd=X[2];this.sve=X[3]}get solutionId(){return this.IG}get solutionVersion(){return this.nkd}get needToRestoreManifest(){return this.sve===OSF.StoreTypeEnum.Registry.toString()}}Object(z.a)(l,"AddinStoreInfo",null,[]);class y{}Object(z.a)(y,"CustomFunctionRegistrationInfos",null,[]);const B=(X,la)=>{if(a(1378).CustomFunctionsLegacyInstaller.NRb("CustomFunctionsRuntimeLogging")&&window.console)switch(la=A(X.severity)+" "+X.message+la,X.severity){case 2:window.console.log&&
window.console.log(la);break;case 0:window.console.info&&window.console.info(la);break;case 1:window.console.error&&window.console.error(la)}},A=X=>{switch(X){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class E{}Object(z.a)(E,"InstallationInfo",null,[]);class N{}Object(z.a)(N,"UninstallationInfo",null,[]);var D=a(198),U=a(41),K=a(36),M=a(12),O=a(264),R=a(1115),J=a(67);class aa{constructor(X,la){this.Fjd=X;this._message=la}get severity(){return this.Fjd}get message(){return this._message}}
Object(z.a)(aa,"CustomFunctionLog",null,[]);var S=a(5),C=a(91),L=a(95);class V{constructor(X){this.oP={};this.$=X;this.QTd().UAa()}OVf(X,la,Va,na){const db=new r.a;if(na.invariantNamespace)for(la=0;la<na.invariantNamespace.length;++la){const ea=na.invariantNamespace.charAt(la);if("."!==ea&&"_"!==ea&&"a">ea&&"z"<ea&&"A">ea&&"Z"<ea&&"0">ea&&"9"<ea)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${ea}', Position=${la}.`),
db.setResult(!1),db.task}V.cacheManifest(Va,na.manifest);let ja=V.ige(X);(null===ja||void 0===ja?0:ja.isDynamicMetadata)?this.nhe(X,ja,db,!1,!1):OSF.OUtil.xhrGet(na.metadataUrl,ea=>{ja=Object(c.a)(new E,{addinId:Va,locale:na.locale,addinInvariantNamespace:na.invariantNamespace,addinNamespace:na.namespace,addinTitle:na.title,isXllCompatible:na.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(ea))});this.nhe(X,ja,db,!1,w.a(this.$,na))},ea=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${X}. ErrorCode: ${ea}.`);
db.setResult(!1)});return db.task}PVf(X,la,Va,na){la=new r.a;if(!V.w_d(Va))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),la.setResult(!1),la.task;const db=V.ige(X);if(!db)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),la.setResult(!1),la.task;db.metadataContent=JSON.stringify(JSON.parse(Va));db.isDynamicMetadata=
!0;this.nhe(X,db,la,!0,na);return la.task}Y3g(X){const la=new r.a,Va=S.xb.Aa()?Object(C.d)(L.a.resolve(S.xb,{va:1})):x.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);n.TaskExtensions.Xa(Va,()=>{const na=Va.result;na.Xva();const db=Object(c.a)(new N,{solutionId:X});V.cie(X);V.kie(X);n.TaskExtensions.Xa(this.dze(na,X,db),ja=>{D.b(ja)?la.setResult(ja.result):(ja.Fm?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${X}.`):
ja.mo&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${X}.`),la.setResult(!1))},this.$.ya,0)},this.$.ya,3);return la.task}QTd(){const X=new r.a,la=V.mge();0<la.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Va=[];la.forEach(db=>{db=Object(e.a)(String,db);if(db=V.ige(db)){const ja=U.a.wj(this.oP,db.addinId);
ja&&ja===db.metadataContent||(this.oP[db.addinId]=db.metadataContent,Va.push(db))}});if(!Va.length)return X.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),X.task;const na=S.xb.Aa()?Object(C.d)(L.a.resolve(S.xb,{va:1})):x.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);n.TaskExtensions.Xa(na,()=>{const db=na.result,ja=Object(c.a)(new y,{registrationInfos:Va});n.TaskExtensions.Xa(this.roc(db,
la,ja),ea=>{D.b(ea)?X.setResult(ea.result):(ea.Fm?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):ea.mo&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),X.setResult(!1))},this.$.ya,0)},this.$.ya,3);return X.task}rtk(X){X=new l(X);if(X.needToRestoreManifest){const la=V.vek(X.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(X.solutionId,
X.solutionVersion,la,this.$.ua.UICultureTag)}}nhe(X,la,Va,na,db){const ja=S.xb.Aa()?Object(C.d)(L.a.resolve(S.xb,{va:1})):x.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);n.TaskExtensions.Xa(ja,()=>{n.TaskExtensions.Xa(this.phe(ja.result,X,la,!1,na,db),ea=>{D.b(ea)?((ea=ea.result)&&V.Qel(X,la),Va.setResult(ea)):(ea.Fm?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${X}.`):ea.mo&&b.ULS.sendTraceTag(537163487,
0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${X}.`),Va.setResult(!1))},this.$.ya,0)},this.$.ya,3)}phe(X,la,Va,na,db,ja){if(!db&&(db=U.a.wj(this.oP,Va.addinId))&&db===Va.metadataContent)return J.Task.Ua(!0);this.oP[Va.addinId]=Va.metadataContent;const ea=new r.a;ja||X.n4b(la);X.Xva();X=this.aWa(Va);return this.Tfa(Z=>{B(V.bNb,la);const ba=Z.Result;204===ba.ResponseStatusCode?n.TaskExtensions.Xa(this.Iee(ea,Va.addinId,na),ya=>{ya.Fm?la?b.ULS.sendTraceTag(537163485,
0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${la}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Va.addinId}.`):ya.mo&&(la?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${la}.`):b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Va.addinId}.`));
ea.setResult(!1)},this.$.ya,4):(Z=()=>{delete this.oP[Va.addinId];V.cie(la);V.kie(la);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${la}. Received status code ${ba.ResponseStatusCode}.`);ea.setResult(!1)},Z=Object(c.a)(new R.a,{i0a:OSF.InfoType.Error,title:Va.addinTitle,description:String.format(M.a.instance.sh(153),M.a.instance.ia(1892)),buttonText:M.a.instance.ia(4),Fua:Z,TDc:!1,Gva:Z,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
h.a.Jse(Z))},Z=>{Z=u.a.kk(Z.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${la}. Errors: ${K.a.ei(Z)}.`);B(V.aNb,la);delete this.oP[Va.addinId];ea.setResult(!1)},X,ea,!0)}roc(X,la,Va){const na=new r.a;la.forEach(ja=>{ja=Object(e.a)(String,ja);X.Eef(ja)});X.Xva();const db=this.ktd(Va);return this.Tfa(ja=>{B(V.bNb,Sys.Serialization.JavaScriptSerializer.serialize(la));ja=ja.Result;let ea=!0;var Z=
[];Z=Sys.Serialization.JavaScriptSerializer.deserialize(ja.ResponseBody.toString()),Z=Array.isArray(Z.value)?Z.value:null;for(let ba=0;ba<Z.length;ba++)Z[ba]||(ea=!1,delete this.oP[Va.registrationInfos[ba].addinId],V.cie(la[ba]),V.kie(la[ba]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${la[ba]}. Received status code ${ja.ResponseStatusCode}.`));n.TaskExtensions.Xa(this.Iee(na,"",!1),ba=>{ba.Fm?b.ULS.sendTraceTag(537163477,
0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ba.mo&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");na.setResult(!1)},this.$.ya,4);na.setResult(ea)},ja=>{ja=u.a.kk(ja.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(la)}. Errors: ${K.a.ei(ja)}.`);
B(V.aNb,Sys.Serialization.JavaScriptSerializer.serialize(la));for(const ea of Va.registrationInfos)delete this.oP[ea.addinId];na.setResult(!1)},db,na,!0)}dze(X,la,Va){const na=new r.a;X.n4b(la);X=this.Atd(Va);return this.Tfa(()=>{B(V.jAd,la);n.TaskExtensions.Xa(this.Iee(na,Va.solutionId,!1),db=>{db.Fm?la&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${la}.`):db.mo&&la&&b.ULS.sendTraceTag(537163472,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${la}.`);na.setResult(!1)},this.$.ya,4)},db=>{db=u.a.kk(db.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${la}. Errors: ${K.a.ei(db)}.`);B(V.iAd,la);na.setResult(!1)},X,na,!1)}Tfa(X,la,Va,na,db){const ja=this.$.userOperationManager,ea=this.$.pa;let Z=null,ba=null,
ya=null;const Qa=()=>{if(ja.gXa()||0<ea.ta.Ufa||0<ea.$G.Ufa)return!1;Z&&ja.su(Z);ba&&ea.hL(ba);ya&&ea.pZ(ya);const va=Va.request;ja.WO(new k.a(507,0,(Ia,Sa,Xa)=>{B(db?V.hAd:V.kAd,va.RequestBody);return m.h(ea.ta,"ExecuteRichApiRequest",Va,O.c(Ia,X),O.b(Sa,la),Xa,null,0)},(va.RequestFlags&1?0:16)|64));return!0};Qa()||(Z=()=>{Qa()},ba=()=>{Qa()},ya=()=>{Qa()},ja.kw(Z),ea.yI(ba),ea.pX(ya));return na.task}aWa(X){const la={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};la.RequestBody=
JSON.stringify(X);la.RequestFlags=1;X=this.$.pa.ta.$a(1);X.request=la;return X}ktd(X){const la={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};la.RequestBody=JSON.stringify(X);la.RequestFlags=1;X=this.$.pa.ta.$a(1);X.request=la;return X}Atd(X){const la={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};la.RequestBody=JSON.stringify(X);la.RequestFlags=1;X=this.$.pa.ta.$a(1);X.request=la;return X}Iee(X,la,Va){const na=Object(C.d)(L.a.resolve(S.Wc,
{va:1}));n.TaskExtensions.Xa(na,()=>{na.result.Vke();la&&Va&&this.rtk(la);X.setResult(!0)},this.$.ya,3);return na}QVf(){return J.Task.Ua(!0)}static mge(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(V.NRb(v.a.zeb)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(V.NRb(v.a.zeb)||"[]"):null)||[]}static K$g(X){V.wpe(v.a.zeb,Sys.Serialization.JavaScriptSerializer.serialize(X))}static ige(X){X=V.NRb(v.a.tlb(X))||"";return 0<X.length?Sys.Serialization.JavaScriptSerializer.deserialize(X,
!0):null}static Qel(X,la){V.Mtf(X);V.wpe(v.a.tlb(X),Sys.Serialization.JavaScriptSerializer.serialize(la))}static cie(X){V.DDg(X);V.cEg(v.a.tlb(X))}static vek(X){return V.NRb(v.a.slb(X))}static Rel(X,la){V.Mtf(X);V.wpe(v.a.slb(X),la)}static kie(X){V.DDg(X);V.cEg(v.a.slb(X))}static Mtf(X){const la=V.mge();X=X.toLowerCase();la.includes(X)||(la.push(X),V.K$g(la))}static DDg(X){const la=V.mge();X=X.toLowerCase();la.includes(X)&&(la.splice(Array.indexOf(la,X),1),V.K$g(la))}static cacheManifest(X,la){X=
new l(X);X.needToRestoreManifest&&V.Rel(X.solutionId,la)}static NRb(X){try{return localStorage.getItem(X)}catch(la){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${la.message||"Unknown"}`),null}}static wpe(X,la){try{localStorage.setItem(X,la)}catch(Va){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Va.message||
"Unknown"}`)}}static cEg(X){try{localStorage.removeItem(X)}catch(la){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${la.message||"Unknown"}`)}}static w_d(X){if(!X)return!1;try{JSON.parse(X)}catch(la){return!1}return!0}}V.hAd=new aa(2,"CustomFunctions [Registration] [Begin] SolutionId=");V.bNb=new aa(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");V.aNb=new aa(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
V.kAd=new aa(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");V.jAd=new aa(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");V.iAd=new aa(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(z.a)(V,"CustomFunctionsLegacyInstaller",null,[890])},1389:function(z,t,a){a.d(t,"a",function(){return E});z=a(0);var c=a(224),b=a(15);class h{}Object(z.a)(h,"AddinCommandsHost",null,[]);var r=a(1453),e=a(1559),k=a(1113),m=a(64);const x=(N,D,U,K,M,O)=>{const R=N.$a(9);
R.sharedInfo=D;return m.h(N,"InsertAgaveTaskpane",R,U,K,M,O,0)};var n=a(427),u=a(216),v=a(39),w=a(1),l=a(264);t=a(240);class y extends t.a{constructor(N){super();this.kl=this.nSa="AddInCommandsDialog";this.Ph=5;this.dialogWidth=695;this.dialogHeight=438;this.i1h="100%";this.f1h="408px";this.g1h="15px";this.h1h="0";this.Yph=N}get containerDiv(){return this.Xo}nG(){super.nG();this.Xo.style.width=this.i1h;this.Xo.style.height=this.f1h;this.Xo.style.marginTop=this.g1h;this.Xo.style.padding=this.h1h}dT(){super.dT();
this.ph.style.width=String.format("{0}px",this.dialogWidth);this.ph.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.Yph()}}Object(z.a)(y,"AddInCommandsDialog",t.a,[]);var B=a(67),A=a(76);a=a(106);class E extends h{constructor(N,D,U,K,M){K=void 0===K?null:K;M=void 0===M?null:M;super();this.$=N;this.Ai=D;this.ownerAddinInfo=U;this.Nh=M;this.Fvb=K||B.Task.Ua(!0)}c1h(){const N=this.Fvb;this.Fvb=B.Task.Ua(!0);return N}disposeHost(N){this.Ai.p6a(N)}setOwnerAddinEToken(N){this.ownerAddinInfo.eToken=
N}showTaskpane(N,D,U){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let K=null,M=!1;const O=(new r.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new k.a,!0)).rnf(N.solutionId.substr(this.ownerAddinInfo.solutionId.length));K=D.getSharedRuntimeForTaskpane("Workbook",O);M=!!K&&1===K.LifeTime;this.Ai.Hef(M?this.ownerAddinInfo.solutionId:N.solutionId,M?K:null,null)||(this.P9f(M,!0),this.Fvb=this.OTd(N,K,(R,J)=>{R?(M&&(R.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,
R.SharedRuntime=K),R.WebExtensionOsfControlType=3,this.Ai.xXa(R),U(R.InstanceId,J),this.P9f(M,!1),w.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),U(null,J))}))}getSettings(N,D){const U=this.Ai.m5(N.solutionId);U?D(this.Ai.UX(U).OsfPropertyBag):this.Fvb=this.OTd(N,null,K=>{K?D(K.OsfPropertyBag):b.ULS.sendTraceTag(537170641,
220,10,"GetSettings: insertData is null.")})}showDialog(N,D,U){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const K=this.$.pa.ta,M=R=>{const J=R.Result,aa=J?J.AgaveData:null;aa?(this.Ai.gmf(aa,()=>{const S=new y(()=>{this.disposeHost(aa.InstanceId)});S.initializeAndShow("",null,null);return S.containerDiv}),U(aa.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),U(null,R.Errors?R.Errors[0].ErrorCause:5001))},O=E.mfa(N,this.ownerAddinInfo);this.Fvb=
n.a(this.$.userOperationManager,(R,J,aa)=>x(K,O,l.c(R,M),J,aa,null),R=>new u.a(500,0,R,64),this.Nh)}createUILessSandbox(N,D,U){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const K=D.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),M=!!K&&1===K.LifeTime;(D=this.Ai.Owi(M?this.ownerAddinInfo.solutionId:N.solutionId,M?K:null))?U(D,0):this.Fvb=this.OTd(N,K,(O,R)=>{O?(M?(O.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,O.SharedRuntime=K,O.TaskpaneVisible=!1,O.WebExtensionOsfControlType=
3,this.Ai.xXa(O)):(O.WebExtensionOsfControlType=4,this.Ai.gmf(O,()=>{E.bzb.ga(O.InstanceId,new e.a);return E.bzb.na(O.InstanceId).xma})),U(O.InstanceId,R)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),U(null,R))})}OTd(N,D,U){let K=null;const M=this.$.pa.ta,O=C=>{const L=C.Result;(K=L?L.AgaveData:null)||U(null,C.Errors?C.Errors[0].ErrorCause:5001)},R=E.mfa(N,this.ownerAddinInfo);D&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),R.SharedRuntimeId=D.Resid);
let J=500;var aa=(C,L,V)=>x(M,R,l.c(C,O),L,V,null);let S=0;void 0===R.IsToBePersisted||null===R.IsToBePersisted||R.IsToBePersisted||(J=538,aa=(C,L,V)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));C=l.c(C,O);const X=M.$a(9,null);X.sharedInfo=R;return m.h(M,
"ShowAgaveTaskpane",X,C,L,V,null,0)},S=16);S|=64;aa=n.a(this.$.userOperationManager,aa,C=>new u.a(J,0,C,S),this.Nh);return v.TaskExtensions.ts(aa,()=>K?this.o2d(M,K.InstanceId,(C,L)=>{if(C){D||(K.PrimaryMarketplace.MarketplaceType=N.storeType);N.assetId?N.assetId.toLowerCase().startsWith("wa")?K.AssetMarketplace={SolutionId:N.assetId,SolutionVersion:N.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:N.assetStoreId}:(K.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):
K.AssetMarketplace=null;K.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;K.OwnerAddinStoreType=this.ownerAddinInfo.storeType;K.OsfPropertyBag=[];for(L=0;L<C.Settings.length;L++){const V=[];V[0]=C.Settings[L].Name;V[1]=C.Settings[L].Value;K.OsfPropertyBag[L]=V}U(K,0)}else U(null,L.Errors?L.Errors[0].ErrorCause:5001)}):B.Task.Ua(!1),c.a.none,3,A.a.current)}o2d(N,D,U){const K=M=>{U(M.Result,M)};return n.a(this.$.userOperationManager,(M,O,R)=>{M=l.c(M,K);const J=N.$a(1);J.controlId=D;return m.h(N,
"DdaLoadSettings",J,M,O,R,null,0)},M=>new u.a(501,0,M,80),this.Nh)}P9f(N,D){var U;N&&(null===(U=window.performance)||void 0===U?0:U.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${D}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(N){E.bzb.kh(N)&&E.bzb.na(N).initializeAndShowWithTitle()}static hideUILessDialog(N){E.bzb.kh(N)&&
E.bzb.na(N).hide()}static mfa(N,D){var U,K;const M={};M.SolutionId=N.solutionId;M.Version=N.version;M.StoreType=D.storeType;M.StoreId=N.storeId;M.AssetId=null!==(U=N.assetId)&&void 0!==U?U:N.solutionId;M.AssetStoreId=null!==(K=N.assetStoreId)&&void 0!==K?K:"omex";M.TargetType=1;M.Width=350;M.OwnerAddinSolutionId=D.solutionId;M.OwnerAddinStoreType=D.storeType;M.SharedRuntimeId=null;M.Preload=!1;return M}}E.bzb=new a.a;Object(z.a)(E,"WACExcelAddinCommandsHost",h,[])},1405:function(z,t,a){a.d(t,"a",
function(){return n});z=a(0);var c=a(210),b=a(379),h=a(15);class r{}r.getUserId="getUserId";r.getLastStoreUpdate="laststoreupdate";r.getEntitlement="getEntitlements";r.getEToken="getEToken";r.getManifest="getManifest";r.getAppState="getAppState";r.getKilledApps="getRemovedAddins";r.getAppDetails="getAppDetails";r.removeApps="removeAddin";r.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";r.getPrivateCatalogAddIns="getAddIns";r.getPrivateCatalogManifests="getAppManifests";r.isStoreDisabled=
"isStoreDisabled";Object(z.a)(r,"S2SWebRequestActions",null,[]);var e=a(6),k=a(288),m=a(33),x=a(672);class n{getUserId(u,v){const w=new c.a;w.add(new b.a("corr",u));this.X7(r.getUserId,w,1,v)}getLastStoreUpdate(u,v,w){const l=new c.a;l.add(new b.a("lc",u));l.add(new b.a("corr",v));this.X7(r.getLastStoreUpdate,l,1,w)}getEntitlement(u,v,w,l){u=new c.a;u.add(new b.a("av",v));u.add(new b.a("corr",w));this.X7(r.getEntitlement,u,1,l)}getEToken(u,v,w,l,y,B){const A=new c.a;A.add(new b.a("cmu",u));A.add(new b.a("cmf",
v));A.add(new b.a("assetid",w));A.add(new b.a("expver",l));A.add(new b.a("corr",y));this.X7(r.getEToken,A,1,B)}getManifest(u,v,w,l){const y=new c.a;y.add(new b.a("cmu",u));y.add(new b.a("assetid",v));y.add(new b.a("corr",w));this.X7(r.getManifest,y,1,l)}getAppState(u,v,w){const l=new c.a;l.add(new b.a("ma",u));l.add(new b.a("corr",v));this.X7(r.getAppState,l,1,w)}getKilledApps(u,v){const w=new c.a;w.add(new b.a("corr",u));this.X7(r.getKilledApps,w,1,v)}getAppDetails(u,v,w,l){const y=new c.a;y.add(new b.a("cmo",
u));y.add(new b.a("corr",w));this.sendWithBody(r.getAppDetails,y,v,2,l,!1)}removeApps(u,v,w){const l=new c.a;l.add(new b.a("corr",v));this.sendWithBody(r.removeApps,l,u,2,w,!1)}getLastPrivateCatalogUpdate(u,v,w,l,y,B){const A=new c.a;A.add(new b.a("catalog","privatecatalog"));A.add(new b.a("clientCode",u));A.add(new b.a("clientVersion",v));A.add(new b.a("corr",y));u=String.format("authorizationCode={0}&refreshToken={1}",w?m.a.Al(w):"",l?m.a.Al(l):"");this.sendWithBody(r.getLastPrivateCatalogUpdate,
A,u,2,B,!0)}getPrivateCatalogAddIns(u,v,w,l,y,B){const A=new c.a;A.add(new b.a("catalog","privatecatalog"));A.add(new b.a("clientCode",u));A.add(new b.a("clientVersion",v));A.add(new b.a("corr",y));u=String.format("authorizationCode={0}&refreshToken={1}",w?m.a.Al(w):"",l?m.a.Al(l):"");this.sendWithBody(r.getPrivateCatalogAddIns,A,u,2,B,!0)}getPrivateCatalogManifests(u,v,w,l,y){const B=new c.a;B.add(new b.a("catalog","privatecatalog"));B.add(new b.a("corr",l));u=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",
m.a.Al(u),v?m.a.Al(v):"",w?m.a.Al(w):"");this.sendWithBody(r.getPrivateCatalogManifests,B,u,2,y,!0)}isStoreDisabled(u,v){const w=new c.a;w.add(new b.a("corr",u));this.X7(r.isStoreDisabled,w,2,v)}X7(u,v,w,l){this.sendWithBody(u,v,null,w,l,!1)}sendWithBody(u,v,w,l,y,B){const A=new k.QueryStringBuilder("AddinServiceHandler.ashx");A.cq("action",u);A.cq("app",x.a[e.AFrameworkApplication.ra.$g.kn]);for(const E of v)A.cq(E.key,E.value);v=String.format("{0}{1}&{2}",e.AFrameworkApplication.ra.$g.w1,A.toString(),
e.AFrameworkApplication.Jo);e.AFrameworkApplication.sj.lv(v,l,w,null,!1,2,E=>{let N=null,D=null;E&&E.data&&(E.data.responseHeaders["X-BlockedForMinor"]&&"1"===E.data.responseHeaders["X-BlockedForMinor"].toString()&&(E.data.httpStatus=451),N=E.data.responseData,D=E.data.responseHeaders);y(E.data.httpStatus,N,D)},E=>{var N=null;let D=null;B&&E&&E.data&&E.data.responseData&&(N=E.data.responseData,D=E.data.responseHeaders);y(E.data.httpStatus,N,D);if(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){N={message:"AddinServiceHandler request failed"};N.code=E.data.httpStatus;N.action=u;if(E.data.request||E.data.request.get_headers())N["X-UserSessionId"]=E.data.request.get_headers()["X-UserSessionId"];408===E.data.httpStatus||503===E.data.httpStatus?h.ULS.sendTraceTag(538784582,220,50,JSON.stringify(N)):h.ULS.sendTraceTag(18392345,220,50,JSON.stringify(N))}else h.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",E.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+
u,void 0,void 0,void 0,["X-UserKey"])}}Object(z.a)(n,"S2SWebRequestManager",null,[])},1406:function(z,t,a){a.d(t,"a",function(){return m});z=a(0);var c=a(648),b=a(15),h=a(241);class r{constructor(x,n,u){this.$Pf=v=>{try{if(v&&v.rawEvent&&v.rawEvent.origin&&this.iframe&&this.iframe.id){var w=this.Vtg(v.rawEvent.origin);const l=this.Vtg(document.domain);if(c.a.zm().equals(l,w))if(v.rawEvent.source&&v.rawEvent.source.frameElement&&v.rawEvent.source.frameElement.id&&c.a.zm().equals(v.rawEvent.source.frameElement.id,
this.iframe.id)){w=null;try{w=JSON.parse(v.rawEvent.data)}catch(y){b.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",y.message)}w?(w.statusCode!==h.a.EN||void 0!==w.error&&w.error?(b.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",w.statusCode,w.error),this.onError()):(b.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.H1(w.authorizationCode?w.authorizationCode:w.signInUrl)),$removeHandler(window,"message",this.$Pf),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):b.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):b.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):b.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else b.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else b.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else b.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(l){b.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",l.message)}};this.iframe=x;this.H1=n;this.onError=u;$addHandler(window,"message",this.$Pf)}Vtg(x){let n="";try{x&&(n=-1<x.indexOf("//")?x.split("/")[2]:
x.split("/")[0])&&(n=n.split(":")[0],n=n.split("?")[0])}catch(u){b.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",u.message)}return n}static Ba(x,n,u){new r(x,n,u)}}Object(z.a)(r,"ResponseHandler",null,[]);var e=a(6),k=a(288);class m{constructor(x){this.EUa=x}tryAuthenticate(x,n){this.otb(m.Smh,()=>{x()},n)}tryAuthorize(x,n){this.otb(m.Phh,x,n)}getSignInUrl(x,n){this.otb(m.yYe,x,n)}signOut(x,n){this.otb(m.fth,x,n)}otb(x,n,u){var v=new k.QueryStringBuilder("AuthenticationProxyHandler.aspx");
v.cq("responseType",x);e.AFrameworkApplication.aeb(v);v=String.format("{0}{1}&{2}",this.EUa,v.toString(),e.AFrameworkApplication.Jo);const w=document.createElement("iframe");w.setAttribute("id","privateCatalogIframe");w.setAttribute("name","privateCatalogIframe");w.setAttribute("style","display: none");c.a.zm().equals(x,m.yYe)||w.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");r.Ba(w,n,u);w.setAttribute("src",v);document.body.appendChild(w)}}m.Phh=
"authcode";m.Smh="identitytoken";m.yYe="signinurl";m.fth="signout";Object(z.a)(m,"AuthenticationProxy",null,[])},1452:function(z,t,a){t=a(484)(!1);t.push([z.i,".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}",""]);z.exports=t},1453:function(z,t,a){a.d(t,"a",function(){return b});z=a(0);a(15);var c=a(6);class b{constructor(h,r,e,k){this.wEb=h;c.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&
e.OPi();this.IG=r;this.Nsh=k}get y_b(){return this.wEb}get solutionId(){return this.IG}get Yre(){return this.Nsh}HZa(h){h=this.y_b+this.solutionId+h;return this.Yre?(h in b.Jmc||(b.Jmc[h]="AddinControl"+b.mFh++),b.Jmc[h]):h}rnf(h){if(this.Yre){const e=b.Jmc;for(const k in e){var r=k;if(h===e[k])return r.substr(this.y_b.length+this.solutionId.length)}}return h}xMf(h){h=this.y_b+this.solutionId+h;return this.Yre?(h in b.Ppd||(b.Ppd[h]="AddinTab"+b.CFh++),b.Ppd[h]):h}}b.Jmc={};b.Ppd={};b.CFh=0;b.mFh=
0;Object(z.a)(b,"DefaultRibbonNamingProvider",null,[867])},1514:function(z,t,a){a.d(t,"a",function(){return U});z=a(0);var c=a(210),b=a(15),h=a(106);class r{constructor(){this.startTime=0;this.callback=null}}Object(z.a)(r,"SSOCallbackInfo",null,[]);class e{constructor(){this.accessToken=null}}Object(z.a)(e,"AccessTokenInformation",null,[927]);var k=a(1258);class m{constructor(){this.token=null;this.expiresOn=0;this.nua=this.authChallenge=null}}Object(z.a)(m,"CachedTokenInfo",null,[]);class x{constructor(){this.bdc=
new c.a;this.pla=this.ola=!1;this.mCa=this.authChallenge=null;this.startTime=this.retryCount=0;this.v5e=null}get callbacks(){return this.bdc}}Object(z.a)(x,"SSORequestInfo",null,[]);class n extends x{constructor(){super();this.errorCode=0}}Object(z.a)(n,"SSOFailedRequestInfo",x,[]);var u=a(6),v=a(126),w=a(181);class l{static sha(K,M,O,R){var J=K.startTime;let aa=0;0<J&&(aa=l.SF()-J);J={["callInstanceId"]:J.toString(),["callDuration"]:aa.toString(),["errorCode"]:M.toString()};if(R)for(const S in R)J[S]=
R[S];b.ULS.sendTraceTag(51401116,344,50,"{0}",J);w.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:v.a.Pm(J)});K.callback(M,O)}static SF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(K){}return Date.now()}}Object(z.a)(l,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class y{constructor(K,M,O,R){this.u3=new c.a;this.JQ=new c.a;this.uDa=null;this.Bcb=new c.a;this.YQe=Promise.resolve(null);this.wYe=!1;this.Bic=
M;this.zT=K;this.dZe=O;this.Wgh=R}static jtf(){return u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ReduceAddinSSOThrottleErrors")}$Lk(K){if(this.uDa&&this.uDa.authChallenge===K.authChallenge){if(Date.now()/1E3+y.OEj>this.uDa.expiresOn)return this.uDa=null,!1;K=new k.a;K.token=this.uDa.token;K.expiresOn=this.uDa.expiresOn;K.nua=this.uDa.nua;K.sQa=!0;K.fKa=0;this.YSb(K);return!0}return!1}uKk(K){for(let M=0;M<this.JQ.count;M++)if(this.JQ.na(M).authChallenge===
K.authChallenge&&this.JQ.na(M).mCa===K.mCa){let O;(O=this.JQ.na(M)).retryCount=O.retryCount+1;K.retryCount=this.JQ.na(M).retryCount;if(this.JQ.na(M).retryCount<y.nFj||!this.JQ.na(M).ola&&K.ola||!this.JQ.na(M).pla&&K.pla){if(!this.JQ.na(M).ola&&K.ola||!this.JQ.na(M).pla&&K.pla)K.retryCount=0;this.JQ.removeAt(M);break}K=new k.a;K.errorCode=this.JQ.na(M).errorCode;this.YSb(K);return!0}return!1}vAh(K,M){for(let O=0;O<this.JQ.count;O++)if(this.JQ.na(O).mCa===K.mCa&&this.JQ.na(O).authChallenge===K.authChallenge)return;
this.JQ.add(Object.assign(new n,{ola:K.ola,pla:K.pla,authChallenge:K.authChallenge,mCa:K.mCa,errorCode:M,retryCount:K.retryCount}))}get resource(){return this.Bic}pJd(K,M,O,R,J,aa){""===O&&(O=null);if(this.wYe)l.sha(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var S=null;for(const C of this.u3)if(C.ola===K&&C.pla===M&&C.authChallenge===O&&C.mCa===J){S=C;break}S||(S=Object.assign(new x,{ola:K,pla:M,authChallenge:O,v5e:R,mCa:J,retryCount:0,startTime:l.SF()}),this.u3.add(S));
S.retryCount=0;S.callbacks.add(aa);this.YQe=this.YQe.then(()=>{if(0<this.u3.count){var C=this.u3.na(0);if(this.$Lk(C)||this.uKk(C))return null;for(var L=0;L<this.Bcb.count;)this.Bcb.na(L)+y.KYk<l.SF()?this.Bcb.removeAt(L):L++;L=y.jtf()?y.iFj:y.jFj;if(this.Bcb.count>=L||this.u3.count>=y.IEj)return C=new k.a,C.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.YSb(C),null;let V=null;u.AFrameworkApplication.ra&&(L=u.AFrameworkApplication.ra.wL)&&(V=L.Li("ComponentAttach",this.zT+
y.Cth));return C.mCa.ewh(this.resource,C.ola,C.pla,C.authChallenge,this.Wgh,C.v5e).then(X=>{V&&V.stop();this.YSb(X)},()=>{V&&V.stop();const X=new k.a;X.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.YSb(X)})}return null})}}YSb(K){try{if(this.u3.count){var M=this.u3.na(0);this.u3.removeAt(0);var O=null;K.errorCode||(O=new e,O.accessToken=K.token);K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&
K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&K.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.vAh(M,K.errorCode);var R={};null!=K.fKa&&(R.getTokenSilentTime=K.fKa.toString());null!=K.vSb&&(R.getTokenPopupTime=K.vSb.toString());null!=K.YLd&&(R.getIDTokenTime=K.YLd.toString());null!=K.sQa&&(R.tokenCached=K.sQa.toString());K.xwe&&(R.detailedError=K.xwe);K.nua&&(R.authLibrary=K.nua);M.retryCount&&(R.retryCount=M.retryCount);for(var J of M.callbacks)l.sha(J,
K.errorCode,O,R);if(y.jtf()){const aa=Number.isFinite(K.fKa)&&0<=K.fKa&&K.fKa<y.vui;(0<K.vSb||!aa&&!K.sQa)&&this.Bcb.add(M.startTime)}else null!=K.sQa&&K.sQa||this.Bcb.add(M.startTime);if(!K.errorCode)for(null!=K.expiresOn&&(this.uDa=Object.assign(new m,{token:K.token,expiresOn:K.expiresOn,authChallenge:M.authChallenge,nua:K.nua})),this.JQ.clear(),J=0;J<this.u3.count;)if(this.u3.na(J).authChallenge===M.authChallenge){for(const aa of this.u3.na(J).callbacks)l.sha(aa,K.errorCode,O,R);this.u3.removeAt(J)}else J++}}catch(aa){b.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",aa.message)}}shutdown(){this.wYe=!0;this.u3.clear()}}y.KYk=6E4;y.jFj=6;y.iFj=8;y.IEj=6;y.nFj=3;y.OEj=300;y.vui=100;y.Cth="GetAccessToken";Object(z.a)(y,"SSOCallbackManager",null,[]);var B=a(928),A=a(602),E=a(79),N=a(35),D=a(33);class U{constructor(K,M,O){O=void 0===O?null:O;this.S6c=new h.a;const R=new c.a;M&&R.add(M.aDj);O&&R.addRange(O);this.Cr=K;this.Huh=R}qJd(K,M,O,R,J,aa,S,C,L,V){V=Object.assign(new r,{startTime:l.SF(),callback:V});
try{const Va=!!O&&""!==O;var X=V.startTime;const na=this.getOsfControl(K);let db=na.getStoreType()||"",ja=na.getOwnerAddinStoreType()||"",ea=na.getSolutionId()||"";const Z=na.getVersion()||"";db=db.toLowerCase();ja=ja.toLowerCase();ea=ea.toLowerCase();var la=E.a.WLd(M)||"";const ba=E.a.WLd(na.getIframeUrl())||"",ya=la.toLowerCase()===ba.toLowerCase();la=db;"inmemory"===db&&(la=ja);const Qa=Telemetry.PrivacyRules.GetPrivacyCompliantId(ea,la,na.getAssetId(),null,null,na.getStoreId()),va={["callInstanceId"]:X.toString(),
["controlSolutionId"]:Qa,["controlVersion"]:Z,["storeType"]:db,["ownerStoreType"]:ja,["allowConsentPrompt"]:R.toString(),["forMSGraphAccess"]:J.toString(),["allowSignInPrompt"]:aa.toString(),["hasAddinAuthChallenge"]:Va.toString(),["securityOriginEqualsSourceLocation"]:ya.toString(),["singleSignOnEnabled"]:S.toString(),["accountTypeFilter"]:C||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",va);w.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:v.a.Pm(va)});
X=!0;const Ia=u.AFrameworkApplication.fa.Za("HostAuthType");switch(C){case "aad":X="aad"===Ia;break;case "msa":X="msa"===Ia;break;default:X=!C||"noFilter"===C}if(X){C=null;if(S)for(const Sa of this.Huh)if(Sa.Rjj(ea)){C=Sa;break}C?this.isSSOAddin(K)?(S=!0,"omex"===la&&(S=!1),"spapp"===la||"spcatalog"===la?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),l.sha(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):J&&!S?(b.ULS.sendTraceTag(51234570,
344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),l.sha(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(J&&"exchange"===la&&(R=!1),this.pJd(K,M,O,la,R,aa,L,C,V))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),l.sha(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):l.sha(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else l.sha(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(Va){this.xLc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Va.message),l.sha(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(K,M,O,R){this.qJd(K,O[B.a.Npd]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,M,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,R)}pJd(K,M,O,R,J,aa,S,C,L){this.S6c.kh(K)?R=this.S6c.na(K):(R=new y(K,this.getWebApplicationResource(K).split(",")[0],R,this.getDefaultDisplayName(K)),this.S6c.add(K,R));const V=R.resource;K=U.VUi(V,this.getWebApplicationId(K));const X=OfficeExt.WACUtils.getHostSecure(M);K&&X?K.toLowerCase()===X.toLowerCase()?R.pJd(J,aa,O,S,C,L):(U.c3a('SSO Resource "'+
V+'" cannot be used from "'+M+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),l.sha(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(K||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),X||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),l.sha(L,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}xLc(){b.ULS.sendTraceTag(39068820,
344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(K){return this.Cr.getOsfControl(K)}isSSOAddin(K){return this.getOsfControl(K).getManifest().isSSOAddin()}getWebApplicationId(K){return this.getOsfControl(K).getManifest().getWebApplicationId()}getWebApplicationResource(K){return this.getOsfControl(K).getManifest().getWebApplicationResource()}getDefaultDisplayName(K){return this.getOsfControl(K).getManifest().getDefaultDisplayName()}static QWi(){try{const K=
{};N.a.BLa&&A.a.MTb&&(K.UiHostSupportsAuthTokenAddinList=U.lAf);K.UiHostSupportsAuthToken=A.a.MTb;return K}catch(K){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",K.message)}return null}static getInstance(K,M,O){U.Va||(U.Va=new U(K,void 0===O?null:O));return U.Va}static c3a(K){window.console.warn&&window.console.warn(K)}static VUi(K,M){if(!K)return"";M||(M="");let O=K.toLowerCase();var R=M.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(R)||
(U.c3a('SSO App Id "'+M+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));O.endsWith(R)||(U.c3a('SSO Resource "'+K+'" does not end with App Id "'+M+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!O.startsWith("https://")&&!O.startsWith("api://"))return U.c3a('SSO Resource "'+K+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(M=0;M<K.length;M++){R=K.charAt(M);const J=D.a.charCodeAt(K,M);if(33>J||126<J||"&"===R||"?"===R||"#"===R||"%"===R||"\\"===R)return U.c3a('SSO Resource "'+K+'" contains an invalid character "'+R+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+R+"' in resource URI."),""}if(0<=K.indexOf("::"))return U.c3a('SSO Resource "'+K+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
K.length)return U.c3a('SSO Resource "'+K+'" is '+K.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+K.length+"."),"";O.startsWith("api://")&&(O="https://"+O.substring(6,O.length));return 8===O.length?"":OfficeExt.WACUtils.getHostSecure(O)||""}}U.lAf="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
U.Va=null;Object(z.a)(U,"AppsForOfficeSingleSignOnManager",null,[921])},1523:function(z,t,a){a.r(t);a.d(t,"DdaEventDispatch",function(){return l});z=a(0);var c=a(15),b=a(153),h;(function(y){y[y.none=0]="none";y[y.testEvent=1]="testEvent";y[y.test1Event=2]="test1Event";y[y.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";y[y.worksheetActivatedEvent=11]="worksheetActivatedEvent";y[y.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";y[y.worksheetAddedEvent=13]="worksheetAddedEvent";
y[y.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";y[y.worksheetDeletedEvent=15]="worksheetDeletedEvent";y[y.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";y[y.worksheetFilteredEvent=17]="worksheetFilteredEvent";y[y.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";y[y.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";y[y.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";y[y.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";y[y.worksheetRowHiddenChangedEvent=
22]="worksheetRowHiddenChangedEvent";y[y.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";y[y.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";y[y.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";y[y.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";y[y.worksheetMovedEvent=27]="worksheetMovedEvent";y[y.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";y[y.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";
y[y.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";y[y.chartAddedEvent=50]="chartAddedEvent";y[y.chartActivatedEvent=51]="chartActivatedEvent";y[y.chartDeactivatedEvent=52]="chartDeactivatedEvent";y[y.chartDeletedEvent=53]="chartDeletedEvent";y[y.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";y[y.tableDataChangedEvent=101]="tableDataChangedEvent";y[y.tableAddedEvent=102]="tableAddedEvent";y[y.tableDeletedEvent=103]="tableDeletedEvent";y[y.tableFilteredEvent=
104]="tableFilteredEvent";y[y.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";y[y.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";y[y.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";y[y.commentAddedEvent=250]="commentAddedEvent";y[y.commentDeletedEvent=251]="commentDeletedEvent";y[y.commentChangedEvent=252]="commentChangedEvent";y[y.invocationMessage=1E3]="invocationMessage";y[y.cancellationMessage=1001]="cancellationMessage";y[y.metadataMessage=
1002]="metadataMessage";y[y.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";y[y.visualChangeEvent=2001]="visualChangeEvent";y[y.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";y[y.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";y[y.shapeActivatedEvent=2101]="shapeActivatedEvent";y[y.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";y[y.shapeAddedEvent=2103]="shapeAddedEvent";y[y.shapeDeletedEvent=2104]="shapeDeletedEvent";y[y.workbookAutoSaveSettingChangedEvent=
2200]="workbookAutoSaveSettingChangedEvent";y[y.wacOperationEvent=2201]="wacOperationEvent";y[y.recordingStateChangedEvent=2202]="recordingStateChangedEvent";y[y.workbookActivatedEvent=2203]="workbookActivatedEvent";y[y.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";y[y.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";y[y.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";y[y.linkedDataTypeRefreshModeChangedEvent=
2501]="linkedDataTypeRefreshModeChangedEvent";y[y.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";y[y.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";y[y.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";y[y.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";y[y.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";y[y.lineageActivityUpdateAvailableEvent=2800]=
"lineageActivityUpdateAvailableEvent";y[y.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";y[y.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";y[y.pivotTableAddedEvent=2900]="pivotTableAddedEvent";y[y.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";y[y.namedItemAddedEvent=3E3]="namedItemAddedEvent";y[y.namedItemDeletedEvent=3001]="namedItemDeletedEvent";y[y.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";
y[y.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";y[y.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";y[y.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";y[y.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";y[y.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";y[y.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";
y[y.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";y[y.linkedEntityDataDomainLinkedEntityDataDomainAddedEvent=3600]="linkedEntityDataDomainLinkedEntityDataDomainAddedEvent";y[y.linkedEntityDataDomainRefreshCompletedEvent=3601]="linkedEntityDataDomainRefreshCompletedEvent";y[y.linkedEntityDataDomainRefreshModeChangedEvent=3602]="linkedEntityDataDomainRefreshModeChangedEvent";y[y.externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent=3603]=
"externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent";y[y.tableApplyPowerQueryTableUpdatePlanCompletedEvent=3604]="tableApplyPowerQueryTableUpdatePlanCompletedEvent";y[y.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";y[y.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";y[y.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent";y[y.premiumLicenseChangedEvent=65542]=
"premiumLicenseChangedEvent"})(h||(h={}));Object(z.b)("MessageType",h);var r=a(984),e=a(287),k=a(939),m=a(61),x=a(39),n=a(198),u=a(1),v=a(773),w=a(5);class l{constructor(y,B){this.uK=null;this.x1g={};this.z1g={};this.VGd={};this.y7d={};this.wQd=(A,E)=>{A=this.$.Eh.Li("Task","DdaEventDispatch.HandleServerEvent");E=E.ANg;for(let K=0;K<E.length;K++)switch(E[K].EventType){case 2:var N=E[K],D={};D.Name=N.Name;D.BindingType=N.BindingType;D.ColCount=N.ColCount;D.RowCount=N.RowCount;this.nKa(N.InstanceId,
OSF.DDA.EventDispId.dispidBindingDataChangedEvent,D,null);break;case 4:this.nKa(E[K].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(N=E[K],N.InstanceId){D=Array(N.Entries.length);for(var U=0;U<N.Entries.length;U++)D[U]=l.NBc(N.Entries[U],N.IsRemoteOverride);0<N.Entries.length&&1===N.Entries[0].Category?this.J$j(N.InstanceId,D):N.InstanceId&&this.nKa(N.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,D)}else{this.VGd={};this.y7d={};for(D=0;D<N.Entries.length;D++)this.iqf(N.Entries[D],
N.IsRemoteOverride);N=JSON.stringify(this.VGd);D=JSON.stringify(this.y7d);U=JSON.stringify(this.x1g);const M=JSON.stringify(this.z1g);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${N}, Number of Not Fired event: ${D}, Total Number of Fired event: ${U}, Total Number of Not Fired event: ${M}`)}}A.stop()};this.z6b=(A,E)=>{this.nKa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,E)};this.$=y;this.ddaFacade=B;this.zXc=this.wQd}omc(y){y&&(this.Xva(),this.uK.push(y))}IUc(y){this.uK&&(Array.remove(this.uK,
y),this.uK.length||(this.$.wantServerEvents=!1,this.$.eok(this.zXc),this.uK=null))}J$j(y,B){const A=v.d.Aa()?this.ddaFacade:Object(b.a)(k.DdaFacade,e.a(this.$));x.TaskExtensions.Xa(A.MRi(y),E=>{if(n.b(E)){var N=E.result;E=A.es(N);if(N)if(E.iIc)this.nKa(N,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B);else if(E.Ftc)for(N=0;N<B.length;N++)E.Ftc.push(B[N]);else E.Ftc=B}else E.Fm?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):
E.mo&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ya,0)}cak(y,B){const A=w.xb.Aa()?this.ddaFacade:Object(b.a)(k.DdaFacade,e.a(this.$)),E=A.PDi(y);E?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(E,B,this.z6b):A.P3h(y,B)}iqf(y,B){let A=!1;const E=parseInt(y.Type,10);var N=y.Target;const D=w.xb.Aa()?this.ddaFacade:Object(b.a)(k.DdaFacade,e.a(this.$));if((N=D.Xn.WRi(E,N))&&0<Object.keys(N).length){A=
!0;for(const K in N)if(N=K,D.Xn.Mnc(N)){const M=Array(1);M[0]=l.NBc(y,B);if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var U=M[0][3];if(void 0!==U&&null!==U&&(U=Object(b.a)(Object,m.a.Rp(U)))&&void 0!==U.triggerControlId&&null!==U.triggerControlId&&void 0!==U.triggerSource&&null!==U.triggerSource){let O=!1;B?(U.triggerSource="Unknown",O=!0):D.Ygi(U.triggerControlId,N)&&(U.triggerSource="ThisLocalAddin",O=!0);O&&(M[0][3]=m.a.Ci(U))}}this.nKa(N,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,M)}}A?(this.DEc(h[E],this.VGd),this.DEc(h[E],this.x1g)):(this.DEc(h[E],this.y7d),this.DEc(h[E],this.z1g))}Xva(){this.uK||(this.uK=[],this.$.V4e(this.zXc),this.$.wantServerEvents=!0)}DEc(y,B){y in B||(B[y]=0);B[y]+=1}CM(y,B,A){const E={};E.Target=B;E.Category=65536;E.Type=y;E.Message=A;E.Id=-1;this.iqf(E,!1)}exi(y,B){const A={Target:"",Category:2,Type:1E3};A.Message=B;A.Id=0;B=Array(1);B[0]=l.NBc(A,!1);this.cak(y,B)}gyc(y,B,A,E){const N={};N.Target=A;N.Category=65536;N.Type=B;N.Message=E;N.Id=
-1;B=Array(1);B[0]=l.NBc(N,!1);this.nKa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}dxi(y,B){this.nKa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}nKa(y,B,A,E){if(this.uK){var N=w.xb.Aa()?this.ddaFacade:Object(b.a)(k.DdaFacade,e.a(this.$));if(!N||B!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&B!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||N.Xn.Mnc(y)){y=new r.a(B,y,A,E);for(let D=0,U=this.uK.length;D<U;D++)(B=this.uK[D])&&B(y)}}}static NBc(y,B){const A=Array(6);
A[0]=y.Category;A[1]=y.Type;A[2]=y.Target;A[3]=y.Message;A[4]=y.Id;A[5]=B;return A}}Object(z.a)(l,"DdaEventDispatch",null,[])},1559:function(z,t,a){a.d(t,"a",function(){return h});z=a(0);t=a(240);var c=a(482),b=a(22);class h extends t.a{constructor(){super(void 0,void 0,void 0,!0);this.nSa="AddinCommandsUILessDialog";this.qld="WACDialogTitleText";this.Y8="0";this.PN=380;this.JL=190;this.kl=this.nSa;this.Ph=5;this.vjh=String.format("{0}px",this.PN);this.X8=String.format("{0}px",this.JL);this.zQf=this.BC=
!1;this.nG()}nG(){super.nG();this.Xo.style.width=this.vjh;this.Xo.style.height=this.X8;this.Xo.style.padding=this.Y8}pL(r){this.dT();document.getElementById(this.hp(this.qld)).innerText=r}dT(){super.dT();this.ph.style.width=String.format("{0}px",this.PN);this.ph.style.height=String.format("{0}px",this.JL);this.ph.removeAttribute(c.a.hk);this.ph.removeAttribute(c.a.gU)}hide(){this.vmb()}get xma(){return this.Xo}initializeAndShowWithTitle(){this.initializeAndShow(Object(b.a)("NotificationUITitle"),
null,null)}}Object(z.a)(h,"AddinCommandsUILessDialog",t.a,[911])},1576:function(z,t,a){a.d(t,"a",function(){return e});z=a(0);var c=a(210),b=a(113);class h{constructor(){this.Trf=this.displayName=this.SLb=this.Iw=this.YK=null;this.isUpgraded=!1}t2f(k,m){return this.YK.getStoreType().toLowerCase()===k.toLowerCase()&&this.YK.getSolutionId().toLowerCase()===m.toLowerCase()}}Object(z.a)(h,"AddinCommandsResourceItem",null,[]);var r=a(22);class e{constructor(){this.U6c=null;this.ibd=0;this.Vcd=!1;this.hh=
new b.a;this.jnh=new c.a}$Ah(k){this.hh.addHandler("AddinCommandsLoadingMessageChanged",k)}elk(k){this.hh.removeHandler("AddinCommandsLoadingMessageChanged",k)}get $Fa(){return this.U6c}Rwb(k){k!==this.U6c&&(this.U6c=k,this.hh.raiseEvent("AddinCommandsLoadingMessageChanged"))}KBk(){this.ibd++;this.$Fa||this.Rwb(Object(r.a)("LoadingAddInsTitle"))}ape(){this.ibd--;this.rLc()&&(this.Vcd?this.$Fa!==Object(r.a)("ErrorLoadingAddInsTitle")&&this.Rwb(Object(r.a)("ErrorLoadingAddInsTitle")):this.Rwb(null))}WOg(k){this.Vcd=
!0;this.Rwb((void 0===k?0:k)?Object(r.a)("InstallingCustomFunctionsErrorStatusBarMsg"):Object(r.a)("ErrorLoadingAddInsTitle"))}pff(){this.Vcd=!1;this.rLc()?this.Rwb(null):this.Rwb(Object(r.a)("LoadingAddInsTitle"))}rLc(){return 0>=this.ibd}get dnb(){return this.jnh}mwa(k,m,x){x=void 0===x?0:x;for(const n of this.dnb)if(n.t2f(k,m)&&(!n.Iw||n.Iw.kDi===x))return n;return null}M2e(k,m,x,n){const u=new h;u.YK=k;u.Iw=m;u.SLb=x;u.displayName=n;this.dnb.add(u)}Syh(k,m,x,n){const u=new h;u.YK=k;u.Iw=m;u.SLb=
null;u.Trf=x;u.displayName=n;this.dnb.add(u)}rjk(k,m){let x=0;for(const n of this.dnb)n.YK.getStoreType()===k&&n.YK.getSolutionId()===m?this.dnb.removeAt(x):x++}static getInstance(){e.Va||(e.Va=new e);return e.Va}}e.Va=null;Object(z.a)(e,"AddinCommandsResourceManager",null,[])},361:function(z,t,a){function c(f,G){var fa=document.getElementById(f);fa?G?fa.innerHTML=G:fa.remove():G&&(fa=document.createElement("style"),fa.id=f,fa.type="text/css",fa.innerHTML=G,document.head.appendChild(fa))}function b(f,
G){f=f.map(fa=>{var Ya;fa="AddinFlyoutControl"+fa;return`[data-icon-name=${fa}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: ${null!==(Ya=null===G||void 0===G?void 0:G.palette.red)&&void 0!==Ya?Ya:"#CC4A31"};
      }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${fa}]::after {
          border: WindowText 1px solid;
        }
      }
      `}).join("");c("RedDotNotification",f)}function h(f,G){f=f.map(fa=>{var Ya,Kb,sc;fa="AddinFlyoutControl"+fa;return`[data-icon-name=${fa}]::after {
        content: "New";
        position: absolute;
        top: 6px;
        right: 10px;
        width: 30px;
        height: 16px;
        border-radius: 50%/100%;
        border: 1px solid;
        border-color: ${null!==(Ya=null===G||void 0===G?void 0:G.palette.kRa)&&void 0!==Ya?Ya:"white"};
        background-color: ${null!==(Kb=null===G||void 0===G?void 0:G.palette.Sul)&&void 0!==Kb?Kb:"#0078D4"};
        color: ${null!==(sc=null===G||void 0===G?void 0:G.palette.kRa)&&void 0!==sc?sc:"white"};
        font-size: 10px;
        font-style: normal;
    }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${fa}]::after {
          border-color: WindowText;
          color: WindowText;
        }
      }`}).join("");c("NewStringNotification",f)}function r(f){c("ButtonGroupHighlight",`#${f}[type="button"] { font-weight: 600; background-color: var(--legacy_themeDark); color: white; }`)}function e(f){return Lo(function*(){let G;for(let Td=0;10>Td;++Td)(G=document.getElementById("fluent-default-layer-host"))||(yield new Promise(me=>setTimeout(me,1E3)));if(!G)throw Error("Cannot find the flyout container.");let fa=!1,Ya=performance.now(),Kb;const sc=Td=>{const me=performance.now();Td?(fa=!0,f(!0,
0),Ya=me):fa&&(fa=!1,f(!1,me-Ya))},Tc=Td=>{Kb&&Kb.disconnect();const me=Td.querySelector('[id="InsertAddInFlyoutMenuId"]');me?(Kb=new MutationObserver(ne=>{for(const Me of ne)"attributes"===Me.type&&Me.target instanceof HTMLElement&&("InsertAddInFlyoutMenuId"!==Me.target.id?sc(!1):sc(!0))}),Kb.observe(me,{attributes:!0,attributeFilter:["id"]}),sc(!0)):(Kb=new MutationObserver(ne=>{for(const Me of ne)"attributes"===Me.type&&Me.target instanceof HTMLElement&&("hidden"===Me.target.style.visibility?sc(!1):
sc(!0))}),Kb.observe(Td,{attributes:!0,attributeFilter:["style"]}),"hidden"!==Td.style.visibility&&sc(!0))},fd=new WeakSet,ud=new MutationObserver(Td=>{for(const ne of Td){for(Td=0;Td<ne.addedNodes.length;++Td){var me=ne.addedNodes.item(Td);me instanceof HTMLElement&&(me.querySelector('[id="Ribbon-InsertAddInFlyoutDropdown"]')||me.querySelector('[id="InsertAddInFlyoutMenuId"]'))&&(Tc(me.querySelector(".ms-Callout-container")),fd.add(me))}for(Td=0;Td<ne.removedNodes.length;++Td)me=ne.removedNodes.item(Td),
fd.has(me)&&(fd.delete(me),sc(!1))}});ud.observe(G,{attributes:!1,childList:!0});return{dispose:()=>{ud.disconnect();null===Kb||void 0===Kb?void 0:Kb.disconnect()}}})}function k(f,G){const fa=[];G=new Gc(G);for(var Ya=0;30>Ya;Ya++)Array.add(fa,G.next(f.count));G=0;for(const Kb of f){Ya=!1;for(const sc of fa)if(G===sc){Ya=!0;break}G++;if(Ya){let sc;(sc=Kb.addinInfo).AUP=20*sc.AUP}else if(1===Kb.addinInfo.priority){let sc;(sc=Kb.addinInfo).AUP=4*sc.AUP}else if(2===Kb.addinInfo.priority){let sc;(sc=
Kb.addinInfo).AUP=2*sc.AUP}}f.Sc((Kb,sc)=>Kb.addinInfo.AUP<sc.addinInfo.AUP?1:-1);return f}function m(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}function x(f,G){return Object.assign(new f,G)}function n(f,G,fa){return`<a href="${G}" target="${void 0===fa?"_blank":fa}" >${f}</a>`}function u(){const f=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");f&&(f.style.border="transparent",f.addEventListener("focus",()=>{},{once:!0}))}
function v(f,G,fa){c(f,G?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${fa}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 14px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button {
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${fa}) {
          button {
          }
        }
      }
    }
  }

  .addin-flyout-highlight {
    transition: all 0.5s;
    background-color: var(--legacy_themeLighter);
  }

  .addin-flyout-highlighted {
    background-color: rgba(0, 0, 0, 0);
  }

  button[id^=FRECarouselSwitchIcon_LEFT], button[id^=FRECarouselSwitchIcon_RIGHT] {
    width: 16px;
    height: 18px;
    font-size: 8px;
    background-color: transparent;

    >span >i {
      font-weight: 600;
      color: var(--legacy_white);
    }

    cursor: pointer;
  }

  button[id^=FRECarouselSwitchIcon_MIDDLE] {
    width: 34px;
    height: 14px;
    font-size: 10px;
    background-color: transparent;

    >span >div {
      font-weight: 600;
      color: var(--legacy_white);
      margin: 0px;
      overflow-x: visible;
    }
  }

  [id=FRECarouselDescriptionIconView] {
    padding-left: 0;
    margin-left: 0;
  }

  [id=FRECarouselDescriptionIconView]>span {
    height: unset;
    background-color: var(--colorNeutralBackground1);
    padding: 6px 4px;
    box-sizing: border-box;
    border: 1px solid var(--border-color);
    display: inline-block;
    text-decoration: none;
    text-align: center;
    cursor: pointer;
    vertical-align: top;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 700;
    position: relative;
    word-break: keep-all;
    user-select: none;
    white-space: nowrap;
  }

  [id^=FRECarouselDescriptionIcon] {
    cursor: pointer;
  }
  `:"")}function w(){return Object(Gb.a)("AddinsFlyoutSeeAllButtonText")}function l(f){const G=Bb().Word[f];return G?G:"IPWAI"===f?Object(Gb.a)("AddinsFREDescriptionWordAI"):"WF"===f?Object(Gb.a)("AddinsFREDescriptionWordWriting"):"APID"===f?Object(Gb.a)("AddinsFREDescriptionWordInsertGraphics"):"FlyoutBannerCommon"}function y(f,G,fa){const Ya=Tc=>{switch(Tc){case Sh.LEFT:return Object(Gb.a)("AddinsFRECarouselPreviousButton");case Sh.RIGHT:return Object(Gb.a)("AddinsFRECarouselNextButton");case Sh.Hja:return`${fa+
1} of ${G}`;default:return""}},Kb=[Sh.LEFT,Sh.Hja,Sh.RIGHT],sc=x(Rj.a,{Id:"AddInFlyoutFREBanner",ExternalId:"AddInFlyoutFREBanner",IconName:"IPWAI"===f?"FREWordBannerAI":"WF"===f?"FREWordBannerWriting":"APID"===f?"FREWordBannerInsertGraphics":"FREWordBannerGPTForExcelWord"});return x(P.a,{ControlList:[...Kb.map(Tc=>{var fd=Sj.a,ud=lg.a.B0c.toString();a:switch(Tc){case Sh.LEFT:var Td="ChevronLeft";break a;case Sh.RIGHT:Td="ChevronRight";break a;default:Td=null}fd=x(fd,{Id:`FRECarouselSwitchIcon_${Tc}_${G}`,
ExternalId:`FRECarouselSwitchIcon_${Tc}_${G}`,Command:ud,Icon:Td,FullIconStyle:{["root"]:{position:"absolute",width:"100%",height:"100%"}},Role:"button",Alt:Ya(Tc),LabelText:Tc===Sh.Hja?`${fa+1} of ${G}`:null});fd=x(zj,{SectionId:"FRECarouselSwitchIconSection_"+Tc,GalleryButtons:[fd]});return x(bk.a,{Id:"FRECarouselSwitchButton_"+Tc,ExternalId:"FRECarouselSwitchButton_"+Tc,GalleryStyle:{["galleryStack"]:{["root"]:{position:"absolute",maxWidth:"unset",width:Tc===Sh.Hja?"35px":"16px",height:"18px",
padding:"0px",zIndex:Tc===Sh.Hja?"2":"3",top:"79px",left:Tc===Sh.LEFT?"267px":Tc===Sh.Hja?"279px":"309px",borderRadius:Tc===Sh.LEFT?"18px 0px 0px 18px":Tc===Sh.Hja?"none":"0px 18px 18px 0px",backgroundColor:"var(--legacy_themeDarker)"},["inner"]:{margin:"0px",width:Tc===Sh.Hja?"34px":"18px",height:"18px"}}},Type:4,GallerySections:[fd],DismissHostingSurfaceOnExecute:!1})}),sc,x(bk.a,{Id:"FRECarouselDescription",ExternalId:"FRECarouselDescription",GalleryStyle:{["galleryStack"]:{["root"]:{["maxWidth"]:"100%",
["padding"]:"0px",["cursor"]:"pointer"},["inner"]:{["padding"]:"2px",["flex-wrap"]:"nowrap"}},["galleryButtonInExpanded"]:{["root"]:{"white-space":"normal",backgroundColor:"transparent",textAlign:"left",width:"unset",height:"unset",fontWeight:500,fontSize:13,padding:"4px 6px 8px"},["flexContainer"]:{},["label"]:{}}},Type:4,GallerySections:[x(zj,{SectionId:"FRECarouselDescriptionSection",GalleryButtons:[x(Sj.a,{Id:"FRECarouselDescriptionIcon",Command:lg.a.A0c.toString(),ExternalId:"FRECarouselDescriptionIcon",
FullIconStyle:{["root"]:{["display"]:"none"}},Alt:l(f),Role:"button",LabelText:l(f)}),x(Sj.a,{Id:"FRECarouselDescriptionIconView",Command:lg.a.A0c.toString(),ExternalId:"FRECarouselDescriptionIconView",FullIconStyle:{["root"]:{["display"]:"none"}},Alt:w(),Role:"button",LabelText:w()})]})],DismissHostingSurfaceOnExecute:!1})]})}function B(f,G,fa){c(f,G?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${fa}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          margin-left: 0px;
          width: 100%;
          padding: 15px 13px;
          box-sizing: border-box;

          >i {
            border: none;
            min-width: 36px;
            height: 36px;
            padding: 3px;
            background-color: #fff;
          }

          >div>div>span {
            white-space: normal;
            text-align: left;
            margin-bottom: 5px;
          }

          &:hover {
            background-color: transparent;
            border-color: transparent;
          }

          &:focus {
            background-color: transparent;
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${fa}) {
          button[role="menuitem"] {
            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function A(f,G,fa){c(f,G?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${fa}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        padding-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;

          >i {
            width: 100%;
            height: 102px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin: 0;
            padding: 0;
            width: 100%;

            [id="AddInFlyoutPopularBannerGroupMessage"] {
              min-width: 100%;
              padding: 8px 12px 4px 12px;
              font-weight: 600;
              font-size: 12px;
              line-height: 16px;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          width: 306px;
          padding: 4px 8px;
          margin: 6px 12px 8px 12px;
          box-sizing: border-box;
          background-color: var(--colorNeutralBackground1);

          >div>div {
            font-size: 12px;

            >span {
              white-space: normal;
              text-align: left;
              font-size: 12px;
              font-weight: 600;
              line-height: 16px;
            }
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${fa}) {
          button[role="menuitem"] {
            background-color: transparent;

            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function E(f,G){if(!f)switch(G){case "Word":return["wa200005502","wa200001011","wa200000368"];case "Excel":return["wa200005502"];case "PowerPoint":return["wa200005566"];default:return[]}return f.split("|")}function N(f,G){var fa;return(null===(fa=Bb()[f])||void 0===fa?void 0:fa[G])||Bb().Bqe[G]||""}function D(f,G){a:{var fa=G.solutionId;switch(null===fa||void 0===fa?void 0:fa.toLowerCase()){case "wa200005502":if("Word"===f){fa="FREWordBannerGPTForExcelWord";break a}if("Excel"===f){fa="FREBannerGPTForExcelWord";
break a}}fa="FlyoutBannerCommon"}a:{var Ya;switch(f){case "Excel":f="Boost your productivity in Excel with this ChatGPT add-in.";break a;case "PowerPoint":f=null!==(Ya=Object(Gb.a)("AddinsFlyoutFREDescriptionPPT"))&&void 0!==Ya?Ya:"Elevate your slides! Add-ins for flawless presentations.";break a;default:f="Boost your productivity in Word with this ChatGPT add-in."}}G=x(ck.a,{Id:"AddInFlyoutPopularBannerAction",iconSet:null,ExternalId:"AddInFlyoutPopularBannerAction",CommandId:"AddInFlyoutPopularBannerAction",
CommandIdMapped:lg.a.J2a.toString(),SecondaryLabel:null,Label:f,ActionText:Object(Gb.a)("AddinListAdd"),Links:[x(Tj,{text:Object(Gb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+G.solutionId})],ActionId:lg.a.Txa.toString(),ActionIdMapped:lg.a.Txa.toString(),ActionCommandValueId:G.solutionId,CommandValueId:G.solutionId});G=[x(Rj.a,{Id:"AddInFlyoutPopularBanner",ExternalId:"AddInFlyoutPopularBanner",IconName:fa}),G];return x(P.a,{ControlList:G})}function U(f){f.MenuSectionList.some(G=>
G.ControlList.some(fa=>"AddInFlyoutPopularBanner"===fa.Id))||B("PopularBanner",!1,-1)}function K(f){f.MenuSectionList.some(G=>G.ControlList.some(fa=>"AddInFlyoutPopularBannerGroup"===fa.Id))||A("PopularBannerGroup",!1,-1)}function M(f,G,fa,Ya,Kb,sc,Tc){Ya.concat(Kb).find(fd=>fd.solutionId.toLowerCase()===f.solutionId.toLowerCase())?G.MenuSectionList.push(fa):(Ya=D(Tc,f))?(Kb=G.MenuSectionList.some(fd=>"MRUAddinsSection"===fd.Id),sc=sc&&Kb?2:3,G.MenuSectionList.push(x(P.a,Object.assign({},fa,{ControlList:fa.ControlList.slice(0,
sc)}))),G.MenuSectionList.push(Ya),B("PopularBanner",!0,G.MenuSectionList.length),G.MenuSectionList.push(x(P.a,Object.assign({},fa,{ControlList:fa.ControlList.slice(sc),Title:null})))):G.MenuSectionList.push(fa)}function O(f,G){G=G.filter(Ya=>!!Ya&&!!Ya.solutionId).map(Ya=>{const Kb=`${"AddInFlyoutPopularBannerGroup"}_${Ya.solutionId}`;return x(ck.a,{Id:Kb,ExternalId:Kb,CommandId:Kb,CommandIdMapped:lg.a.J2a.toString(),iconSet:{default:"AddinFlyoutControl"+Ya.solutionId},SecondaryLabel:null,Label:Ya.displayName,
Description:Ya.description,ActionText:Object(Gb.a)("AddinListAdd"),Links:[x(Tj,{text:Object(Gb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+Ya.solutionId})],ActionId:lg.a.Txa.toString(),ActionIdMapped:lg.a.Txa.toString(),ActionCommandValueId:Ya.solutionId,CommandValueId:Ya.solutionId})});var fa="Word"===f?"FREWordBannerAI":"FlyoutBannerCommon";f=N(f,"IPWAI");f=[x(Rj.a,{Id:"AddInFlyoutPopularBannerGroup",ExternalId:"AddInFlyoutPopularBannerGroup",IconName:fa,Label:f,
AriaDescription:f}),...G];return x(P.a,{ControlList:f})}function R(f,G,fa,Ya,Kb,sc,Tc){f=null===f||void 0===f?void 0:f.filter(fd=>!!fd&&!!fd.solutionId);if(0!==(null===f||void 0===f?void 0:f.length)){Ya=Ya.concat(Kb);if(0<(null===Ya||void 0===Ya?void 0:Ya.length)){const fd=Ya.filter(ud=>!!ud&&!!ud.solutionId).map(ud=>ud.solutionId.toLowerCase());f=f.filter(ud=>!fd.includes(ud.solutionId.toLowerCase()))}0<(null===f||void 0===f?void 0:f.length)?(Tc=O(Tc,f))?(Ya=G.MenuSectionList.some(fd=>"MRUAddinsSection"===
fd.Id),sc=sc&&Ya?2:3,G.MenuSectionList.push(x(P.a,Object.assign({},fa,{ControlList:fa.ControlList.slice(0,sc)}))),G.MenuSectionList.push(Tc),A("PopularBannerGroup",!0,G.MenuSectionList.length),G.MenuSectionList.push(x(P.a,Object.assign({},fa,{ControlList:fa.ControlList.slice(sc),Title:null}))),yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutShowBannerGroupInPopular",dataFields:kd.a.V5a({["addins"]:null===f||void 0===f?void 0:f.map(fd=>fd.solutionId)})})):G.MenuSectionList.push(fa):
G.MenuSectionList.push(fa)}}function J(f){const G=document.createElement("div");G.innerHTML=`
  ${'<svg style="animation: addin-flyout-bounce 1.5s infinite;" width="16" height="10" viewBox="0 0 9 6" xmlns="http://www.w3.org/2000/svg">\n  <path class=\'OfficeIconColors_HighContrast\' d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  <path style="fill: var(--colorNeutralForeground1)" d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  </svg>'}
  <div style="font-weight: 600; font-size: 18px; font-family: "Segoe UI Semibold", "Segoe UI Semibold_EmbeddedFont", "Segoe UI Semibold_MSFontService", sans-serif;">${f}</div>`;return G}function aa(){const f=[];document.body.querySelectorAll('\n  [id="Ribbon-InsertAddInFlyoutDropdown"] [class^="container-"], [id="InsertAddInFlyoutMenuId"] [class^="container-"]').forEach(G=>{f.push(G)});return f}function S(){c("AppsFlyoutScrollIndicator","\n  @keyframes addin-flyout-bounce {\n    0% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-5px);\n    }\n    100% {\n      transform: translateY(0);\n    }\n  }\n  ");
e(f=>{var G;if(f&&!("MRUAddinsGalleryControl"in appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout"))){var fa=aa();if(0!==fa.length){f=Ya=>{if(!(0>=Ya.deltaY)){Ya=Ya.currentTarget;var Kb=Ya.querySelector("#apps-flyout-scroll-indicator");!Kb||10>Ya.scrollTop||(Kb.style.opacity="0",yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutFREScrolled"}))}};for(const Ya of fa)Ya.style.position="relative",Ya.removeEventListener("wheel",f),Ya.addEventListener("wheel",f),null===(G=
Ya.querySelector("#apps-flyout-scroll-indicator"))||void 0===G?void 0:G.remove(),fa=J(Object(Gb.a)("AddinsFlyoutScrollDownHintText")||"Scroll up to explore more!"),fa.setAttribute("style","pointer-events: none; transition: all 0.5s ease-out; padding: 30px 0 5px 0; width: 100%; position: fixed; left: 0; bottom: 69px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(rgb(from var(--colorNeutralBackground1) r g b / 0%) 5px, rgb(from var(--colorNeutralBackground1) r g b / 80%), rgb(from var(--colorNeutralBackground1) r g b / 90%));"),
fa.id="apps-flyout-scroll-indicator",Ya.appendChild(fa)}}})}a.r(t);var C={};a.r(C);a.d(C,"AgaveCommandHandler",function(){return za});var L={};a.r(L);a.d(L,"AgaveListenerHandler",function(){return Da});var V={};a.r(V);a.d(V,"AgaveOnSelectedReadoutHandler",function(){return Ja});var X={};a.r(X);a.d(X,"DdaMethodHandler",function(){return lf});var la={};a.r(la);a.d(la,"MacroRecorderEventHandler",function(){return gj});var Va={};a.r(Va);var na={};a.r(na);a.d(na,"SmartLookupCommandHandler",function(){return Ah});
var db=a(135),ja=a(0),ea=a(6),Z=a(942),ba=a(23),ya=a(25),Qa=a(39),va=a(1),Ia=a(211),Sa=a(36),Xa=a(359),da=a(5),Ea=a(773),qa=a(95);let za=class{constructor(f,G){this.$=f;this.agaveCommandManager=G;this.ha=ba.f(this.$).ha;this.qa=this.ha.qa}dj(){return!1}Ri(){return!1}Gi(f,G,fa,Ya){let Kb=!1;switch(G.command){case -684355545:Kb=!0;break;case -741808261:Kb=!!fa;break;case -859308420:Kb=!!Ya&&1===Ya.wO;break;case 418618014:Kb=1===f&&!!Ya&&1===Ya.wO;break;case -167264441:Kb=ya.a.QVb(this.$)&&1===f&&!!Ya&&
1===Ya.wO;break;case -515602470:Kb=1===f&&!!Ya&&1===Ya.wO;break;case -1444574190:case -336193495:Kb=1===f&&!!Ya&&1===Ya.wO;break;case 1296389134:Kb=1===f&&!!Ya&&1===Ya.wO;break;case 1221897806:Kb=va.EwaSettings.Ra(155)&&2===f;break;case 1172793074:case 1930653487:Kb=va.EwaSettings.Ra(155)&&2===f;break;case -1753056834:Kb=!0;break;case 932597253:Kb=!0;break;case 301511274:Kb=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Kb=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!0)&&this.$.isEditMode;break;case 1723441034:Kb=this.$.isEditMode&&this.$.ea.M7b;break;case -1997160483:Kb=ya.a.$U()&&this.$.isEditMode&&this.qa.YI();break;case 1485761473:Kb=ya.a.$U()&&this.$.isEditMode;break;case 762629271:Kb=ya.a.$U()&&va.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")}return Kb}executeCommand(f,G,fa){f=Qa.TaskExtensions.Gq();const Ya=G.command;switch(G.command){case 1296389134:ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",
!1)&&Z.a.instance.getItem("removeFlyoutTaskTimeoutId")&&(window.clearTimeout(Number(Z.a.instance.getItem("removeFlyoutTaskTimeoutId"))),Z.a.instance.removeItem("removeFlyoutTaskTimeoutId"));this.agaveCommandManager.iUk(fa.SourceControlId,fa.LabelText);break;case -684355545:this.agaveCommandManager.jud();break;case -741808261:f=this.agaveCommandManager.insertAgave(fa,G);break;case 1172793074:va.EwaSettings.Ra(155)&&(f=this.agaveCommandManager.gQd(fa,G));break;case -1997160483:case 1485761473:if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")&&
this.Chi()){this.q5h();break}ya.a.xVd()&&void qa.a.resolve(da.ib,{va:0}).then(Kb=>{Kb.$2c(!0)});f=this.agaveCommandManager.gQd(fa,G);break;case -859308420:case -515602470:case -167264441:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:case 762629271:f=this.agaveCommandManager.gQd(fa,G);break;default:f=Ia.a(Ya)}return f}Chi(){var f=this.$.uk;const G=f.get(1),fa=f.get(4);f=f.get(117);return(G||
fa)&&!f}q5h(){const f=Sa.a.nj(1,1,751,2407,0,0,"CopilotNoExtractPermissionsErrorDialog");new Xa.a(this.$,f)}};za=Object(db.__decorate)([Object(qa.d)(da.h),Object(db.__param)(0,Object(da.Nb)()),Object(db.__param)(1,Object(Ea.a)())],za);Object(ja.a)(za,"AgaveCommandHandler",null,[43]);var ma=a(15);let Da=class{constructor(f){this.$=f;this.NPf=G=>{if(null!==G&&void 0!==G&&G.data&&(G=G.data)&&"OfficeCopilotExcelTaskPane"===G.Origin)switch(G.Event){case "Office.Excel.Copilot.AnalyzeReceived":this.Rca(-168711560);
break;case "Office.Excel.Copilot.GenerateReceived":this.Rca(-1805433217);break;case "Office.Excel.Copilot.CommandReceived":this.Rca(-112212005);break;case "Office.Excel.Copilot.AnalyzeApplied":this.Rca(347349230);break;case "Office.Excel.Copilot.GenerateApplied":this.Rca(-2005275355);break;case "Office.Excel.Copilot.CommandApplied":this.Rca(306959157);break;default:ma.ULS.sendTraceTag(508044939,0,10,"AgaveListenerHandler.handleMessageReceived - Unhandled Event.")}}}addListener(){window.addEventListener("message",
this.NPf,!1)}removeListener(){window.removeEventListener("message",this.NPf,!1)}Rca(f){this.$.ti(f,-1,0,null)}};Da=Object(db.__decorate)([Object(qa.d)(da.i),Object(db.__param)(0,Object(da.Nb)())],Da);Object(ja.a)(Da,"AgaveListenerHandler",null,[]);var Ua=a(94),ka=a(355),xa=a(153),Fb=a(58),bb=a(54);let Ja=class{constructor(f,G){this.M5a=this.N5a=null;this.f2g=(fa,Ya)=>{let Kb=null,sc=null,Tc=null;Ya?(Object(ka.a)(577,Ya)?(Kb=Ya.pIb,Tc=Ya.instanceId):Object(ka.a)(592,Ya)&&(Kb=Ya.get_element(),Tc=Ya.instanceId),
Kb)?(sc=Object(xa.a)(848,fa),sc)?this.iBg(Tc,Kb,sc)||Tc in this.M5a||(this.N5a[Tc]=0,this.M5a[Tc]=Fb.a.instance.HO(()=>{10<=this.N5a[Tc]||this.iBg(Tc,Kb,sc)?(delete this.N5a[Tc],this.M5a[Tc].dispose(),delete this.M5a[Tc]):this.N5a[Tc]+=1},500,bb.a.oGh,!0,!1)):ma.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):ma.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):ma.ULS.sendTraceTag(537170626,0,10,
"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=f;this.$=G;this.Ird=!1}Ba(f){this.Ird?ma.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.Ird=!0,this.M5a={},this.N5a={},f?f.PBh(this.f2g):ma.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(f){if(f){f.Nlk(this.f2g);f=this.M5a;for(const G in f)Ua.a.dh(f[G]);this.N5a=this.M5a=null;this.Ird=!1}else ma.ULS.sendTraceTag(537170627,
0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}iBg(f,G,fa){if(this.wgj(fa,f))return!1;f=G.querySelector("iframe");if(!f)return ma.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;f=f.title;if(!f||!f.length)return ma.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(f);return!0}wgj(f,G){return(f=f.Dl.getOsfControl(G))?
f.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};Ja=Object(db.__decorate)([Object(qa.d)(da.j),Object(db.__param)(0,Object(da.l)()),Object(db.__param)(1,Object(da.Nb)())],Ja);Object(ja.a)(Ja,"AgaveOnSelectedReadoutHandler",null,[853]);var mb=a(939),sa=a(1514);class oa{constructor(){this.context=null;this.errorCode=0}}Object(ja.a)(oa,"NestedAppAuthContextResult",null,[]);class cb{static NMd(f,G){const fa=new oa;(f=f.getOsfControl(G))&&f.isFirstParty()?(fa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
f={},G=ea.AFrameworkApplication.fa.Za("AADUserObjectId"),f.userObjectId=G?G:ea.AFrameworkApplication.fa.Za("LoggableUserId"),f.userPrincipalName=ea.AFrameworkApplication.fa.Za("UserPrincipalName"),f.tenantId=ea.AFrameworkApplication.fa.Za("TenantId"),f.puid=ea.AFrameworkApplication.fa.Za("Puid"),f.authorityBaseUrl=ea.AFrameworkApplication.fa.Za("HostAuthAuthority"),G=(ea.AFrameworkApplication.fa.Za("HostAuthType")||"").toLowerCase(),f.authorityType="aad"===G?"aad":"msa"===G?"msa":"other",fa.context=
f):fa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return fa}}Object(ja.a)(cb,"NestedAppAuthUtil",null,[]);var Ka=a(1121),Oa=a(1258),gb=a(1173);class bc{}bc.generalException="generalException";bc.invalidArgument="invalidArgument";bc.jfg="notAllowed";bc.knc="apiNotAvailable";bc.v5k="unresolvedPendingRequest";bc.timeout="timeout";bc.Bnd="adalTimeout";bc.cBe="userNotSignedIn";bc.Hzb="userAborted";bc.BWg="silentSignInFailed";bc.fnb="invalidResourceUrl";bc.qFc="invalidGrant";bc.tif="connectionLost";
bc.Mqc="clientError";bc.serverError="serverError";Object(ja.a)(bc,"WopiHostErrorCodes",null,[]);var Dc=a(928),ad=a(602);class Ac{}Object(ja.a)(Ac,"OAuthCallerMetadata",null,[]);var mc=a(35),Gb=a(22);class Ba{constructor(f){this.iza=f;this.Okh=ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}ewh(f,G,fa,Ya,Kb,sc){if(!this.iza)return Ya=new Oa.a,Ya.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Ya);const Tc=new Ac;
Tc.AddinName=Kb;Tc.AddinTrustId=sc;let fd=-1,ud=-1;sc=null;const Td=ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.EnableAddinPopupTimerTelemetry"),me=(ne,Me,Df,Gf,Cf)=>{const xf=Date.now();return this.iza.a2c(ne,Me,Df,Gf,Cf).then(cg=>{ud=Date.now()-xf;return cg})};if(Ya&&this.P_f())sc=Td?me(Dc.a.tyb,f,Ya,Ba.zBc(Kb),Tc):this.iza.a2c(Dc.a.tyb,f,Ya,Ba.zBc(Kb),Tc);else{const ne=Date.now();sc=this.iza.hE(Dc.a.tyb,f,Tc).then(Me=>{fd=Date.now()-ne;const Df=(G||
fa)&&("login_required"===Me.ErrorCode||"Cookies Disabled"===Me.ErrorCode);return(G&&("interaction_required"===Me.ErrorCode||"consent_required"===Me.ErrorCode||"invalid_grant"===Me.ErrorCode||"UserInteractionRequired"===Me.ErrorCode)||Df)&&this.P_f()?Td?me(Dc.a.tyb,f,null,Ba.zBc(Kb),Tc):this.iza.a2c(Dc.a.tyb,f,null,Ba.zBc(Kb),Tc):Promise.resolve(Me)})}return sc.then(ne=>{const Me=new Oa.a;ne.IsSuccess?(Me.token=ne.Token,ne.Telemetry&&(Me.sQa=ne.Telemetry.fromCache,Me.expiresOn=ne.Telemetry.expiresOn)):
(Me.errorCode=this.ZDj(ne),Me.xwe=this.d4j(ne));return Me}).catch(()=>{const ne=new Oa.a;ne.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(ne)}).then(ne=>{ne.nua="OauthManager";0<=fd&&(ne.fKa=fd);0<=ud&&(ne.vSb=ud);return ne})}Rjj(f){const G=(ea.AFrameworkApplication.fa.Za(ea.AFrameworkApplication.UZ)||"").toLowerCase();return(ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.Enable3rdPartySsoApiForTeams")||!(mc.a.BLa||
"teams"===G&&ad.a.MTb)||Ba.xjj(f))&&this.iza&&this.iza.F0a()?!0:!1}P_f(){return this.Okh||1!==gb.a.pzc()}ZDj(f){switch(f.ErrorCode){case "UserCancelled":case "interaction_required":f=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "UserInteractionRequired":case "consent_required":case "invalid_grant":f=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":f=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":f=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":f=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":f=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:f=f.ErrorCode===bc.Hzb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:f.ErrorCode===bc.BWg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:f.ErrorCode===bc.fnb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:f.ErrorCode===
bc.qFc?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:f.ErrorCode===bc.tif?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return f}d4j(f){let G="";(f=RegExp("AADSTS(\\d+)").exec(f.ErrorMessage))&&1<f.length&&(G=f[1]);return G}static zBc(f){return String.format(Object(Gb.a)("SSOSignInNeededNotification_Description_Text_Addins"),f)}static xjj(f){if(!f)return!1;f=f.toLowerCase();for(const G of sa.a.lAf)if(G===f)return!0;return!1}}
Object(ja.a)(Ba,"AppsforOfficeTokenFromOauthManager",null,[925]);class Xb{constructor(f){this.aDj=f}static yCa(){if(ea.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var f=null;try{f=Object(Ka.a)()}catch(G){ma.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+G)}f=new Ba(f);Xb.Va=new Xb(f)}}static getInstance(){Xb.VNe||(Xb.yCa(),Xb.VNe=!0);return Xb.Va}}Xb.Va=null;Xb.VNe=!1;Object(ja.a)(Xb,"AppsForOfficeOauthManagerFactory",null,[922]);var Ab=a(42),Db=a(189),xc=a(1434),
vc=a(188);class zb{constructor(f,G,fa,Ya){this.menuItemId=f;this.gF=G;this.AVk=fa;this.kvi=Ya}}Object(ja.a)(zb,"NewDocumentParameters",null,[]);var tb=a(10);const ab=f=>{var G=f.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var fa=G.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);fa.addParameter("shortcuts","String[]",1,null,0);G.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);fa=G.addMethod("ReplaceShortcuts",
2,"Void",0,0,"ReplaceShortcuts",0);fa.addParameter("shortcuts","Object",1,null,0);G=f.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);fa=G.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);fa.addParameter("pickerCustomizationJsonString","String",1,null,0);G=f.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);fa=G.addMethod("GetAccessTokenFirstPartyOAuth",
1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);fa.addParameter("appName","String",1,null,0);fa.addParameter("target","String",1,null,0);G=f.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);G.addProperty("Data",4,"String",1,!1,null,0);G=f.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);fa=G.addMethod("SendMessage",
1,"Void",0,1,"SendMessage",4);fa.addParameter("data","String",1,null,0);G.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);G.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);G=f.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);G.addProperty("BatchId",6,"String",1,!1,null,0);G=f.addType("Microsoft.Office.UndoService",
"{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);fa=G.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);fa.addParameter("batchId","String",1,null,0);fa=G.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);fa.addParameter("batchId","String",1,null,0);G.addMethod("Undo",1,"Boolean",1,0,"Undo",4);G.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);G.addMethod("_UnregisterUndoStackChangedEvent",
3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);G=f.addEnumType("Microsoft.Office.UserFeedbackType");G.addEnumField("Like",0);G.addEnumField("Dislike",1);G.addEnumField("Idea",2);G.addEnumField("Unclassified",3);G=f.addEnumType("Microsoft.Office.UserFeedbackUIType");G.addEnumField("ModalDialog",0);G.addEnumField("Taskpane",1);G=f.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);G.addMethod("CanCollectUserFeedback",
27,"Boolean",1,1,"CanCollectUserFeedback",4);fa=G.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);fa.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);fa.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);fa.addParameter("featureArea","String",1,null,0);fa.addParameter("options","Object",1,null,0);G.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",4);G.addMethod("_RegisterUserFeedbackUIDismissedEvent",
18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);G.addMethod("_UnregisterUserFeedbackResponseEvent",29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);G.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);G=f.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);fa=G.addMethod("AddNotification",1,"String",1,0,"AddNotification",4);fa.addParameter("props",
"String",1,null,0);fa.addParameter("options","String",1,null,0);fa=G.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);fa.addParameter("id","String",1,null,0);fa=G.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);fa.addParameter("id","String",1,null,0);fa.addParameter("props","String",1,null,0);G=f.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",2,0);G.addProperty("Color",15,"String",
1,!1,null,0);G.addProperty("Description",13,"String",1,!1,null,0);G.addProperty("DisplayName",12,"String",1,!1,null,0);G.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",1,!1,null,0);G.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);G.addProperty("IsDke",9,"Boolean",1,!1,null,0);G.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);G.addProperty("LabelId",5,"String",1,!1,null,0);G.addProperty("Order",11,"Int32",1,!1,null,0);G.addProperty("ParentName",14,"String",1,!1,null,0);
G.addProperty("TenantId",6,"String",1,!1,null,0);G.addProperty("Version",4,"Int32",1,!1,null,0);G=f.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}","{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);G.addProperty("Context",20,"String",1,!1,null,0);G.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);G.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);G.addProperty("PreviousLabel",18,"Microsoft.Office.SensitivityLabelInfo",
2,!1,null,0);G=f.addType("Microsoft.Office.SensitivityService","{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);fa=G.addMethod("GetHighestSensitivityLabel",3,"Microsoft.Office.SensitivityLabelInfo",2,0,"HighestSensitivityLabel",4);fa.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);G.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);fa=G.addMethod("TryUpgradeLabel",2,"Void",0,0,"TryUpgradeLabel",
4);fa.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",2,null,0);fa.addParameter("context","String",1,null,0);G.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",4);G.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);G=f.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}","{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",3,2);fa=G.addMethod("LaunchHelpPaneByArticleId",
2,"Void",0,0,"LaunchHelpPaneByArticleId",4);fa.addParameter("articleId","Int32",1,null,0);fa=G.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);fa.addParameter("articleId","String",1,null,0);fa=G.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);fa.addParameter("query","String",1,null,0);G=f.addEnumType("Microsoft.Office.BusinessBarType");G.addEnumField("Info",0);G.addEnumField("Error",1);G.addEnumField("Blocked",2);G.addEnumField("SevereWarning",
3);G.addEnumField("Success",4);G.addEnumField("Warning",5);G=f.addType("Microsoft.Office.BusinessBarShowArgs","{9cd04f48-f89b-4720-affd-b69cda192318}","{fb97b13e-bd55-46f2-a1bc-92cf8525546f}",2,0);G.addProperty("HideCloseButton",6,"Boolean",1,!1,null,0);G.addProperty("Message",4,"String",1,!1,null,0);G.addProperty("MessageType",5,"Microsoft.Office.BusinessBarType",1,!1,null,0);G.addProperty("Title",3,"String",1,!1,null,0);G=f.addType("Microsoft.Office.BusinessBarService","{0234fef7-ca58-4b3e-9ae8-6972ccf29564}",
"{8787e4f8-8270-480c-8721-5854ecbc8227}",3,2);fa=G.addMethod("Hide",2,"Void",0,0,"Hide",4);fa.addParameter("caller","String",1,null,0);fa=G.addMethod("Show",1,"Void",0,0,"Show",4);fa.addParameter("caller","String",1,null,0);fa.addParameter("options","Microsoft.Office.BusinessBarShowArgs",2,null,0);G=f.addEnumType("Microsoft.Office.SimpleDialogCategory");G.addEnumField("information",0);G.addEnumField("error",1);G.addEnumField("warning",2);G.addEnumField("question",3);G.addEnumField("other",4);G=f.addType("Microsoft.Office.ShowSimpleDialog",
"{55fc9dc0-9f07-4859-8ba1-f33c353972da}","{f55bd118-7884-4f60-9e0e-e3a7972b7ecb}",3,2);fa=G.addMethod("LaunchSimpleDialog",1,"Microsoft.Office.SimpleDialogState",1,0,"LaunchSimpleDialog",4);fa.addParameter("title","String",1,null,0);fa.addParameter("description","String",1,null,0);fa.addParameter("telemetryid","String",1,null,0);fa.addParameter("Category","Microsoft.Office.SimpleDialogCategory",1,null,0);fa.addParameter("hasButton","Boolean",1,null,0);fa.addParameter("buttonLabel","String",1,null,
0);fa.addParameter("hasCheckbox","Boolean",1,null,0);fa.addParameter("checkboxLabel","String",1,null,0);G=f.addType("Microsoft.Office.DispatchApiService","{1e3afc74-fb27-4b5d-a37b-fda697c46f78}","{82297de7-ac3a-4ee2-853d-26598d2e90e2}",3,2);fa=G.addMethod("Execute",1,"String",1,1,"Execute",4);fa.addParameter("apiName","String",1,null,0);fa.addParameter("paramsData","String",1,null,0);G=f.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);fa=G.addMethod("CreateAndOpenWorkbook",
1,"Void",0,1,"CreateAndOpenWorkbook",0);fa.addParameter("base64File","String",1,null,0);G=f.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);G.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);fa=G.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);fa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);G=f.addType("Microsoft.ExcelServices.CustomFunctionManager",
"{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);G.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);fa=G.addMethod("Register",1,"Void",0,0,"Register",0);fa.addParameter("metadata","String",1,null,0);fa.addParameter("javascript","String",1,null,0);G=f.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);G.addProperty("Enabled",1,"Boolean",1,!1,null,0);G.addProperty("NativeRuntime",
3,"Boolean",1,!1,null,0);G.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);G=f.addEnumType("Microsoft.Authentication.IdentityType");G.addEnumField("OrganizationAccount",0);G.addEnumField("MicrosoftAccount",1);G=f.addEnumType("Microsoft.Authentication.AuthorityType");G.addEnumField("External",0);G.addEnumField("Msa",1);G.addEnumField("Aad",2);G=f.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);G.addProperty("DisplayName",
4,"String",1,!1,null,0);G.addProperty("Email",3,"String",1,!1,null,0);G.addProperty("FederationProvider",2,"String",1,!1,null,0);G.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);G=f.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);G.addProperty("AppId",4,"String",1,!1,null,0);G.addProperty("Authority",2,"String",1,!1,null,0);G.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",
1,!1,null,0);G.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);G.addProperty("TenantId",6,"String",1,!1,null,0);G.addProperty("Upn",1,"String",1,!1,null,0);G=f.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);G.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);fa=G.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",
4);fa.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);G.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);G.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);G=f.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);G.addProperty("AuthChallenge",3,"String",1,!1,null,0);G.addProperty("CorrelationId",
7,"String",1,!1,null,0);G.addProperty("Policy",4,"String",1,!1,null,0);G.addProperty("Resource",2,"String",1,!1,null,0);G.addProperty("Scope",5,"String",1,!1,null,0);G.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);G=f.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);G.addProperty("AccessToken",2,"String",1,!1,null,0);G.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);
G=f.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);G.addProperty("Id",1,"String",1,!0,null,0);G.addProperty("Value",2,"Object",1,!1,null,0);G=f.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);fa=G.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);fa.addParameter("id","String",1,null,0);fa=G.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",
3,1,"ItemOrNullObject",0);fa.addParameter("id","String",1,null,0);G=f.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);G.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);fa=G.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);fa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);G=f.addEnumType("Microsoft.AppRuntime.AppRuntimeState");
G.addEnumField("Inactive",0);G.addEnumField("Background",1);G.addEnumField("Visible",2);G=f.addEnumType("Microsoft.AppRuntime.Visibility");G.addEnumField("Hidden",1);G.addEnumField("Visible",2);G=f.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);G.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);fa=G.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);fa.addParameter("jsonCreate",
"String",1,null,0);fa=G.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);fa.addParameter("jsonUpdate","String",1,null,0);fa=G.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);fa.addParameter("id","String",1,null,0);fa=G.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);fa.addParameter("id","String",1,null,0);G.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);G=f.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}",
"",3,0);G.addProperty("Id",2,"String",1,!0,null,0);fa=G.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);fa.addParameter("visibility","Boolean",1,null,0);G.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);G=f.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);G.addProperty("Enabled",3,"Boolean",1,!1,null,0);G.addProperty("Id",2,"String",1,!0,null,0);G.addProperty("Label",4,"String",1,!0,null,0);fa=G.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",
0);fa.addParameter("enabled","Boolean",1,null,0);G.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);G=f.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);G.addMethod("GetCount",3,"Int32",1,1,"Count",0);fa=G.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);fa.addParameter("key","String",1,null,0);G.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);G.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);G=f.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");
G.addEnumField("Unknown",0);G.addEnumField("Basic",1);G.addEnumField("Premium",2);G=f.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);fa=G.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);fa.addParameter("feature","String",1,null,0);fa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);fa=G.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",
3,1,"LicenseFeature",0);fa.addParameter("feature","String",1,null,0);fa=G.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);fa.addParameter("feature","String",1,null,0);fa.addParameter("fallbackValue","Boolean",1,null,0);G.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);fa=G.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);fa.addParameter("experienceId","String",1,null,0);fa=G.addMethod("_TestFireStateChangedEvent",6,"Void",
0,0,"_TestFireStateChangedEvent",4);fa.addParameter("feature","String",1,null,0);G=f.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);G.addProperty("Id",5,"String",1,!0,null,0);G.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);G.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);G=f.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",
3,0);G.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);G=f.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);G.addMethod("Disable",3,"Void",0,1,"Disable",0);G.addMethod("Enable",2,"Void",0,1,"Enable",0);G.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var La=a(949),pb=a(177);class ia{constructor(f,G){this.nph=f;this.Hph=G}createAndOpenWorkbook(f){if(f&&
f.length>this.nph)throw ma.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",f.length),OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.invalidArgument,pb.a.ia(1769));const G=new zb("blank","agave",f?"streamBase64":"streamEmpty",f);let fa=null;return OfficeExtension.WacRuntime.Utility.createPromise((Ya,Kb)=>{const sc=new vc.a,Tc=pb.a.Uzc("GeneralAddInMessageDialogTitle"),fd=pb.a.Uzc("NewFileAPIConsentMessage");sc.Ph=4;sc.Oo(Tc,fd,1,ud=>{2===ud||0===ud?Kb("Cancelled"):
(fa=window.open(""),this.Hph.create(Ya,Kb,G).Khb())})}).then(Ya=>{if(!Ya)throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,pb.a.ia(1765));try{fa.top.location.href=Ya}catch(Kb){ma.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",mc.a.Vv,Kb),ma.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
fa.location.replace(Ya)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},Ya=>{if("Cancelled"===Ya)throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.fbe,pb.a.ia(1768));fa.close();this.RYk();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.e4h(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}e4h(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.createAndOpenWorkbook(f)}RYk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,
pb.a.ia(1765));}}Object(ja.a)(ia,"WacWorkbook",null,[]);const kb=(f,G)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof f+", objectId="+f+", value="+G);return null},fb=f=>{f.add("InternalTest","PreviewExecutionMethod",kb)};var hb=a(287),Jb=a(947),ub=a(948);class nb{constructor(f){this.th=f}get $(){return this.th}}Object(ja.a)(nb,"RichApiPreviewExecutionContext",null,[]);var Aa=a(27),ra=a(73),vb=a(65),rb=a(61),Nb=a(46),Qc=a(1261),jd=a(77),xd=a(532),ae=a(242),
Sd=a(33),fc=a(246),uc=a(148),hc=a(19),Ec=a(16),yd=a(13),Ad=a(28);class $b extends fc.a{constructor(f,G,fa,Ya,Kb){super(f,"Select Data");this.wJb=null;this.Gnf=G;this.IAd=fa;this.Bi=Kb;this.callback=Ya}get Di(){return"DdaBindingPrompt"}start(f,G){let fa="<div class='"+uc.l+" "+hc.a.oH+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+uc.c+"' /></div>";fa=String.format(fa,Sd.a.Or(this.IAd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Bi.zr(this.tj,
fa);this.wJb=Ec.DOMElementExtensions.getElementById(this.tj,"bindingText");f=G?f.Ujb(G,this.IAd.DdaBindingsMethod.BindingId):null;(null===f||void 0===f?0:f.IsValidRef)?(G=new Aa.Range(f.Reference.FirstRow+1,f.Reference.FirstColumn+1,f.Reference.LastRow+1,f.Reference.LastColumn+1,!1,!1),this.wJb.value=f.Reference.SheetName+"!"+G):(f=ba.f(this.$).ha,this.wJb.value=ra.f(this.$.ma)||!f.qa.Bn?"":f.vva);this.initialize();this.Us()}dF(){this.Cvd();this.addButton(0);this.addButton(1);super.dF()}setFocus(){Ec.DOMElementExtensions.setFocus(this.wJb)}validate(){return!0}commit(){let f=
this.wJb.value.trim();const G=f.indexOf("!");-1!==G&&(f=this.BWi(f.substring(0,G))+f.substr(G));this.Gnf.addBinding(this.IAd,f,0,this.callback);return!0}nKb(){this.Gnf.m0.lo(Jb.a.internalError,this.callback);super.nKb()}BWi(f){f=Ad.a.trimStart(f.trim(),"=");return f.length?f.startsWith("'")&&f.endsWith("'")?f:yd.HelperMethods.uwc(f):""}}Object(ja.a)($b,"DdaBindingPrompt",fc.a,[]);class Ob{constructor(f){this.ea=f}lo(f,G){if(G){const fa={};fa.Error=f;fa.Version=this.ea.yk;G(fa)}}nZa(f,G){this.lo(f,
G)}xR(f,G){this.lo(Jb.a.kCf(f.Errors[0].MessageId),G)}zE(f){f&&f(this.jR())}jR(){const f={Error:0};f.Version=this.ea.yk;return f}}Object(ja.a)(Ob,"DdaErrorGenerator",null,[]);var Yc=a(254);class zd{constructor(f,G,fa){this.$=f;this.m0=G;this.JJ=fa}C6d(f,G){const fa=f.DdaGoToByIdMethod.GoToType,Ya=f.DdaGoToByIdMethod.SelectionMode,Kb=f.DdaGoToByIdMethod.Id.toString().trim(),sc=Tc=>{const fd=this.$.sa.getItemByName(Tc.SheetName);(null===fd||void 0===fd?0:fd.visible)?(ba.f(this.$).np(Tc,null,null,null,
3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.m0.zE(G)):this.m0.lo(Jb.a.fUh,G)};0===fa?this.dJj(Kb,Ya,f.DdaMethod.ControlId,sc,G):1===fa?this.gJj(Kb,Ya,sc,G):this.m0.lo(Jb.a.N5k,G)}dJj(f,G,fa,Ya,Kb){this.JJ.ddaGetBinding(fa,f,sc=>{if(!Yc.a(sc)&&sc.Result&&sc.Result.Reference){sc=sc.Result;var Tc={};Tc.SheetName=sc.Reference.SheetName;Tc.FirstRow=sc.Reference.FirstRow;Tc.FirstColumn=sc.Reference.FirstColumn;Tc.LastRow=sc.Reference.LastRow;Tc.LastColumn=sc.Reference.LastColumn;zd.Ypd(Tc,
G);1!==sc.BindingType?Ya(Tc):this.JJ.ddaGetBindingData(fa,f,1,0,2,0,0,-1,-1,fd=>{Yc.a(fd)||!fd.Result?this.m0.xR(fd,Kb):(fd=fd.Result,2!==G&&(Tc.FirstRow-=fd.Headers.length,0>Tc.FirstRow&&(Tc.FirstRow=0)),Ya(Tc))},Kb)}else this.m0.nZa(Jb.a.tXg,Kb)},Kb)}gJj(f,G,fa,Ya){var Kb=Nb.D(f);Kb?(Kb=Nb.x(Kb,this.$),zd.Ypd(Kb,G),fa(Kb)):this.$.ea.isNamedObjectViewMode&&this.$.Yh.Lq(f)?this.$.Yh.Bqa(this.$.Yh.getItemByName(f),"dda"):(Kb=sc=>{Yc.a(sc)||!sc.Result?this.$.sa.contains(f)?(sc={},sc.SheetName=f,sc.FirstRow=
0,sc.FirstColumn=0,sc.LastRow=0,sc.LastColumn=0,fa(sc)):this.m0.nZa(Jb.a.tXg,Ya):(sc=sc.Result,zd.Ypd(sc,G),fa(sc))},this.$.sa.ma?this.JJ.parseRangeForGoto(f,this.$.sa.ma.name,Kb,Ya):this.JJ.parseRange(f,Kb,Ya))}static Ypd(f,G){f.LastRow=2===G?f.FirstRow:f.LastRow;f.LastColumn=2===G?f.FirstColumn:f.LastColumn}}Object(ja.a)(zd,"DdaNavigator",null,[]);var Dd=a(216),oc=a(64);const $c=(f,G,fa,Ya,Kb,sc)=>{const Tc=f.$a(1);Tc.request=G;return oc.h(f,"ExecuteRichApiRequest",Tc,fa,Ya,Kb,sc,0)};var yb=a(337),
qb=a(92),Cb=a(768),gc=a(648),Mc;(function(f){f[f.unsupported=0]="unsupported";f[f.surface=1]="surface";f[f.combo=2]="combo";f[f.column=3]="column";f[f.column3D=4]="column3D";f[f.bar=5]="bar";f[f.bar3D=6]="bar3D";f[f.line=7]="line";f[f.line3D=8]="line3D";f[f.pie=9]="pie";f[f.pie3D=10]="pie3D";f[f.scatter=11]="scatter";f[f.bubble=12]="bubble";f[f.area=13]="area";f[f.area3D=14]="area3D";f[f.doughnut=15]="doughnut";f[f.radar=16]="radar";f[f.stock=17]="stock";f[f.waterfall=18]="waterfall";f[f.funnel=19]=
"funnel";f[f.treemap=20]="treemap";f[f.sunburst=21]="sunburst";f[f.boxWhisker=22]="boxWhisker";f[f.histogram=23]="histogram";f[f.pareto=24]="pareto";f[f.regionMap=25]="regionMap";f[f.noVisibleSeries=26]="noVisibleSeries";f[f.complexDataSource=27]="complexDataSource";f[f.pivotChart=28]="pivotChart"})(Mc||(Mc={}));Object(ja.b)("ChartCategory",Mc);class bd{constructor(f,G){this.source=f;this.eventId=G}}Object(ja.a)(bd,"MacroRecorderEventData",null,[]);class Id{constructor(f,G,fa){this.response=this.request=
this.eventId=this.source=null;f&&(this.source=f.source,this.eventId=f.eventId,this.request=G,this.response=fa)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(ja.a)(Id,"MacroRecorderRichApiRequestExecutedPayload",null,[146]);class Vd{constructor(f,G,fa){this.parentName=f;this.$=G;this.request=fa}MUi(f){var G;if(void 0===f||null===f||void 0===f.RequestBody||null===f.RequestBody)return null;const fa=JSON.parse(f.RequestBody);
if(void 0!==f.ActiveFloatingObjectId&&null!==f.ActiveFloatingObjectId){fa.ActiveFloatingObjectId=f.ActiveFloatingObjectId;const Ya=ba.f(this.$).ha.$e.Lh;if(null===(G=null===Ya||void 0===Ya?void 0:Ya.floatingObject)||void 0===G?0:G.Ti)fa.ActiveChartType=Mc[Ya.floatingObject.Ti.ChartCategory]}void 0!==f.SheetMultiRange&&null!==f.SheetMultiRange&&(fa.SheetName=f.SheetMultiRange.SheetName);return fa}XUi(f){if(void 0===f||null===f||void 0===f.Result||null===f.Result)return null;f=f.Result;return void 0===
f.ResponseBody||null===f.ResponseBody||f.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(f.ResponseBody.join(""))}Dpj(f){return!!f&&!(void 0===f.eventId||null===f.eventId)&&0<f.eventId.length}Ft(f){return()=>{if(this.$.bha){const G=this.KPh(this.request);if(this.Dpj(G)){const fa=this.MUi(this.request),Ya=this.XUi(f);if(fa&&!qb.a.isEmpty(fa)&&Ya&&!qb.a.isEmpty(Ya))return ma.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Id(G,
fa,Ya);ma.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${fa?"(not null)":"(null)"}; responseInfo: ${Ya?"(not null)":"(null)"}`}`)}}return new Id(null,null,null)}}KPh(f){const G=this.Epj(f.SolutionId),fa=Vd.rUi(f);if(fa&&G)return ma.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:fa,["request.SolutionId"]:f.SolutionId})}`),new bd(f.SolutionId,fa);f=JSON.stringify({["recorderEventId"]:fa,["isRecorderAwareAddin"]:G,
["request.SolutionId"]:f.SolutionId});ma.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${f}`);return null}Epj(f){if(!f)return!1;f=f.toLowerCase();return Vd.e0i().contains(f)}static e0i(){Vd.mOa||(Vd.mOa=new Cb.a(gc.a.zm()),Vd.mOa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Vd.mOa.add("fa000000005"),Vd.mOa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Vd.mOa.add("fa000000014"),Vd.mOa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Vd.mOa}static rUi(f){let G=null;var fa=
RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(fa.test(f.RequestBody))G=fa.exec(f.RequestBody)[1];else{f=f.RequestHeaders;if(!f)return G;fa=tb.a.kMj.toLowerCase();for(let Ya=0;Ya<f.length;Ya++)if(f[Ya].Name.toLowerCase()===fa){G=f[Ya].Value;break}}return G}}Vd.mOa=null;Object(ja.a)(Vd,"DdaRichApiRequestRecorder",null,[]);var ce=a(264);class ee extends yb.a{constructor(f,G,fa,Ya,Kb,sc,Tc,fd){super(10,0,G,fd);this.kGb=fa;this.pCb=Ya;this.wfa=Kb;this.AUa=sc;this.request=
Tc;this.fme=new Vd("10",f,Tc)}get c4c(){return this.AUa}get jQ(){return this.kGb}get iwa(){return this.pCb}Nea(f){return super.Nea(f)||this.RSh(f)}Ft(){return this.fme.Ft(this.nk)}Byb(){const f={OperationType:3};f.RichApiRequest=this.request;return f}RSh(f){return(G,fa,Ya)=>$c(f,this.request,ce.c(G,this.kGb),ce.b(fa,this.pCb),Ya,this.wfa)}}Object(ja.a)(ee,"DdaRichApiRequestBatchOperation",yb.a,[]);class Je extends Dd.a{constructor(f,G,fa,Ya){super(576,0,fa,Ya);this.fme=new Vd("576",f,G)}Ft(){return this.fme.Ft(this.nk)}}
Object(ja.a)(Je,"DdaRichApiRequestOperation",Dd.a,[]);class Ue{constructor(f,G){this.BS=(fa,Ya)=>{this.m0.nZa(Jb.a.internalError,Ya)};this.$=f;this.m0=G}ddaAddBinding(f,G,fa,Ya,Kb,sc,Tc){this.CU((fd,ud,Td)=>{var me=this.$.pa.ta,ne=this.Mwa();fd=ce.c(fd,sc);ud=ce.b(ud,this.BS);const Me=me.$a(9);Me.controlId=f;Me.bindingId=G;Me.bindingType=fa;Me.currentSheetName=ne;Me.formula=Ya;Me.options=Kb;return oc.h(me,"DdaAddBinding",Me,fd,ud,Td,Tc,0)},Tc,563)}ddaReleaseBinding(f,G,fa,Ya){this.CU((Kb,sc,Tc)=>
{var fd=this.$.pa.ta;Kb=ce.c(Kb,fa);sc=ce.b(sc,this.BS);const ud=fd.$a(9);ud.controlId=f;ud.bindingId=G;return oc.h(fd,"DdaReleaseBinding",ud,Kb,sc,Tc,Ya,0)},Ya,564)}ddaGetBinding(f,G,fa,Ya){this.CU((Kb,sc,Tc)=>{var fd=this.$.pa.ta;Kb=ce.c(Kb,fa);sc=ce.b(sc,this.BS);const ud=fd.$a(1);ud.controlId=f;ud.bindingId=G;return oc.h(fd,"DdaGetBinding",ud,Kb,sc,Tc,Ya,0)},Ya,565,16)}ddaGetAllBindings(f,G,fa){this.CU((Ya,Kb,sc)=>{var Tc=this.$.pa.ta;Ya=ce.c(Ya,G);Kb=ce.b(Kb,this.BS);const fd=Tc.$a(1);fd.controlId=
f;return oc.h(Tc,"DdaGetAllBindings",fd,Ya,Kb,sc,fa,0)},fa,566,16)}ddaGetBindingData(f,G,fa,Ya,Kb,sc,Tc,fd,ud,Td,me){this.CU((ne,Me,Df)=>{var Gf=this.$.pa.ta,Cf=this.Mwa();ne=ce.c(ne,Td);Me=ce.b(Me,this.BS);const xf=Gf.$a(1);xf.controlId=f;xf.bindingId=G;xf.coerceType=fa;xf.valueFormat=Ya;xf.filterType=Kb;xf.startRow=sc;xf.startCol=Tc;xf.rowCount=fd;xf.colCount=ud;xf.currentSheetName=Cf;return oc.h(Gf,"DdaGetBindingData",xf,ne,Me,Df,me,0)},me,567,16)}ddaSetBindingData(f,G,fa,Ya,Kb,sc,Tc){this.CU((fd,
ud,Td)=>{var me=this.$.pa.ta,ne=this.Mwa();fd=ce.c(fd,sc);ud=ce.b(ud,this.BS);const Me=me.$a(9);Me.controlId=f;Me.bindingId=G;Me.startRow=fa;Me.startCol=Ya;Me.currentSheetName=ne;Me.bindingData=Kb;return oc.h(me,"DdaSetBindingData",Me,fd,ud,Td,Tc,0)},Tc,568)}ddaGetSelectedData(f,G,fa,Ya,Kb,sc,Tc){this.CU((fd,ud,Td)=>{var me=this.$.pa.ta,ne=this.Mwa();fd=ce.c(fd,sc);ud=ce.b(ud,this.BS);const Me=me.$a(1);Me.controlId=f;Me.coerceType=G;Me.valueFormat=fa;Me.filterType=Ya;Me.currentSheetName=ne;Me.formula=
Kb;return oc.h(me,"DdaGetSelectedData",Me,fd,ud,Td,Tc,0)},Tc,569,16)}ddaSetSelectedData(f,G,fa,Ya,Kb){this.CU((sc,Tc,fd)=>{var ud=this.$.pa.ta,Td=this.Mwa();sc=ce.c(sc,Ya);Tc=ce.b(Tc,this.BS);const me=ud.$a(9);me.controlId=f;me.currentSheetName=Td;me.formula=G;me.bindingData=fa;return oc.h(ud,"DdaSetSelectedData",me,sc,Tc,fd,Kb,0)},Kb,570)}ddaLoadSettings(f,G,fa){this.CU((Ya,Kb,sc)=>{var Tc=this.$.pa.ta;Ya=ce.c(Ya,G);Kb=ce.b(Kb,this.BS);const fd=Tc.$a(1);fd.controlId=f;return oc.h(Tc,"DdaLoadSettings",
fd,Ya,Kb,sc,fa,0)},fa,501,16)}ddaSaveSettings(f,G,fa,Ya,Kb){this.CU((sc,Tc,fd)=>{var ud=this.$.pa.ta;sc=ce.c(sc,Ya);Tc=ce.b(Tc,this.BS);const Td=ud.$a(9);Td.controlId=f;Td.settings=G;Td.overwriteIfStale=fa;return oc.h(ud,"DdaSaveSettings",Td,sc,Tc,fd,Kb,0)},Kb,571)}ddaAddRowsColumns(f,G,fa,Ya,Kb,sc){this.CU((Tc,fd,ud)=>{var Td=this.$.pa.ta,me=this.Mwa();Tc=ce.c(Tc,Kb);fd=ce.b(fd,this.BS);const ne=Td.$a(9);ne.controlId=f;ne.bindingId=G;ne.isRow=fa;ne.currentSheetName=me;ne.bindingData=Ya;return oc.h(Td,
"DdaAddRowsColumns",ne,Tc,fd,ud,sc,0)},sc,572)}ddaDeleteAllDataValues(f,G,fa,Ya){this.CU((Kb,sc,Tc)=>{var fd=this.$.pa.ta,ud=this.Mwa();Kb=ce.c(Kb,fa);sc=ce.b(sc,this.BS);const Td=fd.$a(9);Td.controlId=f;Td.bindingId=G;Td.currentSheetName=ud;return oc.h(fd,"DdaDeleteAllDataValues",Td,Kb,sc,Tc,Ya,0)},Ya,573)}ddaClearBindingFormats(f,G,fa,Ya){this.CU((Kb,sc,Tc)=>{var fd=this.$.pa.ta,ud=this.Mwa();Kb=ce.c(Kb,fa);sc=ce.b(sc,this.BS);const Td=fd.$a(9);Td.controlId=f;Td.bindingId=G;Td.currentSheetName=
ud;return oc.h(fd,"DdaClearBindingFormats",Td,Kb,sc,Tc,Ya,0)},Ya,574)}ddaSetBindingFormats(f,G,fa,Ya,Kb,sc){this.CU((Tc,fd,ud)=>{var Td=this.$.pa.ta,me=this.Mwa();Tc=ce.c(Tc,Kb);fd=ce.b(fd,this.BS);const ne=Td.$a(9);ne.controlId=f;ne.bindingId=G;ne.currentSheetName=me;ne.bindingData=fa;ne.isSetFormats=Ya;return oc.h(Td,"DdaSetBindingFormats",ne,Tc,fd,ud,sc,0)},sc,575)}parseRange(f,G,fa){this.CU((Ya,Kb,sc)=>{const Tc=this.$.pa.ta.Wh();return oc.w(this.$.pa.ta,f,-1,ce.c(Ya,G),ce.b(Kb,this.BS),sc,fa,
Tc)},fa,162,16)}parseRangeForGoto(f,G,fa,Ya){this.CU((Kb,sc,Tc)=>{const fd=this.$.pa.ta.Wh();return oc.x(this.$.pa.ta,f,G,ce.c(Kb,fa),ce.b(sc,this.BS),Tc,Ya,fd)},Ya,562,16)}executeRichApiRequest(f,G,fa){f.RequestFlags&=12287;if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var Ya=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const Kb=0!==(f.RequestFlags&128);Ya||"sdxcatalog"===f.MarketplaceType||Kb||(f.RequestFlags&=
-17)}va.EwaSettings.Ra(233)?this.lti(this.$.pa.ta.Wh(),G,()=>{this.m0.nZa(Jb.a.internalError,fa)},fa,f):(Ya=mb.DdaFacade.bNd(f),!this.$.vh.ME||Ya&16?(Ya|=64,this.$.userOperationManager.WO(new Je(this.$,f,(Kb,sc,Tc)=>$c(this.$.pa.ta,f,ce.c(Kb,G),ce.b(sc,this.BS),Tc,fa),Ya))):(this.m0.nZa(Jb.a.f5c,fa),ma.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}Mwa(){return this.$.ea.isNamedObjectViewMode?this.$.ma.sheetName:this.$.activeItemName}CU(f,G,fa,Ya){Ya=void 0===Ya?0:Ya;!this.$.vh.ME||
Ya&16?this.$.userOperationManager.WO(new Dd.a(fa,0,f,Ya|64)):(this.m0.nZa(Jb.a.f5c,G),ma.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}lti(f,G,fa,Ya,Kb){let sc=mb.DdaFacade.bNd(Kb);if(!this.$.vh.ME||sc&16){var Tc=this.$.Eh.Li("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new ee(this.$,f,G,fa,Ya,Tc,Kb,sc|64),null)}else this.m0.nZa(Jb.a.f5c,Ya),ma.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(ja.a)(Ue,"DdaWebServiceHelper",
null,[]);class jc{constructor(f,G,fa,Ya){this.$ui=f;this.fileSize=G;this.cSk=Ya}}Object(ja.a)(jc,"DocumentFile",null,[]);class tc{}tc.generalException="GeneralException";tc.xHh="ApiNotFound";tc.fbe="OperationCancelled";tc.invalidArgument="InvalidArgument";Object(ja.a)(tc,"ErrorCodes",null,[]);class Kc{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(ja.a)(Kc,"WacApiDelegates",null,[]);var wd=a(731);class Rb extends Kc{constructor(f,G){super();this.V2f=(fa,Ya)=>{fa=Rb.r2h(fa,Ya);if(!wd.a(this.$,fa))return!0;fa=this.$.shortcutKeyManager.kOd(fa);return!!fa&&0<fa.length};this.addinId=f;this.$=G}replaceShortcuts(f){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,f,this.V2f)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(f){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(f,
this.V2f)}static a7h(f,G){const fa=document.createEvent("KeyboardEvent");if(mc.a.aJ)fa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(f&8),!!(f&32),!!(f&4),!!(f&256));else{const Ya=[];f&4&&Ya.push("Shift");f&8&&Ya.push("Control");f&32&&Ya.push("Alt");fa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Ya.join(" "),!1,"en-US")}f=new Sys.UI.DomEvent(fa);f.keyCode=G;return f}static r2h(f,G){if(mc.a.Am)switch(G){case 189:G=173;break;case 187:G=61;break;case 186:G=59}return Rb.a7h(f,G)}}Object(ja.a)(Rb,
"ExcelWacApiDelegates",Kc,[]);class dc{constructor(f){this.fYa={};this.WEj=f}Txh(f,G){this.lDc(f)||(this.fYa[f]={});if(this.wjj(f))return ma.ULS.sendTraceTag(537163157,344,50,`App ${f} has reach the limit of number of cached files.`),Jb.a.KFj;this.fYa[f][G.$ui.toString()]=G;return Jb.a.success}dKi(f,G){let fa=null;this.lDc(f)&&(fa=this.fYa[f][G.toString()]);fa||ma.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${f}, fileHandler:${G}] doesn't exist`);return fa}lDc(f){return f in this.fYa}gjk(f,
G){if(this.lDc(f)){const fa=this.fYa[f];delete fa[G.toString()];1>Object.keys(fa).length&&delete this.fYa[f];return G.toString()in fa?Jb.a.internalError:Jb.a.success}return Jb.a.internalError}wjj(f){return this.lDc(f)?Object.keys(this.fYa[f]).length>=this.WEj:!1}static getInstance(f){return f.la.lh(200)||f.la.Hh(200,new dc(dc.XEj))}static UJj(){return++dc.MRh}}dc.yEj=4194304;dc.XEj=1;dc.MRh=0;Object(ja.a)(dc,"GetFileApiHelper",null,[]);class $a{constructor(f){this.zs=f}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.zs)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){switch(f){case 1:return this.EKj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){f=this.invokeMethod(f,
G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}EKj(){this.notifyActionHandlerReady();return null}}Object(ja.a)($a,"AddinInternalService",null,[]);class Wb{constructor(f,G){this.zx=G;this.zs=f}getAppRuntimeState(){let f=this.zs;pb.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.zx.KZ&&(f=this.zx.kaa(this.zs));return this.zx.getAppRuntimeState(f)?2:1}setAppRuntimeState(f){switch(f){case 2:f=!0;break;case 1:f=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.invalidArgument,
pb.a.ia(1769));}let G=this.zs;pb.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.zx.KZ&&(G=this.zx.kaa(this.zs));this.zx.setAppRuntimeState(G,f)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f,G){switch(f){case 2:return this.EEi();case 1:return this.ABk(G)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}EEi(){return this.getAppRuntimeState()}ABk(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
0,"int");this.setAppRuntimeState(f);return null}}Object(ja.a)(Wb,"AppRuntimeService",null,[]);var rc=a(1262);class xb{constructor(f,G,fa,Ya){this.IG=f;this.uda=fa;this.nI=Ya.Dl.getOsfControl(G)}disable(){try{if(!pb.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.jkf();if(!this.s2f())return this.kkf();this.uda.Q4k(this.IG)}catch(f){return ma.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",f.message||"Unknown"),
this.hkf()}return null}enable(){try{if(!pb.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.jkf();if(!this.s2f())return this.kkf();this.uda.Ygk(this.IG)}catch(f){return ma.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",f.message||"Unknown"),this.hkf()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){switch(f){case 1:return this.vRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 3:return this.vfi();
case 2:return this.Kki()}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}vfi(){return this.disable()}Kki(){return this.enable()}vRa(){this._OnAccess();return null}jkf(){return rc.a(La.a.notImplemented,pb.a.ia(1770))}kkf(){return rc.a(La.a.sharedRuntimeNotAvailable,pb.a.ia(1774))}hkf(){return rc.a(La.a.generalException,pb.a.ia(1765))}s2f(){const f=this.nI.getSharedRuntimeId();return!!f&&0<f.length}}Object(ja.a)(xb,"BeforeDocumentCloseNotification",null,
[]);class ic{constructor(){this.eZe=this.XSe=this.Sz=!1}get enabled(){return this.Sz}set enabled(f){this.Sz=f}get nativeRuntime(){return this.XSe}set nativeRuntime(f){this.XSe=f}get streamingEnabled(){return this.eZe}set streamingEnabled(f){this.eZe=f}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(f){switch(f){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}Object(ja.a)(ic,"CustomFunctionEngineStatus",null,[]);class Rc{constructor(f,G,fa){this.qnh=f;this.rnh=G;this.urh=fa}get status(){const f=new ic;f.enabled=this.qnh;f.streamingEnabled=
this.rnh;f.nativeRuntime=!1;return f}register(f){return OfficeExtension.WacRuntime.Utility.createPromise(this.urh(f))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(f){switch(f){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.Rhk(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}Rhk(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
1,"string");return this.register(G,f)}}Object(ja.a)(Rc,"CustomFunctionManager",null,[]);var Zc=a(1163);class Kd{constructor(f,G,fa,Ya){this.iIe="";this.Hec=0;this.b_=f;this._id=G;this.zs=fa;this.zx=Ya}get id(){return this._id}_RegisterStateChange(){this.Hec||this.b_.execute(f=>{this.iIe=f.$5a(this._id,G=>{this.zx.cxi(this.zs,this._id,JSON.stringify(G))})});this.Hec++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Hec--;this.Hec||this.b_.execute(f=>
{f.Yhe(this._id,this.iIe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(f){switch(f){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 6:return this.wgh();case 7:return this.Cgh()}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}wgh(){return this._RegisterStateChange()}Cgh(){return this._UnregisterStateChange()}}Object(ja.a)(Kd,"LicenseFeature",
null,[]);class fe{constructor(f,G){this.b_=Ab.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.zs=f;this.zx=G;this.kqh=this.zx.Dl.getOsfControl(this.zs)}getFeatureTier(f,G){return OfficeExtension.WacRuntime.Utility.createPromise(fa=>{const Ya=1===G?1:2===G?2:0;this.b_.execute(Kb=>{Kb.getFeatureTier(f,Ya).then(sc=>{fa(this.dPi(sc))},()=>{fa(G)})})})}getLicenseFeature(f){f=new Kd(this.b_,f,this.zs,this.zx);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}isFeatureEnabled(f,
G){return OfficeExtension.WacRuntime.Utility.createPromise(fa=>{this.b_.execute(Ya=>{Ya.isFeatureEnabled(f,G).then(Kb=>{fa(Kb)},()=>{fa(G)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(f=>{this.b_.execute(G=>{G=G.isFreemiumUpsellEnabled();f(G)})})}launchUpsellExperience(f){if(this.kqh.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.b_.execute(G=>{G.launchUpsellExperience(f)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.xmd,
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f,
G){switch(f){case 6:return this.zgh(G)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 2:return this.jLi(G);case 5:return this.cPi(G);case 1:return this.skj(G);case 3:return this.llj();case 4:return this.cwj(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}jLi(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
1,"int");return this.getFeatureTier(G,f)}cPi(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.getLicenseFeature(f)}skj(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"boolean");return this.isFeatureEnabled(G,f)}llj(){return this.isFreemiumUpsellEnabled()}cwj(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.launchUpsellExperience(f)}zgh(f){f=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");this._TestFireStateChangedEvent(f);return null}dPi(f){switch(f){case 1:return 1;case 2:return 2;default:return 0}}}Object(ja.a)(fe,"License",null,[]);class Ld{constructor(){this.tHe=null;this.mXe=this.Bic=this.MN="";this.AYe=!0;this.options=null}get authChallenge(){return this.tHe}set authChallenge(f){this.tHe=f}get correlationId(){return this.MN}set correlationId(f){this.MN=f}get policy(){return null}set policy(f){}get resource(){return this.Bic}set resource(f){this.Bic=
f}get scope(){return this.mXe}set scope(f){this.mXe=f}get silentLogin(){return this.AYe}set silentLogin(f){this.AYe=f}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(f){switch(f){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");
return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,
G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}Object(ja.a)(Ld,"TokenParameters",null,[798]);var Gd=a(198),Zd=a(12);const Bc=(f,G,fa)=>Ya=>(Kb,sc)=>{Qa.TaskExtensions.Xa(jd.GetServiceTaskFactory.create(G.la,279,G.ya,1),Tc=>{Tc=Tc.result;let fd=!1;var ud=fa.Dl.getOsfControl(f);let Td=null;ud&&(Td=ud.getStoreType(),(ud=ud.getManifest())&&ud.getSharedRuntimeForCustomFunctions("Workbook")&&(fd=!0));Qa.TaskExtensions.Xa(Tc.PVf(f,Td,Ya,fd),me=>{Gd.b(me)?
me.result?Kb(null):sc(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.invalidArgument,Zd.a.instance.ia(1769))):sc(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,Zd.a.instance.ia(1765)))},G.ya,3)},G.ya,3)};class Lc{constructor(f){if(!f)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.z4d=f}areShortcutsInUse(f){return OfficeExtension.WacRuntime.Utility.createPromise((G,fa)=>{this.z4d.checkShortcutsInUse(f).then(Ya=>
{G(Ya)}).catch(Ya=>{fa(Ya)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((f,G)=>{this.z4d.getShortcuts().then(fa=>{f(fa)}).catch(fa=>{G(fa)})})}replaceShortcuts(f){return OfficeExtension.WacRuntime.Utility.createPromise((G,fa)=>{this.z4d.replaceShortcuts(f).then(()=>{G(null)}).catch(Ya=>{fa(Ya)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=
this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 3:return this.vJh(G);case 1:return this.HWi();case 2:return this.Fpk(G)}f=
this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}vJh(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"Array<string>");return this.areShortcutsInUse(f)}HWi(){return this.getShortcuts()}Fpk(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"any");return this.replaceShortcuts(f)}}Object(ja.a)(Lc,"ActionService",null,[]);class Cd{constructor(){this.data=null}}Object(ja.a)(Cd,"AugLoopHostMessageReceivedEventArgs",null,[]);var Fd=
a(1263);class te{constructor(f,G,fa){this.zT=f;this.YW=void 0===G?!1:G;this.QW=(void 0===fa?null:fa)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(f){this.YW||Fd.a.Xzk(f)}_RegisterHostMessageReceivedEvent(){this.YW||(te.$Cg||(Fd.a.Ihk(f=>{this.QW.fireEvent("",65542,Object.assign(new Cd,{data:f}))}),te.$Cg=!0),this.QW.register(this.zT,"",65542))}_UnregisterHostMessageReceivedEvent(){this.YW||this.QW.unregister(this.zT,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f,G){switch(f){case 1:return this.Hzk(G);case 2:return this.ugh();case 3:return this.Agh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}Hzk(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");this.sendMessage(f);return null}ugh(){this._RegisterHostMessageReceivedEvent();return null}Agh(){this._UnregisterHostMessageReceivedEvent();return null}}te.$Cg=!1;Object(ja.a)(te,"AugLoopEventService",null,[]);var ye=a(1030),ue=a(967),De=a(125),Ke=a(605);class pe{constructor(f,G,fa){this.sgd=this.CMe=
null;this.zT=f;this.lUe=G;if(this.Ha=fa)this.CMe=this.Ha.Za("GetAccessTokenOAuthFirstPartyAllowList")}oRi(){this.sgd||(this.sgd=Ke.a.ew(Object(ye.a)()));return this.sgd}Blj(f,G){if(!this.lUe||""===this.zT||!this.Ha)return!1;const fa=this.lUe.getOsfControl(this.zT);if(!fa)return!1;let Ya=!1;this.CMe.split(";").forEach(Kb=>{G===Kb&&(Ya=!0)});return 1===ea.AFrameworkApplication.ra.$g.kn&&fa.isFirstParty()&&f===pe.VGh&&Ya&&De.d(fa.getSolutionId())===pe.WGh}getAccessTokenFirstPartyOAuth(f,G){let fa;fa=
this.Blj(f,G)?Ya=>{const Kb=this.oRi();Kb.continueWith(()=>{Kb.result.hE(f,G).then(sc=>{Ya(sc);return sc})})}:Ya=>{Ya(Object.assign(new ue.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(fa)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.xDi(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}xDi(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
1,"string");return this.getAccessTokenFirstPartyOAuth(G,f)}}pe.VGh="Maker";pe.WGh="fa000000043";Object(ja.a)(pe,"Auth",null,[]);var pf=a(1120),qf=a(47),of=a(67);class Ef{constructor(){this.kFa=null}sWi(){this.kFa||(this.kFa=Ke.a.ew(Object(pf.a)()));return this.kFa}getSharedFilePickerResponse(f){return OfficeExtension.WacRuntime.Utility.createPromise((G,fa)=>{try{const Ya=this.sWi();of.Task.WAA.call(null,Ya).continueWith(()=>{const Kb=Ya.result;if(Kb){let sc={};(()=>{let Tc=qf.d(f);({wz:sc}=Tc);return Tc})().returnValue?
Kb.wAc(sc).then(Tc=>{Tc&&0<Tc.length?G(Tc):fa(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Tc=>{fa(Tc)}):fa(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else fa(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Ya){fa(Ya)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.rWi(G)}f=this.invokeMethod(f,
G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}rWi(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.getSharedFilePickerResponse(f)}}Object(ja.a)(Ef,"SharedFilePicker",null,[]);var Nf=a(182);class Kf{ujf(f){return'[data-unique-id="Ribbon-'+f+'"]'}Xtg(f,G){G=JSON.parse(G);if("callout"===G.type)return G.params.target=this.ujf(G.params.target),f.callout(G.params);G.props.target=this.ujf(G.props.target);return G.props}u4j(f){return JSON.parse(f)}addNotification(f,
G){if(!this.YW)return Nf.a.VI().then(fa=>fa.addNotification(this.Xtg(fa,f),this.u4j(G)))}removeNotification(f){if(!this.YW)return Nf.a.VI().then(G=>G.removeNotification(f))}updateNotification(f,G){if(!this.YW)return Nf.a.VI().then(fa=>fa.updateNotification(f,this.Xtg(fa,G)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.Vyh(G);case 3:return this.ukk(G);case 2:return this.N8k(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}Vyh(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");
f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"string");return this.addNotification(G,f)}ukk(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.removeNotification(f)}N8k(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"string");return this.updateNotification(G,f)}}Object(ja.a)(Kf,"NotificationService",null,[]);class Qf{constructor(f){this.Sag=f}execute(f,
G){if(this.Sag){const fa=this.Sag.lookupApi(f);if(fa)return fa.doExecutionAsync(G)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}getTypeName(){return"Microsoft.Office.DispatchApiService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.Zsi(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}Zsi(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
1,"string");return this.execute(G,f)}}Object(ja.a)(Qf,"DispatchApiService",null,[]);class Hf{createInstance(f,G,fa,Ya,Kb,sc){fa=void 0===fa?"":fa;Ya=void 0===Ya?null:Ya;Kb=void 0===Kb?null:Kb;sc=void 0===sc?null:sc;switch(f){case "Microsoft.Office.ActionService":return new Lc(G);case "Microsoft.Office.SharedFilePicker":return new Ef;case "Microsoft.Office.Auth":return new pe(fa,Ya,Kb);case "Microsoft.Office.AugLoopEventService":return new te(fa);case "Microsoft.Office.NotificationService":return new Kf;
case "Microsoft.Office.DispatchApiService":return new Qf(sc)}return null}}Object(ja.a)(Hf,"WacApiHost",null,[]);var If=a(142);class ac{constructor(){this.responseData=null}}Object(ja.a)(ac,"UserFeedbackResponseEventArgs",null,[]);class Yb{constructor(){this.isFeedbackSent=!1}}Object(ja.a)(Yb,"UserFeedbackUIDismissedEventArgs",null,[]);var Cc=a(245);class Of{constructor(f,G,fa,Ya){this.zT=f;this.Tjh=G;this.YW=void 0===fa?!1:fa;this.QW=(void 0===Ya?null:Ya)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(f){this.QW.fireEvent("",
65546,Object.assign(new Yb,{isFeedbackSent:f}))}onError(){}Vti(f){this.QW.fireEvent("",65550,Object.assign(new ac,{responseData:JSON.stringify(f)}))}sRi(f){switch(f){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}tRi(f){switch(f){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}rRi(f){const G={};G.isScenarioEnabled=f.isScenarioEnabled;G.scenarioType=f.scenarioType;if(f=f.question){const fa={};fa.questionUiType=
f.questionUIType;fa.questionUiBehavior=f.questionUiBehavior;fa.questionUiBehaviour=f.questionUiBehaviour;fa.questionInstruction=f.questionInstruction;fa.questionOptions=f.questionOptions;G.questionDetails=fa}return G}YUa(f,G,fa){"True"===fa?f[G]=!0:"False"===fa&&(f[G]=!1)}canCollectUserFeedback(){return ea.AFrameworkApplication.aD}collectUserFeedback(f,G,fa,Ya){if(!this.YW){const Kb={};ea.AFrameworkApplication.fa.Nnd(Kb);const sc=this.Tjh.getContext(Kb);sc.initialFeedbackType=this.sRi(f);sc.uiType=
this.tRi(G);sc.telemetryGroup.featureArea=fa;Ya.v2Config.contextDataFiles&&(sc.isShareContextDataEnabled=!0,sc.getContextData=()=>Promise.all(Cc.a.map(Ya.v2Config.contextDataFiles,Tc=>window.fetch("data:application/octet-stream;base64,"+Tc.base64Data).then(fd=>fd.blob()).then(fd=>new File([fd],Tc.fileName,{type:Tc.fileType})))));(f=Ya.v2Config.scenarioConfig)&&(sc.scenarioConfig=this.rRi(f));this.YUa(sc,"showEmailAddress",Ya.v2Config.isEmailCollectionEnabled);this.YUa(sc,"isFileUploadEnabled",Ya.v2Config.isFileUploadEnabled);
this.YUa(sc,"screenshot",Ya.v2Config.isScreenshotEnabled);this.YUa(sc,"isScreenRecordingEnabled",Ya.v2Config.isScreenRecordingEnabled);this.YUa(sc,"isThankYouPageDisabled",Ya.v2Config.isThankYouPageDisabled);this.YUa(sc,"isHostManagedContextDataEnabled",Ya.v2Config.isHostManagedContextDataEnabled);this.YUa(sc,"isRetrieveFormDataEnabled",Ya.v2Config.isRetrieveFormDataEnabled);sc.hostManagedContextDataExplanationUrl=Ya.v2Config.hostManagedContextDataExplanationUrl;Nf.a.IJf().then(Tc=>{Tc.initializeFeedbackModal(sc,
Object(If.a)(this,this.onDismiss,"onDismiss"),Object(If.a)(this,this.onError,"onError"),Object(If.a)(this,this.Vti,"extractFeedbackDataForHost"));return Tc})}}_RegisterUserFeedbackResponseEvent(){this.YW||this.QW.register(this.zT,"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.YW||this.QW.register(this.zT,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.YW||this.QW.unregister(this.zT,"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.YW||this.QW.unregister(this.zT,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f,G){switch(f){case 27:return this.oTh();case 1:return this.gZh(G);case 28:return this.xgh();case 18:return this.ygh();case 29:return this.Dgh();
case 19:return this.Egh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}oTh(){return this.canCollectUserFeedback()}gZh(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"int"),fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"int"),Ya=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,2,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
3,"object");this.collectUserFeedback(G,fa,Ya,f);return null}xgh(){this._RegisterUserFeedbackResponseEvent();return null}ygh(){this._RegisterUserFeedbackUIDismissedEvent();return null}Dgh(){this._UnregisterUserFeedbackResponseEvent();return null}Egh(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(ja.a)(Of,"UserFeedbackService",null,[]);class Qb{constructor(){this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;
this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(f){switch(f){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;case 8:return this.encryptionType;case 10:return this.hasExtractForUser;
case 9:return this.isDke;case 7:return this.isEnabled;case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 15:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,
"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return;case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,
"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}
Object(ja.a)(Qb,"SensitivityLabelInfo",null,[]);var Ic;(function(f){f[f.pDi=0]="generic";f[f.coherencyFailure=1]="coherencyFailure";f[f.Tpf=2]="disabledByPolicy";f[f.Sll=3]="fileCheckedOut";f[f.Tll=4]="fileEncrypted";f[f.Ull=5]="fileLocked";f[f.Wll=6]="fileNotSupported";f[f.fileTooLarge=7]="fileTooLarge";f[f.Aml=8]="invalidOperationOnZeroByteFile";f[f.Puj=9]="labelDisabled";f[f.Tml=10]="labelErrorRetryLater";f[f.Quj=11]="labelIdNotFound";f[f.Uml=12]="labelIrmDisabledByTenant";f[f.Vml=13]="labelNotSupported";
f[f.jnl=14]="mandatoryConflict";f[f.nnl=15]="minorVersionLimitExceeded"})(Ic||(Ic={}));Object(ja.b)("SetPolicyLabelErrorType",Ic);var hd=a(1264),Ga;(function(f){f[f.fjl=0]="S_APPLYLABEL_OK";f[f.Ogl=2147467259]="E_APPLYLABEL_FAIL";f[f.Vgl=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT";f[f.Ngl=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY";f[f.Pgl=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION";f[f.Qgl=2147205117]="E_APPLYLABEL_LABELDISABLED";f[f.Xgl=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP";f[f.Rgl=
2147205115]="E_APPLYLABEL_LABELING_DISABLED";f[f.Ugl=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE";f[f.Wgl=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE";f[f.Sgl=2147205112]="E_APPLYLABEL_LABELNOTFOUND";f[f.Tgl=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"})(Ga||(Ga={}));Object(ja.b)("TryUpgradeLabelError",Ga);class Ub{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(f){switch(f){case 20:return this.context;
case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");
return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}Object(ja.a)(Ub,"SensitivityLabelChangedEventArgs",null,[]);var yc=a(181),kd=a(126);class Nd{constructor(f,G){this.QW=OfficeExtension.WacRuntime.RichApi.getEventManager();this.zT=f;this.dfc=G}q6(){var f;return null===(f=ea.AFrameworkApplication.fa)||void 0===f?void 0:f.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}ZWb(){var f;return null===
(f=ea.AFrameworkApplication.fa)||void 0===f?void 0:f.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorCasesInOfficeJS",!1)}GYd(){var f;return null===(f=ea.AFrameworkApplication.fa)||void 0===f?void 0:f.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorEventInOfficeJS",!1)}RGd(f,G,fa){const Ya=new Ub;Ya.context=f;Ya.error=G;Ya.newLabel=fa;this.QW.fireEvent("",65549,Ya)}bN(f,G){yc.a.sendTelemetryEvent({name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",
dataFields:kd.a.Pm({["Class"]:"SensitivityService",["ControlId"]:this.zT,["Api"]:f,["Hr"]:G.toString()})})}y_i(f){return f.HasUserDefinedPermissions?2:f.IsEndpointProtectionEnabled?1:0}bCe(f){var G;const fa=new Qb;fa.color=f.Color;fa.description=f.Tooltip;fa.displayName=f.ParentName?f.ParentName+"\\"+f.DisplayName:f.DisplayName;fa.encryptionType=this.y_i(f);fa.hasExtractForUser=f.HasExtractForUser;fa.isDke=!1;fa.isEnabled=f.Enabled;fa.labelId=f.Id;fa.order=f.Order;fa.parentName=f.ParentName;fa.tenantId=
null===(G=ea.AFrameworkApplication.fa)||void 0===G?void 0:G.Za("TenantId");fa.version=0;return fa}iMj(f){const G=new hd.a;G.Id=f.labelId;G.Enabled=f.isEnabled;G.DisplayName=f.displayName;G.Order=f.order;G.Tooltip=f.description;G.IsEndpointProtectionEnabled=1==f.encryptionType||2==f.encryptionType;G.Color=f.color;G.HasUserDefinedPermissions=2==f.encryptionType;G.ParentName=f.parentName;return G}zFk(f){switch(f){case Ic.pDi:return 2147467259;case Ic.Tpf:return 2147205115;case Ic.Quj:return 2147205112;
case Ic.Puj:return 2147205117;default:return 2147467259}}VZf(f){var G;return f.tenantId===(null===(G=ea.AFrameworkApplication.fa)||void 0===G?void 0:G.Za("TenantId"))}getHighestSensitivityLabel(f){return OfficeExtension.WacRuntime.Utility.createPromise((G,fa)=>{var Ya,Kb;if(this.q6())if(!this.ZWb()||null!==(Ya=ea.AFrameworkApplication.fa)&&void 0!==Ya&&Ya.ka("SupportsPolicies"))if(f&&0!=f.length){if(this.ZWb())for(const Tc of f)if(!this.VZf(Tc)){this.bN("getHighestSensitivityLabel",2147647531);fa(2147647531);
return}if(Ya=null===(Kb=this.dfc)||void 0===Kb?void 0:Kb.instance){Kb=[];for(sc of f)Kb=Kb.concat(sc.labelId);var sc=Ya.getHighestSensitivityLabel(Kb);null==sc?(this.bN("getHighestSensitivityLabel",2147205112),fa(2147205112)):G(this.bCe(sc))}else this.bN("getHighestSensitivityLabel",2147942488),fa(2147942488)}else this.bN("getHighestSensitivityLabel",2147942487),fa(2147942487);else this.bN("getHighestSensitivityLabel",2147205115),fa(2147205115);else this.bN("getHighestSensitivityLabel",2147500033),
fa(2147500033)})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((f,G)=>{var fa;if(this.q6()){var Ya=null===(fa=this.dfc)||void 0===fa?void 0:fa.instance;if(Ya){var [Kb,sc]=Ya.FEi();Kb?f(this.bCe(sc)):(this.bN("getLabel",sc),G(sc))}else this.bN("getLabel",2147942488),G(2147942488)}else this.bN("getLabel",2147500033),G(2147500033)})}tryUpgradeLabel(f,G){return OfficeExtension.WacRuntime.Utility.createPromise((fa,Ya)=>{var Kb,sc;if(this.q6())if(!this.ZWb()||null!==(Kb=ea.AFrameworkApplication.fa)&&
void 0!==Kb&&Kb.ka("SupportsPolicies"))if(f)if(this.ZWb()&&!this.VZf(f))this.bN("tryUpgradeLabel",2147205120),this.GYd()&&this.RGd(G,2147205120,f),Ya(2147205120);else if(Kb=null===(sc=this.dfc)||void 0===sc?void 0:sc.instance)if(G="OFFICEJS_SENSITIVITY_CONTEXT_"+G,sc=Kb.tryUpgradeLabel(this.iMj(f),G),0==sc)fa(sc);else{this.bN("tryUpgradeLabel",sc);if(this.GYd()&&(Object.values(Ga).includes(sc)&&this.RGd(G.substring(29),sc,f),2147205105===sc)){fa(0);return}Ya(sc)}else this.bN("tryUpgradeLabel",2147942488),
Ya(2147942488);else this.bN("tryUpgradeLabel",2147942487),Ya(2147942487);else this.bN("tryUpgradeLabel",2147205115),this.GYd()&&this.RGd(G,2147205115,f),Ya(2147205115);else this.bN("tryUpgradeLabel",2147500033),Ya(2147500033)})}_RegisterSensitivityLabelChangedEvent(){var f,G;this.q6()?!this.ZWb()||null!==(f=ea.AFrameworkApplication.fa)&&void 0!==f&&f.ka("SupportsPolicies")?(f=null===(G=this.dfc)||void 0===G?void 0:G.instance)?(f.RHb((fa,Ya)=>{var Kb;fa=new Ub;fa.context=(null===(Kb=Ya.context)||void 0===
Kb?0:Kb.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?Ya.context.substring(29):Ya.context;fa.error=Ya.H1?0:this.zFk(Ya.vQg);fa.newLabel=this.bCe(Ya.ync);this.QW.fireEvent("",65549,fa)}),this.QW.register(this.zT,"",65549)):this.bN("registerSensitivityLabelChangedEvent",2147942488):this.bN("getHighestSensitivityLabel",2147205115):this.bN("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.q6()?this.QW.unregister(this.zT,"",65549):this.bN("unregisterSensitivityLabelChangedEvent",
2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){switch(f){case 16:return this.vgh();
case 17:return this.Bgh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 3:return this.vNi(G);case 1:return this.KOi();case 2:return this.O3k(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}vNi(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(f)}KOi(){return this.getLabel()}O3k(f){const G=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"SensitivityLabelInfo");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"string");return this.tryUpgradeLabel(G,f)}vgh(){this._RegisterSensitivityLabelChangedEvent();return null}Bgh(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(ja.a)(Nd,"SensitivityService",null,[]);class wa{launchSimpleDialog(){return null}getTypeName(){return"Microsoft.Office.ShowSimpleDialog"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.Xvj(G)}f=this.invokeMethod(f,
G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}Xvj(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string"),fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"string"),Ya=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,2,"string"),Kb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,3,"int"),sc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,4,"boolean"),Tc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
5,"string"),fd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,6,"boolean");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,7,"string");return this.launchSimpleDialog(G,fa,Ya,Kb,sc,Tc,fd,f)}}Object(ja.a)(wa,"ShowSimpleDialog",null,[]);var wb=a(999),zc=a(1574),Hc=a(1255),ed=a(1257),rd=a(1253),ve=a(1256);class Le{mQd(f){const G=new Hc.a("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),fa=new ve.a(wb.a.uRi(),"Web","en-Us"),Ya=new ed.a;Ya.Zw=f;zc.a.instance.Yya(G,rd.a.taskpane,
"CopilotHelpTaskpane",fa,Ya)}launchHelpPaneByArticleId(f){this.mQd({SourceControlId:"SearchHelp",query:"AssetID="+f});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(f){this.mQd({SourceControlId:"SearchHelp",query:"AssetID="+f});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(f){this.mQd({SourceControlId:"SearchHelp",query:f});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 2:return this.Evj(G);case 3:return this.Fvj(G);
case 1:return this.Gvj(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}Evj(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"int");return this.launchHelpPaneByArticleId(f)}Fvj(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.launchHelpPaneByArticleIdString(f)}Gvj(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.launchHelpPaneByQuery(f)}}Object(ja.a)(Le,
"CopilotService",null,[]);class Qe{constructor(f,G){this.hideInternal=f;this.showInternal=G}hide(f){this.checkInvalidArgument(f,"caller");return OfficeExtension.WacRuntime.Utility.createPromise((G,fa)=>{this.hideInternal(f).then(G).catch(fa)})}show(f,G){this.checkInvalidArgument(f,"caller");this.checkInvalidArgument(G,"options");return OfficeExtension.WacRuntime.Utility.createPromise((fa,Ya)=>{this.showInternal(f,G).then(fa).catch(Ya)})}getTypeName(){return"Microsoft.Office.BusinessBarService"}checkInvalidArgument(f,
G){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(f))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(G);}invokePropertyGet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 2:return this.F7i(G);case 1:return this.pPk(G)}f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}F7i(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,"string");return this.hide(f)}pPk(f){const G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,
0,"string");f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,1,"BusinessBarShowArgs");return this.show(G,f)}}Object(ja.a)(Qe,"BusinessBarService",null,[]);class Vb{constructor(){this.m_hideCloseButton=!1;this.m_message="";this.m_messageType=0;this.m_title=""}get hideCloseButton(){return this.m_hideCloseButton}set hideCloseButton(f){this.m_hideCloseButton=f}get message(){return this.m_message}set message(f){this.m_message=f}get messageType(){return this.m_messageType}set messageType(f){this.m_messageType=
f}get title(){return this.m_title}set title(f){this.m_title=f}getTypeName(){return"Microsoft.Office.BusinessBarShowArgs"}invokePropertyGet(f){switch(f){case 6:return this.hideCloseButton;case 4:return this.message;case 5:return this.messageType;case 3:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 6:this.hideCloseButton=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"boolean");return;case 4:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 5:this.messageType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,
G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}Object(ja.a)(Vb,"BusinessBarShowArgs",null,[]);var cd;(function(f){f[f.info=0]="info";f[f.error=1]="error";f[f.ZMh=2]="blocked";f[f.lul=3]="severeWarning";f[f.success=4]="success";f[f.warning=5]="warning"})(cd||(cd={}));
Object(ja.b)("BusinessBarType",cd);var Ud=a(662);class re{doExecutionAsync(f){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}Object(ja.a)(re,"DoEchoRichApi",null,[920]);class qe{constructor(f,G,fa,Ya,Kb){this.Mic=this.Hdb=null;this.Ecc=f;this.zs=G;this.zx=fa;this.th=Ya;this.f0e=Kb;this.Mic=new Map;this.Mic.set("Sample.doEcho",new re)}hostName(){return"ExcelOnline"}appId(){return this.Ecc}createInstance(f){switch(f){case "Microsoft.Authentication.AuthenticationService":f=Ab.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory");
var G=this.zx.Dl,fa=this.zs;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(fa=this.zx.kaa(this.zs));return f.create(fa,G);case "Microsoft.Authentication.TokenParameters":return new Ld;case "Microsoft.ExcelServices.CustomFunctionManager":return f=va.EwaSettings.Ra(114),G=va.EwaSettings.Ra(115),new Rc(f,G,Bc(this.Ecc,this.th,this.zx));case "Microsoft.AppRuntime.AppRuntimeService":return new Wb(this.zs,this.zx);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return f=
Ea.d.Aa()?this.zx:hb.a(this.th),new xb(this.Ecc,this.zs,f,this.zx);case "Microsoft.DynamicRibbon.DynamicRibbon":return f=Ea.d.Aa()?this.zx:hb.a(this.th),G=null,G=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?f.YYa(this.zs).io:f.es(this.zs).io,new Zc.DynamicRibbon(this.Ecc,this.zs,this.zx,f,G);case "Microsoft.Office.Licensing.License":return new fe(this.zs,this.zx);case "Microsoft.InternalService.AddinInternalService":return new $a(this.zs);case "Microsoft.Office.AugLoopEventService":const Ya=
Ea.d.Aa()?this.zx:hb.a(this.th);let Kb=null;Kb=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?Ya.YYa(this.zs).io:Ya.es(this.zs).io;G=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Kb.PrimaryMarketplace.SolutionId&&va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.th.ua.DocumentHostInfo.HostTier||"Dogfood"===ea.AFrameworkApplication.hi.AudienceGroup);if(Ud.a(Kb)||G())return f=fd=>(ud,Td,
me)=>{Ya.Xn.eQd({actionType:fd,controlId:ud,messageType:me,targetId:Td,message:""})},f={register:f(1),unregister:f(2),fireEvent:(fd,ud,Td)=>{Ya.Xn.WR(ud,fd)&&Ya.CM(ud,fd,JSON.stringify(Td))}},new te(this.zs,!1,f);break;case "Microsoft.Office.UserFeedbackService":const sc=Ea.d.Aa()?this.zx:hb.a(this.th);let Tc=null;Tc=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?sc.YYa(this.zs).io:sc.es(this.zs).io;G=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Tc.PrimaryMarketplace.SolutionId&&
va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",!1)&&("TestHost"===this.th.ua.DocumentHostInfo.HostTier||"Dogfood"===ea.AFrameworkApplication.hi.AudienceGroup);if(Ud.a(Tc)||G())return f=fd=>(ud,Td,me)=>{sc.Xn.eQd({actionType:fd,controlId:ud,messageType:me,targetId:Td,message:""})},f={register:f(1),unregister:f(2),fireEvent:(fd,ud,Td)=>{sc.Xn.WR(ud,fd)&&sc.CM(ud,fd,JSON.stringify(Td))}},new Of(this.zs,Ab.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),
!1,f);break;case "Microsoft.Office.SensitivityLabelInfo":return new Qb;case "Microsoft.Office.SensitivityService":G=Ea.d.Aa()?this.zx:hb.a(this.th);fa=null;fa=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?G.YYa(this.zs).io:G.es(this.zs).io;if(Ud.a(fa))return new Nd(this.zs,Ab.a.instance.fj("Common.App.Policy.Contracts.IPolicyManager"));break;case "Microsoft.Office.CopilotService":G=Ea.d.Aa()?this.zx:hb.a(this.th);fa=null;fa=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",
!1)?G.YYa(this.zs).io:G.es(this.zs).io;if("9202c06a-b7d3-466f-9adb-acad75789dbc"===fa.PrimaryMarketplace.SolutionId)return new Le;break;case "Microsoft.Office.BusinessBarShowArgs":return new Vb;case "Microsoft.Office.BusinessBarService":G=(Ea.d.Aa()?this.zx:hb.a(this.th)).es(this.zs).io;if(Ud.a(G)){const fd={officeScriptsRunningStatus:64,msFormsDataSyncRunningStatus:69},ud=qa.a.resolve(da.C,{va:1}).catch(Td=>{throw Td;});return new Qe(Td=>Lo(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(fd[Td]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");
(yield ud).removeEntry(fd[Td])}),(Td,me)=>Lo(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(fd[Td]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");me.businessBarType=cd[me.messageType];(yield ud).Hlc(fd[Td],me)}))}break;case "Microsoft.Office.ShowSimpleDialog":G=(Ea.d.Aa()?this.zx:hb.a(this.th)).es(this.zs).io;if(Ud.a(G))return new wa;break;case "Microsoft.Office.DispatchApiService":if(G=this.zx.Dl)if(fa=G.getOsfControl(this.zs),null===fa||void 0===
fa?0:fa.isFirstParty())return this.Hdb||(this.Hdb=new Hf),this.Hdb.createInstance(f,this.f0e,this.zs,G,ea.AFrameworkApplication.fa,this);break;default:if(this.Hdb||(this.Hdb=new Hf),G=this.Hdb.createInstance(f,this.f0e,this.zs,this.zx.Dl,ea.AFrameworkApplication.fa))return G}ma.ULS.sendTraceTag(537163155,0,10,`Typename: ${f} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,La.a.generalException);
}lookupApi(f){if(this.Mic)return this.Mic.get(f)}}Object(ja.a)(qe,"RichApiHost",null,[]);var Se=a(442),Ve=a(32),rf=a(146),sb=a(83),lc=a(41),Uc=a(118),od=a(328),sd=a(103),be=a(44),Ee=a(286),Ie=a(62),bf=a(8),Xe=a(74),Ze=a(1051),tf=a(1435);class ff{constructor(){this.LLe=this.gLe=this.Xra=null;this.ZCb=0}get displayName(){return this.Xra}set displayName(f){this.Xra=f}get email(){return this.gLe}set email(f){this.gLe=f}get federationProvider(){return this.LLe}set federationProvider(f){this.LLe=f}get identityType(){return this.ZCb}set identityType(f){this.ZCb=
f}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(f){switch(f){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}static t6h(f){const G=new ff;G.displayName=f.displayName;G.email=f.email;if(pb.a.isChangeGateEnabled("OfficeVSO:8577366_FixIdentityType"))switch(f.authority){case "MicrosoftAccount":G.identityType=1;break;default:G.identityType=0}else switch(f.authority){case tf.a.Ksg:G.identityType=1;break;default:G.identityType=0}G.federationProvider="";return G}}Object(ja.a)(ff,"OfficeIdentityInfo",
null,[]);class ef{static get suf(){return ef.Xkh}static flb(f){return f in ef.suf?ef.suf[f].toString():f}}ef.Xkh={["GeneralException"]:La.a.generalException,["AccessDenied"]:La.a.xmd,["ApiNotAvailable"]:La.a.knc,["UserNotSignedIn"]:La.a.cBe,["UserAborted"]:La.a.Hzb,["UnsupportedUserIdentity"]:La.a.Q5k,["InvalidResourceUrl"]:La.a.fnb,["InvalidGrant"]:La.a.qFc,["AddinIsAlreadyRequestingToken"]:La.a.wFh,["ResourceNotAllowed"]:La.a.Vsk,["ClientError"]:La.a.Mqc,["ServerError"]:La.a.serverError};ef.map=
null;Object(ja.a)(ef,"SingleSignOnErrorCodeMap",null,[]);class Sf{constructor(f,G){this.fcc=f;this.ZCb=G}get accessToken(){return this.fcc}set accessToken(f){this.fcc=f}get tokenIdenityType(){return this.ZCb}set tokenIdenityType(f){this.ZCb=f}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(f){switch(f){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=
this.invokePropertyGet(f);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f,G){switch(f){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);
}invokeMethodAsync(f,G){f=this.invokeMethod(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}}Object(ja.a)(Sf,"SingleSignOnToken",null,[]);class zf{constructor(f,G){this.rBb=G;this.zs=f}get roamingSettings(){return null}getAccessToken(f){const G=this.rBb.getOsfControl(this.zs),fa=G.getManifest(),Ya=fa.getMarketplaceID();this.nV(f,Ya);return OfficeExtension.WacRuntime.Utility.createPromise((Kb,sc)=>{G.isFirstParty()&&this.rBb._enableFirstPartySSO?this.Rgj(fa,f)?Ab.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(f,
Ya).then(Tc=>{Kb(Tc)},Tc=>{sc(Tc)}):sc(La.a.xmd):sc(La.a.knc)}).then(Kb=>{let sc;switch(Kb.authority){case tf.a.Ksg:sc=1;break;default:sc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Sf(Kb.accessToken,sc))},Kb=>{this.logErrorResponse(f,Ya,Kb);return Kb?OfficeExtension.WacRuntime.Utility.createPromise((sc,Tc)=>{Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(Kb,ef.flb(Kb)))}):OfficeExtension.WacRuntime.Utility.createPromise((sc,Tc)=>{Tc(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,
ef.flb(La.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const f=this.rBb.getOsfControl(this.zs);f.getManifest();const G=f.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((fa,Ya)=>{Ab.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(G).then(Kb=>{fa(Kb)},Kb=>{Ya(Kb.toString())})}).then(fa=>{fa=ff.t6h(fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(fa)},fa=>fa?OfficeExtension.WacRuntime.Utility.createPromise((Ya,
Kb)=>{Kb(OfficeExtension.WacRuntime.Utility.createRichApiException(fa,ef.flb(fa)))}):OfficeExtension.WacRuntime.Utility.createPromise((Ya,Kb)=>{Kb(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,ef.flb(La.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(f){switch(f){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertyGetAsync(f){f=this.invokePropertyGet(f);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}invokePropertySet(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokePropertySetAsync(f,G){this.invokePropertySet(f,G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(f){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(f);}invokeMethodAsync(f,G){switch(f){case 1:return this.yDi(G);case 3:return this.VEi();case 2:return this.kTi()}f=this.invokeMethod(f,
G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(f)}yDi(f){f=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(f,0,Ld);return this.getAccessToken(f)}VEi(){return this.getAuthContext()}kTi(){return this.getPrimaryIdentityInfo()}Rgj(f,G){let fa=!1;const Ya=f.getWebApplicationAuthorizations();f=null;for(const Kb of Ya)if(Kb.getResource().toLowerCase()===G.resource.toLowerCase()){f=Kb;fa=!0;break}if(!fa)return!1;G=G.scope.split(" ,+");for(const Kb of G)if(Kb&&Kb.length){G=
!1;for(const sc of f.getScopes())Kb.toLowerCase()===sc.toLowerCase()&&(G=!0);if(!G)return!1}return!0}nV(f,G){f=this.cgg(f.resource);ma.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:G,["resource"]:f})}logErrorResponse(f,G,fa){f=this.cgg(f.resource);ma.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:G,["resource"]:f,["error"]:fa})}cgg(f){return f.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(ja.a)(zf,"AuthenticationService",null,[]);class sf{create(f,
G){return new zf(f,G)}}Object(ja.a)(sf,"AuthenticationServiceFactory",null,[]);Object(qa.b)(da.yb,{Ek:"singleton"})(f=>Lo(function*(){var G;const fa=yield qa.a.resolve(da.Nb,f),Ya=yield qa.a.resolve(da.xb,f),Kb=yield qa.a.resolve(da.pd,f),sc=yield qa.a.resolve(da.Wb,f),Tc=yield qa.a.resolve(da.fe,f);yield Ze.a(fa.ya,null!==(G=f.va)&&void 0!==G?G:0);yield qa.a.resolve(da.nd,f);Ab.a.instance.register(sf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").yi().Ei(()=>new sf);
return new lf(fa,Ya,Tc,Kb,sc)}));class lf{constructor(f,G,fa,Ya,Kb){this.Bi=this.rangePicker=this.externalLinksManager=null;this.$=f;this.Ai=G;this.Bi=Ya;this.Yk=new Ob(f.ea);this.JJ=new Ue(f,this.Yk);this.Heg=fa;this.txc=new Map;this.externalLinksManager=Kb}get m0(){return this.Yk}dispose(){this.$=this.txc=null}Ri(){return!1}dj(){return!1}executeCommand(f,G,fa){f=G.command;switch(f){case 451041795:this.Yk.lo(fa[vb.a.Wk],fa[vb.a.wfa]);break;case 974713501:this.t3i(fa[vb.a.Wk],fa[vb.a.wfa]);break;
case 1237877382:this.Yk.zE(fa[vb.a.wfa]);break;default:return Ia.a(f)}return of.Task.Ua(!0)}Gi(f,G,fa){if(f=!!fa)switch(G.command){case 974713501:case 1237877382:case 451041795:break;default:f=!1}return f}t3i(f,G){var fa;const Ya=f.DdaMethod;"undefined"===typeof Ya.DispatchId?this.Yk.lo(Jb.a.internalError,G):lf.ijj(f)||this.$.Ij&1?(Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new $b(this.$,this,f,G,this.Bi)).start(this.Ai,f.DdaMethod.ControlId):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?
this.QVi(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.wGk(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(f,this.DKd(f.DdaMethod.ControlId),0,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.nFi(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.LBk(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.mFi(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?
this.fjk(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.hEi(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.o2d(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(f.DdaAddRowsColumns.IsRow=!0,this.d3e(f,G)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(f.DdaAddRowsColumns.IsRow=!1,this.d3e(f,G)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?
this.$ci(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.cXh(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(f.DdaSetBindingFormats.IsSetFormats=!0,this.cOg(f,G)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(f.DdaSetBindingFormats.IsSetFormats=!1,this.cOg(f,G)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(f,f.DdaBindingsMethod.ItemName,f.DdaBindingsMethod.FailOnCollision?2:1,G):Ya.DispatchId===
OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.qLi(G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.C6d(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.aKi(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.bKi(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.hjk(f,G):Ya.DispatchId===
OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(f.DdaMethod.ControlId,f),this.Yk.zE(G)):Ya.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.eGj(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.bGj(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(f,G):Ya.DispatchId===
OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.NMd(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidExecuteFeature?this.executeFeature(f,G):Ya.DispatchId===OSF.DDA.MethodDispId.dispidQueryFeature?this.queryFeature(f,G):this.Yk.lo(Jb.a.kbe,G),va.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Ya.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(G=f.DdaMethod.ControlId,va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&(G=this.Ai.kaa(f.DdaMethod.ControlId)),f=this.Ai.UX(G),G="",f&&(G=mb.DdaFacade.getSolutionId(f,this.$),G=Telemetry.PrivacyRules.GetPrivacyCompliantId(G,f.OwnerAddinStoreType||f.PrimaryMarketplace.MarketplaceType,null===(fa=f.AssetMarketplace)||void 0===fa?void 0:fa.SolutionId,null,null,f.PrimaryMarketplace.MarketplaceRef)),ma.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${Ya.DispatchId}, AppID: ${G}`))):this.Yk.lo(Jb.a.Xqf,G)}nFi(f,G){f.DdaGetBindingData.CoerceType=lf.Zqc(f.DdaGetBindingData.CoerceType);
f.DdaGetBindingData.FilterType=lf.Czf(f.DdaGetBindingData.FilterType);f.DdaGetBindingData.ValueFormat=lf.M8g(f.DdaGetBindingData.ValueFormat);if(this.EJc(f.DdaGetBindingData.CoerceType,G)){if(f.DdaGetBindingData){var fa=f.DdaGetBindingData;0===fa.FilterType&&(fa.FilterType=2);fa.StartCol|=0;fa.StartRow|=0;fa.ColCount=void 0===fa.ColCount?-1:fa.ColCount;fa.RowCount=void 0===fa.RowCount?-1:fa.RowCount}fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&this.Ai.KZ&&(fa=this.Ai.$wa(f.DdaMethod.ControlId));this.JJ.ddaGetBindingData(fa,f.DdaGetBindingData.BindingId,f.DdaGetBindingData.CoerceType,f.DdaGetBindingData.ValueFormat,f.DdaGetBindingData.FilterType,f.DdaGetBindingData.StartRow,f.DdaGetBindingData.StartCol,f.DdaGetBindingData.RowCount,f.DdaGetBindingData.ColCount,Ya=>{if(Yc.a(Ya)||!Ya.Result)this.Yk.xR(Ya,G);else{const Kb=this.Yk.jR();Kb.Data=lf.Uaf(Ya.Result);G(Kb)}},G)}}LBk(f,G){f.DdaSetBindingData.CoerceType=lf.Zqc(f.DdaSetBindingData.CoerceType);
if(this.EJc(f.DdaSetBindingData.CoerceType,G)){var fa=lf.ltd(f.DdaSetBindingData.CoerceType,f.DdaSetBindingData.Data);if(lf.MFc(fa))this.Yk.lo(Jb.a.D2c,G);else{1===fa.CoerceType&&(fa.CellFormat||(fa.CellFormat=f.DdaSetBindingData.CellFormat),fa.TableOptions||(fa.TableOptions=f.DdaSetBindingData.TableOptions));f.DdaSetBindingData&&(f.DdaSetBindingData.StartCol|=0,f.DdaSetBindingData.StartRow|=0);var Ya=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&this.Ai.KZ&&(Ya=this.Ai.$wa(f.DdaMethod.ControlId));this.JJ.ddaSetBindingData(Ya,f.DdaSetBindingData.BindingId,f.DdaSetBindingData.StartRow,f.DdaSetBindingData.StartCol,fa,Kb=>{Yc.a(Kb)?this.Yk.xR(Kb,G):this.Yk.zE(G)},G)}}}QVi(f,G){f.DdaGetBindingData.CoerceType=lf.Zqc(f.DdaGetBindingData.CoerceType);f.DdaGetBindingData.ValueFormat=lf.M8g(f.DdaGetBindingData.ValueFormat);f.DdaGetBindingData.FilterType=lf.Czf(f.DdaGetBindingData.FilterType);if(this.EJc(f.DdaGetBindingData.CoerceType,G)){var fa=
this.DKd(f.DdaMethod.ControlId);fa?this.JJ.ddaGetSelectedData(f.DdaMethod.ControlId,f.DdaGetBindingData.CoerceType,f.DdaGetBindingData.ValueFormat,f.DdaGetBindingData.FilterType,fa,Ya=>{if(Yc.a(Ya))this.Yk.xR(Ya,G);else{const Kb=this.Yk.jR();Kb.Data=lf.Uaf(Ya.Result);G(Kb)}},G):this.Yk.lo(Jb.a.ELf,G)}}aKi(f,G){const fa=f[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],Ya=f[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Kb=f.DdaMethod.ControlId,sc=dc.getInstance(this.$);if(0>=
Ya)ma.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Yk.lo(Jb.a.gfj,G);else if(Ya>dc.yEj)ma.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Yk.lo(Jb.a.QFf,G);else{var Tc=null;switch(fa){case 1:Tc="Compressed";break;case 0:Tc="Text";break;case 2:Tc="Pdf";break;default:ma.ULS.sendTraceTag(537163219,344,15,`Requested file type ${fa} is not supported.`);this.Yk.lo(Jb.a.qzf,G);return}if("Text"===Tc)ma.ULS.sendTraceTag(537163218,
344,15,`Requested file type ${Tc} is not supported.`),this.Yk.lo(Jb.a.qzf,G);else{va.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(f=new Sys.StringBuilder,f.append(Qc.a(this.$,Tc)),"Pdf"===Tc&&ae.a.lr(f,tb.a.Tyg,"WholeWorkbook"),f=f.toString()):f=Qc.a(this.$,Tc);var fd=null,ud=new XMLHttpRequest;ud.onreadystatechange=()=>{if(4===ud.readyState)if(200===ud.status){var Td=ud.response;if(Td){fd=new Uint8Array(Td);Td=this.Yk.jR();var me=fd.length,ne=dc.UJj(),
Me={},Df=0;for(let Gf=0;Gf<me;Gf+=Ya){const Cf=[],xf=Gf+Ya<me?Gf+Ya:me;for(let cg=0,Kg=Gf;Kg<xf;cg++,Kg++)Cf[cg]=fd[Kg];Me[(Df++).toString()]=Cf}Me=new jc(ne,me,Ya,Me);Me=sc.Txh(Kb,Me);Me!==Jb.a.success?this.Yk.lo(Me,G):(Td[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=ne,Td[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=me,ma.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${Tc}, the file size is ${me}`),G(Td))}else ma.ULS.sendTraceTag(537163217,
344,15,`Request is successful, but respone have no data for file type ${Tc}.`),this.Yk.lo(Jb.a.internalError,G)}else 500===ud.status?this.Yk.lo(Jb.a.kCf(parseInt(ud.statusText,10)),G):(ma.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Tc}.`),this.Yk.lo(Jb.a.xJj,G))};ud.open("GET",f,!0);ud.responseType="arraybuffer";ud.setRequestHeader("If-Modified-Since","0");ud.send(null)}}}bKi(f,G){var fa=f[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Ya=f[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];
f=f.DdaMethod.ControlId;(fa=dc.getInstance(this.$).dKi(f,fa))?(fa=fa.cSk,0>Ya||Ya>=Object.keys(fa).length?this.Yk.lo(Jb.a.n$i,G):(Ya=fa[Ya.toString()],fa=this.Yk.jR(),fa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=Ya,fa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=Ya.length,G(fa))):this.Yk.lo(Jb.a.internalError,G)}hjk(f,G){var fa=f[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];f=f.DdaMethod.ControlId;fa=dc.getInstance(this.$).gjk(f,fa);fa===Jb.a.success?
this.Yk.zE(G):this.Yk.lo(fa,G)}wGk(f,G){f.DdaSetBindingData.CoerceType=lf.Zqc(f.DdaSetBindingData.CoerceType);if(this.EJc(f.DdaSetBindingData.CoerceType,G)){var fa=this.DKd(f.DdaMethod.ControlId);if(fa){var Ya=lf.ltd(f.DdaSetBindingData.CoerceType,f.DdaSetBindingData.Data),Kb=ba.f(this.$).ha;1===Ya.CoerceType&&(!Ya.Data&&Kb.qa.t6&&(Ya.Headers||(Ya.Headers=[]),Ya.Headers.length||Ya.Headers.push([]),Ya.Headers[0].length||Ya.Headers[0].push("")),lf.MFc(Ya)||(Ya.CellFormat||(Ya.CellFormat=f.DdaSetBindingData.CellFormat),
Ya.TableOptions||(Ya.TableOptions=f.DdaSetBindingData.TableOptions)));if(lf.MFc(Ya))this.Yk.lo(Jb.a.D2c,G);else{var sc=Kb.qa.jj.clone(),Tc=Kb.qa.activeCell.clone();this.JJ.ddaSetSelectedData(f.DdaMethod.ControlId,fa,Ya,fd=>{var ud;if(Yc.a(fd))this.Yk.xR(fd,G);else{fd=sc.clone();const Td=Ya.Headers?Ya.Headers[0].length:Ya.Data[0].length;1!==Ya.CoerceType||Ya.Data?1===Ya.CoerceType&&(null===(ud=Ya.TableOptions)||void 0===ud?0:ud.length)&&0==Ya.TableOptions[0]?(fd.top+=1,fd.bottom=fd.top+Ya.Data.length-
1):fd.bottom=fd.top+Ya.Data.length-(1===Ya.CoerceType?0:1):fd.bottom=fd.top+1;fd.right=fd.left+Td-1;ud=fd.contains(Tc)?Tc:fd.topLeft;Kb.updateSelection(fd,ud,0);this.Yk.zE(G)}},G)}}else this.Yk.lo(Jb.a.Bdf,G)}}addBinding(f,G,fa,Ya){if(G){var Kb=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.KZ&&(Kb=this.Ai.$wa(f.DdaMethod.ControlId));this.JJ.ddaAddBinding(Kb,f.DdaBindingsMethod.BindingId,f.DdaBindingsMethod.BindingType,G,fa,sc=>
{if(Yc.a(sc))this.Yk.xR(sc,Ya);else{const Tc=this.Yk.jR();Tc.Bindings=Array(1);Tc.Bindings[0]=this.Ai.voc(sc.Result);Ya(Tc)}},Ya)}else this.Yk.lo(Jb.a.Nyk,Ya)}mFi(f,G){let fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.KZ&&(fa=this.Ai.$wa(f.DdaMethod.ControlId));this.JJ.ddaGetBinding(fa,f.DdaBindingsMethod.BindingId,Ya=>{if(Yc.a(Ya)||!Ya.Result)this.Yk.xR(Ya,G);else{const Kb=this.Yk.jR();Kb.Bindings=Array(1);Kb.Bindings[0]=
this.Ai.voc(Ya.Result);G(Kb)}},G)}qLi(f){const G=this.Yk.jR(),fa={};fa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;G[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=fa;f(G)}fjk(f,G){let fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.KZ&&(fa=this.Ai.$wa(f.DdaMethod.ControlId));this.JJ.ddaReleaseBinding(fa,f.DdaBindingsMethod.BindingId,Ya=>{Yc.a(Ya)?this.Yk.xR(Ya,G):this.Yk.zE(G)},
G)}hEi(f,G){let fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.KZ&&(fa=this.Ai.$wa(f.DdaMethod.ControlId));this.JJ.ddaGetAllBindings(fa,Ya=>{if(Yc.a(Ya))this.Yk.xR(Ya,G);else{const Kb=this.Yk.jR();if(Ya.Result){Ya=Ya.Result;Kb.Bindings=Array(Ya.length);for(let sc=0;sc<Ya.length;sc++)Kb.Bindings[sc]=this.Ai.voc(Ya[sc])}else Kb.Bindings=null;G(Kb)}},G)}o2d(f,G){this.JJ.ddaLoadSettings(f.DdaMethod.ControlId,fa=>{if(Yc.a(fa))this.Yk.xR(fa,
G);else{const Ya=this.Yk.jR();Ya.Properties=fa.Result;G(Ya)}},G)}saveSettings(f,G){const fa={Settings:[]};for(let Ya=0;Ya<f.DdaSettingsMethod.Properties.length;Ya++){const Kb={};Kb.Name=f.DdaSettingsMethod.Properties[Ya][0];Kb.Value=f.DdaSettingsMethod.Properties[Ya][1];fa.Settings[Ya]=Kb}this.JJ.ddaSaveSettings(f.DdaMethod.ControlId,fa,f.DdaSettingsMethod.OverwriteIfStale,Ya=>{Yc.a(Ya)?this.Yk.xR(Ya,G):this.Yk.zE(G)},G)}d3e(f,G){const fa=lf.ltd(1,f.DdaAddRowsColumns.Data);lf.MFc(fa)?this.Yk.lo(Jb.a.D2c,
G):this.JJ.ddaAddRowsColumns(f.DdaMethod.ControlId,f.DdaAddRowsColumns.BindingId,f.DdaAddRowsColumns.IsRow,fa,Ya=>{Yc.a(Ya)?this.Yk.xR(Ya,G):this.Yk.zE(G)},G)}$ci(f,G){this.JJ.ddaDeleteAllDataValues(f.DdaMethod.ControlId,f.DdaBindingsMethod.BindingId,fa=>{Yc.a(fa)?this.Yk.xR(fa,G):this.Yk.zE(G)},G)}cXh(f,G){this.JJ.ddaClearBindingFormats(f.DdaMethod.ControlId,f.DdaClearBindingFormats.BindingId,fa=>{Yc.a(fa)?this.Yk.xR(fa,G):this.Yk.zE(G)},G)}cOg(f,G){const fa={},Ya=f.DdaSetBindingFormats.IsSetFormats;
Ya?fa.CellFormat=f.DdaSetBindingFormats.CellFormat:fa.TableOptions=f.DdaSetBindingFormats.TableOptions;this.JJ.ddaSetBindingFormats(f.DdaMethod.ControlId,f.DdaSetBindingFormats.BindingId,fa,Ya,Kb=>{Yc.a(Kb)?this.Yk.xR(Kb,G):this.Yk.zE(G)},G)}executeRichApiRequest(f,G){var fa;const Ya=f.ArrayData,Kb={},sc=ba.f(this.$).ha;if(Ya){if("WacPartition"===Ya[0]){this.Osi(f,G);return}const ne=da.xb.Aa()?this.Ai:Object(xa.a)(mb.DdaFacade,hb.a(this.$));var Tc=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&this.Ai.KZ&&(Tc=this.Ai.kaa(f.DdaMethod.ControlId));"SetOsfControlContainerReadyForCustomFunctions"===Ya[0]&&(Tc=ne.es(Tc))&&(Tc.iIc=!0,Tc.dyg());Kb.HttpMethod=Ya[1];Kb.PathAndQuery=Ya[2];Kb.RequestHeaders=lf.yHf(Ya[3]);Kb.RequestBody=Ya[4];Kb.AppPermission=Ya[5];Tc=Ya[6];Kb.RequestFlags=Tc;var fd=0;if(ra.i(this.$.ma))switch(sc.Ck){case 1:fd=2;break;case 2:fd=3;break;case 64:fd=16;break;case 128:fd=4;break;default:fd=1}var ud=null;sc.$e.sK&&(ud=sc.$e.sK.Wq);Kb.SheetMultiRange=Nb.t(sc.qa.selectedRanges,
this.$);Kb.ActiveCell=Nb.x(sc.qa.activeCell,this.$);Kb.ActiveFloatingObjectId=ud;Kb.SelectionState=fd;fd=null;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)?this.Ai.KZ?(ud=this.Ai.$wa(f.DdaMethod.ControlId),fd=this.Ai.kaa(f.DdaMethod.ControlId),fd=this.Ai.UX(fd),Kb.InstanceId=ud):(fd=this.Ai.UX(f.DdaMethod.ControlId),Kb.InstanceId=fd?fd.InstanceId:""):(fd=this.Ai.UX(f.DdaMethod.ControlId),Kb.InstanceId=fd?fd.InstanceId:"");if(fd&&fd.PrimaryMarketplace){let Me;
if(fd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)Me=fd.PrimaryMarketplace.SolutionId,ud=fd.PrimaryMarketplace.MarketplaceType;else{if(!fd.OwnerAddinSolutionId){ma.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.Yk.lo(Jb.a.OUb,G);return}if(!fd.OwnerAddinStoreType){ma.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Yk.lo(Jb.a.OUb,G);return}Me=fd.OwnerAddinSolutionId;ud=fd.OwnerAddinStoreType}const Df=
Telemetry.PrivacyRules.GetPrivacyCompliantId(Me,ud,null===(fa=fd.AssetMarketplace)||void 0===fa?void 0:fa.SolutionId,null,null,fd.PrimaryMarketplace.MarketplaceRef);Kb.CompliantSolutionId=Df;Kb.SolutionId=Me;Kb.MarketplaceType=ud;Kb.SolutionVersion=fd.PrimaryMarketplace.SolutionVersion;Kb.StoreLocation=fd.PrimaryMarketplace.MarketplaceRef}else Kb.SolutionId=Kb.MarketplaceType="",Kb.CompliantSolutionId="";Kb.IsEventsEnabled=void 0===ne||null===ne||ne.Xn.Mnc(Kb.InstanceId);Kb.RequestGuid=Db.a.create().toString();
fa=Kb.RequestBody.length;if(fa>this.$.ua.ExcelRichApiMaxAllowedRequestPayloadSize){this.Yk.lo(Jb.a.krk,G);ma.ULS.sendTraceTag(537163213,0,50,`Request payload size:${fa} exceeded the limit`);return}va.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Tc&4096&&(fa=new nb(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(fa,fb,Ya),Kb.RequestBody=Ya[4])}const Td=lf.eLf(Kb.RequestHeaders);lf.fce++;const me=Ve.a.ih.si;va.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
Kb&&Kb.RequestBody&&ma.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Kb.RequestBody.length}`);this.JJ.executeRichApiRequest(Kb,ne=>{var Me;this.lNg(me,!0,ne.ServerCorrelationId);let Df=null,Gf=null;var Cf=ne.ServerCorrelationId;if(null===(Me=null===ne||void 0===ne?void 0:ne.Errors)||void 0===Me?0:Me[0])Df=ne.Errors[0].MessageIdName,Gf=ne.Errors[0].Description,Xe.a(this.$).xj.VL(ne.Errors[0].MessageId);if(Yc.a(ne)||!ne.Result)this.Aqb(Cf,Td,"Server error",Df,Gf),this.Yk.xR(ne,
G);else{let cg=null;if(va.EwaSettings.Ra(233))if((Me=ne.Result)&&Me.length){for(let Tg=0;Tg<Me.length;Tg++)if(Me[Tg].RequestGuid===Kb.RequestGuid){cg=Me[Tg];break}cg||this.Yk.xR(ne,G)}else cg=ne.Result;else cg=ne.Result;if(!Df&&cg&&cg.ResponseBody&&cg.ResponseBody[0])if(ne=cg.ResponseBody[0],ne.startsWith('{"Error":')){1<cg.ResponseBody.length&&(ne=ne.substring(0,ne.indexOf("}")+1),ne+="}");try{var xf=rb.a.Rp(ne);xf.Error&&this.Aqb(Cf,Td,"Pipeline error",xf.Error.Code,xf.Error.Message)}catch(Tg){this.Aqb(Cf,
Td,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.Aqb(Cf,Td);else this.Aqb(Cf,Td,"Server error",Df,Gf);const Kg=(Cf=cg.SheetMultiRange)?Cf.SheetName:null;xf=cg.ActiveFloatingObjectId;const fg=cg.SelectionState;ne=5===fg&&!!Cf||6===fg||7===fg||17===fg||8===fg;if(this.$.vh.ME&&ne)this.Yk.lo(Jb.a.f5c,G),ma.ULS.sendTraceTag(537163211,0,50,`${fg.toString()} is not allowed`);else if(5===fg&&Cf){if(this.$.sa&&Kg)if(this.$.sa.Lq(Kg))this.fnd(Kg);else{let Tg=null;Tg=()=>{this.$.sa.Lq(Kg)&&
(ma.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.fnd(Kg),this.$.sa.EUc(Tg))};this.$.sa.jmc(Tg);if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Wh=null;Wh=()=>{this.$.sa.Lq(Kg)&&(this.fnd(Kg),this.$.sa.FAa(Wh))};this.$.sa.Tta(Wh)}}}else if(6===fg||7===fg||17===fg||8===fg||9===fg){if(Cf){const Tg=Nb.h(Cf.Ranges);if(Kg&&Nb.mb(Tg,!0))if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!this.$.sa.Lq(Kg)){let Wh=null;Wh=()=>{this.V6g(sc,Tg,Kg,fg);this.$.sa.FAa(Wh)};this.$.sa.Tta(Wh)}else this.V6g(sc,Tg,Kg,fg)}if(7===fg||17===fg||8===fg)xf="{"+De.e(xf)+"}",sd.a(this.$).yyk(xf);9===fg&&(this.$.ua.ApiCallToSetPageLayout=!0)}cg.PostProcessActions?(Cf=rb.a.Rp(cg.PostProcessActions),this.g8j(Cf).then(()=>{this.kwb(cg,G);this.TGd(f.DdaMethod.ControlId,Kb);return Promise.resolve(null)},Tg=>{this.kwb(cg,G,Tg);return Promise.reject(Tg)})):this.kwb(cg,G)}},ne=>{this.lNg(me,!1,null);this.Aqb(null,
Td,"Web service error");G(ne)})}TGd(f,G){const fa=da.xb.Aa()?this.Ai:Object(xa.a)(mb.DdaFacade,hb.a(this.$));(null===fa||void 0===fa?0:fa.eme)&&fa.es(f)&&lf.ZKk(G.RequestHeaders)&&(ma.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${f}; SolutionId: ${G.SolutionId}.`),fa.eme.fmi(f))}Osi(f,G){var fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Ai.KZ&&(fa=this.Ai.kaa(f.DdaMethod.ControlId));
const Ya=this.Ai.UX(fa),Kb=mb.DdaFacade.getSolutionId(Ya,this.$);var sc=null;sc=mb.DdaFacade.iJa(Ya,this.$);sc=new Rb(sc,this.$);va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Ai.KZ&&(fa=this.Ai.$wa(f.DdaMethod.ControlId));sc=new qe(Kb,fa,this.Ai,this.$,sc);const Tc={ResponseHeaders:[]};Tc.ResponseBody=Array(1);fa=lf.yHf(f.ArrayData[3]);const fd=lf.eLf(fa);fa=new ia(this.$.ua.CreateWorkbookMaxAllowedBase64Size,this.Heg);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(sc,
ab,fa,f.ArrayData).then(ud=>{if(!ud)return this.g3d(!1,"The rich api executor call failed",fd),ma.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Tc.ResponseStatusCode=500,this.kwb(Tc,G),null;this.g3d(!0,"The rich api executor call succeeded",fd);Tc.ResponseStatusCode=ud[0];Tc.ResponseBody[0]=ud[2];this.kwb(Tc,G);return null},ud=>{Tc.ResponseStatusCode=400;Tc.ResponseBody[0]=ud.toString();this.g3d(!1,"The rich api executor call failed",fd);ma.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${Kb}`);
this.kwb(Tc,G);return null})}lNg(f,G,fa){lf.fce--;f=rf.a(Ve.a.ih,f);ma.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${f}, requests pending:${lf.fce}, request result:${G?"success":"false"}, server correlationid: ${fa}.`)}kwb(f,G,fa){fa=void 0===fa?null:fa;const Ya=Array(3);Ya[0]=f.ResponseStatusCode;Ya[1]=lf.xXi(f.ResponseHeaders);const Kb=[];var sc=!1;if(fa&&f.ResponseBody){const Tc=rb.a.Rp(f.ResponseBody.join(""));Tc.Error||(sc={},sc.Error=fa,sc.TraceIds=Tc.TraceIds,
sc.ProcessedResults={},sc.ProcessedResults.Results=Tc.Results,Kb[0]=rb.a.Ci(sc),sc=!0)}Ya[2]=sc?Kb:f.ResponseBody;f=this.Yk.jR();f.Data=Ya;G(f)}C6d(f,G){(new zd(this.$,this.Yk,this.JJ)).C6d(f,G)}eGj(f,G){ma.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const fa=f[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Ya=f[Dc.a.Npd],Kb=f[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];f=this.$.la.lh(232).uib.fGj(f.DdaMethod.ControlId,fa,Ya,Kb);f===Jb.a.success?this.Yk.zE(G):(ma.ULS.sendTraceTag(537163205,
0,10,"MessageParent API Failed!"),this.Yk.lo(f,G))}bGj(f,G){ma.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const fa=f[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],Ya=f[Dc.a.Npd],Kb=f[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],sc=this.$.la.lh(232);let Tc=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(Tc=this.Ai.kaa(f.DdaMethod.ControlId));sc.uib.Izk(Tc,fa,Ya,Kb);this.Yk.zE(G)}getAccessToken(f,G){ma.ULS.sendTraceTag(537163203,
0,50,"GetAccessToken API called!");let fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(fa=this.Ai.kaa(f.DdaMethod.ControlId));const Ya=(Kb,sc)=>{var Tc;if(Kb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Kb=this.Yk.jR(),Kb[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=sc.accessToken,G(Kb);else{sc=this.Ai.UX(fa);const fd=null!==sc.OwnerAddinStoreType?sc.OwnerAddinStoreType:sc.PrimaryMarketplace.MarketplaceType;
ma.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Kb.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(mb.DdaFacade.getSolutionId(sc,this.$),fd,null===(Tc=sc.AssetMarketplace)||void 0===Tc?void 0:Tc.SolutionId,null,null,sc.PrimaryMarketplace.MarketplaceRef),["storeType"]:fd})}.`);this.Yk.lo(Kb,G)}};da.nd.Aa()?void qa.a.resolve(da.nd,{va:1}).then(Kb=>{const sc=this.Ai.Dl,Tc=Xb.getInstance();sa.a.getInstance(sc,Kb,Tc).getAccessToken(fa,!0,f,Ya)}):Qa.TaskExtensions.Xa(jd.GetServiceTaskFactory.create(this.$.la,
137,this.$.ya,1),Kb=>{const sc=this.Ai.Dl,Tc=Xb.getInstance();sa.a.getInstance(sc,Kb.result,Tc).getAccessToken(fa,!0,f,Ya)},this.$.ya)}getAuthContext(f,G){const fa=()=>{var Ya=this.Ai.Dl,Kb=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(Kb=this.Ai.kaa(f.DdaMethod.ControlId));Ya=Ya.getOsfControl(Kb);if(Ya.isFirstParty()){Ya=Ya.getManifest();Kb=Ya.getMarketplaceID();var sc=Ya.getWebApplicationId(),Tc=Ya.getWebApplicationMsaId();Ab.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Kb).then(fd=>
{const ud=this.Yk.jR(),Td={};Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=sc;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||sc;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=fd.upn;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=fd.userId;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=fd.authority;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=xc.a.XEi(fd.authorityType);Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
fd.isAnonymous;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=fd.tenantId;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=fd.supportsAuthToken;ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Td;G(ud)},fd=>{const ud=this.Yk.jR(),Td={},me=new xc.a;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=sc;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Tc||sc;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
me.upn;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=me.userId;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=me.authority;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=me.authorityType;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=me.isAnonymous;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=me.tenantId;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=fd;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
me.supportsAuthToken;ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Td;ud.Error=1;G(ud)})}};da.nd.Aa()?void qa.a.resolve(da.nd,{va:1}).then(()=>{fa()}):Qa.TaskExtensions.Xa(jd.GetServiceTaskFactory.create(this.$.la,137,this.$.ya,1),()=>{fa()},this.$.ya)}NMd(f,G){let fa=f.DdaMethod.ControlId;va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(fa=this.Ai.kaa(f.DdaMethod.ControlId));f=cb.NMd(this.Ai.Dl,fa);f.errorCode===Jb.a.success?(f=Object.assign({},
this.Yk.jR(),f.context),G(f)):this.Yk.lo(f.errorCode,G)}executeFeature(f,G){32===ea.AFrameworkApplication.yh.gl(f[0],2)?G(this.Yk.jR()):this.Yk.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,G)}queryFeature(f,G){f=[32===ea.AFrameworkApplication.yh.gl(f[0],1),!0];f=Object.assign({},this.Yk.jR(),f);G(f)}Uij(f){const G=ba.f(this.$).ha;return 16===G.Ck&&!!G.$e.Lh&&!!G.$e.Lh.floatingObject&&Ad.a.equals(G.$e.Lh.floatingObject.id,f,!0)}DKd(f){const G=ba.f(this.$).ha;return G.qa.Bn?1===G.Ck||this.Uij(f)?
G.vva:null:null}EJc(f,G){return 1!==f&&2!==f&&3!==f?(this.Yk.lo(Jb.a.Rgf,G),!1):!0}g3d(f,G,fa){const Ya={};Ya.a=this.$.ua.UserSessionId;Ya.b=f;Ya.c=G;Ya.d=null;Ya.e=fa;Ie.b().Ll(37,Ya)}Aqb(f,G,fa,Ya,Kb){fa=void 0===fa?null:fa;Ya=void 0===Ya?null:Ya;Kb=void 0===Kb?null:Kb;const sc={};f&&(sc.ServerCorrelationId=f);void 0!==G&&null!==G&&(sc.Source=G);fa&&(sc.ErrorType=fa);Ya&&(sc.MessageId=Ya);Kb&&(sc.StatusDescription=Kb);va.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&Ya&&
"ExternalDataRefreshFailed"===Ya&&(sc.StatusDescription="");ma.ULS.sendTraceTag(50688452,0,50,rb.a.Ci(sc))}g8j(f){let G=new Promise(fa=>{fa(null)});for(let fa=0;fa<f.length;fa++)G=this.f8j(G,f[fa]);return G}f8j(f,G){const fa=this;return Lo(function*(){if(!G)return ma.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),f.then(()=>Promise.reject(lf.Ikb(tc.generalException,Zd.a.instance.ia(1765),null)));switch(G.actionType){case 1:case 2:f=f.then(()=>{const sc=da.xb.Aa()?fa.Ai:Object(xa.a)(mb.DdaFacade,
hb.a(fa.$));if(sc.es(G.controlId))switch(sc.Xn.eQd(G),G.messageType){case 14:case 100:sc.dme.goc(G);break;case 11:case 12:sc.wuk.hJb(G);break;case 51:case 52:sc.uuk.hJb(G);break;case 2101:case 2102:sc.vuk.hJb(G);break;case 2E3:sc.xuk.goc(G);break;case 2201:fa.$.xya&&sc.eme.sKh(G);break;case 2203:sc.yuk.tKh(G);break;case 2700:va.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&sc.cme.goc(G);break;case 65541:sc.bme.rKh(G)}else ma.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${G.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:f=f.then(()=>{fa.U1i(G);return Promise.resolve(null)});break;case 15:va.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(f=f.then(()=>{fa.i4i(G);return Promise.resolve(null)}));break;case 4:f=f.then(()=>{var sc=ba.f(fa.$).ha.qa.activeCell;sc.top!==G.row+1&&sc.left!==G.column+1&&(sc=Nb.x(Aa.Range.vi(G.row+1,G.column+1),fa.$),ba.f(fa.$).np(sc,null,null,null,3,"DdaMethodHandler.ShowCard"));da.H.Aa()?void qa.a.resolve(da.H,{va:0}).then(Tc=>
{Tc.d8a(G.row+1,G.column+1,1,!1,!1)}):xd.a(fa.$,243,242,0,Tc=>{Tc.d8a(G.row+1,G.column+1,1,!1,!1)});return Promise.resolve(null)});break;case 7:f=f.then(()=>{(da.xb.Aa()?fa.Ai:Object(xa.a)(mb.DdaFacade,hb.a(fa.$))).Xn.ftf(G.controlId,G.isEnableEvents);return Promise.resolve(null)});break;case 5:f=f.then(()=>fa.eai(G));break;case 6:f=f.then(()=>fa.i2j(G));break;case 8:f=f.then(()=>{va.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&(da.xb.Aa()?
fa.Ai:Object(xa.a)(mb.DdaFacade,hb.a(fa.$))).bXh();const sc=new Ee.a(bf.a.gq,5,null);be.a(fa.$).Ty(sc);return Promise.resolve(null)});break;case 9:f=f.then(()=>fa.PBk(G));break;case 10:f=f.then(()=>fa.Gel(G));break;case 11:f=f.then(()=>fa.Fel());break;case 12:f=f.then(()=>fa.Cel());break;case 13:f=f.then(()=>fa.Del(G));break;case 14:f=f.then(()=>fa.Eel(G));break;case 16:f=f.then(()=>Promise.resolve(G));break;case 17:f=f.then(()=>fa.Kxk(G,Object(xa.a)(mb.DdaFacade,da.xb.Aa()?fa.Ai:hb.a(fa.$))));break;
case 18:ba.f(fa.$).focus();break;case 19:fa.KOf(G.entryType,!1,G.options);break;case 20:fa.KOf(G.entryType,!0,G.options);break;case 21:const Ya=da.xb.Aa()?fa.Ai:hb.a(fa.$);f=f.then(()=>Ya.bme.w1i(G));break;case 22:const Kb=da.xb.Aa()?fa.Ai:hb.a(fa.$);f=f.then(()=>Kb.bme.x1i(G));break;case 23:(ya.a.QVb(fa.$)||ya.a.$U())&&fa.Ai.AJg.Y4i(G.worksheetId,G.anchorCell,G.values,G.options);break;case 24:(ya.a.QVb(fa.$)||ya.a.$U())&&fa.Ai.AJg.M2i(G.worksheetId);break;default:f=f.then(()=>Promise.reject(lf.Ikb(tc.xHh,
Zd.a.instance.ia(1766),null)))}return f})}i4i(f){var G=(da.xb.Aa()?this.Ai:Object(xa.a)(mb.DdaFacade,hb.a(this.$))).es(f.controlId);if(G&&!(0===f.operationType^!G.mqa)){ba.f(this.$).hUb=!0;switch(f.operationType){case 0:var fa=new od.a(document.createElement("input"));fa.text=f.range;G.bdj(ba.f(this.$).co.z9h(fa,new Se.a(this.$)));G.mqa.startEdit(!0);break;case 1:G.tEg();this.rangePicker=null;break;case 2:G.mqa.k7g(f.range);break;case 3:G.mqa.k7g(f.startingRange);G=f.expandSelection;fa=f.getNextDataRegionCell;
let Ya=0;switch(f.keyboardDirectionValue){case 2:Ya=38;f=G&&fa?105288353:G?-31900117:fa?542791952:137938150;break;case 3:Ya=40;f=G&&fa?-1297307319:G?-1603798598:fa?1713663844:-798660877;break;case 0:Ya=37;f=G&&fa?-403586027:G?2039316657:fa?-2012742350:-1470715894;break;case 1:Ya=39;f=G&&fa?784916030:G?589730764:fa?1324884057:-1231471547;break;default:f=1461300262}G=this.Osc("keydown",Ya,G,fa);ba.f(this.$).Q5b(G,new sb.a(f,1,0,8,null))}ba.f(this.$).hUb=!1}}Osc(f,G,fa,Ya){const Kb=document.createEvent("KeyboardEvent");
if(mc.a.aJ)Kb.initKeyboardEvent(f,!1,!1,window.self,"A",0,Ya,!1,fa,!1);else{let sc="";fa&&(sc+="Shift");Ya&&(sc+=0<sc.length?" Control":"Control");Kb.initKeyboardEvent(f,!1,!1,window.self,"A",0,sc,!1,"en-US")}f=new Sys.UI.DomEvent(Kb);f.keyCode=G;return f}U1i(f){switch(f.operationType){case 1:void qa.a.resolve(da.Wc,{va:0}).then(G=>{G.Vke()});break;case 2:if(f=(da.xb.Aa()?this.Ai:Object(xa.a)(mb.DdaFacade,hb.a(this.$))).es(f.controlId))f.iIc=!0,f.dyg()}}eai(f){const G=f.fileBase64;return G&&G.length>
this.$.ua.CreateWorkbookMaxAllowedBase64Size?Promise.reject(lf.Ikb(tc.invalidArgument,Zd.a.instance.ia(1769),"Application.CreateWorkbook")):(new Promise((fa,Ya)=>{const Kb=new vc.a;Kb.Ph=4;Kb.Oo(ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.GeneralAddInMessageDialogTitle:CommonUIStrings.l_GeneralAddInMessageDialogTitle,ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.NewFileAPIConsentMessage:CommonUIStrings.l_NewFileAPIConsentMessage,1,sc=>{2!==sc&&0!==sc||
Ya(lf.Ikb(tc.fbe,Zd.a.instance.ia(1768),"Application.CreateWorkbook"));sc=new zb("blank","agave",G?"streamBase64":"streamEmpty",G);this.Heg.create(fa,Ya,sc).Khb()})})).then(fa=>{this.txc.set(f.fakeFileId,fa);return Promise.resolve(null)},fa=>fa?Promise.reject(fa):Promise.reject(lf.Ikb(tc.generalException,Zd.a.instance.ia(1765),"Application.CreateWorkbook")))}i2j(f){return new Promise((G,fa)=>{if(this.txc.has(f.fakeFileId)){const Ya=this.txc.get(f.fakeFileId);fa=new vc.a;fa.Ph=4;ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?
fa.Oo(CommonUiStrings.GeneralAddInMessageDialogTitle,CommonUiStrings.OpenWindowConsentMessage,1,Kb=>{1===Kb&&yd.HelperMethods.Cm(Ya,void 0,void 0,"DdaMethodHandler.fileUrl");G(null)}):fa.Oo(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Kb=>{1===Kb&&yd.HelperMethods.Cm(Ya,void 0,void 0,"DdaMethodHandler.fileUrl");G(null)})}else fa(lf.Ikb(tc.generalException,Zd.a.instance.ia(1765),"Document.Open"))})}PBk(f){return new Promise(G=>{(da.xb.Aa()?this.Ai:Object(xa.a)(mb.DdaFacade,
hb.a(this.$))).BJg=f.runtimeCalculationMode;const fa=qa.a.nh(da.Cd);fa&&fa.C7d(3===f.runtimeCalculationMode);G(null)})}Gel(f){ya.a.RXb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.lh(331)).lwb(0,f.urlStr,!0,!0,null);return Promise.resolve(null)}Fel(){ya.a.RXb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.lh(331)).lwb(1,null,!0,!0,null);return Promise.resolve(null)}Cel(){ya.a.RXb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.lh(331)).Yvc();return Promise.resolve(null)}Del(f){ya.a.RXb(this.$)&&
(da.Wb.Aa()?this.externalLinksManager:this.$.la.lh(331)).lwb(5,f.urlStr,!0,!0,null);return Promise.resolve(null)}Eel(f){if(ya.a.RXb(this.$)){const G=da.Wb.Aa()?this.externalLinksManager:this.$.la.lh(331);for(const fa of G.Oma)fa.IsActive&&fa.HostEditUrl&&fa.UrlStr===f.hostEditUrlStr&&yd.HelperMethods.Cm(fa.HostEditUrl,"_blank")}return Promise.resolve(null)}Kxk(f,G){const fa=ub.a.VV;f=rb.a.Rp(f.payload);const Ya={};"eventId"in f&&"payload"in f&&(Ya.eventId=f.eventId,Ya.payload=f.payload);G.CM(2201,
fa,rb.a.Ci(Ya));return Promise.resolve(null)}KOf(f,G,fa){const Ya=qa.a.nh(da.C);Ya&&(f=this.SFi(f))&&(G?Ya.removeEntry(f):Ya.Hlc(f,fa))}SFi(f){switch(f){case 0:return 64;case 1:if(va.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}fnd(f){f=Object(xa.a)(Uc.a,this.$.sa.getItemByName(f));(null===f||void 0===f?0:f.visible)&&f.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}V6g(f,G,fa,Ya){var Kb=f.qa.Fy;const sc=Kb<G.length&&G[Kb].contains(f.qa.activeCell);f=
sc?f.qa.activeCell:G[0].topLeft;Kb=sc?Kb:0;ba.f(this.$).N0(G,Kb,fa,null,f,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===Ya)}static get wbi(){lf.IDa||(lf.IDa={},lf.IDa[Microsoft.Office.WebExtension.CoercionType.Table]=1,lf.IDa[Microsoft.Office.WebExtension.CoercionType.Text]=2,lf.IDa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,lf.IDa[Microsoft.Office.WebExtension.CoercionType.Html]=4,lf.IDa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return lf.IDa}static get zbi(){lf.EBb||
(lf.EBb={},lf.EBb[Microsoft.Office.WebExtension.FilterType.All]=1,lf.EBb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return lf.EBb}static get Abi(){lf.FBb||(lf.FBb={},lf.FBb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,lf.FBb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return lf.FBb}static yHf(f){if(!f||!f.length)return null;const G=Array(f.length/2);for(let fa=0;fa<f.length/2;fa++)G[fa]={},G[fa].Name=f[2*fa],G[fa].Value=f[2*fa+1];return G}static xXi(f){if(!f||
!f.length)return null;const G=Array(2*f.length);for(let fa=0;fa<f.length;fa++)G[2*fa]=f[fa].Name,G[2*fa+1]=f[fa].Value;return G}static lHd(f){if(!f||!f.length)return null;const G=Array(f.length);for(let fa=0,Ya=f.length;fa<Ya;fa++){const Kb=f[fa].length;if(Kb){G[fa]=Array(Kb);for(let sc=0;sc<Kb;sc++)G[fa][sc]=null==f[fa][sc]?null:f[fa][sc].toString()}else return null}return G}static Zqc(f){return"string"===typeof f?lc.a.Lw(lf.wbi,f,0):f}static Czf(f){return"string"===typeof f?lc.a.Lw(lf.zbi,f,0):
f}static M8g(f){return"string"===typeof f?lc.a.Lw(lf.Abi,f,0):f}static ijj(f){switch(f.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static ltd(f,G){const fa={};fa.CoerceType=f;1===fa.CoerceType?(fa.Data=lf.lHd(G.Rows),fa.Headers=lf.lHd(G.Headers)):fa.Data=lf.lHd(G);return fa}static Uaf(f){return 1===f.CoerceType?{["Headers"]:f.Headers,["Rows"]:f.Data}:f.Data}static MFc(f){return 1===f.CoerceType?!f.Data&&!f.Headers:!f.Data}static eLf(f){let G=
"Unknown";if(!f)return G;for(let fa=0;fa<f.length;fa++)if(f[fa].Name.toLowerCase()===tb.a.zuk){G=f[fa].Value;break}return G}static ZKk(f){if(!f)return!1;const G=tb.a.lMj.toLowerCase();for(let fa=0;fa<f.length;fa++)if(f[fa].Name.toLowerCase()===G)return!0;return!1}static Ikb(f,G,fa){const Ya={};Ya.Code=f;Ya.Message=G;Ya.Location=fa;Ya.ActionIndex=0;return Ya}}lf.IDa=null;lf.EBb=null;lf.FBb=null;lf.fce=0;Object(ja.a)(lf,"DdaMethodHandler",null,[43,2]);var Ra=a(210);class Lb{constructor(){this.$$c=this.aad=
this.Hgd=this.Tld=null}get operations(){this.Hgd||(this.Hgd=new Ra.a,this.ni());return this.Hgd}get s4c(){this.Tld||(this.Tld=new Ra.a,this.Sm());return this.Tld}get Vyf(){this.$$c||(this.$$c=new Ra.a);return this.$$c}get featureGates(){this.aad||(this.aad=new Ra.a,this.initializeFeatureGates());return this.aad}Sm(){}initializeFeatureGates(){}Gj(f){this.s4c.add(f)}$h(f){this.operations.contains(f)||this.operations.add(f)}p2e(f){this.Vyf.add(f)}}Object(ja.a)(Lb,"MacroRecorderEventBase",null,[]);class Nc extends Lb{constructor(){super()}get eventId(){return 130}ni(){this.$h(100)}}
Object(ja.a)(Nc,"AccessibilityCheckRunEvent",Lb,[]);class Ed extends Lb{constructor(){super()}get eventId(){return 160}ni(){this.$h(241)}Sm(){this.Gj(f=>f.addToPrintArea)}}Object(ja.a)(Ed,"AddedToPrintAreaEvent",Lb,[]);class Wd extends Lb{constructor(){super()}get eventId(){return 65}ni(){this.$h(516)}}Object(ja.a)(Wd,"AutoFilterToggledEvent",Lb,[]);class $d extends Lb{constructor(){super()}get eventId(){return 118}ni(){this.$h(502)}Sm(){this.Gj(f=>!(f.Hlb().FirstColumn===f.Hlb().LastColumn&&f.Hlb().FirstRow===
f.Hlb().LastRow))}}Object(ja.a)($d,"AutoSumEvent",Lb,[]);class se extends Lb{constructor(){super()}get eventId(){return 223}ni(){this.$h(1032)}}Object(ja.a)(se,"CellImageAltTextAppliedEvent",Lb,[]);class Fa extends Lb{constructor(f,G){super();this.dsa=f;this.Ibl=G}get eventId(){return this.dsa}ni(){this.$h(529);this.$h(594)}Sm(){this.Gj(f=>this.Ibl.includes(f.cNd()))}}Object(ja.a)(Fa,"ChartPropertyAppliedEventBase",Lb,[]);class lb extends Fa{constructor(){super(84,[348,349,350,351,352,353,354,355,
356,357,372,373,374,375])}}Object(ja.a)(lb,"ChartAxisChangedEvent",Fa,[]);class d extends Fa{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(ja.a)(d,"ChartAxisTitleChangedEvent",Fa,[]);class H extends Fa{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(ja.a)(H,"ChartDataLabelsChangedEvent",Fa,[]);class ha extends Fa{constructor(){super(76,[-100])}}Object(ja.a)(ha,"ChartDataSelectedEvent",Fa,[]);class Ta extends Fa{constructor(){super(83,
[500,501,502])}}Object(ja.a)(Ta,"ChartDataTableChangedEvent",Fa,[]);class Mb extends Lb{constructor(){super()}}Object(ja.a)(Mb,"RichApiRequestExecutedEventBase",Lb,[]);class W extends Mb{constructor(){super()}get eventId(){return 117}QK(f){W.sia||(W.sia=new Cb.a(gc.a.zm()),W.sia.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),W.sia.add("fa000000014"));return!!f&&W.sia.contains(f.toLowerCase())}ni(){this.$h(507);this.$h(10);this.$h(576)}Sm(){this.Gj(f=>Object(ka.a)(Id,f)&&(f=Object(xa.a)(Id,f),f.isValid&&
this.QK(f.source))?(ma.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${f.eventId}`),!0):!1)}}W.sia=null;Object(ja.a)(W,"ChartFormatRichApiRequestExecutedEvent",Mb,[]);class eb extends Fa{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(ja.a)(eb,"ChartGridlinesChangedEvent",Fa,[]);class Ib extends Lb{constructor(){super()}get eventId(){return 66}ni(){this.$h(528)}}Object(ja.a)(Ib,"ChartInsertedEvent",Lb,[]);class nc extends Fa{constructor(){super(81,
[100,101,102,103,104,105,106])}}Object(ja.a)(nc,"ChartLegendChangedEvent",Fa,[]);class ta extends Fa{constructor(){super(75,[-101])}}Object(ja.a)(ta,"ChartRowColumnSwitchedEvent",Fa,[]);class ob extends Fa{constructor(){super(79,[0,1,2,-102])}}Object(ja.a)(ob,"ChartTitleChangedEvent",Fa,[]);class cc extends Fa{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(ja.a)(cc,
"ChartTypeChangedEvent",Fa,[]);class qc extends Lb{constructor(){super()}get eventId(){return 131}ni(){this.$h(521)}}Object(ja.a)(qc,"ConnectorFloatingObjectResizedEvent",Lb,[]);class Wc extends Lb{constructor(){super()}get eventId(){return 129}ni(){this.$h(109)}}Object(ja.a)(Wc,"EntitySelectedEvent",Lb,[]);class id extends Lb{constructor(){super()}get eventId(){return 49}ni(){this.$h(149);this.$h(147)}}Object(ja.a)(id,"FindCellEvent",Lb,[]);class Bd extends Lb{constructor(){super()}get eventId(){return 96}ni(){this.$h(122)}}
Object(ja.a)(Bd,"FloatingObjectAltTextAppliedEvent",Lb,[]);class ke extends Lb{constructor(){super()}get eventId(){return 93}ni(){this.$h(522)}}Object(ja.a)(ke,"FloatingObjectDeletedEvent",Lb,[]);class He extends Lb{constructor(){super()}get eventId(){return 94}ni(){this.$h(524)}}Object(ja.a)(He,"FloatingObjectMovedAndResizedEvent",Lb,[]);class Tb extends Lb{constructor(){super()}get eventId(){return 95}ni(){this.$h(523)}}Object(ja.a)(Tb,"FloatingObjectRotatedEvent",Lb,[]);class Xc extends Lb{constructor(){super()}get eventId(){return 100}ni(){this.$h(543)}}
Object(ja.a)(Xc,"GroupDetailsShownOrHiddenEvent",Lb,[]);class Od extends Lb{constructor(){super()}get eventId(){return 154}ni(){this.$h(125)}}Object(ja.a)(Od,"HyperlinksRemovedFromRangeEvent",Lb,[]);class ie extends Mb{constructor(){super()}get eventId(){return 125}QK(f){ie.sia||(ie.sia=new Cb.a(gc.a.zm()),ie.sia.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ie.sia.add("fa000000005"));return!!f&&ie.sia.contains(f.toLowerCase())}ni(){this.$h(507);this.$h(10);this.$h(576)}Sm(){this.Gj(f=>Object(ka.a)(Id,
f)?(f=Object(xa.a)(Id,f),f.isValid&&this.QK(f.source)):!1)}}ie.sia=null;Object(ja.a)(ie,"IdeasRichApiRequestExecutedEvent",Mb,[]);class Oe extends Lb{constructor(){super()}get eventId(){return 136}ni(){this.$h(115)}}Object(ja.a)(Oe,"LinkedEntityConvertedEvent",Lb,[]);class Re extends Lb{constructor(){super()}get eventId(){return 148}ni(){this.$h(114)}}Object(ja.a)(Re,"LinkedEntityDisambiguationPaneToggledEvent",Lb,[]);class hf extends Lb{constructor(){super()}get eventId(){return 127}ni(){this.$h(119)}}
Object(ja.a)(hf,"MovedToEdgeEvent",Lb,[]);class Af extends Lb{constructor(){super()}get eventId(){return 135}ni(){this.$h(191)}}Object(ja.a)(Af,"NamedSheetViewCreatedEvent",Lb,[]);class ig extends Lb{constructor(){super()}get eventId(){return 166}ni(){this.$h(200)}}Object(ja.a)(ig,"NamedSheetViewDeletedEvent",Lb,[]);class xg extends Lb{constructor(){super()}get eventId(){return 133}ni(){this.$h(192)}}Object(ja.a)(xg,"NamedSheetViewExitedEvent",Lb,[]);class jg extends Lb{constructor(){super()}get eventId(){return 162}ni(){this.$h(199)}}
Object(ja.a)(jg,"NamedSheetViewRenamedEvent",Lb,[]);class Wf extends Lb{constructor(){super()}get eventId(){return 167}ni(){this.$h(195)}}Object(ja.a)(Wf,"NamedSheetViewSwitchedEvent",Lb,[]);class gg extends Lb{constructor(){super()}get eventId(){return 99}ni(){this.$h(174)}}Object(ja.a)(gg,"OutlineLevelSetEvent",Lb,[]);class Eg extends Lb{constructor(){super()}get eventId(){return 156}ni(){this.$h(244)}}Object(ja.a)(Eg,"PageBreakInsertedEvent",Lb,[]);class Og extends Lb{constructor(){super()}get eventId(){return 157}ni(){this.$h(245)}}
Object(ja.a)(Og,"PageBreakRemovedEvent",Lb,[]);class Yg extends Lb{constructor(){super()}get eventId(){return 158}ni(){this.$h(246)}}Object(ja.a)(Yg,"PageBreaksAllResetEvent",Lb,[]);class uf extends Lb{constructor(){super()}get eventId(){return 112}ni(){this.$h(503)}Sm(){this.Gj(f=>!!f.pasteParameters.ClientEstimationFloatingObjectId&&2===f.pasteParameters.CopyPasteTargetType&&!f.isFromCurrentSession)}}Object(ja.a)(uf,"PasteArtOtherWorkbookEvent",Lb,[]);class Mf extends Lb{constructor(){super()}get eventId(){return 52}ni(){this.$h(503)}Sm(){this.Gj(f=>
!!f.pasteParameters.ClientEstimationFloatingObjectId&&2===f.pasteParameters.CopyPasteTargetType&&f.isFromCurrentSession)}}Object(ja.a)(Mf,"PasteArtSameWorkbookEvent",Lb,[]);class og extends Lb{constructor(){super()}get eventId(){return 110}ni(){this.$h(204)}}Object(ja.a)(og,"PasteHtmlEvent",Lb,[]);class ih extends Lb{constructor(){super()}get eventId(){return 35}ni(){this.$h(506)}}Object(ja.a)(ih,"PasteRangeEvent",Lb,[]);class tg extends Lb{constructor(){super()}get eventId(){return 111}ni(){this.$h(503)}Sm(){this.Gj(f=>
1===f.pasteParameters.CopyPasteTargetType)}}Object(ja.a)(tg,"PasteShadowWorkbookRangeEvent",Lb,[]);class Pg extends Lb{constructor(){super()}get eventId(){return 42}ni(){this.$h(180)}}Object(ja.a)(Pg,"PasteStringEvent",Lb,[]);class qg extends Lb{constructor(){super()}get eventId(){return 134}ni(){this.$h(220)}}Object(ja.a)(qg,"PendingMergeEvent",Lb,[]);class Na extends Lb{constructor(){super()}get eventId(){return 122}ni(){this.$h(510)}}Object(ja.a)(Na,"PictureInsertedEvent",Lb,[]);class Pa extends Lb{constructor(){super()}get eventId(){return 153}ni(){this.$h(161)}}
Object(ja.a)(Pa,"PivotDrillToggledEvent",Lb,[]);class Oc extends Lb{constructor(f,G){super();this.dsa=f;this.opType=G}get eventId(){return this.dsa}ni(){this.$h(225)}Sm(){this.Gj(f=>f.opType===this.opType)}}Object(ja.a)(Oc,"PivotTableSettingsChangedEventBase",Lb,[]);class ge extends Oc{constructor(){super(171,4)}}Object(ja.a)(ge,"PivotTableAllItemLabelsRepeatedEvent",Oc,[]);class Ae extends Oc{constructor(){super(184,17)}}Object(ja.a)(Ae,"PivotTableAltTextDescriptionChangedEvent",Oc,[]);class Ye extends Oc{constructor(){super(183,
16)}}Object(ja.a)(Ye,"PivotTableAltTextTitleChangedEvent",Oc,[]);class Bf extends Oc{constructor(){super(173,6)}}Object(ja.a)(Bf,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Oc,[]);class Pf extends Oc{constructor(){super(172,5)}}Object(ja.a)(Pf,"PivotTableBlankLineAfterEachItemToggledEvent",Oc,[]);class mg extends Oc{constructor(){super(170,3)}}Object(ja.a)(mg,"PivotTableColumnGrandTotalShownEvent",Oc,[]);class Jf extends Lb{constructor(){super()}get eventId(){return 98}ni(){this.$h(132)}}
Object(ja.a)(Jf,"PivotTableCreatedEvent",Lb,[]);class $f extends Oc{constructor(){super(177,10)}}Object(ja.a)($f,"PivotTableDisplayErrorStringToggledEvent",Oc,[]);class Yf extends Oc{constructor(){super(178,11)}}Object(ja.a)(Yf,"PivotTableDisplayNullStringToggledEvent",Oc,[]);class ng extends Oc{constructor(){super(179,12)}}Object(ja.a)(ng,"PivotTableErrorStringChangedEvent",Oc,[]);class eg extends Oc{constructor(){super(174,7)}}Object(ja.a)(eg,"PivotTableExpandCollapseButtonsShownEvent",Oc,[]);class Ig extends Oc{constructor(){super(187,
20)}}Object(ja.a)(Ig,"PivotTableIndentChangedEvent",Oc,[]);class Ug extends Oc{constructor(){super(176,9)}}Object(ja.a)(Ug,"PivotTableItemsWithNoDataOnColumnsShownEvent",Oc,[]);class Cg extends Oc{constructor(){super(175,8)}}Object(ja.a)(Cg,"PivotTableItemsWithNoDataOnRowsShownEvent",Oc,[]);class eh extends Oc{constructor(){super(186,19)}}Object(ja.a)(eh,"PivotTableLayoutTypeSetEvent",Oc,[]);class Fh extends Oc{constructor(){super(180,13)}}Object(ja.a)(Fh,"PivotTableNullStringChangedEvent",Oc,[]);
class bh extends Lb{constructor(){super()}get eventId(){return 149}ni(){this.$h(219)}}Object(ja.a)(bh,"PivotTablePivotLocationChangedEvent",Lb,[]);class Rg extends Lb{constructor(){super()}get eventId(){return 102}ni(){this.$h(145)}}Object(ja.a)(Rg,"PivotTablePivotedEvent",Lb,[]);class Vg extends Oc{constructor(){super(182,15)}}Object(ja.a)(Vg,"PivotTableRefreshDataOnLoadToggledEvent",Oc,[]);class fh extends Lb{constructor(){super()}get eventId(){return 104}ni(){this.$h(50)}Sm(){this.Gj(f=>!!f.pivotTableId&&
!!f.pivotTableName)}}Object(ja.a)(fh,"PivotTableRefreshedEvent",Lb,[]);class hh extends Oc{constructor(){super(168,1)}}Object(ja.a)(hh,"PivotTableRenamedEvent",Oc,[]);class Gh extends Oc{constructor(){super(169,2)}}Object(ja.a)(Gh,"PivotTableRowGrandTotalShownEvent",Oc,[]);class vh extends Oc{constructor(){super(181,14)}}Object(ja.a)(vh,"PivotTableSaveSourceDataWithFileToggledEvent",Oc,[]);var Hh=a(741);class Zg extends Lb{constructor(){super()}get eventId(){return 155}ni(){this.$h(131)}Sm(){this.Gj(f=>
{f=Object(xa.a)(Hh.a,f);return!!f&&!!f.getFieldName()&&!!f.hierarchyName})}}Object(ja.a)(Zg,"PivotTableSortedEvent",Lb,[]);class pg extends Oc{constructor(){super(185,18)}}Object(ja.a)(pg,"PivotTableSubTotalsVisibilitySettingSetEvent",Oc,[]);class $g extends Lb{constructor(){super()}get eventId(){return 206}ni(){this.$h(560)}}Object(ja.a)($g,"PivotValueFieldSettingAppliedEvent",Lb,[]);class Sg extends Lb{constructor(){super()}get eventId(){return 161}ni(){this.$h(243)}}Object(ja.a)(Sg,"PrintAreaClearedEvent",
Lb,[]);class di extends Lb{constructor(){super()}get eventId(){return 159}ni(){this.$h(241)}Sm(){this.Gj(f=>!f.addToPrintArea)}}Object(ja.a)(di,"PrintAreaSetEvent",Lb,[]);class Wg extends Lb{constructor(){super()}get eventId(){return 57}ni(){this.$h(517)}}Object(ja.a)(Wg,"RangeAutoFilterClearedEvent",Lb,[]);class Fg extends Lb{constructor(f,G){super();this.dsa=f;this.jBe=G}get eventId(){return this.dsa}ni(){this.$h(11)}Sm(){this.Gj(f=>16===f.E0().ValidMembers);this.Gj(f=>f.E0().Font.ValidMembers===
this.jBe)}}Object(ja.a)(Fg,"RangeFontFormattedEventBase",Lb,[]);class zg extends Fg{constructor(){super(3,4)}}Object(ja.a)(zg,"RangeBoldedEvent",Fg,[]);class Ma extends Lb{constructor(){super()}get eventId(){return 2}ni(){this.$h(11)}Sm(){this.Gj(f=>128===f.E0().ValidMembers)}}Object(ja.a)(Ma,"RangeBorderedEvent",Lb,[]);class Pb{}Pb.Hsb="Table";Pb.EQc="Sheet";Object(ja.a)(Pb,"MacroRecorderEventConstants",null,[]);class wc extends Lb{constructor(){super()}get eventId(){return 113}ni(){this.$h(208)}Sm(){this.Gj(f=>
f.getParameters().FilterType===Pb.EQc)}}Object(ja.a)(wc,"RangeCheckedItemsFilteredEvent",Lb,[]);class Pc extends Lb{constructor(){super()}get eventId(){return 109}ni(){this.$h(105)}}Object(ja.a)(Pc,"RangeConditionalFormattingCreatedEvent",Lb,[]);class md extends Lb{constructor(){super()}get eventId(){return 124}ni(){this.$h(221)}}Object(ja.a)(md,"RangeConditionalFormattingRuleDeletedEvent",Lb,[]);class Yd extends Lb{constructor(){super()}get eventId(){return 29}ni(){this.$h(508)}Sm(){this.Gj(f=>3===
f.ED()||1===f.ED()||4===f.ED())}}Object(ja.a)(Yd,"RangeContentClearedEvent",Lb,[]);class oe extends Lb{constructor(){super()}get eventId(){return 40}ni(){this.$h(104)}}Object(ja.a)(oe,"RangeCopiedCutCellsInsertedEvent",Lb,[]);class ca extends Lb{constructor(){super()}get eventId(){return 114}ni(){this.$h(209)}Sm(){this.Gj(f=>f.getParameters().FilterType===Pb.EQc)}}Object(ja.a)(ca,"RangeCustomFilteredEvent",Lb,[]);class Eb extends Lb{constructor(){super()}get eventId(){return 106}ni(){this.$h(121)}}
Object(ja.a)(Eb,"RangeDataValidationChangedEvent",Lb,[]);class Fc extends Fg{constructor(){super(4,64)}}Object(ja.a)(Fc,"RangeDoubleUnderlinedEvent",Fg,[]);class nd extends Lb{constructor(){super()}get eventId(){return 69}ni(){this.$h(190)}}Object(ja.a)(nd,"RangeDuplicatesRemovedEvent",Lb,[]);class he extends Lb{constructor(){super()}get eventId(){return 1}ni(){this.$h(527);this.$h(12)}}Object(ja.a)(he,"RangeEditedEvent",Lb,[]);class Xd extends Lb{constructor(){super()}get eventId(){return 164}ni(){this.$h(255)}Sm(){this.Gj(f=>
4===f.actionType)}}Object(ja.a)(Xd,"RangeExternalLinksBrokeAllLinksEvent",Lb,[]);class Fe extends Lb{constructor(){super()}get eventId(){return 119}ni(){this.$h(255)}Sm(){this.Gj(f=>3===f.actionType)}}Object(ja.a)(Fe,"RangeExternalLinksBrokeLinkEvent",Lb,[]);class jf extends Lb{constructor(){super()}get eventId(){return 205}ni(){this.$h(256)}initializeFeatureGates(){this.p2e("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(ja.a)(jf,"RangeExternalLinksChangeSourceEvent",
Lb,[]);class cf extends Lb{constructor(){super()}get eventId(){return 163}ni(){this.$h(553)}Sm(){this.Gj(f=>1===f.actionType)}}Object(ja.a)(cf,"RangeExternalLinksRefreshedAllEvent",Lb,[]);class wf extends Lb{constructor(){super()}get eventId(){return 77}ni(){this.$h(553)}Sm(){this.Gj(f=>0===f.actionType)}}Object(ja.a)(wf,"RangeExternalLinksRefreshedEvent",Lb,[]);class ag extends Lb{constructor(){super()}get eventId(){return 165}ni(){this.$h(224)}}Object(ja.a)(ag,"RangeExternalLinksSetAutoRefreshEvent",
Lb,[]);class ug extends Lb{constructor(){super()}get eventId(){return 5}ni(){this.$h(11)}Sm(){this.Gj(f=>64===f.E0().ValidMembers)}}Object(ja.a)(ug,"RangeFillColoredEvent",Lb,[]);class vg extends Lb{constructor(){super()}get eventId(){return 59}ni(){this.$h(155)}}Object(ja.a)(vg,"RangeFilledEvent",Lb,[]);class ah extends Lb{constructor(){super()}get eventId(){return 115}ni(){this.$h(176)}Sm(){this.Gj(f=>f.autoFilterOptions.AutoFilterType===Pb.EQc&&!!f.autoFilterOptions.CriteriaType)}}Object(ja.a)(ah,
"RangeFilterAppliedEvent",Lb,[]);class Hg extends Lb{constructor(){super()}get eventId(){return 58}ni(){this.$h(176)}Sm(){this.Gj(f=>f.autoFilterOptions.AutoFilterType===Pb.EQc&&!f.autoFilterOptions.CriteriaType)}}Object(ja.a)(Hg,"RangeFilterClearedEvent",Lb,[]);class We extends Lb{constructor(){super()}get eventId(){return 41}ni(){this.$h(518)}}Object(ja.a)(We,"RangeFilterReappliedEvent",Lb,[]);class Q extends Lb{constructor(){super()}get eventId(){return 86}ni(){this.$h(150)}}Object(ja.a)(Q,"RangeFlashFilledEvent",
Lb,[]);class Ca extends Fg{constructor(){super(6,32)}}Object(ja.a)(Ca,"RangeFontColoredEvent",Fg,[]);class ib extends Fg{constructor(){super(7,8)}}Object(ja.a)(ib,"RangeFontItalicizedEvent",Fg,[]);class kc extends Fg{constructor(){super(8,1)}Sm(){this.Gj(f=>16===f.E0().ValidMembers);this.Gj(f=>1===(f.E0().Font.ValidMembers&1))}}Object(ja.a)(kc,"RangeFontNamedEvent",Fg,[]);class Sc extends Fg{constructor(){super(9,2)}}Object(ja.a)(Sc,"RangeFontSizedEvent",Fg,[]);class ld extends Lb{constructor(){super()}get eventId(){return 74}ni(){this.$h(215)}}
Object(ja.a)(ld,"RangeFormattedAsTableEvent",Lb,[]);class vd extends Lb{constructor(){super()}get eventId(){return 97}ni(){this.$h(188)}}Object(ja.a)(vd,"RangeGroupedOrUngroupedEvent",Lb,[]);class Y extends Lb{constructor(){super()}get eventId(){return 60}ni(){this.$h(11)}Sm(){this.Gj(f=>2===f.E0().ValidMembers)}}Object(ja.a)(Y,"RangeHorizontallyAlignedEvent",Lb,[]);class Ha extends Lb{constructor(){super()}get eventId(){return 43}ni(){this.$h(526)}}Object(ja.a)(Ha,"RangeHyperlinkAppliedEvent",Lb,
[]);class Hb extends Lb{constructor(){super()}get eventId(){return 63}ni(){this.$h(11)}Sm(){this.Gj(f=>256===f.E0().ValidMembers)}}Object(ja.a)(Hb,"RangeIndentChangedEvent",Lb,[]);class Zb extends Lb{constructor(){super()}get eventId(){return 53}ni(){this.$h(156)}Sm(){this.Gj(f=>2===f.ED()||5===f.ED()||6===f.ED()||7===f.ED())}}Object(ja.a)(Zb,"RangeMergedEvent",Lb,[]);class dd extends Lb{constructor(){super()}get eventId(){return 107}ni(){this.$h(216)}}Object(ja.a)(dd,"RangeNamedCellStyleAppliedEvent",
Lb,[]);class Pd extends Lb{constructor(){super()}get eventId(){return 12}ni(){this.$h(11)}Sm(){this.Gj(f=>32===f.E0().ValidMembers)}}Object(ja.a)(Pd,"RangeNumberFormattedEvent",Lb,[]);var de=a(1216);class xe extends Lb{constructor(){super()}get eventId(){return 108}ni(){this.$h(141)}Sm(){this.Gj(f=>Object(ka.a)(de.a,f))}}Object(ja.a)(xe,"RangeSortedEvent",Lb,[]);class Pe extends Fg{constructor(){super(10,128)}}Object(ja.a)(Pe,"RangeStrikedThroughEvent",Fg,[]);class Ne extends Fg{constructor(){super(11,
16)}}Object(ja.a)(Ne,"RangeUnderlinedEvent",Fg,[]);class gf extends Lb{constructor(){super()}get eventId(){return 61}ni(){this.$h(11)}Sm(){this.Gj(f=>1===f.E0().ValidMembers)}}Object(ja.a)(gf,"RangeVerticallyAlignedEvent",Lb,[]);class Lf extends Lb{constructor(){super()}get eventId(){return 62}ni(){this.$h(11)}Sm(){this.Gj(f=>8===f.E0().ValidMembers)}}Object(ja.a)(Lf,"RangeWrapTextToggledEvent",Lb,[]);class Uf extends Lb{constructor(){super()}get eventId(){return 103}ni(){this.$h(51)}}Object(ja.a)(Uf,
"RefreshedAllEvent",Lb,[]);class dg extends Lb{constructor(){super()}get eventId(){return 47}ni(){this.$h(148)}}Object(ja.a)(dg,"ReplaceAllEvent",Lb,[]);class df extends Lb{constructor(){super()}get eventId(){return 226}ni(){this.$h(1025)}}Object(ja.a)(df,"SampleTableCreatedEvent",Lb,[]);class Ff extends Lb{constructor(){super()}get eventId(){return 91}ni(){this.$h(532)}Sm(){this.Gj(f=>95!==f.getShapeType()&&96!==f.getShapeType()&&97!==f.getShapeType()&&98!==f.getShapeType()&&100!==f.getShapeType()&&
102!==f.getShapeType()&&103!==f.getShapeType())}}Object(ja.a)(Ff,"ShapeInsertedEvent",Lb,[]);class Vf extends Lb{constructor(){super()}get eventId(){return 92}ni(){this.$h(531)}}Object(ja.a)(Vf,"ShapeStyleSetEvent",Lb,[]);var Xf=a(1043);class Ag extends Lb{constructor(f,G){super();this.dsa=f;this.jBe=G}get eventId(){return this.dsa}ni(){this.$h(581)}Sm(){this.Gj(f=>Object(ka.a)(Xf.a,f)&&4===f.getShapeTextFormat().ValidMembers);this.Gj(f=>Object(ka.a)(Xf.a,f)&&f.getShapeTextFormat().Font.ValidMembers===
this.jBe)}}Object(ja.a)(Ag,"ShapeTextFontFormattedEventBase",Lb,[]);class ch extends Ag{constructor(){super(193,4)}}Object(ja.a)(ch,"ShapeTextBoldedEvent",Ag,[]);var vf=a(1237);class wh extends Lb{constructor(){super()}get eventId(){return 191}ni(){this.$h(581)}Sm(){this.Gj(f=>Object(ka.a)(vf.a,f))}}Object(ja.a)(wh,"ShapeTextChangedEvent",Lb,[]);class mh extends Ag{constructor(){super(196,32)}}Object(ja.a)(mh,"ShapeTextFontColorChangedEvent",Ag,[]);class Ih extends Ag{constructor(){super(197,1)}}
Object(ja.a)(Ih,"ShapeTextFontNameChangedEvent",Ag,[]);class ph extends Ag{constructor(){super(198,2)}}Object(ja.a)(ph,"ShapeTextFontSizeChangedEvent",Ag,[]);class Xh extends Lb{constructor(){super()}get eventId(){return 199}ni(){this.$h(581)}Sm(){this.Gj(f=>Object(ka.a)(Xf.a,f)&&2===f.getShapeTextFormat().ValidMembers)}}Object(ja.a)(Xh,"ShapeTextHorizontallyAlignedEvent",Lb,[]);class Di extends Ag{constructor(){super(194,8)}}Object(ja.a)(Di,"ShapeTextItalicizedEvent",Ag,[]);class Oi extends Ag{constructor(){super(195,
16)}}Object(ja.a)(Oi,"ShapeTextUnderlinedEvent",Ag,[]);class Yh extends Lb{constructor(){super()}get eventId(){return 200}ni(){this.$h(581)}Sm(){this.Gj(f=>Object(ka.a)(Xf.a,f)&&1===f.getShapeTextFormat().ValidMembers)}}Object(ja.a)(Yh,"ShapeTextVerticallyAlignedEvent",Lb,[]);class Ei extends Lb{constructor(){super()}get eventId(){return 13}ni(){this.$h(138)}}Object(ja.a)(Ei,"SheetAddedEvent",Lb,[]);class Fi extends Lb{constructor(){super()}get eventId(){return 142}ni(){this.$h(237)}Sm(){this.Gj(f=>
!!f.insertDeleteMultiRangeParameters);this.Gj(f=>!f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>{f=f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>f.DeltaColumn&&!f.DeltaRow&&(!!f.InsertDeleteRange.FirstRow||f.InsertDeleteRange.LastRow!==tb.a.eG)||!f.DeltaColumn&&0>f.DeltaRow&&(!!f.InsertDeleteRange.FirstColumn||f.InsertDeleteRange.LastColumn!==tb.a.PE)})}}Object(ja.a)(Fi,"SheetCellsDeletedEvent",Lb,[]);class sh extends Lb{constructor(){super()}get eventId(){return 143}ni(){this.$h(237)}Sm(){this.Gj(f=>
!!f.insertDeleteMultiRangeParameters);this.Gj(f=>!f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>{f=f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<f.DeltaColumn&&!f.DeltaRow&&(!!f.InsertDeleteRange.FirstRow||f.InsertDeleteRange.LastRow!==tb.a.eG)||!f.DeltaColumn&&0<f.DeltaRow&&(!!f.InsertDeleteRange.FirstColumn||f.InsertDeleteRange.LastColumn!==tb.a.PE)})}}Object(ja.a)(sh,"SheetCellsInsertedEvent",Lb,[]);class Gi extends Lb{constructor(){super()}get eventId(){return 139}ni(){this.$h(237)}Sm(){this.Gj(f=>
!!f.insertDeleteMultiRangeParameters);this.Gj(f=>!f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>0>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Gj(f=>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===tb.a.eG)}}Object(ja.a)(Gi,"SheetColumnDeletedEvent",
Lb,[]);class mi extends Lb{constructor(){super()}get eventId(){return 138}ni(){this.$h(237)}Sm(){this.Gj(f=>!!f.insertDeleteMultiRangeParameters);this.Gj(f=>!f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>0<f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Gj(f=>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
tb.a.eG)}}Object(ja.a)(mi,"SheetColumnInsertedEvent",Lb,[]);class Ti extends Lb{constructor(){super()}get eventId(){return 14}ni(){this.$h(137)}}Object(ja.a)(Ti,"SheetDeletedEvent",Lb,[]);class ri extends Lb{constructor(){super()}get eventId(){return 137}ni(){this.$h(185)}}Object(ja.a)(ri,"SheetDirectionChangedEvent",Lb,[]);class ei extends Lb{constructor(){super()}get eventId(){return 54}ni(){this.$h(139)}}Object(ja.a)(ei,"SheetDuplicatedEvent",Lb,[]);class nh extends Lb{constructor(){super()}get eventId(){return 15}ni(){this.$h(207)}}
Object(ja.a)(nh,"SheetNameEditedEvent",Lb,[]);class vi extends Lb{constructor(){super()}get eventId(){return 90}ni(){this.$h(151)}}Object(ja.a)(vi,"SheetPaneFrozenEvent",Lb,[]);class wi extends Lb{constructor(){super()}get eventId(){return 120}ni(){this.$h(226)}}Object(ja.a)(wi,"SheetPrintSettingsSavedEvent",Lb,[]);var Hi=a(1122);class Ph extends Lb{constructor(){super()}get eventId(){return 215}ni(){this.$h(507)}initializeFeatureGates(){this.p2e("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Sm(){this.Gj(f=>
Object.getType(f)===Hi.a)}}Object(ja.a)(Ph,"SheetProtectionPausedResumedEvent",Lb,[]);class bg extends Lb{constructor(){super()}get eventId(){return 64}ni(){this.$h(557)}}Object(ja.a)(bg,"SheetReorderedEvent",Lb,[]);class Mg extends Lb{constructor(){super()}get eventId(){return 141}ni(){this.$h(237)}Sm(){this.Gj(f=>!!f.insertDeleteMultiRangeParameters);this.Gj(f=>!f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Gj(f=>0>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Gj(f=>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===tb.a.PE)}}Object(ja.a)(Mg,"SheetRowDeletedEvent",Lb,[]);class Qh extends Lb{constructor(){super()}get eventId(){return 140}ni(){this.$h(237)}Sm(){this.Gj(f=>!!f.insertDeleteMultiRangeParameters);this.Gj(f=>!f.insertDeleteMultiRangeParameters.IsTableCommand);
this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(f=>0<f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Gj(f=>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===tb.a.PE)}}Object(ja.a)(Qh,"SheetRowInsertedEvent",Lb,[]);class jh extends Lb{constructor(){super()}get eventId(){return 39}ni(){this.$h(135)}}
Object(ja.a)(jh,"SheetRowsColumnsAutoFitEvent",Lb,[]);class Kh extends Lb{constructor(){super()}get eventId(){return 36}ni(){this.$h(136)}}Object(ja.a)(Kh,"SheetRowsColumnsResizedEvent",Lb,[]);class Lh extends Lb{constructor(){super()}get eventId(){return 68}ni(){this.$h(183)}}Object(ja.a)(Lh,"SheetShowGridlinesToggledEvent",Lb,[]);class xi extends Lb{constructor(){super()}get eventId(){return 67}ni(){this.$h(184)}}Object(ja.a)(xi,"SheetShowHeadingsToggledEvent",Lb,[]);class oh extends Lb{constructor(){super()}get eventId(){return 89}ni(){this.$h(213)}}
Object(ja.a)(oh,"SheetSpellCheckedEvent",Lb,[]);class Qd extends Lb{constructor(){super()}get eventId(){return 70}ni(){this.$h(515)}}Object(ja.a)(Qd,"SheetTabColoredEvent",Lb,[]);class we extends Lb{constructor(){super()}get eventId(){return 71}ni(){this.$h(157)}}Object(ja.a)(we,"SheetVisibilityChangedEvent",Lb,[]);class qh extends Lb{constructor(){super()}get eventId(){return 126}ni(){this.$h(239)}}Object(ja.a)(qh,"SheetsVisibilityChangedEvent",Lb,[]);class Jg extends Lb{constructor(){super()}get eventId(){return 188}ni(){this.$h(203)}}
Object(ja.a)(Jg,"SlicerInsertedEvent",Lb,[]);class Ii extends Lb{constructor(){super()}get eventId(){return 189}ni(){this.$h(173)}Sm(){this.Gj(f=>!f.clearFilter)}}Object(ja.a)(Ii,"SlicerSelectionAppliedEvent",Lb,[]);class yi extends Lb{constructor(){super()}get eventId(){return 190}ni(){this.$h(173)}Sm(){this.Gj(f=>f.clearFilter)}}Object(ja.a)(yi,"SlicerSelectionClearedEvent",Lb,[]);class Bh extends Lb{constructor(){super()}get eventId(){return 27}ni(){this.$h(208)}Sm(){this.Gj(f=>f.getParameters().FilterType===
Pb.Hsb)}}Object(ja.a)(Bh,"TableCheckedItemsFilteredEvent",Lb,[]);class Ji extends Lb{constructor(){super()}get eventId(){return 144}ni(){this.$h(237)}Sm(){this.Gj(f=>!!f.insertDeleteMultiRangeParameters);this.Gj(f=>f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>0>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ja.a)(Ji,"TableColumnDeletedEvent",Lb,[]);class Mh extends Lb{constructor(){super()}get eventId(){return 145}ni(){this.$h(237)}Sm(){this.Gj(f=>
!!f.insertDeleteMultiRangeParameters);this.Gj(f=>f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>0<f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ja.a)(Mh,"TableColumnInsertedEvent",Lb,[]);var Ki=a(1215);class Zh extends Lb{constructor(){super()}get eventId(){return 121}ni(){this.$h(141)}Sm(){this.Gj(f=>Object(ka.a)(Ki.a,f))}}Object(ja.a)(Zh,"TableColumnSortedEvent",
Lb,[]);class th extends Lb{constructor(){super()}get eventId(){return 105}ni(){this.$h(193)}}Object(ja.a)(th,"TableConvertedToRangeEvent",Lb,[]);class lj extends Lb{constructor(){super()}get eventId(){return 16}ni(){this.$h(206)}}Object(ja.a)(lj,"TableCreatedEvent",Lb,[]);class Qi extends Lb{constructor(){super()}get eventId(){return 30}ni(){this.$h(209)}Sm(){this.Gj(f=>f.getParameters().FilterType===Pb.Hsb)}}Object(ja.a)(Qi,"TableCustomFilteredEvent",Lb,[]);var hi=a(1556);class Lg extends Lb{constructor(){super()}get eventId(){return 25}ni(){this.$h(187)}Sm(){this.Gj(f=>
f.options.OperationType===hi.d.CustomSort)}}Object(ja.a)(Lg,"TableCustomSortedEvent",Lb,[]);class xh extends Lb{constructor(){super()}get eventId(){return 28}ni(){this.$h(176)}Sm(){this.Gj(f=>f.autoFilterOptions.AutoFilterType===Pb.Hsb);this.Gj(f=>0===f.autoFilterOptions.CriteriaType)}}Object(ja.a)(xh,"TableFilterClearedEvent",Lb,[]);class bj extends Lb{constructor(){super()}get eventId(){return 32}ni(){this.$h(176)}Sm(){this.Gj(f=>f.autoFilterOptions.AutoFilterType===Pb.Hsb);this.Gj(f=>{const G=
new Ra.a;G.add(1);G.add(2);G.add(8);G.add(9);G.add(10);G.add(11);G.add(12);G.add(13);G.add(14);G.add(15);G.add(16);G.add(17);G.add(18);G.add(19);G.add(20);G.add(21);G.add(22);G.add(23);G.add(24);G.add(25);G.add(26);G.add(27);G.add(28);G.add(29);G.add(30);G.add(31);G.add(32);G.add(33);G.add(34);G.add(35);G.add(36);G.add(37);G.add(38);G.add(39);return G.contains(f.autoFilterOptions.CriteriaType)})}}Object(ja.a)(bj,"TableItemFilteredEvent",Lb,[]);class yh extends Lb{constructor(){super()}get eventId(){return 101}ni(){this.$h(217)}}
Object(ja.a)(yh,"TableRenamedEvent",Lb,[]);class zi extends Lb{constructor(){super()}get eventId(){return 73}ni(){this.$h(211)}}Object(ja.a)(zi,"TableResizedEvent",Lb,[]);class Ch extends Lb{constructor(){super()}get eventId(){return 44}ni(){this.$h(514)}}Object(ja.a)(Ch,"TableRowColumnRearrangedEvent",Lb,[]);class zh extends Lb{constructor(){super()}get eventId(){return 146}ni(){this.$h(237)}Sm(){this.Gj(f=>!!f.insertDeleteMultiRangeParameters);this.Gj(f=>f.insertDeleteMultiRangeParameters.IsTableCommand);
this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(f=>0>f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ja.a)(zh,"TableRowDeletedEvent",Lb,[]);class Th extends Lb{constructor(){super()}get eventId(){return 147}ni(){this.$h(237)}Sm(){this.Gj(f=>!!f.insertDeleteMultiRangeParameters);this.Gj(f=>f.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(f=>!f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Gj(f=>0<f.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ja.a)(Th,"TableRowInsertedEvent",Lb,[]);class Rh extends Lb{constructor(){super()}get eventId(){return 26}ni(){this.$h(177)}Sm(){this.Gj(f=>f.autoFilterOptions.AutoFilterType===Pb.Hsb)}}Object(ja.a)(Rh,"TableSortedEvent",Lb,[]);class mj extends Lb{constructor(){super()}get eventId(){return 87}ni(){this.$h(212)}}Object(ja.a)(mj,"TableStyleAppliedEvent",Lb,[]);class Rf extends Lb{constructor(){super()}get eventId(){return 88}ni(){this.$h(196)}}
Object(ja.a)(Rf,"TableStyleOptionToggledEvent",Lb,[]);class ii extends Lb{constructor(){super()}get eventId(){return 31}ni(){this.$h(210)}Sm(){this.Gj(f=>f.getParameters().FilterType===Pb.Hsb)}}Object(ja.a)(ii,"TableTop10FilteredEvent",Lb,[]);class Xg extends Lb{constructor(){super()}get eventId(){return 207}ni(){this.$h(238)}}Object(ja.a)(Xg,"TextToColumnsEvent",Lb,[]);class dh extends Lb{constructor(){super()}get eventId(){return 128}ni(){this.$h(559)}}Object(ja.a)(dh,"ValuesSortedEvent",Lb,[]);
class kh extends Lb{constructor(){super()}get eventId(){return 55}ni(){this.$h(197)}}Object(ja.a)(kh,"WorkbookCalculationModeSetEvent",Lb,[]);class ni extends Lb{constructor(){super()}get eventId(){return 34}ni(){this.$h(181)}Sm(){this.Gj(f=>!!f.parentCommentId)}}Object(ja.a)(ni,"WorkbookCommentRepliedEvent",Lb,[]);class Uh extends Lb{constructor(){super()}get eventId(){return 33}ni(){this.$h(181)}Sm(){this.Gj(f=>!f.parentCommentId)}}Object(ja.a)(Uh,"WorkbookCommentedEvent",Lb,[]);class Ui extends Lb{constructor(){super()}get eventId(){return 56}ni(){this.$h(128)}}
Object(ja.a)(Ui,"WorkbookRecalculatedEvent",Lb,[]);class ji extends Lb{constructor(){super()}get eventId(){return 46}ni(){this.$h(171)}}Object(ja.a)(ji,"WorkbookRedoEvent",Lb,[]);class Vi extends Lb{constructor(){super()}get eventId(){return 45}ni(){this.$h(170);this.$h(1033)}}Object(ja.a)(Vi,"WorkbookUndoEvent",Lb,[]);class cj extends Lb{constructor(){super()}get eventId(){return 116}ni(){this.$h(507);this.$h(576);this.$h(10)}Sm(){this.Gj(f=>{if(Object(ka.a)(Id,f)&&(f=Object(xa.a)(Id,f),void 0!==
f.source&&null!==f.source&&void 0!==f.eventId&&null!==f.eventId))return ma.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${f.source}; eventId: ${f.eventId}.`),!0;ma.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(ja.a)(cj,"DefaultRichApiRequestExecutedEvent",Lb,[]);class oi extends Lb{constructor(){super()}get eventId(){return 216}ni(){this.$h(1022)}}Object(ja.a)(oi,"TablelAltTextEditedEvent",
Lb,[]);class $h extends Lb{constructor(){super()}get eventId(){return 217}ni(){this.$h(263)}}Object(ja.a)($h,"FloatingObjectZOrderChangedEvent",Lb,[]);var nj=a(1236);class dj extends Lb{constructor(){super()}get eventId(){return 192}ni(){this.$h(507)}Sm(){this.Gj(f=>Object(ka.a)(nj.a,f)?!0:!1)}}Object(ja.a)(dj,"VisualPropertySetEvent",Lb,[]);class Ai extends Fa{constructor(){super(219,[510])}}Object(ja.a)(Ai,"ChartSeriesDeletedEvent",Fa,[]);class ai extends Lb{get eventId(){return 220}ni(){this.$h(1027)}}
Object(ja.a)(ai,"ChartDataChangedEvent",Lb,[]);class ej extends Fa{constructor(){super(221,[512])}}Object(ja.a)(ej,"ChartSeriesDataChangedEvent",Fa,[]);class Wi extends Lb{constructor(){super()}get eventId(){return 225}ni(){this.$h(269)}}Object(ja.a)(Wi,"FloatingObjectPutFloatingImageInCellEvent",Lb,[]);class $e extends Lb{constructor(){super()}get eventId(){return 224}ni(){this.$h(268)}}Object(ja.a)($e,"ImageInCellConvertToFloatingObjectEvent",Lb,[]);class uh{constructor(f){this.Bh=null;this.$=f}get macroRecorderEvents(){this.Bh||
(this.Bh=new Ra.a,this.Bh.add(new he),this.Bh.add(new Ma),this.Bh.add(new zg),this.Bh.add(new Fc),this.Bh.add(new ug),this.Bh.add(new Ca),this.Bh.add(new ib),this.Bh.add(new kc),this.Bh.add(new Sc),this.Bh.add(new Pe),this.Bh.add(new Ne),this.Bh.add(new Pd),this.Bh.add(new Ei),this.Bh.add(new Ti),this.Bh.add(new nh),this.Bh.add(new lj),this.Bh.add(new Ji),this.Bh.add(new Mh),this.Bh.add(new zh),this.Bh.add(new Th),this.Bh.add(new mi),this.Bh.add(new Gi),this.Bh.add(new Qh),this.Bh.add(new Mg),this.Bh.add(new Lg),
this.Bh.add(new Rh),this.Bh.add(new Bh),this.Bh.add(new xh),this.Bh.add(new Yd),this.Bh.add(new Qi),this.Bh.add(new ii),this.Bh.add(new bj),this.Bh.add(new Uh),this.Bh.add(new ni),this.Bh.add(new ih),this.Bh.add(new Kh),this.Bh.add(new Fi),this.Bh.add(new sh),this.Bh.add(new jh),this.Bh.add(new oe),this.Bh.add(new We),this.Bh.add(new Ha),this.Bh.add(new Pg),this.Bh.add(new Ch),this.Bh.add(new ji),this.Bh.add(new Vi),this.Bh.add(new dg),this.Bh.add(new id),this.Bh.add(new Mf),this.Bh.add(new Zb),this.Bh.add(new ei),
this.Bh.add(new kh),this.Bh.add(new Ui),this.Bh.add(new Wg),this.Bh.add(new Hg),this.Bh.add(new vg),this.Bh.add(new Y),this.Bh.add(new gf),this.Bh.add(new Lf),this.Bh.add(new Hb),this.Bh.add(new bg),this.Bh.add(new Wd),this.Bh.add(new Ib),this.Bh.add(new xi),this.Bh.add(new Lh),this.Bh.add(new nd),this.Bh.add(new we),this.Bh.add(new Qd),this.Bh.add(new zi),this.Bh.add(new ld),this.Bh.add(new ta),this.Bh.add(new ha),this.Bh.add(new wf),this.Bh.add(new se),this.Bh.add(new cc),this.Bh.add(new ob),this.Bh.add(new d),
this.Bh.add(new nc),this.Bh.add(new H),this.Bh.add(new Ta),this.Bh.add(new lb),this.Bh.add(new eb),this.Bh.add(new Q),this.Bh.add(new mj),this.Bh.add(new Rf),this.Bh.add(new oh),this.Bh.add(new vi),this.Bh.add(new Ff),this.Bh.add(new Vf),this.Bh.add(new ke),this.Bh.add(new He),this.Bh.add(new Tb),this.Bh.add(new Bd),this.Bh.add(new vd),this.Bh.add(new Jf),this.Bh.add(new gg),this.Bh.add(new Xc),this.Bh.add(new yh),this.Bh.add(new Rg),this.Bh.add(new Uf),this.Bh.add(new fh),this.Bh.add(new th),this.Bh.add(new Eb),
this.Bh.add(new dd),this.Bh.add(new xe),this.Bh.add(new Pc),this.Bh.add(new og),this.Bh.add(new tg),this.Bh.add(new uf),this.Bh.add(new wc),this.Bh.add(new ca),this.Bh.add(new ah),this.Bh.add(new $d),this.Bh.add(new Na),this.Bh.add(new Fe),this.Bh.add(new wi),this.Bh.add(new Zh),this.Bh.add(new md),this.Bh.add(new qh),this.Bh.add(new hf),this.Bh.add(new dh),this.Bh.add(new Wc),this.Bh.add(new Nc),this.Bh.add(new qc),this.Bh.add(new xg),this.Bh.add(new qg),this.Bh.add(new Af),this.Bh.add(new Oe),this.Bh.add(new ri),
this.Bh.add(new Re),this.Bh.add(new bh),this.Bh.add(new Pa),this.Bh.add(new Od),this.Bh.add(new Zg),this.Bh.add(new Eg),this.Bh.add(new Og),this.Bh.add(new Yg),this.Bh.add(new di),this.Bh.add(new Ed),this.Bh.add(new Sg),this.Bh.add(new jg),this.Bh.add(new cf),this.Bh.add(new Xd),this.Bh.add(new ag),this.Bh.add(new ig),this.Bh.add(new Wf),this.Bh.add(new hh),this.Bh.add(new Gh),this.Bh.add(new mg),this.Bh.add(new ge),this.Bh.add(new Pf),this.Bh.add(new Bf),this.Bh.add(new eg),this.Bh.add(new Cg),this.Bh.add(new Ug),
this.Bh.add(new $f),this.Bh.add(new Yf),this.Bh.add(new ng),this.Bh.add(new Fh),this.Bh.add(new vh),this.Bh.add(new Vg),this.Bh.add(new Ye),this.Bh.add(new Ae),this.Bh.add(new pg),this.Bh.add(new eh),this.Bh.add(new Ig),this.Bh.add(new Jg),this.Bh.add(new Ii),this.Bh.add(new yi),this.Bh.add(new wh),this.Bh.add(new ch),this.Bh.add(new Di),this.Bh.add(new Oi),this.Bh.add(new mh),this.Bh.add(new Ih),this.Bh.add(new ph),this.Bh.add(new Xh),this.Bh.add(new Yh),this.Bh.add(new jf),this.Bh.add(new $g),this.Bh.add(new Xg),
this.Bh.add(new Ph),this.Bh.add(new oi),this.Bh.add(new $h),this.Bh.add(new dj),this.Bh.add(new Ai),this.Bh.add(new ej),this.Bh.add(new ai),this.Bh.add(new $e),this.Bh.add(new Wi),this.Bh.add(new df),va.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Pjk());return this.Bh}PIf(f,G){let fa=this.QIf(f,this.macroRecorderEvents,G);fa||(fa=this.QIf(f,uh.b0i(),G),!fa&&this.q0f(f,uh.jof,G)&&(fa=uh.jof));return fa}QIf(f,G,fa){const Ya=new Ra.a;for(const Kb of G)this.q0f(f,Kb,
fa)&&Ya.add(Kb);return 1===Ya.count?Ya.na(0):1<Ya.count?uh.lFi(Ya):null}q0f(f,G,fa){const Ya=uh.q2j(f,G);return fa?Ya&&uh.zcl(f,G):Ya}Pjk(){const f=new Ra.a;for(const G of this.Bh){let fa=!1;for(const Ya of G.featureGates)if(!va.EwaSettings.Ra(Ya)){f.add(G);fa=!0;break}if(!fa)for(const Ya of G.Vyf)if(!va.EwaSettings.getBooleanFeatureGate(Ya,!1)){f.add(G);break}}for(const G of f)this.Bh.remove(G)}static b0i(){uh.KZb||(uh.KZb=new Ra.a,uh.KZb.add(new W),uh.KZb.add(new ie));return uh.KZb}static q2j(f,
G){return G.operations.contains(f.operation)}static zcl(f,G){G=G.s4c;if(!G.count)return!0;let fa=!0;for(const Ya of G)if(!Ya(f.payload)){fa=!1;break}return fa}static lFi(f){let G=f.na(0);for(const fa of f)fa.s4c.count>G.s4c.count&&(G=fa);return G}}uh.KZb=null;uh.jof=new cj;Object(ja.a)(uh,"MacroRecorderEventList",null,[]);var fj=a(694);class oj{constructor(){this.DAb=null}get aMh(){this.DAb||(this.DAb=new Ra.a,this.DAb.add(12),this.DAb.add(11));return this.DAb}Vgj(f){return this.aMh.contains(f.operation)}i4k(f){const G=
[],fa=f.payload;for(const Ya of fa.batchedOperations)G.push(new fj.a(f.operation,Ya));return G}}Object(ja.a)(oj,"MacroRecorderBatchedEventList",null,[]);var Xi=a(119);class si{equals(f,G){return f===G}getHashCode(f){return f}Qwa(f){return f}}Object(ja.a)(si,"UserOperationNameComparer",null,[128,129]);class nf{static h0i(){nf.Yi||(nf.Yi=new Cb.a(new si),nf.Yi.add(507),nf.Yi.add(10),nf.Yi.add(576),nf.Yi.add(563),nf.Yi.add(564),nf.Yi.add(565),nf.Yi.add(566),nf.Yi.add(567),nf.Yi.add(568),nf.Yi.add(569),
nf.Yi.add(570),nf.Yi.add(571),nf.Yi.add(572),nf.Yi.add(573),nf.Yi.add(574),nf.Yi.add(575),nf.Yi.add(501),nf.Yi.add(520),nf.Yi.add(1),nf.Yi.add(1002),nf.Yi.add(129),nf.Yi.add(198),nf.Yi.add(500),nf.Yi.add(519),nf.Yi.add(538),nf.Yi.add(1E3),nf.Yi.add(1003),nf.Yi.add(144),nf.Yi.add(502),nf.Yi.add(505),nf.Yi.add(179),nf.Yi.add(205),nf.Yi.add(134),nf.Yi.add(230),nf.Yi.add(103),nf.Yi.add(110),nf.Yi.add(112),nf.Yi.add(113),nf.Yi.add(124),nf.Yi.add(133),nf.Yi.add(154),nf.Yi.add(162),nf.Yi.add(168),nf.Yi.add(172),
nf.Yi.add(201),nf.Yi.add(222),nf.Yi.add(227),nf.Yi.add(513),nf.Yi.add(534),nf.Yi.add(539),nf.Yi.add(545),nf.Yi.add(600),nf.Yi.add(547),nf.Yi.add(555),nf.Yi.add(558),nf.Yi.add(562),nf.Yi.add(585),nf.Yi.add(1001),nf.Yi.add(1005),nf.Yi.add(1008),nf.Yi.add(1010),nf.Yi.add(1011),nf.Yi.add(1012),nf.Yi.add(1018),nf.Yi.add(252),nf.Yi.add(253),nf.Yi.add(258),nf.Yi.add(101),nf.Yi.add(102),nf.Yi.add(108),nf.Yi.add(257),nf.Yi.add(119),nf.Yi.add(120),nf.Yi.add(123),nf.Yi.add(126),nf.Yi.add(127),nf.Yi.add(130),
nf.Yi.add(140),nf.Yi.add(159),nf.Yi.add(160),nf.Yi.add(165),nf.Yi.add(166),nf.Yi.add(167),nf.Yi.add(169),nf.Yi.add(189),nf.Yi.add(223),nf.Yi.add(214),nf.Yi.add(228),nf.Yi.add(233),nf.Yi.add(247),nf.Yi.add(504),nf.Yi.add(511),nf.Yi.add(512),nf.Yi.add(525),nf.Yi.add(533),nf.Yi.add(537),nf.Yi.add(542),nf.Yi.add(544),nf.Yi.add(548),nf.Yi.add(550),nf.Yi.add(551),nf.Yi.add(552),nf.Yi.add(554),nf.Yi.add(577),nf.Yi.add(584),nf.Yi.add(586),nf.Yi.add(587),nf.Yi.add(588),nf.Yi.add(592),nf.Yi.add(1009),nf.Yi.add(1016),
nf.Yi.add(1017),nf.Yi.add(1024),nf.Yi.add(260),nf.Yi.add(597),nf.Yi.add(264),nf.Yi.add(596),nf.Yi.add(254),nf.Yi.add(262),nf.Yi.add(1030),nf.Yi.add(1031),nf.Yi.add(606));return nf.Yi}}nf.Yi=null;Object(ja.a)(nf,"MacroRecorderUnrecognizedEventList",null,[]);let gj=class{constructor(f,G,fa){G=void 0===G?new uh(f):G;fa=void 0===fa?new oj:fa;this.JPb=null;this.dDj=(Ya,Kb)=>{this.iTg()&&this.SGd(Kb)};this.jbg=G;this.ibg=fa;this.$=f;this.$.m6&&this.$.GDh(this.dDj)}init(f){this.$.m6&&(f?this.JPb=f:ma.ULS.sendTraceTag(537155424,
0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}SGd(f){if(this.iTg())try{if(this.ibg.Vgj(f)){var G=this.ibg.i4k(f);for(const fa of G)this.fAf(fa)}else this.fAf(f)}catch(fa){G=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${Xi.a(f.operation)}, Exception: ${fa.stack}`;ma.ULS.sendTraceTag(537155423,0,10,G);try{this.bxi(f)}catch(Ya){}}}fAf(f){var G=this.jbg.PIf(f,!0);G?(this.JPb(G.eventId,rb.a.Ci(f.payload)),ma.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${G.eventId}`)):
(G=this.jbg.PIf(f,!1))?ma.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${G.eventId}, but failed to match filters`):nf.h0i().contains(f.operation)||(this.JPb(0,rb.a.Ci(f.operation)),f=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${Xi.a(f.operation)}`,ma.ULS.sendTraceTag(537155420,0,50,f))}bxi(f){this.JPb(222,rb.a.Ci(f.operation))}iTg(){return this.$.xya&&this.JPb&&this.$.bha?!0:!1}};gj=Object(db.__decorate)([Object(qa.d)(da.Sd),Object(db.__param)(0,
Object(da.Nb)())],gj);Object(ja.a)(gj,"MacroRecorderEventHandler",null,[851]);Object(qa.b)(da.fe,{Ek:"singleton"})(f=>Lo(function*(){yield qa.a.resolve(da.ee,f);return Ab.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory")}));var Bi=a(2);class sj{}Object(ja.a)(sj,"Selection",null,[]);var yg=a(1254),ti=a(40);class hj{}Object(ja.a)(hj,"SmartLookupApplicationInterface",null,[]);class Dg{}Object(ja.a)(Dg,"ApplicationProperties",null,[]);class Dh{}Object(ja.a)(Dh,"EnterpriseUserInfo",
null,[]);class Li{}Object(ja.a)(Li,"FeatureGates",null,[]);class Ci{constructor(f,G,fa){this.K_k=9E5;this.M_k=3E5;this.$3d=null;this.R$f="";this.X3d=0;this.jNb=Date.now;this.iza=f;this.Lqb=G;(void 0===fa||fa)&&this.JJd()}LWi(){var f=void 0===f?!0:f;const G=this.jNb();if(G<this.X3d+this.K_k)return G>this.X3d+this.M_k&&this.JJd(),this.R$f;f&&this.JJd();return""}JJd(){this.$3d=this.$3d||new Promise(f=>{this.MWi().then(G=>{this.R$f=G;this.X3d=this.jNb();this.$3d=null;f(G)})})}MWi(){return this.Lqb&&this.Lqb.length?
new Promise(f=>{this.iza.hE("SmartLookup",this.Lqb).then(G=>{G.IsSuccess?G.Token||(f(""),ma.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(ma.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+G.ErrorCode+": "+G.ErrorMessage),f(""));f(G.Token)}).catch(G=>{G=qf.c(G);ma.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+G);f("")})}):(ma.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),
Promise.resolve(""))}}Object(ja.a)(Ci,"SmartLookupAuthenticationManager",null,[893]);class Mi{static JKi(){switch(Object(xa.a)(String,ea.AFrameworkApplication.hi.AudienceGroup)||""){case "Dogfood":if(ea.AFrameworkApplication.fa){let f=ea.AFrameworkApplication.fa.Za("UserPrincipalName");f=Sd.a.Xs(f);const G=ea.AFrameworkApplication.fa.Jv("SmartLookupINTEnabledForSKITeam")?ea.AFrameworkApplication.fa.pA("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(G,f)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static fWi(){switch(ea.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")?
"EDOG":ea.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")?"PROD":ea.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")?"INT":Mi.JKi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(ja.a)(Mi,"Utils",null,[]);var Nh=a(79),pi=
a(653);class bi{constructor(f){ma.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Bag=ea.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");this.sCj=ea.AFrameworkApplication.fa.Za("SmartLookupApprovedOriginPattern");this.Lqb=ea.AFrameworkApplication.fa.Za("SmartLookupShredderServiceEndpoint");this.ZCj=Nh.a.OU(ea.AFrameworkApplication.fa.Za("AppCatalogUrl")||"");this.Kqb=new Li;this.Kqb.EnableAllTabV2=!0;this.Kqb.EnableIntentService=!0;this.Kqb.EnableInDocumentSearch=
ea.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch");this.Kqb.EnableLocalSearch=ea.AFrameworkApplication.fa.ka("SmartLookupEnableLocalSearch");this.Kqb.IntentServiceEndpoint=Mi.fWi();this.UCj=new Ci(f,this.Lqb)}get approvedOriginPattern(){return this.sCj}CEi(){return Promise.resolve(this.DEi())}DEi(){const f=new Dg;f.anid="";f.applicationVersion=ea.AFrameworkApplication.buildVersion;f.appCorrelationId=Db.a.create().toString();f.themePlatform=bi.Edl;f.lcid=ea.AFrameworkApplication.lcid;
f.launchUtcTime=(new Date).toUTCString();f.featureGates=this.Kqb;var G=pi.a.MU(ea.AFrameworkApplication.lcid);G=G?G.name:null;f.market=this.aAc(G);f.uiLanguage=G;f.sessionId=ea.AFrameworkApplication.userSessionId;f.themeId=0;f.parentalControl=bi.b4j;const fa=new Dh;fa.CountryCode=this.aAc(G);fa.ServiceEndpoint=this.Lqb;fa.IsGoLocal=!1;fa.IsEnabled=this.Bag;fa.IsEnterpriseEnabled=this.Bag;fa.TenantRoot=this.ZCj;f.enterpriseUserInfo=fa;f.accessToken=this.UCj.LWi();return f}aAc(f){f=f.split("-");return f[f.length-
1]}}bi.Edl="web";bi.b4j="yes";Object(ja.a)(bi,"SmartLookupManager",null,[878]);var Oh;let Ah=Oh=class extends ti.a{constructor(f){super();this.$=f;this.isFirstLaunch=!1}dj(){return!1}Ri(){return!1}Gi(f,G){f=va.EwaSettings.Ra(127);return-983891024===G.command&&f}executeCommand(f,G){f=Qa.TaskExtensions.Gq();-983891024===G.command&&this.xvj();return f}xvj(){var f=new bi(null);const G={};var fa=ba.f(this.$).zh(null).originalText;fa=Object(Bi.a)(new sj,{neighborhood:fa,mentionStart:0,mentionLength:fa?
fa.length:0});const Ya=Object(Bi.a)(new hj,{selection:fa,entryPoint:0});f.CEi().then(sc=>{sc.applicationName=Oh.appName;sc.isFirstLaunch=this.isFirstLaunch;sc.themeId=5;G[Oh.FSk]=JSON.stringify(Ya);G[Oh.JHh]=JSON.stringify(sc);this.isFirstLaunch=!1});f=new ve.a("ExcelOnline","Web","en-Us");fa=new Hc.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Kb=new ed.a;Kb.Ak[yg.a.Vs]=Zd.a.instance.ia(1810);Kb.Ak[yg.a.taskPaneWidth]=350;Kb.Ak[yg.a.sourceLocationOverrideResourceId]=
"WAC.PROD.URL";Kb.Zw=G;zc.a.instance.Yya(fa,"Taskpane","SmartLookupSDXTaskpane",f,Kb)}};Ah.JHh="AppProperties";Ah.appName="Excel";Ah.FSk="SmartLookupApplicationInterface";Ah=Oh=Object(db.__decorate)([Object(qa.d)(da.jg),Object(db.__param)(0,Object(da.Nb)()),Object(db.__param)(1,Object(Ea.a)())],Ah);Object(ja.a)(Ah,"SmartLookupCommandHandler",ti.a,[43]);var qi=a(1259),P=a(432);class pa{constructor(){this.Cih=new Ra.a}get mpc(){return this.Cih}vRi(f){ma.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",
f);const G=new Ra.a;for(const fa of this.mpc)for(const Ya of fa.e0b)Ya.id===f&&G.add(Ya);return G}d2e(f){this.mpc.add(f)}Ijk(f){for(const G of this.mpc)if(G.V5e===f.V5e){this.mpc.remove(G);break}}static rfi(f,G,fa){fa=void 0===fa?null:fa;f=pa.gIi(f);0<f.length&&(pa.bYc(f,!1),fa&&fa(G,f))}static gIi(f){const G=[];if(f&&f.e0b&&0<f.e0b.count)for(const fa of f.e0b)if(fa.controls&&0<fa.controls.count)for(const Ya of fa.controls)if(Ya.menuItems&&0<Ya.menuItems.count)for(const Kb of Ya.menuItems)Array.add(G,
Kb.id);return G}static bYc(f,G){if(f.length){var fa=[];for(const Ya of f)fa.push(appChrome.actions.updateControlEnabledDisabledState(Ya,G));appChrome.api.dispatch(fa)}}}Object(ja.a)(pa,"ContextMenuExtensibilityCache",null,[915,916]);var Wa=a(1576),Sb=a(1115),ec=a(1027);class Jc{geb(f,G){G=void 0===G?null:G;if(f=ec.a.wQb(f)){appChrome.addInApi.dispatchActionsToInstallAddIn(f,G);for(const fa of f.tabs)if(fa.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(f,()=>{});break}}}vie(f){(f=
ec.a.wQb(f))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(f)}MPg(){}static Afi(f,G,fa){fa=void 0===fa?null:fa;f=Jc.$Ui(f);0<f.length&&(Jc.bYc(f,!1),fa&&fa(G,f))}static $Ui(f){const G=[];if(f&&(f=f.b7,f.fC&&0<f.fC.count))for(const fa of f.fC)if(fa.groups&&0<fa.groups.length)for(const Ya of fa.groups)if(Ya.controls&&0<Ya.controls.length)for(const Kb of Ya.controls)Array.add(G,Kb.id);return G}static bYc(f){if(f.length){var G=[];for(const fa of f)G.push(appChrome.actions.updateControlEnabledDisabledState(fa,
!0));appChrome.api.dispatch(G)}}}Object(ja.a)(Jc,"OneLineRibbonExtensibilityManager",null,[923]);var td=a(1161);class Jd{constructor(){this.wHe=this.z6c=null;this.JUf=(f,G)=>{let fa=null;fa=()=>{f.getIsUpgrading()?window.setTimeout(fa,1E3):f.getUpgradingFailed()?Jc.bYc(G,!0):ea.AFrameworkApplication.ra.UB()};window.setTimeout(fa,1E3)}}get Cmd(){return this.z6c||(this.z6c=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set Cmd(f){this.z6c=f}get zLh(){return this.wHe||(this.wHe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(f,
G){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(f,G)}UPd(f,G,fa,Ya,Kb,sc,Tc){sc=void 0===sc?null:sc;Tc=void 0===Tc?null:Tc;var fd;ma.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",f);ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8642303_FixedTelemetryForAddinCommandsActionEnabled")&&(f={["solutionId"]:null===(fd=globalThis.Telemetry)||void 0===fd?void 0:fd.PrivacyRules.GetPrivacyCompliantId(Kb.ownerAddinInfo.solutionId,Kb.ownerAddinInfo.storeType,
Kb.ownerAddinInfo.assetId,null,null,Kb.ownerAddinInfo.storeId)},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.HandleAddinCommandsAction",dataFields:kd.a.Pm(f)}));if((G=G.mwa(Kb.ownerAddinInfo.storeType,Kb.ownerAddinInfo.solutionId))&&G.YK&&!G.YK.getIsUpgrading())if(fd=null,0<G.YK.getNotificationParams().length&&(fd=this.ebf(G.YK.getNotificationParams()[0]))&&2147758681===fd.errorCode&&(G.isUpgraded=!0),2!==G.YK.getStatus()&&(1!==G.YK.getStatus()||fd&&2147758681===fd.errorCode))fd&&this.cUg(G,
fd,Tc);else try{fa.setOwnerAddinEToken(G.YK.getEToken()),Kb.action(fa,Ya.upa),sc&&sc()}catch(ud){ma.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?ud.stack:ud.message)),td.a.Ise(Object(Gb.a)("InternalError")+" "+Object(Gb.a)("InternalError_Directive"))}}cUg(f,G,fa){fa=void 0===fa?null:fa;const Ya=f.YK;if(1===Ya.getNotificationParams().length||G.TDc){const Kb=
G.Fua,sc=G.Gva;G.Fua=()=>{Ya.removeFirstNotification();if(0<Ya.getNotificationParams().length){const Tc=this.ebf(Ya.getNotificationParams()[0]);this.cUg(f,Tc)}2147758681===G.errorCode&&(Jc.Afi(f.Iw,Ya,this.JUf),pa.rfi(f.SLb,Ya,this.JUf));Kb&&Kb()};G.Gva=()=>{sc&&sc();fa&&fa()};td.a.Jse(G)}}ebf(f){const G=new Sb.a;G.i0a=f.infoType;G.id=f.id;G.title=f.title;G.description=f.description;G.buttonText=f.buttonTxt;G.Fua=f.buttonCallback;G.TDc=f.highPriority;G.Gva=f.dismissCallback;G.errorCode=f.errorCode;
G.ITf=f.iframeNotificationUrl;return G}}Object(ja.a)(Jd,"AddinCommandsActionHandler",null,[914]);var le=a(183),Be=a(914),Te=a(7),kf=a(959),yf=a(910);class Zf{constructor(f,G){this.Ya=f;this.A1h=G}iCi(f){if(void 0!==f&&null!==f&&f===Te.a.Rif)f="ContextMenuCell";else return null;const G=this.Ya.ji();this.uBi(G,f);return G}uBi(f,G){G=this.A1h.vRi(G);for(const fa of G){G=fa.controls;for(const Ya of G)this.eBi(f,Ya)}}eBi(f,G){var fa=G.t4[kf.a.id];const Ya=G.t4[kf.a.C$a],Kb=G.t4[kf.a.G$a];let sc="Image16by16",
Tc=G.t4[kf.a.D$a];yf.c(Kb)&&(sc="None");0<G.menuItems.count?(fa=this.Ya.uz(fa,fa,Ya,798637440),fa.d7b(sc,Kb,null),this.gCi(fa.menu,G),f.buttons.push(fa)):f.buttons.push(this.Ya.tXa(fa,Ya,Tc,Kb,sc,null,!1))}gCi(f,G){const fa=this.Ya.ji();for(const Ya of G.menuItems){G=Ya.oza[kf.a.id];const Kb=Ya.oza[kf.a.C$a],sc=Ya.oza[kf.a.G$a];let Tc="Image16by16";const fd=Ya.oza[kf.a.D$a];yf.c(sc)&&(Tc="None");G=this.Ya.tXa(G,Kb,fd,sc,Tc,null,!1);fa.buttons.push(G)}f.Mh.push(fa)}}Object(ja.a)(Zf,"AddInCommandsContextMenuExtensibilityHandler",
null,[892]);var kg=a(1034);class Bg{constructor(){this.yo=null;this.visible=!1}}Object(ja.a)(Bg,"AddinStatusCommandValues",null,[]);class Ng{static abk(f){const G=new Bg;G.yo=f.$Fa;G.visible=G.yo?!0:!1;return G}static OZc(f,G,fa,Ya,Kb){const sc=document.getElementById(fa);sc?Ng.vPk(f,G,sc,Ya,Kb):ma.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",fa))}static vPk(f,G,fa,Ya,Kb){fa?f.$Fa===Object(Gb.a)("ErrorLoadingAddInsTitle")?td.a.WNk(G,fa,Ya,Kb):f.$Fa===Object(Gb.a)("InstallingCustomFunctionsErrorStatusBarMsg")&&
td.a.CPk(G,fa,Object(Gb.a)("InstallingCustomFunctionsErrorStatusBarMsg"),Object(Gb.a)("InstallingCustomFunctionsErrorCalloutMsg")):ma.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(ja.a)(Ng,"AddinCommandsStatusHandler",null,[]);var F=a(255),ua=a(88);class jb extends ti.a{constructor(f,G){super();this.agaveCommandManager=this.statusBarManager=null;this.Mo=!1;this.Jff=()=>{this.jL&&this.jL.pff()};this.GOf=()=>{this.raiseEvent("LAC")};this.ij=
(fa,Ya)=>{!fa.ki&&F.b(Ya)&&this.statusBarManager&&(this.statusBarManager.pN(this),this.statusBarManager=null)};this.jL=G;this.$=f;this.Mo=ya.a.Mo(this.$);this.Mo||(this.Zue=f.xi+"OfficeAddinLabel-Medium14");this.$.la.fi(29,fa=>{this.statusBarManager=fa;fa.dO(this)});this.$.ea.$q(this.ij);this.jL.$Ah(this.GOf);this.$.la.fi(206,fa=>{this.agaveCommandManager=fa;fa.LCh(this.Jff)})}ky(f){this.addHandler("LAC",f)}Xx(f){this.removeHandler("LAC",f)}xy(f,G){if("QueryAddinLabel"!==f)return!1;f=!1;this.Mo?(f=
appChrome.selectors.getControlLabel(ua.a.c8d),f=!(!f&&!this.jL.$Fa)&&f!==this.jL.$Fa):f=G[kg.a.LabelText]!==this.jL.$Fa;f&&(f=Ng.abk(this.jL),G[kg.a.LabelText]=f.yo,G[kg.a.Visible]=f.visible,window.setTimeout(()=>{this.OZc()},0));return!0}pr(){return!0}OZc(){if(this.$){if(this.Mo){const f=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');f&&(this.Zue=f.getElementsByClassName("ms-Button-label")[0].id)}this.Zue&&Ng.OZc(this.jL,this.$.domElement,this.Zue,Zd.a.instance.ia(333),
Zd.a.instance.ia(334))}}dispose(){this.$.ea.Uq(this.ij);this.jL.elk(this.GOf);this.agaveCommandManager&&(this.agaveCommandManager.Amk(this.Jff),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.pN(this),this.statusBarManager=null);this.jL=this.$=null;super.dispose()}}Object(ja.a)(jb,"AddinCommandsStatusBarManager",ti.a,[168,169]);class pc{constructor(){this.Ver=1}}Object(ja.a)(pc,"CacheItem",null,[]);class Vc{constructor(f){this.AEa=f}Wn(f){const G=this.AEa.getItem(f);if(G){let fa=
new pc;try{fa=Sys.Serialization.JavaScriptSerializer.deserialize(G,!0)}catch(Ya){return this.AEa.removeItem(f),null}return fa.Data?fa.Data:fa.data}return null}Pub(f){this.AEa.removeItem(f)}}Object(ja.a)(Vc,"AppsDataCacheManager",null,[875]);class pd{constructor(){new Vc(Z.a.instance)}MNg(f,G){f=Dc.a.LGf()+f;Z.a.instance.setItem(f,G.toString())}hTi(){var f=Dc.a.yKf();ma.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",f);f=Z.a.instance.getItem(f);return qf.a(f)}GFk(f){const G=Dc.a.yKf();ma.ULS.sendTraceTag(527523851,
306,50,"get cache key:{0}",G);Z.a.instance.setItem(G,qf.c(f))}NNg(f){const G=Dc.a.zKf();ma.ULS.sendTraceTag(507364892,306,50,"get cache key:{0}",G);Z.a.instance.setItem(G,qf.c(f))}DJd(){var f,G=Dc.a.zKf();ma.ULS.sendTraceTag(507364891,306,50,"set cache key:{0}",G);G=Z.a.instance.getItem(G);return null!==(f=qf.a(G))&&void 0!==f?f:new Set}fnj(){return!!Z.a.instance.localStorage}static get instance(){pd.Va||(pd.Va=new pd);return pd.Va}}pd.Va=null;Object(ja.a)(pd,"AddInCommandsCacheManager",null,[838]);
var gd=a(117);class Md{constructor(f){this.Ha=f}get host(){var f;const G=null===(f=this.Ha)||void 0===f?void 0:f.Za("Application");return"Word"===G||"Excel"===G||"PowerPoint"===G?G:""}get Zta(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get rFh(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",!1)}get m5e(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",
!1)}get o3j(){return this.Ha?this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryIds",""):""}get p3j(){return this.Ha?this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryNames",""):""}get n3j(){return this.Ha?this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping",""):""}get p6b(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get W3(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",
!1)}get qFh(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutNoSearchResultsV2Enabled",!1)}get LWh(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.CitationEnabled",!1)}get pFh(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREScrollEnabled",!1)}get tFh(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchWithOmexEnabled",!1)}get q5e(){var f,
G;return null!==(G=null===(f=this.Ha)||void 0===f?void 0:f.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchDebouncing",100))&&void 0!==G?G:100}get r5e(){return!!this.Ha&&this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRecommendedKeyword","")}get sFh(){return this.Ha?this.Ha.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRequestSentTimeoutMs",2E4):2E4}get q3j(){return this.Ha?this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",
""):""}get Mpd(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerInPopularEnabled",!1)}get Lpd(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerGroupInPopularEnabled",!1)}get xea(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)}get p5e(){return!!this.Ha&&this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREBannerAddins",
"")}get jaf(){return!!this.Ha&&"Dev Box"===this.Ha.Za("StatusBarEnvironmentNameToUse")}get o5e(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",!1)}get Wxb(){return!!this.Ha&&this.Ha.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get M$b(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get EHd(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyEnabled",
!1)}get Ayi(){return this.Ha?this.Ha.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutTriggerSurveyTimeMs",25E3):25E3}get cQb(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",!1)}get xyi(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUseLabelsEnabled",!1)}}Object(ja.a)(Md,"AppsFlyoutGeneratorContext",null,[]);var ze;(function(f){f.LEFT="LEFT";f.Hja="MIDDLE";f.RIGHT="RIGHT"})(ze||(ze={}));Object(ja.b)("FRECarouselDirection",
ze);const T=()=>({["APIC"]:Object(Gb.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(Gb.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),["BBM"]:Object(Gb.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(Gb.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(Gb.a)("AddInCategoryTitleDataSyncAndAnalysis"),["DWT"]:Object(Gb.a)("AddInCategoryTitleDesigningWithTemplates"),["ER"]:Object(Gb.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(Gb.a)("AddInCategoryTitleFinancialAnalytics"),
["IPWAI"]:Object(Gb.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(Gb.a)("AddInCategoryTitleTrendingAddins"),["WN"]:Object(Gb.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(Gb.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(Gb.a)("AddInCategoryTitlePopularAddinsInYourOrg"),default:Object(Gb.a)("PopularAddins")}),Za=()=>({["Word"]:{["IPWAI"]:Object(Gb.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["WF"]:Object(Gb.a)("AddInCategoryShortTitleWritingFluently")||
"Perfect your writing",["ER"]:Object(Gb.a)("AddInCategoryShortTitleEducationalResources")||"Education",["APID"]:Object(Gb.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity"},["Excel"]:{["IPWAI"]:Object(Gb.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(Gb.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["FA"]:Object(Gb.a)("AddInCategoryShortTitleFinancialAnalytics")||"Manage your finances"},
["PowerPoint"]:{["IPWAI"]:Object(Gb.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(Gb.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["CAIP"]:Object(Gb.a)("AddInCategoryShortTitleCreatingAnInteractivePresentation")||"Elevate your presentations",["DWT"]:Object(Gb.a)("AddInCategoryShortTitleDesigningWithTemplates")||"Templates"},Bqe:{["BBM"]:Object(Gb.a)("AddInCategoryShortTitleBuildByMicrosoft")||"Built by Microsoft",
["TD"]:Object(Gb.a)("AddInCategoryShortTitleTrending")||"Trending",["WN"]:Object(Gb.a)("AddInCategoryShortTitleWhatsNew")||"Just released",["PAIYO"]:Object(Gb.a)("AddInCategoryShortTitlePopularAddinsInYourOrg")||"Popular"}}),Bb=()=>({["Word"]:{["APID"]:Object(Gb.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||"Add photos, icons, and diagrams to your documents.",["ER"]:Object(Gb.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",["IPWAI"]:Object(Gb.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||
"Draft and summarize with the power of generative AI.",["WF"]:Object(Gb.a)("AddInCategoryDescriptionWritingFluently")||"Get help with spelling, grammar, and more."},["Excel"]:{["APID"]:Object(Gb.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(Gb.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",["IPWAI"]:Object(Gb.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||
"Use the power of AI to capture and understand your data.",["FA"]:Object(Gb.a)("AddInCategoryDescriptionFinancialAnalytics")||"Track expenses, budget, and more."},["PowerPoint"]:{["IPWAI"]:Object(Gb.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||"Use the power of AI in your presentations.",["APID"]:Object(Gb.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",["CAIP"]:Object(Gb.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||
"Add polls, timers, and more.",["DWT"]:Object(Gb.a)("AddInCategoryDescriptionDesigningWithTemplates")||"Create beautiful slides with templates you can customize."},Bqe:{["BBM"]:Object(Gb.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",["TD"]:Object(Gb.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(Gb.a)("AddInCategoryDescriptionWhatsNew")||"Brand new or updated add ins.",["PAIYO"]:Object(Gb.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||
"Add ins people add and use the most in your organization."}});class Gc{constructor(f){this.ojd=f}next(f){this.ojd=(9301*this.ojd+49297)%233280;return Math.floor(this.ojd/233280*f)}}Object(ja.a)(Gc,"Random",null,[]);class qd{constructor(f){this.cU=f;this.J1d=new Set;this.PGe=[];this.Hpd=pd.instance;this.kQc=()=>this.rnc=gd.a("getTheme")?appChrome.api.getTheme():null;this.context=new Md(ea.AFrameworkApplication.fa);this.rnc=gd.a("getTheme")?appChrome.api.getTheme():null;gd.a("registerOnThemeChangeCallback")&&
appChrome.api.registerOnThemeChangeCallback(this.kQc)}get hVa(){return this.PGe}set hVa(f){this.PGe=f}bEj(f){if(this.context.o5e&&this.hVa.includes(f)){this.J1d.add(f);var G=this.Hpd.DJd();G.has(f)&&(G.delete(f),this.Hpd.NNg(G))}}WDi(f){const G=this.cU.getUpgradedAddinsOfOmex(),fa=this.Hpd.DJd(),Ya=f.filter(Kb=>fa.has(Kb)&&!this.J1d.has(Kb));f=f.filter(Kb=>G.has(Kb)&&!this.J1d.has(Kb));return{eGh:Ya,R$k:f}}addNotification(f){if(this.context.o5e){var {eGh:G,R$k:fa}=this.WDi(f.map(Ya=>Ya.solutionId));
this.hVa=[];b(fa,this.rnc);this.hVa.push(...fa);h(G,this.rnc);this.hVa.push(...G);0!==this.hVa.length&&(f={["Upgraded"]:fa.map(Ya=>m(this.cU.TI(Ya))),["AdminInstalled"]:G.map(Ya=>m(this.cU.TI(Ya)))},this.qwb(f,"ShowNotificationAddins"))}}qwb(f,G){yc.a.sendTelemetryEvent({name:`Office.Extensibility.Host.${G}`,dataFields:kd.a.Pm(f)})}}Object(ja.a)(qd,"AppsInFlyoutNotificationManager",null,[]);var Rd=a(1112),je=a(1436),Ge=a(132),af=a(671),mf=a(145);class Tf{constructor(){this.yeb=null}setErrorMessageForAddin(f,
G){this.yeb||(this.yeb={});this.yeb[f]=G}QKi(f){return this.yeb&&f in this.yeb?this.yeb[f]:null}}Object(ja.a)(Tf,"AddinCommandsErrorManager",null,[]);var wg=a(113);class Gg{constructor(){this.xA=this.rAa=0;this.Jpd=null;this.BSc=this.K1c=0;this.zDa=this.Iad=this.T6c=null}get Imc(){this.T6c||(this.T6c=new Ra.a);return this.T6c}get GId(){this.Iad||(this.Iad=new Ra.a);return this.Iad}get hXa(){this.zDa||(this.zDa=new Ra.a);return this.zDa}}Object(ja.a)(Gg,"AddinCommandsListLoaderContext",null,[]);class Qg{constructor(f,
G){this.entitlement=f;this.metadata=G}q$b(){var f=this.entitlement;const G={};G.solutionId=f.solutionId;G.version=f.version;G.storeType=f.storeType;G.storeId=f.storeId;G.assetId=f.assetId;G.assetStoreId=f.assetStoreId;G.targetType=f.targetType;G.requireConsent=f.requireConsent||!1;G.isAddinCommands=!0;G.addinCommandsActionType=0;G.targetType=this.targetType;return G}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(ja.a)(Qg,"AddinEntitlementEx",null,[]);var fi=a(298),Jh=a(379);class gi{}Object(ja.a)(gi,"AppsForOfficeEntitlementQueryInfo",null,[]);class Pi{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(ja.a)(Pi,"AddinAbstract",
null,[]);class kj extends Sys.EventArgs{constructor(){super();this.Iw=this.hs=null}}Object(ja.a)(kj,"InsertionParamEventArgs",Sys.EventArgs,[]);class Yi{constructor(f,G,fa,Ya){this.c_a=Kb=>{let sc=!1,Tc=null;try{if(0<Kb.data.responseData.length){const fd=Object(xa.a)(Object,qf.a(Kb.data.responseData)),ud=fd?fd[this.appName]:null;ud&&(Tc=Object(xa.a)(Object,qf.a(ud.toString())))}sc=!0}catch(fd){this.dxa(null)}sc&&this.MCb&&this.MCb(Tc)};this.dxa=Kb=>{this.ICb&&this.ICb(Kb?Kb.data:null)};this.lAa=Kb=>
{this.aFb&&this.aFb(Kb?Kb.data:null)};this.O5b=ea.AFrameworkApplication.fa.Za("RoamingServiceHandlerWebServiceBase");this.appName=f;this.MCb=G;this.ICb=fa;this.aFb=void 0===Ya?null:Ya}CFd(f){this.Ysi(f,this.c_a,this.dxa)}Ysi(f,G,fa){const Ya=new Sys.StringBuilder(this.O5b);Ya.append("RoamingServiceHandler.ashx?action=");Ya.append("getAddinTeachingCalloutSettings");Ya.append("&");Ya.append(this.zNd(f));Ya.append("&");Ya.append(ea.AFrameworkApplication.Jo);ea.AFrameworkApplication.sj.lv(Ya.toString(),
1,null,null,!0,2,G,fa,null)}cxc(f){this.cti(f)}cti(f){var G=new Sys.StringBuilder(this.O5b);G.append("RoamingServiceHandler.ashx?action=");G.append("saveAddinTeachingCalloutSettings");G.append("&");G.append(ea.AFrameworkApplication.Jo);G=G.toString();f=qf.c(f);ea.AFrameworkApplication.sj.lv(G,2,f,null,!0,4,null,this.lAa,null)}zNd(f){const G=new Sys.StringBuilder("requestedsettings=");for(let fa=0;fa<f.count;fa++)G.append(f.na(fa)),fa<f.count-1&&G.append(";");return G.toString()}}Object(ja.a)(Yi,"AddinTeachingUIRoamingRequestHandler",
null,[]);class xj extends Sys.EventArgs{constructor(f){super();this.solutionId=f.solutionId;this.assetId=f.assetId;this.storeType=f.storeType;this.storeId=f.storeId;this.assetStoreId=f.assetStoreId;this.targetType=f.targetType;this.width=f.width;this.height=f.height;this.displayName=f.displayName;this.version=f.version}}Object(ja.a)(xj,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);class ci{constructor(f){this.Aeb=this.hs=null;this.bWc=!1;this.zDa=this.rcc=this.Rpa=this.Dl=this.X6c=
this.Nvb=null;this.JVj=()=>{const G=new fi.ScriptSharpLegacyMap;this.Aeb&&this.Aeb.tabs&&!this.Aeb.tabs[0].isOfficeTab&&G.ga("SDX.FeatureFlags","NonOfficeTab");this.sqb(ci.tga(this.hs),"ClickOnLaunch",G);this.uMc();this.Aeb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Aeb,()=>{const fa=new kj;fa.hs=this.hs;this.eh.raiseEvent(Dc.a.z6f,fa)}):ma.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};this.SOj=()=>{this.sqb(ci.tga(this.hs),
"ClickOnClose");this.uMc()};this.AQj=()=>{this.sqb(ci.tga(this.hs),"ClickOnDismiss");this.uMc()};this.Nhg=G=>{if(G&&(G=G.detail)&&G.id&&this.nhj(G.id)){const fa=(G.action||"").toLowerCase();if(G.success&&"opened"===fa)this.sqb(ci.tga(this.hs),"CampaignLaunched"),ma.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.uMc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.Nhg,!0);else{let Ya;try{Ya=JSON.stringify(G),ma.ULS.sendTraceTag(508625353,
220,15,"Campaign launch failure. Event:"+Ya)}catch(Kb){Ya="id : "+G.id+" telemetryEventName: "+G.telemetryEventName,ma.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+Ya+" Error: "+(Kb?Kb.toString():""))}}}};this.c_a=G=>{G?this.PMk(G)?(ma.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.Nvb="AddinHasShown"in G&&G.AddinHasShown?G.AddinHasShown.toString():null,this.Zhf()):(ma.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),this.Rpa(this.ZFa,
null)):(ma.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.Nvb=null,this.Zhf())};this.dxa=G=>{ma.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",G?G.httpStatus:-1);this.Rpa(this.ZFa,null)};this.lAa=G=>{ma.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};this.eh=f}get appName(){return ea.AFrameworkApplication.fa.Za("WebAppShortName")}get lIb(){this.X6c||(this.X6c=
new Yi(this.appName,this.c_a,this.dxa,this.lAa));return this.X6c}get ZFa(){this.rcc||(this.rcc=new Ra.a);return this.rcc}set ZFa(f){this.rcc=f}get hXa(){this.zDa||(this.zDa=new Ra.a);return this.zDa}set hXa(f){this.zDa=f}Zxh(f,G){window.addEventListener?(this.hs=f,this.Aeb=G,window.addEventListener("LaunchAddinTaskpane",this.JVj,!0),window.addEventListener("DismissCallout",this.AQj,!0),window.addEventListener("CloseCallout",this.SOj,!0),window.addEventListener("FGWebSurfaceEvent",this.Nhg,!0)):ma.ULS.sendTraceTag(508625357,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}B9a(f,G,fa,Ya){this.Dl=f;this.ZFa=G;this.hXa=fa;this.Rpa=Ya;ma.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",G?G.count.toString():"null",fa?fa.count.toString():"null");0<this.ZFa.count||0<this.hXa.count?(f=new Ra.a,f.add(this.appName),this.lIb.CFd(f)):this.Rpa(new Ra.a,null)}nhj(f){f=Sd.a.Xs(f);return-1!==f.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==f.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==f.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==f.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==f.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==f.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}vWc(f){if(this.appName){const G={},fa={};fa.LastTeachingUIShowTime=(new Date).toUTCString();fa.AddinHasShown=f;G[this.appName]=qf.c(fa);this.lIb.cxc(G);ma.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else ma.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}uMc(){if(!this.bWc){const f=window.g_roamingAddinList;f&&(this.vWc(f),this.bWc=!0)}}Zhf(){const f=this.qei();0===f.targetType?(f.solutionId?this.Wak(f):this.sqb(null,"NoSolutionId"),this.Q6g(f),this.Rpa(this.ZFa,null)):this.Rpa(this.ZFa,f);ma.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",f.addinId)}Wak(f){const G=new gi;G.callbackFunc=fa=>{if(fa.errorCode){this.sqb(f.solutionId,"FailToGetAppDetails");var Ya=window.g_roamingAddinList;
Ya&&this.vWc(Ya)}else if(fa.value)for(Ya of fa.value)if(fa=Ya[1],fa===f.solutionId){const Kb={};Kb.solutionId=fa;Kb.assetId=Ya[5];Kb.storeType=Ya[12];Kb.storeId=Ya[11];Kb.assetStoreId=Ya[6];Kb.targetType=Ya[3];Kb.width=Ya[7];Kb.height=Ya[8];Kb.displayName=Ya[0];Kb.version=Ya[4];ma.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",f.solutionId);Ya=new xj(Kb);this.eh.raiseEvent(Dc.a.hUg,Ya);break}};G.storeType=OSF.StoreTypeEnum.PrivateCatalog;G.fromInsertDialog=
!1;G.refresh=!1;this.Dl.queryEntitlementDetails(G)}PMk(f){if("LastTeachingUIShowTime"in f){if(f=+new Date-+new Date(f.LastTeachingUIShowTime.toString()),f<ea.AFrameworkApplication.fa.hP("AddinShowTeachingUIIntervalInMS",864E5))return ma.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",f),!1}else ma.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}qei(){let f=new Jh.a(new Pi,0),G=new Jh.a(new Pi,0),fa=0,Ya=0,Kb=0;var sc=new Ra.a;
for(var Tc of this.ZFa)sc.add(Tc);for(const fd of this.hXa)sc.add(fd);for(const fd of sc)if(!("excatalog"!==fd.storeType||yf.c(fd.installTimeInMS)||!fd.installTimeInMS||fd.installTimeInMS<=ea.AFrameworkApplication.fa.hP("DateTimeInMSForNewAddin",16409952E5))){sc=ci.BDf(fd);if(this.Nvb&&(Tc=this.Nvb.split(","),0<Tc.length&&Array.contains(Tc,sc))){Kb++;ma.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}sc.startsWith("private_")?(f=ci.tIf(fd,f),Ya++):(G=ci.tIf(fd,
G),fa++)}ma.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Ya,fa,Kb);return 0<G.value?G.key:0<f.value?f.key:Object.assign(new Pi,{addinId:null,targetType:-1,solutionId:null})}sqb(f,G,fa){fa=void 0===fa?null:fa;f={["AppTeachingUICalloutAction"]:G,["SDX.Id"]:f,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(fa)for(const Ya of fa.keys)f[Ya]=fa.na(Ya);yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:kd.a.Pm(f)})}Q6g(f){f&&(window.g_roamingAddinList=this.Nvb?this.Nvb+","+f.addinId:f.addinId)}static tga(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}static tIf(f,G){return G.value<f.installTimeInMS?new Jh.a(Object.assign(new Pi,{addinId:ci.BDf(f),targetType:f.targetType,solutionId:f.solutionId}),f.installTimeInMS):G}static BDf(f){return Telemetry.PrivacyRules.IsPrivateAddin(f.storeType,f.assetId,null,null,f.storeId)?"private_"+
f.installTimeInMS:f.solutionId}}Object(ja.a)(ci,"PrivateCatalogTeachingCalloutHandler",null,[]);const Ni=()=>{const f=Nh.a.qga(window.location.href.toLowerCase(),"wdomexsrctype");return!!f&&"4"===f},Aj=()=>Nh.a.qga(window.location.href.toLowerCase(),"wdtpl"),mk=()=>{const f=Nh.a.qga(window.location.href.toLowerCase(),"wdomexsrctype");return!!f&&"1"===f};var nk=a(1050);class Bk extends Sys.EventArgs{constructor(f){super();this.properties=f}}Object(ja.a)(Bk,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class Bj{constructor(f,G,fa){this.eh=new wg.a;this.context=new Gg;this.Ukd=null;this.qVj=(Ya,Kb,sc,Tc)=>{Ya?(Ya=new Qg(sc.targetData,Tc),Kb&&this.context.Imc.add(Ya),10===this.context.rAa&&(this.context.GId.add(Ya),0===Ya.targetType&&this.context.hXa.add(Ya))):(Kb=sc.targetData,ma.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Kb.solutionId,Kb.storeType,Kb.assetId,null,null,Kb.storeId),Kb.storeType));
this.v8d()};this.contextActivationMgr=f;this.nFh=G;this.xeb=fa;this.appName=ea.AFrameworkApplication.fa.Za("WebAppShortName")}get jyb(){this.Ukd||(this.Ukd=new ci(this.eh));return this.Ukd}YAh(f){this.eh.addHandler(Dc.a.k5e,f)}JEh(f){this.eh.addHandler(Dc.a.hUg,f)}A3k(f){null!==f&&(this.context.rAa=f[Dc.a.T9],this.context.xA=f[Dc.a.U3],this.context.K1c=this.context.BSc=0,f=Dc.a.eVa in f?f[Dc.a.eVa]:0,-1!==this.context.rAa&&0!==this.context.xA&&(this.context.Jpd=this.nFh.createAddinDataProvider(nk.a(this.context.rAa),
this.contextActivationMgr),this.context.Jpd?this.context.Jpd.getEntitlementsAsync(this.contextActivationMgr.upa,!0,f,G=>{this.VVj(G)}):ma.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.rAa)))}VVj(f){if(f&&0<f.length){this.context.K1c=f.length;const fa=Aj();for(let Ya=0;Ya<f.length;Ya++){const Kb=f[Ya];if(mk()&&Kb&&Kb.storeType&&"omex"===Kb.storeType.toLowerCase()&&Kb.assetId&&fa&&Kb.assetId.toLowerCase()===fa.toLowerCase()){var G={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:Bj.tga(Kb)};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:kd.a.Pm(G)})}!Kb||1!==Kb.targetType&&-1!==Kb.targetType?this.v8d():(G={},ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(G.solutionId=Kb.solutionId,G.version=Kb.version):(G.marketplaceId=Kb.solutionId,G.marketplaceVersion=Kb.version),G.storeType=Kb.storeType,G.storeId=Kb.storeId,G.targetData=Kb,this.contextActivationMgr.isAddinCommandsExAsync(G,
this.qVj))}}else this.v8d()}v8d(){var f;(f=this.context).BSc=f.BSc+1;this.context.BSc>=this.context.K1c&&(this.xeb.MNg(this.context.rAa,!1),0<this.context.K1c&&10===this.context.rAa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(f=!1,Ni()&&(f=this.tzj(this.context.GId)),this.Fyj(this.context.GId),f?this.Rpa(this.Yhf(this.context.Imc)):this.jyb.B9a(this.contextActivationMgr,this.context.Imc,this.context.hXa,(G,fa)=>{const Ya=new Ra.a;for(const Kb of G)G=Kb.q$b(),fa&&
fa.solutionId===Kb.solutionId&&(G.showCallout=!0,this.jyb.Q6g(fa)),Ya.add(G);this.Rpa(Ya)})):this.Rpa(this.Yhf(this.context.Imc)))}Yhf(f){const G=new Ra.a;if(f)for(const fa of f)G.add(fa.q$b());return G}Rpa(f){f&&f.count||wb.a.DQa(Dc.a.Ipd,"false",this.context.rAa);f={["ack2"]:f};f[Dc.a.T9]=this.context.rAa;f[Dc.a.U3]=this.context.xA;this.eh.raiseEvent(Dc.a.k5e,new Bk(f),this)}tzj(f){let G=!1;if(f&&1>f.count)return G;const fa=Aj();if(!fa)return G;for(const Ya of f)if(Ya.storeId&&Ya.storeId.toLowerCase()===
fa.toLowerCase()||Ya.assetId&&Ya.assetId.toLowerCase()===fa.toLowerCase())f={["SDX_Id"]:Bj.xKf(Ya),["SDX_TargetType"]:yf.c(Ya.targetType)?"":Ya.targetType.toString()},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:kd.a.Pm(f)}),G=!0;return G}Fyj(f){if(!(f&&1>f.count))if(this.xeb.fnj()){var G=this.xeb.hTi();G?(f=this.GFf(f,G),ma.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(f=this.GFf(f,null),ma.ULS.sendTraceTag(527523847,306,
50,"no data from cache"));this.xeb.GFk(f)}else ma.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}GFf(f,G){const fa={};let Ya=!1;const Kb=new Set;for(const sc of f)if(f=Bj.xKf(sc))!G||f in G||(Kb.add(sc.solutionId),this.OE(sc,f),ma.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===f.toLowerCase()?Ya||(Ya=!0,fa[f]=null):fa[f]=null;ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",
!1)&&(G=this.xeb.DJd(),this.xeb.NNg(new Set([...Kb,...G])));return fa}OE(f,G){var fa=f.installTimeInMS?(new Date(f.installTimeInMS)).toISOString():"";fa={["SDX.Id"]:G,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:yf.c(f.targetType)?"":f.targetType.toString(),["SDX.AdminDeploymentTime"]:fa};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:kd.a.Pm(fa)});1===f.targetType&&yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:kd.a.Pm({["SDX.Id"]:G,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"})})}static tga(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}static xKf(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}}Object(ja.a)(Bj,"AddInCommandsListLoader",null,[]);class Cj{constructor(f){this.jqh=f}get upa(){return this.jqh}insertOsfControl(f){return this.upa.insertOsfControl(f)}getManifestInvaildErrorString(){return this.upa.getManifestInvaildErrorString()}isAddinCommandsAsync(f,
G){this.upa.isAddinCommandsAsync(f,G)}isAddinCommandsExAsync(f,G){this.upa.isAddinCommandsExAsync(f,G)}ownerAddinControlRecreated(f,G){this.upa.ownerAddinControlRecreated(f,G)}queryEntitlementDetails(f){this.upa.queryEntitlementDetails(f)}}Object(ja.a)(Cj,"ContextActivationMgrWrapper",null,[910]);class pj{createAddinDataProvider(f,G){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(f,G.upa)}static get instance(){pj.Va||(pj.Va=new pj);return pj.Va}}pj.Va=null;Object(ja.a)(pj,"OSFAddinDataProviderFactory",
null,[840]);class Mj{constructor(f,G,fa,Ya,Kb,sc){this.xA=f;this.hs=G;this.nca=fa;this.displayName=Kb;this.w5f=sc}}Object(ja.a)(Mj,"PostLaunchAddinCommandsParameters",null,[]);class Ck{constructor(f){this.ied=null;this.cOe=f}get B2a(){return this.ied}geb(f,G){this.cOe.geb(f,void 0===G?null:G);this.ied=f}vie(f){this.cOe.vie(f)}MPg(f){this.ied=f}}Object(ja.a)(Ck,"RibbonExtensibilityManagerWithChangeDetection",null,[923]);var Nj=a(1080),Dk=a(106);class ij{static MHf(f){const G=new Ra.a;if(ij.Hhf)for(var fa of ij.Hhf)G.add(fa);
fa=null;switch(f){case "Workbook":fa=ij.zel;break;case "Document":fa=ij.shi;break;case "Presentation":fa=ij.C9j}if(fa)for(const Ya of fa)G.add(Ya);return G}}ij.Hhf=["PrimaryCommandSurface","ContextMenu"];ij.zel=null;ij.shi=null;ij.C9j=null;Object(ja.a)(ij,"ExtensionPointType",null,[]);class Xj{constructor(f){this.ETe=null;if(yf.c(f))throw ma.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.dhh=f}get e0b(){return this.ETe||
(this.ETe=new Ra.a)}get V5e(){return this.dhh}}Object(ja.a)(Xj,"ContextMenuExtensibility",null,[909]);class tj{constructor(f,G,fa){G=void 0===G?null:G;fa=void 0===fa?0:fa;if(yf.c(f))throw ma.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.cqh=f;this.vth=G;this.Slh=fa}get b7(){return this.cqh}get startedNode(){return this.vth}get kDi(){return this.Slh}}Object(ja.a)(tj,
"RibbonExtensibility",null,[926]);class Ek{constructor(f){this.Tkh=f.entitlement}get entitlement(){return this.Tkh}createActionContext(f,G){f={};f.ownerAddinInfo=this.entitlement;f.action=G;return f}}Object(ja.a)(Ek,"AddInCommandsContextProvider",null,[]);class sg{constructor(f,G,fa){this.OGe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=f;this.eventBuilder=G;this.contextMenuBuilder=fa}get addinInfo(){return this.OGe}n5h(f){return new Ek(f)}createActionBuilder(f,
G){return OfficeExt.DefaultControlActionBinder.createActionBuilder(f,G.entitlement,G.manifest)}startApplyAddin(f){this.OGe=f;const G=this.n5h(f);this.actionBuilder=this.createActionBuilder(G,f)}endApplyAddin(){}jJd(f,G,fa){fa=void 0===fa?0:fa;return this.ribbonBuilder.fC&&0<this.ribbonBuilder.fC.count?new tj(this.yCi(f,G),this.addinInfo.startedNode,fa):null}JCf(){var f=void 0===f?null:f;if(this.contextMenuBuilder.NMc&&0<this.contextMenuBuilder.NMc.count){f||(f=this.addinInfo.entitlement.solutionId);
f=new Xj(f);for(const G of this.contextMenuBuilder.NMc)f.e0b.add(G);return f}return null}yCi(f,G){return this.ribbonBuilder.fC&&0<this.ribbonBuilder.fC.count?new ec.a(this.ribbonBuilder.fC,f,G):null}}Object(ja.a)(sg,"AddinCommandsBuilder",null,[]);class ok{constructor(f,G,fa,Ya,Kb,sc,Tc){this.T8a=new Dk.a;this.xA=f;this.Dl=G;this.Ex=fa;this.ribbonManager=Ya;this.contextMenuManager=Kb;this.jL=sc;this.Yta=Tc;this.LZ=ea.AFrameworkApplication.ra.wL}HYb(f,G,fa,Ya,Kb,sc,Tc){const fd=(ud,Td,me,ne)=>{Kb(ud,
Td,me,ne);const Me=Nj.a[this.xA]+Td.assetId;let Df;(()=>{let Gf=this.T8a.wj(Me);({value:Df}=Gf);return Gf})().returnValue&&(Df.stop(),Df=null,this.T8a.remove(Me))};if(0!==this.xA&&f){ma.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",f.count);4===this.xA&&(ma.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Ya)),this.ZWh(f,Ya),sc());for(const ud of f)if(f=ud,ma.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,
f.ownerAddinStoreType||f.storeType,f.assetId,null,null,f.storeId))),this.V8g(f))if(Tc&&f.requireConsent)Tc(f,Td=>{try{if(this.LZ){const ne=Nj.a[this.xA]+Td.solutionId,Me=this.LZ.Li("ComponentAttach",ne);this.T8a.ga(ne,Me)}const me=this.jL.mwa(Td.storeType,Td.solutionId);6!==this.xA&&(me&&(this.vqc(me),me.YK.purge(!1)),this.Dl.insertOsfControl(this.T2b(Td,G,fa,fd)),me&&this.Dl.ownerAddinControlRecreated(Td.solutionId,Td.storeType))}catch(me){ma.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.solutionId,Td.ownerAddinStoreType||Td.storeType,Td.assetId,null,null,Td.storeId),Td.version,Td.storeType,Td.storeId,me.message)),fd(!1,Td,null,null)}});else try{if(this.LZ){const me=Nj.a[this.xA]+f.solutionId,ne=this.LZ.Li("ComponentAttach",me);this.T8a.ga(me,ne)}const Td=this.jL.mwa(f.storeType,f.solutionId);3!==ea.AFrameworkApplication.ra.$g.kn&&1!==ea.AFrameworkApplication.ra.$g.kn&&2!==ea.AFrameworkApplication.ra.$g.kn||3!==this.xA||"excatalog"===
f.storeType||!Td||Td.isUpgraded?6!==this.xA&&(Td&&(this.vqc(Td),Td.YK.purge(!1)),this.Dl.insertOsfControl(this.T2b(f,G,fa,fd)),Td&&this.Dl.ownerAddinControlRecreated(f.solutionId,f.storeType)):(this.ribbonManager.MPg(Td.Iw),fd(!0,f,null,Td.displayName))}catch(Td){ma.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.ownerAddinStoreType||
f.storeType,f.assetId,null,null,f.storeId),f.version,f.storeType,f.storeId,Td.message)),fd(!1,f,null,null)}else fd(!1,f,null,null)}}wvj(f,G,fa,Ya,Kb,sc){const Tc=(fd,ud,Td,me)=>{sc(fd,ud,Td,me);const ne=Nj.a[this.xA]+ud.solutionId;let Me;(()=>{let Df=this.T8a.wj(ne);({value:Me}=Df);return Df})().returnValue&&(Me.stop(),Me=null,this.T8a.remove(ne))};if(6===this.xA&&f)if(ma.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,
f.ownerAddinStoreType||f.storeType,f.assetId,null,null,f.storeId))),this.V8g(f))try{if(this.LZ){const ud=Nj.a[this.xA]+f.solutionId,Td=this.LZ.Li("ComponentAttach",ud);this.T8a.ga(ud,Td)}const fd=this.jL.mwa(f.storeType,f.solutionId);fd||Tc(!1,f,null,null);ea.AFrameworkApplication.ra&&ea.AFrameworkApplication.ra.$g.delayInstallAddInIsEnabled?this.qDf(f,G,Ya,Kb,fa,ud=>{Tc(ud,f,fa,fd.displayName)}):(this.qDf(f,G,Ya,Kb,fa),Tc(!0,f,fa,fd.displayName))}catch(fd){ma.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.ownerAddinStoreType||f.storeType,f.assetId,null,null,f.storeId),f.version,f.storeType,f.storeId,fd.message)),Tc(!1,f,null,null)}else Tc(!1,f,null,null)}RMj(f,G,fa,Ya,Kb,sc){if(sc)if(sc._isAddinCommandsManifest(this.Ex.kY))try{ea.AFrameworkApplication.ra&&ea.AFrameworkApplication.ra.$g.delayInstallAddInIsEnabled?this.pDf(f,G,fa,Kb,sc,Tc=>{Ya(Tc,f,sc,sc.getDefaultDisplayName())}):(this.pDf(f,G,fa,Kb,sc),Ya(!0,f,sc,sc.getDefaultDisplayName()))}catch(Tc){ma.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.ownerAddinStoreType||f.storeType,f.assetId,null,null,f.storeId),f.version,f.storeType,f.storeId,Tc.message)),Ya(!1,f,sc,sc.getDefaultDisplayName())}else ma.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.ownerAddinStoreType||f.storeType,f.assetId,null,null,f.storeId),f.version,f.storeType,f.storeId)),Ya(!1,f,null,null);else ma.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Ex.kY,Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.ownerAddinStoreType||f.storeType,f.assetId,null,null,f.storeId),f.version,f.storeType,f.storeId)),
Ya(!1,f,null,null)}T2b(f,G,fa,Ya){const Kb={},sc=document.createElement("div");sc.setAttribute("visible","false");Kb.div=sc;Kb.id=f.solutionId;Kb.solutionId=f.solutionId;Kb.version=f.version;Kb.storeType=f.storeType;Kb.storeId=f.storeId;Kb.assetId=f.assetId;Kb.assetStoreId=f.assetStoreId;Kb.isvirtualOsfControl=!0;Kb.virtualOsfControlActivationCallback=(Tc,fd)=>{const ud=this.jL.mwa(f.storeType,f.solutionId);ud&&(ud.isUpgraded&&(f.isUpgraded=!0),this.vqc(ud));this.RMj(f,G,fa,Ya,Tc,fd)};Kb.reason=3===
this.xA?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Kb}pDf(f,G,fa,Ya,Kb,sc){sc=void 0===sc?null:sc;const Tc={};Tc.solutionId=Ya.getSolutionId();Tc.version=Ya.getVersion();Tc.storeType=Ya.getStoreType();Tc.storeId=Ya.getStoreId();Tc.assetId=Ya.getAssetId();Tc.assetStoreId=Ya.getAssetStoreId();Tc.targetType=Ya.getOsfControlType();let fd=null,ud=null;if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))fd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Ex.kY,this.Ex.formFactor)).parseExtensions(Tc,Kb,this.Yta),ud=ij.MHf(this.Ex.kY);else try{fd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Ex.kY,this.Ex.formFactor)).parseExtensions(Tc,Kb,this.Yta),ud=ij.MHf(this.Ex.kY)}catch(me){throw ma.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+me.message),me;}if(ud&&0<ud.count){if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Td=G(f);G=fa(f);fa=!!ea.AFrameworkApplication.fa&&ea.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Td=new sg(Td,null,G);for(const me of ud)Td.commandSurface=me,fd.apply(Td,this.Yta,fa)}else try{const me=G(f),ne=fa(f),Me=!!ea.AFrameworkApplication.fa&&ea.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Td=new sg(me,null,ne);for(const Df of ud)Td.commandSurface=Df,fd.apply(Td,this.Yta,Me)}catch(me){throw ma.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
me.message),me;}if(OSF.OUtil.checkFlight(14))try{const me=Td.jJd(f.solutionId,Kb.getDefaultDisplayName()),ne=Td.JCf();me&&this.ribbonManager.geb(me,sc);ne&&this.contextMenuManager.d2e(ne);this.jL.M2e(Ya,me,ne,Kb.getDefaultDisplayName());ma.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Kb.getDefaultDisplayName())}catch(me){throw OfficeExt.DevConsole.log(me),ma.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+me.message),me;}else try{const me=Td.jJd(f.solutionId,
Kb.getDefaultDisplayName()),ne=Td.JCf();me&&this.ribbonManager.geb(me);ne&&this.contextMenuManager.d2e(ne);this.jL.M2e(Ya,me,ne,Kb.getDefaultDisplayName());ma.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Kb.getDefaultDisplayName())}catch(me){throw ma.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+me.message),me;}}}qDf(f,G,fa,Ya,Kb,sc){sc=void 0===sc?null:sc;const Tc={};Tc.solutionId=f.solutionId;Tc.version=f.version;Tc.storeType=f.storeType;Tc.storeId=
f.storeId;Tc.assetId=f.assetId;Tc.assetStoreId=f.assetStoreId;Tc.targetType=f.targetType;const fd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Ex.kY,this.Ex.formFactor);try{const ud=G.getManifest(),Td=fd.parse(Tc,ud,Kb,this.Yta,G.getSharedRuntimeId(),G),me=fa(f),ne=Ya(f),Me=new sg(me,null,ne);Me.commandSurface="PrimaryCommandSurface";Td.apply(Me,this.Yta,!0);if(Me.ribbonBuilder.fC&&0<Me.ribbonBuilder.fC.count){const Df=Me.jJd(f.solutionId,G.getManifest().getDefaultDisplayName(),1);ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.geb(Df,sc):Df&&this.ribbonManager.geb(Df,sc);this.jL.Syh(G,Df,Kb,G.getManifest().getDefaultDisplayName());ma.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",G.getManifest().getDefaultDisplayName())}}catch(ud){ma.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",G.getManifest().getDefaultDisplayName(),ud.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(ud)}}vqc(f){f.Iw&&this.ribbonManager.vie(f.Iw);
f.SLb&&this.contextMenuManager.Ijk(f.SLb);this.jL.rjk(f.YK.getStoreType(),f.YK.getSolutionId())}ZWh(f,G){G=nk.a(G);for(const fa of this.jL.dnb){if(fa.YK.getStoreType()!==G)continue;let Ya=!0;for(const Kb of f){const sc=Kb;if(sc&&fa.t2f(sc.storeType,sc.solutionId)){Ya=!1;break}}Ya&&(this.vqc(fa),fa.YK.purge(!1))}}V8g(f){return!!f&&!!f.solutionId&&!!f.version&&!!f.storeType&&!!f.storeId}}Object(ja.a)(ok,"AddInCommandsIntegration",null,[]);class pk{constructor(f,G,fa,Ya,Kb,sc,Tc,fd){fd=void 0===fd?null:
fd;this.hh=new wg.a;this.V6c=f;this.Bjh=G;this.Cr=fa;this.h_e=Ya;this.Hcb=Kb;this.Sgh=sc;this.scc=Tc;this.Uph=fd}ZAh(f){this.hh.addHandler(Dc.a.l5e,f)}cDh(f){this.hh.addHandler(Dc.a.z6f,f)}IEh(f){this.hh.addHandler(Dc.a.iUg,f)}eBh(f){this.hh.addHandler(Dc.a.csd,f)}Uvj(f,G,fa){const Ya=fa[Dc.a.hIb],Kb=void 0===fa[Dc.a.U3]?0:fa[Dc.a.U3];if(Ya&&0!==Kb)if(0>=Ya.count&&4!==Kb)this.Xvg(new Mj(Kb,null,null,G,null,!0));else{var sc=Ya.count,Tc=new Ck(new Jc),fd=void 0===fa[Dc.a.T9]?-1:fa[Dc.a.T9],ud=new ok(Kb,
this.Cr,this.V6c,Tc,this.Bjh,this.Hcb,this.scc),Td=Gf=>this.h_e.zPh(Gf.solutionId,this.scc,this.V6c,f),me=Gf=>this.h_e.KOh(Gf.solutionId),ne=(Gf,Cf,xf)=>{sc--;xf=new Mj(Kb,Cf,Tc,G,xf,0>=sc);if(Gf&&Cf)this.Xvg(xf);else{if(3===Kb||Cf&&Cf.isUpgraded)Gf="",Cf&&(Gf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Cf.solutionId,Cf.ownerAddinStoreType||Cf.storeType,Cf.assetId,null,null,Cf.storeId)),yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:kd.a.Pm({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Gf})});this.Wvg(xf)}sc||ea.AFrameworkApplication.ra.UB()},Me=(Gf,Cf,xf,cg)=>{ne(Gf,Cf,cg)},Df=()=>{this.J7d();0>=Ya.count&&4===Kb&&this.Hcb.ape()};6===Kb?(fd=fa[Dc.a.lYa],fa=fa[Dc.a.mYa],ud.wvj(Ya.na(0),fd,fa,Td,me,(Gf,Cf,xf,cg)=>{ne(Gf,Cf,cg)})):ud.HYb(Ya,Td,me,fd,Me,Df,this.Uph)}else yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:kd.a.Pm({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",
["SDX_Id"]:""})}),ma.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.V6c.kY)),this.Wvg(new Mj(Kb,null,null,G,null,!0))}Wvg(f){this.J7d(f);this.oVg(!1,f)}Xvg(f){const G=f.hs;let fa=null;null!==G&&(fa=G.storeType,fa=fa.toLowerCase());if(f&&"omex"===fa&&(3===f.xA||G.isUpgraded)){var Ya={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||
G.storeType,G.assetId,null,null,G.storeId)};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:kd.a.Pm(Ya)})}this.J7d(f);Ya=mk()&&"omex"===fa&&!!f.nca&&!!G.solutionId&&2===f.xA&&G.solutionId.toLowerCase()===Aj().toLowerCase();var Kb="excatalog"===fa&&3===f.xA;if("omex"===fa&&f.nca&&(3===f.xA&&"hardcodedpreinstall"!==fa||G.isUpgraded)||Ya||Kb)Ya=new kj,Ya.hs=G,Ya.Iw=f.nca.B2a,this.hh.raiseEvent(Dc.a.csd,Ya);Ya=Ni();Kb=Aj();Ya&&G&&"excatalog"===G.storeType&&f.nca&&5===f.xA&&
Kb&&(G.storeId&&G.storeId.toLowerCase()===Kb.toLowerCase()||G.assetId&&G.assetId.toLowerCase()===Kb.toLowerCase())&&(Ya=new kj,Ya.hs=G,Ya.Iw=f.nca.B2a,this.hh.raiseEvent(Dc.a.csd,Ya),ma.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));G&&(pd.instance.MNg(nk.b(fa),!0),"uploadfiledevcatalog"===fa&&(Ya=this.Sgh.createAddinDataProvider(fa,this.Cr))&&Ya.localCacheAddinCommands(this.Cr.upa,G.solutionId,G.version,G.storeId),wb.a.DQa(Dc.a.Ipd,"true",nk.b(fa)));this.oVg(!0,
f)}oVg(f,G){f?G.nca&&5===G.xA&&G.nca.B2a&&void 0!==G.hs.showCallout&&null!==G.hs.showCallout&&G.hs.showCallout?((new ci(this.hh)).Zxh(G.hs,ec.a.wQb(G.nca.B2a)),f=new kj,f.Iw=G.nca.B2a,f.hs=G.hs,this.hh.raiseEvent(Dc.a.iUg,f)):3!==G.xA?G.w5f&&this.Hcb.ape():G.nca&&G.nca.B2a&&"hardcodedpreinstall"!==G.hs.storeType&&td.a.YNk(G.displayName,G.nca.B2a,G.hs.isAutoLaunched):3===G.xA?G.hs&&"uploadfiledevcatalog"===G.hs.storeType.toLowerCase()?(G=this.scc.QKi(G.hs.solutionId),td.a.Ise(G?G:Object(Gb.a)("InternalError")+
" "+Object(Gb.a)("InternalError_Directive"))):this.Hcb.WOg():G.w5f&&this.Hcb.ape()}J7d(f){var G=(f=void 0===f?null:f)?f.hs:null;const fa=new kj;if(fa.hs=G){var Ya=this.Hcb.mwa(G.storeType,G.solutionId,6===f.xA?1:0);if(Ya&&Ya.Iw){fa.Iw=Ya.Iw;var Kb=Aj();Kb=mk()&&!!G.solutionId&&!!Kb&&G.solutionId.toLowerCase()===Kb.toLowerCase()&&2===f.xA;if(3===f.xA&&"hardcodedpreinstall"!==G.storeType||Kb)f="",Ya.Iw.b7&&Ya.Iw.b7.fC&&(Ya=Ya.Iw.b7.fC.na(0))&&(f=Ya.id),G={["SDX_CommandPlacement"]:f,["SDX_PinningAction"]:"Pinning",
["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,G.ownerAddinStoreType||G.storeType,G.assetId,null,null,G.storeId)},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:kd.a.Pm(G)})}}this.hh.raiseEvent(Dc.a.l5e,fa)}}Object(ja.a)(pk,"LaunchAddinCommandsHandler",null,[913]);class gh{}gh.C$a="Alt";gh.D$a="Command";gh.id="Id";gh.G$a="Image16by16";gh.Zbc="LabelText";gh.J$a="Title";gh.GROUP="Group";gh.sEe="Groups";gh.iAb=
"Controls";gh.button="Button";gh.Wma="FlyoutAnchor";gh.LARGE="Large";gh.SMALL="Small";Object(ja.a)(gh,"AddinDataNodeConstants",null,[]);var fl=a(289);a(664);var vj=a(488);class Fk{constructor(f,G){this.oTa=this.uJe=null;if(yf.c(f)||yf.c(G))throw ma.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Ijh=G;this._id=f;this.t4[gh.id]=this._id}get id(){return this._id||""}get t4(){return this.uJe||
(this.uJe={})}get controlType(){return this.Ijh||""}get menuItems(){return this.oTa||(this.oTa=new Ra.a)}}Object(ja.a)(Fk,"ControlDefinition",null,[883]);class gl{constructor(f){this.mSe=null;if(yf.c(f))throw ma.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=f;this.oza[gh.id]=this._id}get oza(){return this.mSe||(this.mSe={})}get id(){return this._id||""}}Object(ja.a)(gl,"MenuItemDefinition",
null,[882]);class Zi{constructor(f){this.BDa=null;if(yf.c(f))throw ma.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=f}get id(){return this._id}get controls(){return this.BDa||(this.BDa=new Ra.a)}}Object(ja.a)(Zi,"OfficeMenuDefinition",null,[841]);var lg=a(26);class Yj{constructor(f,G,fa){this.BT=this.wab=null;this.bgd=f;this.lab=G;this.M$a=fa;this.tph=new Ra.a}get rNc(){return this.bgd}get sLb(){return this.lab}get Bmd(){return this.M$a}addButton(f){ma.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",f.actionType);this.BT=new Fk(this.CGa(f.id),gh.button);this.BT.t4[gh.Zbc]=f.label;this.BT.t4[gh.C$a]=f.label;this.BT.t4[gh.G$a]=f.icon["16"];this.vJb(this.BT.t4[gh.id],f.action);this.QUa(this.BT.t4);this.wab.controls.add(this.BT);this.BT=null}startBuildMenu(f){if(yf.c(this.wab))this.wab=new Zi(f.id);else{const G=this.CGa(f.id);this.BT=new Fk(G,gh.Wma);this.Wfb(this.BT.t4,f);this.BT.t4[gh.G$a]=f.icon["16"];this.BT.t4[gh.D$a]=lg.a.alwaysEnabled}}addMenuItem(f){ma.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",f.actionType);const G=new gl(this.CGa(f.id));this.Wfb(G.oza,f);f.icon&&(G.oza[gh.G$a]=f.icon["16"]);this.vJb(G.oza[gh.id],f.action);this.QUa(G.oza);this.BT.menuItems.add(G)}endBuildMenu(){yf.c(this.BT)?(this.NMc.add(this.wab),this.wab=null):(this.wab.controls.add(this.BT),this.BT=null)}get NMc(){return this.tph}vJb(f,G){this.Bmd.bindAction(f,G)}QUa(f){this.sLb.QUa(f)}CGa(f){return this.rNc.HZa(f)}Wfb(f,G){f[gh.Zbc]=G.label;f[gh.C$a]=G.label}}Object(ja.a)(Yj,
"ContextMenuExtensibilityCreator",null,[869,865]);class qj{constructor(f){this.wEb=f}get y_b(){return this.wEb}HZa(f){return this.y_b+f}}Object(ja.a)(qj,"DefaultContextMenuNamingProvider",null,[868]);var Gk=a(1453);class Hk{bindAction(f,G){OfficeExt.DefaultControlActionBinder.bindAction(f,G)}}Object(ja.a)(Hk,"DefaultUIControlActionBinder",null,[866]);class hl{constructor(f){this.XRa=f}get command(){return this.XRa}QUa(f){f[gh.D$a]=this.command}}Object(ja.a)(hl,"DefaultUIControlCommandBinder",null,
[863]);var Zj=a(34);class ak{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(ja.a)(ak,"AddInControl",null,[]);class $i{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(ja.a)($i,"AddInGroup",null,[]);class il{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(ja.a)(il,"AddInMenuItem",null,[]);class Ik{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(ja.a)(Ik,"AddInTab",null,[]);class qk{constructor(f,G,fa,Ya,Kb,sc){this.pcc=new Ra.a;this.BBb=this.Rra=this.xab=null;this.bgd=f;this.M$a=G;this.lab=fa;this.IG=Ya;this.scc=Kb;this.zLe=sc}get rNc(){return this.bgd}get fC(){return this.pcc}get Bmd(){return this.M$a}get sLb(){return this.lab}startBuildTab(f){const G=f.isOfficeTab?f.id:this.rNc.xMf(f.id),
fa=f.isOfficeTab?null:f.label;this.xab=Object.assign(new Ik,{id:G,title:fa,isOfficeTab:f.isOfficeTab,visible:f.visible,groups:[],tabType:f.tabType,insertBefore:f.insertBefore,insertAfter:f.insertAfter,autoFocus:f.autoFocus})}startBuildGroup(f){const G=this.CGa(f.id);this.Rra=Object.assign(new $i,{id:G,mlrId:f.mlrId,title:f.label,controls:[],groupType:0})}addNativeGroup(f){this.Rra=Object.assign(new $i,{id:f.id,mlrId:f.mlrId,title:f.label,controls:[],groupType:1});this.xab.groups.push(this.Rra)}addButton(f){const G=
this.CGa(f.id);G&&(this.vJb(G,f.action),ma.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",f.actionType),f=Object.assign(new ak,{id:G,title:f.label,iconLocation:this.ZLd(f),enabled:f.enabled,controlType:0,attributes:this.Wfb()}),this.zLe.P1e(new Zj.a(G,this.sLb.command.toString())),this.Rra.controls.push(f))}addNativeControl(f){f.id&&(ma.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",f.actionType),f=Object.assign(new ak,{id:f.id,
title:"",iconLocation:"",enabled:f.enabled,controlType:2,attributes:this.Wfb()}),this.Rra.controls.push(f))}startBuildMenu(f){const G=this.CGa(f.id);G&&(this.BBb=Object.assign(new ak,{id:G,title:f.label,iconLocation:this.ZLd(f),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(f){const G=this.CGa(f.id);G&&(this.vJb(G,f.action),ma.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",f.actionType),f=Object.assign(new il,{id:G,title:f.label,iconLocation:this.ZLd(f),
enabled:f.enabled,attributes:this.Wfb()}),this.zLe.P1e(new Zj.a(G,this.sLb.command.toString())),this.BBb.menuItems.push(f))}endBuildMenu(){yf.c(this.BBb.id)||this.Rra.controls.push(this.BBb);this.BBb=null}endBuildGroup(){yf.c(this.Rra.id)||this.xab.groups.push(this.Rra);this.Rra=null}endBuildTab(){yf.c(this.xab.id)||this.pcc.add(this.xab);this.xab=null}Wfb(){const f={};this.QUa(f);return f}ZLd(f){return f.icon["80"]?f.icon["80"]:f.icon["32"]}QUa(f){this.sLb.QUa(f)}CGa(f){return this.rNc.HZa(f)}vJb(f,
G){this.Bmd.bindAction(f,G)}}Object(ja.a)(qk,"OneLineRibbonExtensibilityCreator",null,[864,865]);class rk{constructor(f,G){this.wEb=f;this.M$a=new Hk;this.lab=new hl(G)}KOh(f){f=new qj(f);return new Yj(f,this.lab,this.M$a)}zPh(f,G,fa,Ya){fa=new Gk.a(this.wEb,f,fa,!0);return new qk(fa,this.M$a,this.lab,f,G,Ya)}}Object(ja.a)(rk,"UIExtensibilityFactory",null,[839]);var Oj=a(1113);class ki{get Bah(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&
ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}constructor(f){this.cVa=this.gVa=this.hs=this.Iw=null;this.RDg=0;this.HVj=()=>{if(this.hs&&this.cVa){const G=new sb.a(lg.a.qea,0,0,2,null);this.addinUICommandHandler.executeCommand(0,G,{["SourceControlId"]:this.cVa},null);ma.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.ZNk=(G,fa)=>{G=null;if(fa)if(G=fa,this.hs=G.hs,(this.Iw=G.Iw)&&this.Iw.b7&&this.Iw.b7.fC&&
(this.gVa=this.Iw.b7.fC.na(0)),this.gVa&&this.gVa.id)if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)&&this.RPg(),this.gVa.isOfficeTab)if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)||this.RPg(),this.cVa)if(Ad.a.contains(this.gVa.id,Te.a.HS,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ec.a.wQb(this.Iw),()=>{this.aWg(this.BNd(this.cVa))});
else{if(fa=this.$.Ma)fa.zpd(this.hrg),ma.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else ma.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),fa={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(fa)}),
this.zha();else this.cWg(this.BNd(this.gVa.id),0);else ma.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),fa={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(fa)}),this.zha();else this.zha()};this.hrg=()=>{if(Ad.a.contains(this.gVa.id,
appChrome.selectors.getSelectedTabId(),!0)){var G=this.$.Ma;G&&G.TFg(this.hrg);this.aWg(this.BNd(this.cVa))}};this.KVj=()=>{var G={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ki.E$a(this.pM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(G)});this.zha();const fa={};fa[vb.a.Wk]=this.pM;G={};G.solutionId=this.pM.solutionId;G.assetId=this.pM.assetId;
G.assetStoreId=this.pM.assetStoreId;G.height=0!=this.pM.height?this.pM.height:600;G.storeId=this.pM.storeId;G.storeType=this.pM.storeType;G.targetType=this.pM.targetType;G.width=0!=this.pM.width?this.pM.width:600;G.displayName=this.pM.displayName;G.version=this.pM.version;G.isAddinCommands=!1;fa[Dc.a.S9]=G;const Ya=new sb.a(-741808261,0,0,2,null);Qa.TaskExtensions.Xa(jd.GetServiceTaskFactory.Tj(this.$.la,374,375,1),Kb=>{Kb=Kb.result;null!=Kb&&Kb.insertAgave(fa,Ya)},this.$.ya,3)};this.TOj=()=>{const G=
{["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ki.E$a(this.pM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(G)});this.zha()};this.BQj=()=>{const G={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ki.E$a(this.pM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:kd.a.Pm(G)});this.zha()};this.lAa=G=>{ma.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${G?G.httpStatus:-1}`)};this.$=f.$;this.addinUICommandHandler=f;this.appName=ea.AFrameworkApplication.fa.Za("WebAppShortName")||"Excel";this.xFh=ea.AFrameworkApplication.fa.Lj("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,
f.storeId)}static E$a(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}Hik(f){this.pM=f;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.KVj,!0),window.addEventListener("DismissCallout",this.BQj,!0),window.addEventListener("CloseCallout",this.TOj,!0))}RPg(){var f=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();const G=this.hs.solutionId;G in f?this.cVa=f[G]:(f=ki.GetPrivacyCompliantId(this.hs),
ma.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${f}`),this.cVa=this.VDi(this.Iw))}BNd(f){return"[id="+f+"]"}cWg(f,G){G>this.xFh?(window.clearTimeout(this.RDg),this.bWg("[data-unique-id='pivotOverflowButton']"),ma.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+f)?this.bWg(f):this.RDg=window.setTimeout(()=>{this.cWg(f,G+1)},1E3)}aWg(f){var G=document.querySelector("button[data-unique-id='RightPaddle']");
if(G)f={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)});else if(G=document.querySelector("button"+f),!G||"none"===window.getComputedStyle(G).display)if(G=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!G){G={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(G)});ma.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.zha();return}this.b2g(G,"ShowTeachingUIForAddinButton")}bWg(f){f=document.querySelector("button"+f);if(!f&&(f=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!f)){f={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)});ma.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.zha();return}this.b2g(f,"ShowTeachingUIForAddinTab")}b2g(f,G){f.setAttribute("lpp-id","latestAddin");const fa=
Ab.a.instance.fj("Common.ISystemInitiatedFeedback");fa&&f?(fa.execute(Ya=>{Ya.logActivity(G,null)}),f={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)}),ma.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(ma.ULS.sendTraceTag(537170689,
220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),f={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:ki.GetPrivacyCompliantId(this.hs),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)}),this.zha())}VDi(f){if(f&&(f=f.b7,(null===f||void 0===f?0:f.fC)&&0<f.fC.count))for(const G of f.fC)if(G.groups&&0<G.groups.length)for(const fa of G.groups)if(fa.controls&&
0<fa.controls.length)for(const Ya of fa.controls){if(Ya.attributes&&0===Ya.controlType&&Ya.enabled)return Ya.id;if(Ya.menuItems)for(const Kb of Ya.menuItems)if(Kb.attributes&&Kb.enabled)return Ya.id}}$Vg(){var f="button[data-unique-id = 'Ribbon-InsertAppsForOffice']";va.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&(f=this.Bah?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":f);if((f=document.querySelector(f))&&"none"!==window.getComputedStyle(f).display)ma.ULS.sendTraceTag(527286666,
220,15,"Callout show on OfficeAddin Button");else{f=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==f){f={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:ki.E$a(this.pM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)});ma.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");
this.zha();return}ma.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const G=Ab.a.instance.fj("Common.ISystemInitiatedFeedback");null==G||null==f?(f={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:ki.E$a(this.pM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)}),ma.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),
this.zha()):(G.execute(fa=>{fa.logActivity("ShowTeachingUIForContentAddin",null)}),f={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:ki.E$a(this.pM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm(f)}),ma.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}vWc(f){const G={},fa={};fa.LastTeachingUIShowTime=(new Date).toUTCString();
fa.AddinHasShown=f;G[this.appName]=qf.c(fa);this.lIb=new Yi(this.appName,null,null,this.lAa),this.lIb.cxc(G),ma.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}zha(){if(!this.bWc){const f=window.g_roamingAddinList;f&&(this.vWc(f),this.bWc=!0)}}}Object(ja.a)(ki,"AddinTeachingCalloutHandler",null,[]);var sk=a(1389),wj=a(308),Pj=a(48),yj=a(240),Eh=a(247);class Qj extends yj.a{constructor(f,G,fa,Ya){super();this.X8=
"calc(100% - 46px)";this.aka="15px";this.Y8="0";this.XBb="WACDialogPanel";this.PN=695;this.YBb=462;this.JL="80%";this.IAb=350;this.rDa="100%";this.h3=null;this.Ph=5;this.kl="AddinInstallDialog";this.Ihh=f;this.l9=G;this.Uuh=fa;this.$ph=Ya}nG(){super.nG();this.Xo.style.width=this.rDa;this.Xo.style.height=this.X8;this.Xo.style.marginTop=this.aka;this.Xo.style.padding=this.Y8;document.getElementById(this.hp("WACDialogButtonPanel")).style.display="none";this.Rua.setAttribute("tabindex","0");$addHandler(this.Rua,
"keyup",Object(If.a)(this,this.onKeyUp,"onKeyUp"));const f=document.createElement("iframe");f.setAttribute("id","InstallAddinDialog");f.setAttribute("src","about:blank");f.setAttribute("width","100%");f.setAttribute("height","100%");f.setAttribute("marginHeight","0");f.setAttribute("marginWidth","0");f.setAttribute("frameBorder","0");f.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const G=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.Ihh,this.l9,this.Uuh);f.setAttribute("src",G);this.h3=f;$addHandler(f,"load",Object(If.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(If.a)(this,this.onMessage,"onMessage"));this.Xo.appendChild(f);this.Xo.appendChild(this.k6h())}k6h(){const f=document.createElement("div");f.setAttribute("tabindex","0");$addHandler(f,"focus",Object(If.a)(this,this.eWj,"onLoopPivotFocus"));return f}onKeyUp(f){13!==f.keyCode&&32!==f.keyCode||this.hide()}eWj(){this.Rua.focus()}onLoad(){this.h3.focus()}onMessage(f){f=
f.rawEvent;if(f.source===this.h3.contentWindow&&(f=(f=f.data)?f.split("|"):null)&&0<f.length&&("REFRESH_REQUIRED"===f[0]||"PRELOAD_MANIFEST"===f[0])){Z.a.instance.setItem("refreshRequired","true");const G={};G.solutionId=f[1];G.version=Qj.nKj(f[3]);G.storeType=f[4];G.storeId=f[5];G.assetId=f[6];G.targetType=Qj.G4j(f[2]);G.assetStoreId=f[7];G.width=parseInt(f[8]);G.height=parseInt(f[9]);this.$ph(G)}}wAa(){this.Xo.style.width=this.rDa;this.Xo.style.height=this.X8;this.Xo.style.marginTop=this.aka;this.Xo.style.padding=
this.Y8;this.PN>Eh.a.Lba?(this.ph.style.width=String.format("{0}px",Eh.a.Lba),this.ph.style.overflowX="scroll",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0"):(this.ph.style.width=String.format("{0}px",this.PN),this.ph.style.overflowX="hidden");this.ph.offsetHeight>Eh.a.L1||this.YBb+50>Eh.a.L1?(this.ph.style.height=String.format("{0}px",Eh.a.L1),this.ph.style.overflowY="scroll",this.ph.style.top="0",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left=
"0",this.Xo.style.minHeight=String.format("{0}px",this.IAb)):(this.ph.style.overflowY="hidden",this.ph.style.top="10%",this.ph.style.height=this.JL);this.Pla()}Pla(){if(this.ph){var f=this.ph.style.zIndex;this.ph.style.zIndex="-9999";if(this.PN>Eh.a.Lba)ea.AFrameworkApplication.isRtl?this.ph.style.marginRight="0":this.ph.style.marginLeft="0";else{const G=String.format("{0}px",Math.floor(-this.ph.offsetWidth/2));ea.AFrameworkApplication.isRtl?this.ph.style.marginRight=G:this.ph.style.marginLeft=G;
ea.AFrameworkApplication.isRtl?this.ph.style.right="50%":this.ph.style.left="50%"}this.ph.style.zIndex=String(f)}else ma.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}dT(){super.dT();const f=document.getElementById(this.hp(this.XBb));f.style.width=String.format("{0}px",this.PN);f.style.height=this.JL}get xma(){return this.Xo}dispose(){super.dispose();$removeHandler(window,"message",Object(If.a)(this,this.onMessage,"onMessage"))}static G4j(f){switch(f){case "1":return 0;
case "2":return 1;default:return 0}}static nKj(f){const G=f.split(".");for(let fa=0;fa<4-G.length;fa++)f+=".0";return f}}Object(ja.a)(Qj,"AddinInstallDialog",yj.a,[]);class Jk{constructor(){this.addInDetails=this.title=null}}Object(ja.a)(Jk,"AddInCategoryData",null,[]);class tk{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(ja.a)(tk,"AddInDetailData",null,[]);class uk{constructor(){this.href=this.text=null}}Object(ja.a)(uk,"AddInLinkData",null,
[]);var Dj=a(1048),Ej;(function(f){f[f.hjl=0]="S_OK";f[f.fhl=-2147471590]="E_REQUEST_TIME_OUT";f[f.ghl=-2147208619]="E_USER_NOT_SIGNED_IN";f[f.Ygl=-2147471591]="E_CATALOG_ACCESS_DENIED";f[f.$gl=-2147471589]="E_CATALOG_REQUEST_FAILED";f[f.chl=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";f[f.ehl=-2147208617]="E_PROVIDER_NOT_REGISTERED";f[f.bhl=-2147208637]="E_OEM_CACHE_SHUTDOWN";f[f.dhl=-2147209421]="E_OEM_REMOVED_FAILED";f[f.Zgl=-1]="E_CATALOG_NO_APPS";f[f.hhl=-2]="E_USER_NO_MAILBOX";f[f.ahl=-1E3]="E_GENERIC_ERROR";
f[f.gjl=10]="S_HIDE_PROVIDER"})(Ej||(Ej={}));Object(ja.b)("InvokeResultCode",Ej);class Kk{constructor(f,G){this.Ha=G;this.Rw=f}get sQk(){return this.Ha?this.Ha.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}GVg(f){return this.sQk?f.failure?-2147208619===f.failure.invokeResultCode:!1:!1}fIf(f,G){return`invokeFailure/${3===f.errorCode&&f.failure?Ej[f.failure.invokeResultCode]:""}/${3===G.errorCode&&G.failure?Ej[G.failure.invokeResultCode]:""}`}m8f(f,G,fa,Ya){f={["Source"]:this.Rw,
["MRUListNumber"]:f.toString(),["MyAddinsErrorCode"]:Dj.a[G.errorCode],["MyAddInsResult"]:G.Dt.length.toString(),["MyAddinsInvokeResultCode"]:G.failure?G.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:Dj.a[fa.errorCode],["AdminManagedResult"]:fa.Dt.length.toString(),["AdminManageInvokeResultCode"]:fa.failure?fa.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:Ya?Dj.a[Ya.errorCode]:"N/A",["PopularAddinsResult"]:Ya?Ya.Dt.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:Ya&&
Ya.failure?Ya.failure.invokeResultCode:"N/A"};this.rLk&&(f.MyAddinsQueryStart=this.BBc(G.failure),f.AdminManagedQueryStart=this.BBc(fa.failure),f.PopularQueryStart=this.BBc(Ya.failure));yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:kd.a.Pm(f)})}l8f(f,G,fa,Ya,Kb){fa={["MyAddinsResult"]:this.itd(fa),["AdminManagedResult"]:this.itd(Ya),["PopularResult"]:this.itd(Kb)};f={["Source"]:this.Rw,["Abnormals"]:G.join("|"),["NumAddinsInMRU"]:f.toString(),["DiagnosticDetails"]:JSON.stringify(fa)};
yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",dataFields:kd.a.Pm(f)})}itd(f){return{["Count"]:f.Dt.length.toString(),["QueryStart"]:this.BBc(f.failure),["ErrorCode"]:Dj.a[f.errorCode],["InvokeResultCode"]:f.failure?f.failure.invokeResultCode:"N/A"}}get H_g(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get h8f(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}BBc(f){let G=
"N/A";f&&f.queryStart&&window.performance.timeOrigin&&(G=(new Date(window.performance.timeOrigin+f.queryStart)).toISOString());return G}get rLk(){return this.Ha?this.Ha.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(ja.a)(Kk,"AddinEntryPointCommon",null,[]);class Lk{constructor(f,G,fa){this.Lja=0;this.VMe=!1;this.dGb=[];this.ARa=void 0;this.Ha=f;this.Kja=G;this.whd=fa;ma.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}W3a(f,G){f&&G&&this.ELk(G)&&this.qvg()}ELk(f){0===
f.WL&&(this.Lja|=1);1===f.WL&&(this.Lja|=2);2===f.WL&&(this.Lja|=4);return!!this.Lja}qvg(){const f=[];let G=null;const fa={},Ya=this.Ooj,Kb=this.wHj,sc=this.Kja.zR(0),Tc=this.Kja.zR(1),fd=this.Kja.zR(2);(2===sc.errorCode||this.Wxb&&2===fd.errorCode)&&!Kb.length?(G=this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?{ariaDescription:Object(Gb.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(Gb.a)("AddinPickerDisableError"),title:Object(Gb.a)("AddInBackstageErrorViewTitle"),
linkText:Object(Gb.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",ea.AFrameworkApplication.uiCulture),onLinkClicked:()=>{ma.ULS.sendTraceTag(507875924,220,15,"User has clicked link on add-in backstage error view")}}:{ariaDescription:Object(Gb.a)("AddinPickerDisableError"),iconName:"StoreDisabled",
label:Object(Gb.a)("AddinPickerDisableError"),title:Object(Gb.a)("AddInBackstageErrorViewTitle")},f.push("storeDisabled")):3!==sc.errorCode||this.V3.GVg(sc)||3!==Tc.errorCode?4!==sc.errorCode||Kb.length?!this.u1f&&(!this.Uaa||0!==fd.errorCode&&5!==fd.errorCode)||fd.Dt.length||(ma.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.Lja,fd.errorCode),f.push("emptyCategory")):(G={ariaDescription:Object(Gb.a)("AddinPickerServiceDisconnectedError"),
iconName:"StoreDisabled",label:Object(Gb.a)("AddinPickerServiceDisconnectedError"),title:Object(Gb.a)("AddInBackstageErrorViewTitle")},f.push("serviceDisabled")):(G={ariaDescription:Object(Gb.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(Gb.a)("AddinPickerGeneralError"),title:Object(Gb.a)("AddInBackstageErrorViewTitle")},f.push(this.V3.fIf(sc,Tc)));this.M$b&&this.V3.m8f(Kb.length,sc,Tc,fd);const ud=!G;!ud||Ya||Kb.length?(ud?(fa.mruAddIns=Kb,Ya&&(fa.categories=this.O6j)):fa.errorViewProps=
G,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(fa,ud)),Ya&&ud&&!this.VMe&&(this.VMe=!0,ma.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.Lja))):f.push("emptyPage");this.M$b&&(this.V3.H_g&&ma.ULS.sendTraceTag(508047441,220,15,`${f.join("|")}`),this.V3.h8f&&this.V3.l8f(Kb.length,f,sc,Tc,fd))}get u1f(){return!!(this.Lja&4)}get M$b(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",
!1)}get Ooj(){const f=this.Kja.zR(2);return(this.u1f||this.Uaa||this.M$b)&&(0===f.errorCode||5===f.errorCode)&&!!f.Dt.length}get O6j(){var f=this.XIi();0<f.length&&(this.whd=f);if(yf.c(this.whd))return[];var G=JSON.parse(this.whd);f=[];for(var fa of G)G=Object.assign(new Jk,{title:fa.title,addInDetails:[]}),this.xOh(G,fa.solutionIds),0<G.addInDetails.length&&Array.add(f,G);0<this.dGb.length&&(fa=this.Kja.zR(2),ma.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",
this.dGb.length,this.dGb,fa.Dt.length),this.dGb=[]);return f}get wHj(){var f=[],G=this.Kja.zR(0);Array.addRange(f,G.Dt);G=this.Kja.zR(1);Array.addRange(f,G.Dt);f.sort((fa,Ya)=>{fa=De.d(fa.displayName);Ya=De.d(Ya.displayName);return Sd.a.localeCompare(fa,Ya)});G=[];for(const fa of f)f=Object.assign(new tk,{description:fa.description,displayName:fa.displayName,solutionId:fa.solutionId,uniqueId:this.xQb(fa)}),Array.add(G,f);return G}xOh(f,G){const fa=this.xHj;let Ya=0;for(const Kb of G){if(4===Ya)break;
if(fa.contains(Kb))continue;G=this.Kja.TI(Kb);if(!G){this.dGb.push(Kb);continue}const sc=Object.assign(new tk,{description:G.description,displayName:G.displayName,solutionId:G.solutionId,uniqueId:this.xQb(G)});sc.links=[Object.assign(new uk,{text:Object(Gb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+G.solutionId})];Array.add(f.addInDetails,sc);++Ya}}get xHj(){const f=[];var G=this.Kja.zR(0);Array.addRange(f,G.Dt);G=this.Kja.zR(1);Array.addRange(f,G.Dt);G=new Cb.a(gc.a.zm());
for(const fa of f)G.add(fa.solutionId);return G}xQb(f){return this.Uaa?String.format("{0}#{1}",f.solutionId,f.storeId):f.solutionId}get Uaa(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}XIi(){return this.Ha?this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get Wxb(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}get V3(){this.ARa||
(this.ARa=new Kk("Backstage",this.Ha));return this.ARa}}Object(ja.a)(Lk,"AddInCategoryManager",null,[]);var Rj=a(1049),bk=a(669);class Fj{constructor(f,G,fa){this.amountToShowWhenCollapsed=f;this.expandButton=G;this.collapseButton=fa}}Object(ja.a)(Fj,"GallerySectionCollapse",null,[]);class zj{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(ja.a)(zj,"GallerySectionProps",null,[]);var Sj=a(1207);class Tj{constructor(){this.text=this.href=null}}
Object(ja.a)(Tj,"LinkProps",null,[]);var ck=a(1114),Mk=a(1251),vk=a(288),wl=a(241);class Nk{constructor(f,G,fa){this.LHh="appsource";this.primaryKey="f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.iyk="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.Ha=f;this.HW=G;this.Ioh=void 0===fa?"en":fa;this.Bl=new Md(this.Ha);this.sUe=this.VPh();this.jD={};this.Vlh=this.Bl.sFh}rne(f,G,fa,Ya,Kb){Ya=void 0===Ya?15:Ya;Kb=void 0===Kb?!1:Kb;var sc=new vk.QueryStringBuilder("search"),
Tc={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};Tc.applicableProducts=this.HW;Tc.supportedProducts=this.HW+"_Online";Tc.Language=this.Ioh;Tc.searchQuery=f;Tc.top=Ya.toString();this.v8e("AppSource",Tc);for(const ud in Tc)sc.cq(ud,Tc[ud]);sc="https://catalogapi.azure.com/"+sc.toString();Tc={};Tc["X-API-Key"]=Kb?this.iyk:this.primaryKey;Tc["X-ms-app"]=this.LHh;const fd=window.performance.now();
this.executeRequest(sc,1,Tc,ud=>{let Td="Query Succeeded",me=!0,ne=0;const Me=[],Df=[];ud=ud.data.responseData;try{var Gf=JSON.parse(ud);ne=Gf.totalCount;const Cf=Gf.results;for(Gf=0;Gf<Cf.length;Gf++){const xf=Cf[Gf],cg={};cg.solutionId=xf.uniqueProductId.toLowerCase();cg.displayName=xf.displayName;cg.description=xf.longSummary;cg.iconUrl=xf.smallIconUri;cg.assetId=cg.solutionId;cg.storeId="en-US";cg.storeType="omex";cg.assetStoreId="omex";Me.push(cg);this.jD[cg.solutionId]=cg;Df.push(xf.popularity)}}catch(Cf){Td=
"Exception thrown from Json parse for responseData: "+ud+". Exception: "+Cf,me=!1}this.JLc(0<f.length,fa,"AppSource",me,Td,window.performance.now()-fd,ne,Me,Df);G(me,Me)},ud=>{const Td=[];this.JLc(0<f.length,fa,"AppSource",!1,`Query Failed, httpStatus: ${ud.data.httpStatus}, responseData: ${ud.data.responseData}`,window.performance.now()-fd,0,Td);Kb||ud.data.httpStatus!==wl.a.Oye?G(!1,Td):this.rne(f,G,fa,Ya,!0)})}uMg(f,G){G=void 0===G?15:G;return new Promise((fa,Ya)=>{this.rne(f,(Kb,sc)=>{Kb?fa(sc):
Ya()},Date.now(),G)})}sne(f,G,fa,Ya,Kb){Ya=void 0===Ya?"":Ya;Kb=void 0===Kb?15:Kb;const sc=new vk.QueryStringBuilder("api/addins/search"),Tc={apiversion:"1.0"};0<f.length&&(Tc.qu=f);0<Ya.length&&(Tc.assetids=Ya);Tc.client="WAC_"+this.HW;Tc.cv=ea.AFrameworkApplication.buildVersion;Tc.top=Kb.toString();this.v8e("OMEX",Tc);for(const ud in Tc)sc.cq(ud,Tc[ud]);Ya="https://api.addins.omex.office.net/"+sc.toString();const fd=window.performance.now();this.executeRequest(Ya,1,null,ud=>{let Td="Query Succeeded",
me=!0,ne=0;const Me=[];ud=ud.data.responseData;try{var Df=JSON.parse(ud);ne=Df.TotalCount;const Gf=Df.Values;for(Df=0;Df<Gf.length;Df++){const Cf=Gf[Df],xf={};xf.solutionId=Cf.Id.toLowerCase();xf.displayName=Cf.Title;xf.description=Cf.ShortDescription;xf.iconUrl=Cf.IconUrl;xf.assetId=xf.solutionId;xf.storeId="en-US";xf.storeType="omex";xf.assetStoreId="omex";xf.version=Cf.Version;xf.targetType=Cf.Shape-1;xf.height=Cf.Height;xf.width=Cf.Width;Me.push(xf);this.jD[xf.solutionId]=xf}}catch(Gf){Td="Exception thrown from Json parse for responseData: "+
ud+". Exception: "+Gf,me=!1}this.JLc(0<f.length,fa,"OMEX",me,Td,window.performance.now()-fd,ne,Me);G(me,Me)},ud=>{const Td=[];this.JLc(0<f.length,fa,"OMEX",!1,`Query Failed, httpStatus: ${ud.data.httpStatus}, responseData: ${ud.data.responseData}`,window.performance.now()-fd,0,Td);G(!1,Td)})}vMg(f,G,fa){G=void 0===G?"":G;fa=void 0===fa?15:fa;return new Promise((Ya,Kb)=>{this.sne(f,(sc,Tc)=>{sc?Ya(Tc):Kb()},Date.now(),G,fa)})}TI(f){return this.jD[f.toLowerCase()]?this.jD[f.toLowerCase()]:null}executeRequest(f,
G,fa,Ya,Kb){return ea.AFrameworkApplication.sj.lv(f,G,null,void 0===fa?null:fa,!1,2,Ya,Kb,null,null,!1,null,this.Vlh)}JLc(f,G,fa,Ya,Kb,sc,Tc,fd,ud){f={["hasSearchValue"]:null===f||void 0===f?void 0:f.toString(),["searchStartTime"]:null===G||void 0===G?void 0:G.toString(),["apiSource"]:fa,["responseSuccess"]:null===Ya||void 0===Ya?void 0:Ya.toString(),["responseInfo"]:Kb,["timeElapsed"]:null===sc||void 0===sc?void 0:sc.toString(),["totalCount"]:null===Tc||void 0===Tc?void 0:Tc.toString(),["solutionIds"]:fd.map(Td=>
this.c2h(Td)),["popularity"]:ud?ud:[]};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:kd.a.Pm(f)})}c2h(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}VPh(){let f=this.Bl.q3j;if(1>=f.length)return{};ma.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",f);const G={};let fa=!0,Ya="";f=f.trim();try{const Kb=f.split("$");for(let sc=0;sc<Kb.length&&fa;sc++){const Tc=
Kb[sc].split(":");if(2!==Tc.length){Ya="Invalid override string format: "+Kb[sc];fa=!1;break}const fd=Tc[0].trim(),ud=[],Td=Tc[1].split("|");for(let me=0;me<Td.length&&fa;me++){const ne=Td[me],Me=ne.split("\\");if(2<Me.length){Ya="Invalid override string format: "+ne;fa=!1;break}const Df=Me[0].trim(),Gf=2===Me.length?Me[1].trim():null;Array.add(ud,new Jh.a(Df,Gf))}G[fd]=ud}}catch(Kb){Ya="Failed in parsing the overrideString: "+f+". Exception: "+Kb.toString(),fa=!1}if(fa)return G;ma.ULS.sendTraceTag(507785890,
220,10,"Build override failed: {0}.",Ya);return{}}v8e(f,G){if(this.sUe[f]){f=this.sUe[f];for(let fa=0;fa<f.length;fa++){const Ya=f[fa].key,Kb=f[fa].value;Kb?G[Ya]=Kb:delete G[Ya]}}}}Object(ja.a)(Nk,"AddinSearchApiManager",null,[]);var wk=a(406);class jl{constructor(){this.Ep=f=>{var G;if(null===f||null===f.La)return!1;f=f.La.target;for(this.$Gd=void 0;null!=f&&f.getAttribute;){void 0===this.$Gd&&0<(null===(G=f.id)||void 0===G?void 0:G.length)&&(this.$Gd=f.id);if(null!=f.getAttribute("data-contextmenu-id"))break;
f=f.parentNode}return!1}}get currentTarget(){return this.$Gd}axj(){wk.a.instance.xa(window.document.body,this.Ep,null)}dispose(){wk.a.instance.Qa(window.document.body,this.Ep)}}Object(ja.a)(jl,"AppFlyoutGeneratorContextMenuListener",null,[]);const kl={["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa104381727 wa200005983 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200005313 wa200001361 wa200006001 wa200005312".split(" "),
["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa104380118 wa104178141 wa200002281 wa104379370 wa104379997 wa104381063 wa104381411".split(" ")},Ok={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005281 wa200005107 wa200005333".split(" "),["DA"]:"wa200003784 wa200000169 wa200000018 wa104381841 wa104380711 wa104381807 wa200002503".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" ")},
Pk={["IPWAI"]:["wa200003964","wa200005107","wa200005669","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa200000113 wa104381155 wa104380907 wa104380121 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),["CAIP"]:"wa104379261 wa200001661 wa200002908 wa200000094 wa104218073 wa104381682 wa104382064 wa200004643 wa200004709 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" ")},ll={["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200001361 wa200005313 wa200005312 wa200006001".split(" "),
["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa200005983 wa104381727 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa200002281 wa104178141 wa104380118 wa104379370 wa104379997 wa104381063 wa104381411 wa200001486".split(" ")},ml={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005669 wa200005281 wa200006009 wa200006007 wa200005333".split(" "),
["APIC"]:"wa102957665 wa200004179 wa104051163 wa200000113 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" "),["DA"]:"wa200000169 wa200000018 wa200003784 wa104381841 wa200000025 wa200002503 wa104381807 wa104380711 wa200004632 wa200005782 wa200005817 wa200005777 wa200005960 wa200006017 wa200006008".split(" "),["FA"]:"wa104379220 wa200002311 wa104381695 wa200003692 wa104381859 wa104381717 wa104380978".split(" ")},nl={["IPWAI"]:["wa200003964","wa200005669",
"wa200005107","wa200006000","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa104380907 wa200000113 wa104380121 wa104381155 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),["CAIP"]:"wa104379261 wa200001661 wa200000094 wa200002908 wa104381682 wa104218073 wa104382064 wa200004709 wa200004643 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" "),["DWT"]:"wa200001625 wa104380602 wa104380526 wa200002334 wa104380050 wa200003052 wa200006046 wa200003157 wa104380955 wa104380278 wa200001396 wa200001409".split(" ")};
class ol{constructor(f,G,fa){this.Bl=f;this.yQ=G;this.V8={};this.XAb={};this.Sgd={};if(f.cQb||f.xea){this.V8=fa;this.MIh();this.xIh();f=this.Bl.p3j;try{const Ya=f.split("|");f={};for(G=0;G<Ya.length;G+=2)f[Ya[G]]=Ya[G+1];this.Sgd=f}catch(Ya){}}}MIh(){const f={};var G=this.Bl.n3j;if(!(1>=G.length)){ma.ULS.sendTraceTag(507589127,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",G);var fa=!0,Ya="";G=G.trim();try{const Kb=G.split("$");for(let sc=0;sc<Kb.length&&fa;sc++){const Tc=Kb[sc].split(":");
if(2<Tc.length){Ya="Invalid override string format: "+Kb[sc];fa=!1;break}const fd=Tc[0].trim(),ud=[];if(2===Tc.length){const Td=Tc[1].split("|");for(let me=0;me<Td.length&&fa;me++){const ne=Td[me],Me=ne.split("\\");if(2>Me.length||5<Me.length){Ya="Invalid override string format: "+ne;fa=!1;break}const Df=Me[0].trim(),Gf={};for(let Cf=1;Cf<Me.length&&fa;Cf++)if(0<Me[Cf].trim().length)switch(Cf){case 1:Gf.priority=parseInt(Me[Cf].trim());break;case 2:Gf.AUP=parseInt(Me[Cf].trim());break;case 3:Gf.diffAUP=
parseInt(Me[Cf].trim());break;case 4:const xf=Me[Cf].trim();if(8!==xf.length){Ya="Invalid override string format: "+xf;fa=!1;break}Gf.releaseDate=(new Date(parseInt(xf.substring(0,4)),parseInt(xf.substring(4,6))-1,parseInt(xf.substring(6)))).getTime();break;default:Ya="Invalid override string format: "+ne,fa=!1}if(!fa)break;Array.add(ud,{solutionId:Df,addinInfo:Gf})}}this.V8[fd]&&(f[fd]=ud)}}catch(Kb){Ya="Failed in parsing the overrideString: "+G+". Exception: "+Kb.toString(),fa=!1}if(fa){for(const Kb in f){if(!this.V8[Kb])continue;
const sc=f[Kb];G=this.V8[Kb].filter(Tc=>!sc.some(fd=>fd.solutionId.toLowerCase()===Tc.solutionId.toLowerCase()));Array.addRange(sc,G)}this.V8=f}else ma.ULS.sendTraceTag(507589126,220,10,"Override Failed: {0}.",Ya)}}xIh(){for(const f in this.V8){const G=this.V8[f];for(let fa=0;fa<G.length;fa++){const Ya=G[fa];Ya.addinInfo||(Ya.addinInfo={});if(!Ya.addinInfo.priority||isNaN(Ya.addinInfo.priority))Ya.addinInfo.priority=0;if(!Ya.addinInfo.AUP||isNaN(Ya.addinInfo.AUP))Ya.addinInfo.AUP=0;if(!Ya.addinInfo.diffAUP||
isNaN(Ya.addinInfo.diffAUP))Ya.addinInfo.diffAUP=0;if(!Ya.addinInfo.releaseDate||isNaN(Ya.addinInfo.releaseDate))Ya.addinInfo.releaseDate=0}}}yGi(){if(!this.V8||0===Object.keys(this.V8).length)return ma.ULS.sendTraceTag(507589125,220,15,"The category add-in ids mapping is empty."),{};if(Object.keys(this.XAb).length!==Object.keys(this.V8).length){const G=[],fa={};for(const Ya in this.V8){if("PAIYO"===Ya){var f=this.yQ.zR(1);0===f.errorCode&&(f=f.Dt)&&0<f.length&&(fa[Ya]=f);continue}if(this.XAb[Ya]){fa[Ya]=
this.XAb[Ya];continue}f=this.V8[Ya];if(!f||0===f.length){ma.ULS.sendTraceTag(507589124,220,15,"The addin content list is empty for category: {0}.",Ya);continue}const Kb=[];for(let sc=0;sc<f.length;sc++){const Tc=f[sc],fd=this.yQ.TI(Tc.solutionId);if(!Tc.addinInfo||-1===Tc.addinInfo.priority||!fd||-1===fd.addinInfo.priority)continue;if(!fd){Array.add(G,Tc.solutionId);continue}const ud={};ud.solutionId=fd.solutionId;ud.version=fd.version;ud.storeType=fd.storeType;ud.storeId=fd.storeId;ud.assetId=fd.assetId;
ud.assetStoreId=fd.assetStoreId;ud.displayName=fd.displayName;ud.provider=fd.provider;ud.description=fd.description;ud.targetType=fd.targetType;ud.height=fd.height;ud.width=fd.width;ud.iconUrl=fd.iconUrl;ud.webApplicationId=fd.webApplicationId;ud.highResolutionIconUrl=fd.highResolutionIconUrl;ud.addinInfo=Tc.addinInfo;Array.add(Kb,ud)}0<Kb.length&&("WN"===Ya?Kb.sort((sc,Tc)=>sc.addinInfo.releaseDate<Tc.addinInfo.releaseDate?1:-1):"TD"===Ya?Kb.sort((sc,Tc)=>sc.addinInfo.diffAUP<Tc.addinInfo.diffAUP?
1:-1):Kb.sort((sc,Tc)=>sc.addinInfo.AUP<Tc.addinInfo.AUP?1:-1),fa[Ya]=Kb)}this.XAb=fa;0<G.length&&ma.ULS.sendTraceTag(507589123,220,10,"{0} AddinIds not found in mapping: {1}, collection length: {2}",G.length,G.toString())}return this.XAb}MDg(f,G,fa){return fa&&0<fa.length&&"PAIYO"!==f?fa.filter(Ya=>!G.some(Kb=>Kb.toLowerCase()===Ya.solutionId.toLowerCase())):fa}uXi(){var f,G,fa;const Ya={},Kb=this.Bl.host;if("Word"===Kb)for(const sc in ll)Ya[sc]=(null===(f=ll[sc])||void 0===f?void 0:f.map(Tc=>this.yQ.TI(Tc)).filter(Tc=>
!!Tc))||[];else if("Excel"===Kb)for(const sc in ml)Ya[sc]=(null===(G=ml[sc])||void 0===G?void 0:G.map(Tc=>this.yQ.TI(Tc)).filter(Tc=>!!Tc))||[];else if("PowerPoint"===Kb)for(const sc in nl)Ya[sc]=(null===(fa=nl[sc])||void 0===fa?void 0:fa.map(Tc=>this.yQ.TI(Tc)).filter(Tc=>!!Tc))||[];return Ya}cIi(f){let G=null;var fa=this.yGi();if(fa&&0<Object.keys(fa).length){G={};for(const Kb in fa){const sc=fa[Kb];G[Kb]=this.MDg(Kb,f.map(Tc=>Tc.solutionId),sc)}const Ya=[];for(const Kb in G)if((f=G[Kb])&&0<f.length){f=
f.filter(sc=>!Ya.some(Tc=>Tc.toLowerCase()===sc.solutionId.toLowerCase()));for(fa=0;fa<f.length&&3>fa;fa++)Ya.push(f[fa].solutionId);G[Kb]=f}}else ma.ULS.sendTraceTag(507589122,220,15,"Category addins details dict is empty");return G}sAc(){const f=this.Bl.host,G=this.Bl.o3j;return G?G.split("|"):"Word"===f?["IPWAI","APID","WF"]:"Excel"===f?["IPWAI","APIC","DA"]:"PowerPoint"===f?["IPWAI","APIC","CAIP"]:[]}tAc(f,G){var fa,Ya,Kb,sc=this.Bl.host;if("Word"===sc)sc=(null===(fa=kl[f])||void 0===fa?void 0:
fa.map(Tc=>this.yQ.TI(Tc)))||[];else if("Excel"===sc)sc=(null===(Ya=Ok[f])||void 0===Ya?void 0:Ya.map(Tc=>this.yQ.TI(Tc)))||[];else if("PowerPoint"===sc)sc=(null===(Kb=Pk[f])||void 0===Kb?void 0:Kb.map(Tc=>this.yQ.TI(Tc)))||[];else return[];return G?this.MDg(f,G,sc):sc}EGi(f){if(this.Sgd[f])return this.Sgd[f];switch(f){case "APIC":return"Insert Graphics";case "APID":return"Insert Graphics";case "BBM":return"Microsoft";case "CAIP":return"Interactive tools";case "DA":return"Data analytics";case "DWT":return"Templates";
case "ER":return"Education";case "FA":return"Finance";case "IPWAI":return"AI";case "PAIYO":return"Org";case "TD":return"Trending";case "WF":return"Writing Fluently";case "WN":return"New"}return"Popular"}zzc(f){var G;const fa=this.Bl.host;return(null===(G=Za()[fa])||void 0===G?void 0:G[f])||Za().Bqe[f]||T()[f]||T().default}}Object(ja.a)(ol,"AppFlyoutCategories",null,[]);var Sh;(function(f){f.LEFT="LEFT";f.Hja="MIDDLE";f.RIGHT="RIGHT"})(Sh||(Sh={}));Object(ja.b)("FRECarouselDirection",Sh);class pl{constructor(f,
G){this.categories=f;this.p5b=G;this.BRa=0}E_j(f){var G,fa;let Ya=!1;try{if(null===f||void 0===f?0:f.includes("FRECarouselSwitchIcon_")){let Kb=this.BRa;const sc=f.split("_");if(3===sc.length){const Tc=sc[1],fd=parseInt(sc[2],10);if(Tc===Sh.Hja)return;Tc===Sh.LEFT?(Kb--,0>Kb&&(Kb=fd-1)):(Kb++,Kb>=fd&&(Kb=0));this.BRa=Kb;Ya=!0}}if(Ya){yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchFREBanner",dataFields:kd.a.V5a({["controlId"]:f,["currentIndex"]:null===(G=this.BRa)||void 0===
G?void 0:G.toString()})});try{this.sFb="banner",null===(fa=this.p5b)||void 0===fa?void 0:fa.call(this)}finally{this.sFb=void 0}}else ma.ULS.sendTraceTag(507527308,220,10,`Bad fre banner switch. SourceControlId=${f}`)}catch(Kb){ma.ULS.sendTraceTag(507527307,220,10,`Bad fre banner switch. SourceControlId=${f}; error=${null===Kb||void 0===Kb?void 0:Kb.toString()}`)}}F_j(){var f;this.Tsa=this.categories.sAc()[this.BRa];try{this.sFb="content",null===(f=this.p5b)||void 0===f?void 0:f.call(this)}finally{this.sFb=
void 0}yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchFREContent",dataFields:kd.a.V5a({["category"]:this.Tsa})})}lXh(f){f.MenuSectionList.some(G=>G.ControlList.some(fa=>"AddInFlyoutFREBanner"===fa.Id))||v("AddInFlyoutFREBanner",!1,-1)}Tok(f){var G;const fa=this.categories.sAc(),Ya=fa[this.BRa];f.MenuSectionList.unshift(y(Ya,fa.length,this.BRa));v("AddInFlyoutFREBanner",!0,1);f={["currentIndex"]:null===(G=this.BRa)||void 0===G?void 0:G.toString(),["category"]:Ya};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowFREBanner",
dataFields:kd.a.Pm(f)})}fSi(f,G){if(!this.Tsa)return f;const fa=this.categories.tAc(this.Tsa,G).map(Ya=>Ya.solutionId);return f.filter(Ya=>!fa.includes(Ya.solutionId))}DGi(f){return this.Tsa?this.categories.tAc(this.Tsa,f):[]}zzc(){return this.Tsa?this.categories.zzc(this.Tsa):""}q9j(){this.sFb||(this.Tsa=void 0)}k8j(){"content"===this.sFb&&setTimeout(()=>{const f=document.querySelector('[id^="FRECategoryAddin"]');if(f){f.scrollIntoView({behavior:"smooth",block:"center"});const G=f.parentElement.parentElement.parentElement.parentElement;
G.classList.remove("addin-flyout-highlighted");G.classList.add("addin-flyout-highlight");setTimeout(()=>{G.classList.add("addin-flyout-highlighted")},1E3)}},10)}get dAi(){var f;return null===(f=this.Tsa)||void 0===f?void 0:f.toString()}}Object(ja.a)(pl,"FRECarousel",null,[]);var ql=a(650);class rl{constructor(f,G){this.Tth=f;this.Uth=G;this.Bl=new Md(ea.AFrameworkApplication.fa)}C1d(){null==Z.a.instance.getItem("AddinEntryPointSurveyShowed")&&(this.xrh=window.setTimeout(()=>{this.qZe=Object(ql.a)();
null!=this.qZe&&this.qZe.execute(f=>{if(null==Z.a.instance.getItem("AddinEntryPointSurveyShowed")){var G=this.AAc();this.cFi()||G&&(!G||"hidden"!==G.visibility)||(f.m8a(this.Tth,null),Z.a.instance.setItem("AddinEntryPointSurveyShowed","1"))}})},this.Uth))}uOa(){window.clearTimeout(this.xrh)}AAc(){let f=null;try{const G=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");G&&(f=Ge.a.CE(G.parentNode.parentNode.parentNode))}catch(G){ma.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+
(G?G.toString():""))}return f}cFi(){let f=null;try{f=document.getElementById("BackstageGetAddIns")}catch(G){ma.ULS.sendTraceTag(508343956,220,10,"Backstage get parent and parent get exception "+(G?G.toString():""))}return f}}Object(ja.a)(rl,"FpsHelper",null,[]);class Qk extends yj.a{constructor(f,G,fa,Ya,Kb,sc,Tc,fd,ud){super(!1,!1,!0);this.Ph=5;this.initializeAndShow("",()=>{this.hide()},{["id"]:"AddInStoreDialog",["bodyControls"]:{},["dataProvider"]:{["getAddinDetails"]:Td=>{Td=f.zR(Td);const me=
Td.Dt&&Td.Dt instanceof Array?Td.Dt.filter(ne=>ne.addinInfo&&-1!==ne.addinInfo.priority):[];me.sort((ne,Me)=>Me.addinInfo.AUP-ne.addinInfo.AUP);return{["errorCode"]:Td.errorCode,["addinDetails"]:me,["failure"]:Td.failure}},["getAddinDetailById"]:f.TI.bind(f)},["host"]:G,["getCommonString"]:Gb.a,["hide"]:this.hide.bind(this),["appsFlyoutGeneratorContext"]:{["host"]:fa.host,["addinFlyoutSearchDebouncingDelay"]:fa.q5e,["addinFlyoutSearchRecommendedKeyword"]:fa.r5e,["flyoutStoreExpEnabled"]:fa.cQb,["flyoutStoreExpUseLabelsEnabled"]:fa.xyi},
["addinSearchApiManager"]:{["searchFromAppSource"]:Ya.rne.bind(Ya),["searchFromAppSourceAsync"]:Ya.uMg.bind(Ya),["searchFromOMEX"]:Ya.sne.bind(Ya),["searchFromOMEXAsync"]:Ya.vMg.bind(Ya),["getAddinDetailById"]:Ya.TI.bind(Ya)},["addinCommandsHandlerForStoreExp"]:{["handleInstallPopularAddInAndLaunchIt"]:Kb.lQd.bind(Kb),["handleInstallSearchAddInAndLaunchIt"]:Kb.a3i.bind(Kb),["handleLaunchAddInInstallDialog"]:Kb.QSb.bind(Kb),["handleLaunchAppForOfficeDialog"]:Kb.i3i.bind(Kb)},["appFlyoutCategories"]:{["getContentExpCategoryAddinsRecord"]:sc.cIi.bind(sc),
["getStoreExpCategoryAddinsRecord"]:sc.uXi.bind(sc),["getCategoryTitle"]:sc.zzc.bind(sc)},["telemetryForStoreExp"]:{["sendULSInfoTraceTag"]:Tc.oAk.bind(Tc),["sendULSWarningTraceTag"]:Tc.pAk.bind(Tc),["sendULSErrorTraceTag"]:Tc.nAk.bind(Tc),["sendOtelTelemetry"]:Tc.Nzk.bind(Tc),["getPrivacyCompliantId"]:Tc.tga.bind(Tc)},["onDialogOpen"]:fd,["onDialogClose"]:ud})}}Object(ja.a)(Qk,"AddInStoreDialog",yj.a,[]);class Rk{constructor(){}oAk(f){ma.ULS.sendTraceTag(507343232,220,50,f)}pAk(f){ma.ULS.sendTraceTag(507343203,
220,15,f)}nAk(f){ma.ULS.sendTraceTag(507343202,220,10,f)}Nzk(f,G){yc.a.sendTelemetryEvent({name:f,dataFields:kd.a.Pm(G)})}tga(f){return Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,f.storeType,f.assetId,null,null,f.storeId)}}Object(ja.a)(Rk,"TelemetryForStoreExp",null,[]);class Gj{constructor(f,G,fa,Ya,Kb,sc,Tc,fd,ud,Td,me){fd=void 0===fd?{}:fd;this.p5b=Td;this.Rad={};this.ffc={};this.zMe=0;this.FCb=null;this.rAb={};this.ARa=void 0;this.tJe=this.IZe=this.NGe=this.S$a=null;this.bZe=0;
this.Xcb="All";this.ued=[];this.Vcb="";this.Sic=null;this.tXe=100;this.Vic=!1;this.IFb=[];this.W3a=(ne,Me)=>{this.Uaa?this.Ohk(Me):(this.Nhk(Me),!this.Bl.M$b&&this.KGe&&this.KGe.W3a(ne,Me))};this.yQ=G;this.Lsa=null;this.Ooh=Ya;this.qsh=Kb;this.KGe=void 0===Tc?null:Tc;this.Ha=(void 0===sc?null:sc)||ea.AFrameworkApplication.fa;this.Bl=new Md(this.Ha);this.RNe=ud;this.URa=new ol(this.Bl,G,fd);this.yQ.AAa(this.W3a);(null===appChrome||void 0===appChrome?0:appChrome.addInApi)&&appChrome.addInApi.loadOfficeAddInIcons();
this.Bl.rFh&&e((ne,Me)=>{yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",dataFields:kd.a.V5a({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:ne,["OpenDuration"]:Me})})}).catch(ne=>{ma.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+((null===ne||void 0===ne?void 0:ne.toString())||void 0))});if(this.Bl.W3||this.Bl.LWh||this.Bl.cQb)this.S$a=new Nk(this.Ha,this.Ha.Za("Application")),this.tXe=this.Bl.q5e;this.Bl.cQb&&
(this.NGe=me,this.IZe=new Rk);this.Bl.m5e&&(this.tJe=new jl,this.tJe.axj());this.Bl.xea&&(this.nka=new pl(this.URa,Td));this.Bl.W3&&this.GDk();this.Bl.pFh&&S();this.Bl.EHd&&(this.FCb=new rl("AddinBackstageFeedbackSurvey",this.Bl.Ayi))}get Z1h(){return this.ffc}get noj(){const f=document.querySelector('[data-unique-id="Overflow-InsertAddInFlyout"]');return f?"hidden"!==window.getComputedStyle(f).visibility:!1}Nhk(f){if(f.Dt)for(let G=0;G<f.Dt.length;G++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+
f.Dt[G].solutionId,f.Dt[G].iconUrl);else 0===f.errorCode&&ma.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get Uaa(){return!!this.Ha&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}yMd(f){const G=this.Bl.p6b,fa=G?"more"===f?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":"AddinFlyoutMoreButton",Ya=G?"more"===f?Object(Gb.a)("AddinsFlyoutSeeAllButtonText"):Object(Gb.a)("AddinsFlyoutSeeLessButtonText"):
Object(Gb.a)("AddinsFlyoutSeeAllButtonText");f=G?"more"===f?Object(Gb.a)("AddinsPickerGalleryButtonMoreArialText"):Object(Gb.a)("AddinsPickerGalleryButtonLessArialText"):Object(Gb.a)("AddinsPickerGalleryButtonMoreArialText");return Object.assign(new Sj.a,{Id:fa,ExternalId:fa,Icon:"AllApps_16",Command:this.qsh,LabelText:Ya,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",
overflow:"hidden"}},Role:"menuitem",Alt:f})}yPi(f,G){var fa=void 0===fa?ea.AFrameworkApplication.isRtl:fa;fa={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",["border"]:"1px solid var(--border-color, #c8c8c8)",["direction"]:fa?"ltr":void 0}};return Object.assign(new Sj.a,{Id:G,ExternalId:G,Icon:"AddinFlyoutControl"+f.solutionId,Command:this.Ooh,LabelText:f.displayName,Role:"menuitem",FullIconStyle:fa,Alt:f.description})}OIf(f,G){f=this.NIf("MRUAddinsGalleryControl",
f,G);return Object.assign(new P.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[f],Title:Object(Gb.a)("MyAddinSection")})}NIf(f,G,fa,Ya){Ya=void 0===Ya?this.Bl.p6b:Ya;const Kb=x(zj,{SectionId:f+"Section",GalleryButtons:G.map(sc=>this.yPi(sc,this.GMi(sc)))});Ya&&3<G.length?Kb.Collapse=new Fj(2,this.yMd("more"),this.yMd("less")):fa&&Kb.GalleryButtons.push(this.yMd("more"));return x(bk.a,{Id:f,ExternalId:f,GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",
width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"0px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}},Width:3,Type:4,GallerySections:[Kb],GalleryContextMenu:this.Bl&&this.Bl.m5e?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}JPi(){const f=x(P.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",
ControlList:[x(fl.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(Gb.a)("AddinsPickerFooterButtonMoreArialText")})]});appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",Object(Gb.a)("AddinPickerButtonMore")));return f}get cCf(){var f;return null===(f=this.nka)||void 0===f?void 0:f.dAi}get GMg(){return this.Xcb}AGi(){this.Xcb="All";r(`${"AddinFREButton"}${this.Xcb}`);var f=["All",...this.URa.sAc()];f=x(zj,{SectionId:"AddinFlyoutButtonGroupSection",
GalleryButtons:f.map(G=>{const fa=this.URa.EGi(G);return Object.assign(new Sj.a,{Id:"AddinFREButton"+G,ExternalId:"AddinFREButton"+G,Command:lg.a.M9b.toString(),LabelText:fa,FullIconStyle:{["root"]:{position:"absolute",["border-radius"]:"10px",width:"100%",height:"100%"}},Role:"tab",Alt:fa})})});f=x(bk.a,{Id:"AddinFlyoutButtonGroup",ExternalId:"AddinFlyoutButtonGroup",GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",width:"100%",maxWidth:"unset"},["inner"]:{aml:2,maxWidth:"333px",minWidth:"333px",
flexFlow:"nowrap",paddingLeft:15}},["galleryButtonInExpanded"]:{["root"]:{backgroundColor:"transparent",width:"unset",height:"unset",borderRadius:"10px",borderColor:"var(--border-color)",borderWidth:"1px !important",padding:"4px 8px"},["flexContainer"]:{},["label"]:{fontSize:"12px",textOverflow:"ellipsis"}}},Type:4,GallerySections:[f],DismissHostingSurfaceOnExecute:!1});return x(P.a,{ControlList:[f]})}RWk(f){var G;if(this.Xcb!==f){var fa=appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout");
"All"===this.Xcb&&(this.ued=Object.entries(fa).filter(fd=>{var [ud,Td]=fd;return"MultiActionButtonModel"===Td&&ud.startsWith("AddInsListItem")}).map(fd=>{[fd]=fd;return fd}));this.Xcb=f;r(`${"AddinFREButton"}${f}`);var Ya=-1!==Object.keys(fa).indexOf("SearchAddinInFlyout")||this.Bl.W3?appChrome.api.menuSection(["SearchAddinInFlyout"],""):void 0,Kb=appChrome.api.menuSection(["InsertMoreAddInsFromFooter"],""),sc="All"===f?this.ued:null!==(G=this.URa.tAc(f).map(fd=>`AddInsListItem${fd.solutionId.toLowerCase()}`))&&
void 0!==G?G:[],Tc=new Set(sc);G=this.ued.filter(fd=>Tc.has(fd));G=[appChrome.api.menuSection(["AddinFlyoutButtonGroup",...G],"")];this.Bl.xea&&(sc=Object.keys(fa).filter(fd=>0<=fd.indexOf("FRECarousel")||0<=fd.indexOf("FREBanner")),0<(null===sc||void 0===sc?void 0:sc.length)&&G.unshift(appChrome.api.menuSection(sc,"")));"MRUAddinsGalleryControl"in fa&&G.unshift(appChrome.api.menuSection(["MRUAddinsGalleryControl"],Object(Gb.a)("MyAddinSection")));fa=appChrome.actions.updateMenu("InsertAddInFlyout",
G,void 0,void 0,void 0,void 0,void 0,Kb,!0,Ya);appChrome.api.dispatch(fa);yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:kd.a.V5a({["Category"]:f})})}}r2i(f){this.nka.E_j(f)}s2i(){this.nka.F_j()}MPi(f,G){var fa,Ya,Kb;const sc=[],Tc=[],fd=this.yQ.zR(0);Array.addRange(Tc,fd.Dt);const ud=this.yQ.zR(1);Array.addRange(Tc,ud.Dt);f||Tc.sort((Kg,fg)=>{Kg=De.d(Kg.displayName);fg=De.d(fg.displayName);return Sd.a.localeCompare(Kg,fg)});null===(fa=this.RNe)||void 0===
fa?void 0:fa.addNotification(Tc);this.k$j(Tc);let Td=Tc.length,me=!1;!this.Bl.p6b&&3<Td&&(Td=2,me=!0);let ne=[];fa=null;this.Bl.Wxb||this.Uaa||!this.Lsa?(fa=this.yQ.zR(2),0!==fa.errorCode&&5!==fa.errorCode||fa.Dt.forEach(Kg=>{-1!==Kg.addinInfo.priority&&ne.push(Kg)})):ne=this.Lsa;ma.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",Td,Dj.a[fd.errorCode],fd.Dt.length,Dj.a[ud.errorCode],ud.Dt.length,this.Bl.Wxb?Dj.a[fa.errorCode]:
"undefined",ne.length);this.V3.m8f(Td,fd,ud,fa);this.Bl.EHd&&this.FCb&&this.FCb.C1d();const Me=[],Df=[];f&&(Array.addRange(Me,this.Ivi(this.Vcb,Tc)),Array.addRange(Df,this.y8e(this.IFb,Tc)));const Gf=Object.assign(new P.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",ControlList:[]}),Cf=Object.assign(new vj.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.Bl.W3?Gf:void 0,MenuFooterSection:this.JPi(),UpdateDynamically:!0,IsFlexLayout:!0});if((2===fd.errorCode||this.Bl.Wxb&&
2===fa.errorCode)&&!Tc.length){sc.push("storeDisabled");ma.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");var xf=this.Uyc({iconName:"StoreDisabled",nEc:Object(Gb.a)("AddinPickerDisableError")});Array.add(Cf.MenuSectionList,xf)}else if(3!==fd.errorCode||this.V3.GVg(fd)||3!==ud.errorCode)if(4!==fd.errorCode||Tc.length){const Kg=0>=Me.length&&0>=Df.length;if(this.Bl.W3){const fg=f?String.format(Kg?null!==(Ya=Object(Gb.a)("AddInSearchNoResultsAriaText"))&&void 0!==Ya?Ya:"":
null!==(Kb=Object(Gb.a)("AddInSearchResultsAriaText"))&&void 0!==Kb?Kb:"",this.Vcb):null;Array.add(Gf.ControlList,this.PCi(fg))}if(f)Kg&&this.V7h(Cf),0<Me.length&&this.r7h(Cf,Me),0<Df.length&&this.B7h(Cf,Df),xf={},xf.MRUAddins=Me.map(fg=>m(fg)),xf.MoreAddins=Df.map(fg=>m(fg)),xf.HasResults=!Kg,yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",dataFields:kd.a.Pm(xf)});else{if(this.Bl.cQb&&0===Tc.length&&!G&&!this.noj)return this.OQk(),Object.assign(new vj.a,{Id:"Ribbon.AddinPicker",
MenuSectionList:[this.OIf([])],UpdateDynamically:!0});0<Td?(Cf.MenuSectionList.push(this.OIf(Tc.slice(0,Td),me)),ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(f={["solutionIds"]:ud.Dt.map(lh=>m(lh))},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",dataFields:kd.a.Pm(f)}))):this.Bl.xea&&this.nka.Tok(Cf);let fg=this.Uaa?this.TYi(ne,Tc):this.y8e(ne,Tc);fg&&0!==fg.length||(sc.push("emptyPopularAddins"),
ma.ULS.sendTraceTag(507523101,220,15,"The popular addins list is empty"));fg=fg.filter(lh=>!!lh).slice(0,30);if(this.Bl.Zta){f=this.URa.sAc();for(var cg of f)f=this.URa.tAc(cg,Tc.map(lh=>lh.solutionId)),fg=fg.concat(f.filter(lh=>!fg.some(uj=>uj.solutionId===lh.solutionId)));yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:kd.a.V5a({["Category"]:"All"})})}const Tg=this.Bl.Mpd?null===(xf=E(this.Bl.p5e,this.Bl.host))||void 0===xf?void 0:xf[0]:void 0;Tg&&
(fg=fg.filter(lh=>{var uj;return Tg!==(null===(uj=lh.solutionId)||void 0===uj?void 0:uj.toLowerCase())}));const Wh=this.Bl.Lpd?E(this.Bl.p5e,this.Bl.host):void 0;0<(null===Wh||void 0===Wh?void 0:Wh.length)&&(fg=fg.filter(lh=>{var uj;return!Wh.includes(null===(uj=lh.solutionId)||void 0===uj?void 0:uj.toLowerCase())}));xf=[];this.Bl.xea&&(this.nka.q9j(),fg=this.nka.fSi(fg,Tc.map(lh=>lh.solutionId)),xf=this.nka.DGi(Tc.map(lh=>lh.solutionId)));cg=this.KSi(fg);this.Bl.Zta&&(Cf.MenuSectionList.push(this.AGi()),
cg.Title="");f=this.yQ.TI(Tg);this.Bl.Mpd&&!this.Bl.Zta&&f?M(f,Cf,cg,fd.Dt,ud.Dt,this.Bl.W3,this.Bl.host):this.Bl.Lpd&&!this.Bl.Zta&&0<(null===Wh||void 0===Wh?void 0:Wh.length)?(f=Wh.map(lh=>this.yQ.TI(lh)),R(f,Cf,cg,fd.Dt,ud.Dt,this.Bl.W3,this.Bl.host)):Cf.MenuSectionList.push(cg);0<xf.length&&(xf=x(P.a,{Id:"CategoryAddInListSection",ControlsId:"CategoryAddInListSection.Controls",ControlList:xf.map(lh=>this.hzc("FRECategoryAddin"+lh.solutionId.toLowerCase(),lh)),Title:this.nka.zzc()}),Cf.MenuSectionList.push(xf),
this.nka.k8j())}}else sc.push("serviceDisabled"),ma.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),xf=this.Uyc({iconName:"StoreDisabled",nEc:Object(Gb.a)("AddinPickerServiceDisconnectedError")}),Array.add(Cf.MenuSectionList,xf);else sc.push(this.V3.fIf(fd,ud)),ma.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),xf=this.Uyc({iconName:"Common",nEc:Object(Gb.a)("AddinPickerGeneralError")}),Array.add(Cf.MenuSectionList,xf);this.Bl.xea&&this.nka.lXh(Cf);
this.Bl.Mpd&&U(Cf);this.Bl.Lpd&&K(Cf);this.rWh();0===Cf.MenuSectionList.length&&(Cf.IsFlexLayout=!1,sc.push("emptyMenuSection"),ma.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.V3.H_g&&ma.ULS.sendTraceTag(508047442,220,15,`${sc.join("|")}`);this.V3.h8f&&this.V3.l8f(Tc.length,sc,fd,ud,fa);return Cf}rWh(){window.setTimeout(()=>{var f=document.querySelector('#Ribbon-InsertAddInFlyoutDropdown > .ms-FocusZone > div[class^="root"] > div[class^="container"]');f&&(f=f.scrollTop,
0<f&&(this.Bl.EHd&&this.FCb&&this.FCb.uOa(),yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ScrollableListView",dataFields:kd.a.Pm({["scrollTopValue"]:f.toString()})})))},6E4)}KSi(f){const G=x(P.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:this.Bl.Zta?f.map(fa=>this.hzc("AddInsListItem"+fa.solutionId.toLowerCase(),fa)):f.map((fa,Ya)=>this.hzc("PopularAddInsListItem"+Ya,fa)),Title:Object(Gb.a)("PopularAddins")});ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",
!0)&&(f={["solutionIds"]:f.map(fa=>m(fa))},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:kd.a.Pm(f)}));return G}hzc(f,G){const fa={default:"AddinFlyoutControl"+G.solutionId},Ya=this.xQb(G),Kb=[];var sc=G.solutionId.toLowerCase();sc=Object.assign(new Tj,{text:Object(Gb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+sc});Array.add(Kb,sc);return Object.assign(new ck.a,{Id:f,ExternalId:f,CommandId:f,CommandIdMapped:lg.a.J2a.toString(),
iconSet:fa,SecondaryLabel:null,Details:[],Label:G.displayName,ActionText:f.includes("PAIYO_CategoryAddinListItem")?Object(Gb.a)("AddinListOpen"):Object(Gb.a)("AddinListAdd"),Description:G.description,Links:Kb,ActionId:f+"Add",ActionIdMapped:lg.a.Txa.toString(),ActionCommandValueId:Ya,CommandValueId:Ya})}xQb(f){return this.Uaa?String.format("{0}#{1}",f.solutionId,f.storeId):f.solutionId}hJa(f){if(!f)return null;var G=f.split("#");if(1!==G.length&&2!==G.length)return ma.ULS.sendTraceTag(508912466,220,
10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;f=G[0].trim();G=2===G.length?G[1].trim():ea.AFrameworkApplication.uiCulture;return this.yQ.TI(f,G)}MVi(f){return f?this.S$a.TI(f):null}zef(f){return f&&f.hasOwnProperty("solutionId")&&f.hasOwnProperty("version")&&f.hasOwnProperty("storeType")&&f.hasOwnProperty("storeId")&&f.hasOwnProperty("assetId")&&f.hasOwnProperty("assetStoreId")&&f.hasOwnProperty("targetType")&&f.hasOwnProperty("displayName")&&f.hasOwnProperty("width")&&f.hasOwnProperty("height")?
!0:!1}zAf(f){return new Promise((G,fa)=>{if(this.zef(f))return G(f);const Ya=(new Date).getTime();this.S$a.sne("",(Kb,sc)=>Kb?1!==sc.length||sc[0].solutionId.toLowerCase()!==f.solutionId.toLowerCase()?fa(Error("The search add-in and result add-in don't match.")):this.zef(sc[0])?G(sc[0]):fa(Error("The result add-in details are still not ready for install.")):fa(Error("Failed to query add-in details for install.")),Ya,f.solutionId)})}GMi(f){if(!(f.solutionId in this.Rad)){const G="AddinGalleryButton"+
this.zMe.toString();this.Rad[f.solutionId]=G;f=this.xQb(f);this.ffc[G]=f;this.ffc[G+"Add"]=f;this.zMe++;return G}return this.Rad[f.solutionId]}WOd(f){return f?this.ffc[f]:null}Uyc(f){var {iconName:G,nEc:fa,tul:Ya=!1,bvl:Kb=Object(Gb.a)("AddinPickerTryAgain"),avl:sc="ReloadAddInPicker",Kll:Tc="ReloadAddInPicker"}=f;f=Object.assign(new P.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});let fd=null;fd=fa===Object(Gb.a)("AddinPickerDisableError")&&this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?
Object.assign(new Rj.a,{Id:"ErrorView",ExternalId:"ReloadAddInPickerStoreDisabled",IconName:G,Label:fa,RetryButtonTitle:Ya?Object(Gb.a)("AddinPickerTryAgain"):"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===G?fa:Object(Gb.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(Gb.a)("AddinPickerDisableErrorDocumentText"),LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",
ea.AFrameworkApplication.uiCulture),OnLinkClicked:()=>{ma.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):Object.assign(new Rj.a,{Id:"ErrorView",ExternalId:Tc,IconName:G,Label:fa,RetryButtonTitle:Ya?Kb:"",OnRetryCommandId:sc,AriaDescription:"StoreDisabled"===G?fa:Object(Gb.a)("AddinPickerTryAgainAriaLabel")});Array.add(f.ControlList,fd);return f}y8e(f,G){var fa=new Ra.a;for(let Ya=0;Ya<f.length;Ya++)fa.add(f[Ya]);if(this.Bl.Wxb||!this.Lsa)30<fa.count&&(fa=
k(fa,(new Date).getDate())),this.Lsa=fa.toArray();for(f=0;f<this.Lsa.length;f++)for(fa=0;fa<G.length;fa++)if(this.Lsa[f].solutionId.toLowerCase()===G[fa].solutionId.toLowerCase()){Array.remove(this.Lsa,this.Lsa[f--]);break}return this.Lsa}LSi(f){var G=30,fa=(new Date).getDate();G>f.length&&(G=f.length);var Ya=new Gc(fa);for(fa=new Set;fa.size<G;){const Kb=Ya.next(f.length);fa.add(Kb)}for(G=0;G<f.length;G++)Ya=f[G].addinInfo,fa.has(G)?Ya.AUP*=20:Ya.AUP=1===Ya.priority?4*Ya.AUP:2===Ya.priority?2*Ya.AUP:
1*Ya.AUP;f.sort((Kb,sc)=>Kb.addinInfo.AUP<sc.addinInfo.AUP?1:-1);return f}TYi(f,G){f=f.filter(fa=>!G.some(Ya=>Ya.solutionId.toLowerCase()===fa.solutionId.toLowerCase()));return this.LSi(f).slice(0,30)}Ohk(f){if(0===f.errorCode||2===f.WL&&5===f.errorCode)f.Dt?this.LCg(f.Dt):ma.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${Rd.a[f.WL]}`)}LCg(f){return Promise.all(f.map(G=>{var fa,Ya;if(G&&G.solutionId&&G.iconUrl)return appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+
G.solutionId,G.iconUrl);ma.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(fa=null===G||void 0===G?void 0:G.solutionId)&&void 0!==fa?fa:"null",null!==(Ya=null===G||void 0===G?void 0:G.iconUrl)&&void 0!==Ya?Ya:"null");return Promise.resolve()}))}PCi(f){var G;const fa=this.Bl.r5e,Ya=fa?String.format(null!==(G=Object(Gb.a)("AddInSearchBoxRecommendationPlaceholder"))&&void 0!==G?G:"",fa):Object(Gb.a)("AddInSearchBoxPlaceholder");return Object.assign(new Mk.a,
{ExternalId:"SearchAddinInFlyout",Label:Ya,ShowIcon:!0,Underlined:!0,Value:this.Vcb,ResultAriaLiveText:f,OnChangeCommandId:"SearchAddinInFlyout"})}r7h(f,G){const fa=Object.assign(new P.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,fa);f=this.NIf("MRUAddinsSearchResutlsGalleryControl",G,!1,!1);Array.add(fa.ControlList,f)}B7h(f,G){const fa=Object.assign(new P.a,{Id:"PopularAddinsListSearchResutlsSection",ControlsId:"PopularAddinsSearchResutlsSection.Controls",
ControlList:[],Title:Object(Gb.a)("AddInSearchResultsDivider")});for(let Ya=0;Ya<G.length;Ya++)fa.ControlList.push(this.hzc("PopularAddinsSearchResultsItem"+Ya,G[Ya]));Array.add(f.MenuSectionList,fa)}V7h(f){if(this.Bl.qFh){var G=n(Object(Gb.a)("AddInSearchNoResultsLink1"),"https://aka.ms/Officeaddins"),fa=n(Object(Gb.a)("AddInSearchNoResultsLink2"),"https://aka.ms/OfficeAddinOverview");G="Excel"===this.Bl.host?String.format(Object(Gb.a)("AddInSearchNoResultsDescription2"),G,fa):String.format(Object(Gb.a)("AddInSearchNoResultsDescription3"),
fa);G=x(Rj.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:"NoSearchResultsV2",Title:Object(Gb.a)("AddInSearchNoResultsTitle"),IsNoResultView:!0,LinkText:`${Object(Gb.a)("AddInSearchNoResultsDescription1")} ${G}`});fa=x(P.a,{Id:"ErrorViewSection",ControlsId:"ErrorViewSection.Controls",ControlList:[]});Array.add(fa.ControlList,G);Array.add(f.MenuSectionList,fa)}else G=this.Uyc({iconName:"NoSearchResults",nEc:Object(Gb.a)("AddInSearchNoResultsHint")}),Array.add(f.MenuSectionList,G)}Ivi(f,
G){const fa=f.toLocaleLowerCase();f=G.filter(Ya=>{this.rAb[Ya.solutionId]||(this.rAb[Ya.solutionId]=Ya.displayName.toLocaleLowerCase());return this.rAb[Ya.solutionId].includes(fa)});f.sort((Ya,Kb)=>this.rAb[Ya.solutionId].indexOf(fa)-this.rAb[Kb.solutionId].indexOf(fa));return f}Lxk(f){const G=this;return Lo(function*(){G.IFb=G.Bl.tFh?yield G.S$a.vMg(f):yield G.S$a.uMg(f);yield G.LCg(G.IFb)})}Mxk(f){this.Vcb=f;appChrome.api.dispatch(appChrome.actions.updateSearchBoxValue("SearchAddinInFlyout",f));
this.Sic&&window.clearTimeout(this.Sic);this.Sic=window.setTimeout(()=>{var G;this.Sic=null;f?this.Lxk(f).catch(()=>{this.IFb=[];ma.ULS.sendTraceTag(507577680,220,10,"Failed to call search addins API")}).finally(()=>{var fa;this.Vcb===f&&(this.Yeg=!0,null===(fa=this.p5b)||void 0===fa?void 0:fa.call(this))}):(this.Yeg=!1,null===(G=this.p5b)||void 0===G?void 0:G.call(this))},this.tXe)}set Yeg(f){this.Bl.W3||(this.Vic=!1);this.Vic=f}get zai(){let f=!1;this.Vic&&(this.Vic=!1,f=this.Bl.W3);f||(this.Vcb=
"",this.IFb=[]);return f}GDk(){let f;e(G=>{const fa=document.getElementById("Ribbon-InsertAddInFlyoutDropdown")||document.getElementById("InsertAddInFlyoutMenuId");fa&&G&&(f=()=>{var Ya;null===(Ya=document.getElementById("SearchAddinInFlyout"))||void 0===Ya?void 0:Ya.focus();fa.removeEventListener("focus",f);f=void 0},fa.addEventListener("focus",f))})}l7j(f){if(f)try{f.MenuItems=this.MPi(this.zai,f.IsShadowMenuOpen)}catch(G){ma.ULS.sendTraceTag(509687425,220,10,`GetReactGalleryMenu hit exception ${G.message}; stack: ${G.stack}`)}else ma.ULS.sendTraceTag(509687424,
220,10,"PopulateMenu menuProps is null")}OQk(){new Qk(this.yQ,this.Bl.host,this.Bl,this.S$a,this.NGe,this.URa,this.IZe,this.z_j.bind(this),this.y_j.bind(this));e(f=>{f&&u()});yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAddInStoreDialog"})}z_j(f){this.bZe=f}y_j(f){yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.CloseAddInStoreDialog",dataFields:kd.a.V5a({["OpenDuration"]:f-this.bZe})})}dispose(){}k$j(f){var G;const fa=null===(G=this.RNe)||void 0===G?void 0:G.hVa;f.sort((Ya,
Kb)=>{Ya=null===fa||void 0===fa?void 0:fa.includes(Ya.solutionId);Kb=null===fa||void 0===fa?void 0:fa.includes(Kb.solutionId);return Ya&&!Kb?-1:!Ya&&Kb?1:0})}get V3(){this.ARa||(this.ARa=new Kk("Flyout",this.Ha));return this.ARa}}Object(ja.a)(Gj,"AppsFlyoutGenerator",null,[2]);var Vh=a(91),dk;(function(f){f.Qfl="APIC";f.Rfl="APID";f.egl="BBM";f.ogl="CAIP";f.Dgl="DA";f.Ggl="DWT";f.ihl="ER";f.shl="FA";f.Lhl="IPWAI";f.Lil="PAIYO";f.Hjl="TD";f.akl="WF";f.Tjl="WN"})(dk||(dk={}));Object(ja.b)("AddinCategoryType",
dk);const sl={["TD"]:[{solutionId:"wa200004805",addinInfo:{diffAUP:55500}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa102957665",addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}}],["WN"]:[{solutionId:"wa200006017",
addinInfo:{releaseDate:16951392E5}},{solutionId:"wa200006008",addinInfo:{releaseDate:169488E7}},{solutionId:"wa200005960",addinInfo:{releaseDate:16938432E5}},{solutionId:"wa200005817",addinInfo:{releaseDate:16886592E5}},{solutionId:"wa200005702",addinInfo:{releaseDate:16891776E5}},{solutionId:"wa200005782",addinInfo:{AUP:52,releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},
{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}]},xl={["PAIYO"]:[],["BBM"]:[{solutionId:"wa102957661",addinInfo:{AUP:14891}},{solutionId:"wa104104476",addinInfo:{AUP:14404}},{solutionId:"wa104381701",addinInfo:{AUP:9652}},{solutionId:"wa104379629",addinInfo:{AUP:4E3}},{solutionId:"wa104381504",addinInfo:{AUP:1820}},{solutionId:"wa200003696",addinInfo:{AUP:1707}},{solutionId:"wa104380330",addinInfo:{AUP:793}},
{solutionId:"wa104099688",addinInfo:{AUP:404}},{solutionId:"wa200005702",addinInfo:{AUP:68}}]},xk={["IPWAI"]:[{solutionId:"wa200005271",addinInfo:{AUP:12195}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}},{solutionId:"wa200001584",addinInfo:{AUP:2278}},{solutionId:"wa200005107",addinInfo:{AUP:451}},{solutionId:"wa200005281",addinInfo:{AUP:595}},{solutionId:"wa200005333",addinInfo:{AUP:101}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa200006007",addinInfo:{AUP:235,
diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}],["APIC"]:[{solutionId:"wa102957665",addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104381973",addinInfo:{AUP:55837}},{solutionId:"wa104051163",addinInfo:{AUP:1643}},{solutionId:"wa104221182",addinInfo:{AUP:2980}},{solutionId:"wa104104476",addinInfo:{AUP:13287}},{solutionId:"wa200004688",addinInfo:{AUP:1260}},
{solutionId:"wa104379169",addinInfo:{AUP:69}},{solutionId:"wa103147117",addinInfo:{AUP:89}},{solutionId:"wa200004179",addinInfo:{AUP:1072}},{solutionId:"wa104380194",addinInfo:{AUP:1245}},{solutionId:"wa200003220",addinInfo:{AUP:192}},{solutionId:"wa200004687",addinInfo:{AUP:226}}],["DA"]:[{solutionId:"wa200002503",addinInfo:{AUP:461}},{solutionId:"wa200000018",addinInfo:{AUP:2210}},{solutionId:"wa200000169",addinInfo:{AUP:1962}},{solutionId:"wa104381841",addinInfo:{AUP:1010}},{solutionId:"wa200003784",
addinInfo:{AUP:875}},{solutionId:"wa104381807",addinInfo:{AUP:308}},{solutionId:"wa104380711",addinInfo:{AUP:357}},{solutionId:"wa200000025",addinInfo:{AUP:1058,diffAUP:4600}},{solutionId:"wa200005782",addinInfo:{AUP:52,releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}}],["FA"]:[{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa104381859",addinInfo:{AUP:380}},{solutionId:"wa104381717",addinInfo:{AUP:217}},{solutionId:"wa200003692",
addinInfo:{AUP:295}},{solutionId:"wa104381695",addinInfo:{AUP:299}},{solutionId:"wa104380978",addinInfo:{AUP:347}}]};class Sk{constructor(f,G,fa,Ya,Kb,sc,Tc,fd){Tc=void 0===Tc?null:Tc;this.UA=fd;this.disposed=!1;this.Clc=this.aGa=null;this.gIb=0;this.insertTab="Insert";this.homeTab="Home";this.FZf=this.Kse=!1;this.syi=1E3;this.yyi="AddinFlyoutFeedbackSurvey";this.zyi=15E3;this.lse=!0;this.C$e=!1;this.oRh=ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?`[{"title":"${CommonUiStrings.AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUiStrings.AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUiStrings.AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`:
`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`;
this.m1i=(ud,Td,me,ne)=>{if(ud){if(ud=this.hJa(ud,ne))ud={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ud.solutionId,ud.storeType,ud.assetId,ud.storeId)},ud.href=Td,ud.UILocation=me,ud.ControlId=ne,yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:kd.a.Pm(ud)})}else ma.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.Sok=()=>{this.Clc?this.Clc.qvg():ma.ULS.sendTraceTag(507896192,220,10,"_addInCategoryManager is null")};
this.Z2i=(ud,Td,me)=>{(ud=this.hJa(ud,me))?this.qD.zAf(ud).then(ne=>{const Me={};Me.solutionId=ne.solutionId;Me.version=ne.version;Me.storeType=ne.storeType;Me.storeId=ne.storeId;Me.assetId=ne.assetId;Me.assetStoreId=ne.assetStoreId;Me.targetType=ne.targetType;Me.displayName=ne.displayName;Me.width=ne.width;Me.height=ne.height;this.GPf(Td,me,Me)}).catch(ne=>{ma.ULS.sendTraceTag(507631067,220,10,ne.message)}):ma.ULS.sendTraceTag(507631068,220,10,"No search add-in details.")};this.c5i=ud=>{const Td=
ud.substring(14);"All"===Td||Object.values(dk).some(me=>me===Td)?this.qD.RWk(Td):ma.ULS.sendTraceTag(507564195,220,10,`Bad category switch. SourceControlId=${ud}.`)};this.e5i=()=>{this.qD?this.qD.s2i():ma.ULS.sendTraceTag(507523100,220,10,`Bad fre content switch. appsFlyoutGenerator is valid: ${!!this.qD}`)};this.d5i=ud=>{(ud=ud.SourceControlId)&&this.qD?this.qD.r2i(ud):ma.ULS.sendTraceTag(507560522,220,10,`Bad fre banner switch. SourceControlId=${ud}; appsFlyoutGenerator is valid: ${!!this.qD}`)};
this.lQd=(ud,Td,me)=>{if(this.W3&&(null===me||void 0===me?0:me.startsWith("PopularAddinsSearchResultsItem")))this.Z2i(ud,Td,me);else{if(this.qD.Uaa){ud=this.hJa(ud,me);if(!ud){ma.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");return}ud=ud.q$b()}else ud=this.aIf(ud,me);ud?this.GPf(Td,me,ud):ma.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")}};this.GPf=(ud,Td,me)=>{const ne={[Dc.a.S9]:me,[vb.a.Wk]:this.Ai.mfa(me)},Me=new sb.a(-741808261,
0,this.$.ii,ud,"");this.$.Ma.qh(Me,ne);this.Ai.opa("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,me);ud={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(me.solutionId,me.storeType,me.assetId,me.storeId),["UILocation"]:ud,["ControlId"]:Td,["FRECategory"]:this.Zta?this.qD.GMg:void 0,["FRECarouselCategory"]:this.xea?this.qD.cCf:void 0};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:kd.a.Pm(ud)})};this.QSb=(ud,Td,me)=>{me=
void 0===me?null:me;if(ud)if(ud=this.hJa(ud,me)){var ne=this.Ai.Dl;ne=ne?ne.getAppUILocale()||"en-US":"en-US";this.aGa=new Qj(ud.solutionId,"wac_excel",ne,Me=>{this.Ai.opa("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Me);const Df=new sb.a(-741808261,0,this.$.ii,Td,null);this.$.Ma.qh(Df,{[Dc.a.S9]:Me,[vb.a.Wk]:this.Ai.mfa(Me)});this.aGa&&this.aGa.hide();va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(Me={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Me.solutionId,
Me.storeType,Me.assetId,null,null,Me.storeId),["UILocation"]:Td,["ControlId"]:me,["FRECategory"]:this.Zta?this.qD.GMg:void 0,["FRECarouselCategory"]:this.xea?this.qD.cCf:void 0},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:kd.a.Pm(Me)}))});this.aGa.initializeAndShow("",null,null)}else ma.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else ma.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};
this.l3i=(ud,Td,me)=>{var ne;if(ud){if(this.qD.Uaa){ud=this.hJa(ud);if(!ud){ma.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}ud=ud.q$b()}else if(ud=this.aIf(ud),!ud){ma.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var Me={[Dc.a.S9]:ud,[vb.a.Wk]:this.Ai.mfa(ud)},Df=new sb.a(-741808261,0,this.$.ii,Td,"");this.$.Ma.qh(Df,Me);null===(ne=this.XTf)||void 0===ne?void 0:ne.bEj(ud.solutionId);va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&(Td={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ud.solutionId,ud.storeType,ud.assetId,null,null,ud.storeId),["UILocation"]:Td,["ControlId"]:me},yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:kd.a.Pm(Td)}))}else ma.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.hJa=(ud,Td)=>this.W3&&(null===Td||void 0===Td?0:Td.startsWith("PopularAddinsSearchResultsItem"))?this.qD.MVi(ud):this.qD.Uaa?this.qD.hJa(ud):this.cU.TI(ud);
this.$2i=(ud,Td)=>{if(ud){var me={};me.solutionId=ud.solutionId;me.version=ud.version;me.storeType=ud.storeType;me.storeId=ud.storeId;me.assetId=ud.assetId;me.assetStoreId=ud.assetStoreId;me.targetType=ud.targetType;me.displayName=ud.displayName;me.width=ud.width;me.height=ud.height;ud={[Dc.a.S9]:me,[vb.a.Wk]:this.Ai.mfa(me)};var ne=new sb.a(-741808261,0,this.$.ii,2,"");this.$.Ma.qh(ne,ud);this.Ai.opa("installAddinFromStoreExp",OSF.AgaveHostAction.ClickTrust,me);Td={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(me.solutionId,
me.storeType,me.assetId,null,null,me.storeId),["source"]:Td,["userAction"]:"SingleClickInstall"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",dataFields:kd.a.Pm(Td)})}else ma.ULS.sendTraceTag(507332238,220,10,"AddinDetail is null.")};this.b3i=(ud,Td)=>{ud?this.qD.zAf(ud).then(me=>{var ne={};ne.solutionId=me.solutionId;ne.version=me.version;ne.storeType=me.storeType;ne.storeId=me.storeId;ne.assetId=me.assetId;ne.assetStoreId=me.assetStoreId;ne.targetType=me.targetType;
ne.displayName=me.displayName;ne.width=me.width;ne.height=me.height;me={[Dc.a.S9]:ne,[vb.a.Wk]:this.Ai.mfa(ne)};const Me=new sb.a(-741808261,0,this.$.ii,2,"");this.$.Ma.qh(Me,me);this.Ai.opa("installAddinFromStoreExp",OSF.AgaveHostAction.ClickTrust,ne);ne={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ne.solutionId,ne.storeType,ne.assetId,null,null,ne.storeId),["source"]:Td,["userAction"]:"SingleClickInstall"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",
dataFields:kd.a.Pm(ne)})}).catch(me=>{ma.ULS.sendTraceTag(507332236,220,10,me.message)}):ma.ULS.sendTraceTag(507332237,220,10,"AddinDetail is null.")};this.h3i=(ud,Td)=>{if(ud){var me=this.Ai.Dl;me=me?me.getAppUILocale()||"en-US":"en-US";this.aGa=new Qj(ud.solutionId,"wac_excel",me,ne=>{this.Ai.opa("installAddinFromStoreExp",OSF.AgaveHostAction.ClickTrust,ne);const Me=new sb.a(-741808261,0,this.$.ii,2,null);this.$.Ma.qh(Me,{[Dc.a.S9]:ne,[vb.a.Wk]:this.Ai.mfa(ne)});this.aGa&&this.aGa.hide();ne={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ne.solutionId,
ne.storeType,ne.assetId,null,null,ne.storeId),["source"]:Td,["userAction"]:"AddinDetailsDialogInstall"};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",dataFields:kd.a.Pm(ne)})});this.aGa.initializeAndShow("",null,null);ud={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ud.solutionId,ud.storeType,ud.assetId,null,null,ud.storeId),["source"]:Td};yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAddInInstallDialogFromStoreExp",dataFields:kd.a.Pm(ud)})}else ma.ULS.sendTraceTag(507332235,
220,10,"AddinDetail is null.")};this.j3i=()=>{const ud=new sb.a(1296389134,0,this.$.ii,2,null);this.$.Ma.qh(ud,{[vb.a.$Sk]:"InsertMoreAddInsFromFooter"});yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAppForOfficeDialogFromStoreExp"})};this.vNj=(ud,Td)=>{if(Td)if(Td)if(ud=Td.hs){if(mk()||Ni()){const ne=this.$.ea.workbookContext.WebExtensions;if(ne){let Me=!1;for(var me of ne)if(me.PrimaryMarketplace.SolutionId.toLowerCase()===ud.solutionId.toLowerCase()){Me=!0;break}if(!Me){ma.ULS.sendTraceTag(512258444,
220,15,"Not find add-in persisted in the template file.");return}}else{ma.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Td=Td.Iw;me=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(ud.solutionId in me)Td=me[ud.solutionId];else if(Td=this.hIi(Td),void 0===Td||null===Td){ma.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}me=new sb.a(lg.a.qea,0,0,2,null);this.executeCommand(0,me,{["SourceControlId"]:Td},
null);ud.isAutoLaunched=!0}else ma.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else ma.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else ma.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.a_j=(ud,Td)=>{null==Td?yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:kd.a.Pm({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})}):
va.EwaSettings.isChangeGateEnabled("OfficeVSO:8180233_AddNullCheck")&&isNullOrUndefined(this.$)||(this.jyb=new ki(this),this.jyb.Hik(Td),ud=this.$.Ma,va.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.jIb?this.dBa?(Td=appChrome.selectors.getSelectedTabId())&&De.a(Td,this.homeTab)?this.jyb.$Vg():null!==ud&&(ud.zpd(this.Aae),ma.ULS.sendTraceTag(508564945,220,50,"Register home tab switched event")):ma.ULS.sendTraceTag(508564944,802,50,"selector is not ready"):
null!==ud&&(ud.zpd(this.Aae),ma.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))};this.Aae=(ud,Td)=>{ud=this.insertTab;va.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.jIb&&(ud=this.homeTab);Td.tabName===ud&&(Td=this.$.Ma,null!=Td&&(Td.TFg(this.Aae),ma.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.jyb.$Vg())};this.IVj=(ud,Td)=>{ud=null;Td&&(ud=Td);(null===ud||void 0===ud?0:ud.Iw)&&this.YFk(ud.Iw);
this.$.Dm();ud&&ud.hs&&this.yLh(ud.hs)};this.W5k=(ud,Td)=>{Td.WL===Rd.a.DIj&&(this.gIb|=1);Td.WL===Rd.a.fGh&&(this.gIb|=2);!ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)&&this.JSg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=f;ma.ULS.shipAssertTag(537170659,0,!(void 0===G||null===G),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Pj.a.jfa()}`);
this.Ai=G;this.Qif=fa;this.Hmc=Ya;this.jla=Kb;this.iIb=sc;this.Ex=new Oj.a;this.Yta=new Tf;this.WFd=Tc;je.a.Cmb=je.a.Nxf;this.WAd=new Ra.a;this.Aib=new Ra.a;this.jIb&&(this.Kse=ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1),this.cU=this.Ai.cU,null!==this.cU?(this.Clc=this.uNc?new Lk(ea.AFrameworkApplication.fa,this.cU,this.oRh):null,this.XTf=new qd(this.cU),f={lQd:this.$2i.bind(this),a3i:this.b3i.bind(this),QSb:this.h3i.bind(this),
i3i:this.j3i.bind(this)},this.qD=new Gj(ea.AFrameworkApplication.yh,this.cU,lg.a.IYb.toString(),lg.a.cqb.toString(),this.p6b?"-1777747317":"1296389134",ea.AFrameworkApplication.fa,this.Clc,this.zGi(),this.XTf,()=>{var ud;return null===(ud=this.UA)||void 0===ud?void 0:ud.call(this,"InsertAddInFlyout")},f),this.cU.AAa(this.W5k)):ma.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get jIb(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&
ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get uNc(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1)}get Ogi(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",!1)}get W3(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get xea(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",
!1)}get Zta(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get p6b(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get isBusinessUser(){return!!ea.AFrameworkApplication.hi.IsBusinessUser}get isEduUser(){return!!ea.AFrameworkApplication.hi.IsEduUser}get isAnonymousUser(){return ea.AFrameworkApplication.fa.ka("IsAnonymousUser")}CQh(){return`IsBusinessUser: ${this.isBusinessUser}, IsEduUser: ${this.isEduUser}, IsAnonymousUser: ${this.isAnonymousUser}`}zGi(){const f=
this.Ogi&&this.isBusinessUser?xl:sl;for(const G in xk)f[G]=xk[G];return f}dispose(){void 0!==this.iIb&&null!==this.iIb&&(this.iIb.dispose(),this.iIb=null);this.Ai=this.$=null;this.disposed=!0}PKk(f,G){switch(f){case lg.a.qea:f=this.yKk(G);break;default:f=!1}return f}Ri(f,G){return"Dev Box"===ea.AFrameworkApplication.fa.Za("StatusBarEnvironmentNameToUse")?!1:619219938===G?(va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TempTelemetryOfInsertAddInFlyout",!1)&&Object(gd.a)("getRibbonSubComponentStatus")&&
(f=appChrome.api.getRibbonSubComponentStatus("insertAddInFlyout"),ma.ULS.sendTraceTag(507909329,220,50,`insertAddInFlyout status=${f}`)),!this.JSg()):!1}executeCommand(f,G,fa){f=Qa.TaskExtensions.Gq();var Ya=G.command;G=sc=>{let Tc=null;if(!sc)return Tc;(Tc=sc.CommandValueId)||(Tc=this.qD.WOd(sc.SourceControlId));Tc||ma.ULS.sendTraceTag(508560270,220,10,"UniqueId is null.");return Tc};switch(Ya){case 843847158:break;case lg.a.IYb:this.uOa();var Kb=fa.UILocation;this.uNc?(fa=G(fa),this.QSb(fa,Kb)):
(fa=fa.SourceControlId)?this.QSb(this.qD.WOd(fa),Kb):ma.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break;case lg.a.J2a:this.uOa();G=this.uNc?G(fa):fa.CommandValueId;Kb=fa.UILocation;Ya=fa.SourceControlId;"LinkClickedPayload"===fa.Type?this.m1i(G,fa.Href,Kb,Ya):this.QSb(G,Kb,Ya);break;case lg.a.pne:this.W3&&this.qD.Mxk(null!==(Kb=fa.SearchBoxNewValue)&&void 0!==Kb?Kb:"");break;case lg.a.M9b:this.Zta&&(this.uOa(),this.c5i(fa.SourceControlId));break;case lg.a.B0c:this.xea&&this.d5i(fa);
break;case lg.a.A0c:this.xea&&this.e5i();break;case lg.a.POb:this.C$e||(this.cU.AAa(this.Sok),this.C$e=!0);break;case lg.a.Txa:this.uOa();this.lQd(fa.CommandValueId,fa.UILocation,fa.SourceControlId);break;case lg.a.cqb:this.uOa();Kb=fa.UILocation;Ya=fa.SqmControlId;const sc=fa.SourceControlId;if(this.uNc)fa=G(fa);else{if(!sc){ma.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}fa=this.qD.Uaa?this.qD.WOd(sc):this.qD.Z1h[sc]}this.l3i(fa,Kb,null!==Ya&&void 0!==Ya?Ya:sc);break;case -2025863019:td.a.Ise(fa[Dc.a.Kpd].toString(),
()=>{ba.f(this.$).focus()});break;case -1777565636:sk.a.showUILessDialog(fa[Dc.a.kIb].toString());this.Ai.qOk(fa[Dc.a.kIb].toString());break;case 1592314317:sk.a.hideUILessDialog(fa[Dc.a.kIb].toString());this.Ai.x7i(fa[Dc.a.kIb].toString());break;case lg.a.qea:f=this.UPd(fa);break;case lg.a.aqb:this.HYb(fa);break;case lg.a.pG:this.Tak(fa);break;case lg.a.kqa:this.kqa(fa);break;case lg.a.k8b:this.iIb.OZc();break;case lg.a.refreshAddinCommands:this.sgk();break;case 1949669462:this.jla.WOg(!0);break;
case -1014260128:f=this.executeDynamicAddInCommandsAPI(fa);break;default:f=Ia.a(Ya)}return f}Gi(f,G,fa){f=!1;switch(G.command){case lg.a.J2a:case lg.a.Txa:case lg.a.IYb:case lg.a.cqb:case lg.a.pne:case lg.a.M9b:case lg.a.B0c:case lg.a.POb:f=!!fa;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case lg.a.pG:case lg.a.kqa:case lg.a.k8b:case lg.a.refreshAddinCommands:case 1949669462:case lg.a.aqb:case -1014260128:f=!0;break;case lg.a.qea:f=!ea.AFrameworkApplication.protectedFile}return f}JSg(){return!va.EwaSettings.isChangeGateEnabled("OfficeVSO:8162137_NullCheckForFlyoutControlEnabled")||
void 0!==this.$&&null!==this.$?ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)?this.$.b4&&!va.EwaSettings.Ra(174):0!==this.gIb&&this.$.b4&&!va.EwaSettings.Ra(174):(ma.ULS.sendTraceTag(508380621,220,15,"ewaControl is null"),!1)}dj(f,G,fa){switch(G){case "PopulateAddInGallery":return va.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.PopulateAddinGallery",
dataFields:kd.a.Pm({})}),va.EwaSettings.isChangeGateEnabled("OfficeVSO:8464891_ShowUserSegmentInformationEnabled")&&yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.UserSegmentInformation",dataFields:kd.a.Pm({["UserSegment"]:this.CQh()})}),this.qD.l7j(fa),this.Kse&&(this.uOa(),this.C1d()),!0;default:return!1}}C1d(){Z.a.instance.getItem("AddinFlyoutOnExcelSurveyShowed")&&(this.lse=!1);this.lse&&(window.setTimeout(()=>{const f=this.AAc();f&&"hidden"!==f.visibility&&(this.FZf=!0)},this.syi),
this.VDg=window.setTimeout(()=>{this.ZZg=Ab.a.instance.fj("Common.ISystemInitiatedFeedback");Z.a.instance.setItem("removeFlyoutTaskTimeoutId",this.VDg.toString());this.FZf&&this.ZZg&&this.ZZg.execute(f=>{const G=this.AAc();G&&"hidden"===G.visibility&&(f.m8a(this.yyi,null),this.lse=!1,Z.a.instance.setItem("AddinFlyoutOnExcelSurveyShowed","1"))})},this.zyi))}AAc(){let f=null;try{const G=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");G&&(f=Ge.a.CE(G.parentNode.parentNode.parentNode))}catch(G){ma.ULS.sendTraceTag(508911886,
220,10,"AddinFlyout get parent and parent get exception "+(G?G.toString():""))}return f}uOa(){this.Kse&&(window.clearTimeout(this.VDg),Z.a.instance.removeItem("removeFlyoutTaskTimeoutId"))}hIi(f){if(!f)return ma.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((f=f.b7)&&f.fC&&0<f.fC.count)for(const G of f.fC){if(G.groups&&1===G.groups.length){f=G.groups[0];if(f.controls&&1===f.controls.length){const fa=f.controls[0];if(fa.attributes&&!fa.controlType&&fa.enabled)return fa.id}f.controls&&
ma.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}G.groups&&ma.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get EM(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}Tak(f){if(f&&Dc.a.T9 in f)if(this.Ai){var G=f[Dc.a.T9];this.EM?Dc.a.Lmc in f&&(f=f[Dc.a.Lmc],this.Ai.Hub(G,f),1===f&&this.pG(G,!0)):this.pG(G,
!0)}else ma.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else ma.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}pG(f,G){G=void 0===G?!1:G;this.Ai?(ma.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",f,G),this.Ai.pG(f,G)):ma.ULS.sendTraceTag(508564227,220,50,"QueryAddinDetails: abort because ddaFacadeService is null.")}sgk(){if(this.jla.rLc()){this.jla.pff();
var f=this.PJd();if(f&&0<f.count)for(const G of f)f={[Dc.a.T9]:G,[Dc.a.U3]:4,[Dc.a.eVa]:(new Date).getTime()},this.kqa(f)}else ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(ma.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.jla.rLc()),this.pG(10,!0),this.pG(0,!0))}kqa(f){ma.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${f[Dc.a.U3]}, DataProvider ${f[Dc.a.T9]}.`);
this.jla.KBk();window.setTimeout(()=>{if(void 0===this.Ai||null===this.Ai)ma.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Pj.a.jfa()}`);else{const G=new Bj(new Cj(this.Ai.Dl),pj.instance,pd.instance);G.YAh((fa,Ya)=>{ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.pG(f[Dc.a.T9]);this.HYb(Ya.properties)});G.JEh(this.a_j);G.A3k(f)}},0)}HYb(f){if(!this.disposed){ma.ULS.sendTraceTag(537170655,
220,50,`LaunchOperationType ${f[Dc.a.U3]}.`);try{if(va.EwaSettings.Ra(174)){const Ya=f[Dc.a.hIb];if(Ya&&0<Ya.count){const Kb=Ya.count;for(let sc=Kb-1;0<=sc;sc--){const Tc=Ya.na(sc);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||Ya.remove(Ya.na(sc))}if(Ya.count<Kb){const sc=Object(Vh.d)(qa.a.resolve(da.C,{va:0}));Qa.TaskExtensions.Xa(sc,()=>{sc.result.Mm(36,null)},this.$.ya,3)}if(!Ya.count)return}}if(void 0===this.Ai||null===this.Ai)ma.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Pj.a.jfa()}`);
else{var G=null;G=ea.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new pk(this.Ex,this.Qif,new Cj(this.Ai.Dl),new rk(this.$.xi,lg.a.qea),this.jla,pj.instance,this.Yta,(Ya,Kb)=>{const sc={};sc.InstanceId=af.a.create().toString();sc.PrimaryMarketplace={};sc.PrimaryMarketplace.SolutionId=Ya.solutionId;sc.PrimaryMarketplace.SolutionVersion=Ya.version;sc.PrimaryMarketplace.MarketplaceType=Ya.storeType;sc.PrimaryMarketplace.MarketplaceRef=Ya.storeId;sc.WebExtensionType=1;this.Ai.aRk(sc,()=>
{Kb(Ya)})}):new pk(this.Ex,this.Qif,new Cj(this.Ai.Dl),new rk(this.$.xi,lg.a.qea),this.jla,pj.instance,this.Yta);G.eBh(this.vNj);G.ZAh(this.IVj);var fa=new ki(this);G.cDh(fa.HVj);G.IEh(fa.ZNk);this.$.la.lh(53).ns&&mf.a.get_instance().Qm(5,null).continueWith(()=>{this.disposed||G.Uvj(this.WFd,this.$.domElement,f)})}}catch(Ya){ma.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Ya.message}.`)}}}UPd(f){const G=Qa.TaskExtensions.Gq();f=f[this.Ex.fva];const fa=this.Hmc.Cmd(f),Ya=
new sk.a(this.$,this.Ai,fa.ownerAddinInfo,G);return this.FOf(G,f,fa,Ya)}FOf(f,G,fa,Ya){this.Hmc.UPd(G,this.jla,Ya,new Cj(this.Ai.Dl),fa,()=>{f=Ya.c1h()},()=>{ba.f(this.$).focus()});return f}yLh(f){const G=Qa.TaskExtensions.Gq();var fa=this.Ai.m5(f.solutionId);if(fa){var Ya=this.Ai.UX(fa);if(yd.HelperMethods.XF(Ya)&&0!==Ya.SharedRuntime.State)return}Ya=this.Hmc.zLh;const Kb=f.solutionId in Ya?Ya[f.solutionId]:null;if(Kb){const sc=this.Hmc.Cmd(Kb),Tc=new sk.a(this.$,this.Ai,sc.ownerAddinInfo,G),fd=
Telemetry.PrivacyRules.GetPrivacyCompliantId(f.solutionId,null!==sc.ownerAddinInfo?sc.ownerAddinInfo.storeType:f.storeType,f.assetId,null,null,f.storeId);Ya=ud=>{if(ud){const Td={};for(const me of ud)Td[me[0]]=me[1];(ud=Dc.a.j5e in Td?Td[Dc.a.j5e]:null)&&"true"===ud.toLowerCase()&&(ma.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${f.storeType}, StoreId ${f.storeId}, SolutionId ${fd}.`),this.FOf(G,Kb,sc,Tc))}};ma.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${f.storeType}, StoreId ${f.storeId}, SolutionId ${fd}.`);
if(fa)Ya(this.Ai.UX(fa).OsfPropertyBag);else if(fa=this.$.ea.workbookContext.WebExtensions)for(const ud of fa)if((1===ud.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===f.targetType&&ud.PrimaryMarketplace.MarketplaceType.toLowerCase()===f.storeType.toLowerCase()&&ud.PrimaryMarketplace.MarketplaceRef.toLowerCase()===f.storeId.toLowerCase()&&ud.PrimaryMarketplace.SolutionId.toLowerCase()===f.solutionId.toLowerCase()){Ya(ud.OsfPropertyBag);break}}}bwe(f,G,fa){f&&(void 0===
fa||!fa||G||this.WAd.contains(f)||this.WAd.add(f),(fa=this.Aib.contains(f))&&G&&this.Aib.remove(f),fa||G||this.Aib.add(f))}YFk(f){if((f=f.b7)&&f.fC)for(const G of f.fC)if(G.groups)for(const fa of G.groups)if(fa.controls)for(const Ya of fa.controls)if(this.bwe(Ya.id,Ya.enabled,!0),1===Ya.controlType&&Ya.menuItems)for(const Kb of Ya.menuItems)this.bwe(Kb.id,Kb.enabled,!0)}PJd(){const f=new Ra.a;va.EwaSettings.Ra(52)&&(this.$.ea.Vn.get(27)&&(f.add(0),f.add(16)),this.$.ea.Vn.get(33)&&f.add(1),f.add(8));
return f}executeDynamicAddInCommandsAPI(f){let G=!0;if(void 0===f||null===f||void 0===f[Dc.a.oOb]||null===f[Dc.a.oOb])return of.Task.Ua(!1);switch(f[Dc.a.oOb]){case 1:G=this.P6k(f);break;case 2:G=this.bGk(f);break;case 4:this.Aib.clear();this.Aib.addRange(this.WAd);break;case 3:G=this.installContextualTab(f);break;default:G=!1}return of.Task.Ua(G)}yKk(f){return f&&this.Ex.fva in f?(f=f[this.Ex.fva])?this.Aib.contains(f):!1:!1}P6k(f){var G=null;let fa=null,Ya=null,Kb=!0;void 0!==f[Dc.a.Gfa]&&null!==
f[Dc.a.Gfa]&&void 0!==f[this.Ex.fva]&&null!==f[this.Ex.fva]&&void 0!==f[Dc.a.Ffa]&&null!==f[Dc.a.Ffa]&&(G=f[Dc.a.Gfa],fa=f[Dc.a.Ivc],Ya=f[this.Ex.fva],Kb=f[Dc.a.Ffa]);if(!G||!Ya)return ma.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;f=(new Gk.a(this.$.xi,G,this.Ex,!0)).HZa(Ya);G={DynamicAddinCommandsApiName:"UpdateControlEnableState"};G.AssetId=fa;G.MaskedTabId=f;G.IsToEnable=Kb;ma.ULS.sendTraceTag(537170648,220,50,rb.a.Ci(G));this.bwe(f,
Kb);wj.a.dB.UB();return!0}bGk(f){var G,fa,Ya=null,Kb=null;let sc=null;var Tc=null;let fd=!0;void 0!==f[Dc.a.PCd]&&null!==f[Dc.a.PCd]&&void 0!==f[Dc.a.Gfa]&&null!==f[Dc.a.Gfa]&&void 0!==f[this.Ex.fva]&&null!==f[this.Ex.fva]&&void 0!==f[Dc.a.Ffa]&&null!==f[Dc.a.Ffa]&&(Ya=f[Dc.a.PCd],Kb=f[Dc.a.Gfa],sc=f[Dc.a.Ivc],Tc=f[this.Ex.fva],fd=f[Dc.a.Ffa]);if(!Ya||!Kb||!Tc)return ma.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;f=(new Gk.a(this.$.xi,
Kb,this.Ex,!0)).xMf(Tc);Tc={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Tc.StoreType=Ya;Tc.AssetId=sc;Tc.MaskedTabId=f;Tc.IsToShow=fd;ma.ULS.sendTraceTag(537170646,220,15,rb.a.Ci(Tc));Ya=this.jla.mwa(Ya,Kb,1);Kb=!1;if(null===(fa=null===(G=null===Ya||void 0===Ya?void 0:Ya.Iw)||void 0===G?void 0:G.b7)||void 0===fa?0:fa.fC)for(const ud of Ya.Iw.b7.fC)if(ud.id===f){Kb=!0;break}if(!Kb)return ma.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;G=[];fd?appChrome.selectors.getSelectedTabId()!==
f&&G.push(appChrome.actions.activateRibbonTab(f)):(appChrome.selectors.getSelectedTabId()===f&&G.push(appChrome.actions.setCurrentTab(Te.a.HS)),G.push(appChrome.actions.deactivateRibbonTab(f)));appChrome.api.dispatch(G);return!0}aIf(f,G){if(this.cU){if(f=this.hJa(f,G))return G={},G.solutionId=f.solutionId,G.version=f.version,G.storeType=f.storeType,G.storeId=f.storeId,G.assetId=f.assetId,G.assetStoreId=f.assetStoreId,G.targetType=f.targetType,G.displayName=f.displayName,G.width=f.width,G.height=f.height,
G;ma.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}ma.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(f){let G=null,fa=null,Ya=null;var Kb=null;if(void 0!==f[Dc.a.Gfa]&&null!==f[Dc.a.Gfa]&&void 0!==f[Dc.a.Ffa]&&null!==f[Dc.a.Ffa]){const sc=f[Dc.a.Ffa];G=f[Dc.a.Gfa];void 0!==sc[Dc.a.lYa]&&null!==sc[Dc.a.lYa]&&void 0!==sc[Dc.a.mYa]&&null!==sc[Dc.a.mYa]&&(fa=sc[Dc.a.lYa],Ya=sc[Dc.a.mYa],Kb=sc[Dc.a.QCd])}if(!(G&&Ya&&fa&&Kb))return ma.ULS.sendTraceTag(537170644,
220,15,"InstallContextualTab failed to invalid parameters"),!1;f=this.jla.mwa(Kb.PrimaryMarketplace.MarketplaceType,Kb.PrimaryMarketplace.SolutionId,1);if(null===f||void 0===f?0:f.Iw)return ma.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;f={};f.solutionId=Kb.PrimaryMarketplace.SolutionId;f.version=Kb.PrimaryMarketplace.SolutionVersion;f.storeType=Kb.PrimaryMarketplace.MarketplaceType;f.storeId=Kb.PrimaryMarketplace.MarketplaceRef;Kb.AssetMarketplace?(f.assetId=
Kb.AssetMarketplace.SolutionId,f.assetStoreId=Kb.AssetMarketplace.MarketplaceRef):(f.assetId=null,f.assetStoreId=null);f.targetType=Kb.WebExtensionOsfControlType;f.width=Kb.TaskpaneWidth;f.height=0;f.isAddinCommands=!0;Kb=new Ra.a;Kb.add(f);f={};f[Dc.a.hIb]=Kb;f[Dc.a.U3]=6;f[Dc.a.lYa]=fa;f[Dc.a.mYa]=Ya;this.HYb(f);return!0}get dBa(){return!!window.appChrome&&!!appChrome.selectors}}Object(ja.a)(Sk,"AddinUICommandHandler",null,[836,43,2]);var ek=a(51);class Tk{constructor(f,G,fa,Ya){this.lre=void 0===
f?null:f;this.Jmd=void 0===G?null:G;this.JAd=void 0===fa?null:fa;this.qPb=void 0===Ya?0:Ya}GPa(){return this.lre()}activate(){return this.Jmd()}deactivate(){this.JAd()}dispose(){this.JAd=this.Jmd=this.lre=null}}Object(ja.a)(Tk,"FeatureActivator",null,[891,2]);var li=a(52),yk=a(43);class Uk extends Be.a{constructor(f){super(f);this.handler=null;this.rwh=()=>{ma.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Ij&
16384)}]`);const G=new le.a;this.$.la.fi(53,Td=>{ma.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");G.setResult(Td)});const fa=G.task,Ya=new pa,Kb=Wa.a.getInstance(),sc=new jb(this.$,Kb),Tc=jd.GetServiceTaskFactory.create(this.$.la,203,this.ya,this.xh),fd=this.chk(Ya),ud=Object(Vh.d)(qa.a.resolve(da.ke,{va:this.xh}));return Qa.TaskExtensions.Xa(Qa.TaskExtensions.Wo([fa,Tc,fd,ud],this.ya),()=>{ma.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
da.xb.Aa()?void qa.a.resolve(da.xb,{va:this.xh}).then(Td=>{let me;if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)||ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)){const ne=fa.result;me=Me=>{var Df,Gf;return null===(Gf=null===(Df=null===ne||void 0===ne?void 0:ne.ns)||void 0===Df?void 0:Df.UA)||void 0===Gf?void 0:Gf.call(Df,Me)}}else me=()=>{};this.handler=new Sk(this.$,
Td,Ya,new Jd,Kb,sc,Ab.a.instance.Ho("Common.IExternalUICommandDefinitionMapping"),me);ma.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Qr([this.handler]);this.$.la.Hh(198,this.handler)}):Qa.TaskExtensions.Xa(jd.GetServiceTaskFactory.create(this.$.la,106,this.ya,this.xh),Td=>{Td=Td.result;let me;if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)){const ne=fa.result;me=Me=>
{var Df,Gf;return null===(Gf=null===(Df=null===ne||void 0===ne?void 0:ne.ns)||void 0===Df?void 0:Df.UA)||void 0===Gf?void 0:Gf.call(Df,Me)}}else me=()=>{};this.handler=new Sk(this.$,Td,Ya,new Jd,Kb,sc,Ab.a.instance.Ho("Common.IExternalUICommandDefinitionMapping"),me);ma.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Qr([this.handler]);this.$.la.Hh(198,this.handler)},this.ya,3)},this.ya,3)};this.Dbi=()=>{void 0!==this.handler&&null!==this.handler?
(this.$.Ma.Qub(this.handler),this.$.la.wma(198),this.handler=null):ma.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.la.wma(204);yk.a(li.a,19,this.$.la,198)}}Gt(){ma.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");const f=va.EwaSettings.Qp("AddinUICommandHandler"),G=f?128:2;ek.a(this.$).add(Object(Bi.a)(new Tk,{lre:()=>{const fa=(f?this.$.ea.jn:this.$.ea.XM)&&
this.$.ea.ki&&!!(this.$.Ij&16384)&&this.$.isEditMode;this.$.ea.ki&&ma.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${fa}] IsSessionFullyLoaded [${this.$.ea.XM}] IsSessionActive [${this.$.ea.ki}] ShowCommandUI [${!!(this.$.Ij&16384)}] IsEditMode [${this.$.isEditMode}] IsAppVisuallyReady [${this.$.ea.jn}]`);return fa},Jmd:this.rwh,JAd:this.Dbi,qPb:G}))}chk(f){const G=Object(Vh.d)(qa.a.resolve(da.uf,{va:this.xh}));return Qa.TaskExtensions.Xa(G,
()=>{ma.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.la.Hh(204,new Zf(G.result,f))},this.ya,3)}static Ba(f){Be.a.my(199,new Uk(f))}}Object(ja.a)(Uk,"AddinUICommandHandlerFactory",Be.a,[]);var fk=a(9),Hj=a(428),tl=a(1377),Vk=a(1378),gk=a(921);class zk extends Hj.a{constructor(f){super();this.$=f;this.gm()}create(){let f;if(va.EwaSettings.Ra(355)){const G=da.xb.Aa()?Object(Vh.d)(qa.a.resolve(da.xb,{va:this.xh})):
jd.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,this.xh),fa=Object(Vh.d)(qa.a.resolve(da.vd,{va:this.xh}));Qa.TaskExtensions.Xa(of.Task.tQ(G,fa),()=>{this.Bk(Object(gk.a)(this.$.la,278,()=>new tl.CustomFunctionsInstaller(this.$,G.result,fa.result)))},this.$.ya,3)}else f=Object(gk.a)(this.$.la,278,()=>new Vk.CustomFunctionsLegacyInstaller(this.$)),this.Bk(f)}static Ba(f){f.la.Hh(279,new zk(f))}}Object(ja.a)(zk,"CustomFunctionsInstallerFactory",Hj.a,[]);var Wk=a(60),yl=a(1406),hk=a(1405);class ik extends Hj.a{constructor(f){super();
this.hBg=this.ddaFacade=null;this.$=f;f.la.Hh(106,this);this.gm()}get Ai(){return this.ddaFacade||(this.ddaFacade=new mb.DdaFacade(this.$,this.hBg,this.xk,null))}create(){ma.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");ea.AFrameworkApplication.disableWholeAppsForOfficeFeature?ma.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${ea.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
va.EwaSettings.Ra(359)?Ab.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{const G=Ab.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");Promise.all([f.isFeatureEnabled("mso_officeStore",!0),G.AR("WACSideloadAddins")]).then(fa=>{var [Ya,Kb]=fa;mb.DdaFacade.VLb=Ya;mb.DdaFacade.JAe=Kb;this.olf();return null},fa=>{ma.ULS.sendTraceTag(508073758,0,10,`Unsable to fetch office store or add-in sideload enabled flag from OCPS: ${fa}.`);
return null})}):this.olf()}olf(){const f=Object(Vh.d)(qa.a.resolve(da.j,{va:this.xh})),G=Wk.a.n2d(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.ua.MaxRetriesForLoadingScript,this.$.ya,this.xh,106),fa=Ze.a(this.ya,this.xh),Ya=Object(Vh.d)(qa.a.resolve(da.xc,{va:this.xh}));Qa.TaskExtensions.Xa(Qa.TaskExtensions.Wo([f,G,fa,Ya],this.$.ya),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?ma.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Pj.a.jfa()}`):
this.Caj();ma.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.hBg=f.result;this.xk=Ya.result;this.Bk(this.Ai);ma.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ya,3)}Caj(){va.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new hk.a);this.$.uk.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new hk.a,new yl.a(ea.AFrameworkApplication.fa.appSettings.WebServiceBase),va.EwaSettings.Ra(70),
!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new hk.a);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new hk.a)}dispose(){Ua.a.dh(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static Ba(f){new ik(f)}}Object(ja.a)(ik,"DdaFacadeServiceFactory",Hj.a,[]);class jk extends Be.a{constructor(f){super(f)}Gt(){xd.a(this.$,374,375,this.xh,f=>{const G=[];da.h.Aa()||G.push(new za(this.$,f));da.jg.Aa()||G.push(new Ah(this.$,
f));this.Qr(G)})}static Ba(f){Be.a.my(76,new jk(f))}}Object(ja.a)(jk,"AgaveCommandHandlerFactory",Be.a,[]);var Xk=a(1454),rj=a(136);class jj{constructor(){this.Ai=null;this.fub=(f,G,fa,Ya,Kb)=>{if(2===fa){f=Kb?Kb:{};G=f.callback;fa=f.refresh?f.refresh:!1;if(!G)return 16;ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=f.storeType?this.Ai.Jyg(G,fa,f.storeType):this.Ai.ife(G,fa)}return 32};this.GTc=(f,G,fa,Ya,Kb)=>{if(2===fa){f=Kb?Kb:{};G=f.Observer;
if(!G)return ma.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(f)),16;if(!this.Ai||!this.Ai.cU)return ma.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(f)),16;this.Ai.cU.AAa(G)}return 32};this.hik=(f,G,fa,Ya,Kb)=>{2===fa&&(f=Kb?Kb.callback:null)&&this.Ai.OBh(f);return 32};this.Xdj=(f,G,fa,Ya,Kb)=>{2===fa&&this.Ai.opa(null,
OSF.AgaveHostAction.InsertAgave,Kb);return 32}}initialize(f){jj.initialized||(this.Ai=f,this.ho(),jj.initialized=!0)}ho(){ea.AFrameworkApplication.yh.Zk(lg.a.fub,rj.a.frame,this.fub,96);ea.AFrameworkApplication.yh.Zk(lg.a.GTc,rj.a.frame,this.GTc,96);ea.AFrameworkApplication.yh.Uh(lg.a.Sgk,rj.a.frame,this.hik);ea.AFrameworkApplication.yh.Zk(lg.a.HVf,rj.a.frame,this.Xdj,96)}static get instance(){jj.Va||(jj.Va=new jj);return jj.Va}}jj.Va=null;jj.initialized=!1;Object(ja.a)(jj,"AgaveCommandActor",null,
[]);var Ri=a(1521),Uj=a(366),Yk=a(367);a(1162);var Ij=a(1407),zl=a(395);class Ak{constructor(){this.swe=this.V0c=null;this.rwe=!1;this.pwe=null;this.NZ=0;this.U0c=null}}Object(ja.a)(Ak,"FirstPartyAddinTaskpaneOverrides",null,[]);class Vj{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(ja.a)(Vj,"IdeasSelectionContext",null,[]);class Zk extends Vj{constructor(){super();
this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(ja.a)(Zk,"IdeasTableSelectionContext",Vj,[]);class $k{constructor(f,G){this.selection=f;this.tables=G}}Object(ja.a)($k,"IdeasXLIMTableBoundaries",null,[]);var Jj=a(1118),aj=a(1560),ui=a(1260),Kj=a(154),al=a(427),Wj=a(190),ul=a(155);class bl extends yj.a{constructor(){super();this.X8="calc(100% - 46px)";this.aka="15px";this.Y8="0";this.XBb="WACDialogPanel";this.PN=695;this.YBb=462;this.JL=
"80%";this.IAb=350;this.rDa="100%";this.Ph=5;this.kl="AppsForOfficeInsertionDialog";this.F$c=!!ea.AFrameworkApplication.fa&&ea.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}nG(){var f;super.nG();this.Xo.style.width=this.rDa;this.Xo.style.height=this.X8;this.Xo.style.marginTop=this.aka;this.Xo.style.padding=this.Y8;if(null===(f=ea.AFrameworkApplication.fa)||void 0===f?0:f.isChangeGateEnabled("AddInDialogBugFix"))this.Z2.classList.add("AddInDialog"),this.Xo.classList.add("AddInDialog")}wAa(){this.Xo.style.width=
this.rDa;this.Xo.style.height=this.X8;this.Xo.style.marginTop=this.aka;this.Xo.style.padding=this.Y8;this.PN>Eh.a.Lba?(this.ph.style.width=String.format("{0}px",Eh.a.Lba),this.ph.style.overflowX="scroll",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0"):(this.ph.style.width=String.format("{0}px",this.PN),this.ph.style.overflowX="hidden");this.ph.offsetHeight>Eh.a.L1||this.YBb+50>Eh.a.L1?(this.ph.style.height=String.format("{0}px",Eh.a.L1),this.ph.style.overflowY="scroll",
this.ph.style.top="0",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0",this.F$c||(this.ph.style.marginTop="-48px"),this.Xo.style.minHeight=String.format("{0}px",this.IAb)):(this.ph.style.overflowY="hidden",this.ph.style.top="10%",this.ph.style.height=this.JL);this.Pla()}Pla(){if(this.ph){var f=this.ph.style.zIndex;this.ph.style.zIndex="-9999";if(this.PN>Eh.a.Lba)ea.AFrameworkApplication.isRtl?this.ph.style.marginRight="0":this.ph.style.marginLeft="0";else{const G=String.format("{0}px",
Math.floor(-this.ph.offsetWidth/2));ea.AFrameworkApplication.isRtl?this.ph.style.marginRight=G:this.ph.style.marginLeft=G;ea.AFrameworkApplication.isRtl?this.ph.style.right="50%":this.ph.style.left="50%"}this.ph.style.zIndex=String(f)}else ma.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}dT(){super.dT();const f=document.getElementById(this.hp(this.XBb));f.style.width=String.format("{0}px",this.PN);f.style.height=this.JL}get xma(){return this.Xo}}Object(ja.a)(bl,"AppsForOfficeInsertionDialog",
yj.a,[796]);class vl extends yj.a{constructor(f,G,fa){f=void 0===f?!0:f;G=void 0===G?!0:G;fa=void 0===fa?null:fa;super();this.X8="calc(100% - 46px)";this.aka="15px";this.Y8="0";this.XBb="WACDialogPanel";this.PN=695;this.YBb=462;this.JL="80%";this.IAb=350;this.rDa="100%";this.uKe=this.mKe=this.msa=null;this.GKe="auto";this.HKe="5px";this.IKe="auto";this.FKe="40px";this.eec="100px";this.ZBb="200px";this.Ph=5;this.kl="SDXDialog";this.cgc=f;this.oTb=G;this.aec=fa}nG(){super.nG();this.Xo.style.width=this.rDa;
this.Xo.style.height=this.X8;this.Xo.style.marginTop=this.aka;this.Xo.style.padding=this.Y8}wAa(){this.Xo.style.width=this.rDa;this.Xo.style.height=this.cgc?this.X8:"100%";this.Xo.style.marginTop=this.cgc?this.aka:"0px";this.Xo.style.padding=this.Y8;if(this.cgc){this.eec&&this.ZBb&&(this.PN=parseInt(this.ZBb.substring(0,this.ZBb.length-2)),this.JL=this.eec);this.PN>Eh.a.Lba?(this.ph.style.width=String.format("{0}px",Eh.a.Lba),this.ph.style.overflowX="scroll",ea.AFrameworkApplication.isRtl?this.ph.style.right=
"0":this.ph.style.left="0"):(this.ph.style.width=String.format("{0}px",this.PN),this.ph.style.overflowX="hidden");if(this.ph.offsetHeight>Eh.a.L1||this.YBb+50>Eh.a.L1)this.ph.style.height=String.format("{0}px",Eh.a.L1),this.ph.style.overflowY="scroll",this.ph.style.top="0",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0",this.Xo.style.minHeight=String.format("{0}px",this.IAb);else{this.ph.style.overflowY="hidden";const f="%"===this.JL.substring(this.JL.length-1,this.JL.length),
G=f?parseInt(this.JL.substring(0,this.JL.length-1)):parseInt(this.JL.substring(0,this.JL.length-2));this.ph.style.top=f?(100-G)/2+"%":100*(Eh.a.L1-G)/Eh.a.L1/2+"%";this.ph.style.height=this.JL}this.Pla()}else this.ph.style.left=this.GKe,this.ph.style.right=this.HKe,this.ph.style.top=this.IKe,this.ph.style.bottom=this.FKe,this.ph.style.width=this.ZBb,this.ph.style.height=this.eec,this.ph.style.overflowX="hidden",this.ph.style.overflowY="hidden"}Pla(){if(this.ph){var f=this.ph.style.zIndex;this.ph.style.zIndex=
"-9999";if(this.PN>Eh.a.Lba)ea.AFrameworkApplication.isRtl?this.ph.style.marginRight="0":this.ph.style.marginLeft="0";else{const G=String.format("{0}px",Math.floor(-this.ph.offsetWidth/2));ea.AFrameworkApplication.isRtl?this.ph.style.marginRight=G:this.ph.style.marginLeft=G;ea.AFrameworkApplication.isRtl?this.ph.style.right="50%":this.ph.style.left="50%"}this.ph.style.zIndex=String(f)}else ma.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}dT(){super.dT();const f=document.getElementById(this.hp(this.XBb));
f.style.width=String.format("{0}px",this.PN);f.style.height=this.JL}get dha(){return this.cgc}get xma(){return this.Xo}get instanceId(){return this.msa}set instanceId(f){this.msa=f}get vuc(){return this.mKe}set vuc(f){this.mKe=f}get Cuc(){return this.uKe}set Cuc(f){this.uKe=f}OCk(f,G,fa,Ya){this.GKe=f;this.HKe=G;this.IKe=fa;this.FKe=Ya}QCk(f,G){this.eec=f;this.ZBb=G}}Object(ja.a)(vl,"SDXDialog",yj.a,[]);var Si=a(1116),Lj=a(101),cl=a(269),kk;(function(f){f[f.Valid=2]="Valid";f[f.Invalid=4]="Invalid";
f[f.All=6]="All"})(kk||(kk={}));Object(ja.b)("MetadataState",kk);var dl=a(392),el=a(923),Al=a(1119);class hg extends ti.a{constructor(f,G,fa,Ya,Kb,sc,Tc){super();this.zPa={};this.mne={};this.cHd={};this.PNa=this.sdxDialog=this.Ona=null;this.BTg=this.Dhe=!1;this.cTk=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter",
"InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.eOc=()=>{this.PNa=null};this.jAk=fd=>{const ud=this;return Lo(function*(){yield ud.Zo.submitCustomMessage(Object.assign(new Jj.a,{message:new aj.a({authToken:fd})}))})};this.k3i=(fd,ud,Td,me,ne)=>{if(2!==Td)return 32;this.ZKc(ne);return 32};this.JYb=(fd,ud,Td,me,ne)=>{2===Td&&(this.nlf(),fd=ne.CommandValueId,ud=[],ud.push(ne.SourceControlId),
ud.push(fd),ud.push(null),this.Ai.J6f(this.Ona.xma,ud));return 32};this.ZKc=fd=>{var ud=fd[Si.a.mPb];fd=fd[Si.a.tpa];var Td=fd.Ak[yg.a.opf];const me=fd.Ak[yg.a.vpf],ne=fd.Ak[yg.a.dialogTitle],Me=fd.Ak[yg.a.dialogHeight],Df=fd.Ak[yg.a.dialogWidth],Gf=fd.Ak[yg.a.dialogLeft],Cf=fd.Ak[yg.a.upf],xf=fd.Ak[yg.a.dialogTop],cg=fd.Ak[yg.a.ipf];var Kg=fd.Ak.InstanceToken;Kg=null!=Kg?Kg:(new af.a(Db.a.create(),1)).toString();this.sdxDialog=new vl(Td,me);null!=Gf&&null!=Cf&&null!=xf&&null!=cg&&this.sdxDialog.OCk(Gf,
Cf,xf,cg);null!=Me&&null!=Df&&this.sdxDialog.QCk(Me,Df);this.sdxDialog.instanceId=Kg;this.sdxDialog.vuc=fd.Ak[yg.a.vuc];this.sdxDialog.Cuc=fd.Ak[yg.a.Cuc];this.sdxDialog.initializeAndShow(ne,null,null);Td={};Td.div=this.sdxDialog.xma;Td.id=Kg;Td.solutionId=ud.getId();Td.version=ud.HRa;Td.storeType=ud.getStoreType();Td.storeId=ud.getStoreId();Td.assetId=null;Td.assetStoreId=null;Td.settings=null!=fd.Zw?fd.Zw:{};Td.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Td.osfControlType=
OSF.OsfControlType.ContainerLevel;Td.sourceLocationOverrideResourceId=fd.Ak[yg.a.sourceLocationOverrideResourceId];Td.featureGates=ea.AFrameworkApplication.fa.NGf(ud.getId());Td.onExtensionLaunchCallback=fd.Ak[yg.a.onExtensionLaunchCallback];ud={};ud.InstanceId=Td.id;ud.WebExtensionType=2;ud.PrimaryMarketplace={};ud.PrimaryMarketplace.SolutionId=Td.solutionId;ud.PrimaryMarketplace.MarketplaceType=Td.storeType;ud.PrimaryMarketplace.MarketplaceRef=Td.storeId;ud.PrimaryMarketplace.SolutionVersion=Td.version;
ud.SrcLocationOverrideResourceId=Td.sourceLocationOverrideResourceId;ud.WebExtensionOsfControlType=6;ud.OnExtensionLaunchCallback=Td.onExtensionLaunchCallback;this.zPa[Td.solutionId]=Td.settings;const {DSc:fg,LPb:Tg}=this.PMc([],Td.solutionId);ud.OsfPropertyBag=fg;ud.HostPropertyBag=Tg;this.Ai.xXa(ud);this.Ai.Dl.insertOsfControl(Td)};this.W4i=(fd,ud,Td,me,ne)=>{if(2!==Td)return 32;const Me=ne[Si.a.mPb];var Df=ne[Si.a.cXa];const Gf=ne[Si.a.tpa];if(null!=Gf.Ak[yg.a.actionName])return this.ePf(fd,ud,
Td,me,ne);fd=new Ri.a;fd.fFc=Gf.Ak.InstanceToken;fd.Vs=Gf.Ak[yg.a.Vs];fd.oW=Gf.Ak[yg.a.oW];yg.a.taskPaneWidth in Gf.Ak&&(fd.taskPaneWidth=Gf.Ak[yg.a.taskPaneWidth]);fd.sourceLocationOverrideResourceId=Gf.Ak[yg.a.sourceLocationOverrideResourceId];fd.onTaskPaneClose=Gf.Ak[yg.a.onTaskPaneClose];fd.onExtensionLaunchCallback=Gf.Ak[yg.a.onExtensionLaunchCallback];fd.showLoadingSpinner=Gf.Ak[yg.a.showLoadingSpinner];fd.KH=Gf.Zw;fd.cXa=Df;Df=new sb.a(-859308420,0,2,0,"");ud=Me.getStoreType()===OSF.StoreType.Sdx;
Td=new ui.a;Td.vaa=Gf.Ak.HeaderCssClass||hc.a.bPb;Td.Ayb=Gf.Ak.TitleCssClass;this.h8(Df,Me.getId(),fd,ud,Td);return 32};this.x4i=(fd,ud,Td,me,ne)=>{if(2!==Td)return 32;fd=ne[Si.a.mPb].getId();ne=ne[Si.a.tpa].Ak[yg.a.sourceLocationOverrideResourceId];return fd?(this.Ai.Dl.refreshOsfControl(fd,ne),32):8};this.b8j=fd=>{fd=fd.Result;if(fd=null===fd?null:fd.SolutionId)this.Ai.g2e(fd),sd.a(this.$).YOa(3,fd)};this.Vvg=(fd,ud)=>{var Td;const me=(fd=fd.Result)?fd.AgaveData:null;if(me){var ne=Telemetry.PrivacyRules.GetPrivacyCompliantId(me.PrimaryMarketplace.SolutionId,
me.PrimaryMarketplace.MarketplaceType,null===(Td=null===me||void 0===me?void 0:me.AssetMarketplace)||void 0===Td?void 0:Td.SolutionId,null,null,me.PrimaryMarketplace.MarketplaceRef);ma.ULS.shipAssertTag(537170434,0,me.TaskpaneWidth===hg.nof,`Taskpane width is ${me.TaskpaneWidth}, assetId is ${ne}.`);if(Td=this.cHd[me.PrimaryMarketplace.SolutionId])Td.V0c&&(me.TaskpaneTitle=Td.V0c),Td.swe&&(me.TaskpaneTitleTag=Td.swe),Td.rwe&&(me.ShowResizeChatButton=Td.rwe),Td.U0c&&(me.TaskpaneIconId=Td.U0c),Td.pwe&&
(me.TaskpaneButtonTooltip=Td.pwe),0<Td.NZ&&(me.TaskpaneWidth=Td.NZ);ud&&(me.FocusOnIframeWhenLoaded=ud.focusOnIframeWhenLoaded,ud.width&&(me.TaskpaneWidth=ud.width),me.TaskpaneIconCssClass=ud.Sx,me.TaskpaneHeaderCssClass=ud.vaa,me.TaskpaneTitleCssClass=ud.Ayb,me.IsFirstPartyOptOutAppContextOptmization=ud.isFirstPartyOptOutAppContextOptmization,me.ShowLoadingSpinner=ud.showLoadingSpinner);if(this.zPa[me.PrimaryMarketplace.SolutionId]){const {DSc:Me,LPb:Df}=this.PMc(me.OsfPropertyBag,me.PrimaryMarketplace.SolutionId);
me.OsfPropertyBag=Me;me.HostPropertyBag=Df}Ud.a(me)||(me.WebExtensionOsfControlType=1);me.OnExtensionLaunchCallback=this.mne[me.PrimaryMarketplace.SolutionId];me&&(this.Ai.g2e(fd.SolutionId),this.Ai.xXa(me))}else ma.ULS.sendTraceTag(593285650,220,50,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.ePf=(fd,ud,Td,me,ne)=>{if(2!==Td)return 32;if(qb.a.Gm(ne))return 8;fd=ne[Si.a.Xhf];if(fd!==rd.a.action&&fd!==rd.a.taskpane)return 8;ud=ne[Si.a.tpa];return ud?
(fd=(fd=this.VRi(ne))?this.Ai.m5(fd):null)?(ne=this.Ai.L3h(ne[Si.a.cXa],ud.Ak[yg.a.Amd]),va.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Td=this.Ai.UX(fd),Td.TaskpaneTitle!==ud.Ak[yg.a.Vs]&&(Td.TaskpaneTitle=ud.Ak[yg.a.Vs],Td.TaskpaneIconCssClass=ud.Ak.IconCssClass,Td.TaskpaneIconUrl=ud.Ak.TaskPaneIconUrl,Td.TaskpaneIconId=ud.Ak.TaskPaneIconId,Td.OnExtensionLaunchCallback=ud.Ak[yg.a.onExtensionLaunchCallback],va.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(ud=this.Ai.Dl,ud.changeIframeTitle(fd,Td.TaskpaneTitle),Td=ud.getOsfControl(fd),ud.raiseOsfControlStatusChange(Td)):(ud=this.Ai.Dl.getOsfControl(fd),this.Ai.Dl.raiseOsfControlStatusChange(ud)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(fd,ne,this.z6b),32):8:8};this.z6b=(fd,ud)=>{this.Ai.Zwi(fd,ud)};this.KTc=()=>{void qa.a.resolve(da.ug,{va:1}).then(fd=>{fd.naa()})};this.$=f;this.viewBlockContainerHelpers=fa;this.Ai=G;this.Qn=Kb;this.nGh=sc;this.TLj=Tc;this.Qn.Uh(lg.a.HUg,
rj.a.frame,this.W4i);this.Qn.Uh(lg.a.KIg,rj.a.frame,this.x4i);this.Qn.Uh(lg.a.Pxf,rj.a.frame,this.ePf);this.Qn.Uh(lg.a.ZKc,rj.a.frame,this.k3i);this.Qn.Uh(lg.a.JYb,rj.a.frame,this.JYb);this.BTg=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Augloop.ShowChatPaneAfterSendToken",!1);this.$.ea.K3e(this.eOc)}LCh(f){this.addHandler(hg.bbe,f)}Amk(f){this.removeHandler(hg.bbe,f)}dispose(){Ua.a.dh(this.Ona);this.Ona=null;!va.EwaSettings.vl()&&this.Dhe&&(this.$.ea.yv(this.KTc),this.Dhe=!1);super.dispose()}jud(){this.Ona&&
this.Ona.hide()}iUk(f,G){var fa;if(f){this.raiseEvent(hg.bbe);const Ya=f.split("|");this.kAj(f,G,Ya);this.nlf();this.Ai.J6f(this.Ona.xma,Ya);window[hg.uFh]=null!==(fa=this.cTk.get(f))&&void 0!==fa?fa:"Unknown"}}nlf(){const f=G=>{0===G&&(this.Ai.opa("",OSF.AgaveHostAction.RefreshAddinCommands,{}),yc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.RefreshAddinsAfterClosingDialog"}))};this.Ona=new bl;this.Ona.initializeAndShow("",va.EwaSettings.isChangeGateEnabled("OfficeVSO:8619119_RefreshAddinsAfterClosingDialog")?
f:null,null)}gQd(f,G){var fa=Qa.TaskExtensions.Gq();if(-515602470===G.command||-167264441===G.command||-336193495===G.command||-1444574190===G.command)fa=this.Q2i(f,G);418618014===G.command&&(fa=new Ri.a,fa.Vs=Zd.a.instance.ia(1823),fa=this.h8(G,hg.f7i,fa,!0));if((G.tabName===this.$.xi+Te.a.uJg||G.tabName===Te.a.y7)&&2===G.ik||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),f[vb.a.Qi])||f[vb.a.Qi]===Te.a.EK)return this.APf(f,G);if(7===G.ik&&f.SourceControlId===
this.$.xi+Te.a.kKa)return f.MenuItemId=Te.a.oge,this.APf(f,G);1221897806===G.command&&(fa=this.lUg(G,"Format"));if(1930653487===G.command||1172793074===G.command)fa=this.lUg(G,"Data");-1753056834===G.command&&(fa=this.tPk(G));if(932597253===G.command){ma.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested");Lj.c(932597253,!0);fa=new Ri.a;fa.Vs=Zd.a.instance.ia(2163);fa.sourceLocationOverrideResourceId=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?hg.n8j:hg.p8j;fa.focusOnIframeWhenLoaded=!0;fa.taskPaneWidth=hg.DTf;var Ya={};Ya.LaunchSource=Object(xa.a)(String,f.SourceControlId);Ya.LaunchMode="Default";fa.KH=Ya;fa=this.h8(G,hg.o8j,fa,!0)}301511274===G.command&&(fa=this.IPk(G));if(515196233===G.command){fa=va.EwaSettings.isChangeGateEnabled("OfficeVSO:8093484_EnableCoauthCheckOnOptimize");if(Ya=qa.a.nh(da.te))Ya.Hga(),fa&&Ya.tdj();Ya=new Ri.a;Ya.Vs=Zd.a.instance.ia(2237);const Kb={};Kb.SourceUILocation=Uj.a[G.ik];Kb.TaskPaneVisualRefreshEnabled=
va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled",!1);fa&&(Kb.SessionID=this.$.ea.sessionId,Kb.EnableCoauthCheckOnOptimize=fa);Ya.KH=Kb;fa=new ui.a;fa.vaa=hc.a.bPb;fa=this.h8(G,hg.u2j,Ya,!0,fa,void 0,Ya.Vs)}1723441034===G.command&&(fa=new Ri.a,fa.Vs=Zd.a.instance.ia(2249),fa.focusOnIframeWhenLoaded=!0,fa.taskPaneWidth=hg.Dak,Ya=new ui.a,Ya.vaa=hc.a.ovf,fa=this.h8(G,cl.e,fa,!0,Ya));ea.AFrameworkApplication.dba(cl.a)&&f.LoadDataFromPictureTaskpane&&(fa=
{},Ya=new Ri.a,Ya.Vs=Zd.a.instance.ia(2276),fa.SessionID=f.SessionID,Ya.KH=fa,Ya.focusOnIframeWhenLoaded=!0,fa=this.h8(G,f.DataFromPictureAssetId,Ya,!0));762629271===G.command&&(this.w7i(),fa=Qa.TaskExtensions.Gq());-1997160483!==G.command&&1485761473!==G.command||!ya.a.$U()||(va.EwaSettings.isChangeGateEnabled("OfficeVSO:8777768_ColorFillEntryPointTrigger")&&"FillColor"===f.ParentMenuId&&(fa="ColorFill"+f.CommandValueId.replace(/(^\w|\s\w)/g,Kb=>Kb.toUpperCase()).replace(/\s+/g,""),Lj.b(fa)),fa=
this.T1i(f,G),ya.a.wVd()&&this.nGh.addListener());return fa}insertAgave(f,G){var fa=Qa.TaskExtensions.Gq();const Ya=this.$;var Kb=f[Dc.a.S9];const sc=f[vb.a.Wk];let Tc=null;ui.a.key in f&&(Tc=f[ui.a.key]);this.Ona&&this.Ona.hide();if(!sc||!Kb)return ma.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),fa;this.$.toa&&Te.a.hja in f&&(sc.EnabledInViewMode=f[Te.a.hja]);f=this.zHi(G.command);if(!sc.EnabledInViewMode&&!Ya.qy(null,!1,f))return fa;let fd=void 0===sc.IsToBePersisted||
null===sc.IsToBePersisted||sc.IsToBePersisted?0:16;if(1===sc.TargetType)fa=this.tej(sc,Kb,G,Tc,fd);else{Kb=ba.f(Ya);fa=this.viewBlockContainerHelpers.o$a(Kb);const ud=Ya.ea.isNamedObjectViewMode?Ya.ma.sheetName:Ya.ma.name;let Td,me,ne,Me;fa?(Kb=fa.fk,Td=Kb.yj.top,me=Kb.yj.left,ne=fa.rT.x,Me=fa.rT.y):(Td=me=1,fa=this.viewBlockContainerHelpers.gKa(Kb),ne=fa.x,Me=fa.y);const Df=this.$.pa.ta.Wh();fd|=64;fa=al.a(this.$.userOperationManager,(Gf,Cf,xf)=>{var cg=Ya.pa.ta,Kg=Td,fg=me,Tg=ne,Wh=Me;Gf=ce.c(Gf,
this.b8j);const lh=cg.$a(9,Df);lh.sharedInfo=sc;lh.sheetName=ud;lh.positionRow=Kg;lh.positionCol=fg;lh.positionOffsetX=Tg;lh.positionOffsetY=Wh;return oc.h(cg,"InsertWebExtension",lh,Gf,Cf,xf,null,0)},Gf=>new Dd.a(534,0,Gf,fd),G)}return fa}W0h(){var f=Ab.a.instance.fj("Common.App.ICustomerFeedbackUiWrapper"),G={};ea.AFrameworkApplication.fa.Nnd(G);f=f.instance.getContext(G);G={};"telemetryGroup"in f&&(G=f.telemetryGroup);G.processSessionId=f.sessionId;G.officeBuild=f.build;f.telemetryGroup=G;f.feedbackType=
-1;f.userVoiceEnabled=!1;"disableIncludeScreenshot"in f||(f.disableIncludeScreenshot=!1);"screenshot"in f||(f.screenshot=!1);f.disableScreenshotPreview=!1;f.includeScreenshotSelectedDefault=!0;return f}twg(f){if(!this.PNa){var G=this.iMd();G=this.Yaf(G);const fa=new ui.a;fa.Sx=hc.a.fPb;fa.vaa=hc.a.xvf;fa.Ayb=hc.a.HEd;this.PNa=this.JWc(G,null,!1,null,fa);ul.b(this.$).Aj(Kj.a.M8j,{["Location"]:f?Uj.a[f.ik]:0,["InputMethod"]:f?Yk.a[f.method]:0},void 0,!0)}}XOg(f){const G=this.$.ea.Vn.get(17);Ab.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fa=>
{fa.isFeatureEnabled("mso_sendASmile",G).then(Ya=>{f.FeedbackEnabled=G&&Ya;return null})})}gmj(){return this.Ai.Xrj(this.Ai.eJa(hg.c0a,this.iMd()))}onPaneClosed(f){var G;switch(f){case hg.dsc:null===(G=this.Zo)||void 0===G?void 0:G.unregister("Copilot")}}lUg(f,G){const fa=ba.f(this.$),Ya=new Ri.a;var Kb={};Kb.ActiveTab=G;Kb.IsRTL=this.$.isChromeRtl;Kb.DatapaneFlighting=!0;Kb.MergeIvyBiDataSources=!0;Kb.ComboChartUIInXLO=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",
!1);Kb.ThemeColorsFlighting=!0;Kb.FormatTaskPaneUXImprovePhase2=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);Kb.ChartTPNewFontAndColorTheme=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);Kb.UOMirrorTaskPaneRefactor=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirrorTaskPaneRefactor",!1);Kb.DataPaneAddNewField=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataPaneAddNewField",
!1);Kb.LineFormatTaskPane=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSLineFormatTaskPane",!1);Kb.ChartTaskPaneNewTheme=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneNewTheme",!1);Kb.SnowballChartImprovement=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1);this.XOg(Kb);Kb.startTimeMs=Date.now();Kb.UserSessionId=this.$.ua.UserSessionId;(G=fa.ha.$e.Kp)&&(Kb.SubSelection=G);ma.ULS.sendTraceTag(592524688,
0,50,`Chart task pane launched. UserSessionId: ${Kb.UserSessionId}, UILocation: ${void 0===f.ik||null===f.ik?"Null":Uj.a[f.ik]}, SubSelection: ${G||"ChartRoot"}`);Ya.KH=Kb;Ya.Vs=Zd.a.instance.ia(984);Kb=new ui.a;Kb.vaa=hc.a.bPb;return this.h8(f,hg.IVh,Ya,!0,Kb)}tPk(f){const G=new Ri.a;G.KH={};G.Vs=Zd.a.instance.ia(1809);G.oW=hg.l7f;const fa=new ui.a;fa.vaa=hc.a.bPb;return this.h8(f,hg.l7f,G,!0,fa,void 0,G.Vs)}IPk(f){const G=new Ri.a;G.KH={};G.Vs=Zd.a.instance.ia(2187);const fa=new ui.a;fa.vaa=hc.a.gpi;
fa.Ayb=hc.a.Avf;const Ya=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",!1);return this.h8(f,hg.pJj,G,!0,fa,Ya)}APf(f,G){const fa=hg.i7i;var Ya=f[vb.a.Qi].toString();const Kb={},sc=new Ri.a;sc.Vs=Zd.a.instance.ia(9);switch(Ya){case "A0":Kb.query=(f[vb.a.Wk]||"").split("|").slice(2,zl.a.K8).join("|");break;case "A1":Kb.query=f.CommandValueId;break;case "Help":Kb.query="";sc.oW="HelpTaskPane";break;case Te.a.oge:sc.Vs=Zd.a.instance.ia(1775);sc.sourceLocationOverrideResourceId=
hg.sPd;Kb.feedback=this.W0h();break;case "HelpArticle":Kb.query=f[vb.a.Wk];break;case "Tutorials":Kb.query=f.CommandValueId;break;case "ContactSupport":Kb.query=Ya;sc.sourceLocationOverrideResourceId=hg.d1h;sc.Vs=Zd.a.instance.ia(2389);sc.oW="ContactSupportTaskPane";break;case "ShowTraining":case "WhatsNew":Kb.query=Ya;break;default:return of.Task.Ua(!0)}sc.KH=Kb;Ya=new ui.a;Ya.vaa=hc.a.bPb;f=f[Te.a.hja]||!1;return this.h8(G,fa,sc,va.EwaSettings.isChangeGateEnabled("OfficeVSO:8469439_UseSdxActivationFlow"),
Ya,f)}Yaf(f){const G={};G.SolutionId=hg.c0a;G.Version="0.0.0.0";G.StoreType=OSF.StoreType.Sdx;G.StoreId=OSF.StoreType.Sdx;G.AssetId=null;G.AssetStoreId=null;G.Height=0;G.Width=0;G.TargetType=OSF.OsfControlTarget.TaskPane;G.IsToBePersisted=!1;G.SourceLocationOverrideResourceId=f;G.SharedRuntimeId=f;return G}Q2i(f,G){const fa=new Ri.a,Ya=new ui.a,Kb={};this.PNa&&this.XOg(Kb);Kb.LaunchSource="";Kb.StartTimeMs=Date.now();Kb.CorrelationId=Db.a.create().toString();fa.KH=Kb;fa.focusOnIframeWhenLoaded=!0;
fa.taskPaneWidth=hg.DTf;Ya.vaa=hc.a.xvf;Ya.Ayb=hc.a.HEd;switch(G.command){case -1444574190:let sc,Tc,fd;Kb.LaunchMode="RecommendedPivotTables";Kb.SelectionContext="";Kb.LaunchSource="PivotTableHandRaise"===Object(xa.a)(String,f.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&va.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&f.SourceSelection){const ud=f.SourceSelection.split(",")[0],Td=va.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?
-1:0;if((()=>{let me=Nb.jb(ud,this.$.sa);({sheetName:sc,jAg:Tc,range:fd}=me);return me})().returnValue&&!ba.f(this.$).oh.vY(fd))f=this.$.sa.getItemByName(sc),Kb.SelectionContext=JSON.stringify(Object(Bi.a)(new Vj,{address:Tc,addressWithSheet:sc+"!"+fd.FE(!1),sheetId:ra.d(f),sheetName:sc,isSheetEmpty:!1,columnCount:fd.width,rowCount:fd.height,columnIndex:fd.left+Td,rowIndex:fd.top+Td,selectionType:"Continuous"}));else if((f=this.$.Yh.getItemByName(Object(xa.a)(String,f.SourceSelection)))&&ra.m(f)){fd=
Wj.a(f,!0);const me=this.$.sa.getItemByName(f.sheetName);Kb.SelectionContext=JSON.stringify(Object(Bi.a)(new Zk,{tableName:f.name,hasTableHeaders:Wj.d(f),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:fd.FE(!1),addressWithSheet:me.name+"!"+fd.FE(!1),sheetId:ra.d(me),sheetName:me.name,isSheetEmpty:!1,columnCount:fd.width,rowCount:fd.height,columnIndex:fd.left+Td,rowIndex:fd.top+Td,selectionType:"Continuous"}))}}fa.Vs=Zd.a.instance.ia(1821);fa.oW=hg.l6j;fa.Sx=hc.a.qxf;Ya.Sx=hc.a.qxf;break;
case -336193495:Kb.LaunchMode="RecommendedCharts";fa.Vs=Zd.a.instance.ia(1820);fa.oW=hg.nfk;fa.Sx=hc.a.rxf;Ya.Sx=hc.a.rxf;break;case -167264441:Kb.LaunchMode="ExcelIntelligence";Kb.TableName=f.tableName;fa.Vs=Zd.a.instance.ia(2287);fa.oW=hg.B6e;fa.Sx=hc.a.fPb;Ya.Sx=hc.a.fPb;break;default:Kb.LaunchMode="Default",fa.Vs=Zd.a.instance.ia(1822),fa.oW=hg.B6e,fa.Sx=hc.a.fPb,Ya.Sx=hc.a.fPb}fa.sourceLocationOverrideResourceId=this.iMd();return this.PNa?this.PNa.kB(()=>this.$yk(Kb,fa)):this.ncj(G,fa,Ya,Kb)}w7i(){const f=
this.Ai.m5(hg.dsc);if(f){const G=this.NXk(f);ya.a.Rt()?void qa.a.resolve(da["if"],{va:0}).then(fa=>fa.hideTaskPane(G)):void Nf.a.ep().then(fa=>{fa.hideTaskPane(G,2);return null})}}NXk(f){return hg.OXk+f.replace(/[{}]/g,"")}wRi(){const f=qa.a.nh(da.pe),G=gd.c()&&appChrome.api.isCachedControlVisible(Te.a.J5a);return void 0!==f?f.lXb:G}TOi(){const f=new Ri.a;f.Vs=appChrome.getCopilotString();let G=!1;va.EwaSettings.isChangeGateEnabled("OfficeVSO:8583475_CheckAccountTypeForPreviewTag")&&(G="msa"===ea.AFrameworkApplication.fa.Za("HostAuthType").toLowerCase());
(G?va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitleConsumer",!1):va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitle",!1))||(f.w_g=appChrome.getPreviewTaskPaneHeaderTagString());va.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&(f.oW=hg.e3h);f.focusOnIframeWhenLoaded=!0;f.taskPaneWidth=hg.nof;return f}UOi(){const f={};f.AudienceGroup=ea.AFrameworkApplication.hi.AudienceGroup;f.StartTimeMs=Date.now();
va.EwaSettings.isChangeGateEnabled("OfficeVSO:8337949_sendAnnotationsToCopilotOnOpen")&&va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FA000000124.TabularRangeSupportForCopilot",!1)&&(f.TableBoundaries=this.UXi());f.HandoffMessageId=this.$.ua.HandoffMessageId;const G=va.EwaSettings.getBooleanFeatureGate(el.a.u4,!1),fa=va.EwaSettings.getBooleanFeatureGate(el.a.gva,!1);f.CopilotSaveAutomation=G&&this.wRi();f.CopilotSaveRegularScript=fa;return f}T1i(f,G){const fa=this.TOi();var Ya=this.UOi();
va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&f.MenuItemId&&(Ya.CopilotStartQuery=JSON.stringify(f.MenuItemId));f=Al.a.xIf(this.$,!0,"Copilot",{});const Kb={};Kb.devProperties=f.Zw;Kb.optionalProperties=f.Ak;Ya.LaunchOfficeScriptsSDXOptionalProperties=JSON.stringify(Kb);fa.KH=Ya;const sc=new ui.a;sc.vaa=hc.a.ovf;const Tc=ud=>{ud.register(ud.v5().b8("Copilot").a8(()=>{ma.ULS.sendTraceTag(508347875,0,15,"Copilot AugLoop host received close message")}).activateAnnotation({annotationType:"FakeCopilotAnnotation",
Jy:!1,pkj:!0}).build())},fd=()=>this.BTg?Object(Vh.d)(Object(Ij.a)(this.TLj).then(this.jAk.bind(this)).catch(ud=>{ma.ULS.sendTraceTag(507562076,0,10,`[Copilot Chat] Failed to get and send token. ${ud}`)}).then(()=>Object(Vh.a)(this.h8(G,hg.dsc,fa,!0,sc)))):this.h8(G,hg.dsc,fa,!0,sc);if(this.Zo)return Tc(this.Zo),fd();Ya=qa.a.resolve(da.p,{va:1});return Object(Vh.d)(Ya.then(ud=>{this.Zo=ud;Tc(this.Zo);ma.ULS.sendTraceTag(508347904,0,15,"Copilot proxy created IAugmentationLoopManager manager");return Object(Vh.a)(fd())}))}ncj(f,
G,fa,Ya){this.PNa=this.JWc(this.Yaf(G.sourceLocationOverrideResourceId),G,!1,f,fa,!1);Ya.NoActionMsgOnFirstInstance=!0;this.zPa[hg.c0a]=Ya;return this.PNa}$yk(f,G){const fa=this.Ai.m5(this.Ai.eJa(hg.c0a,G.sourceLocationOverrideResourceId));if(fa){this.zPa[hg.c0a]=f;const {DSc:Ya,LPb:Kb}=this.PMc(this.Ai.UX(fa).OsfPropertyBag,hg.c0a);this.Ai.UX(fa).OsfPropertyBag=Ya;this.Ai.UX(fa).HostPropertyBag=Kb}this.Yya(hg.c0a,rd.a.taskpane,"LaunchIdeasAction",f,"1.0.0.0",G);return of.Task.Ua(!0)}iMd(){switch(ea.AFrameworkApplication.fa.Za("SovereignEnvironmentName")){case "USGov":return"Insights.Https.GCC.Bundle";
case "Pathfinder":return"Insights.Https.DOD.Bundle";case "Trailblazer":return"Insights.Https.GCCH.Bundle"}const f=ea.AFrameworkApplication.hi.AudienceGroup;if(va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(f){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(f){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}h8(f,G,fa,Ya,Kb,sc,Tc){fa=void 0===
fa?null:fa;Ya=void 0===Ya?!1:Ya;Kb=void 0===Kb?null:Kb;sc=void 0===sc?!1:sc;Tc=void 0===Tc?null:Tc;Qa.TaskExtensions.Gq();fa||(fa=new Ri.a);const fd={};fd.SolutionId=G;fd.Version="0.0.0.0";fd.StoreType=Ya?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;fd.StoreId=Ya?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;fd.AssetId=null;fd.AssetStoreId=null;fd.Height=0;fd.Width=0;fd.TargetType=OSF.OsfControlTarget.TaskPane;fd.IsToBePersisted=!1;fd.SourceLocationOverrideResourceId=fa.sourceLocationOverrideResourceId;
if(fa.Vs||Tc)this.cHd[G]=Object(Bi.a)(new Ak,{V0c:fa.Vs,swe:fa.w_g,rwe:fa.showResizeChatButton,pwe:Tc,U0c:fa.oW});fa.KH||(fa.KH={});fa.KH.ShowFeedback=this.$.isFeedbackEnabled;this.zPa[G]=fa.KH;this.mne[G]=fa.onExtensionLaunchCallback;G={};G[vb.a.Wk]=fd;Tc={};Tc.solutionId=fd.SolutionId;Tc.version=fd.Version;Tc.storeType=fd.StoreType;Tc.storeId=fd.StoreId;Tc.assetId=fd.AssetId;Tc.assetStoreId=fd.AssetStoreId;Tc.height=fd.Height;Tc.targetType=fd.TargetType;Tc.width=fd.Width;Tc.isAddinCommands=!Ya;
G[Dc.a.S9]=Tc;Kb||(Kb=new ui.a);Kb.focusOnIframeWhenLoaded=fa.focusOnIframeWhenLoaded;Kb.width=fa.taskPaneWidth;Kb.showLoadingSpinner=fa.showLoadingSpinner;G[ui.a.key]=Kb;G[Te.a.hja]=sc;return this.insertAgave(G,f)}tej(f,G,fa,Ya,Kb){const sc=(Td,me)=>{var ne=Td.SolutionId;const Me=OSF.OsfControl.isFirstPartyStoreString(Td.StoreType);Me&&Td.SourceLocationOverrideResourceId&&(ne=this.Ai.eJa(ne,Td.SourceLocationOverrideResourceId));var Df=this.Ai.Hef(ne,null,Td.SharedRuntimeId);if(Me){if(Df&&(ne=this.Ai.m5(ne))){const {DSc:Gf,
LPb:Cf}=this.PMc(this.Ai.UX(ne).OsfPropertyBag,Td.SolutionId);if(ne=this.Ai.Dl.getOsfControl(ne))ne.setSettings(Gf),ne.setHostSettings(Cf)}Td.SharedRuntimeId&&Df||this.Ai.Dl.refreshOsfControl(Td.SolutionId,Td.SourceLocationOverrideResourceId)}if(!Df){const Gf=this.$.pa.ta.Wh();let Cf=519;Df=(xf,cg,Kg)=>{var fg=this.$.pa.ta;xf=ce.c(xf,this.Vvg);const Tg=fg.$a(9,Gf);Tg.sharedInfo=Td;return oc.h(fg,"InsertAgaveTaskpane",Tg,xf,cg,Kg,Ya,0)};void 0===Td.IsToBePersisted||null===Td.IsToBePersisted||Td.IsToBePersisted||
(Cf=538,Df=(xf,cg,Kg)=>{var fg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.SolutionId,Td.StoreType,Td.AssetId,null,null,Td.StoreId);ma.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Td.StoreType}, StoreId ${Td.StoreId}, SolutionId ${fg}.`);fg=this.$.pa.ta;xf=ce.c(xf,this.Vvg);const Tg=fg.$a(9,void 0===Gf?null:Gf);Tg.sharedInfo=Td;return oc.h(fg,"ShowAgaveTaskpane",Tg,xf,cg,Kg,Ya,0)});Kb|=64;return al.a(this.$.userOperationManager,Df,xf=>new Dd.a(Cf,0,xf,
Kb),me)}return Qa.TaskExtensions.oaa()},Tc=Td=>{var me=Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.solutionId,Td.storeType,Td.assetId,null,null,Td.storeId);ma.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${me} from ${Td.storeType}.`);me={};const ne=[];ne.push(Td);me[Dc.a.hIb]=ne;me[Dc.a.U3]=3;Td=new sb.a(lg.a.aqb,0,this.$.ii,0,null);return this.$.Ma.qh(Td,me)};if(!va.EwaSettings.Ra(52)||f.StoreId===OSF.StoreType.FirstParty)return sc(f,fa,Ya);if(G.isAddinCommands)return Tc(G);const fd=
new le.a,ud={};ud.solutionId=f.SolutionId;ud.version=f.Version;ud.storeType=f.StoreType;ud.storeId=f.StoreId;ud.targetData=f;this.Ai.Dl.isAddinCommandsAsync(ud,(Td,me,ne)=>{fd.setResult(me);Td||(Td=ne.targetData,me=Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.SolutionId,Td.StoreType,Td.AssetId,null,null,Td.StoreId),ma.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${me} from ${Td.StoreType} during addin inserting`))});return Qa.TaskExtensions.ts(fd.task,Td=>Td.result?Tc(G):
sc(f,fa,Ya),this.$.ya)}PMc(f,G){if(!this.zPa[G])return{ltl:f,LPb:null};const fa={},Ya={};if(f)for(var Kb of f){const [Tc,fd]=Kb;fa[Tc]=fd}f=this.zPa[G];for(var sc of Object.keys(f))Kb=f[sc],sc===hg.Cui?fa[sc]=Ya[sc]=Sys.Serialization.JavaScriptSerializer.serialize(Kb):(!va.EwaSettings.isChangeGateEnabled("OfficeVSO:8380805_LogsToInvestigateMergeFirstPartySettingsCrash_2")||null!==Kb&&void 0!==Kb||ma.ULS.sendTraceTag(508072652,220,15,"AgaveCommandHandler.mergeFirstPartySettings: value is null or undefined. firstPartySolutionId: "+
G+". key: "+sc+". value is null: "+(null===Kb)),fa[sc]=Ya[sc]=Sys.Serialization.JavaScriptSerializer.serialize(Kb.toString()));G=Object.keys(fa).map(Tc=>[Tc,fa[Tc].toString()]);sc=Object.keys(Ya).map(Tc=>[Tc,Ya[Tc].toString()]);return{DSc:G,LPb:sc}}kAj(f,G,fa){const Ya=this.$.ua.UserSessionId,Kb=this.$.ua.UICultureTag,sc=this.$.ua.UICultureTagLcid,Tc=this.$.ua.WacHostId;let fd="",ud="";5<=fa.length&&(fd=fa[3],ud=fa[4]);this.lAj(fd,ud,f,G,Kb,sc,Ya,Tc)}lAj(f,G,fa,Ya,Kb,sc,Tc,fd){const ud={};ud.a=Tc;
ud.b=fa;ud.c=Ya;ud.d=f;ud.e=G;ud.f=Kb;ud.g=sc;ud.h=fd;Ie.b().Ll(36,ud)}JWc(f,G,fa,Ya,Kb,sc){G=void 0===G?null:G;fa=void 0===fa?!1:fa;Ya=void 0===Ya?null:Ya;Kb=void 0===Kb?null:Kb;sc=void 0===sc?!0:sc;var Tc=f.SolutionId,fd=of.Task.Ua(!1);f&&Tc&&f.SharedRuntimeId&&(Ya=Ya||new sb.a(-859308420,0,2,0,""),Tc={},Tc.solutionId=f.SolutionId,Tc.version=f.Version,Tc.storeType=f.StoreType,Tc.storeId=f.StoreId,Tc.assetId=f.AssetId,Tc.assetStoreId=f.AssetStoreId,Tc.height=f.Height,Tc.targetType=f.TargetType,Tc.width=
0,Tc.isAddinCommands=!1,Tc.sharedRuntimeId=f.SharedRuntimeId,f.Preload=sc,Kb=Kb?Kb:new ui.a,Kb.width=0,G&&(sc=G,Kb.focusOnIframeWhenLoaded=sc.focusOnIframeWhenLoaded,fd=new Ak,sc.Vs&&(fd.V0c=sc.Vs),0<sc.taskPaneWidth&&(fd.NZ=sc.taskPaneWidth),sc.oW&&(fd.U0c=sc.oW),va.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&sc.KH&&(this.zPa[f.SolutionId]=G.KH),this.cHd[f.SolutionId]=fd,this.mne[f.SolutionId]=G.onExtensionLaunchCallback),G={},G[vb.a.Wk]=f,G[Dc.a.S9]=Tc,G[ui.a.key]=
Kb,G[Te.a.hja]=fa,fd=this.insertAgave(G,Ya));return fd}Yya(f,G,fa,Ya,Kb,sc){sc=void 0===sc?null:sc;if(f&&fa){f=new Hc.a(f,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Kb);Kb=new ve.a("ExcelOnline","Web",this.$.ua.UICultureTag);const Tc=new ed.a;Tc.Ak[yg.a.Amd]=Ya;sc&&(Ya=sc,Ya.sourceLocationOverrideResourceId&&(Tc.Ak[yg.a.sourceLocationOverrideResourceId]=Ya.sourceLocationOverrideResourceId),Ya.Vs&&(Tc.Ak[yg.a.Vs]=Ya.Vs),Ya.Sx&&(Tc.Ak.IconCssClass=Ya.Sx),Ya.mwe&&(Tc.Ak.TaskPaneIconUrl=Ya.mwe),Ya.oW&&(Tc.Ak.TaskPaneIconId=
Ya.oW),Ya.onExtensionLaunchCallback&&(Tc.Ak[yg.a.onExtensionLaunchCallback]=Ya.onExtensionLaunchCallback));fa&&(Tc.Ak[yg.a.actionName]=fa);zc.a.instance.Yya(f,G,fa,Kb,Tc)}}VRi(f){if(!qb.a.Gm(f)){var G=f[Si.a.mPb];if(G&&(G=G.getId(),f=f[Si.a.tpa],G&&f))return this.eJa(G,f.Ak[yg.a.sourceLocationOverrideResourceId])}return null}eJa(f,G){G=void 0===G?null:G;return f&&G?`${f}.${G}`:f}zHi(f){switch(f){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:return 1;case 1723441034:return 1023;
case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}i2g(){this.$.ea.lm?this.KTc():va.EwaSettings.vl()?this.$.ea.Yq(this.KTc):(this.$.ea.jr(this.KTc),this.Dhe=!0)}UXi(){var f=qa.a.nh(da.ug);if(!f)return this.i2g(),"";f=f.naa();if(!f)return this.i2g(),"";var G=this.$.sa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.ma.sheetName:this.$.ma.name);G=ra.d(G);var fa=ba.f(this.$).ha.qa.selectedRanges;const Ya=[];for(const sc of fa){fa=new dl.a(sc,G);var Kb=
f.YJa(fa,kk.Valid);fa=[];if(Kb)for(const Tc of Kb)(Kb=Tc.table.analyzedRange)&&(Kb=Kb.range.toString())&&fa.push(Kb);fa=new $k(sc.toString(),fa);Ya.push(fa)}return JSON.stringify(Ya)}}hg.bbe="IDS";hg.i7i="FA000000012";hg.c0a="FA000000005";hg.f7i="HelloWorld";hg.IVh="FA000000014";hg.sPd="Help.GiveFeedback.Url";hg.d1h="Help.ContactSupport.Url";hg.Cui="feedback";hg.l7f="FA000000066";hg.p8j="PowerBi.Url";hg.n8j="PowerBi.DevUrl";hg.o8j="FA000000054";hg.pJj="FA000000064";hg.u2j="FA000000075";hg.B6e="AnalyzeDataTaskPane";
hg.nfk="RecommendedChartsTaskPane";hg.l6j="PivotTableTaskPane";hg.DTf=320;hg.Dak=320;hg.e3h="CopilotSDXTaskpane";hg.dsc="FA000000124";hg.nof=350;hg.OXk="AgaveTaskPane-";hg.uFh="g_InstallOrigin";Object(ja.a)(hg,"AgaveCommandManager",ti.a,[886,887]);class lk extends Hj.a{constructor(f){super();this.$=f;this.gm()}create(){const f=this.$.la,G=da.xb.Aa()?Object(Vh.d)(qa.a.resolve(da.xb,{va:this.xh})):jd.GetServiceTaskFactory.create(f,106,this.ya,this.xh),fa=jd.GetServiceTaskFactory.create(f,104,this.ya,
this.xh),Ya=Object(Vh.d)(qa.a.resolve(da.i));Qa.TaskExtensions.Xa(Qa.TaskExtensions.Wo([fa,G,Ya],this.ya),()=>{let Kb=null;Kb=Ab.a.instance.fj("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance;jj.instance.initialize(G.result);const sc=va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(gk.a)(this.$.la,374,()=>new hg(this.$,G.result,fa.result,Kb,ea.AFrameworkApplication.yh,Ya.result,Ab.a.instance.fj("Common.App.OAuth.IOAuthManager"))):
new hg(this.$,G.result,fa.result,Kb,ea.AFrameworkApplication.yh,Ya.result,Ab.a.instance.fj("Common.App.OAuth.IOAuthManager"));f.Hh(206,sc);this.Bk(f.lh(374)||f.Hh(374,sc))},this.ya,3);Ab.a.instance.register(Xk.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").yi().Ei(()=>new Xk.a(this.$.pK))}static Ba(f){f.la.Hh(375,new lk(f))}}Object(ja.a)(lk,"AgaveCommandManagerFactory",Hj.a,[]);class I extends Be.a{constructor(f){super(f)}Gt(){const f=da.xb.Aa()?Object(Vh.d)(qa.a.resolve(da.xb,{va:this.xh})):
jd.GetServiceTaskFactory.create(this.$.la,106,this.ya,this.xh),G=Object(Vh.d)(qa.a.resolve(da.ee,{va:this.xh})),fa=Ze.a(this.ya,this.xh),Ya=Object(Vh.d)(qa.a.resolve(da.pd,{va:this.xh})),Kb=da.Wb.Aa()?Object(Vh.d)(qa.a.resolve(da.Wb,{va:this.xh})):of.Task.Ua(null);Qa.TaskExtensions.Xa(Qa.TaskExtensions.Wo([f,G,fa,Ya,Kb],this.ya),()=>{const Tc=f.result,fd=Ab.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Qr([new lf(this.$,Tc,fd,Ya.result,Kb.result)])},this.ya,
3);const sc=Ab.a.instance;da.nd.Aa()?void qa.a.resolve(da.nd,{va:this.xh}).then(()=>{Ab.a.instance.register(sf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").yi().Ei(()=>new sf)}):Qa.TaskExtensions.Xa(jd.GetServiceTaskFactory.create(this.$.la,137,this.$.ya,this.xh),()=>{sc.register(sf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").yi().Ei(()=>new sf)},this.$.ya)}static Ba(f){Be.a.my(82,new I(f))}}Object(ja.a)(I,"DdaCommandHandlerFactory",
Be.a,[]);va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1111);(()=>{fk.a.gh(f=>{va.EwaSettings.Ra(52)&&Uk.Ba(f)})})();(()=>{fk.a.gh(f=>{va.EwaSettings.Ra(114)&&zk.Ba(f)})})();(()=>{fk.a.gh(f=>{da.xb.Aa()||ik.Ba(f)})})();(()=>{fk.a.gh(f=>{da.h.Aa()&&da.jg.Aa()||jk.Ba(f);lk.Ba(f)})})();(()=>{fk.a.gh(f=>{I.Ba(f)})})();String(C);String(L);String(V);String(mb);String(X);String(la);String(Va);String(na);String(qi);window.___1710439927496_closurehack=C;window.___1710439927496_closurehack=
L;window.___1710439927496_closurehack=V;window.___1710439927496_closurehack=mb;window.___1710439927496_closurehack=X;window.___1710439927496_closurehack=la;window.___1710439927496_closurehack=Va;window.___1710439927496_closurehack=na;window.___1710439927496_closurehack=qi},939:function(z,t,a){a.r(t);a.d(t,"DdaFacade",function(){return Nd});var c=a(0),b=a(2),h=a(15),r=a(1574),e=a(113);class k{constructor(wa,wb,zc){this._id=wa;this.Vgh=wb;this.ajh=zc;this.uWf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get vFh(){return this.Vgh}get CZh(){return this.ajh}execute(wa,
wb,zc){zc=zc||{};zc.commandMode=this.uWf;wb.invokeAppCommand(this.vFh,this.CZh,zc,()=>{wa.AWj(this.id)})}}Object(c.a)(k,"AddinNativeActionBase",null,[877]);class m extends k{constructor(wa,wb){super(1,wa,wb);this.uWf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(m,"AddinTakeSnapshotAction",k,[]);class x{Q3h(wa){return new k(3,wa,this.TDi().getNativeActionName(3))}TDi(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(x,"AddinNativeActionManager",null,[844]);var n=
a(240);class u{invokeAppCommand(wa,wb,zc,Hc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(wa,wb,zc,Hc)}static getInstance(){u.Va||(u.Va=new u);return u.Va}}u.Va=null;Object(c.a)(u,"OSFAddinCommandsRuntimeManager",null,[845]);var v=a(6),w=a(247),l=a(35);class y extends n.a{constructor(wa,wb,zc){super();this.Wka=null;this.qld="WACDialogTitleText";this.Y8="0";this.aka="15px";this.ujh="0px";this.X8="calc(100% - 30px)";this.tjh="100%";this.dWe=0;this.hh=new e.a;this.Xgh=new x;this.Ph=5;this.kl=
this.nSa=zc;this.k$c=wa;this.nKe=wb;this.F$c=!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}zDh(wa){this.hh.addHandler("OnDialogClosedEventKey",wa)}TEk(){this.qTa=null}nG(){super.nG();this.Xo.style.width="100%";this.Xo.style.height=this.oTb?this.X8:this.tjh;this.Xo.style.marginTop=this.oTb?this.aka:this.ujh;this.Xo.style.padding=this.Y8}dT(){super.dT();this.ph.style.width=String.format("{0}px",this.k$c*window.innerWidth/100);this.ph.style.height=
String.format("{0}px",this.nKe*window.innerHeight/100);this.ph.style.minWidth="0px";this.F$c&&v.AFrameworkApplication.isRtl&&100===this.k$c&&(this.ph.style.right="0px",this.ph.style.marginRight="0px");this.Wka=document.getElementById(this.hp(this.qld));this.Wka.style.position="absolute";this.Wka.style.whiteSpace="nowrap";this.Wka.style.textOverflow="ellipsis";v.AFrameworkApplication.isRtl?(this.Wka.style.right="14px",this.Wka.style.left="44px"):(this.Wka.style.right="44px",this.Wka.style.left="14px")}pL(wa){super.pL(wa);
this.Wka&&this.Wka.setAttribute("title",wa)}get xma(){return this.Xo}ble(){this.ph.style.width=String.format("{0}px",this.k$c*window.innerWidth/100);this.ph.style.height=String.format("{0}px",this.nKe*window.innerHeight/100);this.ph.style.overflowY="hidden";this.ph.style.overflowX="hidden";this.ph.style.marginTop="";this.ph.style.top="";l.a.Raa&&v.AFrameworkApplication.isRtl?(this.ph.style.right="",this.ph.style.marginRight=""):(this.ph.style.left="",this.ph.style.marginLeft="")}hide(){this.Xgh.Q3h(this.nSa).execute(this,
u.getInstance(),{});this.dWe=window.setTimeout(()=>{this.hh.raiseEvent("OnDialogClosedEventKey",this.nSa);w.a.prototype.hide.call(this)},500)}AWj(wa){3===wa&&(window.clearTimeout(this.dWe),this.hh.raiseEvent("OnDialogClosedEventKey",this.nSa),super.hide())}}Object(c.a)(y,"AppsForOfficeDialog",n.a,[824,825]);class B{constructor(){this.dialog=this.kl=null}}Object(c.a)(B,"DialogInfo",null,[]);class A{}A.url="url";A.height="height";A.width="width";A.cCd="displayInIframe";A.SDc="hideTitle";Object(c.a)(A,
"DialogSettings",null,[]);class E{constructor(){this.height=this.width=0;this.kl=this.controlId=this.pageUrl=null;this.SDc=this.cCd=!1}}Object(c.a)(E,"DisplayDialogParams",null,[]);class N extends Sys.EventArgs{constructor(wa,wb,zc,Hc,ed){zc=void 0===zc?null:zc;Hc=void 0===Hc?"":Hc;ed=void 0===ed?"":ed;super();this.controlId=wa;this.messageType=wb;this.messageContent=zc;this.messageOrigin=Hc;this.targetOrigin=ed}}Object(c.a)(N,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(wa,
wb,zc,Hc,ed){zc=void 0===zc?null:zc;Hc=void 0===Hc?"":Hc;ed=void 0===ed?"":ed;super();this.controlId=wa;this.messageType=wb;this.messageContent=zc;this.messageOrigin=Hc;this.targetOrigin=ed}}Object(c.a)(D,"OnMessageParentEventArgs",Sys.EventArgs,[]);var U=a(47),K=a(33),M=a(189),O=a(106),R=a(22);class J{constructor(wa){this.hh=new e.a;this.vQj=(wb,zc)=>{if(wb=this.HZa(zc))this.Cr.purgeDialogControl(zc),J.Nja.remove(wb),this.hh.raiseEvent("OnMessageParentEventKey",new D(wb,OSF.DialogMessageType.DialogClosed,
null,null,"*"))};this.Cr=wa}JDh(wa){this.hh.addHandler("OnMessageParentEventKey",wa)}IDh(wa){this.hh.addHandler("OnMessageDialogEventKey",wa)}showDialog(wa,wb,zc,Hc){if(J.Nja.kh(wb))h.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),zc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const cd=U.b(wa),Ud=cd[A.url];if(this.Cr.getOsfControl(wb).checkAppDomains(Ud)){var ed=new E;ed.width=cd[A.width];ed.height=cd[A.height];ed.pageUrl=
Ud;ed.cCd=cd[A.cCd];ed.SDc=cd[A.SDc];ed.controlId=wb;ed.kl=M.a.create().toString();var rd=new B;rd.kl=ed.kl;var ve=this.Cr.getOsfControl(ed.controlId).getManifest().getDefaultDisplayName(),Le=this.Cr.getOsfControl(ed.controlId).getStoreType().toLowerCase();wa=null;wa=(4===v.AFrameworkApplication.ra.$g.kn&&"hardcodedpreinstall"===Le||"sdxcatalog"===Le)&&ed.SDc?this.createAndShowAppsForOfficeDialog(ed.width,ed.height,ed.kl,!0,ve):this.createAndShowAppsForOfficeDialog(ed.width,ed.height,ed.kl,!1,ve);
var Qe=this.Cr.getOsfControl(ed.controlId),Vb=Qe.getManifest();wb={};wb.id=ed.kl;wb.solutionId=Qe.getSolutionId();wb.version=Qe.getVersion();wb.storeType=Le;wb.storeId=Qe.getStoreId();wb.assetId=Qe.getAssetId();wb.assetStoreId=Qe.getAssetStoreId();wb.ownerAddinSolutionId=Qe.getOwnerAddinSolutionId();wb.ownerAddinStoreType=Qe.getOwnerAddinStoreType();wb.appDomains=Vb.getAppDomains();wb.dialogUrl=Ud;wb.osfControlType=1;wb.agaveName=ve;wb.div=wa.xma;h.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(wb.solutionId,wb.ownerAddinStoreType||wb.storeType,wb.assetId,null,null,wb.storeId),K.a.rE(ed.pageUrl));this.Cr.insertDialogControl(wb);wa.zDh(this.vQj);rd.dialog=wa;J.Nja.ga(ed.controlId,rd);Hc&&Hc(wb);zc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else h.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),zc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(cd){h.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
cd.message),zc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}fGj(wa,wb,zc,Hc){v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Hc&&(Hc=zc);try{const ed=this.HZa(wa);ed&&this.hh.raiseEvent("OnMessageParentEventKey",new D(ed,OSF.DialogMessageType.DialogMessageReceived,wb,zc,Hc))}catch(ed){return h.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ed.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}OWa(wa,
wb){if(J.Nja.kh(wa))try{const zc=J.Nja.na(wa);zc.dialog&&zc.dialog.hide();this.Cr.purgeDialogControl(zc.kl);J.Nja.remove(wa);wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(zc){h.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",zc.message),wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else h.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}Izk(wa,
wb,zc,Hc){v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Hc&&(Hc=zc);if(J.Nja.kh(wa)&&(wa=J.Nja.na(wa),wa.dialog))try{this.hh.raiseEvent("OnMessageDialogEventKey",new N(wa.kl,OSF.DialogMessageType.DialogParentMessageReceived,wb,zc,Hc))}catch(ed){h.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",ed.message)}}HZa(wa){let wb=null;for(const zc of J.Nja)if(zc.value.kl===wa){wb=zc.key;
break}return wb}createAndShowAppsForOfficeDialog(wa,wb,zc,Hc,ed){wa=new y(wa,wb,zc);ed=Hc?"":String.format(Object(R.a)("ShowDialogApiInlineDialogTitle"),ed);Hc&&(wa.oTb=!1,wa.BC=!1);wa.initializeAndShow(ed,null,null);wa.TEk();return wa}static R_i(){return J.Nja}static getInstance(wa){J.Va||(J.Va=new J(wa));return J.Va}}J.Va=null;J.Nja=new O.a;Object(c.a)(J,"AppsForOfficeDialogManager",null,[814]);var aa=a(1514),S=a(854),C=a(648),L=a(210),V=a(435),X=a(1112);class la{constructor(){this.releaseDate=
this.diffAUP=this.AUP=this.priority=0}}Object(c.a)(la,"AddinDetailInfo",null,[]);class Va{constructor(wa,wb){this.failure=null;this.p$=wa;this.errorCode=void 0===wb?0:wb}}Object(c.a)(Va,"AddinQueryResult",null,[]);class na extends Va{constructor(wa,wb){super(wa,void 0===wb?0:wb);this.solutionIds=null}}Object(c.a)(na,"AddinCollection",Va,[]);var db;(function(wa){wa[wa.stop=-1]="stop";wa[wa.skip=0]="skip";wa[wa.query=1]="query"})(db||(db={}));Object(c.b)("QueryStrategy",db);var ja=a(1048);class ea extends Sys.EventArgs{constructor(wa,
wb,zc,Hc){Hc=void 0===Hc?null:Hc;super();this.WL=wa;this.errorCode=wb;this.Dt=zc;this.failure=Hc}}Object(c.a)(ea,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class Z{constructor(wa){this.errorCode=wa;this.Dt=[];this.failure=null}}Object(c.a)(Z,"GetAddinDetailsResult",null,[]);var ba=a(928),ya=a(1031);class Qa{}Object(c.a)(Qa,"GetEntitlementDetailsParameters",null,[]);var va=a(125),Ia=a(231),Sa=a(172);class Xa{constructor(wa){this.bIe=432E5;wa&&(this.bIe=36E5*wa.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",
12))}tXi(wa){const wb=new Date;let zc=new Date(-1);try{const Hc=Xa.O2g(`${wa}_ExpirationTime`);Hc&&(zc=new Date(parseInt(Hc,10)))}catch(Hc){h.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${wa}: ${Hc}`)}if(wb.getTime()<zc.getTime()&&(wa=Xa.O2g(`${wa}_StoreDisabled`)))return"true"===wa}NGk(wa,wb){void 0!==wb&&null!==wb&&(Xa.j3g(wb.toString(),`${wa}_StoreDisabled`),Xa.j3g(((new Date).getTime()+this.bIe).toString(),`${wa}_ExpirationTime`))}static O2g(wa){let wb=null;try{const zc=
Xa.h$b;if(void 0!==zc&&zc){const Hc=ba.a.Nkb("Flyout")+"_"+wa;wb=zc.getItem(Hc)}else h.ULS.sendTraceTag(508063828,220,50,"tryGetCache: Storage.Local null")}catch(zc){h.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",wa)}return wb}static j3g(wa,wb){try{const zc=Xa.h$b;if(void 0!==zc&&zc){const Hc=ba.a.Nkb("Flyout")+"_"+wb;zc.setItem(Hc,wa)}else h.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(zc){h.ULS.sendTraceTag(508063825,
220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",wb)}}static get h$b(){if(!Xa.uaa)return null;let wa=null;try{wa=localStorage}catch(wb){Xa.uaa=!1,wa=null,h.ULS.sendTraceTag(508063824,220,50,`Failed to use localStorage: error name: ${wb.name}; message: ${wb.message}; stack: ${wb.stack}`)}return wa}}Xa.uaa=!0;Object(c.a)(Xa,"StoreDisabledCache",null,[]);class da{constructor(wa,wb,zc){zc=void 0===zc?null:zc;var Hc;this.hh=new e.a;this.jD=new S.a(C.a.zm());this.pF=
new V.a;this.V2=0;this.cX=new V.a;this.xhd=null;this.rsb=(ed,rd,ve)=>{if(ve)if(this.$2d(ed,ve,window.performance.now()-rd),0===ve.errorCode){let Le;if(ve.value){let Qe=0;Le=Array(ve.value.length);ve.value.forEach(Vb=>{Le[Qe++]=Vb})}else Le=[];this.jG(new Va(ed),Le)}else-1===ve.errorCode||10===ve.errorCode?this.jG(new Va(ed),[]):(ed=this.xtd(ed,rd,ve),this.jG(ed));else ed=da.ytd(ed,rd),this.jG(ed)};this.W3a=(ed,rd)=>{if(0!==rd.errorCode)this.pF.ga(rd.WL,Object.assign(new na(rd.WL,rd.errorCode),{failure:rd.failure})),
this.DGj&&this.dca(rd.WL,1);else{ed=Object.assign(new na(rd.WL),{solutionIds:new L.a});var ve=rd.Dt;for(const Le of ve)ve=Le.solutionId,this.jD.kh(ve)?this.jD.ga(ve,this.A5d(this.jD.na(ve),rd.WL,Le)):this.jD.add(ve,Le),ed.solutionIds.add(ve);this.pF.ga(rd.WL,ed);this.dca(ed.p$,1)}};this.hta=new Ia.a;this.hta.add(OSF.StoreTypeEnum.MarketPlace,0);this.hta.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ha=wa;this.Cr=wb;this.RJ=zc;this.ccd=da.$Ld(wa,"https://store-images.s-microsoft.com");this.JHb(this.W3a);
this.cZe=null!==(Hc=zc.StoreDisabledCache)&&void 0!==Hc?Hc:new Xa(wa)}get DGj(){return!!this.Ha&&this.Ha.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get EM(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get b3d(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get Rte(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get rVk(){return!!this.Ha&&
this.Ha.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.Ha&&this.Ha.ka("IsAnonymousUser")}get FHd(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get ekb(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get aga(){return this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Dl(){return this.Cr.value}zR(wa){if(this.EM&&
!this.Zxa(wa))return new Z(0);if(!this.z0a(wa))return wa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:X.a[wa]}),Object.assign(new Z(1),{failure:wa});if(this.pF.na(wa).failure)return Object.assign(new Z(this.pF.na(wa).errorCode),{failure:this.pF.na(wa).failure});h.ULS.shipAssertTag(509870082,220,!!this.pF.na(wa).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",wa);const wb=new Z(0);for(const zc of this.pF.na(wa).solutionIds)this.jD.kh(zc)&&
Array.add(wb.Dt,this.jD.na(zc));return wb}getUpgradedAddinsOfOmex(){return this.Dl.getUpgradedAddinsOfOmex()}TI(wa){return this.jD.kh(wa)?this.jD.na(wa):null}AAa(wa){if(wa){this.JHb(wa);for(const wb of this.pF.keys){if(this.EM&&!this.Zxa(wb))continue;if(!this.z0a(wb)||this.pF.na(wb).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.pF.na(wb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",wb);const zc=[],Hc=this.pF.na(wb);for(const ed of Hc.solutionIds)Array.add(zc,
this.jD.na(ed));wa(null,new ea(wb,Hc.errorCode,zc,Hc.failure))}}}get name(){return"AddinDetailsManager1"}Hub(wa,wb){if(this.EM&&da.l2a(wa)){var zc=ed=>{this.jG(da.ZVa(ed,4,"The connected service is disabled."));this.dca(ed,-1)},Hc=ed=>{this.jG(da.ZVa(ed,0,"The user doesn't have any addin installed."),[]);this.dca(ed,0)};0===wa?(this.uUb(0,wb,zc,Hc),this.uUb(2,wb,zc,()=>{this.D5a(this.rsb)})):10===wa&&this.dca(1,1)}}pG(wa,wb){da.l2a(wa)?this.gfe(wa,this.rsb,void 0===wb?!1:wb):h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",ya.a[wa])}JHb(wa){this.hh.addHandler(ba.a.Kmc,wa)}uUb(wa,wb,zc,Hc){this.Zxa(wa)||(3===wb&&zc?zc(wa):2===wb&&Hc?Hc(wa):this.dca(wa,1))}Zxa(wa){return this.cX.kh(wa)}dca(wa,wb){if(this.EM){var zc=this.Zxa(wa);if(!zc||-1!==this.cX.na(wa)&&this.cX.na(wa)!==wb)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",X.a[wa],zc?db[this.cX.na(wa)]:"undefined",db[wb]),this.cX.ga(wa,wb)}}xtd(wa,wb,zc){const Hc=
{};Hc.collectionType=X.a[wa];Hc.invokeResultCode=zc.errorCode;Hc["queryResult.Value"]=zc.value?String.format("Length: {0}",zc.value.length):"null";Hc.queryStart=wb;Hc.queryDuration=window.performance.now()-wb;return Object.assign(new Va(wa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Hc)})}LLk(){return this.z0a(2)?this.Ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.pF.na(2).errorCode:!1:!0}oxb(wa){return this.EM&&this.cX.kh(wa)?1===
this.cX.na(wa):!0}gfe(wa,wb,zc){zc=void 0===zc?!1:zc;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",wa);if(wa!==OSF.StoreTypeEnum.MarketPlace&&wa!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",wa);else{var Hc=this.hta.na(wa);(!this.Rte||this.ekb&&this.isAnonymousUser)&&wa===OSF.StoreTypeEnum.MarketPlace&&this.oxb(2)&&this.D5a(wb);this.oxb(Hc)&&(this.ekb&&this.isAnonymousUser?(wa=da.jtd(Hc),this.jG(wa)):this.hfe(wa,
wb,zc))}}hfe(wa,wb,zc){this.Ryg(wa,(Hc,ed)=>{if(Hc===OSF.StoreTypeEnum.MarketPlace&&ed)ed=da.DGa(0),this.jG(ed),this.Rte&&this.jG(da.DGa(2));else if(Hc===OSF.StoreTypeEnum.PrivateCatalog&&ed)ed=da.DGa(1),this.jG(ed);else{this.Rte&&Hc===OSF.StoreTypeEnum.MarketPlace&&this.oxb(2)&&wb(2,window.performance.now(),this.YIg());var rd=window.performance.now();this.Dl.getEntitlementDetails(Object.assign(new Qa,{storeType:Hc,refresh:zc}),ve=>{wb(this.hta.na(Hc),rd,ve)})}})}D5a(wa){this.LLk()&&this.Ryg(0,(wb,
zc)=>{zc?(wb=da.DGa(2),this.jG(wb)):(wb=window.performance.now(),wa(2,wb,this.YIg()))})}jG(wa,wb){wb=void 0===wb?null:wb;0!==wa.errorCode?(h.ULS.shipAssertTag(509116673,220,!wb,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!wa.failure,"The result.Failure must not be available for any failed queries"),this.Wre(wa)?h.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",X.a[wa.p$],ja.a[wa.errorCode],wa.failure?wa.failure.toString():"null",JSON.stringify(wa.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",X.a[wa.p$],ja.a[wa.errorCode],wa.failure?wa.failure.toString():"null",JSON.stringify(wa.failure))):(h.ULS.shipAssertTag(509116643,220,!!wb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
X.a[wa.p$]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",X.a[wa.p$],wb?wb.length:-1));wa=new ea(wa.p$,wa.errorCode,wb,wa.failure);this.hh.raiseEvent(ba.a.Kmc,wa)}Wre(wa){return 3===wa.errorCode&&(this.ekb&&-2147208619===da.GRb(wa)||this.FHd&&-2===da.GRb(wa))||4===wa.errorCode?!1:2!==wa.errorCode}z0a(wa){return this.pF.kh(wa)?!!this.jD:!1}get Nnc(){return this.RJ?!this.RJ.AreThirdPartyAddInsAllowed||this.RJ.AppsForOfficeThirdPartyIsDisabled:
!this.Ha.ka("AreThirdPartyAddInsAllowed")||this.Ha.ka("AppsForOfficeThirdPartyIsDisabled")}get LHc(){return this.RJ?!this.RJ.AppsForOfficeAllowExternalMarketplace:!this.Ha.ka("AppsForOfficeAllowExternalMarketplace")}get ytb(){return this.RJ?this.RJ.PopularAddinDetailsJsonString:this.Ha.Za("PopularAddinDetailsJsonString")}queryStoreDisabled(wa,wb){if(this.Nnc)wb(wa,!0);else if(wa===OSF.StoreTypeEnum.MarketPlace&&this.LHc)wb(wa,!0);else{const zc=da.x1c(wa);if(zc){const Hc=window.performance.now();this.Dl.queryStoreDisabled(zc,
ed=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",wa,ed,Hc,window.performance.now()-Hc);wb(wa,ed)})}else wb(wa,!1)}}Ryg(wa,wb){if(this.rVk)if(this.Nnc)wb(wa,!0);else if(wa===OSF.StoreTypeEnum.MarketPlace&&this.LHc)wb(wa,!0);else{const zc=da.x1c(wa),Hc=this.cZe.tXi(wa);if(void 0===Hc)if(zc){const ed=window.performance.now();this.Dl.queryStoreDisabled(zc,rd=>{this.cZe.NGk(wa,rd);h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
wa,rd,ed,window.performance.now()-ed);wb(wa,void 0!==rd?rd:!0)})}else wb(wa,!1);else wb(wa,Hc)}else this.queryStoreDisabled(wa,wb)}A5d(wa,wb,zc){return wa?zc?2===wb?da.ZZb(zc,wa):da.ZZb(wa,zc):wa:zc}YIg(){if(!this.xhd){const wa=JSON.parse(this.ytb);this.jHd(wa);this.xhd=wa}return da.Yoc(0,this.xhd)}jHd(wa){da.Nqd(wa);this.Fnc(wa);this.kHd(wa)}Fnc(wa){const wb=this.utd();for(var zc=0;zc<wa.length&&0<wb.count;zc++){const Hc=wa[zc];if(wb.kh(Hc.solutionId)){let ed=String.format("Found an override, solutionId: {0}",
Hc.solutionId);const rd=wb.na(Hc.solutionId);rd&&(isNaN(rd.addinInfo.priority)||(ed=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ed,Hc.addinInfo.priority,rd.addinInfo.priority),Hc.addinInfo.priority=rd.addinInfo.priority),isNaN(rd.addinInfo.AUP)||(ed=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ed,Hc.addinInfo.AUP,rd.addinInfo.AUP),Hc.addinInfo.AUP=rd.addinInfo.AUP),rd.displayName&&(ed=String.format("{0}; DisplayName: update {1} to {2}",ed,Hc.displayName,rd.displayName),Hc.displayName=
rd.displayName),rd.iconUrl&&(ed=String.format("{0}; IconUrl: update {1} to {2}",ed,Hc.iconUrl,rd.iconUrl),Hc.iconUrl=rd.iconUrl),rd.description&&(ed=String.format("{0}; Description: update {1} to {2}",ed,Hc.description,rd.description),Hc.description=rd.description));wb.remove(Hc.solutionId);this.aga&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ed)}}for(const Hc of wb.keys)zc=wb.na(Hc),zc.displayName&&zc.iconUrl&&zc.addinInfo&&(wa.push(zc),this.aga&&h.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(zc)))}utd(){const wa=new S.a(C.a.zm());let wb=this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!wb)return wa;wb=wb.trim();if(12>=wb.length)return 0<wb.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",wb),wa;this.aga&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
wb);try{const zc=[],Hc=wb.split("|");for(let ed=Hc.length-1;0<=ed;ed--){const rd=Hc[ed],ve=rd.split("\\");if(2>ve.length){zc.push(rd);continue}const Le=da.Tbe(ve);Le?wa.kh(Le.solutionId)||wa.add(Le.solutionId,Le):zc.push(rd)}this.aga&&0<zc.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",zc.join("|"));this.aga&&0<wa.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",wa.count,JSON.stringify(Sa.toArray(wa.values)));
return wa}catch(zc){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",wb,zc.toString())}return wa}kHd(wa){for(let wb=0;wb<wa.length;wb++)va.c(wa[wb].iconUrl.toLowerCase(),"http",0)||(wa[wb].iconUrl=String.format("{0}/image/apps.{1}",this.ccd,wa[wb].iconUrl))}static l2a(wa){return 0===wa||10===wa}static ytd(wa,wb){const zc={};zc.collectionType=X.a[wa];zc.queryResult="null";zc.queryStart=wb;zc.queryDuration=window.performance.now()-
wb;return Object.assign(new Va(wa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",zc)})}static ZVa(wa,wb,zc){const Hc={};Hc.collectionType=X.a[wa];wa=new Va(wa,wb);0!==wb&&(wa.failure=Error.create(zc,Hc));return wa}static DGa(wa){return da.ZVa(wa,2,"The store is disabled.")}static jtd(wa){const wb={};wb.collectionType=X.a[wa];wb.invokeResultCode=-2147208619;wb.queryDuration=0;return Object.assign(new Va(wa,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
wb)})}static GRb(wa){return wa.failure?wa.failure.invokeResultCode:-1E3}a3d(wa,wb,zc){const Hc={};Hc.AddinCollectionType=X.a[wa];Hc.ErrorCode=wb.errorCode;Hc.AddinCount=wb.value?wb.value.length:0;wa=window.performance.now();wb=Date.now()-v.AFrameworkApplication.dR;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",zc,wa,wb,JSON.stringify(Hc))}$2d(wa,wb,zc){this.b3d?(zc={["AddinCollectionType"]:X.a[wa],
["ErrorCode"]:wb.errorCode,["QueryDuration"]:zc,["FlyoutDataReadySinceBoot"]:Date.now()-v.AFrameworkApplication.dR},this.zWd(wa)&&h.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(zc)),zc.AddinCount=wb.value?wb.value.length:0,h.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(zc))):this.a3d(wa,wb,zc)}zWd(wa){0===wa?this.V2|=1:1===wa&&(this.V2|=2);wa=this.V2&131;if(wa=1===wa||2===wa)this.V2=255;return wa}static Yoc(wa,wb){const zc={};zc.errorCode=wa;zc.value=wb;
return zc}static x1c(wa){return wa===OSF.StoreTypeEnum.MarketPlace?"omex":wa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static ZZb(wa,wb){wb.solutionId=wb.solutionId||wa.solutionId;wb.version=wb.version||wa.version;wb.storeType=wb.storeType||wa.storeType;wb.storeId=wb.storeId||wa.storeId;wb.assetId=wb.assetId||wa.assetId;wb.assetStoreId=wb.assetStoreId||wa.assetStoreId;wb.displayName=wb.displayName||wa.displayName;wb.provider=wb.provider||wa.provider;wb.description=wb.description||wa.description;
wb.iconUrl=wb.iconUrl||wa.iconUrl;wb.webApplicationId=wb.webApplicationId||wa.webApplicationId;wb.highResolutionIconUrl=wb.highResolutionIconUrl||wa.highResolutionIconUrl;wb.licenseUrl=wb.licenseUrl||wa.licenseUrl;wb.privacyUrl=wb.privacyUrl||wa.privacyUrl;wb.addinInfo=wb.addinInfo||wa.addinInfo;isNaN(wb.targetType)&&(wb.targetType=wa.targetType);isNaN(wb.height)&&(wb.height=wa.height);isNaN(wb.width)&&(wb.width=wa.width);return wb}static Nqd(wa){for(const wb of wa)isNaN(wb.targetType)&&(wb.targetType=
1),wb.assetId=wb.assetId||wb.solutionId,wb.storeId=wb.storeId||"en-US",wb.storeType=wb.storeType||"omex",wb.assetStoreId=wb.assetStoreId||"omex",isNaN(wb.width)&&(wb.width=0),isNaN(wb.height)&&(wb.height=0)}static Tbe(wa){const wb={};let zc=0;zc<wa.length&&0<wa[zc].trim().length&&wa[zc].trim().toLowerCase().startsWith("wa")&&(wb.solutionId=wa[zc].trim(),wb.addinInfo=Object.assign(new la,{priority:Number.NaN,AUP:Number.NaN}),++zc<wa.length&&0<wa[zc].trim().length&&(wb.addinInfo.priority=parseInt(wa[zc].trim())),
++zc<wa.length&&0<wa[zc].trim().length&&(wb.addinInfo.AUP=parseInt(wa[zc].trim())),++zc<wa.length&&0<wa[zc].trim().length&&(wb.displayName=wa[zc].trim()),++zc<wa.length&&0<wa[zc].trim().length&&(wb.iconUrl=wa[zc].trim()),++zc<wa.length&&0<wa[zc].trim().length&&(wb.description=wa[zc].trim()));return wb.solutionId?wb:null}static $Ld(wa,wb){wa=wa.Za("AddinImageStoreServiceUrl");if(!wa)return wb;wa=wa.toLowerCase();return wa.startsWith("http://")||wa.startsWith("https://")?wa:wb}}Object(c.a)(da,"AddinDetailsManager1",
null,[803,804]);class Ea{constructor(wa,wb){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=wa.solutionId;this.version=wa.version;this.storeType=wa.storeType;this.storeId=wa.storeId;this.assetId=wa.assetId;this.assetStoreId=wa.assetStoreId;
this.displayName=wa.displayName;this.provider=wa.provider;this.description=wa.description;this.targetType=wa.targetType;this.height=wa.height;this.width=wa.width;this.iconUrl=wa.iconUrl;this.webApplicationId=wa.webApplicationId;this.highResolutionIconUrl=wa.highResolutionIconUrl;this.licenseUrl=wa.licenseUrl;this.privacyUrl=wa.privacyUrl;this.addinInfo=void 0===wb?null:wb}q$b(){const wa={};wa.solutionId=this.solutionId;wa.version=this.version;wa.storeType=this.storeType;wa.storeId=this.storeId;wa.assetId=
this.assetId;wa.assetStoreId=this.assetStoreId;wa.targetType=this.targetType;wa.displayName=this.displayName;wa.width=this.width;wa.height=this.height;return wa}}Object(c.a)(Ea,"AddinDetail",null,[]);class qa{constructor(wa,wb,zc,Hc,ed){this.Fjc=null;this.Ha=wa;this.Cr=wb;this.ITa=zc;this.crh=Hc;this.yBb=ed}pG(wa,wb){this.Dl.queryAppDetails(this.crh,this.yBb,this.solutionIds,wa,(zc,Hc)=>{let ed=null;if(Hc){ed=Array(Hc.length);for(let rd=0;rd<Hc.length;rd++)ed[rd]=new Ea(Hc[rd],this.nCj(Hc[rd].solutionId))}wb(zc,
ed||[])})}get tlj(){return!!this.Dl.queryAppDetails}nCj(wa){return this.ITa.na(wa)}get solutionIds(){if(!this.Fjc){this.Fjc=new L.a;for(const wa of this.ITa.keys)this.Fjc.add(va.d(wa))}return this.Fjc.toArray()}get Dl(){return this.Cr.value}}Object(c.a)(qa,"AddinDetailsLoader",null,[]);class za{constructor(wa,wb){this.failure=null;this.p$=wa;this.errorCode=void 0===wb?0:wb}}Object(c.a)(za,"AddinQueryResult",null,[]);class ma extends za{constructor(wa,wb){super(wa,void 0===wb?0:wb);this.qve=this.solutionIds=
null}}Object(c.a)(ma,"AddinCollection",za,[]);var Da=a(908);class Ua extends Da.a{constructor(){super(C.a.zm())}}Object(c.a)(Ua,"AddinDetailTable",Da.a,[]);var ka;(function(wa){wa[wa.stop=-1]="stop";wa[wa.skip=0]="skip";wa[wa.query=1]="query"})(ka||(ka={}));Object(c.b)("QueryStrategy",ka);class xa{constructor(wa,wb,zc){zc=void 0===zc?null:zc;this.hh=new e.a;this.jD=new S.a(C.a.zm());this.pF=new V.a;this.V2=0;this.cX=new V.a;this.ITa=this.i8c=null;this.rsb=(Hc,ed,rd)=>{rd?(this.$2d(Hc,rd,window.performance.now()-
ed),0===rd.errorCode?(ed=rd.value?xa.AHh(rd.value):[],this.jG(new za(Hc),ed)):-1===rd.errorCode||10===rd.errorCode?this.jG(new za(Hc),[]):(Hc=this.xtd(Hc,ed,rd),this.jG(Hc))):(Hc=xa.ytd(Hc,ed),this.jG(Hc))};this.W3a=(Hc,ed)=>{if(0!==ed.errorCode&&5!==ed.errorCode)this.R4g(ed.WL,Object.assign(new ma(ed.WL,ed.errorCode),{failure:ed.failure}));else{Hc=Object.assign(new ma(ed.WL,ed.errorCode),{solutionIds:new L.a,qve:new L.a});var rd=ed.Dt;for(const Le of rd){rd=Le.solutionId;const Qe=Le.storeId;if(this.jD.kh(rd)){var ve=
this.jD.na(rd);ve.kh(Qe)?ve.ga(Qe,this.A5d(ve.na(Qe),ed.WL,Le)):ve.add(Qe,Le)}else ve=new Ua,ve.add(Qe,Le),this.jD.add(rd,ve);Hc.solutionIds.add(rd);Hc.qve.add(Qe)}this.R4g(ed.WL,Hc)}};this.hta=new Ia.a;this.hta.add(OSF.StoreTypeEnum.MarketPlace,0);this.hta.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ha=wa;this.Cr=wb;this.RJ=zc;this.ccd=xa.$Ld(wa,"https://store-images.s-microsoft.com");this.yhd=null;this.JHb(this.W3a)}get Zoc(){this.i8c||(this.i8c=this.tEf());return this.i8c}tEf(){const wa=JSON.parse(this.ytb);
this.jHd(wa);return wa.map(wb=>new Ea(wb,wb.addinInfo))}get EM(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get b3d(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.Ha&&this.Ha.ka("IsAnonymousUser")}get FHd(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get ekb(){return!!this.Ha&&this.Ha.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get aga(){return this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Dl(){return this.Cr.value}get Rce(){this.yhd||(this.yhd=new qa(this.Ha,this.Cr,this.R6j,0,this.Dl.getAppUILocale()));return this.yhd}zR(wa){if(this.EM&&!this.Zxa(wa))return new Z(0);if(!this.z0a(wa))return wa=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:X.a[wa]}),Object.assign(new Z(1),{failure:wa});const wb=this.pF.na(wa);if(wb.failure)return Object.assign(new Z(wb.errorCode),{failure:wb.failure});h.ULS.shipAssertTag(509870082,220,!!wb.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
wa);const zc=new Z(wb.errorCode);for(let Hc=0;Hc<wb.solutionIds.count;Hc++){const ed=wb.solutionIds.na(Hc),rd=wb.qve.na(Hc);if(this.jD.kh(ed)){const ve=this.jD.na(ed);ve.kh(rd)?Array.add(zc.Dt,ve.na(rd)):h.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",ed,wa,rd)}else h.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",ed,wa)}return zc}getUpgradedAddinsOfOmex(){return this.Dl.getUpgradedAddinsOfOmex()}TI(wa,
wb){wb=void 0===wb?null:wb;if(wa=this.QDi(wa))if(wb||(wb=this.uiCulture),wa.kh(wb))return wa.na(wb);return null}QDi(wa){return this.jD.kh(wa)?this.jD.na(wa):null}AAa(wa){if(wa){this.JHb(wa);for(const wb of this.pF.keys){if(this.EM&&!this.Zxa(wb))continue;if(!this.z0a(wb)||this.pF.na(wb).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.pF.na(wb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",wb);const zc=[],Hc=this.pF.na(wb);for(const ed of Hc.solutionIds)Array.add(zc,
this.jD.na(ed));wa(null,new ea(wb,Hc.errorCode,zc,Hc.failure))}}}get name(){return"AddinDetailsManager2"}Hub(wa,wb){if(this.EM&&xa.l2a(wa)){var zc=ed=>{this.jG(xa.ZVa(ed,4,"The connected service is disabled."));this.dca(ed,-1)},Hc=ed=>{this.jG(xa.ZVa(ed,0,"The user doesn't have any addin installed."),[]);this.dca(ed,0)};0===wa?(this.uUb(0,wb,zc,Hc),this.uUb(2,wb,zc,()=>{this.D5a(this.rsb,this.Zoc)})):10===wa&&this.dca(1,1)}}pG(wa,wb){xa.l2a(wa)?this.gfe(wa,this.rsb,void 0===wb?!1:wb):h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",ya.a[wa])}JHb(wa){this.hh.addHandler(ba.a.Kmc,wa)}uUb(wa,wb,zc,Hc){this.Zxa(wa)||(3===wb&&zc?zc(wa):2===wb&&Hc?Hc(wa):this.dca(wa,1))}Zxa(wa){return this.cX.kh(wa)}dca(wa,wb){if(this.EM){var zc=this.Zxa(wa);if(!zc||-1!==this.cX.na(wa)&&this.cX.na(wa)!==wb)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",X.a[wa],zc?ka[this.cX.na(wa)]:"undefined",ka[wb]),this.cX.ga(wa,wb)}}xtd(wa,wb,zc){const Hc=
{};Hc.collectionType=X.a[wa];Hc.invokeResultCode=zc.errorCode;Hc["queryResult.Value"]=zc.value?String.format("Length: {0}",zc.value.length):"null";Hc.queryStart=wb;Hc.queryDuration=window.performance.now()-wb;return Object.assign(new za(wa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Hc)})}MLk(wa){if(wa!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.oxb(2)){if(!this.z0a(2))return!0;if(this.Ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===
this.pF.na(2).errorCode}return!1}oxb(wa){return this.EM&&this.cX.kh(wa)?1===this.cX.na(wa):!0}gfe(wa,wb,zc){zc=void 0===zc?!1:zc;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",wa);if(wa!==OSF.StoreTypeEnum.MarketPlace&&wa!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",wa);else{var Hc=this.hta.na(wa);this.MLk(wa)&&this.D5a(wb,this.x8j);this.oxb(Hc)&&(this.ekb&&this.isAnonymousUser?(wa=xa.jtd(Hc),this.jG(wa)):this.hfe(wa,
wb,zc))}}get x8j(){return this.pF.kh(2)?null:this.Zoc}hfe(wa,wb,zc){this.queryStoreDisabled(wa,(Hc,ed)=>{if(Hc===OSF.StoreTypeEnum.MarketPlace&&ed)ed=xa.DGa(0),this.jG(ed);else if(Hc===OSF.StoreTypeEnum.PrivateCatalog&&ed)ed=xa.DGa(1),this.jG(ed);else{var rd=window.performance.now();this.Dl.getEntitlementDetails(Object.assign(new Qa,{storeType:Hc,refresh:zc}),ve=>{wb(this.hta.na(Hc),rd,ve)})}})}D5a(wa,wb){wa=void 0===wa?null:wa;wb=void 0===wb?null:wb;null===wa&&(wa=this.rsb);this.queryStoreDisabled(0,
(zc,Hc)=>{Hc?(zc=xa.DGa(2),this.jG(zc)):null!=wb?this.jG(new za(2,5),wb):this.fbk(wa)})}jG(wa,wb){wb=void 0===wb?null:wb;0!==wa.errorCode&&5!==wa.errorCode?(h.ULS.shipAssertTag(509116673,220,!wb,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!wa.failure,"The result.Failure must not be available for any failed queries"),this.Wre(wa)?h.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",X.a[wa.p$],ja.a[wa.errorCode],wa.failure?wa.failure.toString():"null",JSON.stringify(wa.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",X.a[wa.p$],ja.a[wa.errorCode],wa.failure?wa.failure.toString():"null",JSON.stringify(wa.failure))):(h.ULS.shipAssertTag(509116643,220,!!wb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
X.a[wa.p$]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",X.a[wa.p$],wb?wb.length:-1,ja.a[wa.errorCode]));wa=new ea(wa.p$,wa.errorCode,wb,wa.failure);this.hh.raiseEvent(ba.a.Kmc,wa)}Wre(wa){return 3===wa.errorCode&&(this.ekb&&-2147208619===xa.GRb(wa)||this.FHd&&-2===xa.GRb(wa))||4===wa.errorCode?!1:2!==wa.errorCode}R4g(wa,wb){this.pF.ga(wa,wb);this.dca(wa,1)}z0a(wa){return this.pF.kh(wa)?!!this.jD:!1}get uiCulture(){return this.RJ&&
this.RJ.UICulture?this.RJ.UICulture:v.AFrameworkApplication.uiCulture}get Nnc(){return this.RJ?!this.RJ.AreThirdPartyAddInsAllowed||this.RJ.AppsForOfficeThirdPartyIsDisabled:!this.Ha.ka("AreThirdPartyAddInsAllowed")||this.Ha.ka("AppsForOfficeThirdPartyIsDisabled")}get LHc(){return this.RJ?!this.RJ.AppsForOfficeAllowExternalMarketplace:!this.Ha.ka("AppsForOfficeAllowExternalMarketplace")}get R6j(){if(!this.ITa){this.ITa=new S.a(C.a.zm());const wa=JSON.parse(this.ytb);for(const wb of wa)this.ITa.add(wb.solutionId,
wb.addinInfo)}return this.ITa}get ytb(){return this.RJ?this.RJ.PopularAddinDetailsJsonString:this.Ha.Za("PopularAddinDetailsJsonString")}queryStoreDisabled(wa,wb){if(this.Nnc)wb(wa,!0);else if(wa===OSF.StoreTypeEnum.MarketPlace&&this.LHc)wb(wa,!0);else{const zc=xa.x1c(wa);if(zc){const Hc=window.performance.now();this.Dl.queryStoreDisabled(zc,ed=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",wa,ed,Hc,window.performance.now()-
Hc);wb(wa,ed)})}else wb(wa,!1)}}A5d(wa,wb,zc){return wa?zc?2===wb?xa.ZZb(zc,wa):xa.ZZb(wa,zc):wa:zc}fbk(wa){const wb=(Hc,ed,rd)=>{wa(2,rd,xa.Yoc(Hc,ed))},zc=window.performance.now();this.Rce&&this.Rce.tlj?this.Rce.pG(!1,(Hc,ed)=>{this.Fnc(ed);wa(2,zc,xa.Yoc(Hc,ed))}):wb(0,this.tEf(),zc)}jHd(wa){xa.Nqd(wa);this.Fnc(wa);this.kHd(wa)}Fnc(wa){const wb=this.utd();for(var zc=0;zc<wa.length&&0<wb.count;zc++){const Hc=wa[zc];if(wb.kh(Hc.solutionId)){let ed=String.format("Found an override, solutionId: {0}",
Hc.solutionId);const rd=wb.na(Hc.solutionId);rd&&(isNaN(rd.addinInfo.priority)||(ed=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ed,Hc.addinInfo.priority,rd.addinInfo.priority),Hc.addinInfo.priority=rd.addinInfo.priority),isNaN(rd.addinInfo.AUP)||(ed=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ed,Hc.addinInfo.AUP,rd.addinInfo.AUP),Hc.addinInfo.AUP=rd.addinInfo.AUP),rd.displayName&&(ed=String.format("{0}; DisplayName: update {1} to {2}",ed,Hc.displayName,rd.displayName),Hc.displayName=
rd.displayName),rd.iconUrl&&(ed=String.format("{0}; IconUrl: update {1} to {2}",ed,Hc.iconUrl,rd.iconUrl),Hc.iconUrl=rd.iconUrl),rd.description&&(ed=String.format("{0}; Description: update {1} to {2}",ed,Hc.description,rd.description),Hc.description=rd.description));wb.remove(Hc.solutionId);this.aga&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ed)}}for(const Hc of wb.keys)zc=wb.na(Hc),zc.displayName&&zc.iconUrl&&zc.addinInfo&&(wa.push(zc),this.aga&&h.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(zc)))}utd(){const wa=new S.a(C.a.zm());let wb=this.Ha.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!wb)return wa;wb=wb.trim();if(12>=wb.length)return 0<wb.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",wb),wa;this.aga&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
wb);try{const zc=[],Hc=wb.split("|");for(let ed=Hc.length-1;0<=ed;ed--){const rd=Hc[ed],ve=rd.split("\\");if(2>ve.length){zc.push(rd);continue}const Le=xa.Tbe(ve);Le?wa.kh(Le.solutionId)||wa.add(Le.solutionId,Le):zc.push(rd)}this.aga&&0<zc.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",zc.join("|"));this.aga&&0<wa.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",wa.count,JSON.stringify(Sa.toArray(wa.values)));
return wa}catch(zc){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",wb,zc.toString())}return wa}kHd(wa){for(let wb=0;wb<wa.length;wb++)va.c(wa[wb].iconUrl.toLowerCase(),"http",0)||(wa[wb].iconUrl=String.format("{0}/image/apps.{1}",this.ccd,wa[wb].iconUrl))}static l2a(wa){return 0===wa||10===wa}static ytd(wa,wb){const zc={};zc.collectionType=X.a[wa];zc.queryResult="null";zc.queryStart=wb;zc.queryDuration=window.performance.now()-
wb;return Object.assign(new za(wa,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",zc)})}static ZVa(wa,wb,zc){const Hc={};Hc.collectionType=X.a[wa];wa=new za(wa,wb);0!==wb&&(wa.failure=Error.create(zc,Hc));return wa}static DGa(wa){return xa.ZVa(wa,2,"The store is disabled.")}static jtd(wa){const wb={};wb.collectionType=X.a[wa];wb.invokeResultCode=-2147208619;wb.queryDuration=0;return Object.assign(new za(wa,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
wb)})}static GRb(wa){return wa.failure?wa.failure.invokeResultCode:-1E3}a3d(wa,wb,zc){const Hc={};Hc.AddinCollectionType=X.a[wa];Hc.ErrorCode=wb.errorCode;Hc.AddinCount=wb.value?wb.value.length:0;wa=window.performance.now();wb=Date.now()-v.AFrameworkApplication.dR;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",zc,wa,wb,JSON.stringify(Hc))}$2d(wa,wb,zc){this.b3d?(zc={["AddinCollectionType"]:X.a[wa],
["ErrorCode"]:wb.errorCode,["QueryDuration"]:zc,["FlyoutDataReadySinceBoot"]:Date.now()-v.AFrameworkApplication.dR},this.zWd(wa)&&h.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(zc)),zc.AddinCount=wb.value?wb.value.length:0,h.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(zc))):this.a3d(wa,wb,zc)}zWd(wa){0===wa?this.V2|=1:1===wa&&(this.V2|=2);wa=this.V2&131;if(wa=1===wa||2===wa)this.V2=255;return wa}static Yoc(wa,wb){const zc={};zc.errorCode=wa;zc.value=wb;
return zc}static x1c(wa){return wa===OSF.StoreTypeEnum.MarketPlace?"omex":wa===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static ZZb(wa,wb){wb.solutionId=wb.solutionId||wa.solutionId;wb.version=wb.version||wa.version;wb.storeType=wb.storeType||wa.storeType;wb.storeId=wb.storeId||wa.storeId;wb.assetId=wb.assetId||wa.assetId;wb.assetStoreId=wb.assetStoreId||wa.assetStoreId;wb.displayName=wb.displayName||wa.displayName;wb.provider=wb.provider||wa.provider;wb.description=wb.description||wa.description;
wb.iconUrl=wb.iconUrl||wa.iconUrl;wb.webApplicationId=wb.webApplicationId||wa.webApplicationId;wb.highResolutionIconUrl=wb.highResolutionIconUrl||wa.highResolutionIconUrl;wb.licenseUrl=wb.licenseUrl||wa.licenseUrl;wb.privacyUrl=wb.privacyUrl||wa.privacyUrl;wb.addinInfo=wb.addinInfo||wa.addinInfo;isNaN(wb.targetType)&&(wb.targetType=wa.targetType);isNaN(wb.height)&&(wb.height=wa.height);isNaN(wb.width)&&(wb.width=wa.width);return wb}static AHh(wa){const wb=Array(wa.length);for(let zc=0;zc<wb.length;zc++)wb[zc]=
new Ea(wa[zc],wa[zc].addinInfo);return wb}static Nqd(wa){for(const wb of wa)isNaN(wb.targetType)&&(wb.targetType=1),wb.assetId=wb.assetId||wb.solutionId,wb.storeId=wb.storeId||"en-US",wb.storeType=wb.storeType||"omex",wb.assetStoreId=wb.assetStoreId||"omex",isNaN(wb.width)&&(wb.width=0),isNaN(wb.height)&&(wb.height=0)}static Tbe(wa){const wb={};let zc=0;zc<wa.length&&0<wa[zc].trim().length&&wa[zc].trim().toLowerCase().startsWith("wa")&&(wb.solutionId=wa[zc].trim(),wb.addinInfo=Object.assign(new la,
{priority:Number.NaN,AUP:Number.NaN}),++zc<wa.length&&0<wa[zc].trim().length&&(wb.addinInfo.priority=parseInt(wa[zc].trim())),++zc<wa.length&&0<wa[zc].trim().length&&(wb.addinInfo.AUP=parseInt(wa[zc].trim())),++zc<wa.length&&0<wa[zc].trim().length&&(wb.displayName=wa[zc].trim()),++zc<wa.length&&0<wa[zc].trim().length&&(wb.iconUrl=wa[zc].trim()),++zc<wa.length&&0<wa[zc].trim().length&&(wb.description=wa[zc].trim()));return wb.solutionId?wb:null}static $Ld(wa,wb){wa=wa.Za("AddinImageStoreServiceUrl");
if(!wa)return wb;wa=wa.toLowerCase();return wa.startsWith("http://")||wa.startsWith("https://")?wa:wb}}Object(c.a)(xa,"AddinDetailsManager2",null,[805]);class Fb{constructor(wa,wb){this.ztb="popular";this.n5e="addinDetails";this.Ybf="cache-lastUpdate";this.qbf="builtin-lastUpdate";this.pvg=144E5;this.Ha=this.vT=null;this.SMj=(zc,Hc)=>{2===Hc.WL&&0===Hc.errorCode&&(this.Ttd=Hc.Dt,this.npc=this.now,h.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};
this.vT=wb;this.Ha=wa;this.vT.AAa(this.SMj);this.pvg=this.Ha.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get Noj(){return this.npc?this.now.getTime()-this.npc.getTime()>=this.pvg:!0}zR(wa){var wb=this.vT.zR(wa);2===wa&&this.Moj(wb.errorCode)&&(wa=this.Ttd,null!=wa?(this.Noj&&this.vT.D5a(null,null),wb=this.toDateString(this.now),wb=this.toDateString(this.Ctd)===wb?this.htd(5,this.vT.Zoc):this.htd(0,wa)):(Fb.uaa&&(wb=this.htd(5,this.vT.Zoc)),this.Ctd=this.now,
this.vT.D5a(null,null)));return wb}htd(wa,wb){var zc=void 0===zc?null:zc;return Object.assign(new Z(wa),{Dt:wb,failure:zc})}toDateString(wa){return wa.toISOString().substring(2,16)}get Ctd(){const wa=Fb.H9a(this.ztb,this.qbf);return null!==wa?new Date(wa):new Date(0)}set Ctd(wa){Fb.DQa(this.ztb,wa.toISOString(),this.qbf)}get npc(){const wa=Fb.H9a(this.ztb,this.Ybf);return null!==wa?new Date(wa):new Date(0)}set npc(wa){Fb.DQa(this.ztb,wa.toISOString(),this.Ybf)}get Ttd(){const wa=Fb.H9a(this.ztb,this.n5e);
let wb=null;wa&&(wb=JSON.parse(wa));return wb}set Ttd(wa){wa=JSON.stringify(wa);Fb.DQa(this.ztb,wa,this.n5e)}get now(){return new Date}Moj(wa){return 2!==wa&&4!==wa}TI(wa,wb){return this.vT.TI(wa,void 0===wb?null:wb)}getUpgradedAddinsOfOmex(){return this.vT.getUpgradedAddinsOfOmex()}AAa(wa){this.vT.AAa(wa)}get name(){return"AddinDetailsCacheManager"}Hub(wa,wb){this.vT.Hub(wa,wb)}pG(wa,wb){this.vT.pG(wa,void 0===wb?!1:wb)}static H9a(wa,wb){let zc=null;try{const Hc=Fb.h$b;if(void 0!==Hc&&Hc){const ed=
ba.a.Nkb(wa)+"_"+wb;zc=Hc.getItem(ed)}else h.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(Hc){h.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",wa,wb)}return zc}static DQa(wa,wb,zc){try{const Hc=Fb.h$b;if(void 0!==Hc&&Hc){const ed=ba.a.Nkb(wa)+"_"+zc;Hc.setItem(ed,wb)}else h.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(Hc){h.ULS.sendTraceTag(508352216,
220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",wa,zc)}}static get h$b(){if(!Fb.uaa)return null;let wa=null;try{wa=localStorage}catch(wb){Fb.uaa=!1,wa=null,h.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${wb.name}; message: ${wb.message}; stack: ${wb.stack}`)}return wa}}Fb.uaa=!0;Object(c.a)(Fb,"AddinDetailsCacheManager",null,[803]);class bb{static createInstance(wa,wb,zc){zc=void 0===zc?null:zc;wa=bb.oFh(wa)?new Fb(wa,new xa(wa,wb,zc)):new da(wa,wb,zc);
h.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${wa.name}`);return wa}static oFh(wa){return(wa||v.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(c.a)(bb,"AddinDetailsManagerFactory",null,[]);var Ja=a(1050),mb=a(605),sa=a(1453),oa=a(1559),cb=a(1161),Ka=a(42),Oa=a(182),gb=a(1454),bc=a(138),Dc=a(181),ad=a(126),Ac=a(94),mc=a(768),Gb=a(153),Ba=a(355),Xb=a(142),Ab=a(598),
Db=a(183),xc=a(40),vc=a(1113),zb=a(1389),tb=a(1117),ab=a(78);class La{constructor(){this.command=0;this.properties=null}}Object(c.a)(La,"DdaRequestInfo",null,[]);var pb=a(947),ia=a(65);class kb extends ab.a{constructor(wa,wb){super();this.requests=[];this.disposed=this.Xpc=!1;this.Rl=()=>{if(!this.disposed){this.grid.Fh.qx(this.Rl);this.Xpc=!1;const zc=this.requests;this.requests=[];for(const Hc of zc)this.ddaFacade.TU(Hc.command,Hc.properties)}};this.ddaFacade=wa;this.grid=wb}Pci(wa,wb){this.disposed||
(this.Xpc||(this.grid.Fh.jy(this.Rl),this.Xpc=!0),this.requests.push(Object(b.a)(new La,{command:wa,properties:wb})))}dispose(){if(!this.disposed){this.disposed=!0;this.Xpc&&this.grid.Fh.qx(this.Rl);var wa=this.requests;this.requests=null;for(const wb of wa)(wa=wb.properties?wb.properties[ia.a.wfa]:null)&&this.ddaFacade.lo(pb.a.OUb,wa);this.ddaFacade=this.grid=null;super.dispose()}}static FZh(wa,wb){var zc=!1;974713501===wa&&(wb=(wa=wb?wb[ia.a.Wk]:null)?wa.DdaMethod:null)&&wb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(zc=wa.ArrayData,zc=!!zc&&64===(zc[6]&64));return zc}}Object(c.a)(kb,"DdaCellEditDelayRequestHandler",ab.a,[]);var fb=a(984);class hb extends fb.a{constructor(wa,wb,zc,Hc,ed,rd,ve){super(wa,wb,zc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Hc;this.messageContent=ed;this.messageOrigin=rd;this.targetOrigin=ve}}Object(c.a)(hb,"DialogMessageReceivedEventArgs",fb.a,[]);class Jb extends fb.a{constructor(wa,wb,zc,Hc,ed,rd,ve){super(wa,wb,zc);this.messageType=
0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Hc;this.messageContent=ed;this.messageOrigin=rd;this.targetOrigin=ve}}Object(c.a)(Jb,"DialogParentMessageReceivedEventArgs",fb.a,[]);var ub=a(1),nb=a(23);class Aa{constructor(wa){this.Dl=this.Tqd=null;this.pWj=(wb,zc)=>{this.handlers.kh(zc.controlId)&&(wb=new hb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,zc.controlId,null,zc.messageType,zc.messageContent,zc.messageOrigin,zc.targetOrigin),this.handlers.na(zc.controlId)(wb),
zc.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(zc.controlId))};this.oWj=(wb,zc)=>{this.RMc.kh(zc.controlId)&&(wb=new Jb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,zc.controlId,null,zc.messageType,zc.messageContent,zc.messageOrigin,zc.targetOrigin),this.RMc.na(zc.controlId)(wb))};this.handlers=new O.a;this.RMc=new O.a;this.iq=wa;this.uib.JDh(this.pWj);this.uib.IDh(this.oWj)}get uib(){this.Tqd||(this.Tqd=J.getInstance(this.contextActivationMgr));return this.Tqd}get contextActivationMgr(){!this.Dl&&
this.iq&&(this.Dl=this.iq.Dl);return this.Dl}addHandler(wa,wb,zc,Hc){h.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const ed=rd=>{rd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ga(wa,wb),this.iq.zE(zc)):(h.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.iq.lo(rd,zc))};this.handlers.kh(wa)?ed(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(wa,Hc,ed)}Kyh(wa,wb,zc){h.ULS.sendTraceTag(537170500,
0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.RMc.ga(wa,wb);this.iq.zE(zc)}removeHandler(wa,wb){this.handlers.kh(wa)?(h.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.uib.OWa(wa,zc=>{this.handlers.remove(wa);zc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.iq.zE(wb):(h.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.iq.lo(zc,wb))})):this.iq.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
wb)}skk(wa,wb){h.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.RMc.remove(wa);this.iq.zE(wb)}showDialog(wa,wb,zc){try{ub.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&nb.f(this.iq.$).isEditing&&nb.f(this.iq.$).Pz(!0),this.uib.showDialog(wb,wa,zc,Hc=>{this.iq.dzh(this.DQh(Hc))})}catch(Hc){h.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Hc.message}`),zc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}DQh(wa){const wb=
{};wb.InstanceId=wa.id;wb.WebExtensionType=wa.osfControlType===OSF.OsfControlTarget.InContent?0:1;wb.PrimaryMarketplace={};wb.PrimaryMarketplace.SolutionId=wa.solutionId;wb.PrimaryMarketplace.SolutionVersion=wa.version;wb.PrimaryMarketplace.MarketplaceRef=wa.storeId;wb.PrimaryMarketplace.MarketplaceType=wa.storeType;wb.OwnerAddinSolutionId=wa.ownerAddinSolutionId;wb.OwnerAddinStoreType=wa.ownerAddinStoreType;return wb}static Ba(wa){if(!wa.$.la.lh(232)){const wb=new Aa(wa);wa.$.la.Hh(232,wb)}}}Object(c.a)(Aa,
"DialogMessageReceivedEventManager",null,[908]);class ra{constructor(wa,wb){this.uK=null;this.dsa=wa;this.Zth=wb}omc(wa){wa&&(this.uK||(this.uK=[]),this.uK.push(wa))}IUc(wa){this.uK&&Array.remove(this.uK,wa)}get eventId(){return this.dsa}get targetId(){return this.Zth}get c6i(){return 0<this.uK.length}vEj(wa){return this.eventId!==wa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===wa.ddaBinding.Name:
!0}Bpc(wa){this.uK&&Array.forEach(this.uK,wb=>{wb(wa)})}tOa(){this.uK=[]}}Object(c.a)(ra,"DdaEventRegistration",null,[]);class vb{constructor(wa){this.PO=null;this.GKa=!1;this.Jj=()=>{this.PO.forEach(wb=>{wb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&wb.Bpc(new fb.a(wb.eventId,"",null))})};this.iq=wa}invokeDdaMethod(wa,wb){const zc={};zc[ia.a.Wk]=wa;zc[ia.a.wfa]=wb;this.iq.TU(974713501,zc)}registerDdaEventAsync(wa,wb,zc,Hc,ed){vb.PVb(wa)?(vb.GVd(wa)&&this.MRd(),this.PO||(this.PO=
[]),wb=this.EPb(wa,zc),wb||(wb=new ra(wa,zc),this.PO.push(wb)),wb.omc(Hc),this.iq.zE(ed)):this.iq.lo(-1,ed)}unregisterDdaEventAsync(wa,wb,zc,Hc,ed){vb.PVb(wa)?((wa=this.EPb(wa,zc))&&wa.IUc(Hc),this.iq.zE(ed)):this.iq.lo(-1,ed)}MRd(){this.GKa||(nb.f(this.iq.$).ha.R9(this.Jj),this.GKa=!0)}EPb(wa,wb){if(!this.PO)return null;for(let zc=0;zc<this.PO.length;zc++){const Hc=this.PO[zc];if(Hc.eventId===wa&&Hc.targetId===wb)return Hc}return null}static PVb(wa){return wa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static GVd(wa){return wa===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(vb,"EmbeddingPage",null,[850]);var rb=a(233);class Nb extends fb.a{constructor(wa,wb,zc,Hc,ed,rd,ve,Le){super(wa,wb,zc);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=rd-Hc.Reference.FirstColumn;this.columnCount=Le;wa=Math.max(ed,Hc.Reference.FirstRow);ed=Math.min(ed+ve-1,Hc.Reference.LastRow);wa>ed?this.startRow=this.rowCount=void 0:(this.startRow=wa-Hc.Reference.FirstRow,this.rowCount=ed-wa+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(Nb,"DdaBindingSelectionEventArgs",fb.a,[]);var Qc=a(212),jd=a(27),xd=a(46),ae=a(486),Sd=a(39),fc=a(662),uc=a(322),hc=a(60),Ec=a(83),yd=a(16),Ad=a(13),$b=a(103),Ob=a(91),Yc=a(95),zd=a(5),Dd=a(358),oc=a(216),$c=a(427);a(1111);class yb extends rb.a{constructor(wa,wb,zc,Hc,ed){ed=void 0===ed?!1:ed;super();this.swb=0;this.PO=null;this.GKa=!1;this.mSc=null;this.P4=0;this.Gtc=this.zab=this.QJe=this.sHe=null;this.bgc=this.vPe=!1;this.Igd=this.mqa=this.jCe=null;this.Jj=()=>{this.enabled&&(this.Zzk(),
this.mSc=xd.d(nb.f(this.$).ha.qa.selectedRanges))};this.TOf=rd=>{rd.controlId===this.Kj.InstanceId&&Array.forEach(this.PO,ve=>{ve.vEj(rd)&&ve.Bpc(rd)})};this.Sgg=rd=>{rd=Object(Gb.a)(577,rd);if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8220021_ExcludingMisMatchingPaneAndData")&&null!=(null===rd||void 0===rd?void 0:rd.Xm)&&(null===rd||void 0===rd?void 0:rd.Xm.InstanceId)!==this.Kj.InstanceId)h.ULS.sendTraceTag(508302915,220,15,"InstanceIds mismatching for webExtensionPane and webExtensionData.");
else if(rd&&!rd.f6())if(!this.Kj||OSF.OsfControl.isFirstPartyStoreString(this.Kj.PrimaryMarketplace.MarketplaceType)||this.$.b4){rd.Xm=this.Kj;rd.ut=this.iq;this.jCe=rd;this.pYc(rd.pIb);const ve=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Ad.HelperMethods.XF(this.Kj)&&this.Kj.Preload&&!this.Kj.TaskpaneVisible;ve?rd.h$d():ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(rd.h$d(),(this.Kj.SharedRuntime&&1===this.Kj.SharedRuntime.LifeTime||
this.Kj.SharedRuntimeId)&&!this.Kj.TaskpaneVisible&&rd.eF(!1)):((this.Kj.SharedRuntime&&1===this.Kj.SharedRuntime.LifeTime||this.Kj.SharedRuntimeId)&&!this.Kj.TaskpaneVisible&&rd.eF(!1),rd.h$d());this.nnb||ve||rd.DS();this.$.la.lh(77).LEg(this.Sgg);this.wla=Object(Gb.a)(594,rd)}else h.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(rd,ve)=>{3===ve.control.floatingObject.type&&ve.control.floatingObject.io.InstanceId===this.fda.WebExtensionId&&
(this.wla=Object(Gb.a)(594,ve.control),this.pYc(ve.control.Uj.firstChild),$b.a(this.$).zUc(this.onFloatingObjectControlAdded))};this.th=wa.$;this.webExtensionView=Hc;this.iq=wa;this.Kj=zc;this.Kj.InstanceId=zc.SrcLocationOverrideResourceId?wa.eJa(zc.InstanceId,zc.SrcLocationOverrideResourceId):zc.InstanceId;this.ao=wb;this.fda={};this.fda.WebExtensionId=zc.InstanceId;this.qtg="osfControl_"+zc.InstanceId;this.MBd="disabled_"+zc.InstanceId;this.fda.BindingData=zc.BindingData;this.nnb=this.iq.nnb(zc.InstanceId);
this.FFc=this.iq.FFc(zc.InstanceId);this.kUe=zc.WebExtensionOsfControlType;this.Ywg=ed}get controlId(){return this.Kj.InstanceId}get L_f(){return this.bgc}bdj(wa){this.mqa||(this.mqa=wa)}tEg(){this.mqa&&(this.mqa.dispose(),this.mqa=null)}get controlType(){return this.Kj.WebExtensionType}get ownerAddinSolutionId(){return this.Kj.OwnerAddinSolutionId}get $(){return this.th}get enabled(){return!this.P4}get visible(){return this.Kj.TaskpaneVisible}get lG(){return this.Igd}get HX(){return this.Kj.SrcLocationOverrideResourceId?
this.iq.eJa(this.Kj.PrimaryMarketplace.SolutionId,this.Kj.SrcLocationOverrideResourceId):this.Kj.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Kj.SrcLocationOverrideResourceId}get io(){return this.Kj}get wla(){return this.sHe}set wla(wa){this.sHe=wa}get osfControlType(){return this.kUe}get GHa(){return this.QJe}set GHa(wa){this.QJe=wa}get Ftc(){return this.zab}set Ftc(wa){this.zab=wa}get focusOnIframeWhenLoaded(){return this.Kj.FocusOnIframeWhenLoaded}get iIc(){return this.vPe}set iIc(wa){this.vPe=
wa}bTd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Kj.PrimaryMarketplace.MarketplaceType)&&ub.EwaSettings.Ra(174)){const wb=Object(Ob.d)(Yc.a.resolve(zd.C,{va:0}));Sd.TaskExtensions.Xa(wb,()=>{wb.result.Mm(36,null)},this.ya,3);return this}if(1===this.Kj.WebExtensionType)Sd.TaskExtensions.Xa(ae.a(this.$),wb=>{wb.result.Jsc(this.$.la,77,5,this.Sgg,1)},this.ya,3);else{var wa=this.Jzf();const wb=$b.a(this.$);wa||(wa={Type:3},wa.Id=this.fda.WebExtensionId,wa.WebExtensionData=this.Kj,wa.ContentHtml=
"<div/>",wa.Version=0,wa.AbsoluteLeft=0,wa.AbsoluteTop=0,wa.AbsoluteRight=0,wa.AbsoluteBottom=0,wa.Width=0,wa.Height=0,wa.ZOrder=0,wa.OriginDeltaX=0,wa.OriginDeltaY=0,wa=new Qc.a(wa),wb.wsc(wa,null),wa=wb.Ox(wa.rn()));wa?(this.pYc(wa.Uj.firstChild),this.wla=Object(Gb.a)(594,wa)):wb.emc(this.onFloatingObjectControlAdded)}return this}BUf(wa){this.pYc(wa);return this}vOc(){this.Ywg||this.iq.Dl.purgeOsfControl(this.controlId,!1);if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")&&
this.$.isEditMode||!ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")){const wb=this.$.pa.ta.Wh();$c.a(this.$.userOperationManager,(zc,Hc,ed)=>Dd.e(this.$.pa.ta,this.Kj.InstanceId,zc,Hc,ed,wb),zc=>new oc.a(606,0,zc,64),null)}this.V3g(!0);const wa=this.Jzf();wa&&$b.a(this.$).deleteFloatingObject(wa);this.iq.Xn.Xjk(this.controlId);this.iq.Xn.ftf(this.controlId,!0);this.Igd=null}t$d(wa){this.fda=wa}invokeDdaMethod(wa,wb){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled){var zc={};zc[ia.a.Wk]=wa;zc[ia.a.wfa]=wb;this.iq.TU(974713501,zc)}else this.iq.lo(pb.a.OUb,wb)}ehk(wa,wb,zc,Hc){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!yb.Ahi(wa)||void 0!==wb&&null!==wb&&void 0!==this.Ujb(wb)&&null!==this.Ujb(wb))if(h.ULS.sendTraceTag(36444195,0,50,`eventId: ${wa}, targetId: ${wb}`),yb.wYf(wa)&&this.n8i(),yb.GVd(wa)&&this.MRd(),yb.uYf(wa))this.bgc=!0,this.iq.$.la.lh(232).addHandler(this.controlId,zc,Hc,wb);else if(yb.vYf(wa))this.bgc=
!0,this.iq.$.la.lh(232).Kyh(this.controlId,zc,Hc);else{yb.tYf(wa)&&this.WOf(-1777565636,Hc);this.PO||(this.PO=[]);var ed=this.EPb(wa,wb);ed||(ed=new ra(wa,wb),this.PO.push(ed));ed.tOa();ed.omc(zc);this.iq.zE(Hc);wa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.zab&&(this.Gtc=zc)}else this.iq.lo(3002,Hc);else this.iq.lo(-1,Hc)}T4k(wa,wb,zc,Hc){yb.uYf(wa)?(this.iq.$.la.lh(232).removeHandler(this.controlId,Hc),ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)&&
(this.bgc=!1)):yb.vYf(wa)?this.iq.$.la.lh(232).skk(this.controlId,Hc):(yb.tYf(wa)&&this.WOf(1592314317,Hc),wb=this.EPb(wa,wb),this.enabled?(wb&&(wb.IUc(zc),wb.c6i||Array.remove(this.PO,wb),this.PO.length?yb.wYf(wa)&&this.W3g(!1):this.V3g(!1)),this.iq.zE(Hc)):this.iq.lo(-1,Hc))}Ba(wa){yd.DOMElementExtensions.getElementById(wa,this.qtg)||wa.appendChild(yd.DOMElementExtensions.$m(this.lG))}showHide(wa){yd.DOMElementExtensions.setVisible(this.lG,wa)}resize(wa,wb){yd.DOMElementExtensions.BG(this.lG,wa);
yd.DOMElementExtensions.qT(this.lG,wb)}Gpf(wa){if(!this.P4&&!yd.DOMElementExtensions.getElementById(this.lG,this.MBd)&&this.lG){const wb=document.createElement("div");wb.id=this.MBd;wb.className="ewa-wx-disabled-div";wb.style.backgroundImage="url("+hc.a.current.Nu(102)+")";wb.style.opacity=wa?"1":"0";wb.style.backgroundRepeat="no-repeat";wb.style.backgroundPosition="center";this.lG.insertBefore(wb,this.lG.firstChild)}this.P4++}Gki(){0<this.P4&&this.P4--;this.P4||(yd.DOMElementExtensions.$m(yd.DOMElementExtensions.getElementById(this.lG,
this.MBd)),this.GKa&&!xd.X(this.mSc,nb.f(this.$).ha.qa.selectedRanges)&&this.Jj(null,null))}Ujb(wa){if(!this.fda||!this.fda.BindingData)return null;for(let wb=0;wb<this.fda.BindingData.length;wb++)if(this.fda.BindingData[wb].Name===wa)return this.fda.BindingData[wb];return null}getDefaultIconUrl(){const wa=this.VJf();return wa?wa.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Kj.TaskpaneTitle)return this.Kj.TaskpaneTitle;const wa=this.VJf();return wa?wa.getDefaultDisplayName():null}dyg(){if(this.zab&&
this.Gtc){const wa=new fb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.zab);this.Gtc(wa);this.Gtc=this.zab=null}}eF(wa){this.jCe&&this.jCe.eF(wa)}pCk(){this.$.ea.isNamedObjectViewMode&&this.cpj()&&(zd.Ug.Aa()?this.webExtensionView.zOg(this.lG):tb.a(this.$).zOg(this.lG),this.showHide(!1));if(this.iq.Vdl){if(!this.Ywg){const wa={};wa.div=this.lG;wa.id=this.Kj.InstanceId;wa.solutionId=this.Kj.PrimaryMarketplace.SolutionId;wa.version=this.Kj.PrimaryMarketplace.SolutionVersion;
wa.storeId=this.Kj.PrimaryMarketplace.MarketplaceRef;wa.storeType=this.Kj.PrimaryMarketplace.MarketplaceType;wa.ownerAddinSolutionId=this.Kj.OwnerAddinSolutionId;wa.ownerAddinStoreType=this.Kj.OwnerAddinStoreType;this.Kj.AssetMarketplace?(wa.assetId=this.Kj.AssetMarketplace.SolutionId,wa.assetStoreId=this.Kj.AssetMarketplace.MarketplaceRef):(wa.assetId=null,wa.assetStoreId=null);wa.settings=this.Kj.OsfPropertyBag;wa.hostSettings=this.Kj.HostPropertyBag;ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
wa.reason=this.nnb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.FFc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:wa.reason=this.nnb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;wa.osfControlType=0===this.Kj.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;wa.isForUILessAction=4===
this.Kj.WebExtensionOsfControlType;wa.sourceLocationOverrideResourceId=this.Kj.SrcLocationOverrideResourceId;wa.focusOnIframeWhenLoaded=this.Kj.FocusOnIframeWhenLoaded;fc.a(this.Kj)&&(wa.featureGates=v.AFrameworkApplication.fa.NGf(wa.solutionId));wa.hostInfoFlags=0;this.GHa&&(wa.hostInfoFlags|=2);Ad.HelperMethods.XF(this.Kj)&&(wa.hostInfoFlags|=1);this.$.b4||(h.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),wa.hostInfoFlags|=4);ub.EwaSettings.Ra(553)&&(wa.hostInfoFlags|=
8);wa.sharedRuntimeId=this.Kj.SharedRuntime?this.Kj.SharedRuntime.Resid:this.Kj.SharedRuntimeId;!Ad.HelperMethods.XF(this.Kj)||this.Kj.Preload||fc.a(this.Kj)||this.iq.Dl.getOsfControl(a(939).DdaFacade.getSolutionId(this.Kj,this.$))||(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.iq.$rg(this.Kj):this.iq.$rg(this.Kj));wa.onExtensionLaunchCallback=this.Kj.OnExtensionLaunchCallback;wa.initialDisplayMode=this.Kj.TaskpaneVisible?2:1;ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&
(wa.titleOverride=this.io.TaskpaneTitle);this.iq.Dl.insertOsfControl(wa)}this.P4=0}else this.Gpf(!0)}V3g(wa){this.W3g(wa);this.A4k()}n8i(){this.swb||this.ao.omc(this.TOf);this.swb++}W3g(wa){0<this.swb&&(wa?this.swb=0:this.swb--,this.swb||this.ao.IUc(this.TOf))}MRd(){if(!this.GKa){const wa=nb.f(this.$).ha;this.mSc=xd.d(nb.f(this.$).ha.qa.selectedRanges);wa.R9(this.Jj);this.GKa=!0}}A4k(){this.GKa&&(nb.f(this.$).ha.hca(this.Jj),this.GKa=!1)}Oyk(wa){var wb=new jd.Range(wa.Reference.FirstRow+1,wa.Reference.FirstColumn+
1,wa.Reference.LastRow+1,wa.Reference.LastColumn+1,!1,!1);1===wa.BindingType&&(wa.HasHeaders&&--wb.top,wa.HasTotals&&(wb.bottom+=1));var zc=nb.f(this.$).ha.qa.selectedRanges;wa=wb.enb(this.mSc);zc=wb.enb(zc);return(wb=wb.Hk(nb.f(this.$).ha.qa.activeRange))&&(uc.a(wa)&&!uc.a(zc)||!uc.a(wa)&&!uc.a(zc)&&!xd.X(wa,zc))?wb:null}Zzk(){Array.forEach(this.PO,wa=>{if(wa.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&wa.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.iq.Xn.Mnc(this.controlId))if(wa.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)wa.Bpc(new fb.a(wa.eventId,this.controlId,null));else if(wa.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const wb=this.Ujb(wa.targetId);if((null===wb||void 0===wb?0:wb.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Yh.ma.sheetName:this.$.sa.ma.name)===wb.Reference.SheetName){const zc=this.Oyk(wb);zc&&wa.Bpc(new Nb(wa.eventId,this.controlId,this.iq.voc(wb),wb,zc.top-1,zc.left-1,zc.height,zc.width))}}})}EPb(wa,wb){if(!this.PO)return null;
for(let zc=0;zc<this.PO.length;zc++){const Hc=this.PO[zc];if(Hc.eventId===wa&&Hc.targetId===wb)return Hc}return null}Jzf(){const wa=$b.a(this.$).x0;for(let wb=wa.length-1;0<=wb;--wb){const zc=wa[wb];if(3===zc.floatingObject.type&&zc.floatingObject.io.InstanceId===this.fda.WebExtensionId)return zc}return null}cpj(){for(let wa=0;wa<this.$.Yh.count;wa++)if(this.$.Yh.getItem(wa).imageId===this.fda.WebExtensionId)return!0;return!1}pYc(wa){this.Igd=wa;this.lG.id=this.qtg;this.lG.className="ewa-wx-container-div";
this.lG.dir=this.$.isChromeRtl?"rtl":"ltr";this.pCk()}VJf(){if(!this.enabled)return null;const wa=fc.a(this.io)?"":this.io.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.io.PrimaryMarketplace.SolutionId,wa)}WOf(wa,wb){try{if(h.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.kUe)this.iq.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,wb);else{const zc={};zc[ba.a.kIb]=this.controlId;const Hc=new Ec.a(wa,
0,this.$.isEditMode?2:1,0,null);this.$.Ma.qh(Hc,zc);this.iq.zE(wb)}}catch(zc){h.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${zc.message}.`),this.iq.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,wb)}}static Ahi(wa){return wa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||wa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static wYf(wa){return wa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||wa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||
wa===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static GVd(wa){return wa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||wa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static uYf(wa){return wa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static vYf(wa){return wa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static tYf(wa){return wa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(yb,"OsfControl",rb.a,[880]);class qb{constructor(){this.Beb=
{}}add(wa){this.Beb[wa]=!0}remove(wa){delete this.Beb[wa]}clear(){for(const wa of Object.keys(this.Beb))delete this.Beb[wa]}vQf(){return 0<Object.keys(this.Beb).length}SDi(){return Object.keys(this.Beb)}}Object(c.a)(qb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Cb=a(61);class gc{constructor(wa,wb,zc){this.ZCg=this.YCg=0;this.L7b=this.Stb=null;this.mOj=()=>{var Hc=nb.f(this.$).ha.$e.sK;if(this.eVd(Hc)&&(Hc=this.VQb(Hc))){var ed={};ed.chartId=Hc;ed.worksheetId=this.Nwa();
ed=Cb.a.Ci(ed);this.pwa(51,Hc,ed);this.pwa(51,this.Nwa(),ed)}};this.nOj=()=>{if(this.Stb){var Hc={};Hc.chartId=this.Stb;Hc.worksheetId=this.L7b;Hc=Cb.a.Ci(Hc);this.pwa(52,this.Stb,Hc);this.pwa(52,this.L7b,Hc)}Hc=nb.f(this.$).ha.$e.sK;this.eVd(Hc)?(this.Stb=this.VQb(Hc),this.L7b=this.Nwa()):this.L7b=this.Stb=null};this.$=wa;this.Xn=wb;this.ao=zc}hJb(wa){51===wa.messageType?this.YCg=this.IVa(wa.actionType,this.YCg,this.mOj):52===wa.messageType&&(this.ZCg=this.IVa(wa.actionType,this.ZCg,this.nOj))}IVa(wa,
wb,zc){if(1===wa)wb||nb.f(this.$).ha.$e.Hod(zc),wb++,this.vGk();else if(2===wa){if(1>wb)return wb;1===wb&&nb.f(this.$).ha.$e.Lie(zc);wb--}return wb}pwa(wa,wb,zc){wb&&this.Xn.WR(wa,wb)&&this.ao.CM(wa,wb,zc)}VQb(wa){return wa&&wa.floatingObject?(wa=wa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===wa.length?wa[0]:null:null}Nwa(){const wa=this.$.sa.ma;return wa&&0===wa.yG?wa.sheetId:null}vGk(){const wa=nb.f(this.$).ha.$e.sK;this.eVd(wa)&&(this.Stb=this.VQb(wa),this.L7b=
this.Nwa())}eVd(wa){return!!wa&&!!wa.floatingObject&&0===wa.floatingObject.type}}Object(c.a)(gc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Mc=a(948),bd=a(200),Id=a(727),Vd=a(118),ce=a(67);class ee extends ab.a{constructor(wa,wb,zc){super();this.P4=this.sOa=0;this.Jj=(Hc,ed)=>{if(this.enabled&&!(this.T_f()||null!==ed&&void 0!==ed&&ed.A3f)&&(Hc=Object(Gb.a)(Vd.a,this.$.sa.ma))&&0===Hc.yG){const rd=Hc.sheetId,ve=this.KFf();let Le=null,Qe=null;this.Xn.q3f()&&(Le=this.grid.oh.Kl(this.grid.ha.qa.activeCell),
Qe=rd in this.pKc?this.pKc[rd]:null);this.O8e(rd,ve)&&Sd.TaskExtensions.Xa(ce.Task.Ua(!0),()=>{this.A5i(rd,ve);this.k5i(rd,ve,Le,Qe)},this.ya);this.Nqf(rd,ve,Le)}};this.$=wa;this.Xn=wb;this.ao=zc;this.grid=nb.f(wa);this.F2a={};this.pKc={}}get enabled(){return!this.P4&&0<this.sOa}goc(wa){1===wa.actionType?(this.sOa||this.grid.ha.R9(this.Jj),this.sOa++):2!==wa.actionType||1>this.sOa||(1===this.sOa&&this.grid.ha.hca(this.Jj),this.sOa--)}$Xc(wa){wa?this.P4++:(0<this.P4&&this.P4--,this.P4||this.Jj(null,
new Id.a(!1)))}KFf(){return this.grid.ha.qa.selectedRanges}O8e(wa,wb){return ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!wa&&bd.e(this.F2a)||wa in this.F2a)&&!xd.X(this.F2a[wa],wb):wa in this.F2a&&!xd.X(this.F2a[wa],wb)}Nqf(wa,wb,zc){this.F2a[wa]=xd.d(wb);this.pKc[wa]=zc}T_f(){return this.grid.isEditing||this.grid.kq}cAf(wa,wb){this.Xn.WR(14,wa)&&this.ao.CM(14,wa,wb);this.Xn.WR(14,Mc.a.VV)&&this.ao.CM(14,Mc.a.VV,wb)}A5i(wa,wb){const zc=
{};zc.worksheetId=wa;zc.address=this.FNd(wb);wb=Cb.a.Ci(zc);this.cAf(wa,wb)}k5i(wa,wb,zc,Hc){if(this.Xn.q3f()){var ed="";let rd="";Hc&&(ed=Hc.Wq);zc&&(rd=zc.Wq);Hc?zc?(wb=zc.usedRange.enb(wb),ed!==rd&&this.hyc(ed,"",wa),this.hyc(rd,this.FNd(wb),wa)):this.hyc(ed,"",wa):zc&&(ed=zc.usedRange.enb(wb),this.hyc(rd,this.FNd(ed),wa))}}hyc(wa,wb,zc){if(this.Xn.WR(100,wa)){const Hc={};Hc.address=wb;Hc.worksheetId=zc;this.ao.CM(100,wa,Cb.a.Ci(Hc))}}FNd(wa){return xd.j(wa,",",this.$,!1)}dispose(){0<this.sOa&&
this.grid.ha.hca(this.Jj);this.pKc=this.F2a=null;this.sOa=0;this.ao=this.Xn=this.$=this.grid=null}}Object(c.a)(ee,"RichApiEventSelectionChangedHandler",ab.a,[]);var Je=a(392);class Ue extends ee{constructor(wa,wb,zc){super(wa,wb,zc);this.J5f=this.K5f=null}KFf(){return Je.a.Tsc(this.grid.ha.rangePicker.hZ)}O8e(wa,wb){return this.K5f!==wa||!xd.X(this.J5f,wb)}Nqf(wa,wb){this.K5f=wa;this.J5f=xd.d(wb)}T_f(){return!this.grid.isEditing&&!this.grid.kq}cAf(wa,wb){this.Xn.WR(2700,Mc.a.VV)&&this.ao.CM(2700,
Mc.a.VV,wb)}}Object(c.a)(Ue,"RichApiEventPickedRangesChangedHandler",ee,[]);class jc{constructor(wa,wb,zc){this.f6a=this.e6a=0;this.mWa=this.Hua=null;this.wkg=()=>{var Hc=nb.f(this.$).ha.$e.sK;if(0<this.f6a&&this.Hua&&this.mWa){var ed={};ed.shapeId=this.Hua;ed.worksheetId=this.mWa;ed=Cb.a.Ci(ed);this.fireEvent(2102,this.Hua,ed)}this.Vqj(Hc)?(this.Hua=this.Z2k(Hc),this.mWa=this.Nwa(),this.Hua&&this.mWa)?0<this.e6a&&(Hc={},Hc.shapeId=this.Hua,Hc.worksheetId=this.mWa,Hc=Cb.a.Ci(Hc),this.fireEvent(2101,
this.Hua,Hc)):h.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Hua}', or worksheet id: '${this.mWa}' from a Floating object or gridview.`):this.mWa=this.Hua=null};this.$=wa;this.Xn=wb;this.ao=zc}hJb(wa){const wb=nb.f(this.$).ha;1===wa.actionType?(this.e6a||this.f6a||wb.$e.Hod(this.wkg),2101===wa.messageType?this.e6a++:2102===wa.messageType&&this.f6a++):2===wa.actionType&&(2101===wa.messageType?this.e6a=0<this.e6a?this.e6a-1:0:2102===wa.messageType&&(this.f6a=
0<this.f6a?this.f6a-1:0),this.e6a||this.f6a||wb.$e.Lie(this.wkg))}Vqj(wa){return!!wa&&!!wa.floatingObject&&(0===wa.floatingObject.type||7===wa.floatingObject.type||1===wa.floatingObject.type||3===wa.floatingObject.type||5===wa.floatingObject.type)}Z2k(wa){if(!wa||!wa.floatingObject)return null;wa=wa.floatingObject.id;var wb=wa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));wb=wb&&1===wb.length?wb[0]:null;return wb?wb:(h.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${wa}', but we failed.`),
null)}Nwa(){const wa=this.$.sa.ma;return wa&&0===wa.yG?wa.sheetId:null}fireEvent(wa,wb,zc){wb&&this.Xn.WR(wa,wb)&&this.ao.CM(wa,wb,zc)}}Object(c.a)(jc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class tc{constructor(wa,wb,zc){this.cDg=this.bDg=this.dDg=this.aDg=0;this.n1j=(Hc,ed)=>{Hc=Object(Gb.a)(Vd.a,ed.ma);this.ppb(Hc)&&(ed={},ed.worksheetId=Hc.sheetId,ed=Cb.a.Ci(ed),this.pwa(11,Hc.sheetId,ed))};this.q1j=(Hc,ed)=>{Hc=Object(Gb.a)(Vd.a,ed.IB);this.ppb(Hc)&&(ed={},ed.worksheetId=Hc.sheetId,
ed=Cb.a.Ci(ed),this.pwa(12,Hc.sheetId,ed))};this.o1j=(Hc,ed)=>{Hc=Object(Gb.a)(Vd.a,ed.ma);this.ppb(Hc)&&(ed={},ed.worksheetId=Hc.sheetId,Hc=Cb.a.Ci(ed),this.pwa(11,null,Hc,!0))};this.p1j=(Hc,ed)=>{Hc=Object(Gb.a)(Vd.a,ed.IB);this.ppb(Hc)&&(ed={},ed.worksheetId=Hc.sheetId,Hc=Cb.a.Ci(ed),this.pwa(12,null,Hc,!0))};this.$=wa;this.Xn=wb;this.ao=zc}hJb(wa){11===wa.messageType?wa.targetId===Mc.a.VV?this.vKh(wa.actionType):this.uKh(wa.actionType):12===wa.messageType&&(wa.targetId===Mc.a.VV?this.wKh(wa.actionType):
this.xKh(wa.actionType))}uKh(wa){this.aDg=this.IVa(wa,this.aDg,this.n1j)}xKh(wa){this.dDg=this.IVa(wa,this.dDg,this.q1j)}vKh(wa){this.bDg=this.IVa(wa,this.bDg,this.o1j)}wKh(wa){this.cDg=this.IVa(wa,this.cDg,this.p1j)}IVa(wa,wb,zc){1===wa?wb=this.gJb(wb,zc):2===wa&&(wb=this.ANb(wb,zc));return wb}gJb(wa,wb){wa||this.$.sa.pn(wb);wa++;return wa}ANb(wa,wb){if(1>wa)return wa;1===wa&&this.$.sa.Gn(wb);wa--;return wa}ppb(wa){return!!wa&&0===wa.yG}pwa(wa,wb,zc,Hc){wb=(void 0===Hc?0:Hc)?Mc.a.VV:wb;this.Xn.WR(wa,
wb)&&this.ao.CM(wa,wb,zc)}}Object(c.a)(tc,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Kc=a(306),wd=a(17),Rb=a(290);class dc extends Sys.EventArgs{constructor(wa,wb,zc,Hc){super();this.sheet=wa;this.EUh=wb;this.offsetX=zc;this.offsetY=Hc}}Object(c.a)(dc,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class $a{constructor(wa,wb,zc){this.Nqc=null;this.d_d=!1;this.onPointerDown=Hc=>{if(3===Hc.Dh){const {Qgb:ed}=this.da.Azc(Hc.clientPoint);this.d_d=!!ed&&this.da.ha.qa.$qf(ed)}else this.d_d=
!1;this.Nqc=Hc.clientPoint;return!1};this.vj=Hc=>{if(this.da.inRangePicker||this.da.kq||this.d_d||Hc.shiftKey||Hc.ctrlKey||Hc.La.button!==Sys.UI.MouseButton.leftButton||!this.Nqc||!Hc.clientPoint||Hc.clientPoint.x!==this.Nqc.x||Hc.clientPoint.y!==this.Nqc.y)return!1;let ed;var rd=(()=>{let Le=this.da.Azc(Hc.clientPoint);({Qgb:ed}=Le);return Le})().returnValue;const ve=Object(Gb.a)(Vd.a,this.$.sa.ma);if(rd&&ve&&0===ve.yG){if(!this.da.ha.qa.daa.contains(ed))return!1;rd=new dc(ve,ed,Ad.HelperMethods.DRc(rd.x),
Ad.HelperMethods.DRc(rd.y));this.r1j(rd)}return!1};this.$=wa;this.da=nb.f(wa);this.Xn=wb;this.ao=zc;this.Jik()}dispose(){this.o5k()}Jik(){for(const wa of this.da.Uu){const wb=wa.domElement;Kc.a.instance.xa(wd.a.qj,wb,this.onPointerDown);Rb.a.instance.xa(wd.a.click,wb,this.vj)}}o5k(){for(const wa of this.da.Uu){const wb=wa.domElement;Kc.a.instance.Qa(wd.a.qj,wb,this.onPointerDown);Rb.a.instance.Qa(wd.a.click,wb,this.vj)}}r1j(wa){var wb=wa.sheet;if(this.ppb(wb)){var zc={};zc.worksheetId=wb.sheetId;
zc.address=wa.EUh.toString();zc.offsetX=wa.offsetX;zc.offsetY=wa.offsetY;wa=wb.sheetId;this.Xn.WR(21,wa)&&(wb=Cb.a.Ci(zc),this.ao.CM(21,wa,wb));wa=Mc.a.VV;this.Xn.WR(21,wa)&&(zc=Cb.a.Ci(zc),this.ao.CM(21,wa,zc))}}ppb(wa){return!!wa&&0===wa.yG}}Object(c.a)($a,"RichApiEventSingleClickedHandler",null,[]);class Wb{constructor(wa,wb,zc){this.d4b=0;this.Etb=this.Ptb=null;this.wsg=()=>{const Hc=nb.f(this.$).ha.$e.sK;if(Hc)if(this.n4f(Hc)){const ed=this.Nwa();this.UGd(ed);this.Ptb=Hc.floatingObject.id;this.Etb=
ed}else this.Ptb&&(this.UGd(this.Etb),this.Etb=this.Ptb=null);else this.Ptb&&(this.UGd(this.Etb),this.Etb=this.Ptb=null)};this.$=wa;this.Xn=wb;this.ao=zc}goc(wa){2E3===wa.messageType&&(1===wa.actionType?(this.d4b||nb.f(this.$).ha.$e.Hod(this.wsg),this.d4b++,this.xCk()):2===wa.actionType&&this.d4b&&(1===this.d4b&&nb.f(this.$).ha.$e.Lie(this.wsg),this.d4b--))}UGd(wa){var wb;const zc={};zc.worksheetId=wa;zc.revisionLoad=!1;if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")){const Hc=
nb.f(this.$).ha.$e.sK;(null===(wb=null===Hc||void 0===Hc?void 0:Hc.floatingObject)||void 0===wb?0:wb.Ti)?zc.selectedVisualId=Hc.floatingObject.Ti.VisualID:zc.selectedVisualId=null}wb=Cb.a.Ci(zc);wa&&this.Xn.WR(2E3,wa)&&this.ao.CM(2E3,wa,wb)}Nwa(){const wa=this.$.sa.ma;return wa&&0===wa.yG?wa.sheetId:null}xCk(){const wa=nb.f(this.$).ha.$e.sK;this.n4f(wa)&&(this.Ptb=wa.floatingObject.id,this.Etb=this.Nwa())}n4f(wa){return!!wa&&wa.M_d()}}Object(c.a)(Wb,"RichApiEventVisualSelectionChangedHandler",null,
[]);class rc{constructor(wa,wb,zc){this.e4b=0;this.D$g=!0;this.uyc=0;this.TYd=!0;this.Qef=()=>{const Hc=document.hasFocus();if(this.D$g!==Hc){if(Hc){const ed=Cb.a.Ci({});this.ao.CM(2203,Mc.a.VV,ed)}this.D$g=Hc}};this.Ref=Hc=>{(0<Hc.timeRemaining()||Hc.didTimeout)&&this.Qef();window.requestIdleCallback(this.Ref)};this.$=wa;this.Xn=wb;this.ao=zc;window.requestIdleCallback||(this.TYd=!1)}tKh(wa){1===wa.actionType?(this.e4b||this.IKh(),this.e4b++):2!==wa.actionType||1>this.e4b||(1===this.e4b&&this.gei(),
this.e4b--)}IKh(){if(this.Xn.WR(2203,Mc.a.VV))if(this.TYd){const wa={};wa.timeout=this.$.ua.CheckFocusTimeout;this.uyc=window.requestIdleCallback(this.Ref,wa)}else this.uyc=window.setInterval(this.Qef,this.$.ua.CheckFocusTimeInterval)}gei(){this.TYd?window.cancelIdleCallback(this.uyc):window.clearInterval(this.uyc)}}Object(c.a)(rc,"RichApiEventWorkbookActivatedHandler",null,[]);var xb;(function(wa){wa[wa.none=0]="none";wa[wa.registerEvent=1]="registerEvent";wa[wa.unregisterEvent=2]="unregisterEvent";
wa[wa.customFunction=3]="customFunction";wa[wa.showCard=4]="showCard";wa[wa.createWorkbook=5]="createWorkbook";wa[wa.openWorkbook=6]="openWorkbook";wa[wa.enableEvents=7]="enableEvents";wa[wa.closeWorkbook=8]="closeWorkbook";wa[wa.setCalculationMode=9]="setCalculationMode";wa[wa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";wa[wa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";wa[wa.workbookLinksEnableContent=12]="workbookLinksEnableContent";wa[wa.workbookLinksFindNextLink=
13]="workbookLinksFindNextLink";wa[wa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";wa[wa.rangePicker=15]="rangePicker";wa[wa.enableRichApiRecording=16]="enableRichApiRecording";wa[wa.recordAction=17]="recordAction";wa[wa.focus=18]="focus";wa[wa.businessBarShow=19]="businessBarShow";wa[wa.businessBarHide=20]="businessBarHide";wa[wa.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";wa[wa.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";wa[wa.showRangeValuesPreview=
23]="showRangeValuesPreview";wa[wa.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(xb||(xb={}));Object(c.b)("PostProcessActionType",xb);var ic=a(287);class Rc{constructor(wa,wb,zc,Hc){this.rtg=null;this.SGd=(ed,rd)=>{const ve=Mc.a.VV,Le={};Le.eventId=ed;Le.payload=rd;this.Xn.WR(2201,ve)&&this.ao.CM(2201,ve,Cb.a.Ci(Le))};this.$=wa;this.Xn=wb;this.ao=zc;this.ddaFacade=Hc;this.xcj()}sKh(wa){1===wa.actionType?(this.$.bha=!0,(zd.xb.Aa()?this.ddaFacade:Object(Gb.a)(a(939).DdaFacade,ic.a(this.$))).TGd(!0)):
2===wa.actionType&&(this.$.bha=!1);this.rtg=wa.controlId;h.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${xb[wa.actionType]}; controlId: ${this.rtg}; this.ewaControl.IsMacroRecorderListening: ${this.$.bha}.`)}fmi(wa){(zd.xb.Aa()?this.ddaFacade:Object(Gb.a)(a(939).DdaFacade,ic.a(this.$))).eAf(wa,this.$.bha)}xcj(){this.$.m6&&Sd.TaskExtensions.Xa(Object(Ob.d)(Yc.a.resolve(zd.Sd,{va:1})),wa=>{(wa=wa.result)&&wa.init(this.SGd)},this.$.ya,3)}}Object(c.a)(Rc,"RichApiMacroRecorderEventHandler",
null,[]);class Zc{}Object(c.a)(Zc,"StyleCacheItem",null,[]);class Kd{constructor(wa,wb,zc){this.$=wa;this.da=wb;this.xk=zc}uua(wa){this.range=wa;this.jrc=Array(wa.width);this.e0c=Array.from({length:wa.height},()=>Array(wa.width))}eCk(wa,wb,zc,Hc){this.q2f(wa,wb)&&(this.e0c[wa-this.range.top][wb-this.range.left]||(this.e0c[wa-this.range.top][wb-this.range.left]={backgroundColor:zc.backgroundColor}),zc.backgroundColor=Hc)}gCk(wa,wb,zc){if(this.q2f(wa,wb)){wa=jd.Range.vi(wa,wb);var Hc=this.da.zh(wa);
Hc&&(this.jrc[wb-this.range.left]||(this.jrc[wb-this.range.left]=Hc.width),wb=this.xk.gte(this.da,[wa],zc,!1),"Success"!==wb.kind&&h.ULS.sendTraceTag(508303323,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${wb.reason}.`))}}restore(){this.range&&(this.jrc.forEach((wa,wb)=>{wa=this.xk.gte(this.da,[jd.Range.vi(this.range.top,this.range.left+wb)],wa,!1);"Success"!==wa.kind&&h.ULS.sendTraceTag(508303322,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${wa.reason}`)}),
this.e0c.forEach((wa,wb)=>{wa.forEach((zc,Hc)=>{Hc=jd.Range.vi(this.range.top+wb,this.range.left+Hc);if(Hc=this.da.zh(Hc))Hc.cell.backgroundColor=zc.backgroundColor})}),this.jrc=this.e0c=this.range=void 0)}q2f(wa,wb){if(!this.range)return h.ULS.sendTraceTag(508303321,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(wa=this.range.contains(jd.Range.vi(wa,wb)))||h.ULS.sendTraceTag(508303320,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");
return wa}}Object(c.a)(Kd,"InstantaneousGridContentRestorer",null,[]);var fe=a(217),Ld=a(157);class Gd{constructor(wa,wb,zc,Hc){this.STi=ed=>{const rd=ed.mj.block;if(this.TC.Hk(rd.yj)){this.Lvg([rd.yj]);const ve=nb.f(this.$).zW(rd.yj),Le=()=>this.Dvg([rd.yj]);setTimeout(()=>{ve.skeletonMode?setTimeout(()=>{ve.skeletonMode?h.ULS.sendTraceTag(508303319,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time."):Le()},Gd.pdh):Le()},Gd.Feh)}};this.Uha=(ed,rd)=>
{0===rd.ox&&576!==rd.Ul.operation.operationName&&this.wmb(!0)};this.U$d=ed=>{this.TZc&&(this.axi(ed),this.tZ())};this.$=wa;this.Xn=wb;this.ao=zc;this.da=nb.f(this.$);this.hFc=new Kd(this.$,this.da,Hc)}Y4i(wa,wb,zc,Hc){this.C1f(wa)?(wb=this.ASh(wb,zc))?this.XE?h.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=wa,this.TC=wb,this.values=zc,this.k8(Hc)):h.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):
h.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}M2i(wa){this.C1f(wa)?this.wmb(!1):h.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}k8(wa){this.Lvg(this.lEf());wa&&(h.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(wa)}`),
wa.autoexpandTable&&this.FSh(),wa.autofitColumns&&this.SRh());this.TZc=this.da.mN.k8(this.TC,this.STi).then(wb=>{h.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.XE=wb;this.hFc.uua(this.TC);this.Dvg(this.lEf());this.$.userOperationManager.kw(this.Uha);wb.E5b.then(()=>this.U$d(!0),()=>this.U$d(!0));return Promise.resolve()},wb=>{h.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${wb}`);
this.tZ();return Promise.resolve()})}wmb(wa){this.TZc&&(h.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.TZc.then(()=>{const wb=this.XE;this.U$d(wa);wb&&wb.yaa("RichApiRangeValuesPreview")},()=>{h.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}ASh(wa,wb){wa=xd.jb(wa,this.$.sa);if(wa.returnValue)return new jd.Range(wa.range.top,wa.range.left,wa.range.top+wb.length-
1,wa.range.left+wb[0].length-1,!0,!0)}C1f(wa){const wb=this.$.sa.ma;return wb&&wa===wb.sheetId}Lvg(wa){this.VHd(wa,(wb,zc,Hc,ed)=>{ed.cell.BV=this.values[wb][zc];return!0})}Dvg(wa){this.JBa&&this.VHd(wa,(wb,zc,Hc,ed)=>{this.hFc.eCk(Hc.top,Hc.left,ed,this.uLi(Hc.top));return!0});if(this.wfb){const wb=this.TC.enb(wa);0<wb.length&&this.wfb&&this.wfb.forEach((zc,Hc)=>{this.hFc.gCk(wb[0].top,this.TC.left+Hc,zc)})}}VHd(wa,wb){for(let Hc=0;Hc<this.values.length;++Hc)for(let ed=0;ed<this.values[Hc].length;++ed){const rd=
jd.Range.vi(this.TC.top+Hc,this.TC.left+ed);if(!wa||wa.some(ve=>ve.contains(rd))){var zc=this.da.GD(rd);if((!zc||rd.equals(zc.topLeft))&&(zc=this.da.zh(rd))&&!wb(Hc,ed,rd,zc))return}}}lEf(){return this.da.za.nA().filter(wa=>wa.ma===this.$.ma).map(wa=>wa.yj)}axi(wa){this.Xn.WR(3400,this.worksheetId)&&(wa=Cb.a.Ci({type:"RangeValuesPreviewDismissed",source:"Local",Lml:wa}),this.ao.CM(3400,this.worksheetId,wa))}tZ(){this.$.userOperationManager.su(this.Uha);this.ttk();this.JBa=this.worksheetId=this.TZc=
this.values=this.TC=this.XE=void 0}FSh(){if(this.TC){var wa=this.ZXi(this.TC);if(wa){h.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var wb=(rd,ve)=>{var Le;return null===(Le=this.da.zh(jd.Range.vi(rd,ve)))||void 0===Le?void 0:Le.backgroundColor},zc=wa.usedRange.top;if(wa.attributes&16){var Hc=wb(wa.usedRange.top,wa.usedRange.left);++zc}var ed=wb(zc,wa.usedRange.left);wb=wb(zc+
1,wa.usedRange.left);this.JBa={s1g:wa.usedRange.top,jRd:Hc,d0k:ed,tNh:wb}}else h.ULS.sendTraceTag(508303318,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else h.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}SRh(){this.wfb=Array(this.TC.width);let wa=!1;this.VHd(void 0,(wb,zc,Hc,ed)=>{var rd;if(this.da.GD(Hc))return wa=!0,!1;wb=ed.cell;
wb=wb.Jif(wb.BV);wb>ed.width&&(this.wfb[zc]=Object(Ld.a)(null!==(rd=this.wfb[zc])&&void 0!==rd?rd:0,wb));return!0});wa&&(this.wfb=void 0)}ttk(){this.hFc.restore();xd.B(this.TC,(wa,wb)=>{wa=jd.Range.vi(wa,wb);if(wa=this.da.zh(wa))wa.cell.BV=void 0})}uLi(wa){return this.JBa.jRd&&wa===this.JBa.s1g?this.JBa.jRd:0===(wa-this.JBa.s1g-(this.JBa.jRd?1:0))%2?this.JBa.d0k:this.JBa.tNh}ZXi(wa){const wb=fe.b(this.da.$,wa,!0);if(!(1<wb.length)){var zc=ed=>{var rd;const ve=null!==(rd=this.da.oh.YXi(ed))&&void 0!==
rd?rd:this.da.oh.$Xi(ed);if(ve)return ve},Hc=zc(wa);if(Hc&&0===wb.length)return Hc;if(0!==wb.length&&(wa=xd.fb(wa,wb[0].usedRange),1===wa.length))return zc(wa[0])}}}Gd.Feh=20;Gd.pdh=100;Object(c.a)(Gd,"RichApiRangeValuesPreview",null,[]);class Zd{}Object(c.a)(Zd,"SessionRecreationInfo",null,[]);class Bc{constructor(wa,wb,zc){this.$=wa;this.Xn=wb;this.runtimeCalculationMode=zc}sJj(){return ub.EwaSettings.Ra(234)?this.Xn.p6i()||0!==this.runtimeCalculationMode:!1}QPh(){var wa={};wa.eventRegistrationInfos=
this.Xn.YKi();wa.runtimeCalculationMode=this.runtimeCalculationMode;wa=Object(b.a)(new Zd,{runtimeState:wa});const wb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};wb.RequestBody=JSON.stringify(wa);wb.RequestFlags=1;return wb}}Object(c.a)(Bc,"RichApiRuntimeStateHandler",null,[]);class Lc{constructor(wa,wb,zc,Hc,ed,rd,ve,Le,Qe){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=
this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=wa;this.processUtcTime=wb;this.dequeueUtcTime=zc;this.inQueueDurationInMS=Hc;this.executionDurationInMS=ed;this.operationCount=rd;this.ServerCorrelationId=ve;this.UserOperationName=Le;this.IsDocumentHidden=Qe}}Object(c.a)(Lc,"UserOperationQueueItemsStatisticsData",null,[]);var Cd=a(1259),Fd=a(73),te=a(255),ye=a(509),ue=a(64),De=a(77),Ke=a(25),pe=a(123),pf=a(58),qf=a(54),of=a(198),Ef=a(131),Nf=a(51),Kf=a(32),Qf=a(36),Hf=a(254),
If=a(28),ac=a(12),Yb=a(264),Cc=a(943),Of=a(62),Qb=a(1115),Ic=a(26),hd=a(924);class Ga{constructor(wa,wb,zc){this.MTc=0;this.$0e=new Set;this.X1f=!1;this.$=wa;this.Xn=wb;this.ao=zc}rKh(wa){1===wa.actionType?this.Xn.WR(65541,Mc.a.VV)?this.MTc++:h.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===wa.actionType&&0<this.MTc&&this.MTc--}dNj(wa,wb){if(0===this.MTc)h.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(wb){wa=wb.annotation;
var zc=[];zc.push({content:JSON.stringify(wb.annotation),annotationType:hd.a.getTypeNameFor(wa),id:wa.id});this.ao.CM(65541,Mc.a.VV,JSON.stringify({annotationProperties:zc}))}else h.ULS.sendTraceTag(509649752,0,10,"Event args are null")}w1i(wa){const wb=this;return Lo(function*(){if(!wb.Xn.WR(65541,Mc.a.VV))h.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!wb.$0e.has(wa.annotationType)){var zc=yield Yc.a.resolve(zd.p,{va:1});wb.X1f||(zc.register(zc.v5().b8("RichApi").a8(()=>{}).build()),
wb.X1f=!0);zc.$pa("RichApi",{annotationType:wa.annotationType,Jy:!1,uV:wb.dNj.bind(wb)});wb.$0e.add(wa.annotationType)}})}x1i(wa){return Lo(function*(){(yield Yc.a.resolve(zd.p,{va:1})).Zxb(JSON.parse(wa.content));h.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${wa.signalType}`)})}}Object(c.a)(Ga,"RichApiAugmentationLoopHandler",null,[]);var Ub=a(1051),yc=a(1406),kd=a(1405);Object(Yc.b)(zd.xb,{Ek:"singleton"})(wa=>Lo(function*(){h.ULS.sendTraceTag(507581071,0,50,"DdaFacade created");
if(v.AFrameworkApplication.disableWholeAppsForOfficeFeature)return h.ULS.sendTraceTag(507581070,0,50,`Not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${v.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`),null;const wb=yield Yc.a.resolve(zd.Nb,wa),zc=yield Yc.a.resolve(zd.j,wa),Hc=yield Yc.a.resolve(zd.xc,wa),ed=yield Yc.a.resolve(zd.Ug,wa);yield Object(Ob.a)(hc.a.n2d(65,()=>!(void 0===window.OSF||null===window.OSF),wb.ua.MaxRetriesForLoadingScript,wb.ya,wa.va));yield Object(Ob.a)(Ub.a(wb.ya,
wa.va));if(ub.EwaSettings.Ra(359)){const rd=yield(yield Object(Ob.e)(mb.a.oxe(Ka.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")))).isFeatureEnabled("mso_officeStore",!0),ve=yield Ka.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").AR("WACSideloadAddins");Nd.VLb=rd;Nd.JAe=ve}"undefined"!==typeof OfficeExt&&"undefined"!==typeof OSF&&(ub.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new kd.a),wb.uk.get(35)&&
OfficeExt.PrivateCatalogService.initRequestHandler(new kd.a,new yc.a(v.AFrameworkApplication.fa.appSettings.WebServiceBase),ub.EwaSettings.Ra(70),!0),OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new kd.a),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new kd.a));return new Nd(wb,zc,Hc,ed)}));class Nd extends xc.a{constructor(wa,wb,zc,Hc){super();this.ao=this.Cr=this.ea=null;this.Hl=[];this.rYa=null;this.disposed=this.initialized=
this.Bbc=this.Ymf=!1;this.SCa=null;this.JQc=[];this.Smf=[];this.X4a=[];this.fib=null;this.sce=new mc.a(C.a.zm());this.Gmc=new S.a(C.a.zm());this.r2b=[];this.Mug=[];this.sNb=350;this.ILa=this.T8=null;this.emd=!1;this.QWe=this.PWe=this.FWe=this.OWe=this.NWe=this.LWe=this.HWe=this.MWe=this.IWe=this.KWe=this.GWe=this.JWe=null;this.Tgh=3E3;this.W6c=!1;this.vT=this.KDb=null;this.fkd=!1;this.ggd=new S.a(C.a.zm());this.vgd=new S.a(C.a.zm());this.Fl=()=>{this.sUd?this.KZ||(this.SCa=this.ea.Qq.WebExtensions):
this.SCa=this.ea.Qq.WebExtensions;var ed=Le=>ub.EwaSettings.Ra(114)?!Le.GHa:!0,rd=Le=>ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!Le.L_f:!0;const ve=Le=>ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopilotSilentReload",!1)?"FA000000124"!==Le.io.PrimaryMarketplace.SolutionId:!0;for(let Le=this.Hl.length-1;0<=Le;--Le){const Qe=this.Hl[Le];!this.Twi(Qe.controlId)&&ed(Qe)&&rd(Qe)&&ve(Qe)&&(Qe.vOc(),this.Hl.splice(Le,1))}if(this.SCa)for(let Le=
0,Qe=this.SCa.length;Le<Qe;Le++)ed=this.SCa[Le],(rd=this.es(ed.WebExtensionId))&&rd.t$d(ed)};this.zPc=ed=>{this.raiseEvent("csc",ed.getID())};this.opa=(ed,rd,ve)=>{if(rd===OSF.AgaveHostAction.KeyboardShortcuts){var Le=Object(Gb.a)(Object,ve);rd={};rd.keyCode=Le.keyCode;rd.type="keydown";rd.ctrlKey=Le.ctrlKey;rd.shiftKey=Le.shiftKey;rd.altKey=Le.altKey;rd.metaKey=Le.metaKey;Le=this.es(ed);ed=Le.wla;rd.srcElement=Object(Ba.a)(577,ed)?ed.pIb:nb.f(this.$).hj;ed=new Sys.UI.DomEvent(rd);Le=Nd.iJa(Le.io,
this.$);rd={};rd.focusedAddinId=Le;Le=new Ec.a(1461300262,1,this.$.ii,6,null);nb.f(this.$).Q5b(ed,Le,rd)}else if(rd===OSF.AgaveHostAction.Select)this.HOf(!0);else if(rd===OSF.AgaveHostAction.UnSelect)this.HOf(!1);else if(rd===OSF.AgaveHostAction.CancelDialog)this.TU(-684355545,null);else if(rd===OSF.AgaveHostAction.InsertAgave)ed={},ve&&(this.KDb=ve,ed[ba.a.S9]=ve,ed[ia.a.Wk]=this.mfa(ve),this.TU(-741808261,ed));else if(rd===OSF.AgaveHostAction.ClickTrust)this.$pd&&ve&&(this.KDb=ve);else if(rd===
OSF.AgaveHostAction.OsfControlLoad)this.$pd&&this.KDb&&ve&&this.sJh(this.KDb,ve)&&ve.storeType&&(this.KDb=null,this.pG(Ja.b(ve.storeType)));else if(rd===OSF.AgaveHostAction.InsertDevManifest)ed={},ve&&(ed[ba.a.S9]=ve,ed[ia.a.Wk]=this.mfa(ve),this.TU(-741808261,ed));else if(rd===OSF.AgaveHostAction.InsertDevManifestError)ed=Object(Gb.a)(Object,ve),ed={[ba.a.Kpd]:this.Cr.getDevManifestInvalidUrlErrorString(ed.manifestUrl)},this.TU(-2025863019,ed);else if(rd===OSF.AgaveHostAction.NotifyHostError)ed=
{[ba.a.Kpd]:this.Cr.getManifestInvaildErrorString()},this.TU(-2025863019,ed);else if(rd===OSF.AgaveHostAction.RefreshAddinCommands)ub.EwaSettings.Ra(52)&&this.TU(Ic.a.refreshAddinCommands,null);else if(rd===OSF.AgaveHostAction.CtrlF6Exit||rd===OSF.AgaveHostAction.CtrlF6ExitShift){if(Le=Yc.a.nh(zd.Mb)){(ed=this.es(ed).wla)&&ed.V_c();l.a.Am&&document.activeElement.blur();var Qe={keyCode:117,type:"keydown",ctrlKey:!0};Qe.shiftKey=rd===OSF.AgaveHostAction.CtrlF6ExitShift;Qe.srcElement=Object(Ba.a)(577,
ed)?ed.pIb:nb.f(this.$).hj;ed=new Sys.UI.DomEvent(Qe);Le.Qza(ed)}}else if(rd===OSF.AgaveHostAction.PageIsReady){if((ed=this.es(ed).wla)&&ed.Meb===OSF.OsfControlTarget.TaskPane&&(ed=null,(ed=Ke.a.Rt()?Yc.a.nh(zd["if"]):this.$.la.lh(183))&&this.Hl))for(Le of this.Hl)Nd.T0a(Le.HX)&&ed.Up(!0,!1)}else if(rd===OSF.AgaveHostAction.TabExit){rd=this.es(ed);const Ud=rd.wla;Ud?Ud.Meb===OSF.OsfControlTarget.InContent?Ud.n5f():Ud.Meb===OSF.OsfControlTarget.TaskPane&&(l.a.Am&&document.activeElement.blur(),Ke.a.Rt()?
void Yc.a.resolve(zd["if"],{va:3}).then(re=>{const qe=Object(Ba.a)(577,Ud)?Ud:null;qe?qe.isResizable?re.focusResizeHandle():re.focusTabbedTaskPaneArea():re.focusTabbedTaskPaneArea()}):Oa.a.ep().then(re=>{const qe=Object(Ba.a)(577,Ud)?Ud:null;qe?qe.isResizable?re.focusResizeHandle():re.focusTabbedTaskPaneArea():re.focusTabbedTaskPaneArea();return null})):rd&&4===rd.osfControlType&&this.Cr.notifyAgave(ed,OSF.AgaveHostAction.TabIn)}else if(rd===OSF.AgaveHostAction.TabExitShift)(rd=this.es(ed),Le=rd.wla)?
Le.Meb===OSF.OsfControlTarget.InContent?Le.o5f():Le.Meb===OSF.OsfControlTarget.TaskPane&&(ed=Object(Ba.a)(577,Le)?Le:null)&&(l.a.Am&&document.activeElement.blur(),ed.xDk()):rd&&4===rd.osfControlType&&this.Cr.notifyAgave(ed,OSF.AgaveHostAction.TabIn);else if(rd===OSF.AgaveHostAction.EscExit||rd===OSF.AgaveHostAction.ExitNoFocusable||rd===OSF.AgaveHostAction.ExitNoFocusableShift)if(Le=this.es(ed).wla)Le.V_c();else{if(rd===OSF.AgaveHostAction.EscExit){rd=null;for(Qe of J.R_i())if(Qe.value.kl===ed){Qe.value.dialog.hide();
rd=Qe.key;break}rd&&(ed=this.es(rd))&&4!==ed.osfControlType&&this.Dl.notifyAgave(rd,OSF.AgaveHostAction.TabIn)}}else if(rd===OSF.AgaveHostAction.InstallCustomFunctions)if(ub.EwaSettings.Ra(114)){Nf.a(this.$).yBf(()=>!1);var Vb=this.$.la;Sd.TaskExtensions.Xa(De.GetServiceTaskFactory.Tj(Vb,278,279,1),Ud=>{Ud=Ud.result;Vb.lh(278)||Vb.Hh(278,Ud);const re=ve.osfControl.getStoreType();Ud.OVf(ve.osfControl.getSolutionId(),re,Nd.TIi(ve.osfControl),ve).UAa()},this.ya,3)}else h.ULS.sendTraceTag(537170577,0,
10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(rd===OSF.AgaveHostAction.UninstallCustomFunctions)if(ub.EwaSettings.Ra(114)){Nf.a(this.$).yBf(()=>!1);var cd=this.$.la;Sd.TaskExtensions.Xa(De.GetServiceTaskFactory.Tj(cd,278,279,1),Ud=>{Ud=Ud.result;cd.lh(278)||cd.Hh(278,Ud);Ud.Y3g(ve.solutionId,ve.storeType).UAa()},this.ya,3)}else h.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else rd===OSF.AgaveHostAction.SendTelemetryEvent?Dc.a.sendOtelEvent({otelEvent:ve}):rd===OSF.AgaveHostAction.SendCustomerContent?Dc.a.sendOtelCustomerContent({otelEvent:ve}):rd===OSF.AgaveHostAction.LaunchExtensionComponent?r.a.instance.zvj(ve):rd===OSF.AgaveHostAction.RefreshRibbonGallery?void Yc.a.resolve(zd.pe,{va:0}).then(Ud=>{Ud.vQd(ve)}):rd===OSF.AgaveHostAction.RemoveAppCommandsAddin?this.zkk(ve.solutionId):rd===OSF.AgaveHostAction.GetOriginalControlId&&(ed=new sa.a(this.$.xi,ve.ownerAddinSolutionId,
new vc.a,!0),ve.originalControlId=ed?ed.rnf(ve.controlId):ve.controlId)};this.rNg=(ed,rd)=>{const ve=Array(2);ve[0]=rd;ve[1]=null;this.ao.exi(ed,JSON.stringify(ve))};this.xsg=()=>{this.$.ma&&Fd.n(this.$.ma)&&(zd.Ug.Aa()?this.webExtensionView.yUb():tb.a(this.$).yUb())};this.Dj=()=>{this.x7f()};this.onBlockCacheItemChanged=(ed,rd)=>{ed=rd.mj;(ed=(ed=ed.block.state&1?ed.block.Pj:null)?ed.CustomFunctionsObjects:null)&&this.Hyd(ed)};this.D1=(ed,rd)=>{var ve,Le;1===rd.ox&&(ed=rd.Ul)&&(rd=new Lc(Ef.toTimestamp(ed.enqueueUtcTime),
Ef.toTimestamp(ed.processUtcTime),Ef.toTimestamp(ed.dequeueUtcTime),Ef.getElapsedMilliseconds(ed.enqueueUtcTime,ed.processUtcTime),Ef.getElapsedMilliseconds(ed.processUtcTime,ed.dequeueUtcTime),ed.operationCount,(null===(Le=null===(ve=ed.operation)||void 0===ve?void 0:ve.nk)||void 0===Le?0:Le.ServerCorrelationId)?ed.operation.nk.ServerCorrelationId:null,ed.operation?Enum.toString(ye.a,ed.operation.operationName):null,Cc.a.PM(Ef.getElapsedMilliseconds(ed.enqueueUtcTime,Kf.a.ih.si))),ve=Sys.Serialization.JavaScriptSerializer.serialize(rd),
h.ULS.sendTraceTag(50872916,0,50,ve))};this.eOc=()=>{this.vDg()};this.ij=(ed,rd)=>{!this.ea.ki&&te.a(rd)?this.vDg():(rd.MM&&(h.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.mIg()),this.SV(),ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.Bbc=!1))};this.Yt=()=>{ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(h.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),
this.mIg());this.SV();ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.Bbc=!1)};this.Yvg=ed=>{ed=ed.Result;if(ed=null===ed||void 0===ed?void 0:ed.AgaveData){var rd=ed.PrimaryMarketplace.SolutionId;rd=ed.SrcLocationOverrideResourceId?this.eJa(ed.PrimaryMarketplace.SolutionId,ed.SrcLocationOverrideResourceId):rd;if(rd=this.MGd(rd))this.ggd.ga(ed.InstanceId,rd.controlId),this.vgd.ga(rd.controlId,ed.InstanceId)}else h.ULS.sendTraceTag(507637772,0,10,"Silent Reload::postServerReloadSuccess: failed to return valid response.")};
this.kjg=ed=>{ed.vOc();this.raiseEvent("cd",ed.controlId)};this.th=wa;this.webExtensionView=Hc;this.cqd=wb;this.initialize(zc);Aa.Ba(this);this.BJg=0;(wa=(wa=!(l.a.Ux||l.a.b1))&&!l.a.Am)&&OfficeExt.ShortcutKeyDispatchManager.init();this.knh={}}get jfb(){return this.T8||(this.T8=new gb.a(this.$.pK))}zod(wa){this.addHandler("cd",wa)}Mlk(wa){this.removeHandler("cd",wa)}QBh(wa){this.addHandler("csc",wa)}Olk(wa){this.removeHandler("csc",wa)}NBh(wa){this.addHandler("ca",wa)}Llk(wa){this.removeHandler("ca",
wa)}OBh(wa){this.addHandler("ci",wa)}PBh(wa){this.addHandler("ekros",wa)}Nlk(wa){this.removeHandler("ekros",wa)}Vbe(wa,wb){try{return JSON.parse(wa)[wb].toLowerCase()}catch(zc){return""}}TJk(wa){const wb=this.Vbe(wa,"AudienceGroup"),zc=this.Vbe(wa,"SessionOrigin");try{const Hc=parseInt(this.Vbe(wa,"Ring"),10);if("automation"!==wb&&"bluechicken"!==zc&&-2<=Hc)return!0}catch(Hc){if("automation"!==wb&&"bluechicken"!==zc)return!0}return!1}get Dl(){if(!this.Cr){const wa={},wb=!(this.$.Ij&1),zc=hc.a.current.FS,
Hc=this.$.workbookContext,ed=v.AFrameworkApplication.H8?v.AFrameworkApplication.fa.Za("StaticContentHostNonOverriden"):bc.a.lW,rd=ed+bc.a.prc;wa.pageBaseUrl=zc.LayoutsContentUrlPrefix;wa.appName=OSF.AppName.ExcelWebApp;wa.appVersion="16";wa.appSettings=this.zNi();wa.singleSignOnSettings=aa.a.QWi();wa.clientMode=wb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;wa.appUILocale=this.$.ua.UICultureTag;wa.dataLocale=this.$.ua.DataCultureTag;wa.docUrl=Hc.ClientUrl;wa.hostControl=this;wa.formFactor=OSF.FormFactor.Default;
wa.lcid=this.$.zN.toString();wa.localizedScriptsUrl=ed+bc.a.Jhf;wa.localizedImagesUrl=rd;wa.localizedStylesUrl=ed+bc.a.Ghf;wa.localizedResourcesUrl=rd;wa.osfOmexBaseUrl=zc.OsfOmexBaseUrl;wa.firstPartyManifestCDNUrl=zc.FirstPartyAddInManifestCDN;wa.sdxAssetsToPrefetchMapping=v.AFrameworkApplication.fa.Za("SdxAssetsToPrefetchMapping");wa.sdxCdnUrl=zc.SdxCdnUrl;wa.sdx1CdnUrl=zc.Sdx1CdnUrl;wa.forceUseSdx1Cdn=zc.ForceUseSdx1Cdn;wa.sdxDmsUrl=zc.SdxDmsUrl;wa.sovereignFederationDMSToken=zc.SovereignFederationDMSToken;
wa.sovereignFederationDMSTokenSuffix=zc.SovereignFederationDMSTokenSuffix;wa.defaultManifestTokens=v.AFrameworkApplication.defaultManifestTokens;wa.devCatalogUrl=zc.DevCatalogUrl;wa.controlStatusChanged=this.zPc;wa.notifyHost=this.opa;wa.allowExternalMarketplace=this.$.ea.Vn.get(27)&&Nd.VLb;wa.enableAddinCommands=ub.EwaSettings.Ra(52);wa.enableBlackForestRedirect=ub.EwaSettings.Ra(87);wa.enableMyOrg=this.$.ea.Vn.get(33);wa.enableMyApps=this.$.ea.Vn.get(34);wa.enableDevCatalog=ub.EwaSettings.Ra(43);
wa.enablePrivateCatalog=this.QKk();wa.showSignOutFromPrivateCatalogMessage=this.$.ea.Vn.get(36);wa.enableUploadFileDevCatalog=ub.EwaSettings.Ra(52)&&!ub.EwaSettings.Ra(254)&&Nd.JAe;wa.userNameHashCode=K.a.rE(v.AFrameworkApplication.userName);wa.envCode=this.$.ua.OfficeAddinTelemetryDataSourceCode.toString();wa.enableSingleSignOnForAddin=v.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;wa.enableDisplayBlockedMinorError=ub.EwaSettings.Ra(171);wa.hideAppsExtensionUrl=v.AFrameworkApplication.hideAppsExtensionUrl;
wa.enableAnonymousUseLegacyCatalogService=ub.EwaSettings.Ra(162);wa.enableInsertDialogAccessibilityFix=ub.EwaSettings.Ra(169);wa.disableAppsForOfficeThirdParty=ub.EwaSettings.Ra(174);wa.enableFirstPartySSO=ub.EwaSettings.Ra(186);wa.wacSessionId=this.$.ua.UserSessionId;wa.disableLogging=!this.$.ua.AriaLoggingIsEnabled;wa.enableFirstPartySDXErrorMessages=ub.EwaSettings.Ra(198);wa.isHostDocumentDomain=ub.EwaSettings.Ra(209);wa.loggableUserId=v.AFrameworkApplication.fa.Za("LoggableUserId");wa.sessionStartInfoJson=
v.AFrameworkApplication.fa.Za("SessionStartInfoJson");wa.wopiHostOriginFromPostMessage=v.AFrameworkApplication.wopiHostOriginFromPostMessage;wa.wopiHostOriginFromWacPropBag=v.AFrameworkApplication.fa.Za("PostMessageOrigin");wa.wacIsEmbedded=v.AFrameworkApplication.fa.ka("IsEmbedded");wa.accessibilityAllowFocusAddinTaskpane=v.AFrameworkApplication.fa.ka("AccessibilityAllowFocusAddinTaskpane");wa.enableRemoveAppCommandsAddin=v.AFrameworkApplication.fa.ka("RemoveAppCommandsAddinIsEnabled");wa.isHostFrameTrustCheckEnabledForAddIns=
v.AFrameworkApplication.fa.ka("HostFrameTrustCheckIsEnabledForAddIns");wa.isHostFrameTrusted=v.AFrameworkApplication.isHostFrameTrusted;wa.agaveAddinUploadEnabled=ub.EwaSettings.Ra(45);wa.hostAllowedOfficeStore=v.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");wa.hostAllowedSdxEmbedding=v.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");wa.hostInstallAddIns=v.AFrameworkApplication.fa.Za("HostInstallAddIns");wa.hostInstallAddInsIsEnabled=v.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");
wa.approvedAddIns=v.AFrameworkApplication.fa.Za("ApprovedAddIns");wa.addinEnforceHttpsIsEnabled=this.TJk(wa.sessionStartInfoJson);wa.hostFeatureGateFlag=0;wa.isUpnCheckEnabled=v.AFrameworkApplication.fa.ka("IsUpnCheckEnabled");wa.wacUpn=v.AFrameworkApplication.fa.Za("UserPrincipalName");wa.isReactRibbonEnabled=Ke.a.isReactRibbonEnabled();wa.enableSetFocusOnTaskpaneOnUserAction=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);wa.isSafariWithIndexedDBDisabled=
ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&l.a.uoa;wa.isIndexedDBDisabled=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&l.a.uoa||ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&l.a.Am;wa.enableCustomShortcuts=!0;wa.changeGetModifierKeyStringOutputOrder=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");wa.officeJsUrl=v.AFrameworkApplication.vJ("OfficeJs/excel.js",5);
wa.enableOfficeJsUrlParam=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Cr=new OSF.ContextActivationManager(wa);this.Cr.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Cr.setWSA(v.AFrameworkApplication.$t);this.Cr&&"undefined"!==typeof this.Cr.hostCheckReadyHandler&&v.AFrameworkApplication.QCh(Object(Xb.a)(this.Cr,this.Cr.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const ve=Ka.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Cr.setOAuthManager(ve)}catch(ve){}}return this.Cr}get Vdl(){return this.emd}get Xn(){return this.JWe}get RAa(){return this.GWe}get dme(){return this.KWe}get cme(){return this.IWe}get wuk(){return this.MWe}get uuk(){return this.HWe}get vuk(){return this.LWe}get xuk(){return this.NWe}get yuk(){return this.OWe}get eme(){return this.PWe}get AJg(){return this.QWe}get X5(){return this.knh}get $(){return this.th}get bme(){return this.FWe}voc(wa){const wb={};wb.Name=wa.Name;wb.BindingType=wa.BindingType;
wb.HasHeaders=wa.HasHeaders;wa.IsValidRef&&(wb.ColCount=wa.Reference.LastColumn-wa.Reference.FirstColumn+1,wb.RowCount=wa.Reference.LastRow-wa.Reference.FirstRow+1);return wb}get jIb(){return v.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&v.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")}J6f(wa,wb){const zc=this.ROh(wb);let Hc=null;if(v.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==wb&&"LaunchAddinDialogFromTellMe"===wb[0])null!==zc.assetId&&"undefined"!==typeof zc.assetId&&(Hc="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.jIb){const ed=this.$.ea.Vn.get(27);!ed||null===wb||"InsertMoreAddInsFromFooter"!==wb[0]&&"InsertMoreAddInsFromBackstageFooter"!==wb[0]?!ed||null===wb||"AddinFlyoutMoreButton"!==wb[0]&&"LaunchMyAddInsFromBackstage"!==wb[0]||(Hc="0"):Hc="{98143890-AC66-440E-A448-ED8771A02D52}"}ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8253544_LogTelemetryForStoreDialog")&&
Dc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:ad.a.Pm({["controlId"]:null!==wb?wb[0]:"AllSources"})});this.Cr.launchInsertDialog(wa,Hc,zc)}get KZ(){return this.fkd}get sUd(){return ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)}get vmj(){return ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)}$wa(wa){return this.vgd.kh(wa)?this.vgd.na(wa):wa}kaa(wa){return this.ggd.kh(wa)?this.ggd.na(wa):
wa}get cU(){return this.dVa}get dVa(){this.$pd&&!this.vT&&(this.qik&&this.emi(this.Tgh),this.vT=bb.createInstance(v.AFrameworkApplication.fa,new Ab.a(()=>this.Cr),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.EYk,["AreThirdPartyAddInsAllowed"]:this.$.b4,["PopularAddinDetailsJsonString"]:this.jaf&&this.Q6j?Nd.P6j:Nd.ytb,["UICulture"]:v.AFrameworkApplication.uiCulture}));return this.vT}get EYk(){return ub.EwaSettings.Ra(174)}get allowExternalMarketplace(){return this.$.ea.Vn.get(27)}get $pd(){return v.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}static get ytb(){return'[{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":45662}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":84}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":6458}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":13200}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":73}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":10751}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":3216}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":872}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":3973}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":822}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":1968}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":3473}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":346}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":1332}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":533}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":348}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":1167}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1755}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":374}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":9563}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":311}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":1247}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":444}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":54042}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":699}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1898}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":851}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\'s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":2986}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":144554}},{"displayName":"Workspace Lite Add-in","solutionId":"wa200000565","version":"1.0.0.75","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using LSEG\u2019s unique content and analytics","iconUrl":"29750.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.965e10e4-deeb-43e1-b9e3-5801171d8464.baa9f23e-6f54-4889-9419-35de7fe21515.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":516}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":1938}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1073}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":487}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\'s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":996}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":324}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":1616}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":798}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":1340}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":955}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":340}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.4.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":1297}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":-1,"AUP":58}},{"displayName":"Formula Bot | AI Formula Generation and Data Automation","solutionId":"wa200004935","version":"6.0.0.0","targetType":1,"width":0,"height":0,"description":"Revolutionize your analytics workflow, from formula generation to data automation.","iconUrl":"55472.02bef729-7dee-4518-80a6-f1201acff812.93152da9-df92-4449-86fb-7b5555756176.fa00d9a4-0225-4c45-a649-c70f05461582.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://formulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":4975}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Use ChatGPT with the CoPilot experience right within your favorite office app.","iconUrl":"33851.9a73910f-bc07-461c-a5aa-da58e2ce898e.fe022fd3-f2d4-4057-bd68-fd8ef192180a.ac2e20fb-999e-43fc-b780-f35d91b9db91.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":402}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":41}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":9879}},{"displayName":"Numerous.ai","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":555}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":123}},{"displayName":"ChatGPT for Excel Word","solutionId":"wa200005502","version":"1.0.0.9","targetType":1,"width":0,"height":0,"description":"Use GPT AI in Excel and Word to edit, translate, explain, ask, classify, extract, summarize.","iconUrl":"57573.f9f47c4a-38c2-4ed8-b7cc-a8815cd3dcd0.c5bed181-b36c-4c88-b989-056784b5402d.c22af8d2-689f-4982-b9e1-80b025140566.png","licenseUrl":"https://static.talarian.io/gpt-in-excel/GPT_in_Excel_TOS.pdf","privacyUrl":"https://talarian.io/privacy-policy","addinInfo":{"priority":1,"AUP":25712}},{"displayName":"Supermetrics","solutionId":"WA104381807","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Automated Marketing Reporting directly in Excel","iconUrl":"33799.bb8cdc30-0a91-4002-884a-b62395c980a4.fb613201-2a43-4b0f-b068-5360656b0104.5abf29b1-cf19-4ab8-a383-2fd3c3322a82.png","licenseUrl":"https://supermetrics.com/terms-of-service","privacyUrl":"https://supermetrics.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Business Assist - Forecast","solutionId":"WA200005702","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Reduce your organization\'s helpdesk cost by using Business Assist Forecast.","iconUrl":"14472.f9e7cd0c-b0a1-46c9-8121-703e461934bb.9bb6db57-0f7e-4365-83e3-c71dfb411640.49c33548-12d6-4184-a39c-04b1918d113e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":78}},{"displayName":"Autopilot","solutionId":"WA200005669","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring OpenAI technologies into your apps with Autopilot that has integrated ChatGPT.","iconUrl":"12203.36723807-bf6b-458b-85d4-c6c068296f33.807070a8-ca50-4721-a811-d6bb38b70be3.3aaef1c4-2963-4d9e-aab0-905e58073e52.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":3,"AUP":586}},{"displayName":"Compare and Merge for Excel","solutionId":"WA200005782","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Compare Excel data within minutes. Find and resolve differences. Save hours of manual data review.","iconUrl":"30074.934ac94e-6eb5-42e9-bd61-d950303e2383.64b35664-874b-4eea-a5c5-22b9b1dfa6fd.d9552652-5a80-4f6b-b7dc-254b48fbb5ff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.strivetech.com/apps/excelcompareandmergeprivacy","addinInfo":{"priority":3,"AUP":135}},{"displayName":"Array Assistant","solutionId":"WA200005565","version":"1.0.1.0","targetType":1,"width":0,"height":0,"description":"Your AI Excel Assistant, Helping You Work Smarter and Faster! Try your first two weeks for Free!","iconUrl":"19248.dfd99dce-ae19-48c0-89aa-3654a01080ce.5d15e809-f4e4-42e1-813f-8235aab23209.6bb22ab5-ef1d-4810-8ad3-b0ac5496fc4e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://arrayassistant.ai/legal","addinInfo":{"priority":3,"AUP":100}},{"displayName":"Webex","solutionId":"WA200000068","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring Webex messaging and collaboration to your Microsoft files.","iconUrl":"39598.b4ad1d22-0361-475d-8552-534f8374babf.520bf26d-4b81-43fa-ac63-415826cb02fb.11a6abf0-7171-48ff-8c69-26b9e338033f.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848812/Product_42949683051/Asset_46d15f2a-cf03-461d-bd9f-9633d61422c9/universalcloudagreement.pdf","privacyUrl":"https://www.cisco.com/c/en/us/about/legal/privacy-full.html","addinInfo":{"priority":3,"AUP":192}},{"displayName":"draw.io Diagrams","solutionId":"WA200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":1,"AUP":797}},{"displayName":"Personalised QR Code Generator","solutionId":"WA200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"WA104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":1249}},{"displayName":"Wikipedia","solutionId":"WA104099688","version":"1.7.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":332}},{"displayName":"Bing Maps","solutionId":"WA102957661","version":"1.6.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":13556}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"WA104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":-1,"AUP":697}},{"displayName":"CSV Import+Export","solutionId":"WA200000025","version":"1.0.0","targetType":1,"width":0,"height":0,"description":"Import and export CSV files on Excel.","iconUrl":"58575.082549a1-a61c-4d6a-b397-1281a6b2818d.f4f41bd6-d825-4219-af6e-da610c4a7324.1b9d835d-23bf-45b0-818d-783bef621094.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.emeditor.com/about/privacy-policy","addinInfo":{"priority":3,"AUP":858}},{"displayName":"Money in Excel","solutionId":"WA200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.asp","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Isograd Learning Platform","solutionId":"WA200006017","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Isograd Learning Platform is an online courseware solution for Microsoft 2019 and Microsoft 365.","iconUrl":"6539.d4a08e78-43e8-4bd4-823f-8b9bb98f71c8.358fe9da-edf0-4bd2-8f23-eabe1b2de609.79a5fd12-e871-4f4b-ad2d-e3265cff3b2c.png","licenseUrl":"https://learning.isograd.com/eula","privacyUrl":"https://learning.isograd.com/privacypolicy","addinInfo":{"priority":3,"AUP":10}},{"displayName":"Bracket Builder","solutionId":"WA200006008","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Build double elimination tournament brackets compatible with Little League","iconUrl":"50028.22f4f90a-426f-475a-beba-d0189799b8bd.7f3ed4ca-2f1a-436c-9839-dd7764195b7f.db54fea0-fdaf-44f7-a816-41361b822660.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://addin.red.traynrex.com/help/Privacy.html","addinInfo":{"priority":3,"AUP":3}},{"displayName":"Excel Send to Trello","solutionId":"WA200005960","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"This Excel add-in makes it easy to bulk create cards in Trello from a table.","iconUrl":"8664.52ca8fd6-95d6-47e7-b679-b9f888571bc7.5efe9dcf-a87f-4171-ac66-cb9c30b5226e.5d8ecce4-7fc8-49dd-87fd-07095c48deac.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://kryl.com/?page=/privacy","addinInfo":{"priority":3,"AUP":3}},{"displayName":"XperienceED","solutionId":"WA200005817","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Web-based, hands-on learning for Microsoft 365 Apps and Microsoft 2019.","iconUrl":"6120.0e948c8b-c5cf-4b7a-b18f-3d59a7105ce2.fcdc57d0-ecf7-430c-94c1-9742dc8a097c.af83a49b-bd1c-43a3-bf7d-9c061ec545c8.png","licenseUrl":"https://ccilearning.com/wp-content/uploads/2023/03/XperienceED-EULA-August-14-2022_clear.docx","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":7}},{"displayName":"Green Street Add-In","solutionId":"WA200005876","version":"1.0.4.24","targetType":1,"width":0,"height":0,"description":"Enhance your investment analyses with Green Street\'s industry leading commercial real estate data ","iconUrl":"49943.bc2d4344-5f24-4610-b662-91c4934d717d.590cce90-117c-42db-baa3-83d5d7daa95f.c83b6cf7-1070-4e11-896f-53331b434c3e.png","licenseUrl":"https://www.greenstreet.com/termsofuse","privacyUrl":"https://files.greenstreet.com/public_files/GlobalPrivacyPolicy.pdf","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"R2 Copilot for Excel","solutionId":"WA200006007","version":"1.0.4.0","targetType":1,"width":0,"height":0,"description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.35fd77ec-1e64-4d91-b540-7e993a97b899.736533f6-6174-46c6-9736-9d0074bc04cb.93461044-7ae6-496e-abfb-17b484279f77.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":2,"AUP":252}},{"displayName":"Spreadsheet AI","solutionId":"WA200006009","version":"1.0.1.6","targetType":1,"width":0,"height":0,"description":"AI chat copilot in Excel who understands your workbook and assists with countless spreadsheet tasks.","iconUrl":"14669.7db070f8-5e86-4224-b93c-0f0447636b16.132765a9-fdd4-41f1-9c90-aa6f0d6b82dc.45c767b9-81c9-4813-a7d1-462156cc844b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/docs/privacy","addinInfo":{"priority":2,"AUP":76}},{"displayName":"Widata","solutionId":"WA200005777","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"WiData is a platform seamlessly integrated into Excel to assist you in accessing all financial data","iconUrl":"42486.cf83fc97-7cc4-4fc9-a442-27252297bd9d.a3b30b83-17e9-41ef-88f3-72c47dfaee63.4eb440c2-941b-4d85-bc6f-a0c115f258ab.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.widata.vn/en/ch%C3%ADnh-s%C3%A1ch-b%E1%BA%A3o-m%E1%BA%ADt","addinInfo":{"priority":3,"AUP":25}},{"displayName":"McGraw Hill","solutionId":"WA200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":-1,"AUP":176861}},{"displayName":"Web Video Player","solutionId":"WA104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":294}},{"displayName":"AP Essentials Online Reports","solutionId":"WA200004805","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Easily generate Excel reports of your AP Essentials documents.","iconUrl":"46463.4f2ef016-20cb-4469-89c8-91b3ed852e94.bc9b4ced-e86a-461d-bf3e-ea85bc5923db.3fc71624-1087-40f3-bdbf-d437b17759cb.png","licenseUrl":"https://www.kofax.com/legal/terms-of-service","privacyUrl":"https://www.kofax.com/Legal/Privacy","addinInfo":{"priority":-1,"AUP":225}},{"displayName":"Velixo","solutionId":"WA200002311","version":"1.2023.8.64","targetType":1,"width":0,"height":0,"description":"Excel-based reporting for your ERP. Build your own reports in less than 5 minutes!","iconUrl":"56800.9a67df19-bebd-46e1-932f-c05f1da5d162.aded0159-fc94-4c0e-922c-a61decdb9403.0ad5536a-3258-403d-8f0a-adb854889d11.png","licenseUrl":"https://www.velixo.com/eula","privacyUrl":"https://www.velixo.com/privacy-policy","addinInfo":{"priority":2,"AUP":880}},{"displayName":"Mail Merge","solutionId":"WA200006466","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Send personalized emails with Excel, create email drafts or schedule emails for sending later.","iconUrl":"6987.7e407018-9102-4508-a2e9-e769a41b7735.b8d24346-5fb6-49bf-b22b-7baa15ddcad8.847e5579-8358-4333-a405-47191f54a8c1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://digitalinspiration.com/privacy","addinInfo":{"priority":2,"AUP":18}},{"displayName":"NielsenIQ Discover","solutionId":"WA200004632","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"The new NielsenIQ Discover add-In makes generating robust Excel reports faster and easier than ever.","iconUrl":"31362.41c487ba-25d8-4918-a85c-916c87cf1a6d.f8335a3c-da4c-4faa-85ef-58d1bd876169.9204b71b-9802-4510-b8d0-81455582dd72.png","licenseUrl":"https://nielseniq.com/global/en/legal/terms-of-use","privacyUrl":"https://nielseniq.com/global/en/legal/privacy-policy","addinInfo":{"priority":-1,"AUP":180}}]'}static get P6j(){return'[{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}}]'}get Q6j(){return v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinDetailsForTestEnabled",
!1)}get jaf(){return"Dev Box"===v.AFrameworkApplication.fa.Za("StatusBarEnvironmentNameToUse")}get qik(){return v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}emi(wa){window.setTimeout(()=>{this.dti()},wa)}dti(){this.W6c?h.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(h.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.pG(0,!0))}static l2a(wa){return 0===wa||10===
wa}Hub(wa,wb){this.dVa&&this.dVa.Hub(wa,wb)}pG(wa,wb){this.dVa&&(!this.W6c&&Nd.l2a(wa)&&(this.W6c=!0),this.dVa.pG(wa,wb))}GTc(wa){this.dVa&&this.dVa.AAa(wa)}sJh(wa,wb){return C.a.zm().equals(wa.solutionId,wb.solutionId)&&C.a.zm().equals(wa.storeType,wb.storeType)}ife(wa,wb){if(v.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.Jyg(wa,wb,OSF.StoreTypeEnum.MarketPlace);else{const zc={};zc.callbackFunc=wa;zc.storeType=OSF.StoreTypeEnum.MarketPlace;
zc.fromInsertDialog=!1;zc.refresh=wb;this.Cr.queryEntitlementDetails(zc)}}Jyg(wa,wb,zc){const Hc={};Hc.callbackFunc=wa;Hc.storeType=zc;Hc.fromInsertDialog=!1;Hc.refresh=wb;this.Cr.queryEntitlementDetails(Hc)}invokeDdaMethod(wa,wb){const zc=this.es(wa.DdaMethod.ControlId);if(zc){if(this.sUd&&this.KZ){const Hc=this.$wa(wa.DdaMethod.ControlId);wa.DdaMethod.ControlId=Hc}zc.invokeDdaMethod(wa,wb)}else this.lo(pb.a.internalError,wb)}registerDdaEventAsync(wa,wb,zc,Hc,ed){(wb=this.es(wb))?Nd.PVb(wa)?wb.ehk(wa,
zc,Hc,ed):this.lo(pb.a.kbe,ed):this.lo(pb.a.internalError,ed)}unregisterDdaEventAsync(wa,wb,zc,Hc,ed){(wb=this.es(wb))?Nd.PVb(wa)?wb.T4k(wa,zc,Hc,ed):this.lo(pb.a.kbe,ed):this.lo(pb.a.internalError,ed)}dispose(){if(!this.disposed){this.$.Wr(this.Dj);this.ea.ilk(this.eOc);this.ea.Uq(this.ij);this.ea.WP(this.Yt);this.ea.KA(this.Fl);this.cqd.detach(this);this.$.userOperationManager.su(this.D1);const wa=nb.f(this.$);null===wa||void 0===wa?void 0:wa.za.Vy(this.onBlockCacheItemChanged);this.JQc=this.Hl=
this.ao=this.cqd=this.th=null;this.rYa&&(this.rYa.dispose(),this.rYa=null);Ac.a.dh(this.dme);Ac.a.dh(this.cme);this.fib&&(this.fib.dispose(),this.fib=null);super.dispose();this.disposed=!0;h.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}HKd(wa){return(wa=this.es(wa))?wa.getDefaultIconUrl():null}$Xc(wa){if(this.Ymf!==wa){this.Ymf=wa;for(let wb=0,zc=this.Hl.length;wb<zc;wb++){const Hc=this.Hl[wb];wa?Hc.Gpf(!1):Hc.Gki()}this.dme.$Xc(wa);this.cme.$Xc(wa)}}tJi(wa){return(wa=this.es(wa))?wa.getDefaultDisplayName():
null}lo(wa,wb,zc){const Hc={};Hc[ia.a.Wk]=wa;Hc[ia.a.wfa]=wb;this.TU(451041795,Hc,void 0===zc?!0:zc)}zE(wa){const wb={};wb[ia.a.wfa]=wa;this.TU(1237877382,wb)}TU(wa,wb,zc){zc=void 0===zc?!0:zc;const Hc=new Ec.a(wa,0,this.$.ii,0,null),ed=wb?wb[ia.a.wfa]:null;this.fib&&nb.f(this.$).isEditing&&kb.FZh(wa,wb)?this.fib.Pci(wa,wb):(wa=this.$.Ma.qh(Hc,wb),zc&&Sd.TaskExtensions.Xa(wa,rd=>{of.a(rd)?this.lo(pb.a.internalError,ed,!1):rd.result||(nb.f(this.$).isEditing?this.lo(pb.a.OUb,ed,!1):this.lo(pb.a.internalError,
ed,!1))},this.ya,8))}j1h(wa){return!!this.owa(wb=>Nd.getSolutionId(wb.io,this.$)===Nd.getSolutionId(wa,this.$)&&wb.io.PrimaryMarketplace.MarketplaceType===wa.PrimaryMarketplace.MarketplaceType&&wb.io.PrimaryMarketplace.MarketplaceRef===wa.PrimaryMarketplace.MarketplaceRef&&wb.io.PrimaryMarketplace.SolutionVersion===wa.PrimaryMarketplace.SolutionVersion)}es(wa){return this.owa(wb=>wb.controlId.startsWith(wa))}YYa(wa){let wb=wa;this.KZ&&(wb=this.kaa(wa));return this.es(wb)}Hwi(wa){return this.owa(wb=>
wb.GHa===wa)}Lzf(wa){return this.owa(wb=>wb.HX===wa&&!!wb.GHa)}Xzf(wa,wb,zc,Hc){return this.owa(ed=>ed.HX===wa&&ed.io.PrimaryMarketplace.MarketplaceRef.toLowerCase()===wb.toLowerCase()&&ed.io.PrimaryMarketplace.MarketplaceType.toLowerCase()===zc.toLowerCase()&&!!ed.io.SharedRuntime&&!!ed.io.SharedRuntime.Resid&&!!Hc&&!!Hc.Resid&&ed.io.SharedRuntime.Resid.toLowerCase()===Hc.Resid.toLowerCase())}dKh(wa,wb){if(wa=this.es(wa))wa.Ba(wb),wa.showHide(!0)}$Ok(wa){(wa=this.es(wa))&&wa.showHide(!1)}xXa(wa){var wb;
if(1!==wa.WebExtensionType||this.$.Ij&8388608&&wa.TaskpaneVisible||this.$.Ij&8388608&&!wa.TaskpaneVisible&&Ad.HelperMethods.XF(wa)){let zc=null;Ad.HelperMethods.XF(wa)&&(zc=Nd.iJa(wa,this.$),wa.TaskpaneWidth||(wa.TaskpaneWidth=this.sNb));const Hc=(new yb(this,this.ao,wa,this.webExtensionView)).bTd();h.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa.PrimaryMarketplace.SolutionId,wa.OwnerAddinStoreType||wa.PrimaryMarketplace.MarketplaceType,
null===(wb=wa.AssetMarketplace)||void 0===wb?void 0:wb.SolutionId,null,null,wa.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${wa.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ad.HelperMethods.XF(wa)}`);zc&&(Hc.GHa=zc);this.Hl.push(Hc);this.ILa=null;this.nnb(wa.InstanceId)||(wa=String.format("{0}|{1}|{2}|{3}|{4}",wa.PrimaryMarketplace.SolutionId,wa.PrimaryMarketplace.SolutionVersion,wa.PrimaryMarketplace.MarketplaceRef,wa.PrimaryMarketplace.MarketplaceType,wa.WebExtensionType),this.raiseEvent("ci",
wa))}}aRk(wa,wb){wa.TaskpaneWidth=this.sNb;wa.TaskpaneVisible=!0;const zc={};zc.SolutionId=wa.PrimaryMarketplace.SolutionId;zc.TargetType=wa.WebExtensionType;zc.Version=wa.PrimaryMarketplace.SolutionVersion;zc.StoreType=wa.PrimaryMarketplace.MarketplaceType;zc.StoreId=wa.PrimaryMarketplace.MarketplaceRef;wa.AssetMarketplace?(zc.AssetId=wa.AssetMarketplace.SolutionId,zc.AssetStoreId=wa.AssetMarketplace.MarketplaceRef):(zc.AssetId=null,zc.AssetStoreId=null);zc.Width=wa.TaskpaneWidth;const Hc=new yb(this,
this.ao,wa,this.webExtensionView,!0);Hc.bTd();this.Hl.push(Hc);const ed=()=>{this.p6a(Hc.controlId);this.Dl.purgeOsfControl(Hc.controlId,!1);wb()};let rd=null;rd=pf.a.instance.HO(()=>{Hc.lG&&(Ac.a.dh(rd),rd=null,this.Dl.insertBlankControlWithErrorUX(this.T2b(Hc,zc),ed))},100,qf.a.ybi)}Hyd(wa){if(wa&&wa.length){var wb=[];wa.forEach(zc=>{if(zc.ContainsCustomFunctions){const Hc=Nd.iJa(zc,this.$);this.sce.contains(Hc)||(this.sce.add(Hc),this.Mug.push(zc));this.j1h(zc)||wb.push(zc)}});wb.length&&this.Yjf(wb)}}gmf(wa,
wb){this.es(wa.InstanceId)||(wb=wb(),wa=(new yb(this,this.ao,wa,this.webExtensionView)).BUf(wb),this.Hl.push(wa),this.ILa=null)}qOk(wa){Nd.aib.kh(wa)&&Nd.aib.na(wa).initializeAndShowWithTitle()}x7i(wa){Nd.aib.kh(wa)&&Nd.aib.na(wa).hide()}MRi(wa){var wb=null;let zc=null;const Hc=Nd.hPd(wa,!0);if(!Hc)return h.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),ce.Task.Ua(null);const ed=this.Cr.getOsfControl(Nd.getSolutionId(Hc,this.$));ed&&(wb=
ed.getManifest())&&(zc=wb.getSharedRuntimeForCustomFunctions("Workbook"));if(wb=zc&&1===zc.LifeTime?this.Xzf(Hc.PrimaryMarketplace.SolutionId,Hc.PrimaryMarketplace.MarketplaceRef,Hc.PrimaryMarketplace.MarketplaceType,zc):this.Hwi(wa))return ce.Task.Ua(wb.controlId);const rd=new Db.a;Ad.HelperMethods.GJc(zc)&&(Hc.SharedRuntime=zc);wa=ed?ed.getNotificationParams():[];if(!wa.length)return this.Fkf(Hc);this.eUg(wa,()=>{Sd.TaskExtensions.Xa(rd.task,()=>{this.Fkf(Hc)},this.ya,3)},()=>{});return rd.task}PDi(wa){wa=
Nd.hPd(wa,!1);if(!wa)return h.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let wb=null;var zc=this.Cr.getOsfControl(Nd.getSolutionId(wa,this.$));zc&&(zc=zc.getManifest())&&(wb=zc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Ad.HelperMethods.GJc(wb)&&(wa=this.Xzf(wa.PrimaryMarketplace.SolutionId,wa.PrimaryMarketplace.MarketplaceRef,wa.PrimaryMarketplace.MarketplaceType,wb))?wa.controlId:null}P3h(wa,wb){var zc=Nd.hPd(wa,!1);if(zc){var Hc=
null,ed=this.Cr.getOsfControl(Nd.getSolutionId(zc,this.$));ed&&(ed=ed.getManifest())&&(Hc=ed.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ad.HelperMethods.GJc(Hc)){zc.SharedRuntime=Hc;var rd=zc.PrimaryMarketplace.SolutionId;ed=zc.PrimaryMarketplace.SolutionVersion;var ve=OSF.OsfManifestManager.getCachedManifest(rd,ed);if(ve)if(this.Gmc.kh(wa))Hc=this.Gmc.na(wa),Sd.TaskExtensions.Xa(Hc,Vb=>{(Vb=Vb.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Vb,wb,this.ao.z6b)},
this.ya,3);else{var Le={};Le.solutionId=rd;Le.version=ed;Le.storeType=zc.PrimaryMarketplace.MarketplaceType;Le.storeId=zc.PrimaryMarketplace.MarketplaceRef;zc.AssetMarketplace?(Le.assetId=zc.AssetMarketplace.SolutionId,Le.assetStoreId=zc.AssetMarketplace.MarketplaceRef):(Le.assetId=null,Le.assetStoreId=null);Le.targetType=OSF.OsfControlTarget.TaskPane;var Qe=new Db.a;zc=Sd.TaskExtensions.Gq();zc=new zb.a(this.$,this,Le,zc);Hc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(rd,Hc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ve,
Hc,ed);zc.createUILessSandbox(Le,ve,(Vb,cd)=>{Vb&&!cd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Vb,wb,this.ao.z6b),Qe.setResult(Vb)):Qe.setResult(null);this.Gmc.remove(wa)});this.Gmc.ga(wa,Qe.task)}}}else h.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Eef(wa){(wa=this.Lzf(wa))&&(wa.io.SharedRuntime||this.n4b(wa.controlId))}n4b(wa){(wa=this.Lzf(wa))&&this.p6a(wa.controlId)}Ygi(wa,wb){if(!this.Hl||!wa||!wb)return!1;
if(wa.toLowerCase()===wb.toLowerCase())return!0;let zc=null,Hc=null;for(let ed=0,rd=this.Hl.length;ed<rd;ed++){const ve=this.Hl[ed];if(ve.ownerAddinSolutionId&&(ve.controlId===wa&&(zc=ve.ownerAddinSolutionId.toLowerCase()),ve.controlId===wb&&(Hc=ve.ownerAddinSolutionId.toLowerCase()),zc&&Hc))break}return zc&&zc===Hc?!0:!1}dzh(wa){this.es(wa.InstanceId)||(wa=new yb(this,this.ao,wa,this.webExtensionView),this.Hl.push(wa),this.ILa=null)}iEg(wa){if(this.Hl&&0<=wa&&wa<this.Hl.length){const wb=this.Hl[wa],
zc=wb.lG;this.Hl.splice(wa,1);this.kjg(wb);yd.DOMElementExtensions.$m(zc)}}p6a(wa){if(this.Hl)for(let wb=0,zc=this.Hl.length;wb<zc;wb++)if(this.Hl[wb].controlId===wa){this.iEg(wb);break}}zkk(wa){if(this.Hl){wa=wa.toLowerCase();for(let wb=0,zc=this.Hl.length;wb<zc;wb++)if(wa===this.Hl[wb].ownerAddinSolutionId.toLowerCase()){this.iEg(wb);break}}}HKh(wa){wa.Uv&&(this.es(wa.floatingObject.io.InstanceId)||(this.FFc(wa.floatingObject.io.InstanceId)||this.JQc.push(wa.floatingObject.io.InstanceId),this.xXa(wa.floatingObject.io)),
this.ea.isNamedObjectViewMode&&this.dKh(wa.floatingObject.io.InstanceId,wa.Uj))}MGd(wa){return null==this.Hl?null:this.Hl.find(wb=>1===wb.controlType&&If.a.equals(wb.HX,wa,!0))}m5(wa){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return wa=this.MGd(wa),null===wa||void 0===wa?void 0:wa.controlId;if(this.Hl)for(let wb=0,zc=this.Hl.length;wb<zc;wb++)if(1===this.Hl[wb].controlType&&If.a.equals(this.Hl[wb].HX,wa,!0))return this.Hl[wb].controlId;return null}Xrj(wa){return(wa=
this.MGd(wa))?wa.visible:!1}iwi(wa){const wb=[];if(this.Hl)for(let zc=0,Hc=this.Hl.length;zc<Hc;zc++)If.a.equals(this.Hl[zc].HX,wa,!0)&&wb.push(this.Hl[zc].controlId);return wb}Owi(wa,wb){if(!wb||!wa)return null;if(this.Hl)for(let zc=0,Hc=this.Hl.length;zc<Hc;zc++)if(1===this.Hl[zc].controlType&&If.a.equals(this.Hl[zc].HX,wa,!0)&&this.Hl[zc].io.SharedRuntime&&If.a.equals(this.Hl[zc].io.SharedRuntime.Resid,wb.Resid,!0))return this.Hl[zc].controlId;return null}eJa(wa,wb){wb=void 0===wb?null:wb;return wa?
wb?`${wa}.${wb}`:wa:""}Hef(wa,wb,zc){if(this.ILa===wa)return!0;this.ILa=wa;let Hc=null,ed=!1;if(!Hc&&this.Hl)for(let rd=0,ve=this.Hl.length;rd<ve;rd++)if(1===this.Hl[rd].controlType&&If.a.equals(this.Hl[rd].HX,wa,!0)){let Le=!1,Qe=!1;wb?(Le=!0,Qe=!!this.Hl[rd].io.SharedRuntime&&If.a.equals(this.Hl[rd].io.SharedRuntime.Resid,wb.Resid,!0)):zc&&(Le=!0,Qe=If.a.equals(this.Hl[rd].io.SharedRuntimeId,zc,!0));if(!Le||Qe){Qe&&this.Hl[rd].eF(!0);Hc=this.Hl[rd].controlId;ed=!0;this.ILa=null;break}}Hc&&this.raiseEvent("ca",
Hc);return ed}setAppRuntimeState(wa,wb){var zc;if(wa){let Hc;if((Hc=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?this.YYa(wa):this.es(wa))&&Ad.HelperMethods.XF(Hc.io))Hc.eF(wb),wb&&(this.raiseEvent("ca",wa),(null===(zc=Hc.lG)||void 0===zc?0:zc.firstChild)&&(wa=Hc.lG.firstChild.title)&&0<wa.length&&this.jfb.Mzk(wa));else throw h.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(ac.a.instance.ia(2250));
}else throw h.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(ac.a.instance.ia(2251));}getAppRuntimeState(wa){if(wa)if((wa=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?this.YYa(wa):this.es(wa))&&Ad.HelperMethods.XF(wa.io))wa=wa.io.TaskpaneVisible;else throw h.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(ac.a.instance.ia(2250));else throw h.ULS.sendTraceTag(537170562,
0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(ac.a.instance.ia(2251));return wa}Ujb(wa,wb){return(wa=this.es(wa))?wa.Ujb(wb):null}nnb(wa){return this.Jef(this.JQc,wa)}FFc(wa){return this.Jef(this.Smf,wa)}g2e(wa){this.Smf.push(wa)}UX(wa){return(wa=this.es(wa))?wa.io:null}F7d(wa){this.raiseEvent("ekros",wa,this)}$rg(wa){if(wa){var wb=this.es(wa.InstanceId);wb&&(wa.SharedRuntime||wa.SharedRuntimeId||(this.p6a(wb.controlId),this.Dl.purgeOsfControl(wb.controlId,!1)),wb={},wb.SolutionId=
wa.PrimaryMarketplace.SolutionId,wb.TargetType=wa.WebExtensionType,wb.Version=wa.PrimaryMarketplace.SolutionVersion,wb.StoreType=wa.PrimaryMarketplace.MarketplaceType,wb.StoreId=wa.PrimaryMarketplace.MarketplaceRef,wa.AssetMarketplace?(wb.AssetId=wa.AssetMarketplace.SolutionId,wb.AssetStoreId=wa.AssetMarketplace.MarketplaceRef):(wb.AssetId=null,wb.AssetStoreId=null),wb.Width=wa.TaskpaneWidth,wb.SharedRuntimeId=wa.SharedRuntimeId,this.c2g(wb))}}Xva(){this.ao.Xva()}CM(wa,wb,zc){this.ao.CM(wa,wb,zc)}eAf(wa,
wb){wb=Nd.l9h(wb);wa=this.UX(wa);this.ao.gyc(wa.InstanceId,2202,Mc.a.VV,wb)}TGd(wa){for(let wb=0,zc=this.Hl.length;wb<zc;wb++)this.eAf(this.Hl[wb].controlId,wa)}$wi(wa,wb){wb=Nd.u4h(wb);this.ao.gyc(wa,65539,"",wb)}cxi(wa,wb,zc){this.ao.gyc(wa,1,wb,zc)}Zwi(wa,wb){this.ao.dxi(wa,wb)}L3h(wa,wb){return[[2,1E3,"",JSON.stringify([wa,wb]),0,!1]]}nXf(){return!!this.RAa&&this.RAa.vQf()}bXh(){this.RAa&&this.RAa.clear()}bAf(){if(this.RAa&&this.RAa.vQf()){var wa=this.RAa.SDi();for(const wb of wa){wa=this.iwi(wb);
for(const zc of wa)this.ao.gyc(zc,65540,"","{}")}}}Ygk(wa){this.RAa.add(wa)}Q4k(wa){this.RAa.remove(wa)}owa(wa){if(!this.Hl)return null;for(const wb of this.Hl)if(wa(wb))return wb;return null}Fkf(wa){const wb=new Db.a,zc=Nd.iJa(wa,this.$);if(Ad.HelperMethods.XF(wa))h.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.Jug(wa,Hc=>{Hc?(wa.InstanceId=Hc.InstanceId,wa.WebExtensionOsfControlType=3,wa.TaskpaneVisible=!1,this.xXa(wa),wb.setResult(wa.InstanceId)):(h.ULS.sendTraceTag(537170530,
0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(wa.PrimaryMarketplace.SolutionId,wa.PrimaryMarketplace.MarketplaceType,null,null,null,wa.PrimaryMarketplace.MarketplaceRef)} failed`),wb.setException(Error.create("Null insert data")))});else{Nd.aib.ga(wa.InstanceId,new oa.a);const Hc=Nd.aib.na(wa.InstanceId).xma;this.v5h(wa,Hc,zc);this.Jug(wa,null);wb.setResult(wa.InstanceId)}return wb.task}v5h(wa,wb,zc){this.es(wa.InstanceId)||(wa=new yb(this,this.ao,wa,
this.webExtensionView),wa.GHa=zc,wa.BUf(wb),this.Hl.push(wa),this.ILa=null)}Jug(wa,wb){const zc=Nd.iJa(wa,this.$);if(!this.sce.contains(zc))this.r2b.push(wa),1<=this.r2b.length&&this.Kug(wa,wb);else if(wb)for(const Hc of this.Mug)if(Nd.iJa(Hc,this.$)===zc){wb(Hc,0);break}}Kug(wa,wb){let zc=null;const Hc={};Hc.SolutionId=Nd.getSolutionId(wa,this.$);Hc.TargetType=wa.WebExtensionType;Hc.Version=wa.PrimaryMarketplace.SolutionVersion;Hc.StoreType=wa.PrimaryMarketplace.MarketplaceType;Hc.StoreId=wa.PrimaryMarketplace.MarketplaceRef;
wa.AssetMarketplace?(Hc.AssetId=wa.AssetMarketplace.SolutionId,Hc.AssetStoreId=wa.AssetMarketplace.MarketplaceRef):(Hc.AssetId=null,Hc.AssetStoreId=null);Hc.Width=wa.TaskpaneWidth;Hc.ContainsCustomFunctions=!0;Ad.HelperMethods.XF(wa)&&(Hc.SharedRuntimeId=wa.SharedRuntime.Resid);const ed=this.$.pa.ta;wa=this.$.pa.ta.Wh();const rd=ed.$a(9,wa);rd.sharedInfo=Hc;const ve=Qe=>{Qe=pe.a.kk(Qe.data);h.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Qf.a.ei(Qe)}`)},
Le=Qe=>{Qe&&!Hf.a(Qe)||h.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.SolutionId,Hc.StoreType,Hc.AssetId,null,null,Hc.StoreId)} finish with errors: ${Qf.a.ei(Qe.Errors)}`);this.r2b.shift();0<this.r2b.length&&this.Kug(this.r2b[0],wb)};if(wb){const Qe=Vb=>{const cd=Vb.Result;(zc=cd?cd.AgaveData:null)||wb(null,Vb.Errors?Vb.Errors[0].ErrorCause:5001);wb(zc,0)};wa=(Vb,cd,Ud)=>ue.h(ed,"InsertAgaveTaskpane",rd,Yb.c(Vb,Le,Qe),Yb.b(cd,ve),
Ud,null,0)}else wa=(Qe,Vb,cd)=>ue.h(ed,"InsertAgaveTaskpane",rd,Yb.c(Qe,Le),Yb.b(Vb,ve),cd,null,0);$c.a(this.$.userOperationManager,wa,Qe=>new oc.a(519,0,Qe,64),null)}QKk(){return this.$.uk.get(35)}Fkk(wa){wa=this.es(wa);(null===wa||void 0===wa?0:wa.mqa)&&wa.tEg()}D7d(wa){var wb=this.owa(zc=>Nd.T0a(zc.HX));wb&&(wb=this.Dl.getOsfControl(wb.controlId))&&wb.notifyAgave(OSF.AgaveHostAction.SendMessage,wa)}IXf(){return!!this.owa(wa=>1===wa.controlType&&Nd.T0a(wa.HX))}HXf(){const wa=this.owa(wb=>Nd.T0a(wb.HX));
return wa?wa.lG?yd.DOMElementExtensions.isVisible(wa.lG):!1:!1}gPg(){const wa=this.owa(wb=>Nd.T0a(wb.HX));wa&&(wa.eF(!0),this.raiseEvent("ca",wa.controlId))}initialize(wa){var {DdaEventDispatch:wb}=a(1523);const zc=void 0===this.$||null===this.$||ub.EwaSettings.Ra(234);void 0!==this.$&&null!==this.$||h.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");zc&&h.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);
this.initialized||(zd.Ug.Aa()||Cd.WebExtensionView.iJb(this.$),this.ea=this.$.ea,this.ao=new wb(this.$,this),this.$.kr(this.Dj),this.ea.K3e(this.eOc),this.ea.$q(this.ij),this.ea.kO(this.Yt),this.ea.mz(this.Fl),this.$.userOperationManager.kw(this.D1),wb=nb.f(this.$),null===wb||void 0===wb?void 0:wb.za.kz(this.onBlockCacheItemChanged),this.x7f(),this.YVj(),this.Fbj(),zd.Ug.Aa(),zd.xb.Aa()||this.$.la.Hh(35,this),this.cqd.Ba(this),zc&&h.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),
this.JWe=new Mc.a,zc&&h.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.MWe=new tc(this.$,this.Xn,this.ao),new $a(this.$,this.Xn,this.ao),this.KWe=new ee(this.$,this.Xn,this.ao),this.IWe=new Ue(this.$,this.Xn,this.ao),this.HWe=new gc(this.$,this.Xn,this.ao),this.LWe=new jc(this.$,this.Xn,this.ao),this.NWe=new Wb(this.$,this.Xn,this.ao),this.OWe=new rc(this.$,this.Xn,this.ao),this.$.m6&&(this.PWe=new Rc(this.$,this.Xn,this.ao,this)),this.QWe=new Gd(this.$,
this.Xn,this.ao,wa),this.fib=new kb(this,nb.f(this.$)),ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.GWe=new qb),this.FWe=new Ga(this.$,this.Xn,this.ao),this.initialized=!0,h.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}Twi(wa){if(!this.SCa)return null;for(let wb=0,zc=this.SCa.length;wb<zc;wb++)if(wa.startsWith(this.SCa[wb].WebExtensionId))return this.SCa[wb];return null}x7f(){var wa,wb=this.ea;if(wb.ki&&!this.Bbc){if(wb.workbookContext){if(this.emd=
this.$.ea.Vn.get(22),null===(wa=wb.workbookContext.WebExtensions)||void 0===wa?0:wa.length){wa=wb.workbookContext.WebExtensions;wb=!1;if(v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TelemetryForAddinsWithinFileEnabled",!1)&&0<wa.length){var zc=[];for(var Hc=wa.length-1;0<=Hc;Hc--)zc.push(Telemetry.PrivacyRules.GetPrivacyCompliantId(wa[Hc].PrimaryMarketplace.SolutionId,wa[Hc].PrimaryMarketplace.MarketplaceType,null,null,null,wa[Hc].PrimaryMarketplace.MarketplaceRef));
Dc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinsWithinFile",dataFields:ad.a.Pm({["solutionIds"]:zc})})}for(zc=wa.length-1;0<=zc;zc--){if(!this.ea.isNamedObjectViewMode){this.JQc.push(wa[zc].InstanceId);if(1!==wa[zc].WebExtensionType){wa.splice(zc,1);continue}if(Ad.HelperMethods.XF(wa[zc])&&0!==wa[zc].SharedRuntime.State)1===wa[zc].SharedRuntime.State?wa[zc].TaskpaneVisible=!1:2===wa[zc].SharedRuntime.State?wa[zc].TaskpaneVisible=!0:h.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");
else if(!wa[zc].ContainsCustomFunctions&&!wa[zc].TaskpaneVisible&&!fc.a(wa[zc])){wa.splice(zc,1);continue}}Hc=OSF.OsfControl.isFirstPartyStoreString(wa[zc].PrimaryMarketplace.MarketplaceType);if(ub.EwaSettings.Ra(174)&&!Hc&&(wa.splice(zc,1),!wb)){wb=!0;const ed=Object(Ob.d)(Yc.a.resolve(zd.C,{va:3}));Sd.TaskExtensions.Xa(ed,()=>{ed.result.Mm(36,null)},this.ya,3)}ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&wa[zc].PrimaryMarketplace&&Nd.T0a(wa[zc].PrimaryMarketplace.SolutionId)&&
(h.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),wa.splice(zc,1))}this.Yjf(wa)}}else this.emd=!1;this.Bbc=!0}}HOf(wa){const wb=nb.f(this.$),zc=wb.ha.$e.Lh;if(zc&&wa){wa=!1;if(this.Hl)for(const Hc of this.Hl)if(Nd.T0a(Hc.HX)||Nd.hmj(Hc.HX)||Nd.Qnj(Hc.HX)){wa=!0;break}wa||wb.ha.$e.qR(zc)}}YVj(){this.Dl&&this.ea.isNamedObjectViewMode&&this.$.ma&&Fd.n(this.$.ma)&&(zd.Ug.Aa()?this.webExtensionView.pY?this.webExtensionView.yUb():this.webExtensionView.aA(this.xsg):
tb.a(this.$).pY?tb.a(this.$).yUb():tb.a(this.$).aA(this.xsg))}Yjf(wa){let wb=null;wb=zc=>{const Hc=zc.WebExtensionData,ed=zc.IsTaskPane,rd=zc.RecordHandler,ve=()=>{this.X4a.shift();0<this.X4a.length&&wb(this.X4a[0])};if(this.m5(Hc.PrimaryMarketplace.SolutionId))ve();else{ed&&(Hc.WebExtensionOsfControlType=1);var Le=fc.a(Hc);if(!ed||Hc.TaskpaneVisible||Le||Hc.SharedRuntime&&0!==Hc.SharedRuntime.State||Hc.ContainsCustomFunctions){var Qe=new yb(this,this.ao,Hc,this.webExtensionView,!ed);h.ULS.sendTraceTag(537170517,
0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.PrimaryMarketplace.SolutionId,Hc.PrimaryMarketplace.MarketplaceType,null,null,null,Hc.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Hc.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Ad.HelperMethods.XF(Hc)}`);Qe.bTd();Ad.HelperMethods.XF(Hc)&&(Qe.GHa=Nd.iJa(Hc,this.$),Hc.TaskpaneWidth=this.sNb);Le&&(Hc.WebExtensionToolTip="");!ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&
ed&&Hc.TaskpaneVisible&&!Le&&(Hc.TaskpaneWidth=this.sNb);this.Hl.push(Qe);var Vb=this.ILa=null;Vb=pf.a.instance.HO(()=>{Qe.lG&&(Ac.a.dh(Vb),Vb=null,rd&&rd(zc,Qe),ve())},100,qf.a.xbi)}else ve()}};for(let zc=0;zc<wa.length;zc++){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Hc=wa[zc].WebExtensionType===OSF.OsfControlTarget.TaskPane,ed=fc.a(wa[zc]);Hc&&!ed&&(wa[zc].TaskpaneWidth=this.sNb)}if(!this.es(wa[zc].InstanceId))if(1!==wa[zc].WebExtensionType)this.xXa(wa[zc]);
else if(!ub.EwaSettings.Ra(52))this.XGb(wa[zc],wb);else if(this.$.Ij&8388608||wa[zc].TaskpaneVisible){const Hc={};Hc.solutionId=wa[zc].PrimaryMarketplace.SolutionId;Hc.version=wa[zc].PrimaryMarketplace.SolutionVersion;Hc.storeType=wa[zc].PrimaryMarketplace.MarketplaceType;Hc.storeId=wa[zc].PrimaryMarketplace.MarketplaceRef;Hc.targetData=wa[zc];this.Dl.isAddinCommandsAsync(Hc,(ed,rd,ve)=>{if(ed){var Le=ve.targetData;if(rd)if(Hc.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())ed=Hc.storeType.toLowerCase()===
OSF.StoreType.UploadFileDevCatalog.toLowerCase(),rd=Hc.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(ed||rd)&&Ad.HelperMethods.XF(Le)&&this.XGb(Le,wb);else if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.H3i(ve,wb);else{let Qe=!1;this.ife(Vb=>{if(!Vb.errorCode){if(Vb.value)for(const cd of Vb.value){if(Qe)break;Qe=va.e(cd[1])===va.e(Le.PrimaryMarketplace.SolutionId)}Qe?Ad.HelperMethods.XF(Le)&&this.XGb(Le,wb):(Vb={},
Vb.SolutionId=ve.solutionId,Vb.Version=ve.version,Vb.StoreType=Le.PrimaryMarketplace.MarketplaceType,Vb.StoreId=ve.storeId,Vb.AssetId=null,Vb.AssetStoreId=null,Vb.Width=Le.TaskpaneWidth,Vb.TargetType=Le.WebExtensionType,Le.TaskpaneVisible=!0,this.R0e(Vb,Le,wb))}},!0)}else this.XGb(Le,wb)}else ed=ve.targetData,h.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ed.PrimaryMarketplace.SolutionId,ed.PrimaryMarketplace.MarketplaceType,null,
null,null,ed.PrimaryMarketplace.MarketplaceRef)} from ${ed.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}H3i(wa,wb){let zc=!1;this.ife(Hc=>{const ed=wa.targetData;if(!Hc.errorCode){if(Hc.value)for(const rd of Hc.value){if(zc)break;zc=va.e(rd[1])===va.e(ed.PrimaryMarketplace.SolutionId)}zc?Ad.HelperMethods.XF(ed)&&this.XGb(ed,wb):(Hc={},Hc.SolutionId=wa.solutionId,Hc.Version=wa.version,Hc.StoreType=ed.PrimaryMarketplace.MarketplaceType,Hc.StoreId=wa.storeId,Hc.AssetId=null,Hc.AssetStoreId=
null,Hc.TargetType=ed.WebExtensionType,Hc.Width=ed.TaskpaneWidth,ed.TaskpaneVisible=!0,this.R0e(Hc,ed,wb))}},!0)}XGb(wa,wb){const zc={};zc.WebExtensionData=wa;zc.IsTaskPane=!0;this.X4a.push(zc);1===this.X4a.length&&wb(zc)}R0e(wa,wb,zc){const Hc={};Hc.ActivationInfo=wa;Hc.WebExtensionData=wb;Hc.IsTaskPane=!1;Hc.RecordHandler=(ed,rd)=>{const ve=ed.ActivationInfo;this.Dl.insertBlankControlWithErrorUX(this.T2b(rd,ve),()=>{this.p6a(rd.controlId);this.Dl.purgeOsfControl(rd.controlId,!1);this.c2g(ve)})};
this.X4a.push(Hc);1===this.X4a.length&&zc(Hc)}c2g(wa){var wb={};wb.solutionId=wa.SolutionId;wb.version=wa.Version;wb.storeType=wa.StoreType;wb.storeId=wa.StoreId;wb.assetId=wa.AssetId;wb.assetStoreId=wa.AssetStoreId;wb.targetType=wa.TargetType;wb.sharedRuntimeId=wa.SharedRuntimeId;wa=new L.a;wa.add(wb);wb={};wb[ba.a.hIb]=wa;wb[ba.a.U3]=3;wa=new Ec.a(Ic.a.aqb,0,this.$.ii,0,null);this.$.Ma.qh(wa,wb)}T2b(wa,wb){const zc={};zc.div=wa.lG;zc.id=wa.controlId;zc.solutionId=wb.SolutionId;zc.version=wb.Version;
zc.storeId=wb.StoreId;zc.storeType=wb.StoreType;zc.osfControlType=OSF.OsfControlTarget.TaskPane;return zc}vDg(){this.Hl.forEach(this.kjg);this.Hl.length=0;this.Bbc=!1}tEi(wa){const wb=wa.PrimaryMarketplace.MarketplaceType,zc=Nd.getSolutionId(wa,this.$);return wb===OSF.StoreType.InMemory&&zc.toLowerCase().startsWith("wa")?{solutionId:zc,HYg:OSF.StoreType.OMEX}:{solutionId:wa.PrimaryMarketplace.SolutionId,HYg:wb}}tga(wa){var wb;const zc=this.tEi(wa);return Telemetry.PrivacyRules.GetPrivacyCompliantId(zc.solutionId,
zc.HYg,null===(wb=wa.AssetMarketplace)||void 0===wb?void 0:wb.SolutionId,null,null,wa.PrimaryMarketplace.MarketplaceRef)}KNk(wa){var wb,zc;const Hc=wa.io,ed={AssetId:null===(wb=Hc.AssetMarketplace)||void 0===wb?void 0:wb.SolutionId,AssetStoreId:null===(zc=Hc.AssetMarketplace)||void 0===zc?void 0:zc.MarketplaceRef,EnabledInViewMode:!0,Height:0,IsToBePersisted:!1,SolutionId:Hc.PrimaryMarketplace.SolutionId,SourceLocationOverrideResourceId:Hc.SrcLocationOverrideResourceId,StoreId:Hc.PrimaryMarketplace.MarketplaceRef,
StoreType:Hc.PrimaryMarketplace.MarketplaceType,TargetType:Hc.WebExtensionType,Version:Hc.PrimaryMarketplace.SolutionVersion,Width:Hc.TaskpaneWidth},rd={width:Hc.TaskpaneWidth,Sx:Hc.TaskpaneIconCssClass,showLoadingSpinner:Hc.ShowLoadingSpinner,focusOnIframeWhenLoaded:Hc.FocusOnIframeWhenLoaded};let ve=ed.IsToBePersisted?0:16;const Le=this.$.pa.ta.Wh();ve|=64;this.fkd=!0;$c.a(this.$.userOperationManager,(Qe,Vb,cd)=>{var Ud=this.tga(Hc);h.ULS.sendTraceTag(507637774,0,50,`Silent Reload::showAgaveTaskpaneReload:Web Method ShowAgaveTaskpane is called, StoreType ${ed.StoreType}, StoreId ${ed.StoreId}, SolutionId ${Ud}.`);
Ud=this.$.pa.ta;Qe=Yb.c(Qe,this.Yvg);const re=Ud.$a(9,void 0===Le?null:Le);re.sharedInfo=ed;return ue.h(Ud,"ShowAgaveTaskpane",re,Qe,Vb,cd,rd,0)},Qe=>new oc.a(538,0,Qe,ve),null)}Ydj(wa){const wb=wa.io,zc={AssetId:wb.PrimaryMarketplace.SolutionId,AssetStoreId:wb.PrimaryMarketplace.MarketplaceRef,OwnerAddinSolutionId:wb.OwnerAddinSolutionId,OwnerAddinStoreType:wb.OwnerAddinStoreType,Preload:wb.Preload,SharedRuntimeId:wb.SharedRuntimeId,SolutionId:wb.PrimaryMarketplace.SolutionId,StoreId:wb.PrimaryMarketplace.MarketplaceRef,
StoreType:wb.PrimaryMarketplace.MarketplaceType,TargetType:wb.WebExtensionType,Version:wb.PrimaryMarketplace.SolutionVersion,Width:wb.TaskpaneWidth},Hc=this.$.pa.ta,ed=Hc.$a(9);ed.sharedInfo=zc;this.fkd=!0;$c.a(this.$.userOperationManager,(rd,ve,Le)=>{const Qe=this.tga(wb);h.ULS.sendTraceTag(507637771,0,50,`Silent Reload::insertAgaveSandboxReload:Web Method InsertAgaveTaskpane is called, StoreType ${zc.StoreType}, StoreId ${zc.StoreId}, SolutionId ${Qe}.`);return ue.h(Hc,"InsertAgaveTaskpane",ed,
Yb.c(rd,this.Yvg),Yb.b(ve,ve),Le,null,0)},rd=>new oc.a(500,0,rd,64),null)}mIg(){const wa=[];var wb=this.Hl.length;for(var zc=0;zc<wb;zc++){var Hc=this.Hl[zc];if(this.sUd){if(Hc.L_f&&this.vmj){wa.push(Hc);continue}const ed=fc.a(Hc.io),rd=3===Hc.osfControlType,ve=0===Hc.osfControlType||4===Hc.osfControlType;ed||rd?Hc.io.PrimaryMarketplace?"FA000000112"===Hc.io.PrimaryMarketplace.SolutionId?wa.push(Hc):ed?this.KNk(Hc):this.Ydj(Hc):(h.ULS.sendTraceTag(507642883,0,10,"Silent Reload::ResetOsfControlAfterServerReload: PrimaryMarketplace is null."),
wa.push(Hc)):ve&&wa.push(Hc)}else 0!==Hc.osfControlType&&3!==Hc.osfControlType&&4!==Hc.osfControlType||wa.push(Hc)}wb=!1;for(zc=0;zc<wa.length;zc++)Hc=wa[zc],this.p6a(Hc.controlId),!wb&&Hc&&Hc.io&&(wb=Ad.HelperMethods.XF(Hc.io));wb&&this.TU(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4});ub.EwaSettings.Ra(355)&&Sd.TaskExtensions.Xa(De.GetServiceTaskFactory.Tj(this.$.la,278,279,3),ed=>{ed&&(ed=ed.result)&&(this.$.la.lh(278)||this.$.la.Hh(278,ed),ed.QVf().UAa())},this.ya,3)}SV(){var wa=new Bc(this.$,
this.Xn,this.BJg);void 0===this.$||null===this.$?h.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ub.EwaSettings.Ra(234)&&h.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Xn||null===this.Xn));if(wa.sJj()){const wb=()=>{},zc=ed=>{ed=pe.a.kk(ed.data);h.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Qf.a.ei(ed)}.`)},
Hc=wa.QPh();wa=Nd.bNd(Hc);wa|=64;this.$.userOperationManager.WO(new oc.a(507,0,(ed,rd,ve)=>ue.h(this.$.pa.ta,"ExecuteRichApiRequest",this.SPh(Hc),Yb.c(ed,wb),Yb.b(rd,zc),ve,null,0),wa))}}SPh(wa){const wb=this.$.pa.ta.$a(1);wb.request=wa;return wb}Jef(wa,wb){if(wa)for(let zc=0;zc<wa.length;zc++)if(If.a.equals(wa[zc],wb,!0))return!0;return!1}ROh(wa){const wb={};wb.navigationMode=OSF.OsfNavigationMode.DefaultMode;wb.assetId=null;wb.category=null;if(!wa||3>wa.length)return wb;if(wa[0]){const zc=parseInt(wa[0],
10);isNaN(parseInt(zc,10))||(wb.navigationMode=zc)}wa[1]&&(wb.assetId=wa[1]);wa[2]&&(wb.category=wa[2]);return wb}Fbj(){var wa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(wa&&"*"!==wa.trim()){this.rYa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new vb(this),wa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.uk.get(2));try{this.rYa.init()}catch(wb){try{this.rYa.dispose()}catch(zc){}this.rYa=null;h.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+
wb.message)}wa={};wa.a=this.$.ua.UserSessionId;Of.b().Ll(39,wa)}}eUg(wa,wb,zc){const Hc=Nd.cOh(wa[0]),ed=Hc.Fua,rd=Hc.Gva;Hc.Fua=()=>{ed&&ed();const ve=Hc.i0a!==OSF.InfoType.Error?wb:null;wa.shift();wa.length?this.eUg(wa,ve,zc):ve&&ve()};Hc.Gva=()=>{rd&&rd();zc&&Hc.i0a!==OSF.InfoType.Error&&zc()};cb.a.Jse(Hc)}zNi(){const wa={};wa.AddinRibbonControlsOverriddenByApi=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();wa.AddinActionDefinitionHybridMode=
ub.EwaSettings.Ra(556).toString();wa.UseActionIdForUILessCommand=ub.EwaSettings.Ra(559).toString();wa.AllowStorageAccessByUserActivationOnIFrame=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();wa.RequirementSetRibbonApiOnePointTwo=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();wa.flightingTreatmentVariables=v.AFrameworkApplication.fa.QPb;wa.ShortcutInfoArrayInUserPreferenceData=
ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();wa.DisabledChangeGates=v.AFrameworkApplication.fa.Za("DisabledChangeGates");wa.DmsSdxListWorkbook=v.AFrameworkApplication.Dqf;wa.AddinDevicePermissionAllowList=v.AFrameworkApplication.fa.Za("AddinDevicePermissionAllowList");return wa}static get VLb(){return Nd.vJe}static set VLb(wa){Nd.vJe=wa}static getSolutionId(wa){let wb=wa.PrimaryMarketplace.SolutionId;ub.EwaSettings.Ra(261)&&wa.OwnerAddinSolutionId&&
(wb=wa.OwnerAddinSolutionId);return wb}static bNd(wa){return wa.RequestFlags&1&&256!==(wa.RequestFlags&256)?0:16}static iJa(wa,wb){wb=Nd.getSolutionId(wa,wb);return Nd.NFf(wb,wa.PrimaryMarketplace.SolutionVersion,wa.PrimaryMarketplace.MarketplaceType,wa.PrimaryMarketplace.MarketplaceRef)}static l9h(wa){return JSON.stringify({["recording"]:wa})}static u4h(wa){const wb={};wb.visibility=wa?"Visible":"Hidden";return JSON.stringify(wb)}static TIi(wa){const wb=wa.getSolutionId(),zc=wa.getVersion(),Hc=wa.getStoreType();
wa=wa.getStoreId();return Nd.NFf(wb,zc,Hc,wa)}static NFf(wa,wb,zc,Hc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",wa,wb,Nd.vXi(zc).toString(),Hc)}static hPd(wa,wb){var zc=wa.split("|");if(7>zc.length)return h.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==zc[0])return h.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${zc[0]}'.`),null;let Hc=zc[1];const ed=
zc[2],rd=Nd.wXi(zc[3]),ve=zc[4];zc=zc[5];Hc&&Hc.length||(Hc=zc);zc={};zc.InstanceId=String.format("{{{0}}}",M.a.create().toString());zc.WebExtensionOsfControlType=4;zc.WebExtensionType=1;zc.PrimaryMarketplace={};zc.PrimaryMarketplace.SolutionId=Hc;zc.PrimaryMarketplace.SolutionVersion=ed;zc.PrimaryMarketplace.MarketplaceRef=ve;zc.PrimaryMarketplace.MarketplaceType=rd;zc.ContainsCustomFunctions=wb?!0:!1;wb&&(zc.OsfPropertyBag=[["customFunctionAddinId",wa]]);return zc}static wXi(wa){wa=parseInt(wa,
10);return wa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:wa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:wa===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:wa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:wa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:wa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:wa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:wa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:wa===OSF.StoreTypeEnum.FirstParty?
OSF.StoreType.FirstParty:wa===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:wa===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static vXi(wa){return wa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:wa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:wa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:wa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:wa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:wa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:
wa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:wa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:wa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:wa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:wa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}mfa(wa){const wb={};wb.Version=wa.version;wb.AssetId=wa.assetId;wb.AssetStoreId=wa.assetStoreId;wb.StoreType=wa.storeType;wb.Height=wa.height;wb.SolutionId=
wa.solutionId;wb.StoreId=wa.storeId;wb.TargetType=wa.targetType;wb.Width=1===wb.TargetType?0:wa.width;wb.SharedRuntimeId=wa.sharedRuntimeId;return wb}static PVb(wa){return wa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||wa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||wa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||wa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||wa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||wa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
wa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||wa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static cOh(wa){return Object(b.a)(new Qb.a,{i0a:wa.infoType,id:wa.id,title:wa.title,description:wa.description,buttonText:wa.buttonTxt,Fua:wa.buttonCallback,TDc:wa.highPriority,Gva:wa.dismissCallback,errorCode:wa.errorCode,ITf:wa.iframeNotificationUrl})}static T0a(wa){let wb="FA000000014"===wa;wb||(wb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===wa);return wb}static hmj(wa){return"FA000000005"===
wa}static Qnj(wa){return"FA000000064"===wa}}Nd.aib=new O.a;Nd.vJe=!0;Nd.JAe=!0;Object(c.a)(Nd,"DdaFacade",xc.a,[733,847,848,849,850,2])},947:function(z,t,a){a.d(t,"a",function(){return b});z=a(0);var c=a(41);class b{static get dGj(){return b.tSe||(b.tSe={["-2002156328"]:b.Rgf,["-1954750170"]:b.ELf,["317650254"]:b.WYh,["-1005263101"]:b.afj,["1353664579"]:b.Vyk,["159671765"]:b.bfj,["1446690022"]:b.QFf,["1150069548"]:b.D2c,["-1409306331"]:b.Bdf,["338507772"]:b.wnf,["-457159301"]:b.u3j,["-1037701970"]:b.Yai,
["-1893322318"]:b.ffj,["965579896"]:b.$ai,["93287890"]:b.Zai,["358088857"]:b.ECk,["-1223650923"]:b.wnf,["2007306190"]:b.HUh,["1549955423"]:b.T$e,["-1275974171"]:b.efj,["382101082"]:b.m2j,["-898776235"]:b.HIj,["335464256"]:b.zIj,["1677378049"]:b.dfj,["-261992848"]:b.H4k,["-980820954"]:b.T$e,["-931375837"]:b.l2j,["929186550"]:b.mji,["-982144310"]:b.Bak,["-785741187"]:b.Zej,["2125217573"]:b.hfj,["299124955"]:b.$ej,["1669853884"]:b.Luk,["-1515932330"]:b.XYh,["314621024"]:b.nzi,["-300049690"]:b.LUh,["14766835"]:b.iIk,
["-1251992761"]:b.Xqf,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.NUa,["49173765"]:b.NUa,["-907155566"]:b.NUa,["-1201603824"]:b.NUa,["1541165282"]:b.NUa,["-1347753427"]:b.NUa,["134912532"]:b.NUa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static kCf(h){return c.a.Lw(b.dGj,
h.toString(),b.internalError)}}b.success=0;b.Rgf=1E3;b.ELf=1001;b.WYh=1002;b.afj=1003;b.Vyk=1004;b.bfj=1005;b.QFf=1008;b.qzf=1009;b.invalidSheetName=1014;b.D2c=2E3;b.Bdf=2001;b.wnf=2002;b.u3j=2003;b.Yai=2004;b.ffj=2005;b.$ai=2007;b.Zai=2008;b.ECk=2009;b.HUh=2014;b.Nyk=3E3;b.T$e=3002;b.efj=3004;b.m2j=3005;b.HIj=3006;b.zIj=3007;b.dfj=3008;b.H4k=3009;b.l2j=3010;b.iIk=4002;b.kbe=5E3;b.internalError=5001;b.Xqf=5002;b.OUb=5004;b.N5k=5007;b.n$i=5008;b.BHg=5011;b.invalidOrTimedOutSession=5012;b.f5c=5016;
b.NUa=5102;b.krk=5103;b.responsePayloadSizeLimitExceeded=5104;b.fUh=7001;b.tXg=7002;b.mji=8E3;b.Bak=8001;b.Zej=8010;b.hfj=8011;b.$ej=8012;b.Luk=8020;b.XYh=8021;b.nzi=8022;b.LUh=8023;b.KFj=11E3;b.xJj=11001;b.gfj=11002;b.tSe=null;Object(z.a)(b,"DdaErrorIds",null,[])},948:function(z,t,a){a.d(t,"a",function(){return h});z=a(0);var c=a(15),b=a(92);class h{constructor(){this.Ghe=0;this.C7={};this.eHa={}}WRi(r,e){return this.C7[h.otd(r,e)]}ftf(r,e){e||void 0!==this.eHa[r]&&null!==this.eHa[r]?e&&void 0!==
this.eHa[r]&&null!==this.eHa[r]&&delete this.eHa[r]:this.eHa[r]=1}Mnc(r){return void 0===this.eHa[r]||null===this.eHa[r]}eQd(r){const e=h.otd(r.messageType,r.targetId);1===r.actionType?this.r4i(r.controlId,r.messageType,e):2===r.actionType&&this.t5i(r.controlId,r.messageType,e)}Xjk(r){if(r){var e=Object.keys(this.C7);if(!(void 0===e||null===e||0>=e.length))for(const k of e)e=this.C7[k],e[r]&&(delete e[r],Object.keys(e).length||delete this.C7[k])}}WR(r,e){r=h.otd(r,e);r=this.C7[r];return!!r&&0<Object.keys(r).length}p6i(){return!b.a.isEmpty(this.C7)}q3f(){return 0<
this.Ghe}YKi(){const r=[],e=this.C7;for(const x in e){var k=x,m=e[x];for(const n in m){m=n;const u={};u.eventType=parseInt(k.split("#")[0],10);u.targetId=k.split("#")[1];u.addinId=m;r.push(u)}}return r}r4i(r,e,k){if(this.C7[k])k=this.C7[k],k[r]=k[r]?k[r]+1:1;else{const m={};m[r]=1;this.C7[k]=m}100===e&&this.Ghe++}t5i(r,e,k){if(this.C7[k]){const m=this.C7[k];if(r){const x=m[r];1===x?(delete m[r],Object.keys(m).length||delete this.C7[k]):m[r]=x-1;100===e&&this.Ghe--}else c.ULS.sendTraceTag(537170459,
0,50,`The OsfControl[${r}] doesn't register event with key[${k}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${k}] that will be unregistered doesn't exist.`)}static otd(r,e){return String.format("{0}#{1}",r,e)}}h.VV="Workbook";Object(z.a)(h,"RichApiEventRegistration",null,[])},949:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.xmd="AccessDenied";c.notSupported=
"NotSupported";c.knc="ApiNotAvailable";c.jfg="NotAllowed";c.fbe="OperationCancelled";c.cBe="UserNotSignedIn";c.Hzb="UserAborted";c.Q5k="UnsupportedUserIdentity";c.fnb="InvalidResourceUrl";c.qFc="InvalidGrant";c.wFh="AddinIsAlreadyRequestingToken";c.Vsk="ResourceNotAllowed";c.Mqc="ClientError";c.serverError="ServerError";c.$1h="ControlIdNotFound";c.Wtk="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";
Object(z.a)(c,"ErrorCodes",null,[])},984:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{constructor(b,h,r,e){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=h;this.ddaBinding=r;this.ArrayData=void 0===e?null:e}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(z.a)(c,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/a59de69fc1adf07c38dbcc4fd33a1f44/EwaTS.agave.js.map