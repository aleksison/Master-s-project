'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1309:function(z,t,a){t=a(483);a=a(1484);a=a.Mw?a.default:a;"string"===typeof a&&(a=[[z.i,a,""]]);t(a,{insert:"head",bD:!1});z.exports=a.FH||{}},1484:function(z,t,a){t=a(484)(!1);t.push([z.i,".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}",
""]);z.exports=t},1485:function(z,t,a){(function(c){a.d(t,"a",function(){return K});var b=a(0),h=a(15),r=a(189),e=a(153),k=a(1486),m=a(40),x=a(287),n=a(46),u=a(427),v=a(216),w=a(64),l=a(83),y=a(12),B=a(23),A=a(47),E=a(1487),N=a(1),D=a(101),U=a(5);class K extends m.a{constructor(M,O,R,J){super();this.z9i=k.a.getTypeName();this.XTb=this.q4=this.Nh=null;this.imageHeight=this.imageWidth=0;this.g0a=this.errorMessage=this.tableData=null;this.gSd=0;this.zmd=!1;this.vnf=aa=>{if(aa){var S={};if((()=>{let V=
A.d(this.Obi(aa.data));({wz:S}=V);return V})().returnValue){var C=Object(e.a)(Object,S);if("."===C.DataFromPictureWildcard)if(C.SessionId!==this.g0a)h.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(h.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),C.CmdType){case "ACK":this.zmd=!0;
this.x_g.stop();h.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.Bzk();0<this.errorMessage.length?this.bNg():0<this.tableData.length&&this.tNg();break;case "insert_html":const V=this.$.pa.ta,X={};var L=B.f(this.$).ha.qa.jj.clone();X.PasteId=r.a.create().toString();X.DestinationRanges=n.u(n.x(L,this.$));L=C.Parameters.split("|",3);N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||h.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${L[0]}|${L[1]}|${L[2]}.`);L=C.Parameters.indexOf("|");L=C.Parameters.indexOf("|",L+1);L=C.Parameters.indexOf("|",L+1);X.SourceHtml=C.Parameters.substring(L+1);X.CopyOperationId=null;const la=V.$a(1,V.Wh());la.pasteHtmlParameters=X;u.a(this.$.userOperationManager,(Va,na,db)=>w.h(V,"pasteHtmlContent",la,Va,na,db,null,64),Va=>new v.a(204,0,Va,1),null);this.gSd++;h.ULS.sendTraceTag(523805135,
0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.gSd.toString()}`);D.b("DataFromPictureCompleted")}}}};this.y9i=(aa,S)=>{if(aa=S.annotation)if(!S.parentPath||1>=S.parentPath.length||S.parentPath[1]!==this.g0a)h.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{h.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
S=aa.errorCode;switch(S){case null:case -1:this.errorMessage=y.a.instance.ia(2273);break;case 1:this.errorMessage=y.a.instance.ia(2274);break;case 2:this.errorMessage=y.a.instance.ia(2275)}0<this.errorMessage.length&&h.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${S?S.toString():"null"}.`);this.T6e.stop();this.tableData=aa.html;this.zmd&&(0<this.errorMessage.length?this.bNg():0<this.tableData.length&&this.tNg())}else h.ULS.sendTraceTag(523805125,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=M;this.ddaFacade=J;this.Zo=O;this.uploaderCreator=R;this.initialize()}dispose(){window.removeEventListener("message",this.vnf,!1);this.Zo.unregister("DataFromPicture");super.dispose()}C_j(M,O){h.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let R=new Image;R.onload=()=>{var J=document.createElement("canvas");J.width=R.width;J.height=R.height;const aa=
J.getContext("2d");try{aa.drawImage(R,0,0,R.width,R.height)}catch(L){h.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${L.message}`);return}let S;try{S=J.toDataURL("image/jpeg")}catch(L){h.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${L.message}`);return}J=S.split(",");if(2>J.length)h.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{J=J[1];try{var C=window.self.atob(J)}catch(L){h.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${L.message}`);return}28E5<C.length?(h.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),O.JOk()):(this.lvk(this.Nh,this.q4,J,R.width,R.height),URL.revokeObjectURL(R.src),R=null,h.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
R.src=M}e9j(M,O,R,J){this.Nh=M;this.q4=J;this.uploaderCreator.Pbj(this.$,O,R,J,this)}lvk(M,O,R,J,aa){this.g0a=r.a.create().toString();this.gSd=0;this.XTb=R;this.imageWidth=J;this.imageHeight=aa;this.errorMessage=this.tableData="";this.zmd=!1;this.x_g=this.$.Eh.em("LoadResource","DataFromPictureTaskpaneLaunch");this.x_g.start();this.h2j(M,O);this.T6e=this.$.Eh.em("LoadResource","DataFromPictureAnnotation");this.T6e.start();this.X$k()}X$k(){if(this.XTb.length){var M=window.self.atob(this.XTb),O=new Uint8Array(M.length);
for(let R=0;R<M.length;R++)O[R]=M.charCodeAt(R);this.Zo.W$k(O,this.g0a,this.imageWidth,this.imageHeight)}else h.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}h2j(M,O){O.SessionID=this.g0a;O.DataFromPictureAssetId="FA000000050";O.LoadDataFromPictureTaskpane=!0;M=new l.a(-859308420,M.method,M.mode,M.ik,M.tabName);this.$.Ma.qh(M,O)}CDd(M){try{const O=c.from(M,"utf16le").toString("base64");return E.a.nXa(this.g0a,O)}catch(O){return h.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Obi(M){try{const O=E.a.nXa(this.g0a,M);return c.from(O,"base64").toString("utf16le")}catch(O){return h.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}Bzk(){if(this.XTb.length){var M=U.xb.Aa()?this.ddaFacade.m5("FA000000050"):x.a(this.$).m5("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.imageData=this.CDd(this.XTb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,
"onCustomMessage",O,R=>{R&&h.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else h.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}tNg(){if(this.tableData.length){var M=U.xb.Aa()?this.ddaFacade.m5("FA000000050"):x.a(this.$).m5("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.tableHtml=this.CDd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,
"onCustomMessage",O,R=>{R&&h.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else h.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}bNg(){if(this.errorMessage.length){var M=U.xb.Aa()?this.ddaFacade.m5("FA000000050"):x.a(this.$).m5("FA000000050"),O={["DataFromPictureWildcard"]:"."};O.errorMessage=this.CDd(this.errorMessage);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,"onCustomMessage",O,R=>{R&&h.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else h.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.vnf,!1);this.Zo.register(this.Zo.v5().b8("DataFromPicture").a8(()=>
{}).activateAnnotation({annotationType:this.z9i,Jy:!1,uV:this.y9i}).build())}}Object(b.a)(K,"DataFromPictureManager",m.a,[746])}).call(this,a(774).Buffer)},1486:function(z,t,a){a.d(t,"a",function(){return b});z=a(0);t=a(937);var c=a(913);class b extends t.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(z.a)(b,"DetectedHtmlTableAnnotation",t.a,[])},1487:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{static nXa(b,h){if(!(b&&h&&b.length&&h.length)||256<b.length)return"";const r=Array(256),e=Array(256);let k,m=0,x=0;let n,u="";for(k=0;256>k;k++)r[k]=k;for(k=0;256>k;k++){var v=b.charCodeAt(k%b.length);if(256<=v)return"";m=(m+r[k]+v)%256;v=r[k];r[k]=r[m];r[m]=v}for(k=0;256>k;k++)e[k]=r[256-k-1];m=k=0;for(b=0;b<h.length;b++){k=(k+1)%256;m=(m+r[k])%256;v=r[k];r[k]=r[m];r[m]=v;v=h.charCodeAt(b);
if(256<=v)return"";n=v^r[(r[k]+r[m])%256];x=(x+e[k])%256;v=e[k];e[k]=e[x];e[x]=v;u+=String.fromCharCode(n^r[(e[k]+e[x])%256])}return u}}Object(z.a)(c,"RC4A",null,[])},185:function(z,t,a){function c(F,ua){if(!ua)return F;ua=ua.sheet;if(!ua)return F;ua=ua.cssRules;if(!ua)return F;var jb=Array.clone(ua);jb.reverse();let pc=ua=0,Vc=0,pd=0;for(const Md of jb){jb=Md.style;var gd=Md.selectorText;jb=jb?jb.cssText:null;gd=gd?gd.split(","):null;if(jb&&gd&&Md.type===Md.STYLE_RULE){pd+=gd.length;for(const ze of gd){0<=
ze.indexOf("#")&&ua++;0<=ze.indexOf(".")&&pc++;0>ze.indexOf("#")&&0>ze.indexOf(".")&&Vc++;gd=null;try{gd=F.querySelectorAll(ze)}catch(T){L.ULS.sendTraceTag(507536148,0,50,"Exception in querySelectorAll: {0}",T.message)}if(gd)for(let T=0;T<gd.length;T++)gd[T].setAttribute("style",jb+(gd[T].getAttribute("style")||""))}}}L.ULS.sendTraceTag(507536147,0,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",pd,ua,pc,Vc);return F}function b(F){if(void 0===F||-1===
F.indexOf("px"))return 0;F=F.match($f);let ua=11;F&&(1===F.length?ua=parseFloat(F[0]):3===F.length&&(ua=parseFloat(F[1])));return ae.HelperMethods.DRc(ua)}function h(F){const ua=[];if("none"!==F.borderTopStyle&&""!==F.borderTopStyle){var jb=b(F.borderTopWidth);ua.push({BorderLineStyle:r(F.borderTopStyle,jb),BorderPosition:0,Weight:jb,Color:e(F.borderTopColor)})}"none"!==F.borderBottomStyle&&""!==F.borderBottomStyle&&(jb=b(F.borderBottomWidth),ua.push({BorderLineStyle:r(F.borderTopStyle,jb),BorderPosition:1,
Weight:jb,Color:e(F.borderBottomColor)}));"none"!==F.borderLeftStyle&&""!==F.borderLeftStyle&&(jb=b(F.borderLeftWidth),ua.push({BorderLineStyle:r(F.borderTopStyle,jb),BorderPosition:2,Weight:jb,Color:e(F.borderLeftColor)}));"none"!==F.borderRightStyle&&""!==F.borderRightStyle&&(jb=b(F.borderRightWidth),ua.push({BorderLineStyle:r(F.borderTopStyle,jb),BorderPosition:3,Weight:jb,Color:e(F.borderRightColor)}));return ua}function r(F,ua){switch(F){case "solid":return 1>ua?1:1.5>ua?2:5;case "dashed":return 1>
ua?3:8;case "double":return 6;case "dotted":return 4;case "dotDash":return 10;case "dotDotDash":return 1>ua?12:10;case "dotDashSlanted":return 13;case "triple":return 6;case "hairline":return 7;default:return 0}}function e(F){const ua={};if(void 0===F||""===F)return ua.Red=0,ua.Green=0,ua.Blue=0,ua;Va.a.compare(F,"windowtext",!0)?(F=Ed.a.Mu(F),ua.Red=F.r,ua.Green=F.g,ua.Blue=F.b):(ua.Red=0,ua.Green=0,ua.Blue=0);return ua}function k(F){F=Ed.a.Mu(F);return Ed.a.DJ(F)}function m(F,ua,jb,pc,Vc){try{if(ua&&
F.parentElement){jb.fontFamily="Aptos Narrow";if(Vc.map(Md=>Md.ZGa.fontFamily).some(Md=>Md)&&ua.fontFamily){const Md=ua.fontFamily.replace(/['"]+/g,"").split(",");0<Md.length&&(Jf.hasOwnProperty(Md[0])?jb.fontFamily=Jf[Md[0]]:jb.fontFamily=Md[0])}jb.fontSize=11;const pd=Vc.map(Md=>Md.ZGa.fontSize),gd=Vc.map(Md=>Md.element.tagName);(pd.some(Md=>Md)||gd.some(Md=>ge.includes(Md)))&&ua.fontSize&&(jb.fontSize=Math.round(b(ua.fontSize)));ua.fontWeight&&700<=parseInt(ua.fontWeight,10)&&(jb.bold=!0);jb.borders=
h(ua);ua.textDecoration&&"underline"===ua.W_g&&("solid"===ua.X_g?jb.Lwe=1:"double"===ua.X_g&&(jb.Lwe=2));ua.textDecoration&&"line-through"===ua.W_g&&(jb.vBf=!0);jb.color="#000000";Vc.map(Md=>Md.ZGa.color).some(Md=>Md)&&ua.color&&(jb.color=k(ua.color));if(pc){const Md=F.parentElement.closest("td,th");jb.backgroundColor=Md.style.backgroundColor?k(Md.style.backgroundColor):""}if("italic"===ua.fontStyle||"oblique"===ua.fontStyle)jb.italic=!0}}catch(pd){L.ULS.sendTraceTag(507377813,0,10,"CssStyleProcessor.setHtmlCellStyle: Error while setting cell style",
pd)}return jb}a.r(t);var x={};a.r(x);a.d(x,"FocusBasedReadout",function(){return Da});var n={};a.r(n);a.d(n,"AriaLiveNotifier",function(){return Ua});var u={};a.r(u);a.d(u,"DataFromPictureCommandHandler",function(){return sa});var v={};a.r(v);a.d(v,"EmbeddedWorkbookReadoutHandler",function(){return cb});var w={};a.r(w);a.d(w,"EwaAccessibilityManager",function(){return La});var l={};a.r(l);a.d(l,"GridHighlightBehaviorEventManager",function(){return ia});var y={};a.r(y);a.d(y,"GridHighlightsBehaviorManager",
function(){return Yb});var B={};a.r(B);a.d(B,"PictureCommandHandler",function(){return sd});var A={};a.r(A);a.d(A,"PasteIndicationManager",function(){return ef});var E={};a.r(E);a.d(E,"PasteShortcutManager",function(){return zf});var N={};a.r(N);a.d(N,"SelectionReadoutHandler",function(){return se});var D={};a.r(D);a.d(D,"SessionReloadActivity",function(){return H});var U={};a.r(U);a.d(U,"SessionReloadSilentActivity",function(){return ta});var K={};a.r(K);a.d(K,"SparklineManager",function(){return cc});
var M={};a.r(M);a.d(M,"TableManager",function(){return Oe});var O={};a.r(O);a.d(O,"UploaderCreator",function(){return Na});var R={};a.r(R);a.d(R,"WorkbookReadoutHandler",function(){return Pa});var J={};a.r(J);a.d(J,"HtmlProcessor",function(){return ng});var aa={};a.r(aa);a.d(aa,"PastableIframe",function(){return eg});var S=a(135),C=a(0),L=a(15),V=a(29),X=a(7),la=a(16),Va=a(28),na=a(12),db=a(438),ja=a(23),ea=a(33);class Z{constructor(F){this.sWc=F||""}static get Vsf(){return Z.lLe||(Z.lLe=new Z(""))}static get D3d(){return Z.URe||
(Z.URe=Z.ega(2).sWc)}static Bwa(F){F=ea.a.Or(F||"");return new Z(F)}static uQb(F){return Z.Bwa(na.a.instance.ia(F))}static ega(F){return new Z(na.a.instance.Ea(F))}static lCf(F,...ua){return Z.lAi(na.a.instance.sh(F),...ua)}static lAi(F,...ua){const jb=ua.length,pc=Array(jb);for(let Vc=0;Vc<jb;Vc++)pc[Vc]=(ua[Vc]||Z.Vsf).sWc;return new Z(String.format(F,pc))}}Z.lLe=null;Z.URe=null;Object(C.a)(Z,"SafeHtml",null,[251]);const ba=(F,ua)=>{ua&&(F.append(ua),F.append(Z.D3d))};var ya=a(1),Qa=a(181),va=a(126),
Ia=a(161),Sa=a(103),Xa=a(955),da=a(35),Ea=a(248),qa=a(5),za=a(95),ma;let Da=ma=class{constructor(F,ua,jb){this.aca=this.R1=this.IV=null;this.xwa=qa.uc.Aa()?ua.cellTextEditBox.Wa.Yl:jb;this.k9h(F);this.Z8j()}get isActive(){return!!this.xwa&&document.activeElement===this.xwa}readText(F){F=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?F:String.format(na.a.instance.sh(30),F);this.IV.setAttribute(X.a.rD,F);this.R1.setAttribute(X.a.rD,F);this.XWk()}dispose(){this.aca&&
this.aca.parentNode&&this.aca.parentNode.removeChild(this.aca);this.R1=this.IV=this.aca=this.xwa=null}k9h(F){var ua=F.xi+"readoutElementWrapper";const jb=F.xi+"readoutElement1",pc=F.xi+"readoutElement2";this.aca=document.getElementById(ua);this.aca||(this.aca=document.createElement(Ea.a.div),this.aca.id=ua,this.IV=document.createElement(Ea.a.label),this.IV.id=jb,this.IV.setAttribute(X.a.hk,X.a.Wnc),this.IV.setAttribute("aria-roledescription",""),this.IV.setAttribute("aria-multiline",!1),this.R1=document.createElement(Ea.a.label),
this.R1.id=pc,this.R1.setAttribute(X.a.hk,X.a.Wnc),this.R1.setAttribute("aria-roledescription",""),this.R1.setAttribute("aria-multiline",!1),this.IV.style.width="0px",this.IV.style.height="0px",this.R1.style.width="0px",this.R1.style.height="0px",this.IV.tabIndex=-1,this.R1.tabIndex=-1,this.aca.appendChild(this.IV),this.aca.appendChild(this.R1),F=F.xi+X.a.Orc,ua=document.getElementById(F),L.ULS.shipAssertTag(537153942,3,!!ua,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${F}`),
ua&&ua.appendChild(this.aca))}Z8j(){this.xwa&&this.IV&&this.R1&&(this.xwa.setAttribute(X.a.Dea,this.IV.id),this.xwa.setAttribute(X.a.Vnc,`${this.IV.id} ${this.R1.id}`))}XWk(){if(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.isActive){let F="";la.DOMElementExtensions.hasAttribute(this.xwa,X.a.Dea)&&(F=this.xwa.getAttribute(X.a.Dea).toString());this.xwa.setAttribute(X.a.Dea,F===this.IV.id?this.R1.id:this.IV.id)}this.isActive||L.ULS.sendTraceTag(537153941,
0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static Wnb(){if(null==ma.eQb)if(da.a.uoa){if(ma.eQb=!1,da.a.sP||da.a.Am)ma.eQb=!0}else ma.eQb=!0;return ma.eQb}};Da.eQb=null;Da=ma=Object(S.__decorate)([Object(za.d)(qa.uc),Object(S.__param)(0,Object(qa.Nb)()),Object(S.__param)(1,Object(qa.id)())],Da);Object(C.a)(Da,"FocusBasedReadout",null,[228,2]);let Ua=class{constructor(F,ua,jb,pc){jb=void 0===jb?F.pK:jb;pc=void 0===pc?F.Cl:pc;this.ZMg=()=>{this.$.ea.ki||Qa.a.sendTelemetryEvent({name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",
dataFields:va.a.Pm({["AriaLiveOffCount"]:this.nHe,["AriaLivePoliteCount"]:this.oHe,["AriaLiveAssertiveCount"]:this.mHe,["AriaLiveRudeCount"]:this.pHe,["ScreenReaderDivCount"]:this.nXe,["AlertScreenReaderDivCount"]:this.XGe,["AuxScreenReaderDivCount"]:this.xHe,["AriaAlertCount"]:this.kHe,["ReadCommandOnCompletionCount"]:this.SVe,["TotalAriaLiveRegionUpdates"]:this.a_e})})};this.$=F;this.Bi=void 0===ua?null:ua;this.Oja=document.createElement("div");this.Oja.setAttribute(X.a.Eea,X.a.Ir);this.Oja.className=
V.J;jb.insertBefore(this.Oja,pc);this.Qka=document.createElement("div");this.Qka.setAttribute(X.a.Eea,X.a.Ir);this.Qka.className=V.J;jb.insertBefore(this.Qka,this.Oja);this.hph=na.a.instance.Ea(2);this.Hea=document.createElement("div");this.Hea.setAttribute(X.a.hk,X.a.jua);this.Hea.setAttribute(X.a.kua,X.a.CVa);this.Hea.className=V.J;jb.insertBefore(this.Hea,this.Qka);this.a_e=this.SVe=this.kHe=this.xHe=this.XGe=this.nXe=this.pHe=this.mHe=this.oHe=this.nHe=0;this.register();ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)||this.$.la.Hh(211,this)}get e3a(){return this.hph}get isActive(){return!0}get BGh(){return this.Oja}get oxk(){return this.Qka}get activeCell(){return ja.f(this.$).zh(null)}dispose(){this.$&&this.unregister();la.DOMElementExtensions.$m(this.Hea);la.DOMElementExtensions.$m(this.Oja);la.DOMElementExtensions.$m(this.Qka);this.Qka=this.Oja=this.Hea=this.$=null}setEnabled(F){this.NOg(this.Qka,F)}bDk(){this.NOg(this.Oja,!0)}readText(F){this.H3b(Z.Bwa(F),!0)}$ba(F){this.H3b(Z.Bwa(F),!1)}$Ag(F,ua){if(1>
ua||!F)L.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var jb=new Sys.StringBuilder;F=String.format(na.a.instance.sh(34),ua,F);ba(jb,F);ba(jb,na.a.instance.ia(857));this.H3b(Z.Bwa(jb.toString()),!1)}}tek(F,ua,jb){if(1>jb||1>ua||ua>jb||!F)L.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var pc=new Sys.StringBuilder;ba(pc,F);pc.append(String.format(na.a.instance.sh(55),ua,jb));this.H3b(Z.Bwa(pc.toString()),!1)}}rek(F){F=this.aVi(F);this.H3b(F,!1,
!0)}H3b(F,ua,jb){jb=void 0===jb?!1:jb;if(F=F?F.sWc:null)ua=ua?this.Qka:this.Oja,Va.a.equals(ua.innerHTML,F,!1)&&(F+=Z.D3d),this.H1g(ua,jb),this.Bi.zr(ua,F)}L5a(F,ua){this.Hea.getAttribute(X.a.kua)!==ua&&this.Hea.setAttribute(X.a.kua,ua);F=F?Z.Bwa(F).sWc:"";this.H1g(this.Hea);this.Bi.zr(this.Hea,F)}uek(F,ua,jb,pc){var Vc=!0;Vc=void 0===Vc?!1:Vc;const pd=na.a.instance.sh(54);L.ULS.shipAssertTag(537153949,0,!(void 0===F||null===F));L.ULS.shipAssertTag(537153948,0,!(void 0===ua||null===ua));L.ULS.shipAssertTag(537153947,
0,!(void 0===jb||null===jb));L.ULS.shipAssertTag(537153946,0,!(void 0===pc||null===pc));L.ULS.shipAssertTag(537153945,0,!(void 0===pd||null===pd));F=String.format(pd,F||"",ua||"",jb||"",pc||"");Vc?this.L5a(F,X.a.qGa):this.readText(F)}e6k(F){var ua=this.Qka.style;F?(F=db.a.uQh(F.cell,ua),ua=F.hF,ua.top=ua.left=ua.bottom=ua.right=null,F.Y9()):ua.cssText=""}aVi(F){if(6!==F.ik)return null;const ua=this.activeCell;if(!ua)return null;switch(F.command){case -1985798686:return Z.uQb(12);case -911352779:return Z.uQb(11);
case 237279923:return Z.uQb(13);case -1502853784:return Z.ega(81);case -111689794:return Z.ega(78);case 368460465:F=ja.f(this.$).oh.Kl(ua.range,!0);if(null!==F)return this.e_a(2291,!F.hasAutoFilter,!1);F=this.$.sa.ma;if(!F)break;return this.e_a(2291,null===F.qL,!1);case -1522760979:return this.e_a(1150,ja.f(this.$).isFormulaView,!1);case 1941920197:return Z.uQb(836);case 1051390410:return Z.ega(589);case 1542466017:return Z.ega(591);case -706918724:return Z.ega(590);case 369708605:return Z.ega(592);
case -1215659745:return Z.ega(523);case 1783960667:return Z.ega(521);case -1355155015:return Z.ega(554);case -1158102843:return Z.ega(522);case -287251124:return F=this.ZGc(F.command,ua),null===F?null:this.e_a(1333,F);case -1925065947:return F=this.ZGc(F.command,ua),null===F?null:this.e_a(1334,F);case 1764140053:return F=this.ZGc(F.command,ua),null===F?null:this.e_a(1335,F);case -1590502662:return F=this.ZGc(F.command,ua),null===F?null:this.e_a(1336,F);case 862890474:case 963349338:F=this.HJa(ua);
if(null===F)break;F=Z.Bwa(String(F));return Z.lCf(214,F);case 1896159024:return Z.Bwa(na.a.instance.sh(228));case -1554384558:return Z.Bwa(na.a.instance.sh(229))}return null}register(){L.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(L.ULS.shipAssertTag(537153943,0,!!this.$.Ma,"Can't register to CommandHandlerManager's event"),this.$.ea&&this.$.ea.dK(this.ZMg))}unregister(){this.$&&this.$.ea.gL(this.ZMg)}NOg(F,ua){const jb=F===this.Oja;ua?(jb&&Da.Wnb()||F.setAttribute(X.a.kua,
X.a.qGa),jb&&F.setAttribute(X.a.hk,X.a.jua),F.setAttribute(X.a.Eea,X.a.jC),F.removeAttribute(X.a.Eea),this.Bi.zr(F,F.innerHTML+" ")):(F.removeAttribute(X.a.kua),jb&&F.removeAttribute(X.a.hk),F.setAttribute(X.a.Eea,X.a.Ir))}H1g(F,ua){ua=void 0===ua?!1:ua;switch(F.getAttribute(X.a.kua)){case X.a.Y8e:++this.nHe;break;case X.a.qGa:++this.oHe;break;case X.a.CVa:++this.mHe;break;case X.a.HJh:++this.pHe}switch(F){case this.oxk:++this.nXe;break;case this.BGh:++this.XGe;break;case this.Hea:++this.xHe}F.getAttribute(X.a.hk)===
X.a.jua&&++this.kHe;ua&&++this.SVe;this.a_e++}e_a(F,ua,jb){jb=void 0===jb?!0:jb;return Z.lCf(ua?jb?7:216:jb?8:217,Z.uQb(F))}ZGc(F,ua){return ja.f(this.$).ha.$e.isFloatingObjectSelected?this.Ykj(F):this.Zkj(F,ua)}Ykj(F){const ua={};switch(F){case -287251124:F="QueryBold";break;case -1925065947:F="QueryItalics";break;case 1764140053:F="QueryUnderline";break;case -1590502662:F="QueryStrikethrough";break;default:return!1}const jb=Sa.a(this.$);return jb?(jb.E_a(F,ua),ua[Xa.a.On]):!1}Zkj(F,ua){if(!ua)return null;
var jb=ja.f(this.$);ua=Ia.a(ua);jb.isEditing&&(ua.Font=jb.Bp.IJa(ua.Font));jb=ua.Font;switch(F){case -287251124:return jb.Bold;case -1925065947:return jb.Italic;case 1764140053:return jb.Underline;case -1590502662:return jb.Strikethrough}return!1}HJa(F){if(!F)return null;const ua=ja.f(this.$);if(ua.ha.$e.isFloatingObjectSelected)return null;F=Ia.a(F);ua.isEditing&&(F.Font=ua.Bp.IJa(F.Font));return F.Font.FontSize}};Ua=Object(S.__decorate)([Object(za.d)(qa.l),Object(S.__param)(0,Object(qa.Nb)()),Object(S.__param)(1,
Object(qa.pd)())],Ua);Object(C.a)(Ua,"AriaLiveNotifier",null,[227,228,2]);var ka=a(97),xa=a(6),Fb=a(1485),bb=a(269),Ja=a(211),mb=a(67);let sa=class{constructor(F,ua,jb,pc){this.gNb=null;this.$=F;this.ddaFacade=pc;ua?(L.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.gNb=new Fb.a(F,ua,jb,this.ddaFacade)):L.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Ri(){return!1}executeCommand(F,
ua,jb){F=!1;switch(ua.command){case 73979048:this.gNb&&this.gNb.e9j(ua,ka.TaskManager.instance,xa.AFrameworkApplication.fa,jb),F=!0}return F?mb.Task.Ua(!0):Ja.a(ua.command)}Gi(F,ua){return 73979048===ua.command&&xa.AFrameworkApplication.dba(bb.a)}dj(){return!1}dispose(){this.gNb&&this.gNb.dispose()}};sa=Object(S.__decorate)([Object(za.d)(qa.qb),Object(S.__param)(0,Object(qa.Nb)()),Object(S.__param)(1,Object(qa.p)()),Object(S.__param)(2,Object(qa.Lg)()),Object(S.__param)(3,Object(qa.xb)())],sa);Object(C.a)(sa,
"DataFromPictureCommandHandler",null,[43,2]);class oa{constructor(F,ua){this.$=ua;this.ariaLiveNotifier=F}dBg(){const F=this.LEi();this.ariaLiveNotifier.L5a(F,X.a.CVa)}LEi(){const F=new Sys.StringBuilder;this.$.workbookContext&&ba(F,this.$.workbookContext.WorkbookFileName);ba(F,na.a.instance.ia(855));ba(F,this.NEi());ba(F,this.MEi());ba(F,na.a.instance.ia(856));return F.toString()}NEi(){return this.$.isEditMode?na.a.instance.ia(860):na.a.instance.ia(861)}MEi(){var F=this.rdl();const ua=this.$.sa.ma;
F=1!==F?String.format(na.a.instance.sh(32),F):na.a.instance.ia(854);F=new Sys.StringBuilder(F);ua&&ua.sheetName&&(F.append(Z.D3d),F.append(String.format(na.a.instance.sh(33),ua.sheetName)));return F.toString()}rdl(){let F=0;for(const ua of this.$.sa.items)ua.visible&&F++;return F}}Object(C.a)(oa,"WorkbookReadout",null,[]);let cb=class{constructor(F,ua,jb){this.Amg=()=>{this.DCe.dBg();this.ariaLiveNotifier.setEnabled(!0)};this.$=ua;this.ariaLiveNotifier=F;this.DCe=new oa(F,ua);this.vyc=jb.fNd(this.$);
this.vyc.ZCh(this.Amg)}dispose(){this.vyc&&this.vyc.Nmk(this.Amg);this.vyc=this.ariaLiveNotifier=this.$=null}};cb=Object(S.__decorate)([Object(za.d)(qa.Kb),Object(S.__param)(0,Object(qa.l)()),Object(S.__param)(1,Object(qa.Nb)()),Object(S.__param)(2,Object(qa.Qf)())],cb);Object(C.a)(cb,"EmbeddedWorkbookReadoutHandler",null,[2]);var Ka=a(144),Oa=a(283),gb=a(394),bc=a(667),Dc=a(482),ad=a(105),Ac=a(305),mc=a(168),Gb=a(87),Ba=a(308),Xb=a(77),Ab=a(39),Db=a(83),xc=a(69),vc=a(673),zb=a(25);class tb extends ad.a{constructor(F,
ua){super(F);this.m3=[];this.mQe=null;this.O3f=!1;this.N6a=jb=>{let pc="forward";jb.Values[gb.a.direction]?pc=jb.Values[gb.a.direction].toLowerCase():L.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");jb=0;let Vc=!0;"backward"===pc?(jb=this.s0d.length-1,Vc=!1):"forward"===pc?(jb=0,Vc=!0):L.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${pc}`);this.tdg(Vc,jb,!1)};this.ymg=()=>{this.m3=[]};this.n4a=jb=>{this.$.shortcutKeyManager.Lfk(jb);const pc=
this.$.shortcutKeyManager.ED(jb);if(-411645385===pc&&this.U_f()||this.O3f&&(369708605===pc||1542466017===pc))this.$.Ma.qh(new Db.a(pc,1,this.$.ii,6,null),{["event"]:jb},jb),jb.stopPropagation()};this.BVj=jb=>{this.Qza(jb)};this.th=ua;this.mE=ja.f(this.th);this.O3f=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8797275_unhideRowColKeyBoardCommandBugFix");this.oj.Ba("keydown",this.BVj);this.oj.Ba("keyup",this.n4a);Ac.a(ua).xEh(this.ymg);Gb.a(ua.ua,27)&&(qa.nd.Aa()?void za.a.resolve(qa.nd,{va:1}).then(jb=>
{jb.$r(Ka.a.cEc);jb.wq(Ka.a.cEc,this.N6a)}):Ab.TaskExtensions.Xa(Xb.GetServiceTaskFactory.Tj(ua.la,21,137,1),jb=>{jb=jb.result;jb.$r(Ka.a.cEc);jb.wq(Ka.a.cEc,this.N6a)},ua.ya))}get $(){return this.th}get s0d(){this.m3.length||(this.m3=this.lIf());return this.m3}get Sya(){return this.mQe}set Sya(F){this.mQe=F;this.m3=this.lIf()}dispose(){this.$&&Ac.a(this.$).Ynk(this.ymg);this.th=null;this.m3.length=0;super.dispose()}L$j(F){this.Qza(F)}tdg(F,ua,jb,pc){pc=void 0===pc?null:pc;var Vc=this.SWk(F,ua,void 0===
jb?!0:jb,pc);if(!Vc){jb=ua;var pd=F?1:-1,gd=this.s0d;do{Vc=!1;if(Gb.a(this.$.ua,27)){if(jb+=pd,jb>=gd.length||0>jb)Vc=!0}else jb=(jb+pd+gd.length)%gd.length;if(Vc){this.oCj(F,ua,pc);break}else if(Vc=this.SZg(F,ua,jb,!1,pc))break}while(jb!==ua)}}SWk(F,ua,jb,pc){pc=void 0===pc?null:pc;let Vc=null;0<=ua&&(Vc=this.m3[ua]);return(null===Vc||void 0===Vc?0:Vc.$o)&&Vc.Up(F,void 0===jb?!0:jb)?(pc&&xc.g(pc),L.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Vc.hl} into a sub region`),
Vc.Js(),!0):!1}SZg(F,ua,jb,pc,Vc){Vc=void 0===Vc?null:Vc;jb=this.m3[jb];const pd=Ac.a(this.th).TF(Oa.a.RIa),gd=Ac.a(this.th).TF(Oa.a.JSb),Md=this.mE.ha.$e.isFloatingObjectSelected;if(jb===gd&&Md||jb===pd&&!pc&&!Md)return!1;if((null===jb||void 0===jb?0:jb.$o)&&jb.Up(F,!1)){Vc&&xc.g(Vc);jb.Js();if(F=this.m3[ua])F.lu(),L.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${F.hl} to ${jb.hl}`);return!0}return!1}oCj(F,ua,jb){(jb=void 0===jb?null:jb)&&xc.g(jb);if(ua=this.m3[ua])ua.lu(),L.ULS.sendTraceTag(537166666,
0,50,`Lost focus from section ${ua.hl}`);qa.nd.Aa()?void za.a.resolve(qa.nd,{va:0}).then(pc=>{pc.sendMessage(Ka.a.GFa,{[gb.a.direction]:F?"forward":"backward"})}):Ab.TaskExtensions.Xa(Xb.GetServiceTaskFactory.Tj(this.$.la,21,137,0),pc=>{pc.result.sendMessage(Ka.a.GFa,{[gb.a.direction]:F?"forward":"backward"})},this.$.ya)}Qza(F){var ua=this.$.isEditMode?mc.a(this.$):null;tb.D_f(ua)&&this.$.shortcutKeyManager.G2k(F,ua.ns);if(!this.$.vh.poa||tb.D_f(ua))if(117===F.keyCode&&(F.ctrlKey||xc.b(F))){ua=this.wLf(F.target);
var jb=!F.shiftKey;L.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ua}`);var pc=Ac.a(this.th).TF(Oa.a.J5b);pc=this.m3.indexOf(pc);xa.AFrameworkApplication.ra.$g.ZI&&this.$.s6&&-1!==pc&&ua===pc&&bc.a.zX(this.$.O8b,0);this.tdg(jb,ua,!0,F)}else 117!==F.keyCode||tb.Myf?-411645385===this.$.shortcutKeyManager.ED(F)?this.U_f()&&(this.$.Ma.qh(new Db.a(-411645385,1,this.$.ii,6,null),{["event"]:F},F),F.stopPropagation()):1588554917===this.$.shortcutKeyManager.ED(F)?
0===this.mode?(vc.a(this.$)||this.$.Ma.qh(new Db.a(1588554917,1,this.$.ii,6,null),{["event"]:F},F),F.preventDefault(),F.stopPropagation()):3===this.mode&&(F.preventDefault(),F.stopPropagation()):1058684758===this.$.shortcutKeyManager.ED(F)?(ua=this.wLf(F.target),pc=Ac.a(this.th).TF(Oa.a.J5b),jb=Ac.a(this.th).TF(Oa.a.RIa),pc=this.m3.indexOf(pc),jb=this.m3.indexOf(jb),xa.AFrameworkApplication.ra.$g.ZI&&this.$.s6&&-1!==pc&&ua===pc&&1===this.$.O8b&&bc.a.zX(1,0),-1!==jb&&ua!==jb&&this.SZg(!0,ua,jb,!0,
F)):ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.FWi(F)?(ua=this.$.shortcutKeyManager.ED(F),L.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${ua} fired in ${this.mode} mode`),0===this.mode?(this.$.Ma.qh(new Db.a(ua,1,this.$.ii,6,null)),F.preventDefault(),F.stopPropagation()):4===this.mode&&-1966746939===ua&&(F.preventDefault(),F.stopPropagation())):this.z2i(F):(F=Ba.a.dB.UK.IX(Dc.a.eLi(),!1),
F.image=zb.a.Fob()?3:0,Ba.a.dB.UK.EF(F),tb.Myf=!0)}wLf(F){const ua=this.s0d;for(let jb=0,pc=ua.length;jb<pc;++jb){const Vc=ua[jb];if(Vc&&Vc.sq(F))return jb}return-1}lIf(){const F=[];for(let ua=0,jb=this.Sya.length;ua<jb;ua++){const pc=Ac.a(this.$).TF(this.Sya[ua]);pc&&F.push(pc)}return F}U_f(){return 0===this.mode||4===this.mode}static D_f(F){return F?F.inKeytipMode:!1}}tb.Myf=!1;Object(C.a)(tb,"AccessibilityManager",ad.a,[823,2]);var ab=a(178);let La=class extends tb{constructor(F){super(document.documentElement,
F);this.QL=0;this.WLh=[Oa.a.zjf,Oa.a.B7d,Oa.a.GDc,Oa.a.Cxe,Oa.a.J5b,Oa.a.Dtd,Oa.a.mId,Oa.a.uOf,Oa.a.Bsd,Oa.a.nwe,Oa.a.XRk,Oa.a.nSg,Oa.a.JSb,Oa.a.ZBf,Oa.a.Dud,Oa.a.RIa,Oa.a.dre,Oa.a.Hud,Oa.a.kYg,Oa.a.n7f,Oa.a.atd];this.Tcl=[Oa.a.GDc,Oa.a.d9g,Oa.a.c9g,Oa.a.e9g];this.i$j=[Oa.a.GDc,Oa.a.uxg,Oa.a.vxg,Oa.a.yxg];this.JUh=[Oa.a.PBf,Oa.a.tOf,Oa.a.OBf,Oa.a.LBf,Oa.a.Enf];this.E9j=[Oa.a.zjf,Oa.a.B7d,Oa.a.Dtd,Oa.a.mId,Oa.a.Bsd,Oa.a.nwe,Oa.a.JSb,Oa.a.Dud,Oa.a.RIa,Oa.a.dre,Oa.a.Nwg,Oa.a.Hud,Oa.a.atd];this.V9j=[Oa.a.JSb,
Oa.a.qId];const ua=na.a.instance.Ea(253);this.FDk=this.$.shortcutKeyManager.mlb(ua);this.mode=0;qa.nd.Aa()?void za.a.resolve(qa.nd,{va:1}).then(jb=>{jb.$r(Ka.a.GFa);jb.wq(Ka.a.GFa,this.N6a)}):Ab.TaskExtensions.Xa(Xb.GetServiceTaskFactory.Tj(F.la,21,137,1),jb=>{jb=jb.result;jb.$r(Ka.a.GFa);jb.wq(Ka.a.GFa,this.N6a)},F.ya)}get mode(){return this.QL}set mode(F){this.QL=F;switch(F){case 0:this.Sya=this.WLh;break;case 2:this.Sya=this.Tcl;break;case 3:this.Sya=this.i$j;break;case 4:this.Sya=this.JUh;break;
case 5:this.Sya=this.E9j;break;case 6:this.Sya=this.V9j;break;default:L.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Qza(F){this.$.Ij&65536&&super.Qza(F)}z2i(F){if(Va.a.equals(this.FDk,this.$.shortcutKeyManager.PLd(F),!1)){const ua=ab.b(this.$);if(null===ua||void 0===ua?0:ua.$o)xc.g(F),ua.Up(!0,!1)}}};La=Object(S.__decorate)([Object(za.d)(qa.Mb),Object(S.__param)(0,Object(qa.Nb)())],La);Object(C.a)(La,"EwaAccessibilityManager",tb,[]);var pb=a(40);let ia=class extends pb.a{constructor(){super()}OEh(F){this.addHandler("TAF",
F)}pok(F){this.removeHandler("TAF",F)}kck(){this.raiseEvent("TAF")}};ia=Object(S.__decorate)([Object(za.d)(qa.ed),Object(S.__param)(0,Object(qa.Nb)())],ia);Object(C.a)(ia,"GridHighlightBehaviorEventManager",pb.a,[730,2]);var kb=a(78),fb=a(306),hb=a(17),Jb=a(193),ub=a(140);class nb extends Sys.EventArgs{constructor(F,ua){super();this.start=F;this.lUb=ua}}Object(C.a)(nb,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);class Aa extends pb.a{constructor(F){super();this.Fbg=[3];this.ebb=void 0;
this.da=F}get DD(){if(this.ebb)return this.ebb;const F=qa.Ec.Aa()?za.a.nh(qa.Ec):this.da.$.la.lh(464);F||L.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");F.DD||L.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.ebb=F.DD}lDh(F){this.addHandler("mrek",
F)}aqa(F,ua,jb){for(const pc of this.da.Uu)fb.a.instance.xa(hb.a.wv,pc.domElement,F);fb.a.instance.xa(hb.a.Co,document.documentElement,ua);this.da.cellTextEditBox.djb(!0);jb&&fb.a.instance.xa(hb.a.aL,this.da.yn,ua)}Chk(F,ua,jb){document.documentElement.addEventListener("pointermove",F);document.documentElement.addEventListener("pointerup",ua);this.da.cellTextEditBox.djb(!0);jb&&this.da.yn.addEventListener("pointerleave",ua)}gze(F,ua,jb){for(const pc of this.da.Uu)fb.a.instance.Qa(hb.a.wv,pc.domElement,
F);fb.a.instance.Qa(hb.a.Co,document.documentElement,ua);this.da.cellTextEditBox.djb(!1);jb&&fb.a.instance.Qa(hb.a.aL,this.da.yn,ua)}a5k(F,ua,jb){document.documentElement.removeEventListener("pointermove",F);document.documentElement.removeEventListener("pointerup",ua);this.da.cellTextEditBox.djb(!1);jb&&this.da.yn.removeEventListener("pointerleave",ua)}Dhk(F,ua){for(const jb of this.da.Uu)Jb.a.instance.xa(hb.a.Jn,jb.domElement,F);Jb.a.instance.xa(hb.a.ml,document.documentElement,ua)}b5k(F,ua){for(const jb of this.da.Uu)Jb.a.instance.Qa(hb.a.Jn,
jb.domElement,F);Jb.a.instance.Qa(hb.a.ml,document.documentElement,ua)}Ikf(F,ua,jb,pc){const Vc=document.createElement("div");Vc.className=ua;for(const pd of jb)Vc.classList.add(pd);F.appendChild(Vc);fb.a.instance.xa(hb.a.qj,Vc,pc);return Vc}yLf(F){F=F.li.parentNode;if(!F)return L.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;F=parseInt(F.getAttribute(X.a.lUb),10);return isNaN(F)?(L.ULS.shipAssertTag(537159393,0,
!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.da.Gh.NU(3,1,F)}t7b(F,ua,jb){F=(void 0===jb?!0:jb)&&!!this.DD&&this.DD.mnj(F);for(const pc of ua)la.DOMElementExtensions.setVisible(pc,F)}tJd(){return this.da.vA?ub.a(this.da.$):this.da.Fh}oBg(){const F=this.tJd();F&&this.DD?F.TZ(null):(L.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateFormulaHighlights: Can't UpdateFormulaHighlights, will hide all marquee as a last fallback."),
this.da.Gh.Mq(this.Fbg),this.da.Gh.qt(null,this.Fbg))}Azg(F,ua){this.raiseEvent("mrek",new nb(F,ua))}}Object(C.a)(Aa,"BehaviorHelperMethods",pb.a,[]);var ra=a(94),vb=a(59),rb=a(91);class Nb extends ad.a{constructor(F,ua){super(F,void 0===ua?null:ua)}Feb(){}}Object(C.a)(Nb,"HighlightFlyweightBehavior",ad.a,[]);var Qc=a(19),jd=a(490),xd=a(65),ae=a(13),Sd=a(137),fc=a(290),uc=a(53),hc=a(265),Ec=a(10),yd=a(57);class Ad extends hc.a{constructor(F,ua,jb,pc){super(document.createElement("div"));this.rtc=
null;this.kbc=!1;this.onPointerDown=Vc=>{Vc=this.zoomManager?this.zoomManager.il(Vc):Vc;this.kbc=!1;if(3===(xd.a.rh=Vc.Dh)){const pd=Vc.La.rawEvent,gd=pd.srcElement||pd.target;la.DOMElementExtensions.eo(this.domElement,gd)&&la.DOMElementExtensions.eo(pd.currentTarget,gd)&&(this.kbc=!0,this.rtc=Vc.clientPoint)}return!1};this.Bo=Vc=>{Vc=this.zoomManager?this.zoomManager.il(Vc):Vc;this.raiseEvent("GrPointerUp",Vc);return this.kbc=!1};this.Rr=Vc=>{Vc=this.zoomManager?this.zoomManager.il(Vc):Vc;3===Vc.Dh&&
this.kbc&&this.j6i(Vc.clientPoint)&&(this.raiseEvent("GrDrag"),this.kbc=!1);return!1};this.vj=Vc=>{this.zoomManager&&this.zoomManager.il(Vc);return!0};this.$=jb;this.zoom=pc;this.domElement.classList.add(yd.pb);this.domElement.classList.add(yd.rb);F.appendChild(this.domElement);la.DOMElementExtensions.setVisible(this.domElement,!1);this.A_a=document.createElement("div");this.A_a.classList.add(yd.qb);this.A_a.style.borderColor=ua;this.domElement.appendChild(this.A_a);fb.a.instance.xa(hb.a.qj,this.domElement,
this.onPointerDown);fb.a.instance.xa(hb.a.Co,this.domElement,this.Bo);Jb.a.instance.xa(hb.a.ml,this.domElement,this.Bo);fb.a.instance.xa(hb.a.wv,this.domElement,this.Rr);Jb.a.instance.xa(hb.a.Jn,this.domElement,this.Rr);fc.a.instance.xa(hb.a.click,this.domElement,this.vj)}get zoomManager(){return this.zoom.zoomManager}n4e(F){this.addHandler("GrDrag",F)}lFg(F){this.removeHandler("GrDrag",F)}m4e(F){this.addHandler("GrContxt",F)}kFg(F){this.removeHandler("GrContxt",F)}o4e(F){this.addHandler("GrPointerUp",
F)}mFg(F){this.removeHandler("GrPointerUp",F)}dispose(){uc.a.tOa(this.domElement);super.dispose()}YNg(){this.domElement.classList.remove(yd.rb);this.A_a.classList.remove(yd.qb);this.A_a.classList.add(ya.EwaSettings.aG?yd.vb:yd.ub)}G4g(){this.A_a.classList.remove(ya.EwaSettings.aG?yd.vb:yd.ub);this.A_a.classList.add(yd.qb);this.domElement.classList.add(yd.rb)}j6i(F){return!!this.rtc&&(3<Math.abs(F.x-this.rtc.x)||3<Math.abs(F.y-this.rtc.y))}static WQb(F){return Math.round(9/Math.max(F.zoomManager?F.zoomManager.zoom:
Ec.a.O6,1))}}Ad.O4d=0;Object(C.a)(Ad,"TouchGrippie",hc.a,[]);var $b=a(176);class Ob extends Nb{constructor(F,ua,jb,pc,Vc){super(ua);this.g_d=this.PIb=!1;this.kpc=null;this.ZM=this.hoa=this.c_d=!1;this.kG=()=>{this.PIb&&this.c_d?this.GBa():this.Iga()};this.zlg=gd=>{3===gd.Dh&&(this.c_d=!0,this.GBa());return!1};this.Alg=gd=>{if(3===gd.Dh){if(!gd.li||this.bkj(gd))return!1;this.c_d=!1;this.Iga()}return!1};this.sm=()=>{this.hoa&&this.kze();this.GBa();this.g_d=!1};this.Ry=()=>{this.Iga();this.g_d=!0};this.Wha=
(gd,Md)=>{Md.waa===this.waa&&(Md.visible?this.g_d||this.GBa():this.Iga())};this.Grg=()=>{this.Blg(this.y2.domElement,!1)};this.Dhg=()=>{this.Blg(this.L_.domElement,!0)};this.VOc=(gd,Md)=>{this.ZM&&$b.b(this.da.$).SA(Md.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.uAa(Md)};this.WOc=(gd,Md)=>{this.ZM&&$b.b(this.da.$).SA(Md.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.uAa(jd.b(Md))};this.S0b=()=>{3===xd.a.rh?this.GBa():this.Iga();this.hoa&&1===xd.a.rh&&this.kze()};this.Hrg=
()=>{this.HBk()};this.Zrf=()=>{this.Iga()};this.Zv=()=>{this.ha.$e.Lh&&this.Iga()};this.rhg=()=>{this.Iga()};this.slg=(gd,Md)=>{this.kze();3===Md.Dh?this.GBa():this.Iga()};this.bTc=()=>{this.PIb&&(this.Iga(),this.GBa())};const pd=jb.$;this.mE=jb;this.zoom=Vc;this.ha=jb.ha;this.NR=F;this.Qyk=ua;this.paneType=pc;F=this.domElement.currentStyle;ua="#000000";F&&(ua=F.borderTopColor);this.y2=new Ad(this.Tzf(),ua,pd,Vc);this.L_=new Ad(this.Tzf(),ua,pd,Vc);this.y2.n4e(this.Grg);this.y2.m4e(this.VOc);this.y2.o4e(this.WOc);
this.L_.n4e(this.Dhg);this.L_.m4e(this.VOc);this.L_.o4e(this.WOc);for(const gd of this.da.Uu)Jb.a.instance.xa(hb.a.Jm,gd.domElement,this.Alg),Jb.a.instance.xa(hb.a.ml,gd.domElement,this.zlg);jb.view.lz(this.kG);jb.Fh.Fv(this.Zrf);jb.Gh.teb(this.Wha);jb.Xlc(this.rhg);pd.xI(this.bTc);jb.aA(this.bTc);this.ha.T3(this.sm);this.ha.ila(this.Ry);jb.hO(this.Zv);this.ha.OHb(this.slg);xd.a.t4e(this.S0b);Ab.TaskExtensions.Xa(Object(rb.d)(za.a.resolve(qa.ed,{va:0})),gd=>{gd.result.OEh(this.Hrg)},pd.ya,3);this.ZM=
ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncContextMenu",!1)}get da(){return this.mE}dispose(){ra.a.gj([this.y2,this.L_]);this.y2.lFg(this.Grg);this.y2.kFg(this.VOc);this.y2.mFg(this.WOc);this.L_.lFg(this.Dhg);this.L_.kFg(this.VOc);this.L_.mFg(this.WOc);for(var F of this.da.Uu)Jb.a.instance.Qa(hb.a.Jm,F.domElement,this.Alg),Jb.a.instance.Qa(hb.a.ml,F.domElement,this.zlg);this.da.view.Yx(this.kG);this.da.Fh.zv(this.Zrf);this.da.Gh.cvb(this.Wha);this.da.sUc(this.rhg);this.da.$.fL(this.bTc);
this.da.$E(this.bTc);this.ha.D7(this.sm);this.ha.uia(this.Ry);this.da.VP(this.Zv);this.ha.E4b(this.slg);xd.a.sFg(this.S0b);this.hoa&&L.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(F=za.a.nh(qa.ed))&&F.pok(this.Hrg);super.dispose()}$7a(){if(!this.NR.range||!this.NR.range.equals(this.ewb))return!1;const F=!this.da.N1a();return this.da.isEditing&&F&&(this.ewb.isRow||this.ewb.qk)?!1:this.hoa?!0:3===xd.a.rh}Iga(){this.PIb&&(this.y2.set_visible(!1),
this.L_.set_visible(!1),this.PIb=!1)}GBa(){if(this.$7a()){var F=la.DOMElementExtensions.getBoundingClientRect(this.kpc);F||L.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.da.yn,this.da.fh.pp);var ua=la.DOMElementExtensions.getBoundingClientRect(this.Qyk),jb=new Sys.UI.Bounds(ua.x-F.x,ua.y-F.y,ua.width,ua.height),pc=this.ewb,Vc=pc.topLeft,pd=pc.bottomRight,gd=pc.isRow||pc.qk;if(pc.qk){var Md=this.swi();pc=jb.x-2*Ad.WQb(this.zoom);
var ze=Md;var T=jb.x+ua.width}else pc.isRow?(pc=T=this.rwi(),ze=jb.y-2*Ad.WQb(this.zoom),Md=jb.y+ua.height):(ze=jb.y,Md=jb.y+ua.height,this.da.rtl?(pc=jb.x+ua.width,T=jb.x):(pc=jb.x,T=jb.x+ua.width));ua=Ad.O4d+(gd?0:Ad.WQb(this.zoom));this.y2.style.left=ae.HelperMethods.Ki(pc-ua);this.y2.style.top=ae.HelperMethods.Ki(ze-ua);this.L_.style.left=ae.HelperMethods.Ki(T-ua);this.L_.style.top=ae.HelperMethods.Ki(Md-ua);this.y2.set_visible(this.h_f(ze,pc,Vc,gd,F));this.L_.set_visible(this.h_f(Md,T,pd,gd,
F));this.PIb=!0}}h_f(F,ua,jb,pc,Vc){const pd=la.DOMElementExtensions.getBoundingClientRect(this.da.sl(this.paneType).domElement);Vc=new Sys.UI.Bounds(pd.x-Vc.x-3,pd.y-Vc.y-3,pd.width+6,pd.height+6);return(this.da.fh.Lo(jb)===this.paneType||pc)&&vb.a.uY(Vc,new Sys.UI.Point(ua,F))}swi(){return(this.da.view.visibleArea.height+this.da.fh.height+Ad.O4d-Ad.WQb(this.zoom))/2}rwi(){return(this.da.view.visibleArea.width+this.da.fh.width+Ad.O4d-Ad.WQb(this.zoom))/2}Wpg(){this.GBa()}bkj(F){return la.DOMElementExtensions.Tvb(F.li,
Qc.a.oH)&&(this.Glj(F)||this.Hlj(F))}Hlj(F){if(this.da.rtl)F=F.clientPoint.x;else{const ua=la.DOMElementExtensions.getBoundingClientRect(F.li);F=F.clientPoint.x-(ua.x+ua.width-Sd.a.Zx)}return 0<F&&F<=Sd.a.Zx}Glj(F){const ua=la.DOMElementExtensions.getBoundingClientRect(F.li);F=F.clientPoint.y-(ua.y+ua.height-Sd.a.Zx);return 0<F&&F<=Sd.a.Zx}Blg(F,ua){this.hoa&&L.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.vud(F,ua,this.hoa);this.Iga()}HBk(){this.hoa||
(L.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.hoa=!0,this.y2.YNg(),this.L_.YNg(),this.da.ha.sourceRange=this.da.ha.qa.jj,this.GBa())}kze(){this.hoa&&(L.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.hoa=!1,this.y2.G4g(),this.L_.G4g())}Tzf(){this.kpc||(this.kpc=this.da.yn);return this.kpc}}Object(C.a)(Ob,"SelectionTouchGrippiesBehaviorBase",Nb,[]);class Yc extends Ob{constructor(F,ua,jb,pc,Vc){super(F,ua,
jb,pc,Vc)}get waa(){return 19}get ewb(){return this.da.ha.qa.activeRange}$7a(){const F=this.da.kq||this.da.isEditing;return!this.da.ha.qa.Bn&&!F&&super.$7a()}}Object(C.a)(Yc,"DiscontinuousSelectionTouchGrippiesBehavior",Ob,[]);var zd=a(764);class Dd extends Nb{constructor(F){super(F);const ua=document.createElement("div");ua.className=yd.Mb;F.appendChild(ua)}}Object(C.a)(Dd,"SelectionBorderBehavior",Nb,[]);class oc{}oc.uxf="ewr-selection-draghandle-grab";oc.Sri="ewr-selection-draghandle-top";oc.Tri=
"ewr-selection-draghandle-top-enhanced";oc.Jri="ewr-selection-draghandle-bottom";oc.Kri="ewr-selection-draghandle-bottom-enhanced";oc.Mri="ewr-selection-draghandle-left";oc.Nri="ewr-selection-draghandle-left-enhanced";oc.Pri="ewr-selection-draghandle-right";oc.Qri="ewr-selection-draghandle-right-enhanced";oc.Vri="ewr-selection-draghandle-top-updated";oc.Lri="ewr-selection-draghandle-bottom-updated";oc.Ori="ewr-selection-draghandle-left-updated";oc.Rri="ewr-selection-draghandle-right-updated";oc.Wri=
"ewr-selection-dragtooltip-updated";oc.Iri="ewr-selection-drag-tooltip-fluent";oc.vxf="ewr-selection-draghandle-reduced";oc.jsi="ewr_selection_rearrangeleft";oc.ksi="ewr_selection_rearrangeright";oc.lsi="ewr_selection_rearrangetop";oc.isi="ewr_selection_rearrangebottom";oc.bsi="ewr_selection_rearrange-flange-left";oc.fsi="ewr_selection_rearrange-fullrowcol-flange-left";oc.csi="ewr_selection_rearrange-flange-right";oc.gsi="ewr_selection_rearrange-fullrowcol-flange-right";oc.dsi="ewr_selection_rearrange-flange-top";
oc.hsi="ewr_selection_rearrange-fullrowcol-flange-top";oc.asi="ewr_selection_rearrange-flange-bottom";oc.esi="ewr_selection_rearrange-fullrowcol-flange-bottom";oc.selecting="selecting";oc.Hri="ewr-selection-drag-shadow";oc.msi="ewr-selection-resizemarqueehandle";oc.psi="ewr-selection-resizemarqueehandle-topleft";oc.qsi="ewr-selection-resizemarqueehandle-topright";oc.nsi="ewr-selection-resizemarqueehandle-bottomleft";oc.osi="ewr-selection-resizemarqueehandle-bottomright";oc.Ari="ewr-marquee-thick";
oc.Cri="ewr-resizemarqueehandle-thick";Object(C.a)(oc,"CssClassNames",null,[]);var $c=a(287);class yb extends Dd{constructor(F,ua,jb,pc,Vc){super(F);this.O8a=!1;this.bnd=this.cnd=null;this.Tzb=this.Bmb=this.FX=this.bla=0;this.n7=this.Oh=this.sourceRange=this.Utb=null;this.Bo=pd=>{pd=this.zoomManager.il(pd);return this.Aog(pd)};this.onPointerDown=pd=>{pd=this.zoomManager.il(pd);if(!this.nse())return!1;if(2===pd.Dh&&pd.Ew===Sys.UI.MouseButton.leftButton&&!this.O8a){var gd=this.ZNd(pd);if(!gd)return L.ULS.shipAssertTag(537159379,
0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Oh=gd.clone();this.sourceRange=this.Oh.clone();this.Utb=this.Oh;if(gd=this.kQi(pd))return this.Tzb=gd.top-this.sourceRange.top,this.Bmb=gd.left-this.sourceRange.left,ja.f(this.$).co.OA(yb.ICd),this.R$d(pd),this.O8a=!0,$c.b(this.$,!0),!0}return!1};this.Rr=pd=>{pd=this.zoomManager.il(pd);if(this.S$d(pd))return!0;if(pd=this.HC?this.ha.a4(pd.clientPoint,pd.li,5,!0):this.ha.Uy(pd.clientPoint,pd.li,5,void 0,void 0,!0)){pd=
this.hKb(pd);if(this.Oh.equals(pd))return!0;this.Oh=pd;if(!this.qzb())return L.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.sxc(!0),!1}return!0};this.yog=pd=>{pd=new Sys.UI.DomEvent(pd);pd=zd.a.create(pd.type,pd.target,pd,2);return this.bnd(pd)};this.Eog=pd=>{pd=new Sys.UI.DomEvent(pd);pd=zd.a.create(pd.type,pd.target,pd,2);return this.cnd(pd)};this.Dj=(pd,gd)=>{gd.i1||this.ZXc(this.$.isEditMode)};this.UO=[];this.$=ua;this.da=
ja.f(this.$);this.zoom=Vc;this.ha=ja.f(this.$).ha;this.paneType=jb;this.lw=pc;this.HC=ya.EwaSettings.HC();ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragHandleUsabilityImprovement",!1)?this.hXc=[oc.Sri,oc.Jri,oc.Mri,oc.Pri]:ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8683878_UpdateDragDropHitRegionOfActiveCell")?this.hXc=[oc.Vri,oc.Lri,oc.Ori,oc.Rri]:this.hXc=[oc.Tri,oc.Kri,oc.Nri,oc.Qri];this.$.kr(this.Dj)}get zoomManager(){return this.zoom.zoomManager}get Gh(){return ja.f(this.$).Gh}get vz(){return this.ha.selectionType}set vz(F){this.ha.selectionType=
F}dispose(){this.UO.forEach(F=>{fb.a.instance.Qa(hb.a.qj,F,this.onPointerDown)});this.UO.length=0;this.Utb=this.sourceRange=this.Oh=null;L.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.bla}, EwaControl is null : ${!this.$}`);this.$&&(this.$.Wr(this.Dj),1===this.bla&&(L.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.RGa(this.bnd,this.cnd,!1)));super.dispose()}Aog(F){if(5!==
this.vz)return!1;(F=this.u4a(F))||this.sxc(!1);$c.b(this.$,!1);return F}aqa(F,ua){L.ULS.shipAssertTag(537159377,0,!this.bla,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.bla}`);this.bla+=1;this.bnd=F;this.cnd=ua;this.HC?this.lw.Chk(this.yog,this.Eog,this.J$b()):this.lw.aqa(F,ua,this.J$b())}hKb(F){if(!F||!this.Oh)return L.ULS.shipAssertTag(537159376,0,!!F,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),
L.ULS.shipAssertTag(537159375,0,!!this.Oh,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ua=this.Oh.clone();1!==this.FX&&(ua.left=Math.max(F.left-this.Bmb,1),ua.right=ua.left+this.sourceRange.width-1);2!==this.FX&&(ua.top=Math.max(F.top-this.Tzb,1),ua.bottom=ua.top+this.sourceRange.height-1);return this.mIb(ua)}RGa(F,ua,jb,pc){jb=void 0===jb?!0:jb;pc=void 0===pc?!0:pc;L.ULS.shipAssertTag(537159374,0,1===this.bla,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.bla}`);
--this.bla;this.HC?this.lw.a5k(this.yog,this.Eog,this.J$b()):this.lw.gze(F,ua,this.J$b());jb&&this.qff(pc);this.FX=0;this.O8a=!1}mIb(F){var ua=ja.f(this.$);const jb=F.clone();if(ua.fh.By){const pc=ua.fh.pH;ua=ua.fh.xK;jb.left<pc&&1!==this.FX&&(jb.left=pc,jb.right=Math.min(jb.left+F.width-1,Ec.a.Nk));jb.top<ua&&2!==this.FX&&(jb.top=ua,jb.bottom=Math.min(jb.top+F.height-1,Ec.a.fl))}return this.Utb=jb}ZXc(F){this.UO.forEach(ua=>{la.DOMElementExtensions.setVisible(ua,F)})}kQi(F){const ua=F.li;F=F.clientPoint;
if(!ua||!F)return L.ULS.shipAssertTag(537159373,0,!!ua,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),L.ULS.shipAssertTag(537159372,0,!!F,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;F.y+=ua===this.UO[yb.GCd]?2:ua===this.UO[yb.xrf]?-2:0;F.x+=ua===this.UO[yb.yrf]?2:ua===this.UO[yb.FCd]?-2:0;return this.HC?this.ha.a4(F,ua,5,!0):this.ha.Uy(F,ua,5,void 0,void 0,!0)}}yb.gsc="copy";yb.ICd="grabbing";yb.GCd=0;yb.xrf=1;yb.yrf=2;yb.FCd=3;Object(C.a)(yb,
"DragSelectionClickBehaviorBase",Dd,[]);class qb extends yb{constructor(F,ua,jb,pc,Vc,pd,gd){super(F,ua,jb,Vc,gd);this.Zi=this.$V=null;this.IPf=()=>{this.sxc(!0)};for(const Md of this.hXc)ua=this.lw.Ikf(F,Md,[oc.uxf],this.onPointerDown),this.UO.push(ua);this.ZXc(this.$.isEditMode);this.BP=pc;F=qa.Ec.Aa()?za.a.nh(qa.Ec):this.$.la.lh(464);L.ULS.shipAssertTag(512312961,0,!!F,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");
this.DD=F.DD;for(const Md of this.UO)fb.a.instance.xa(hb.a.o7,Md,this.BP.eTf),fb.a.instance.xa(hb.a.aL,Md,this.BP.fTf);this.Feb(pd)}Feb(F){this.lw.t7b(F,this.UO);this.BP.tZ()}R$d(F){L.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.da.KKa=!0;this.Zi.tO(!1);this.vz=5;this.BP.Brf(F.li);this.Zi.Wa.removeSelection();this.Zi.lmc(this.IPf);this.aqa(this.Rr,this.Bo);this.FX=this.sourceRange.isRow?1:this.sourceRange.qk?2:0}u4a(){const F=
this.e8();this.vz=-1;this.RGa(this.Rr,this.Bo);return F}qff(){this.da.KKa=!1;this.BP.Crf(this.UO[0]);this.Zi.Wa.setCaretPositionToEnd();this.Zi.FUc(this.IPf);this.lw.oBg()}sxc(F){L.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate formula highlights as a fallback in CleanUp.");F&&this.RGa(this.Rr,this.Bo)}ZNd(F){this.Zi=this.lw.tJd();this.$V=this.lw.yLf(F);return this.Zi&&this.$V&&this.$V.range?this.$V.range:(L.ULS.shipAssertTag(537159388,
0,!!this.Zi,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),L.ULS.shipAssertTag(537159387,0,!!this.$V,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),L.ULS.shipAssertTag(537159386,0,!!this.$V.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}e8(){return this.$V?this.DD.vdg(this.Zi,this.$V,this.Oh):(L.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}qzb(){return this.e8()}J$b(){return!0}S$d(){return!1}nse(){return!0}}Object(C.a)(qb,"DragMarqueeClickBehavior",yb,[]);var Cb=a(98),gc=a(158),Mc=a(189),bd=a(355),Id=a(925),Vd=a(71),ce=a(232),ee=a(36),Je=a(44),Ue=a(369),jc=a(234),tc=a(46),Kc=a(434);class wd extends yb{constructor(F,ua,jb,pc,Vc,pd){super(F,ua,jb,Vc,pd);this.qva=this.KF=null;this.qk=this.isRow=!1;this.ks=ya.EwaSettings.ks();this.hya=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragAnimationTracking",!1);this.LXb=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseSPDForDrag",
!1);this.g1a=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8732599_DragInsertIndicatorAlignmentBugFix");this.O5=ya.EwaSettings.j6()&&ya.EwaSettings.QWd();this.Pib=Vd.a.K$;this.Avc=0;this.Dlg=(gd,Md)=>{this.iWb=!0;this.onPointerDown(Md)};this.sm=()=>{this.domElement.classList.remove(oc.selecting);this.ZXc(this.$.isEditMode&&!this.Emi());if(wd.mgk&&this.ha.qa.t6){const gd=this.zh(this.ha.qa.jj);null!==gd&&(gd.hasAutoFilter?this.domElement.classList.add(oc.vxf):this.domElement.classList.remove(oc.vxf))}};
this.Ry=()=>{this.domElement.classList.add(oc.selecting)};this.Qj=pc;this.UVd=!1;if(0===wd.fvc[jb].length)for(const gd of this.hXc)ua=document.createElement("div"),ua.className=gd,ua.classList.add(oc.uxf),wd.fvc[jb].push(ua);for(const gd of wd.fvc[jb])F.appendChild(gd),fb.a.instance.xa(hb.a.qj,gd,this.onPointerDown),this.UO.push(gd);this.ZXc(this.$.isEditMode);this.$y={};this.da.YU=!1;this.ha.ila(this.Ry);this.ha.T3(this.sm);this.HC&&1===this.paneType&&(this.TGa(),this.da.DDh(this.Dlg));this.hya&&
void za.a.resolve(qa.Ed).then(gd=>{this.SKa=gd})}dispose(){this.ha&&(this.ha.uia(this.Ry),this.ha.D7(this.sm));if(this.$y)for(var F=1;4>=F;F++)la.DOMElementExtensions.$m(this.$y[F.toString()]);for(F=1;4>=F;F++)wd.fvc[F].length=0;this.$y=this.KF=null;this.HC&&1===this.paneType&&this.da.lnk(this.Dlg);super.dispose()}qff(F){F&&(ja.f(this.$).co.OA(X.a.raa),this.rff(),this.da.YU=!1);for(F=1;4>=F;F++){const ua=this.$y[F.toString()];ua&&ua.parentNode.removeChild(ua);this.$y[F.toString()]=null}this.KF=null}ZNd(){return this.ha.qa.jj}e8(){this.ha.updateSelection(this.Oh,
this.Oh.topLeft,0);return!0}j8a(F,ua){ua=void 0===ua?!1:ua;var jb=!isNullOrUndefined(this.ufa);if(F&&ua||F!==jb){jb=this.i6();var pc=this.doa();F&&(jb||pc)?(ua&&this.ufa&&(this.Gh.Mq(this.ufa),this.ufa=null),this.Gh.HTb(!0),this.ufa=this.TVd()?[65]:[62,jb?63:64],this.Gh.qt(this.sourceRange,this.ufa),this.Gh.Jw(this.ufa),L.ULS.sendTraceTag(507872737,0,50,`DragSelectionClickBehavior.showOrHideSourceHighlights: show source highlights for ${this.TVd()?"copy":"cut"} operation`)):this.ufa&&(this.Gh.Mq(this.ufa),
this.ufa=null,this.Gh.Cca(),L.ULS.sendTraceTag(507872736,0,50,"DragSelectionClickBehavior.showOrHideSourceHighlights: hide source highlights"))}}Fdf(F){this.Drf=F}E8b(F){isNullOrUndefined(this.ufa)&&Math.abs(this.i6()?F.y-this.Drf.y:F.x-this.Drf.x)>=wd.bTk&&this.j8a(!0)}P3c(){const F=!isNullOrUndefined(this.ufa);this.j8a(F,!0)}qzb(F){F=void 0===F?!1:F;if(this.ks){const jb=this.i6();var ua=this.doa();jb||ua?(ua=this.f4f(),this.qva=jb?wd.bii:wd.aii,this.Gh.qt(this.Oh,this.qva),ua?this.Gh.Jw(this.qva):
this.CTb()):(this.qva=wd.kYa,this.Gh.qt(this.Oh,this.qva),this.Gh.Jw(this.qva))}else this.Gh.qt(this.Oh,wd.kYa),this.Gh.Jw(wd.kYa);this.dQ(F);return!0}CTb(){this.qva&&(this.Gh.Mq(this.qva),this.qva=null)}l3c(F){F=void 0===F?!1:F;this.Gh.qt(this.Oh,this.KF);if(this.ks){const ua=this.i6()||this.doa(),jb=this.g4f();ua&&!jb?this.Gh.Mq(this.KF):this.Gh.Jw(this.KF)}else this.Gh.Jw(this.KF);this.dQ(F)}TGa(){this.iWb=!1}bSh(F,ua,jb,pc,Vc,pd,gd,Md,ze){ua?(ua=gd,Vc=pc.y+Vc.y-pd.y-Md,gd=pd.width-ze-ua,pc=pc.height,
F=F.y-pd.y-Vc):(ua=jb?pc.x-Vc.right+pd.right+Md:pc.x+Vc.left-pd.left-Md,Vc=gd,gd=pc.width,pc=pd.height-ze-Vc,F=jb?pd.width-(F.x-pd.left)-ua:F.x-pd.left-ua);return{Pib:new Vd.a(ua,Vc,gd,pc),Avc:F}}cSh(F,ua,jb,pc,Vc,pd){ua?(ua=pc.x,F=F.y-pd.y-Vc):(ua=jb?pd.width-(F.x-pd.left)-Vc:F.x-pd.left-Vc,F=pc.y);return new Sys.UI.Point(ua*(jb?-1:1),F)}ERg(F){var ua=this.da.yn,jb=ua.getBoundingClientRect(),pc=this.da.oh.fFf(F),Vc=this.da.oh.ZJf(pc)||this.da.sl(1);pc=Vc.domElement;const pd=pc.getBoundingClientRect();
Vc=this.Gh.yZa(this.sourceRange,Vc.paneType,!1);const gd=this.i6(),{Pib:Md,Avc:ze}=this.bSh(F,gd,this.da.rtl,Vc,pd,jb,(gd?this.da.pca:this.da.X_).TLd(),gd?pc.scrollTop:pc.scrollLeft,Sd.a.Zx/this.zoomManager.zoom);this.Pib=Md;this.Avc=ze;wd.Dfa||(wd.Dfa=document.createElement("div"),wd.Dfa.id=`${this.da.$.xi}rowColDragShadow`,wd.Dfa.className=oc.Hri,la.DOMElementExtensions.setVisible(wd.Dfa,!1),ua.appendChild(wd.Dfa));ua=new jc.a(wd.Dfa.style);jb=ua.hF;jb.height=`${this.Pib.height}px`;jb.width=`${this.Pib.width}px`;
this.zxb(F,ua)}DTb(){wd.Dfa&&la.DOMElementExtensions.setVisible(wd.Dfa,!1)}zxb(F,ua){if(wd.Dfa){ua=ua||new jc.a(wd.Dfa.style);var jb=ua.hF,pc=this.da.yn.getBoundingClientRect(),{x:Vc,y:pd}=this.cSh(F,this.i6(),this.da.rtl,this.Pib,this.Avc,pc);jb.transform=`translate(${Vc}px, ${pd}px)`;la.DOMElementExtensions.fqe(ua,wd.Dfa,!0);ua.Y9()}}zh(F){return(F=this.da.za.Mx(F))?new Ue.a(F,this.da):null}Emi(){if(this.ha.qa.Bn){const F=this.ha.qa.jj;if(null!=F&&1===F.top&&1===F.left&&F.bottom===F.maxRows&&F.right===
F.maxColumns)return!0}return!1}sxc(){L.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}J$b(){return!1}Pwb(F,ua,jb,pc){pc=void 0===pc?!1:pc;var Vc=la.DOMElementExtensions.getBoundingClientRect(ua);let pd=ua===this.UO[yb.GCd]||ua===this.UO[yb.xrf];var gd=ua===this.UO[yb.yrf]||ua===this.UO[yb.FCd];this.isRow&&gd||this.qk&&pd?gd="100px":(pd=this.isRow||pd,gd=this.ks?pd?(pc?wd.Y_k:wd.c0k)+"px":(pc?wd.V_k:wd.Z_k)+"px":
(pd?pc?wd.X_k:wd.b0k:pc?wd.W_k:wd.$_k)+"px");ua=pd?ua===this.UO[yb.GCd]?"top":"bottom":ua===this.UO[yb.FCd]?"right":"left";F=100*(pd?F.x-Vc.x:F.y-Vc.y)/(pd?Vc.width:Vc.height);for(Vc=1;4>=Vc;Vc++){var Md=document.createElement("div"),ze=document.createElement("div");const T=document.createElement("div");Md.appendChild(ze);Md.appendChild(T);pc&&(ze=document.createElement("div"),Md.appendChild(ze),T.style.fontWeight="bold");Md.className=this.ks?oc.Iri:oc.Wri;this.$y[Vc.toString()]=Md;this.Gh.NU(jb,
Vc).rl.appendChild(Md);if(Md=this.$y[Vc.toString()])Md.style[ua]=gd,Md.style[pd?"left":"top"]=F+"%"}}CJd(F,ua,jb,pc){var Vc=ja.f(this.$);let pd;if(this.g1a){pd=Vc.sl(pc);const gd=Kc.a.iP(pc,pd.view.xn);jb=Id.a.az(gd,pd.domElement,jb,Vc.rtl);pc=Vc.yl(F,pc,!0)}else pd=Vc.sl(this.paneType),jb=Id.a.az(pd.view.xn,this.domElement.parentNode,jb,Vc.rtl),pc=Vc.yl(F,void 0,!0);Vc=this.da.kj;return ua&&jb.y-pc.topLeft.y>pc.height/2?tc.E(Vc.vZa(F)):!ua&&jb.x-pc.topLeft.x>pc.width/2?tc.E(Vc.f_a(F)):F}y6g(F,ua,
jb,pc){const Vc=ja.f(this.$);let pd;if(this.g1a){pd=Vc.yl(F,pc);var gd=Vc.sl(pc);pc=Kc.a.iP(pc,gd.view.xn);jb=Id.a.az(pc,gd.domElement,jb,Vc.rtl)}else pd=Vc.yl(F),gd=Vc.sl(this.paneType),jb=Id.a.az(gd.view.xn,this.domElement.parentNode,jb,Vc.rtl);gd=!1;pc=2;ua&&jb.y-pd.topLeft.y>pd.height/2?(gd=!0,pc=1):!ua&&jb.x-pd.topLeft.x>pd.width/2&&(gd=!0);if(gd){ua=Vc.mt("DragSelectionClickBehavior.updateMouseSelectionRange",Vc.t5,pc);try{ua.hG(F),ua.$$mn(),ua.$$cu()}finally{ua&&ua.dispose()}}}JWa(F){this.Gh.Mq(this.KF);
this.RGa(this.GPc,this.HPc,void 0,F);this.hya&&this.U_c()}BX(F){this.ks?this.CTb():this.Gh.Mq(wd.kYa);this.RGa(this.Rr,this.Bo,void 0,F);this.hya&&this.U_c()}U_c(){var F;this.DCd&&(null===(F=this.SKa)||void 0===F?void 0:F.stopTrackAnimation(this.DCd));this.DCd=void 0}l9b(F,ua){var jb;this.U_c();if(null===(jb=this.SKa)||void 0===jb?0:jb.startTrackAnimation(ua,F))this.DCd=F}Fnb(F){return F.La.keyCode===Cb.a.k$a||da.a.isMac&&F.La.keyCode===Cb.a.Pac}EVd(F){return F.La.ctrlKey||da.a.isMac&&F.La.altKey}MUb(F){F=
ja.f(this.$).getRangeInformation(F);for(let ua=0,jb=F.length;ua<jb;++ua)if(Object(bd.a)(ce.PivotTableRange,F[ua]))return F=ee.a.nj(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Je.a(this.$).YC([F]),!0;return!1}Q2e(){this.UVd||(this.ha.S4e(this.lae),this.UVd=!0)}o6a(){this.ha&&(this.ha.KFg(this.lae),this.UVd=!1)}v7a(F){var ua;this.da.YU=F;null===(ua=za.a.nh(qa.jd))||void 0===ua?void 0:ua.K2i(F)}i6(){return 1===this.FX}doa(){return 2===this.FX}}wd.$_k=-85;wd.b0k=-40;wd.W_k=-120;wd.X_k=-50;wd.Z_k=
-95;wd.c0k=-50;wd.V_k=-130;wd.Y_k=-60;wd.bTk=2;wd.kYa=[48];wd.bii=[66,68];wd.aii=[67,69];wd.$ek=[58,60];wd.Zek=[59,61];wd.fvc=[[],[],[],[],[],[]];wd.mgk=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8196440_ReduceDragAreaIfAutoFilter");Object(C.a)(wd,"DragSelectionClickBehavior",yb,[]);var Rb=a(27),dc;(function(F){F[F.none=0]="none";F[F.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";F[F.applyLinkFailed=2]="applyLinkFailed";F[F.pasteHtmlFailed=3]="pasteHtmlFailed";F[F.pasteStringFailed=4]="pasteStringFailed";
F[F.pasteRangeFailed=5]="pasteRangeFailed";F[F.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";F[F.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";F[F.clipboardIsInaccessible=8]="clipboardIsInaccessible";F[F.pasteArtFailed=9]="pasteArtFailed";F[F.noArtSourceItem=10]="noArtSourceItem";F[F.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";F[F.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";
F[F.invalidShadowWorkbook=13]="invalidShadowWorkbook";F[F.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";F[F.failedToPasteExternalImage=15]="failedToPasteExternalImage";F[F.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";F[F.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";F[F.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";F[F.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";
F[F.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";F[F.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";F[F.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed";F[F.invalidHtml=23]="invalidHtml";F[F.failedToProcessClipboardHtml=24]="failedToProcessClipboardHtml"})(dc||(dc={}));Object(C.b)("PasteErrorType",dc);class $a{constructor(F,ua){this.errorName=this.innerError=null;this.errorName=F;this.innerError=void 0===ua?null:
ua}}Object(C.a)($a,"CCPError",null,[]);class Wb extends $a{constructor(F,ua){ua=void 0===ua?null:ua;super(ee.a.ei(void 0===F?null:F,"_"),ua)}}Object(C.a)(Wb,"EwaCCPError",$a,[]);class rc extends $a{constructor(F,ua,jb,pc,Vc){ua=void 0===ua?null:ua;jb=void 0===jb?null:jb;pc=void 0===pc?"":pc;Vc=void 0===Vc?100:Vc;super(dc[F]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=F;this.ewaErrors=ua;this.validationFailureReason=Vc;this.innerError=
ua?new Wb(ua,jb):jb;this.message=pc}}Object(C.a)(rc,"PasteInnerError",$a,[]);var xb=a(216),ic=a(123),Rc=a(264),Zc=a(64);class Kd{constructor(F,ua){this.destinationRange=this.sourceRange=null;this.sourceRange=F;this.destinationRange=ua}}Object(C.a)(Kd,"MacroRecorderTableRowColumnRearrangedPayload",null,[146]);class fe extends wd{constructor(F,ua,jb,pc,Vc,pd){super(F,ua,jb,pc,Vc,pd);this.Qqa=null;this.$I=this.EH=!1;this.$Jc=0;this.WYc=this.yvc=null;this.mR=0;this.zrf=na.a.instance.ia(2269);this.hii=
na.a.instance.ia(2270);this.pSg=na.a.instance.ia(2271);this.MJk=na.a.instance.ia(2272);this.onKeyDown=gd=>this.Fnb(gd)||gd.La.keyCode===Cb.a.Nzb?(this.Z3b(),!this.e6&&this.Fnb(gd)&&(this.e6=!0,ja.f(this.$).co.OA(yb.gsc),this.ks&&this.P3c()),this.qP||gd.La.keyCode!==Cb.a.Nzb||(this.qP=!0,2===this.mR?(this.BX(!1),this.FX=0,this.EH=this.$I,this.m9b(!1,gd.La.rawEvent)):3===this.mR?(this.IWa(!1),this.FX=this.isRow?1:2,this.Eca(!1,gd.La.rawEvent)):1===this.mR&&(this.JWa(!1),this.Eca(!1,gd.La.rawEvent))),
!0):!1;this.onKeyUp=gd=>this.Fnb(gd)||gd.La.keyCode===Cb.a.Nzb?(this.$Jc=this.Fnb(gd)?0:1,1===this.$Jc&&(2===this.mR?(this.IWa(!1),this.FX=0,this.Eca(!0,gd.La.rawEvent)):3===this.mR?(this.BX(!1),this.FX=this.isRow?1:2,this.m9b(!0,gd.La.rawEvent)):1===this.mR&&(this.BX(!1),this.Txb(!0,gd.La.rawEvent))),this.P9a(this.$Jc),0===this.$Jc&&(this.da.YU&&ja.f(this.$).co.OA(yb.ICd),this.ks&&this.P3c()),!0):!1;this.HPc=gd=>{gd=this.zoomManager.il(gd);this.o6a();5===this.vz?this.Aog(gd):(this.O5?this.v7a(!1):
this.da.YU=!1,this.ks&&(this.j8a(!1),this.DTb()),!this.$.qy([this.Oh],!1)||this.afk()||this.NXd()||(this.ha.sourceRange=this.sourceRange.clone(),this.Y$j(),this.$I?this.Oh.top>this.sourceRange.top&&(gd=this.Oh.height,this.Oh.top-=gd,this.Oh.bottom-=gd):this.Oh.left>this.sourceRange.left&&(gd=this.Oh.width,this.Oh.left-=gd,this.Oh.right-=gd),this.e8()));this.JWa(!0);this.tableRange=null;this.vz=-1;this.Qqa=null;this.mR=0;return!0};this.Dog=()=>{this.O5?this.v7a(!1):this.da.YU=!1;this.o6a();this.mR=
0;this.ks&&(this.j8a(!1),this.DTb());if(!this.$.qy([this.Oh],!1))return this.IWa(!0),this.vz=-1,this.TGa(),!0;if(this.R8g()&&!this.MUb(this.Oh)&&!this.MUb(this.sourceRange)&&!this.NXd()){this.e8();this.ha.sourceRange=this.sourceRange.clone();var gd=this.ha.sourceRange;const Md=this.ha.qa.jj;this.HC?this.$.ti(-694765314,2,30,{[X.a.Dma]:this.e6,[X.a.xvc]:!0,[X.a.zvc]:this.EH,[X.a.W4]:gd,[X.a.V4]:Md,[X.a.Mva]:this.qP,[X.a.Mib]:this.iWb}):this.$.ti(-694765314,2,30,{[X.a.Dma]:this.e6,[X.a.xvc]:!0,[X.a.zvc]:this.EH,
[X.a.W4]:gd,[X.a.V4]:Md,[X.a.Mva]:this.qP});this.e6||(this.Oh.top>this.sourceRange.top&&(this.isRow||this.Oh.left===this.sourceRange.left&&this.EH)?(gd=this.Oh.height,this.Oh.top-=gd,this.Oh.bottom-=gd):this.Oh.left>this.sourceRange.left&&(this.qk||this.Oh.top===this.sourceRange.top&&!this.EH)&&(gd=this.Oh.width,this.Oh.left-=gd,this.Oh.right-=gd),this.e8())}this.IWa(!0);this.Qqa=this.tableRange=null;this.vz=-1;this.EH=!1;this.TGa();return!0};this.GPc=gd=>{gd=this.zoomManager.il(gd);var Md=gd.clientPoint;
this.n7=gd;var ze=this.HC?this.ha.a4(Md,gd.li,5,!0):this.ha.Uy(Md,gd.li,5,void 0,void 0,!0);this.ks&&(this.i6()||this.doa())&&(this.zxb(Md),this.E8b(Md));if(ze){if(this.tableRange.contains(ze.topLeft)){if(gd=this.g1a?this.da.fh.Lo(ze):void 0,this.LXb?ze=this.CJd(ze,this.$I,Md,gd):this.y6g(ze,this.$I,Md,gd),this.Oh=this.nWa(ze),this.ha.sourceRange=this.Oh,this.Gh.qt(this.Oh,this.KF),this.Gh.Jw(this.KF),this.ks?this.CTb():this.Gh.Mq(wd.kYa),6!==this.vz){for(Md=1;4>=Md;Md++)if(ze=this.$y[Md.toString()])ze.parentNode.removeChild(ze),
this.Gh.NU(this.$I?11:12,Md).rl.appendChild(ze);this.vz=6}}else this.Oh=this.hKb(ze),this.aPf(gd,!1);this.dQ()}return!0};this.wog=gd=>{gd=this.zoomManager.il(gd);var Md=gd.clientPoint;this.n7=gd;var ze=this.HC?this.ha.a4(Md,gd.li,5,!0):this.ha.Uy(Md,gd.li,5,void 0,void 0,!0);this.ks&&(this.i6()||this.doa())&&(this.zxb(Md),this.E8b(Md));if(ze){if(this.QQf(ze))return this.Oh=this.hKb(ze),this.$Of(gd,!1),!0;var T=this.g1a?this.da.fh.Lo(ze):void 0;if(this.isRow||this.qk){if(this.LXb)ze=this.CJd(ze,this.isRow,
Md,T);else{gd=ja.f(this.$);if(this.g1a){var Za=gd.yl(ze,T);var Bb=gd.sl(T);T=Kc.a.iP(T,Bb.view.xn);Md=Id.a.az(T,Bb.domElement,Md,gd.rtl)}else Za=gd.yl(ze),Bb=gd.sl(this.paneType),Md=Id.a.az(Bb.view.xn,this.domElement.parentNode,Md,gd.rtl);T=!1;Bb=2;this.EH=!1;this.isRow&&Md.y-Za.topLeft.y>Za.height/2?(T=!0,Bb=1):this.qk&&Md.x-Za.topLeft.x>Za.width/2&&(T=!0);if(T){gd=gd.mt("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",gd.t5,Bb);try{gd.hG(ze),gd.$$mn(),ze=gd.$$cu().range}finally{gd&&
gd.dispose()}}}this.Oh=this.hKb(ze)}else{Za=ja.f(this.$);if(this.g1a){Bb=Za.sl(T);var Gc=Kc.a.iP(T,Bb.view.xn);Md=Id.a.az(Gc,Bb.domElement,Md,Za.rtl);T=Za.yl(ze,T,!0)}else T=Za.yl(ze),Bb=Za.sl(this.paneType),Md=Id.a.az(Bb.view.xn,this.domElement.parentNode,Md,Za.rtl);Bb=!1;Gc=2;this.EH=!1;this.LXb?Math.abs(Md.x-T.topLeft.x)<.3*T.width?this.EH=!1:Math.abs(Md.x-T.bottomRight.x)<.15*T.width?(this.EH=!1,Bb=!0):Md.y-T.topLeft.y<=T.height/2?this.EH=!0:Md.y-T.topLeft.y>T.height/2&&(Bb=this.EH=!0):Md.x-T.topLeft.x===
T.width?(this.EH=!1,Bb=!0):Md.y-T.topLeft.y>T.height/2&&(this.EH=Bb=!0,Gc=1);this.Qqa&&(this.EH=this.$I);if(Bb)if(this.LXb)Md=this.da.kj,ze=this.EH?tc.E(Md.vZa(ze)):tc.E(Md.f_a(ze));else{Md=Za.mt("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Za.t5,Gc);try{Md.hG(ze),Md.$$mn(),ze=Md.$$cu().range}finally{Md&&Md.dispose()}}this.Gh.Mq(this.KF);this.KF=this.EH?[11]:[12];for(Md=1;4>=Md;Md++)(T=this.$y[Md.toString()])&&T.parentNode.removeChild(T),this.$y[Md.toString()]=null;this.Pwb(gd.clientPoint,
gd.li,this.EH?11:12);this.Oh=this.nWa(ze)}this.ha.sourceRange=this.Oh;this.ks?this.l3c():(this.Gh.qt(this.Oh,this.KF),this.Gh.Jw(this.KF));this.ks?this.CTb():this.Gh.Mq(wd.kYa);if(6!==this.vz){for(ze=1;4>=ze;ze++)if(gd=this.$y[ze.toString()])Md=this.ks?this.isRow?58:this.qk?59:this.EH?11:12:this.isRow||this.EH?11:12,gd.parentNode.removeChild(gd),this.Gh.NU(Md,ze).rl.appendChild(gd);this.vz=6}this.ks||this.dQ()}return!0};this.lae=()=>{this.da.YU&&5<=this.vz&&(this.tableRange?this.qP?this.BX(!0):this.JWa(!0):
this.qP?this.isRow||this.qk?this.BX(!0):this.IWa(!0):this.isRow||this.qk?this.IWa(!0):this.BX(!0));this.P9a(void 0);this.mR=0;this.vz=-1;this.o6a()};this.tableRange=null;this.tya=this.e6=this.qP=!1}dispose(){this.P9a(void 0);super.dispose()}R$d(F){this.n7=F;this.Qqa=null;this.$I=this.isRow=this.qk=this.EH=!1;gc.a.instance.xa(hb.a.Ui,this.domElement.ownerDocument.body,this.onKeyDown);if(F.La.shiftKey||this.EVd(F))this.Z3b(),F.La.shiftKey&&(this.qP=!0),this.EVd(F)&&(this.e6=!0,ja.f(this.$).co.OA(yb.gsc));
this.Q2e();this.O5?this.v7a(!0):this.da.YU=!0;(this.tableRange=this.ISh(this.Qj.Ay(this.sourceRange.topLeft)))&&!this.tableRange.equals(this.sourceRange)?(this.Qqa=this.tableRange,this.mR=1,this.$I=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right,this.qP?this.Eca(!1,F.La.rawEvent):this.Txb(!0,F.La.rawEvent)):(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.qk=this.sourceRange.qk,this.isRow||this.qk?(this.mR=3,this.FX=this.isRow?1:2,this.qP?this.Eca(!1,
F.La.rawEvent):this.m9b(!0,F.La.rawEvent),this.ks&&(F=F.clientPoint,this.ERg(F),this.Fdf(F))):(this.mR=2,this.FX=0,this.qP?this.m9b(!1,F.La.rawEvent):this.Eca(!0,F.La.rawEvent)))}u4a(){this.O5?this.v7a(!1):this.da.YU=!1;this.o6a();this.mR=0;this.ks&&(this.j8a(!1),this.DTb());if(!this.$.qy([this.Oh],!1))return this.BX(!0),this.TGa(),this.vz=-1,!0;if(!this.R8g()||this.MUb(this.Oh)||this.MUb(this.sourceRange))this.vz=-1;else{this.e8();this.ha.sourceRange=this.sourceRange.clone();const F=this.ha.sourceRange,
ua=this.ha.qa.jj;this.HC?this.$.ti(-694765314,2,30,{[X.a.Dma]:this.e6,[X.a.W4]:F,[X.a.V4]:ua,[X.a.Mva]:this.qP,[X.a.Mib]:this.iWb}):this.$.ti(-694765314,2,30,{[X.a.Dma]:this.e6,[X.a.W4]:F,[X.a.V4]:ua,[X.a.Mva]:this.qP})}this.BX(!0);this.TGa();return!0}S$d(F){const ua=F.clientPoint,jb=this.HC?this.ha.a4(ua,F.li,5,!0):this.ha.Uy(ua,F.li,5,void 0,void 0,!0);this.n7=F;this.ks&&(this.i6()||this.doa())&&(this.zxb(ua),this.E8b(ua));return this.QQf(jb)?(this.Oh=this.nWa(jb),this.$Of(F,!0),!0):this.O5i(jb)?
(this.Oh=this.hKb(jb),this.aPf(F,!0),!0):!1}dQ(F){F=void 0===F?!1:F;const ua=this.Oh.toString();for(let jb=1;4>=jb;jb++){const pc=this.$y[jb.toString()];pc&&pc.childNodes&&0<pc.childNodes.length&&(pc.childNodes[0].innerText=ua,pc.childNodes[1].innerText=this.yvc,F&&(pc.childNodes[2].innerText=this.WYc))}}QQf(F){return!!this.Qqa&&1!==this.mR&&!!F&&this.Qqa.contains(F.topLeft)}O5i(F){return!!this.Qqa&&1===this.mR&&!!F&&!this.Qqa.contains(F.topLeft)}$Of(F,ua){this.tableRange=this.Qqa;this.mR=1;const jb=
!this.qP;ua?(this.BX(!1),this.Txb(jb,F.La.rawEvent)):(this.IWa(!1),this.Eca(jb,F.La.rawEvent))}aPf(F,ua){this.tableRange=null;this.mR=2;const jb=!this.qP;ua?(this.BX(!1),this.EH=this.$I,this.m9b(jb,F.La.rawEvent)):(this.JWa(!1),this.Eca(jb,F.La.rawEvent))}nse(){if(!ja.f(this.$).ha.qa.Bn)return L.ULS.sendTraceTag(507875651,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;const F=ja.f(this.$).getRangeInformation(this.ha.qa.jj);
for(const ua of F)if(Object(bd.a)(ce.PivotTableRange,ua))return L.ULS.sendTraceTag(507875650,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because intersecting a pivot table"),!1;return!0}ISh(F){if(F&&F.contains(this.sourceRange)&&!F.equals(this.sourceRange)){if(F.Bxa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===F.top){const ua=new Rb.Range(this.sourceRange.top,this.sourceRange.left,F.bottom,this.sourceRange.right,!1,!1);if(!ua.equals(F))return this.sourceRange=
ua,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),F}this.$I=F.left===this.sourceRange.left&&F.right===this.sourceRange.right;if(F.top===this.sourceRange.top&&F.bottom===this.sourceRange.bottom||this.$I)return F}return null}nWa(F){const ua=F.clone();this.$I?ua.left=Math.max(F.left-this.Bmb,1):ua.top=Math.max(F.top-this.Tzb,1);ua.right=ua.left+this.sourceRange.width-1;ua.bottom=ua.top+this.sourceRange.height-1;return this.mIb(ua)}NXd(){const F=this.Oh.topLeft.Xi(this.sourceRange);
return!F&&(this.tableRange||this.ks&&(this.isRow||this.qk))?this.$I||this.ks&&this.isRow?this.Oh.top===this.sourceRange.bottom+1:this.Oh.left===this.sourceRange.right+1:F}afk(){if(this.$I&&this.Oh.left!==this.tableRange.left||!this.$I&&this.Oh.top!==this.tableRange.top){const F=ee.a.nj(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Je.a(this.$).YC([F]);return!0}return!1}Y$j(){const F=this.$.Eh.Li("UserAction","RearrangeRowColumnClientSide"),ua={["CopyPasteTargetType"]:1,["OperationId"]:Mc.a.create().toString(),
["Stopwatch"]:F,["DragDropIsShiftKeyDown"]:this.qP,["EncounteredDeploymentErrors"]:!1},jb=this.e6?2:1,pc=this.$.la.lh(254);(new Promise((Vc,pd)=>{this.eti(gd=>{gd.Errors&&0<gd.Errors.length?pd(new rc(22,gd.Errors)):Vc(!0)},gd=>{gd=ic.a.kk(gd.data);pd(new rc(22,gd))})})).then(()=>{L.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');pc&&pc.cBj(ua,jb,this.sourceRange,this.Oh);return Promise.resolve(!0)},Vc=>{L.ULS.sendTraceTag(520747155,
0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Vc?copyPasteInfra.getStringifiedError(Vc):"null"}, copyPasteTargetType="${1}"`);return pc?pc.jYj(Vc,ua,jb,this.sourceRange,this.Oh):Promise.reject(Vc)})}eti(F,ua){F=void 0===F?null:F;ua=void 0===ua?null:ua;const jb={};this.$I?(jb.FirstRow=this.Oh.top-1,jb.FirstColumn=0,jb.DeltaColumn=0,jb.DeltaRow=this.Oh.bottom-this.Oh.top+1):(jb.FirstRow=0,jb.FirstColumn=this.Oh.left-1,jb.DeltaColumn=this.Oh.right-this.Oh.left+1,jb.DeltaRow=
0);jb.LastRow=Ec.a.eG;jb.LastColumn=Ec.a.PE;jb.SheetName=this.$.sa.ma?this.$.sa.ma.name:this.$.Yh.getItemByName(this.$.Yh.ma.name).sheetName;const pc=tc.x(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new xb.a(514,0,(Vc,pd,gd)=>{var Md=this.$.pa.ta;Vc=F?Rc.c(Vc,F):Vc;pd=ua?Rc.b(pd,ua):pd;const ze=Md.$a(41,null);ze.sourceRange=pc;ze.destinationRange=jb;return Zc.h(Md,"RearrangeRowColumn",ze,Vc,pd,gd,null,0)},64,()=>new Kd(pc,jb)),null)}P9a(F){void 0===F?this.qP=this.e6=!1:0===
F?this.e6=!1:1===F&&(this.qP=!1);!this.tya||this.e6||this.qP||(gc.a.instance.Qa(hb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.tya=!1)}Z3b(){this.tya||(gc.a.instance.xa(hb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.tya=!0)}rff(){gc.a.instance.Qa(hb.a.Ui,this.domElement.ownerDocument.body,this.onKeyDown);this.P9a(void 0)}mhe(F){F=void 0===F?!1:F;this.vz=5;this.aqa(this.Rr,this.Bo);this.yvc=this.hii;this.WYc=this.MJk;this.Pwb(this.n7.clientPoint,this.n7.li,this.ks&&this.isRow?
66:this.ks&&this.qk?67:48,F)}hhk(F){F=void 0===F?!1:F;this.vz=6;let ua;this.ks?this.isRow?(this.KF=wd.$ek,ua=58):this.qk?(this.KF=wd.Zek,ua=59):this.$I?(this.KF=[11],ua=11):(this.KF=[12],ua=12):(ua=this.isRow||this.$I?11:12,this.KF=[ua]);this.aqa(this.wog,this.Dog);this.yvc=this.zrf;this.WYc=this.pSg;this.Pwb(this.n7.clientPoint,this.n7.li,ua,F)}xhe(F){F=void 0===F?!1:F;this.vz=6;this.KF=this.$I?[11]:[12];this.aqa(this.GPc,this.HPc);this.yvc=this.zrf;this.WYc=this.pSg;this.Pwb(this.n7.clientPoint,
this.n7.li,this.$I?11:12,F)}Eca(F,ua){this.hya&&this.l9b(this.isRow?"drag_row_replace":this.qk?"drag_column_replace":"drag_range_replace",ua);this.mhe(F);this.qzb(F)}m9b(F,ua){this.hya&&this.l9b(this.isRow?"drag_row_insert":this.qk?"drag_column_insert":"drag_range_insert",ua);this.hhk(F);this.l3c(F)}Txb(F,ua){this.hya&&this.l9b(this.$I?"drag_table_row_rearrange":"drag_table_column_rearrange",ua);this.xhe(F);this.l3c(F)}IWa(F){this.Gh.Mq(this.KF);this.RGa(this.wog,this.Dog,void 0,F);this.hya&&this.U_c()}f4f(){return!this.Oh.equals(this.sourceRange)}g4f(){return!this.NXd()}TVd(){return this.e6}R8g(){return this.ha.qa.jj.equals(this.Oh)?
(L.ULS.sendTraceTag(507787463,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Drag Drop Not Allowed because source range and destination range are the same"),!1):!0}}Object(C.a)(fe,"DragSelectionClickBehaviorCellRangeAndTable",wd,[]);var Ld=a(360),Gd=a(139);class Zd extends wd{constructor(F,ua,jb,pc,Vc,pd){super(F,ua,jb,pc,Vc,pd);this.lae=()=>{this.da.YU&&this.JWa(!0);5===this.vz&&this.BX(!0);this.o6a()};this.HPc=gd=>{this.zoomManager.il(gd);this.O5?this.v7a(!1):this.da.YU=!1;this.o6a();this.ks&&
(this.j8a(!1),this.DTb());this.ha.sourceRange=this.sourceRange.clone();if(this.U2f)this.$.ti(927125067,xd.a.rh,30,null);else if(this.Tga){this.e8();this.ha.sourceRange=this.sourceRange.clone();gd=this.ha.sourceRange;const Md=this.ha.qa.jj;this.HC?this.$.ti(-694765314,2,30,{[X.a.Dma]:!0,[X.a.W4]:gd,[X.a.V4]:Md,[X.a.Mva]:!1,[X.a.Mib]:this.iWb}):this.$.ti(-694765314,2,30,{[X.a.Dma]:!0,[X.a.W4]:gd,[X.a.V4]:Md,[X.a.Mva]:!1});L.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells");
ja.f(this.$).co.OA(X.a.raa);this.Tga=!1}else this.R$j();this.JWa(!0);this.HC&&this.TGa();this.vz=-1;return!0};this.GPc=gd=>{gd=this.zoomManager.il(gd);const Md=gd.clientPoint;this.n7=gd;let ze=this.HC?this.ha.a4(Md,gd.li,5,!0):this.ha.Uy(Md,gd.li,5,void 0,void 0,!0);this.ks&&(this.i6()||this.doa())&&(this.zxb(Md),this.E8b(Md));if(ze){if(!this.DYd(ze))return this.b2i(gd),!0;gd=this.g1a?this.da.fh.Lo(ze):void 0;this.LXb?ze=this.CJd(ze,this.isRow,Md,gd):this.y6g(ze,this.isRow,Md,gd);if(this.isRow||this.qk)this.Oh=
this.nWa(ze);this.ha.sourceRange=this.Oh;this.Gh.qt(this.Oh,this.KF);this.Gh.Jw(this.KF);this.ks?this.CTb():this.Gh.Mq(wd.kYa);this.dQ()}return!0};this.onKeyDown=gd=>this.Fnb(gd)?(this.Z3b(),this.Tga||(this.Tga=!0,ja.f(this.$).co.OA(yb.gsc),this.ks&&this.P3c()),!0):!1;this.onKeyUp=gd=>{this.Fnb(gd)&&(this.P9a(),this.da.YU?ja.f(this.$).co.OA(yb.ICd):ja.f(this.$).co.OA(X.a.raa),this.ks&&this.P3c());return!0};this.wng=gd=>{gd.Errors&&0<gd.Errors.length?(L.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${ee.a.ei(gd.Errors)}]`),
this.Oh.left=this.sourceRange.left,this.Oh.right=this.sourceRange.right,this.Oh.top=this.sourceRange.top,this.Oh.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Oh.top&&this.sourceRange.bottom>=this.Oh.top-1?(this.Oh.top=this.sourceRange.top,this.Oh.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Oh.top||(this.Oh.top-=this.sourceRange.height),this.Oh.bottom=this.Oh.top+this.sourceRange.height-1):this.sourceRange.left<=this.Oh.left&&this.sourceRange.right>=this.Oh.left-
1?(this.Oh.left=this.sourceRange.left,this.Oh.right=this.sourceRange.right):(this.sourceRange.left>this.Oh.left||(this.Oh.left-=this.sourceRange.width),this.Oh.right=this.Oh.left+this.sourceRange.width-1);this.e8();this.vz=-1};this.vng=gd=>{gd=ic.a.kk(gd.data);L.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${ee.a.ei(gd)}]`)};this.Tga=this.tya=!1}dispose(){super.dispose()}R$d(F){this.n7=F;this.isRow=this.qk=!1;this.Q2e();this.FX=null!=this.Oh?
this.Oh.isRow?1:this.Oh.qk?2:0:0;this.O5?this.v7a(!0):this.da.YU=!0;gc.a.instance.xa(hb.a.Ui,this.domElement.ownerDocument.body,this.onKeyDown);this.EVd(F)&&(this.Z3b(),this.Tga=!0,ja.f(this.$).co.OA(yb.gsc));this.Rh=this.Qj.bxa(this.sourceRange);this.VXf=this.spj(this.Oh);this.Rh||L.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.U2f=(new Gd.a(this.$.sa)).wn;this.DYd(this.Oh)?(this.isRow=
this.jqj(),this.qk=this.jij(),this.isRow||this.qk?(this.xob=!1,this.Oh=this.nWa(this.Oh),this.Txb(F)):(this.xob=!0,this.Eca(F))):(this.xob=!0,this.Eca(F),this.ks&&(this.i6()||this.doa())&&(F=F.clientPoint,this.ERg(F),this.Fdf(F)))}u4a(){this.O5?this.v7a(!1):this.da.YU=!1;this.o6a();this.ks&&(this.j8a(!1),this.DTb());if(this.U2f)return this.$.ti(927125067,xd.a.rh,30,null),this.HC&&this.TGa(),this.BX(!0),this.xob=!1,this.vz=-1,!0;if(this.Tga||this.VXf){this.e8();this.ha.sourceRange=this.sourceRange.clone();
const F=this.ha.sourceRange,ua=this.ha.qa.jj;this.HC?this.$.ti(-694765314,2,30,{[X.a.Dma]:this.Tga,[X.a.W4]:F,[X.a.V4]:ua,[X.a.Mva]:!1,[X.a.Mib]:this.iWb}):this.$.ti(-694765314,2,30,{[X.a.Dma]:this.Tga,[X.a.W4]:F,[X.a.V4]:ua,[X.a.Mva]:!1});L.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.Tga}"`);ja.f(this.$).co.OA(X.a.raa);this.BX(!0);this.HC&&this.TGa();this.xob=!1;this.vz=-1;this.VXf=!1;return!0}return 5===
this.vz?(this.BX(!0),this.xob=!1,this.AOk(),this.vz=-1,!0):!1}S$d(F){const ua=F.clientPoint,jb=this.HC?this.ha.a4(ua,F.li,5,!0):this.ha.Uy(ua,F.li,5,void 0,void 0,!0);this.n7=F;this.ks&&(this.i6()||this.doa())&&(this.zxb(ua),this.E8b(ua));return this.xob?!1:this.DYd(jb)?(this.c2i(F),!0):!1}dQ(){const F=new Rb.Range(this.Oh.top,this.Oh.left,this.Oh.bottom,this.Oh.right,!1,!0);6===this.vz&&(this.isRow?(--F.top,F.bottom=F.top+this.Oh.height-1):(--F.left,F.right=F.left+this.Oh.width-1));for(let ua=1;4>=
ua;ua++){const jb=this.$y[ua.toString()];jb&&jb.childNodes&&0<jb.childNodes.length&&(jb.childNodes[0].innerText=F.toString())}}nse(){if(!ja.f(this.$).ha.qa.Bn)return L.ULS.sendTraceTag(507875653,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;var F=ja.f(this.$).getRangeInformation(this.ha.qa.jj);for(var ua of F)if(Object(bd.a)(ce.PivotTableRange,ua)&&(F=this.Qj.bxa(ua)))return ua=!F.isOlap||!F.lpb(!0),L.ULS.sendTraceTag(512341331,
0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",F),F.isActionable&&ua;return!1}nWa(F){F=F.clone();this.isRow?(F.left=this.sourceRange.left,F.right=this.Rh.right,F.bottom=F.top+this.sourceRange.height-1):this.qk?(F.top=this.sourceRange.top,F.bottom=this.Rh.lL?this.Rh.lL.bottom:this.Rh.bottom,F.right=F.left+this.sourceRange.width-1):L.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");
return this.mIb(F)}R$j(){const F={},ua=tc.x(this.sourceRange,this.$);if(this.isRow){ua.FirstColumn=F.FirstColumn=this.Oh.left-1;ua.LastColumn=F.LastColumn=this.Oh.right-1;if(this.sourceRange.top<=this.Oh.top&&this.sourceRange.bottom>=this.Oh.top-1){L.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Oh.top?F.LastRow=F.FirstRow=this.Oh.top-1:(F.FirstRow=this.Oh.top-this.sourceRange.height-1,F.LastRow=F.FirstRow+
this.sourceRange.height-1)}else{F.FirstRow=Math.min(this.Oh.top,this.Oh.bottom-1);F.LastRow=this.Oh.bottom-1;if(this.sourceRange.left<=this.Oh.left&&this.sourceRange.right>=this.Oh.left-1){L.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}F.LastColumn=this.sourceRange.left>this.Oh.left?F.FirstColumn=this.Oh.left-1:F.FirstColumn=this.Oh.left-this.sourceRange.width-1}const jb={};jb.SheetName=this.$.sa.ma?this.$.sa.ma.name:this.$.Yh.getItemByName(this.$.Yh.ma.name).sheetName;
jb.Ranges=Array(2);jb.Ranges[0]=ua;jb.Ranges[1]=F;this.$si(jb)}$si(F){this.$.userOperationManager.enqueueOperation(new xb.a(265,0,(ua,jb,pc)=>{var Vc=this.$.pa.ta;ua=this.wng?Rc.c(ua,this.wng):ua;jb=this.vng?Rc.b(jb,this.vng):jb;const pd=Vc.$a(1,null);pd.moveRange=F;return Zc.h(Vc,"MoveLineItems",pd,ua,jb,pc,null,0)},64),null)}DYd(F){return null!==this.Rh&&null!==F&&this.$mj(F)&&this.bqj(F)&&this.ssj(F)&&this.ghj(F)}$mj(F){return this.Rh.lL?F.left>=this.Rh.lL.left:this.Rh.HI?F.left>=this.Rh.HI.left:
F.left>=this.Rh.left}bqj(F){return this.Rh.HI?F.right<=this.Rh.HI.right:this.Rh.lL?F.right<=this.Rh.lL.right:F.right<=this.Rh.right}ssj(F){return this.isRow?null!==this.Rh.lL&&F.top>=this.Rh.lL.top:this.qk?null!==this.Rh.HI&&F.top>=this.Rh.HI.top:null===this.Rh.top||F.top>=this.Rh.top}ghj(F){return this.Rh.lL?F.bottom<=this.Rh.lL.bottom:this.Rh.HI?F.bottom<=this.Rh.HI.bottom:F.bottom<=this.Rh.bottom}spj(F){return null!==this.Rh&&this.Rh.left>=F.left&&this.Rh.right<=F.right&&this.Rh.top>=F.top&&this.Rh.bottom<=
F.bottom}jqj(){return null!==this.Rh&&null!==this.Rh.lL&&this.Rh.lL.top<=this.Oh.top&&this.Rh.lL.left<=this.Oh.left&&this.Rh.lL.right>=this.Oh.left}jij(){return null!==this.Rh&&null!==this.Rh.HI&&this.Rh.HI.top===this.Oh.top&&this.Rh.HI.left<=this.Oh.left&&this.Rh.HI.right>=this.Oh.right}xhe(F){this.vz=6;this.KF=this.isRow?[11]:[12];this.aqa(this.GPc,this.HPc);this.Pwb(F.clientPoint,F.li,this.isRow?11:12,!1)}mhe(F){this.vz=5;this.aqa(this.Rr,this.Bo);this.Pwb(F.clientPoint,F.li,this.ks&&this.i6()?
66:this.ks&&this.doa()?67:48,!1)}Txb(F){this.hya&&this.l9b(this.isRow?"drag_pivot_row_rearrange":"drag_pivot_column_rearrange",F.La.rawEvent);this.xhe(F);this.l3c()}Eca(F){this.hya&&this.l9b("drag_pivot_replace",F.La.rawEvent);this.mhe(F);this.qzb()}c2i(F){this.BX(!1);this.Oh=this.nWa(this.Oh);this.Txb(F)}b2i(F){this.JWa(!1);this.Eca(F)}AOk(){if((null==this.sourceRange||null==this.Oh||this.sourceRange.FE(!1)!==this.Oh.FE(!1))&&!this.MUb(this.Oh)){var F=ee.a.nj(1,0,904,903,0,2069074184,"PivotTableInvalidMove");
F.HelpTopicId=Ld.a.RSk;F.HelpDescription=na.a.instance.ia(913);Je.a(this.$).YC([F])}}P9a(){this.Tga=!1;this.tya&&(gc.a.instance.Qa(hb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.tya=!1)}Z3b(){this.tya||(gc.a.instance.xa(hb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.tya=!0)}f4f(){return!this.Oh.equals(this.sourceRange)}g4f(){return!1}TVd(){return this.Tga}rff(){gc.a.instance.Qa(hb.a.Ui,this.domElement.ownerDocument.body,this.onKeyDown);this.P9a()}}Object(C.a)(Zd,"DragSelectionClickBehaviorPivotTableRange",
wd,[]);var Bc=a(431);class Lc extends Dd{constructor(F,ua){super(F);this.sm=()=>{this.domElement.classList.remove(oc.selecting);Bc.c(this.da.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Ry=()=>{this.domElement.classList.add(oc.selecting)};this.onPointerDown=jb=>{2===jb.Dh&&jb.Ew===Sys.UI.MouseButton.leftButton&&(this.da.ha.selectionType=4,this.da.ha.sourceRange=this.da.ha.qa.jj,Bc.c(this.da.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.R6=()=>{this.da.$.ti(1983983164,
2,30,null);return!0};this.Dj=()=>{la.DOMElementExtensions.setVisible(this.Rma,this.da.$.isEditMode)};this.L1b=()=>{la.DOMElementExtensions.setVisible(this.Rma,!1)};this.K1b=()=>{la.DOMElementExtensions.setVisible(this.Rma,!0)};this.ulg=()=>{la.DOMElementExtensions.setVisible(this.Rma,!1)};this.tlg=()=>{la.DOMElementExtensions.setVisible(this.Rma,!0)};this.y0b=(jb,pc)=>{la.DOMElementExtensions.setVisible(this.Rma,!pc.ind)};this.da=ua;ua=document.createElement("div");ua.className=ya.EwaSettings.aG()?
yd.Lb:yd.Kb;this.Rma=ua;this.Dj(null,null);F.appendChild(ua);fb.a.instance.xa(hb.a.qj,this.Rma,this.onPointerDown);fc.a.instance.xa(hb.a.Nr,this.Rma,this.R6);this.da.$.kr(this.Dj);this.da.$.vh.g5e(this.L1b);this.da.$.vh.f5e(this.K1b);this.da.T3e(this.y0b);this.da.cellTextEditBox.Fv(this.ulg);this.da.cellTextEditBox.jy(this.tlg)}dispose(){fb.a.instance.Qa(hb.a.qj,this.Rma,this.onPointerDown);fc.a.instance.Qa(hb.a.Nr,this.Rma,this.R6);this.da.$&&(this.da.ha.uia(this.Ry),this.da.ha.D7(this.sm),this.da.$.Wr(this.Dj),
this.da.$.vh.YFg(this.L1b),this.da.$.vh.XFg(this.K1b),this.da.UEg(this.y0b),this.da.cellTextEditBox.zv(this.ulg),this.da.cellTextEditBox.qx(this.tlg));super.dispose()}}Object(C.a)(Lc,"FillHandleClickBehavior",Dd,[]);class Cd{constructor(F){this.eTf=ua=>{this.a3c(ua.li,1);return!0};this.fTf=ua=>{this.a3c(ua.li,-1);return!0};this.sm=()=>{this.cXd=!1};this.Ry=()=>{this.cXd=!0};this.da=F;this.Gmb=0;this.cXd=this.uHc=!1;this.pha=Number.NaN;this.da.ha.ila(this.Ry);this.da.ha.T3(this.sm);this.da.ha.S4e(this.sm)}dispose(){this.da.ha.uia(this.Ry);
this.da.ha.D7(this.sm);this.da.ha.KFg(this.sm)}tZ(){this.Gmb=0;this.uHc=!1;this.pha=Number.NaN}Brf(F){this.uHc=!0;this.a3c(F,1)}Crf(F){this.uHc=!1;this.a3c(F,-1)}a3c(F,ua){if(F)if(F.parentNode)if(this.cXd)isNaN(this.pha)||(this.u3c(this.pha,!1),this.pha=Number.NaN);else if(F=parseInt(F.parentNode.getAttribute(X.a.lUb),10),isNaN(F))L.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.pha)&&F!==this.pha){if(this.uHc)return;
this.u3c(this.pha,!1)}if(isNaN(this.pha)||F!==this.pha)this.pha=F,this.Gmb=0;!this.Gmb&&0<ua&&this.u3c(F,!0);this.Gmb=Math.max(this.Gmb+ua,0);!this.Gmb&&0>ua&&(this.u3c(F,!1),this.pha=Number.NaN)}else L.ULS.shipAssertTag(537159367,0,!!F.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else L.ULS.shipAssertTag(537159368,0,!!F,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}u3c(F,ua){var jb=this.da.fh.hbc;for(const pc of jb)for(jb=this.da.Gh.NU(3,pc,
F).rl,la.DOMElementExtensions.toggleCssClass(jb,oc.Ari,ua),jb=jb.firstChild;jb;jb=jb.nextSibling)Va.a.contains(jb.className,"resizemarqueehandle",!0)&&la.DOMElementExtensions.toggleCssClass(jb,oc.Cri,ua)}}Object(C.a)(Cd,"MarqueeHoveringManager",null,[]);var Fd=a(327),te=a(153),ye=a(1054),ue=a(1390),De=a(392);class Ke extends Nb{constructor(F,ua){super(F);this.jDc=!1;this.FPc=()=>{if(!this.tB)return L.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.tB.edk(this.Ana);this.tB.ili(this.Bna);if(3===this.tB.model.state)return!0;this.tB.cSd(!0);return!0};this.ppa=()=>{if(!this.tB)return!1;this.tB.kzg(!1);this.tB.hle(this.Bna,!1);if(3===this.tB.model.state)return!0;this.tB.cSd(!1);return!0};this.onPointerDown=jb=>this.tB?2===jb.Dh&&jb.Ew===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.Y0b=()=>{if(!this.tB)return!1;this.tB.hle(this.Bna,!0);this.tB.cSd(!1);this.tB.Cib();return!0};this.onDoubleClick=jb=>{if(jb.La)return jb.La.stopPropagation(),!0;
L.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.container=F;this.tB=Object(te.a)(ue.a,ua.metadata);this.qTg(ua)&&this.BVf(ua.isVisible)}dispose(){this.ADg();this.tB=null;super.dispose()}Feb(F){this.tB=Object(te.a)(ue.a,F.metadata);this.qTg(F)?this.BVf(F.isVisible):this.ADg();!ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&F.isVisible!==F.ZLa&&this.tB&&(this.tB.oHk(F.isVisible?
1:0),la.DOMElementExtensions.setVisible(this.Bna,F.isVisible))}BVf(F){this.jDc||(this.jDc=!0,this.Bna=document.createElement("div"),this.Bna.id=`${this.container.id}-${X.a.Ndf}`,this.Bna.className=ye.f,this.Ana=document.createElement("div"),this.Ana.id=`${this.container.id}-${X.a.zUh}`,this.Ana.className=ye.c,this.Q0=document.createElement("div"),this.Q0.appendChild(this.Ana),this.Q0.className=ye.d,this.Bna.appendChild(this.Q0),this.container.appendChild(this.Bna),L.ULS.sendTraceTag(537159365,0,50,
"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),fb.a.instance.xa(hb.a.o7,this.Q0,this.FPc),fb.a.instance.xa(hb.a.aL,this.Q0,this.ppa),fb.a.instance.xa(hb.a.qj,this.Q0,this.onPointerDown),Fd.a.instance.xa(hb.a.click,this.Q0,this.Y0b),Fd.a.instance.xa(hb.a.Nr,this.Q0,this.onDoubleClick),la.DOMElementExtensions.setVisible(this.Q0,F))}ADg(){this.jDc&&(this.jDc=!1,fb.a.instance.Qa(hb.a.o7,this.Q0,this.FPc),fb.a.instance.Qa(hb.a.aL,
this.Q0,this.ppa),fb.a.instance.Qa(hb.a.qj,this.Q0,this.onPointerDown),Fd.a.instance.Qa(hb.a.click,this.Q0,this.Y0b),Fd.a.instance.Qa(hb.a.Nr,this.Q0,this.onDoubleClick),la.DOMElementExtensions.$m(this.Ana),this.Ana=null,la.DOMElementExtensions.$m(this.Bna),this.Bna=null)}qTg(F){F=new De.a(F.range,F.sheetId);return!!this.tB&&this.tB.HFc(F)}}Object(C.a)(Ke,"RangeCatchUpActivityHighlightBehavior",Nb,[]);class pe extends Ob{constructor(F,ua,jb,pc,Vc){super(F,ua,jb,pc,Vc)}get waa(){return 16}get ewb(){return this.da.ha.rangePicker.vJd(!1)}$7a(){return(this.da.inRangePicker||
this.da.kq)&&super.$7a()}}Object(C.a)(pe,"RangePickerTouchGrippiesBehavior",Ob,[]);class pf extends Nb{constructor(F,ua,jb){super(F);const pc=document.createElement("div"),Vc=document.createElement("div");ya.EwaSettings.ks()?jb?(pc.className=ua?oc.fsi:oc.hsi,Vc.className=ua?oc.gsi:oc.esi):(pc.className=ua?oc.bsi:oc.dsi,Vc.className=ua?oc.csi:oc.asi):(pc.className=ua?oc.jsi:oc.lsi,Vc.className=ua?oc.ksi:oc.isi);F.appendChild(pc);F.appendChild(Vc)}}Object(C.a)(pf,"RearrangeHighlightBehavior",Nb,[]);
var qf;(function(F){F[F.topLeft=0]="topLeft";F[F.topRight=1]="topRight";F[F.bottomLeft=2]="bottomLeft";F[F.bottomRight=3]="bottomRight";F[F.error=4]="error"})(qf||(qf={}));Object(C.b)("Corner",qf);class of extends Nb{constructor(F,ua,jb,pc,Vc,pd){super(F);this.Zi=this.$V=null;this.qfa=0;this.Oh=this.sourceRange=null;this.O8a=!1;this.onPointerDown=gd=>{gd=this.zoomManager.il(gd);if(this.RSg(gd)&&!this.O8a){this.R9f();this.Zi=this.lw.tJd();this.$V=this.lw.yLf(gd);if(!this.Zi||!this.$V||!this.$V.range)return L.ULS.shipAssertTag(537159361,
0,!!this.Zi,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),L.ULS.shipAssertTag(537159360,0,!!this.$V,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),L.ULS.shipAssertTag(537159331,0,!!this.$V.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Oh=this.$V.range.clone();this.sourceRange=this.Oh.clone();this.qfa=this.KGf(gd);if(4===this.qfa)return L.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;const Md=this.dJf(gd,!0);if(!Md)return L.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.Elf(Md))return L.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.da.KKa=!0;this.Zi.tO(!1);this.BP.Brf(gd.li);this.lw.Azg(!0,this.NR.Wla);this.Zi.Wa.removeSelection();this.Zi.lmc(this.JPf);this.QCg();this.O8a=!0;$c.b(this.$,!0)}return!0};this.Rr=
gd=>{gd=this.zoomManager.il(gd);gd=this.dJf(gd,!1);if(!gd)return!0;gd=this.Elf(gd);if(!gd)return L.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.dyc(!0),!1;if(this.Oh.equals(gd))return!0;this.Oh=gd;gd=this.qzb();gd||(L.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.dyc(!0));return gd};this.Bo=gd=>{this.zoomManager.il(gd);gd=this.e8();L.ULS.shipAssertTag(537159325,0,gd,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");
this.dyc(!gd);return gd};this.JPf=()=>{this.dyc(!0)};this.da=ua;this.zoom=pd;this.$=ua.$;this.TV=[];this.ha=this.da.ha;this.BP=jb;this.lw=pc;this.NR=Vc;ua=qa.Ec.Aa()?za.a.nh(qa.Ec):this.$.la.lh(464);L.ULS.shipAssertTag(510255176,0,!!ua,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");this.DD=ua.DD;for(const gd of this.vIg())ua=this.lw.Ikf(F,gd,this.w5e(),this.onPointerDown),this.TV.push(ua);for(const gd of this.TV)fb.a.instance.xa(hb.a.o7,
gd,this.BP.eTf),fb.a.instance.xa(hb.a.aL,gd,this.BP.fTf);this.Feb(Vc)}dispose(){this.TV.forEach(F=>{fb.a.instance.Qa(hb.a.qj,F,this.onPointerDown)});this.TV.length=0;super.dispose()}get zoomManager(){return this.zoom.zoomManager}Feb(F){this.NR=F;this.E5e(F);this.lw.t7b(F,this.TV,this.mse());this.BP.tZ()}dJf(F,ua){const jb=F.li;F=F.clientPoint;if(!jb||!F)return L.ULS.shipAssertTag(537159324,0,!!jb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),L.ULS.shipAssertTag(537159323,0,!!F,
"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ua&&(F=this.wdg(F));ua=this.ha.Uy(F,jb,0,!0,!1,!0);ua||(F=this.wdg(F),ua=this.ha.Uy(F,jb,0,!0,!1,!0));return ua}wdg(F){F.y+=0===this.qfa||1===this.qfa?2:-2;F.x+=0===this.qfa||2===this.qfa?2:-2;return F}Elf(F){if(!F||!this.sourceRange)return L.ULS.shipAssertTag(537159322,0,!!F,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),L.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.qfa)return new Rb.Range(F.top,F.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.qfa)return new Rb.Range(F.top,this.sourceRange.left,this.sourceRange.bottom,F.right,!0,!1);if(2===this.qfa)return new Rb.Range(this.sourceRange.top,F.left,F.bottom,this.sourceRange.right,!0,!1);if(3===this.qfa)return new Rb.Range(this.sourceRange.top,this.sourceRange.left,F.bottom,F.right,!0,!1);L.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${qf[this.qfa]}`);
return null}e8(){return this.DD.vdg(this.Zi,this.$V,this.Oh)}qzb(){return this.e8()}dyc(F){F&&L.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate formula highlights as a fallback.");this.BP.Crf(this.TV[0]);this.lw.Azg(!1,this.NR.Wla);this.Zi.Wa.setCaretPositionToEnd();this.Zi.FUc(this.JPf);this.x4g();this.O8a=this.da.KKa=!1;$c.b(this.$,!1);this.lw.oBg()}}Object(C.a)(of,"ResizeMarqueeBehaviorBase",Nb,[]);class Ef extends of{constructor(F,
ua,jb,pc,Vc,pd){super(F,ua,jb,pc,Vc,pd)}vIg(){return[oc.psi,oc.qsi,oc.nsi,oc.osi]}w5e(){return[oc.msi]}KGf(F){F=F.li;if(F===this.TV[0])return 0;if(F===this.TV[1])return 1;if(F===this.TV[2])return 2;if(F===this.TV[3])return 3;L.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}QCg(){this.lw.aqa(this.Rr,this.Bo,!0)}x4g(){this.lw.gze(this.Rr,this.Bo,!0)}RSg(F){return 2===(xd.a.rh=F.Dh)&&F.Ew===Sys.UI.MouseButton.leftButton}mse(){return!0}R9f(){L.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}E5e(F){for(const ua of this.TV)ua.style.backgroundColor=F.rl.style.borderColor}}Object(C.a)(Ef,"ResizeMarqueeMouseBehavior",of,[]);class Nf extends of{constructor(F,ua,jb,pc,Vc,pd){super(F,ua,jb,pc,Vc,pd);this.S0b=()=>{const gd=3===xd.a.rh;this.O0d&&!gd?this.lw.t7b(this.NR,this.TV,!1):!this.O0d&&gd&&this.lw.t7b(this.NR,this.TV,!0);this.O0d=gd};this.GYj=(gd,Md)=>{Md.lUb===this.NR.Wla&&this.lw.t7b(this.NR,
this.TV,!Md.start&&this.mse())};xd.a.t4e(this.S0b);this.O0d=3===xd.a.rh;this.lw.lDh(this.GYj)}dispose(){xd.a.sFg(this.S0b);super.dispose()}vIg(){return[yd.tb,yd.sb]}w5e(){return[yd.pb,yd.rb,yd.qb]}KGf(F){F=F.li;if(F===this.TV[0])return 0;if(F===this.TV[1])return 3;L.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}QCg(){da.a.ZR?this.lw.aqa(this.Rr,this.Bo,!1):this.lw.Dhk(this.Rr,this.Bo)}x4g(){da.a.ZR?this.lw.gze(this.Rr,
this.Bo,!1):this.lw.b5k(this.Rr,this.Bo)}RSg(F){return 3===(xd.a.rh=F.Dh)}mse(){return 3===xd.a.rh}R9f(){L.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}E5e(){}}Object(C.a)(Nf,"ResizeMarqueeTouchBehavior",of,[]);class Kf extends Nb{constructor(F,ua){super(F);Kf.lMb(F,Qc.a.Gri+" "+yd.v,null===ua||void 0===ua?void 0:ua.horizontal);Kf.lMb(F,Qc.a.Fri+" "+yd.v,null===ua||void 0===ua?void 0:ua.vertical);Kf.lMb(F,Qc.a.Dri+" "+
yd.v,null===ua||void 0===ua?void 0:ua.horizontal);Kf.lMb(F,Qc.a.Eri+" "+yd.v,null===ua||void 0===ua?void 0:ua.vertical);Kf.lMb(F,yd.Eb)}static lMb(F,ua,jb){const pc=document.createElement("div");pc.className=ua;jb&&(pc.style.backgroundImage=`url("${jb}")`);F.appendChild(pc)}}Object(C.a)(Kf,"SelectionCutCopyBehavior",Nb,[]);class Qf extends Nb{constructor(F){super(F);appChrome.renderSpinner(F)}}Object(C.a)(Qf,"SelectionPasteBehavior",Nb,[]);class Hf extends Nb{constructor(F,ua){super(F);Hf.DMb(F,Qc.a.$ri+
" "+yd.v,null===ua||void 0===ua?void 0:ua.horizontal);Hf.DMb(F,Qc.a.Zri+" "+yd.v,null===ua||void 0===ua?void 0:ua.vertical);Hf.DMb(F,Qc.a.Xri+" "+yd.v,null===ua||void 0===ua?void 0:ua.horizontal);Hf.DMb(F,Qc.a.Yri+" "+yd.v,null===ua||void 0===ua?void 0:ua.vertical);Hf.DMb(F,yd.Pb)}static DMb(F,ua,jb){const pc=document.createElement("div");pc.className=ua;jb&&(pc.style.backgroundImage=`url("${jb}")`);F.appendChild(pc)}}Object(C.a)(Hf,"SelectionRangePickerBehavior",Nb,[]);class If extends Ob{constructor(F,
ua,jb,pc,Vc){super(F,ua,jb,pc,Vc)}get waa(){return 0}get ewb(){return this.da.ha.qa.jj}$7a(){const F=this.da.kq||this.da.isEditing;return this.da.ha.qa.Bn&&!F&&super.$7a()}}Object(C.a)(If,"SelectionTouchGrippiesBehavior",Ob,[]);var ac=a(60);let Yb=class extends kb.a{constructor(F,ua,jb){super();this.eJb=(pc,Vc)=>{pc=Vc.waa;const pd=this.da;Vc=Vc.h8i;const gd=Vc.rl,Md=Vc.d$;switch(pc){case 24:Vc.d$.push(new Ke(gd,Vc));break;case 0:Vc.d$.push(new Lc(gd,pd));da.a.Ux||(Md.push(new fe(gd,this.da.$,Vc.paneType,
this.Qj,this.lw,this.zoom)),Md.push(new Zd(gd,this.da.$,Vc.paneType,this.Qj,this.lw,this.zoom)));Md.push(new If(Vc,gd,pd,Vc.paneType,this.zoom));break;case 3:Md.push(new Dd(gd));da.a.Ux||(Md.push(new qb(gd,this.da.$,Vc.paneType,this.BP,this.lw,Vc,this.zoom)),Md.push(new Ef(gd,this.da,this.BP,this.lw,Vc,this.zoom)),Md.push(new Nf(gd,this.da,this.BP,this.lw,Vc,this.zoom)));break;case 4:case 5:case 65:Md.push(new Kf(gd,this.a7e));break;case 30:Md.push(new Qf(gd));break;case 16:Md.push(new Hf(gd,this.a7e));
Md.push(new pe(Vc,gd,pd,Vc.paneType,this.zoom));break;case 11:case 12:case 58:case 59:case 60:case 61:Md.push(new pf(gd,11===pc||58===pc||60===pc,58===pc||59===pc||60===pc||61===pc));break;case 17:Md.push(new Dd(gd));break;case 19:Md.push(new Dd(gd)),Md.push(new Yc(Vc,gd,pd,Vc.paneType,this.zoom))}Vc.sJb=!0};this.$=F;this.zoom=jb;this.da=ja.f(F);this.Qj=ua;this.BP=new Cd(this.da);this.lw=new Aa(this.da);this.da.Gh&&(this.da.Gh.FCh(this.eJb),this.da.Gh.update(!1))}get a7e(){ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.$6e&&(this.$6e={vertical:ac.a.current.Nu(104),horizontal:ac.a.current.Nu(105)});return this.$6e}dispose(){this.da.Gh.umk(this.eJb);this.BP&&(this.BP.dispose(),this.BP=null);super.dispose()}};Yb=Object(S.__decorate)([Object(za.d)(qa.fd),Object(S.__param)(0,Object(qa.Nb)()),Object(S.__param)(1,Object(qa.vg)()),Object(S.__param)(2,Object(qa.ah)())],Yb);Object(C.a)(Yb,"GridHighlightsBehaviorManager",kb.a,[]);var Cc=a(183),Of=a(1310),Qb=a(294),Ic=a(995),hd=a(188),Ga=a(22);class Ub extends Of.a{constructor(F,
ua,jb){super(F,ua,jb);this.Uhc=this.wFa=null}get LZ(){return xa.AFrameworkApplication.ra.wL}uGf(F){switch(F){case 1:return Object(Ga.a)("ImageUploadNoFileSpecified");case 2:return Object(Ga.a)("ImageUploadUnsupportedFileType");default:return""}}D8g(F){return Ub.xra(F,this.b_i())}b_i(){return Ub.Q_e}xra(F,ua){ua=void 0===ua?null:ua;F=this.D8g(F);return 0!==F?(ua&&ua.i2e(),2===F&&(ua=this.uGf(F),this.Ip(0,ua)),!1):!0}finalizeUpload(F,ua){L.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");
this.Gae=ua;this.wPk();Qb.a.mark(5576);this.Uhc=this.LZ.Li("LoadResource","PictureUploadTime")}Ip(F,ua){const jb=new hd.a;jb.Ph=0;jb.cE(F,Object(Ga.a)("ImageUploadFailedTitle"),ua,null)}H1b(){L.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.H1b();this.Uhc&&(this.Uhc.stop(),this.Uhc=null);this.zYh()}wPk(){this.wFa=(new Ic.a).create();this.wFa.message=Object(Ga.a)("ImageUploadWait");this.wFa.Ph=5;this.wFa.BC=!1;this.wFa.QPa(null,null,null)}zYh(){this.wFa&&(this.wFa.close(),
this.wFa=null)}static G6i(F,ua){F=ea.a.Xs(F);for(let jb=0;jb<ua.length;++jb)if(F.endsWith(ua[jb]))return!0;return!1}static xra(F,ua){ua=void 0===ua?null:ua;ua||(ua=Ub.Q_e);return F?Ub.G6i(F,ua)?0:2:1}}Ub.Q_e=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(C.a)(Ub,"PictureUploader",Of.a,[]);var yc=a(107),kd=a(42),Nd=a(653),wa=a(427),wb=a(358),zc=a(254),Hc=a(240),ed=a(130),rd=a(247),ve;(function(F){F[F.unknown=0]="unknown";F[F.bing=1]="bing";F[F.M365=2]="M365"})(ve||(ve={}));Object(C.b)("InsertMediaProviders",
ve);var Le=a(96),Qe=a(359),Vb=a(1169),cd=a(79);class Ud extends Vb.a{constructor(F,ua){super(F,cd.a.getOrigin(ua))}$3b(F,ua){this.isEnabled()&&this.x_(this.targetOrigin)&&(this.$r(F),this.wq(F,ua))}}Object(C.a)(Ud,"InsertMediaCrossDocumentMessenger",Vb.a,[876,333,2]);var re=a(2);class qe{}Object(C.a)(qe,"OnlineMediaSearchResult",null,[]);var Se=a(433),Ve;(function(F){F[F.OK=0]="OK";F[F.cancel=1]="cancel";F[F.error=2]="error";F[F.open=3]="open"})(Ve||(Ve={}));Object(C.b)("HubbleAction",Ve);class rf extends Hc.a{constructor(F,
ua,jb,pc,Vc,pd){super();this.yHc=!1;this.U1d=this.bL=this.NKa=null;this.$1f=!1;this.correlationId=null;this.aOj=()=>{this.AIa(this.Ufb);this.qwb(1)};this.p0d=gd=>{gd.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==gd.target.id||gd.shiftKey?"KeepFocusStartDiv"===gd.target.id&&gd.shiftKey&&(gd.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(gd.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.LVj=()=>{this.FIb&&(this.FIb.launchUpsellExperience("stockimages"),
L.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.nXj=gd=>{gd&&gd.Values&&(gd=gd.Values,delete gd.m_Origin,delete gd.m_Source,delete gd.m_ReceivedTime,L.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+gd.eventName||!1),Qa.a.sendOtelEvent({otelEvent:gd}))};this.dialogTitle=pd;this.$=F;this.GVf=ua;this.FIb=jb;this.Hia=[];this.Xqb=pc;this.Tei=Vc;this.q6e=this.$.ua.InsertOnlinePictureMaxCountOfImagesToInsert;this.kp=this.V6h();this.$1f=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8665911_RemoveMediaDetailsInTelemetry")}lPk(F){this.yHc=
!1;this.showDialog(this.dialogTitle,null);this.NKa=document.getElementById(this.hp("InsertMediaFrame"));if(!this.NKa)throw this.AIa(this.Ufb),Error.invalidOperation("Couldn't get InsertMediaIframe.");const ua=document.getElementById(this.hp("WACDialogPanel"));ua&&ua.setAttribute(Dc.a.hk,Dc.a.DVa);var jb=document.createElement("div");jb.id="KeepFocusStartDiv";jb.tabIndex=0;jb.className="keep-focus-start";this.NKa.parentNode.insertBefore(jb,this.NKa.parentNode.firstChild);jb=document.createElement("div");
jb.id="KeepFocusDiv";jb.tabIndex=0;jb.className="keep-focus";this.correlationId=Mc.a.create();this.NKa.parentNode.appendChild(jb);$addHandler(this.tib,"keydown",this.p0d);this.NKa.src=this.GVf;this.NKa.frameBorder="0";jb=document.getElementById(this.hp("WACDialogButtonPanel"));if(!jb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");jb.className="display-none";jb=document.getElementById(this.hp("WACDialogTitleText"));if(!jb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");
jb.className="display-none";2===this.Xqb&&(document.getElementById(this.hp("WACDialogTitlePanel")).className="display-none",document.getElementById(this.hp("WACDialogBodyPanel")).className="padding-zero");ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8728224_StockImagesDialogHeightFix")&&ua&&(ua.style.overflow="hidden",ua.style.height="auto",jb=document.getElementById(this.hp("WACDialogOuterContainer")))&&(ua.style.marginTop="",ua.style.top=(jb.parentElement.clientHeight-ua.clientHeight)/2+"px");
ed.FocusManager.instance().F0().scope.k1=!0;this.bL=new Ud(this.NKa.contentWindow,this.GVf);this.bL.x_("https://osiziwuspersimmon002.blob.core.windows.net");this.bL.x_("https://osizewuspersimmon001.blob.core.windows.net");this.bL.x_("https://osizpscuspersimmon000.blob.core.windows.net");this.bL.x_("https://cdn.hubblecontent.msit.osi.office.net");this.bL.x_("https://cdn.hubblecontent.osi.office.net");this.bL.$3b(Ka.a.Ayh,pc=>{this.QMj(pc,F.yja)});this.bL.$3b(Ka.a.insert,()=>{this.gVj(F.yja)});this.bL.$3b(Ka.a.jud,
this.aOj);this.bL.$3b(Ka.a.ezh,pc=>{this.nXj(pc)});2===this.Xqb&&0===this.Tei&&(this.bL.$3b(Ka.a.Lvj,this.LVj),this.U1d=this.FIb.$5a("MsoPremiumStockImages",pc=>{L.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");pc.isEnabled?this.bL.sendMessage(Ka.a.P$k,{["LicenseTier"]:pc.toString()}):L.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.qwb(3)}dispose(){this.Hia=null;this.FIb&&this.U1d&&this.FIb.Yhe("MsoPremiumStockImages",
this.U1d);this.bL&&(this.bL.dispose(),this.bL=null);super.dispose()}hide(){super.hide();Le.a.dYc(this.$)}get fga(){return rd.a.wuc+"/InsertMediaDialog"}get Rea(){return!1}QMj(F,ua){F=F&&F.Values?(F=F.Values)?Object(re.a)(new qe,{Action:F.action||"",Caption:F.caption||"",ContentType:F.contentType||"",FileExtension:F.extension||"",PageUrl:F.pageUrl||"",SourceUrl:F.sourceUrl||"",ThumbnailUrl:F.thumbnailUrl||"",LicenseUrl:F.licenseUrl||"",LicenseDisplayName:F.licenseDisplayName||"",Height:F.height||0,
Width:F.width||0}):null:null;F&&(this.Hia.push(F),this.yHc&&(L.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),ua(this.Hia),this.yHc=!1,this.AIa(this.Ufb)))}gVj(F){this.Hia&&0<this.Hia.length?this.Hia.length<=this.q6e?(F(this.Hia),this.qwb(0),this.AIa(this.Ufb)):(this.cE(),L.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.Hia.length=0,this.qwb(2)):this.yHc=!0}V6h(){const F=document.createElement("div");
F.id="InsertMediaDialog";F.className=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const ua=document.createElement("div");ua.id="InsertMediaPanel";ua.className=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";const jb=document.createElement("iframe");jb.id="InsertMediaFrame";jb.className=
"insert-media-frame";F.appendChild(ua);ua.appendChild(jb);return Se.b(F)}cE(){const F=ee.a.nj(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");F.Description=String.format(na.a.instance.sh(206),this.q6e.toLocaleString());new Qe.a(this.$,F)}IPi(){return 2===this.Xqb?"M365":"bing"}qwb(F){var ua,jb;if(2===this.Xqb||1===this.Xqb){const Vc=xa.AFrameworkApplication.fa.Za("InsertMediaDialogAriaTenantNameSpace");if(Vc&&""!==Vc){var pc=[{name:"DialogMode",string:this.IPi()},{name:"Provider",string:ve[this.Xqb]},
{name:"InsertedFiles",int64:null===(ua=this.Hia)||void 0===ua?void 0:ua.length},{name:"DialogResult",string:Ve[F]},{name:"CorrelationId",string:null===(jb=this.correlationId)||void 0===jb?void 0:jb.toString()}];this.$1f||pc.push({name:"MediaDetails",string:this.Hia?JSON.stringify(this.Hia.map(pd=>pd.SourceUrl)):null});Qa.a.sendTelemetryEvent({name:String.format("{0}.{1}",Vc,"InsertOnlineImages"),dataFields:pc})}}}}Object(C.a)(rf,"InsertMediaDialog",Hc.a,[]);var sb=a(436),lc=a(310),Uc=a(357);class od extends Ub{constructor(F,
ua,jb,pc,Vc,pd){super(null,jb,pc);this.A$f=0;this.yja=gd=>{if(gd){var Md=Array(gd.length);for(var ze=0;ze<gd.length;ze++){const Bb=gd[ze];Md[ze]={};Md[ze].SourceUrl=Bb.SourceUrl;ea.a.noa(Bb.LicenseUrl)&&ea.a.noa(Bb.PageUrl)&&(Md[ze].LicenseUrl=Bb.LicenseUrl,Md[ze].LicenseDisplayName=Bb.LicenseDisplayName,Md[ze].PageUrl=Bb.PageUrl);Md[ze].AltText=-2053056795===this.Nh.command?Bb.Caption:"";Md[ze].IsCellPicture=15735758===this.Nh.command||570484235===this.Nh.command}var T=-2009825598===this.Nh.command?
"bing":"M365";ze=ja.f(this.$);var Za=tc.q(ze.ha.qa.activeCell,this.$);wa.a(this.$.userOperationManager,(Bb,Gc,qd)=>wb.w(this.$.pa.ta,Za,Md,T,Rc.c(Bb,this.CXj),Rc.b(Gc,this.BXj),qd,null),Bb=>new xb.a(595,0,Bb),this.Nh);ae.HelperMethods.Saa?(ze=new Map,ze.set("MediaProvider",T),ze.set("ImagesCount",gd.length.toString()),ze.set("TimeTakenToOpenDialog",this.A$f.toString()),yc.Health.instance.recordKpiUsage(lc.a.jej,Uc.b.SuccessBased,sb.a.G_g,ze)):L.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");
this.H1b()}else L.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};this.CXj=gd=>{if(zc.a(gd))L.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${ee.a.ei(gd.Errors)}`);else{L.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const Md=this.Nh.command;15735758!==Md&&570484235!==Md&&(gd.Result?Sa.a(this.$).YOa(1,
gd.Result):L.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};this.BXj=()=>{L.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=F;this.Nh=ua;this.jT=pd;this.g7e=kd.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let F=null;F=this.$.Eh.Li("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Nh.command){case -2009825598:case 15735758:this.tOk();
break;case -2053056795:case 570484235:this.g7e.execute(ua=>{ua.isFeatureEnabled("MsoPremiumStockImages",!1).catch(jb=>L.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${jb}`)).then(jb=>{this.uOk(jb);return null})})}F.stop();this.A$f=F.zi}tOk(){let F=this.$.ua.BingPictureEndpoint;const ua=Nd.a.MU(xa.AFrameworkApplication.lcid),jb=Mc.a.create();F?(F=0<F.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(F,
1,1):String.format(F,1,xa.AFrameworkApplication.lcid,ua?ua.name:"en-us",xa.AFrameworkApplication.buildVersion,jb.toString(),1,this.$.ua.DocumentHostInfo.LoggableUserId),this.ysc(F,1,-1,na.a.instance.ia(1764))):(L.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.jT.setException(Error.create("Failed to access the Bing service endpoint")))}uOk(F){var ua=this.$.ua.M365PictureEndpoint,jb=Mc.a.create();if(ua){var pc=
this.$.ua.DocumentHostInfo.UserId;pc=pc?ea.a.rE(pc).toString():"0";var Vc=this.g7e.instance.isFreemiumUpsellEnabled();F=F?1:Vc?0:-1;jb=jb.toString();Vc=Nd.a.MU(xa.AFrameworkApplication.lcid).name;ua=String.format(ua,xa.AFrameworkApplication.lcid,Vc,xa.AFrameworkApplication.buildVersion,jb,1,pc,F,1);this.ysc(ua,2,F,na.a.instance.ia(1763))}else L.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.jT.setException(Error.create("Failed to access the M365 service endpoint"))}ysc(F,
ua,jb,pc){try{(new rf(this.$,F,kd.a.instance.Ho("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),ua,jb,pc)).lPk(this),this.jT.setResult(!0)}catch(Vc){L.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${Vc}] [MediaProvider : ${ua}] [DialogLicenseTier : ${jb}]`),this.jT.setException(Vc)}}}Object(C.a)(od,"OnlinePictureUploaderWrapper",Ub,[2]);let sd=class{constructor(F,ua){this.$=F;this.uploaderCreator=ua}executeCommand(F,ua,jb){F=
ua.command;switch(F){case 1403967063:case -2060689045:if(jb&&"dataUrl"in jb)return ua=new Cc.a,this.uploaderCreator&&this.uploaderCreator.zbj(this.$,ka.TaskManager.instance,xa.AFrameworkApplication.fa,jb,jb.dataUrl,ua),ua.task;this.uploaderCreator&&this.uploaderCreator.Lcj(this.$,ua,ka.TaskManager.instance,xa.AFrameworkApplication.fa,jb);return mb.Task.Ua(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return F=new Cc.a,new od(this.$,ua,ka.TaskManager.instance,xa.AFrameworkApplication.fa,
jb,F),F.task;default:return Ja.a(F)}}Gi(F,ua){let jb=this.$.isEditMode;if(jb)switch(ua.command){case 1403967063:jb=!0;break;case -2053056795:jb=!0;break;case -2009825598:jb=!0;break;case -2060689045:case 15735758:case 570484235:jb=zb.a.rWb()&&1===F;break;default:jb=!1}return jb}dj(){return!1}Ri(){return!1}};sd=Object(S.__decorate)([Object(za.d)(qa.zd),Object(S.__param)(0,Object(qa.Nb)()),Object(S.__param)(1,Object(qa.Lg)())],sd);Object(C.a)(sd,"PictureCommandHandler",null,[43]);var be=a(73);class Ee{}
Ee.ggi="DisplayNotInvoked";Ee.gCd="Displayed";Ee.u9j="PrerequisitesNotReady";Object(C.a)(Ee,"PasteIndicationDisplayStatus",null,[]);var Ie=a(58),bf=a(54),Xe=a(32),Ze=a(311),tf=a(922),ff;let ef=ff=class{constructor(F){this.PMb="";this.iG=this.lC=null;this.ctb=new Map;this.lea=null;this.bSc=!1;this.aSf=(ua,jb)=>{this.hide(void 0===ua?null:ua,void 0===jb?null:jb)};this.$=F;this.da=ja.f(F);this.da.ha.Vw(this.aSf)}zCd(){this.bSc||(L.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),
this.da.$.C5(F=>{F.eaa(0).then(()=>{this.bSc=!0})}))}Rwk(F){this.zCd();this.PMb=F;this.ULg(F)}HLg(F){const ua=F.commandParameters.id;L.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${ua}, cancelCtx is null = ${!this.lC}, PrerequisitesDownloaded = ${this.bSc}`);this.zCd();this.PMb=ua;const jb=!this.Meg();if(!this.lC||jb)this.cdf(),this.lC=Ie.a.instance.create(()=>{this.fgi(F)},void 0===F.timeoutToShowSpinnerInMs||null===F.timeoutToShowSpinnerInMs?100:F.timeoutToShowSpinnerInMs,
bf.a.Y4j);this.lea=F.commandParameters.originalDestinations;this.ULg(ua)}fgi(F){this.bSc?(this.display(F.commandParameters.originalDestinations),F.pasteIndicationDisplayStatus=Ee.gCd):(L.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),F.pasteIndicationDisplayStatus=Ee.u9j)}ULg(F){this.ctb.set(F,Xe.a.ih.$j);Ie.a.instance.create(()=>{this.rgi(F)},this.$.ua.PasteToastNotificationDelayTime,bf.a.Z4j)}rgi(F){this.ctb.has(F)&&
(this.iG?this.iG.displayTimeoutSeconds+=this.$.ua.PasteToastNotificationDefaultDisplayDuration:(F=na.a.instance.ia(2341),this.iG=Ba.a.dB.UK.IX(F,!1),this.iG.image=5,this.iG.R0=tf.a.qgk,this.iG.displayTimeoutSeconds=this.$.ua.PasteToastNotificationDefaultDisplayDuration,Ba.a.dB.UK.EF(this.iG)))}Jga(F,ua,jb){F&&this.iG&&(F=jb?`"${ua}" ${na.a.instance.ia(2433)}`:na.a.instance.ia(2342),this.iG.n3c(F),this.iG.image=5,this.iG.R0=jb?tf.a.$Zk:tf.a.cff);setTimeout(()=>{this.Okk()},3E3)}Okk(){this.iG&&(Ba.a.dB.UK.removeEntry(this.iG),
this.iG=null)}display(F){L.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.da.Gh.aQ(De.a.t9a(be.d(this.da.$.ma),F),ff.fRc,!0);this.da.Gh.Jw(ff.fRc)}tmb(F,ua,jb,pc){ua=void 0===ua?!0:ua;jb=void 0===jb?null:jb;pc=void 0===pc?!1:pc;L.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${F}, currentPasteCommandId = ${this.PMb}`);F&&Va.a.equals(F,this.PMb,!1)&&this.hide();if(F&&this.ctb.has(F)){const Vc=Ze.a(Xe.a.ih.$j,this.ctb.get(F));
6E4<Vc&&L.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${F}), scheduleDisplayToHideDurationInMs (${Vc}))`);this.ctb.delete(F);null!=this.iG&&0===this.ctb.size&&this.Jga(ua,jb,pc)}}hide(F){this.lea&&(void 0===F?0:F)&&this.Meg()&&L.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.PMb="";this.cdf();this.lea=null;0!==this.da.Gh.HJd([30]).length&&
(this.da.Gh.Mq(ff.fRc),this.da.Gh.qt(null,ff.fRc))}Meg(){return tc.X(this.da.ha.qa.selectedRanges,this.lea)}cdf(){this.lC&&(ra.a.dh(this.lC),this.lC=null)}dispose(){this.hide();this.iG&&this.Jga(!1);this.da.ha.rx(this.aSf)}};ef.fRc=[30];ef=ff=Object(S.__decorate)([Object(za.d)(qa.Be),Object(S.__param)(0,Object(qa.Nb)())],ef);Object(C.a)(ef,"PasteIndicationManager",null,[725,2]);var Sf=a(159);Object(za.b)(qa.Ce,{Ek:"singleton"})(F=>Lo(function*(){const ua=yield za.a.resolve(qa.Nb,F),jb=gc.a.instance,
pc=Sf.a.instance.tU();return new zf(ua,jb,pc)}));class zf extends pb.a{constructor(F,ua,jb){super();this.statusBarManager=null;this.Ppf=()=>{this.Ouc()};this.xfi=()=>{this.Ouc()};this.Opf=pc=>{10===pc&&this.Ouc()};this.onKeyDown=pc=>13===pc.La.keyCode?(pc=new Db.a(237279923,1,2,6,null),this.$.Ma.qh(pc,{[X.a.skipClipboardAccess]:!0,[X.a.juf]:!0}),!0):!1;this.$=F;this.OD=ua;this.au=jb;this.bEd=!1;this.$.la.fi(29,pc=>{this.statusBarManager=pc;pc.dO(this)})}dispose(){this.to();this.au=this.OD=this.$=
null;this.statusBarManager&&(this.statusBarManager.pN(this),this.statusBarManager=null)}pr(){return!0}xy(F,ua){if("QueryPasteShortcutEnabledLabel"!==F&&!zf.XUk.includes(F))return!1;const jb=this.tP();"QueryPasteShortcutEnabledLabel"===F?(ua.Visible=jb,L.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${jb} for commandId ${F}`)):(ua.Visible=!jb,L.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!jb} for commandId ${F}`));
return!0}Nki(){this.Hp();this.raiseEvent("pasteShortcutStatusChanged")}Ouc(){this.to();this.raiseEvent("pasteShortcutStatusChanged")}tP(){return this.bEd}ky(F){this.addHandler("pasteShortcutStatusChanged",F)}Xx(F){this.removeHandler("pasteShortcutStatusChanged",F)}Hp(){if(!this.tP()){this.bEd=!0;ja.f(this.$).Bp.Fv(this.Ppf);this.au.Ba("blur",this.xfi);const F=qa.Qb.Aa()?za.a.nh(qa.Qb):this.$.la.lh(65);F&&F.ffa&&F.ffa.registerForCommentEvents(this.Opf);this.OD.YD(hb.a.Ui,this.$.pK,this.onKeyDown,!0)}}to(){if(this.tP()){this.bEd=
!1;ja.f(this.$).Bp.zv(this.Ppf);this.au.detach("blur");const F=qa.Qb.Aa()?za.a.nh(qa.Qb):this.$.la.lh(65);F&&F.ffa&&F.ffa.unregisterForCommentEvents(this.Opf);this.OD.iE(hb.a.Ui,this.$.pK,this.onKeyDown,!0)}}}zf.XUk=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(C.a)(zf,"PasteShortcutManager",pb.a,[726,168,169,2]);const sf=F=>{switch(F){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;
case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var lf=a(217),Ra=a(128);class Lb{static get udk(){return Lb.KVe||(Lb.KVe=RegExp("([A-Z]+)",
"g"))}static get tdk(){return Lb.JVe||(Lb.JVe=RegExp("([A-Z])","g"))}static get pWh(){return Lb.EIe||(Lb.EIe=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static CNd(F){return Lb.DKf(F.toString())}static DKf(F){return Lb.pWh.test(F)?F.replace(Lb.udk,"$1 ").replace(Lb.tdk,' "$1"').trim():F}static Epk(F){const ua=F.lastIndexOf("!");return F.substring(0,-1<ua?ua+1:0)+Lb.DKf(F.substring(-1<ua?ua+1:0,F.length))}}Lb.KVe=null;
Lb.JVe=null;Lb.EIe=null;Object(C.a)(Lb,"RangeAriaExtensions",null,[]);class Nc{constructor(){this.activeItemName=null;this.B2f=!1;this.tableName=null;this.Xgb=0;this.J0c=!1}}Object(C.a)(Nc,"SelectionReadoutState",null,[]);var Ed=a(197),Wd=a(953),$d;let se=$d=class{constructor(F,ua,jb,pc,Vc){this.HGa=this.gridReadoutNotifier=null;this.XLg=!1;this.Spa=()=>{ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?L.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
ja.f(this.$).isEditing&&!ja.f(this.$).inRangePicker||this.Znc.LA()};this.LMj=()=>{if(!ja.f(this.$).ha.$e.$Xd){var pd,gd=(()=>{let Md=this.GDi();({activeCell:pd}=Md);return Md})().returnValue;this.readText(gd,pd)}};this.yS=()=>{const pd=this.activeCell;this.readText("Editing",pd);ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||pd&&pd.qDc&&!ja.f(this.$).EQf||this.Znc.cancel()};this.Jj=()=>{ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&
!this.$?L.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):this.Spa()};this.$=ua;this.ariaLiveNotifier=F;this.h9b=pc;this.Qj=jb;this.oN=new Nc;this.Wnb=Da.Wnb();this.XLg=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8582263_ScreenReaderShapeInfoReadoutEnabled");this.Wnb&&(this.gridReadoutNotifier=Vc,L.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?
$d.Omd=0:$d.Omd=700);this.Znc=Ie.a.instance.create(this.LMj,$d.Omd,bf.a.Wyk,!1);this.Hp()}get activeCell(){return ja.f(this.$).zh(null)}dispose(){this.$&&this.to();ra.a.dh(this.Znc);this.h9b=this.$=this.Znc=null}aKd(F,ua,jb){jb=void 0===jb?!0:jb;if(null!==this.$.vh.Hn&&"FindAndReplaceDialog"===this.$.vh.Hn.Di||!F)return"";var pc=this.$.la;const Vc=new Sys.StringBuilder;this.jIh(Vc,F,ua);if(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var pd=this.Qj.bxa(F.range);(null===
pd||void 0===pd?0:pd.Rse)&&this.x7e(Vc,pd);pd=this.Qj.Ay(F.range);(null===pd||void 0===pd?0:pd.Bxa)&&this.x7e(Vc,pd)}pd=F.L5?this.OHf(F):F.text;ba(Vc,pd);pd=this.$.activeItemName;this.oN.activeItemName!==pd&&(ba(Vc,pd),this.oN.activeItemName=pd);pd=1===ua.length?tc.R(ua).isSingle?"":na.a.instance.ia(853):String.format(na.a.instance.sh(31),ua.length);ba(Vc,pd);for(var gd of ua)pd=this.Wnb?gd.toString():Lb.CNd(gd),ba(Vc,pd),1===ua.length&&$d.wsj(gd)&&(pd=ja.f(this.$).za.Mx(gd.bottomRight),void 0!==
pd&&null!==pd&&pd.text&&(pd=pd.L5?this.NHf(pd,pd.text):pd.text,ba(Vc,pd)));gd=F.cell;gd=this.cSi(gd.Ouk,gd.tZh);ba(Vc,gd);this.THh(Vc,F);jb&&(F.Aob?ba(Vc,na.a.instance.ia(841)):F.P1a&&ba(Vc,na.a.instance.ia(842)));if(F.hasAutoFilter||F.vna)this.kIh(Vc,F.hasAutoFilter?F.cell.autoFilterType:F.cell.$5j),jb&&ba(Vc,na.a.instance.ia(844));lf.d(this.$,F.range)&&ba(Vc,na.a.instance.ia(848));this.RHh(Vc,F);jb=(jb=za.a.nh(qa.tb))?jb.IEi():"";ba(Vc,jb);F.DC&&(jb=ja.f(this.$).za.Mx(F.range),jb=!!jb&&jb.hasIgnorableError,
$d.WJk(F)?$d.SHh(Vc,F):ya.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&jb?ba(Vc,na.a.instance.ia(846)):ba(Vc,na.a.instance.ia(845)));F.LR&&(ba(Vc,na.a.instance.ia(847)),F.gTb&&ba(Vc,String.format(na.a.instance.sh(16),F.kbi)),ba(Vc,F.iconName));F.hasRichValueIcon&&(gd=za.a.nh(qa.hb),jb="",gd&&F.cell.hLc&&(gd=gd.U4(F.cell.hLc))&&gd.DomainId.Id!==$d.mel&&(jb=gd.Name),F.cell.Egj?(ba(Vc,String.format(na.a.instance.sh(187),jb)),ba(Vc,na.a.instance.ia(1812))):(ba(Vc,String.format(na.a.instance.sh(185),
jb)),ba(Vc,na.a.instance.ia(1811))));this.Y5i(F)&&ba(Vc,$d.zMi(F));(pc=pc.lh(231))&&ba(Vc,pc.dIf(ua,!0));1===ua.length&&ua[0].isSingle&&$d.VJk(F,ua[0])&&(ua=za.a.nh(qa.hb))&&ba(Vc,ua.YEi());F.B$b&&F.C$b&&ba(Vc,F.C$b);(ua=F.cell.Pud)&&ba(Vc,ua);this.QHh(Vc,F);F.M1a&&F.v2b&&(F=F.wce)&&(ba(Vc,na.a.instance.ia(1985)),ba(Vc,F));return Vc.toString()}Rbf(F){this.HGa=this.oN;this.oN=Object(re.a)(new Nc,{activeItemName:this.HGa.activeItemName,J0c:F?this.HGa.J0c:!1,tableName:F?this.HGa.tableName:"",Xgb:F?this.HGa.Xgb:
-1})}NIg(){this.HGa&&(this.oN=this.HGa,this.HGa=null)}cSi(F,ua){return 2===F||2===ua?na.a.instance.ia(875):1===F||1===ua?na.a.instance.ia(876):""}OHf(F){return this.NHf(F.cell,F.text)}jIh(F,ua,jb){if(jb&&1===jb.length&&jb[0].isSingle){jb="";var pc=this.Qj.bxa(ua.range);if(pc){jb=pc.pivotTableName;this.Eqd(F,jb);var Vc=pc.DGc?na.a.instance.ia(835):"";ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Vc+=(pc.altText?pc.altText+" . ":"")+(pc.altTextSummary?
pc.altTextSummary:""));this.z7e(F,!0,jb,Vc);ba(F,this.Qj.gqj(pc,ua.range)?na.a.instance.ia(838):"");ba(F,this.Qj.hij(pc,ua.range)?na.a.instance.ia(837):"")}else if(pc=this.Qj.Ay(ua.range)){jb=(Vc=ja.f(this.$).oh.Kl(ua.range))?Vc.name:"";this.Eqd(F,jb);let pd="";Vc&&(pd=(Vc.c9a?Vc.c9a+" . ":"")+(Vc.d9a?Vc.d9a:""));this.z7e(F,!1,jb,pd);ba(F,this.Qj.i_f(pc,ua.range)?na.a.instance.ia(837):"")}else this.Eqd(F,jb),this.oN.tableName="",this.oN.Xgb=-1}}Eqd(F,ua){ua!==this.oN.tableName&&this.oN.tableName&&
(F.append(na.a.instance.ia(this.oN.J0c?834:833)),ba(F," "+this.oN.tableName))}z7e(F,ua,jb,pc){jb!==this.oN.tableName&&(F.append(na.a.instance.ia(ua?832:831)),ba(F," "+jb),ba(F,pc),this.oN.tableName=jb,this.oN.J0c=ua,this.oN.Xgb=-1)}x7e(F,ua){const jb=ja.f(this.$).ha.qa.activeCell;if(jb.top!==ua.top&&jb.left!==this.oN.Xgb){F.append(na.a.instance.ia(837));ua=new Rb.Range(ua.top,jb.left,ua.top,jb.left,!0,!0);ba(F,Lb.CNd(ua));if(ua=ja.f(this.$).zh(ua))ua=ua.L5?this.OHf(ua):ua.text,ba(F,ua);this.oN.Xgb=
jb.left}}NHf(F,ua){const jb=F.ND;return F.xxa?String.format(na.a.instance.sh(14),ua,jb):String.format(na.a.instance.sh(13),ua,Lb.Epk(jb))}Hp(){L.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var F=ja.f(this.$);L.ULS.shipAssertTag(537153929,0,!!F,"Can't register to grid's events");F&&(F.Fh.Fv(this.yS),F.za.iy(this.Spa),F.hO(this.Spa),F=F.ha,L.ULS.shipAssertTag(537153928,0,!!F,"Can't register to selectionManager's events"),F&&(F.Vw(this.Jj),F.add_activeCellChanged(this.Spa),
F.$e.jO(this.Spa)))}}to(){if(this.$){var F=ja.f(this.$);F&&(F.Fh.zv(this.yS),F.za.px(this.Spa),F.VP(this.Spa),F=F.ha)&&(F.rx(this.Spa),F.remove_activeCellChanged(this.Spa),F.$e.NV(this.Spa))}}readText(F,ua){this.Wnb&&this.gridReadoutNotifier&&(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(F):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(F),ua&&this.ariaLiveNotifier.e6k(ua))}GDi(){let F;
F=null;var ua=ja.f(this.$).ha;if(1!==ua.Ck&&!ua.$e.Lh)return L.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ua.Ck} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:F};switch(ua.Ck){case 2:return{returnValue:this.VGi(ua),activeCell:F};case 64:var jb=ua.$e.Lh.floatingObject;let pc="";if(ua=ua.$e.Lh.VB||ua.$e.Lh.Uj)pc=(ua=ua.firstChild)?la.DOMElementExtensions.getTextContent(ua):"";return this.XLg?{returnValue:this.nWi(jb),activeCell:F}:
{returnValue:String.format(na.a.instance.sh(53),$d.czc(jb.altText,jb.altTextDescription,jb.name),pc,jb.altTextDescription),activeCell:F};case 4:return{returnValue:$d.ZGh(ua.$e.Lh.floatingObject),activeCell:F};case 512:return{returnValue:Ra.a.kGf(ua.$e.Lh.floatingObject.VCd),activeCell:F};case 8:return jb=ua.$e.Lh.floatingObject,{returnValue:String.format(na.a.instance.sh(51),jb?jb.name:""),activeCell:F};case 1:return F=this.activeCell,jb=ua.qa.selectedRanges,ja.f(this.$).inRangePicker?this.aUi(ua,
F):{returnValue:this.aKd(F,jb),activeCell:F}}return{returnValue:"",activeCell:F}}aUi(F,ua){F=F.rangePicker.hZ.map(pc=>pc.range);const jb=ja.f(this.$).zh(F[0]);return{returnValue:this.aKd(jb,F),activeCell:ua}}VGi(F){const ua=new Sys.StringBuilder;ua.append($d.AVh(F));const jb=this.$.la.lh(231);jb&&ba(ua,jb.dIf(F.$e.Lh.floatingObject,!1));return ua.toString()}nWi(F){var ua,jb,pc,Vc,pd,gd=null;isNullOrUndefined(null===(ua=F.Ch)||void 0===ua?void 0:ua.ShapeFillColor)||(-1===F.Ch.ShapeFillColor?gd=F.Ch.HasEffects?
"gradient":null:(gd=(null===(jb=F.Ch)||void 0===jb?0:jb.IsShapeConnector)?Ed.a.w2(F.Ch.ShapeOutlineColor):Ed.a.w2(F.Ch.ShapeFillColor),gd=Ed.a.Mu(gd.toUpperCase()),gd=Wd.a.NJa(gd)));jb=!ea.a.HWa(gd);return(ua=!ea.a.HWa(null===(pc=F.Ch)||void 0===pc?void 0:pc.ShapeText))&&jb?String.format(na.a.instance.sh(235),F.altText,F.altTextDescription,F.name,gd,null===(Vc=F.Ch)||void 0===Vc?void 0:Vc.ShapeText):!jb&&ua?String.format(na.a.instance.sh(236),F.altText,F.altTextDescription,F.name,null===(pd=F.Ch)||
void 0===pd?void 0:pd.ShapeText):!ua&&jb?String.format(na.a.instance.sh(237),F.altText,F.altTextDescription,F.name,gd):String.format(na.a.instance.sh(234),F.altText,F.altTextDescription,F.name)}Y5i(F){F=F.DXf();let ua=!1;this.oN.B2f!==F&&(this.oN.B2f=F,ua=!0);return ua}THh(F,ua){if(ua.nmb)if(ua=this.h9b.$Wi(ua)){var jb=na.a.instance,pc=jb.ia;a:switch(ua.type){case 0:var Vc=828;break a;case 1:Vc=829;break a;default:Vc=830}jb=pc.call(jb,Vc);ba(F,String.format(na.a.instance.sh(25),jb));ua=String.format(na.a.instance.sh(24),
Lb.CNd(ua.jTk));ba(F,ua)}else L.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),ba(F,String.format(na.a.instance.sh(25),""))}kIh(F,ua){switch(ua){case 1:case 11:ba(F,na.a.instance.ia(849));break;case 6:ba(F,na.a.instance.ia(849));ba(F,na.a.instance.ia(851));break;case 7:ba(F,na.a.instance.ia(849));ba(F,na.a.instance.ia(852));break;case 2:ba(F,na.a.instance.ia(850));ba(F,na.a.instance.ia(851));break;case 3:ba(F,na.a.instance.ia(850));ba(F,na.a.instance.ia(852));
break;default:ba(F,na.a.instance.ia(850))}}RHh(F,ua){var jb;const pc=qa.Qb.Aa()?za.a.nh(qa.Qb):this.$.la.lh(65);ua=pc?pc.wJa(ua.range):null;let Vc="";const pd=Object(te.a)(246,ua);if(ua)Vc=!ua.iob&&pd&&pd.Urj?String.format(na.a.instance.sh(29),pd.JXk):String.format(na.a.instance.sh(23),ua.author);else if(null===(jb=null===pc||void 0===pc?void 0:pc.Xt)||void 0===jb?0:jb.DK)Vc=String.format(na.a.instance.sh(28),pc.Xt.vV.author);ba(F,Vc)}QHh(F,ua){const jb=qa.J.Aa()?za.a.nh(qa.J):this.$.la.lh(286);jb&&
(ua=jb.KEi(be.d(this.$.ma),ua.range))&&0<ua.length&&(ua=String.format(na.a.instance.sh(1===ua.length?220:221),ua[0]),ba(F,ua))}static ZGh(F){return String.format(na.a.instance.sh(52),$d.czc(F.altText,F.altTextDescription,F.name),F.altTextDescription)}static zMi(F){return na.a.instance.ia(F.DXf()?839:840)}static czc(F,ua,jb){return F||ua?F:jb}static AVh(F){var ua=F.$e.Lh;F=ua.floatingObject;const jb=F.Ti,pc=jb.ChartTitle,Vc=F.altText,pd=F.altTextDescription,gd=!!(jb.Attributes&4);return(ua=ua.getSelectionDescription())?
ua:jb.DataRangeForDisplay?String.format(na.a.instance.sh(gd?49:47),$d.czc(Vc,pd,F.name),pd,pc,na.a.instance.ia(sf(jb.ChartCategory)),jb.DataRangeForDisplay):String.format(na.a.instance.sh(gd?50:48),$d.czc(Vc,pd,F.name),pd,pc,na.a.instance.ia(sf(jb.ChartCategory)))}static WJk(F){return ya.EwaSettings.Ra(101)&&(F.KVb||F.zGc)}static SHh(F,ua){ua.J8a?ua.KVb?ba(F,String.format(na.a.instance.sh(26),ua.J8a.topLeft.toString())):ua.zGc&&(ua=ua.J8a.jF(),ba(F,String.format(na.a.instance.sh(27),(ua.LastColumn-
ua.FirstColumn+1).toString(),(ua.LastRow-ua.FirstRow+1).toString()))):L.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static VJk(F,ua){return F.DC||!ya.EwaSettings.Ra(131)?!1:(F=za.a.nh(qa.hb))?F.XFc(ua):!1}static wsj(F){return F.top===F.bottom&&F.left+1===F.right||F.top+1===F.bottom&&F.left===F.right}};se.hml="#";se.mel=268435712;se.Omd=500;se=$d=Object(S.__decorate)([Object(za.d)(qa.Cf),
Object(S.__param)(0,Object(qa.l)()),Object(S.__param)(1,Object(qa.Nb)()),Object(S.__param)(2,Object(qa.vg)()),Object(S.__param)(3,Object(qa.pg)()),Object(S.__param)(4,Object(qa.uc)())],se);Object(C.a)(se,"SelectionReadoutHandler",null,[724,2]);var Fa=a(8),lb=a(127),d=a(37);let H=class extends lb.a{constructor(F,ua){F=void 0===F?Fa.a.vwb:F;ua=void 0===ua?Fa.a.WG:ua;super(F,ua)}execute(F){const ua=Object(te.a)(10,F.Lk);L.ULS.shipAssertTag(537153921,0,ee.a.QIb(F.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");
ua.QP(!0,!0);F.activityState[d.a.glc]=ua.ea.sessionId;F.activityState[d.a.fHb]=!0;F.activityState[d.a.mlc]=!0;L.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};H=Object(S.__decorate)([Object(za.d)(qa.Gf)],H);Object(C.a)(H,"SessionReloadActivity",lb.a,[]);var ha=a(61),Ta=a(312),Mb=a(41),W=a(45),eb=a(279),Ib=a(112);const nc=(F,ua)=>new ta(F,ua,Fa.a.WG,Fa.a.Sp,Fa.a.Nyb);Object(za.b)(qa.Hf,{Ek:"singleton"})(()=>nc(Fa.a.zqa,Fa.a.zfb));
Object(za.b)(qa.If,{Ek:"singleton"})(()=>nc(Fa.a.R6b,Fa.a.xNa));Object(za.b)(qa.Jf,{Ek:"singleton"})(()=>nc(Fa.a.S6b,Fa.a.AQc));Object(za.b)(qa.Kf,{Ek:"singleton"})(()=>nc(Fa.a.mPa,Fa.a.xW));class ta extends lb.a{constructor(F,ua,jb,pc,Vc){super(F,ua);ta.u4d=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];ta.t4d=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];ta.Zag=[-1468309555,611268539,-1750576502,61029505,-658377927];ta.Yag=[-1468309555,
-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];this.$Zc=jb;this.sRk=pc;this.n0k=Vc}execute(F){var ua=Object(te.a)(10,F.Lk);F.activityState[d.a.NFa]=!0;var jb=ta.PWi(F);if(ta.kKk(F,jb))return ta.mEj(F),jb=50,0<F.errors.length&&(jb=15),L.ULS.sendTraceTag(537153891,0,jb,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${ee.a.ei(F.errors)}`),F.activityState[d.a.NFa]=!1,this.so(Fa.a.idle),3;switch(jb){case 1:case 3:this.Mdj(F,jb);
break;case 2:this.Ldj(F);break;case 0:F.activityState[d.a.Ydb]=null}L.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${jb}. activityName:${this.activityName}. NextActivityName:${this.Aba}. TimeFromLastStatefulResponse:${ua.ea.w8}.`);var pc=Mb.a.Wm(F.activityState,Ib.a.Uyb);L.ULS.shipAssertTag(40502925,0,!pc||pc&&(1===jb||3===jb),`triggerSilentReloadAfterTokenRefresh: ${pc}, silentReloadType: ${jb}`);ua=ua.Ss.reloadCount;return 0!==jb&&0<ua?(pc=Ta.a.Glb(ua,200),
L.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${jb}] retryNum [${ua}] delayInMs [${pc}] activityName [${this.activityName}]`),Ie.a.instance.create(()=>{ta.mU(F)},pc,bf.a.gBk),1):3}Mdj(F,ua){L.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const jb=Object(te.a)(10,F.Lk);F.activityState[d.a.fHb]=!0;jb.IFc||W.a.instance.Nm("ReopenOnLoad");ta.isEditMode(F)&&ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient")&&
ta.V0a(F)||!ee.a.QIb(F.errors)||(L.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),F.activityState[d.a.glc]=jb.ea.sessionId,F.activityState[d.a.mlc]=!0);F.P4d();3===ua?(jb.ea.dm()||jb.ea.fLj(),jb.QP(!0,!0),this.so(this.n0k),F.activityState[d.a.A1e]=jb.workbookContext.CalcMode):(ya.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ua&&jb.QP(!0,!0),F.activityState[d.a.qnd]=
!1,this.so(this.$Zc))}Ldj(F){L.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");F.activityState[d.a.Ydb]=null;F.P4d();this.so(this.sRk);F=Object(te.a)(10,F.Lk);F.IFc||(W.a.instance.Nm("RefreshOnLoad"),F.d5b())}static mU(F){F.mU()}static PWi(F){const ua=Object(te.a)(10,F.Lk),jb=ua.ea,pc=ta.isEditMode(F),Vc=ta.V0a(F);var pd=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient"),gd=ee.a.ko(F.errors,pc||pd&&
Vc?ta.t4d:ta.u4d);pd=ee.a.ko(F.errors,pc||pd&&Vc?ta.Yag:ta.Zag);const Md=ua.Y0,ze=ua.Ss.reloadCount,T=ua.ua.MaxConsecutiveSilentReloadAllowed,Za=ua.Ss.cRf(),Bb=ee.a.ei(F.errors),Gc=ee.a.ei(F.XNa),qd=0<ee.a.RX(af=>!af.triggerSilentReopenOnly,F.errors).length;let Rd=gd;const je=Mb.a.Wm(F.activityState,Ib.a.Uyb);je&&(Rd=!0);const Ge={name:"SessionReloadSilentActivity.GetSilentReloadType"};Ge.editMode=pc;Ge.isSilentReopenError=gd;Ge.isSilentRefreshError=pd;Ge.reloadSequenceCount=ua.Ss.k6a;Ge.reloadCount=
ze;Ge.maxReloads=T;Ge.stopSilentReloads=Za;Ge.errorNames=Bb;Ge.processedErrorNames=Gc;Ge.isClientDirty=Md;Ge.errorsForSilentReopenOnly=qd;Ge.triggerSilentReloadAfterTokenRefresh=je;Ge.IsReopenDisabled=ua.T1a;Ge.isCollabViewMode=Vc;gd=ha.a.Ci(Ge);L.ULS.sendTraceTag(21837004,0,50,gd);if(!Za){if(Rd&&(pc||ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&Vc?ta.$Jk(F):ta.cKk(F)))return eb.a.zSg(F,ua)?3:ua.T1a?2:1;if(pd&&(pc||ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&
Vc||!jb.wub))return 2}return 0}static kKk(F,ua){for(const jb of F.errors)if(-1337545025===jb.MessageId||-238814601===jb.MessageId)return!1;return ee.a.RX(jb=>!jb.triggerSilentReopenOnly,F.errors).length?3!==ua:!1}static mEj(F){const ua=ee.a.RX(jb=>!jb.triggerSilentReopenOnly,F.errors);for(const jb of ua)F.Yoa(jb)}static isEditMode(F){const ua=Object(te.a)(10,F.Lk);return ua.ea.ki?ua.cx&&!!(ua.Ij&64):Mb.a.Wm(F.activityState,d.a.Yz)}static V0a(F){const ua=Object(te.a)(10,F.Lk);L.ULS.sendTraceTag(507618584,
0,50,`SessionReloadSilentActivity.isEditMode: isEditMode [${ua.isEditMode}] Edit Mode capabilities [${ua.Ij&64}]`);return ua.ea.ki?ua.ea.V0a:Mb.a.Wm(F.activityState,d.a.mnd)}static cKk(F){const ua=Object(te.a)(10,F.Lk);if(ee.a.Wfa(F.errors,ta.u4d).some(jb=>jb.ForceVersionUpgrade))return!1;F=ee.a.QIb(F.errors);return!ua.ea.wub||F?!0:!1}static $Jk(F){return!ee.a.Wfa(F.errors,ta.t4d).some(ua=>ua.ForceVersionUpgrade)}}ta.u4d=null;ta.t4d=null;ta.Zag=null;ta.Yag=null;Object(C.a)(ta,"SessionReloadSilentActivity",
lb.a,[]);var ob=a(555);let cc=class extends ob.a{constructor(F){super(Object(ja.f)(F))}$Wi(F){for(const ua of this.rangeList)if(F.range.contains(ua))return ua;return null}Ife(F){return F.GridBlockModel&&(F=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(F.GridBlockModel))?F.getSparklineRanges():null}};cc=Object(S.__decorate)([Object(za.d)(qa.pg),Object(S.__param)(0,Object(qa.Nb)())],cc);Object(C.a)(cc,"SparklineManager",ob.a,[723]);var qc=a(610),Wc=a(192),id=a(190);class Bd extends ad.a{constructor(F,
ua,jb,pc,Vc){super(F);this.l_g=[6];this.g_g=[26];this.oz=null;this.CWb=this.xJc=!1;this.wB=this.una=null;this.onPointerDown=pd=>{if(1!==this.$.Ma.CR())return!0;pd=this.zoomManager.il(pd);if(this.NK)return!0;var gd=Je.a(this.$).ZWd||Je.a(this.$).tv();if(this.qZd||gd)return this.pvb(),!0;this.wB=this.Bv;this.Xhe();this.IRd();gd=2===pd.Dh&&pd.Ew===Sys.UI.MouseButton.leftButton;const Md=3===pd.Dh;if(gd||Md)pd=this.ha.Uy(pd.clientPoint,pd.li,5,void 0,void 0,!0),pd||(pd=this.wB),this.CWb=gd,this.xJc=Md,
this.wB=this.jNf(pd),this.IRd(),gd?this.$hk():Md&&this.Qik(),$c.b(this.$,!0);return!0};this.Rr=pd=>{pd=this.zoomManager.il(pd);if(!this.NK)return!1;let gd=this.CWb?this.ha.Uy(pd.clientPoint,pd.li,5,void 0,void 0,!0):this.ha.Uy(pd.clientPoint,pd.li,5,!0,!1,!0);gd||(gd=this.ha.a4(pd.clientPoint,pd.li,5));gd&&(pd=this.jNf(this.mIb(gd)),this.Qoc(pd.bottomRight),this.wB.equals(pd)||(this.wB=pd,this.p4b(!1),this.Xhe(!1),this.IRd(!1),this.b8i(),this.Gh.update(!1)),this.V6k(this.wB));return!0};this.Bo=pd=>
{this.zoomManager.il(pd);if(!this.NK)return!1;this.resizeTable();this.pvb();return!0};this.E1b=pd=>{this.zoomManager.il(pd);if(!this.NK)return L.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.pvb();return!0};this.ppa=pd=>{this.zoomManager.il(pd);this.pvb();return!0};this.Qhg=()=>{this.NK&&this.pvb()};this.da=ua;this.zoom=Vc;this.$=ua.$;this.Qj=pc;this.ha=ua.ha;this.Gh=ua.Gh;this.parentElement=F;this.nQh();
da.a.Ux||da.a.b1||fb.a.instance.xa(hb.a.qj,this.una,this.onPointerDown);this.Bv=jb;this.Odd=this.qZd=!1;this.Qj.sBh(this.Qhg)}get NK(){return this.CWb||this.xJc}get p3f(){return this.Odd}dispose(){this.pvb();this.Qj.rlk(this.Qhg);this.p3f||da.a.Ux||da.a.b1||fb.a.instance.Qa(hb.a.qj,this.una,this.onPointerDown);if(this.NK){$c.b(this.$,!1);try{this.mF()}catch(F){L.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${F}`)}}this.parentElement&&
this.parentElement.contains(this.una)&&this.parentElement.removeChild(this.una);this.una=this.parentElement=null;super.dispose()}get zoomManager(){return this.zoom.zoomManager}jNf(F){const ua=F.bottom-this.Bv.topLeft.bottom-1;return 0<=F.right-this.Bv.topLeft.right+1&&0<=ua&&F.bottom>=this.Bv.top&&F.right>=this.Bv.left?new Rb.Range(this.Bv.top,this.Bv.left,F.bottom,F.right,!1,!1):this.wB}IRd(F){this.fYc([this.wB],6,void 0===F?!0:F);this.Gh.Jw(this.l_g)}p4b(F){F=void 0===F?!0:F;this.Gh.Mq(this.l_g);
this.fYc([null],6,F)}Xhe(F){F=void 0===F?!0:F;this.Gh.Mq(this.g_g);this.fYc([null],26,F)}b8i(){var F=!1;F=void 0===F?!0:F;const ua=this.vXk();0<ua.length&&(this.fYc(ua,26,F),this.Gh.Jw(this.g_g))}vXk(){const F=[];this.Bv.contains(this.wB)&&(this.Bv.right!==this.wB.right&&F.push(new Rb.Range(this.Bv.top,this.wB.right+1,this.wB.bottom,this.Bv.right,!1,!1)),this.Bv.bottom!==this.wB.bottom&&F.push(new Rb.Range(this.wB.bottom+1,this.Bv.left,this.Bv.bottom,this.Bv.right,!1,!1)));return F}resizeTable(){if(!this.wB.equals(this.Bv)){const F=
new Rb.Range(this.Bv.top,this.Bv.left,this.wB.bottom,this.wB.right,!1,!1);this.a2k(F);this.qZd=!0}}onKeyDown(F){this.zoomManager.il(F);return!0}v9d(){this.p3f&&(da.a.Ux||da.a.b1||(fb.a.instance.xa(hb.a.qj,this.una,this.onPointerDown),this.una.classList.remove("ewr-table-resize-default-cursor"),this.Odd=this.una.disabled=!1),this.Odd=!1)}nQh(){const F=document.createElement("div");F.className="ewr-table-resize-handle";const ua=document.createElement("div");ua.className="ewr-table-resize-fillhandle-higher";
const jb=document.createElement("div");jb.className="ewr-table-resize-fillhandle-broader";F.appendChild(ua);F.appendChild(jb);this.una=F;this.parentElement.appendChild(this.una)}Qoc(F){let ua=60;const jb=this.wB.contains(F);let pc=F.top,Vc=F.bottom,pd=F.left,gd=F.right,Md=null;if(jb){if(this.da.bG(this.Bv.topLeft)&&!this.Bv.D8a)return;F.bottom<this.wB.bottom?(pc=Math.max(1,Vc-2,this.Bv.top),ua=16):(pd=Math.max(1,gd-2,this.Bv.left),ua=4);Vc=pc;gd=pd;Md=new Rb.Range(pc,pd,pc,pd,!1,!1)}else F.right>=
this.Bv.right?(gd+=2,ua=8):F.bottom>=this.Bv.bottom&&(Vc+=2,ua=32),pc=Vc,pd=gd,Md=new Rb.Range(Vc,gd,Vc,gd,!1,!1),ua=16;this.da.bG(Md)||(this.oz?this.oz.St||(this.oz=Ie.a.instance.create(()=>{this.da.AC(Md,ua,"TableResizeBehavior.BringRangeIntoView")},40,bf.a.j_g)):this.oz=Ie.a.instance.create(()=>{this.da.AC(Md,ua,"TableResizeBehavior.BringRangeIntoView")},40,bf.a.j_g))}mIb(F){let ua=F;if(this.da.fh.By){if(!this.da.zh(F.topLeft)){const jb=this.da.mt("TableResizeBehavior.AdjustHiddenRowColumns",this.da.t5,
this.wB.top!==F.top?1:2);try{jb.fs=this.wB.top<F.top||this.wB.left<F.left,jb.hG(F.topLeft),ua=jb.$$cu().range}finally{jb&&jb.dispose()}}ua.right=ua.left+F.width-1;ua.bottom=ua.top+F.height-1}return ua}fYc(F,ua,jb){jb=void 0===jb?!0:jb;const pc=[];for(const Vc of F)pc.push(new De.a(Vc,be.d(this.$.ma)));this.Gh.aQ(pc,[ua],!0,void 0,jb)}$hk(){fb.a.instance.xa(hb.a.wv,document.documentElement,this.Rr);for(const F of this.da.Uu)fb.a.instance.xa(hb.a.wv,F.domElement,this.Rr);fb.a.instance.xa(hb.a.Co,document.documentElement,
this.Bo);this.Npf()}Qik(){Jb.a.instance.xa(hb.a.Jn,document.documentElement,this.Rr);for(const F of this.da.Uu)Jb.a.instance.xa(hb.a.Jn,F.domElement,this.Rr);Jb.a.instance.xa(hb.a.ml,document.documentElement,this.E1b);this.Npf()}mF(){this.CWb&&this.g5k();this.xJc&&this.q5k()}g5k(){fb.a.instance.Qa(hb.a.wv,document.documentElement,this.Rr);for(const F of this.da.Uu)fb.a.instance.Qa(hb.a.wv,F.domElement,this.Rr);fb.a.instance.Qa(hb.a.Co,document.documentElement,this.Bo);this.WBg()}q5k(){Jb.a.instance.Qa(hb.a.Jn,
document.documentElement,this.Rr);for(const F of this.da.Uu)Jb.a.instance.Qa(hb.a.Jn,F.domElement,this.Rr);Jb.a.instance.Qa(hb.a.ml,document.documentElement,this.E1b);this.WBg()}Npf(){this.da.cellTextEditBox.djb(!0)}WBg(){this.da.cellTextEditBox.djb(!1)}a2k(F){this.$.ti(-1400250766,xd.a.rh,30,{["ResizeTableRange"]:F,["OriginalTableRange"]:this.Bv})}V6k(F){if(!this.Bv.contains(F)){F=this.uXk();for(const ua of F)if(this.Qj.RZd(ua)){this.da.co.OA(X.a.sKj);return}}this.da.rtl?this.da.co.OA(X.a.uJj):this.da.co.OA(X.a.RLj)}pvb(){if(this.NK){$c.b(this.$,
!1);try{this.mF()}catch(F){L.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${F}`)}}this.oz&&(this.oz.cancel(),this.oz.dispose());this.xJc=this.CWb=!1;this.p4b();this.Xhe();$c.b(this.$,!1);this.da.co.OA(X.a.raa)}uXk(){const F=[];this.Bv.right!==this.wB.right&&F.push(new Rb.Range(this.Bv.top,this.Bv.right+1,this.wB.bottom,this.wB.right,!1,!1));this.Bv.bottom!==this.wB.bottom&&F.push(new Rb.Range(this.Bv.bottom+1,this.Bv.left,this.wB.bottom,
this.Bv.right,!1,!1));return F}static createInstance(F,ua,jb,pc,Vc){if(!ua)return null;const pd=F.Gh;pd.aQ(jb,[27],!0);pd.Jw(Bd.pXk);jb=pd.NU(27,F.fh.Lo(ua.bottomRight),Bd.XJi(ua,jb)).rl;return new Bd(jb,F,ua,pc,Vc)}static XJi(F,ua){var jb;for(let pc=0;pc<ua.length;pc++)if((null===(jb=ua[pc])||void 0===jb?0:jb.range)&&ua[pc].range.equals(F))return pc;return 0}}Bd.pXk=[27];Object(C.a)(Bd,"TableResizeBehavior",ad.a,[]);var ke=a(55),He=a(154),Tb=a(155),Xc=a(323);class Od extends hc.a{constructor(F,ua){super(document.createElement("div"));
this.Smd=this.VVd=this.Rtg=this.P0=!1;this.Mne=null;this.onActiveCellChanged=()=>{lf.d(this.$,this.da.ha.qa.activeCell)?(this.x0a=!0,this.hMb(!1)):(this.Jaa=this.x0a=!1,this.L4g())};this.Qy=()=>{this.x0a?this.hMb(!0):this.Jaa=!1};this.$Ma=()=>{this.Smd=!0;this.x0a&&(this.Jaa=!1)};this.onContentReady=()=>{this.$.isEditMode?lf.d(this.$,this.da.ha.qa.activeCell)&&(this.x0a=!0,this.hMb(!1)):this.Jaa=!1};this.ZMa=()=>{this.Smd=!1;this.x0a?this.hMb(!1):this.Jaa=!1};this.onBlockCacheItemChanged=(jb,pc)=>
{this.x0a&&(jb=this.da.R4a(pc.mj.block.vk.BlockCachePosition.PaneType).AL(pc.mj.hash))&&(jb.vje(this.BRf),jb.Bpd(this.BRf))};this.BRf=()=>{this.qGg()};this.$=F;this.zoom=ua;this.da=ja.f(this.$);this.parentElement=this.domElement;this.parentElement.className="ewa-ttrd-buttonarea";this.w_a=this.da.yn;this.iHd=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.x0a=!0;this.fcj();this.iHd&&this.F$i();this.oKh();this.hMb(!1);L.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get zoomManager(){return this.zoom.zoomManager}get Jaa(){return this.VVd}set Jaa(F){this.VVd!==
F&&(this.VVd=this.isVisible=F)}get KXb(){return!!(this.$.Ij&16)}get Wmj(){const F=this.da.ha.qa.activeCell;return F.right===F.maxColumns}get ZGb(){const F=this.da.zh(null);return F&&this.da.Yaa(F.range)?this.RJa(F):(F&&L.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.aei();this.$=this.da=this.parentElement=this.w_a=null;super.dispose()}wHi(F){const ua=this.eZi(this.da.zh(null).range);return ua?this.iHd?
`=${this.wMf()}(${F}${this.$.listSeparator}${ua})`:`=SUBTOTAL(${F},${ua})`:null}wMf(){var F,ua,jb;return null!==(jb=null===(ua=null===(F=this.Sj)||void 0===F?void 0:F.localeInfo)||void 0===ua?void 0:ua.getWorksheetFuncName(344))&&void 0!==jb?jb:"SUBTOTAL"}eZi(F){var ua=ja.f(this.$).oh.Kl(F);if(!ua)return null;ua=id.a(ua,!1);ua.right=ua.left=F.left;return ua.toString()}fcj(){Od.dU={};Od.dU["100"]=na.a.instance.ia(1105);Od.dU["101"]=na.a.instance.ia(1108);Od.dU["102"]=na.a.instance.ia(1107);Od.dU["103"]=
na.a.instance.ia(1112);Od.dU["104"]=na.a.instance.ia(1109);Od.dU["105"]=na.a.instance.ia(1110);Od.dU["109"]=na.a.instance.ia(1106);Od.dU["107"]=na.a.instance.ia(1113);Od.dU["110"]=na.a.instance.ia(1115);Od.dU["111"]=na.a.instance.ia(1166)}F$i(){void za.a.resolve(qa.E).then(F=>this.Sj=F)}c4j(){var F=this.da.zh(null);if(F&&(F=F.DC?F.formulaBarText:null))if(this.iHd){const ua="="+this.wMf()+"(",jb=ua.length;if(F.toUpperCase().startsWith(ua)){if(F=F.substring(jb,jb+3),F in Od.dU)return F}else return"111"}else if("=SUBTOTAL("===
F.substring(0,10)){if(F=F.substring(10,13),F in Od.dU)return F}else return"111";return"100"}oKh(){this.da.za.kz(this.onBlockCacheItemChanged);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.aA(this.onContentReady);this.da.cellTextEditBox.Fv(this.$Ma);this.da.cellTextEditBox.jy(this.ZMa)}aei(){this.da&&(this.da.ha&&(this.da.ha.remove_activeCellChanged(this.onActiveCellChanged),this.da.za.Vy(this.onBlockCacheItemChanged)),this.da.$E(this.onContentReady),this.da.cellTextEditBox&&(this.da.cellTextEditBox.zv(this.$Ma),
this.da.cellTextEditBox.qx(this.ZMa)),this.L4g())}hMb(F){this.j7k(F);this.KXb&&(this.VVk(),this.ZGb?(this.Rtg||this.zKh(),this.Smd?this.Jaa=!1:(this.Jaa=!0,this.qGg())):(L.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.Jaa=!1))}qGg(){appChrome.renderTableTotalRowOptions(this.parentElement,Od.dU,Od.dU[this.c4j()].toString(),Math.round(this.zoomManager.jo(17)),F=>{L.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${F}`);
const ua={["SelectedOption"]:Od.dU[F],["FunctionKeyCode"]:F,["Location"]:"canvas"};Tb.b(this.$).Aj(He.a.zXk,ua,null,!0);if("111"===F)return this.Bfj(),!0;if("100"!==F){this.Mne=this.wHi(F);if(!this.Mne)return L.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.z7a(this.Mne)}else this.z7a("");la.DOMElementExtensions.setFocus(this.da.Fh.Wa.domElement);return!0})}Bfj(){L.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const F=new Db.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ma.qh(F)}RJa(F){if(!F)return null;var ua=this.da.cellTextEditBox.Wa.domElement;var jb=0<la.DOMElementExtensions.getHeight(ua)&&0<la.DOMElementExtensions.getWidth(ua)&&0<=ua.offsetTop&&0<=ua.offsetLeft;if(jb)ua=la.DOMElementExtensions.RJa(ua,this.da.yn);else{ua=this.da.getCellBounds(F.cell);var pc=la.DOMElementExtensions.getBoundingClientRect(this.da.yn);ua=new Sys.UI.Bounds(ua.x-pc.x,ua.y-pc.y,ua.width,ua.height)}if(ua)if(jb)2<ua.height&&
2<ua.height&&(ua.x+=1,ua.y+=1,ua.height-=2,ua.width-=2);else if(jb=ja.f(this.$).KU(F.cell))jb=jb.width,pc=Va.a.equals(db.a.dRb(F.cell,this.da.rtl),"right",!0),this.da.rtl&&pc&&(ua.x=ua.x+ua.width-jb),F.Jya&&this.da.rtl===pc&&(ua.width=jb);else return null;return ua}j7k(F){var ua=this.ZGb;if(ua){var jb=17>=ua.height?ua.y:ua.y+ua.height-17-2;ua=this.Wmj?this.da.rtl?ua.x:ua.x+ua.width-(17<ua.height?17:ua.height):this.da.rtl?ua.x-(17<ua.height?17:ua.height):ua.x+ua.width;var pc=this.zoomManager.sga(new Sys.UI.Point(ua,
jb));this.parentElement.style.top=ae.HelperMethods.Ki(pc.y);this.parentElement.style.left=ae.HelperMethods.Ki(pc.x);this.zoomManager.hFk(this.parentElement);F&&(this.Jaa=this.da.NJc(new ke.a(ua,jb)))}else this.Jaa=!1}zKh(){this.w_a.insertBefore(this.parentElement,this.w_a.firstChild);this.Rtg=!0}VVk(){this.P0||(this.da.view.lz(this.Qy),this.P0=!0)}L4g(){this.P0&&this.da.view&&(this.da.view.Yx(this.Qy),this.P0=!1)}z7a(F){const ua=this.da.Fh,jb=this.da.zh(null);jb&&(F=Object(re.a)(new Xc.a,{Text:F}),
this.da.setCell(F,jb.range,0,127,null),ua.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Od.yXk="TableTotalRowDropDownIconButtonId";Od.dU=null;Object(C.a)(Od,"TableTotalRowOptions",hc.a,[2]);var ie=a(1309);let Oe=class extends ob.a{constructor(F,ua){super(ja.f(F));this.fKb=this.Mca=this.N0c=this.dKb=null;this.d7e=!1;this.qQe=null;this.Ndc=0;this.Atc=null;this.ioc=()=>{const jb={},pc=this.GNd();for(const pd in pc){const gd=pc[pd];if(!gd)continue;const Md=this.bYi(gd);if(Md){if(Md in this.MUa){var Vc=
this.MUa[Md];if(Vc.NK){Vc.Bv.equals(gd)||(Vc.Bv=gd);delete this.MUa[Md];jb[Md]=Vc;continue}}(Vc=Bd.createInstance(ja.f(this.$),gd,this.gEi(),this,this.zoom))?jb[Md]=Vc:L.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${gd.FE(!1)}`)}}this.rqc(null,null);this.mcc=jb};this.rqc=()=>{const jb=this.MUa;for(const pd in jb){var pc=pd,Vc=jb[pd];Vc&&(Vc.dispose(),delete this.MUa[pc])}this.mcc={}};this.oAg=()=>{this.rqc(null,null);this.ioc(null,null)};
this.onFocus=()=>{this.qQe=ja.f(this.$).ha.qa.activeCell};this.EA=()=>{if(this.$.isEditMode)this.onActiveCellChanged(null,null)};this.onActiveCellChanged=()=>{!this.d7e&&lf.d(this.$,this.da.ha.qa.activeCell)&&this.Oxj()};this.iJ=()=>{this.vUb(1);ya.EwaSettings.vl()||this.$.ea.yv(this.iJ)};this.I2b=()=>{this.d7e=!0;this.N0c=new Od(this.$,this.zoom)};this.$=F;this.zoom=ua;this.da=ja.f(this.$);this.mcc={};this.ioc(null,null);this.$.sa&&this.$.sa.pn(this.oAg);this.npd(this.ioc);this.$.ea.cK(this.EA);
this.da.ha.add_activeCellChanged(this.onActiveCellChanged);if(this.$.isEditMode)this.onActiveCellChanged(null,null)}npd(F){this.addHandler(ob.a.A3b,F)}kje(F){this.removeHandler(ob.a.A3b,F)}sBh(F){this.addHandler("tce",F)}rlk(F){this.removeHandler("tce",F)}get MUa(){return this.mcc}get x0d(){return this.qQe}get OXa(){return this.Ndc}get rw(){const F=ja.f(this.$);return F.oh.Kl(F.ha.qa.activeCell,!1)}get jee(){return this.x0d?ja.f(this.$).oh.Kl(this.x0d,!1):null}RZd(F){return!!this.YJf(F)}Ay(F){return this.ZTi(this.HKf(F))}MQb(F){return this.HKf(F)}Nik(F){F?
(this.fKb?this.fKb!==F&&(ra.a.dh(this.Mca),this.Mca=null,this.fKb=F):this.fKb=F,this.Mca||(this.Mca=Sf.a.instance.$k(this.fKb)),this.Mca.Uv("focusin")||this.Mca.Ba("focusin",this.onFocus)):L.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement received")}i_f(F,ua){return F?F.Bxa&&F.top===ua.top:(L.ULS.shipAssertTag(537151244,0,!!F,"autofilterRange can't be null"),!1)}bxa(F){F=this.dKb?tc.O(F,this.dKb):this.view.getRangeInformation(F);return 0<F.length&&
Object(bd.a)(ce.PivotTableRange,F[0])?F[0]:null}hij(F,ua){return F?!F.DGc&&!!F.HI&&F.HI.Xi(ua):(L.ULS.shipAssertTag(537151243,0,!!F,"Pivot table can't be null"),!1)}gqj(F,ua){return F?!F.DGc&&!!F.lL&&F.lL.Xi(ua):(L.ULS.shipAssertTag(537151242,0,!!F,"Pivot table can't be null"),!1)}Mlc(F){super.Mlc(F);if((F=ae.HelperMethods.jKf(F))&&0<F.length){this.dKb=Array(F.length);for(let ua=0;ua<F.length;ua++)this.dKb[ua]=Wc.a.SI(F[ua])}}i4b(){super.i4b();this.dKb=null}y3h(F,ua){let jb;jb=!1;if(!F||!ua)return{returnValue:!1,
e$:jb};F=F.clone();F.right+=1;F.left=F.right;if(!F.xB)return{returnValue:!1,e$:jb};if(F.top<ua.fh.Rm){const pc=F.clone();pc.bottom>=ua.fh.Rm&&(pc.bottom=ua.fh.Rm-1);if(!(()=>{let Vc=this.Ojf(pc,ua);({e$:jb}=Vc);return Vc})().returnValue)return{returnValue:!1,e$:jb}}if(F.bottom>=ua.fh.Rm){const pc=F.clone();pc.top<=ua.fh.Rm&&(pc.top=ua.fh.Rm);if(!(()=>{let Vc=this.Ojf(pc,ua);({e$:jb}=Vc);return Vc})().returnValue)return{returnValue:!1,e$:jb}}return{returnValue:!0,e$:jb}}k_g(F){(F=this.Ay(F.topLeft))&&
F.toString()in this.MUa&&(this.MUa[F.toString()].qZd=!1)}Ybk(){this.raiseEvent("tce")}Cq(F,ua){if(!this.N0c)return!1;switch(ua){case -569786022:case 541421805:if(this.N0c.Jaa){const jb=document.getElementById(Od.yXk);jb&&Ie.a.instance.create(()=>{la.DOMElementExtensions.uFc(jb,null)},0,bf.a.rXk,!0,!0)}return!0;default:return!1}}dispose(){this.rqc(null,null);this.kje(this.ioc);this.$.sa.Gn(this.oAg);this.$.Wu(this.rqc);this.mcc=null;this.$.ea&&this.$.ea.XH(this.EA);this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);
this.N0c=null;this.Mca&&(ra.a.dh(this.Mca),this.Mca=null);super.dispose()}kQf(F,ua,jb,pc){var Vc=this.da.oh.Kl(new Rb.Range(ua,jb,ua,jb,!1,!1));if(this.Atc=Vc){var pd=Vc.usedRange,gd=F.ctrlKey||da.a.isMac&&xc.b(F);Vc=!F.shiftKey&&gd;F=F.shiftKey&&!gd;ja.f(this.$).ha.selectionType=3;switch(pc){case 0:this.Ndc=0;ua=this.Izd(F,pd.top,jb,pd.bottom,jb);this.Wpe(ua,Vc,F);break;case 1:this.Ndc=1;ua=this.Izd(F,ua,pd.left,ua,pd.right);this.Wpe(ua,Vc,F);break;case 2:this.Ndc=2;ua=this.Izd(F,pd.top,pd.left,
pd.bottom,pd.right);this.Wpe(ua,Vc,F);break;default:L.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${pc.toString()}`);return}ja.f(this.$).ha.selectionType=3;L.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else L.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}xKk(F){const ua=
this.Atc.usedRange;return this.K1f(F)||1!==this.OXa&&this.K1f(new Rb.Range(ua.top,F.left,ua.bottom,F.right,!1,!1))?!0:!1}Ife(F){return F.Autofilters}Ojf(F,ua){let jb;jb=!1;const pc=ua.fh.Lo(F),Vc=ua.sl(pc).Dp;if(!Vc)return L.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${pc}`),{returnValue:!1,e$:jb};if(!Vc.Hk(F))return{returnValue:!0,e$:jb};F=ua.mt("TableManager.CouldExpandImpl",F,2);try{for(;F.$$mn();){if(F.$$cu().text||F.Du.I_a)return jb=!0,{returnValue:!1,
e$:jb};if(F.$$cu().BH)return{returnValue:!1,e$:jb}}}finally{F&&F.dispose()}return{returnValue:!0,e$:jb}}ZTi(F){if(!F)return null;const ua=new qc.AutofilterRange(F.top,F.left,F.bottom,F.right,null,null,null,F.id,F.Bxa);ua.D8a=F.D8a;const jb=this.da.oh.Kl(F,!0);if(!jb)return null;for(let pc=0,Vc=this.rangeList.length;pc<Vc;pc++){const pd=this.rangeList[pc],gd=this.da.oh.Kl(pd,!0);gd&&gd.name===jb.name&&pd!==F&&this.lpj(pd)&&(ua.union(pd),pd.D8a&&(ua.D8a=!0))}return ua}lpj(F){return!!ja.f(this.$).oh.Kl(F)}gEi(){const F=
[];for(const ua of this.rangeList){const jb=new De.a(this.Ay(ua.topLeft),be.d(this.$.ma));F.push(jb)}return F}GNd(){const F={};for(const ua of this.rangeList){if(!ua)continue;const jb=this.Ay(ua.topLeft);jb&&(F[jb.toString()]=this.Ay(ua.topLeft))}return F}Oxj(){this.$.ea.lm?this.vUb(0):ya.EwaSettings.vl()?this.$.ea.Yq(this.iJ):this.$.ea.jr(this.iJ)}vUb(F){this.$.C5(ua=>{ua.eaa(F).then(this.I2b)})}bYi(F){const ua=this.da.oh.Kl(F);return ua?ua.name:F.toString()}Wpe(F,ua,jb){F&&(jb=jb?ja.f(this.$).ha.qa.activeCell:
F.topLeft,ua?this.da.ha.updateSelection(F,jb,0,1):this.da.ha.uN([F],0,jb,0))}Izd(F,ua,jb,pc,Vc){const pd=id.d(this.Atc),gd=id.g(this.Atc),Md=ua+(1!==this.OXa&&pd?1:0),ze=pc-(1!==this.OXa&&gd?1:0),T=this.da.inRangePicker||this.da.kq;if(F){var Za=T&&!De.a.Tsc(this.da.ha.rangePicker.hZ).length?new Rb.Range(Md,jb,ze,Vc,!1,!1):T?this.da.ha.rangePicker.activeCell:this.da.ha.qa.activeCell;Za=new Rb.Range(Za.top<Md?Za.top:Md,Za.left<jb?Za.left:jb,Za.bottom>ze?Za.bottom:ze,Za.right>Vc?Za.right:Vc,!1,!1)}else Za=
new Rb.Range(Md,jb,ze,Vc,!1,!1);if(1!==this.OXa&&(pd||gd)&&(!F||F&&this.fxd(Za,Md,jb,ze,Vc))){F=T?De.a.Tsc(this.da.ha.rangePicker.hZ):this.da.ha.qa.selectedRanges;for(const Bb of F)if(this.fxd(Bb,Md,jb,ze,Vc)){Za.top=ua;Za.bottom=pc;break}}return Za}K1f(F){const ua=this.da.inRangePicker||this.da.kq?De.a.Tsc(this.da.ha.rangePicker.hZ):this.da.ha.qa.selectedRanges;for(const jb of ua)if(this.fxd(jb,F.top,F.left,F.bottom,F.right))return!0;return!1}fxd(F,ua,jb,pc,Vc){return!!F&&F.top===ua&&F.bottom===
pc&&F.left===jb&&F.right===Vc}};Oe=Object(S.__decorate)([Object(za.d)(qa.vg),Object(S.__param)(0,Object(qa.Nb)()),Object(S.__param)(1,Object(qa.ah)())],Oe);Object(C.a)(Oe,"TableManager",ob.a,[721,2]);String(ie);window.___1710439900913_closurehack=ie;var Re=a(765),hf=a(645),Af=a(1311);class ig extends Hc.a{constructor(F,ua){ua=void 0===ua?!0:ua;super(!1,!1,!0);this.ycb=null;this.RLe=!1;this.Tw=[];this.qq=null;this.vSj=jb=>{this.Bsh&&(this.qq=this.fRg(jb,this.skc))};this.H0j=()=>{this.qq&&this.qq.$O&&
(this.RLe||(this.qq.fik(this.C9d),this.RLe=!0),this.qq.jzf())};this.C9d=jb=>{this.ycb.uploadStatusLabel=jb;this.IQa(this.titleText,this.LTd,this.ycb)};this.LTd=jb=>{1===jb&&this.isEnabled()?this.qq.$O&&!this.qq.$O.value?(this.ycb.uploadStatusLabel=Object(Ga.a)("FileUploadNoFileSpecified"),this.IQa(this.titleText,this.LTd,this.ycb)):(this.vmb(),this.skc.finalizeUpload(this.qq,this.dispose)):0===jb&&this.hide()};this.Hae=()=>{this.Xxg()};this.onKeyDown=jb=>{4!==ed.FocusManager.instance().ayg(jb)&&jb.preventDefault()};
this.skc=F;this.Bsh=ua;this.qI=this.uZe=!1;this.qta=null;this.kl="InsertFileDialog";this.ri(1,this.actionButtonText);this.ycb={["id"]:this.kl,["bodyControls"]:{["uploadButtonProps"]:{["label"]:Object(Ga.a)("DialogChooseFile"),["onExecute"]:this.H0j}},["uploadStatusLabel"]:Object(Ga.a)("DialogNoFileChosen"),["onFrameReady"]:this.vSj};this.initializeAndShow(this.titleText,this.LTd,this.ycb);this.o$c=!0}get aal(){return this.skc}fHk(){this.PLe=!1;this.qq=this.fRg(document.getElementById("uploadFrameContainer"),
this.skc);xa.AFrameworkApplication.fa.ka("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.qta=this.Hae,uc.a.addHandler(this.qq.lSd,"load",this.qta));this.qq.$O||L.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.Xxg()}Xxg(){if(this.qq&&!this.PLe){var F=this.qq.$O;F&&(uc.a.addHandler(F,hb.a.Ui,this.onKeyDown),F=[F],this.Tw=F.concat.apply(F,this.Tw),this.A8k(),this.PLe=!0)}}dispose(){if(this.qq){const F=this.qq.$O;F&&uc.a.removeHandler(F,hb.a.Ui,this.onKeyDown);this.qta&&
uc.a.removeHandler(this.qq.lSd,"load",this.qta)}this.qq=null;super.dispose()}A8k(){if(0<this.Tw.length){const F=new Af.a(this.Tw),ua=ed.FocusManager.instance().F0();ua&&(this.Tw[0].focus(),ua.zo=F,ua.xha=!0)}}static cE(F){const ua=document.getElementById("errorText");ua.innerText=F;ua.style.display="inline-block"}}Object(C.a)(ig,"InsertFileDialog",Hc.a,[]);class xg{static get kp(){return Hc.a.oB(xg.sw,Object(Ga.a)("ImageUploadDialogText"),Object(Ga.a)("ImageUploadNoFileSpecified"))}}xg.sw="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(C.a)(xg,"InsertImageDialogHtml",null,[]);class jg extends ig{constructor(F,ua){super(F,void 0===ua?!0:ua)}get actionButtonText(){return Object(Ga.a)("ImageUploadButtonText")}get titleText(){return Object(Ga.a)("ImageUploadingTitle")}validate(){this.qq.$O||L.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var F=Object(te.a)(Ub,this.aal);const ua=F.D8g(this.qq.$O.value);return 0!==ua?(F=F.uGf(ua),ig.cE(F),!1):!0}}Object(C.a)(jg,"InsertImageDialog",ig,[]);var Wf=a(855),
gg=a(142),Eg=a(1522);class Og extends Eg.a{constructor(F,ua,jb,pc,Vc,pd,gd,Md){Md=void 0===Md?!1:Md;super(F,ua,jb,pc,Vc,"UploadFrame",pd.ea.sessionId,"image/*",!1,null,void 0===gd?!1:gd);this.$=pd;this.Q7g=!0;this.Ihj=Md;this.ATd()}ia(F){return F}TNg(F){L.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");ic.a.Gqd(F,this.$.ua);F.tea(Ec.a.sessionId,this.sessionId);var ua=ja.f(this.$).ha;ua=tc.q(ua.qa.daa,this.$);F.tea(Ec.a.Fyg,this.$.sa.ma.name);F.tea(Ec.a.Sak,ua.FirstRow.toString());
F.tea(Ec.a.Rak,ua.FirstColumn.toString());F.tea(Ec.a.nej,this.Ihj.toString())}qQf(){this.IIg("ServerUploadError")}E4a(F){this.IIg(F)}static okj(F){return!F||Va.a.equals(F,"ServerUploadError",!1)}}Object(C.a)(Og,"UploadFrameWrapper",Eg.a,[]);class Yg extends jg{constructor(F,ua,jb,pc){super(F,!1);this.awa=null;this.cQa=!1;this.Bi=null;this.yOc=()=>{this.Jze("");this.A2c();return!1};this.$=ua;this.V3c=F;this.T0=Wf.a.instance;this.fa=jb;this.Bi=pc;this.fHk();this.Ebj();this.$.vh.ME=!0}fRg(F,ua){return new Og(F,
Object(gg.a)(ua,ua.D4a,"onUploadFrameInitialized"),Object(gg.a)(ua,ua.yja,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.A2c();this.T0=this.V3c=null;super.dispose()}hide(){super.hide();this.$.vh.ME=!1}validate(){var F=this.V3c.Uac(this.qq.$O.value,this.V3c.S2g(this.qq));return 0!==F?(F=this.V3c.aLd(F).Description,this.Jze(F),this.yve(),!1):!0}isEnabled(){return!0}Jze(F){var ua;null===(ua=this.Bi)||void 0===ua?void 0:ua.ROg(this.awa,F)}Ebj(){this.awa=document.getElementById("errorText");
this.awa.style.display="inline-block";this.cQa=!1;this.Jze("");this.tib.style.maxWidth=this.tib.currentStyle.minWidth}yve(){this.T0.xa(hb.a.click,this.qq.$O,this.yOc);this.T0.xa(hb.a.Ui,this.qq.$O,this.yOc);this.cQa=!0}A2c(){this.cQa&&(this.T0.Qa(hb.a.click,this.qq.$O,this.yOc),this.T0.Qa(hb.a.Ui,this.qq.$O,this.yOc),this.cQa=!1)}}Object(C.a)(Yg,"InsertImageDialogWrapper",jg,[]);var uf=a(62);class Mf extends Ub{constructor(F,ua,jb,pc,Vc){Vc=void 0===Vc?!0:Vc;super(null,ua,jb);this.hwa=this.jQ=null;
this.$Ud=this.hpb=!1;this.yce=null;this.yja=pd=>{this.oCe.stop();this.coc.cancel();if(Og.okj(pd))this.x8?this.dPf(4):(pd=new Re.a(0,2,null,null,!1,null,null,null),pd.status=8,this.jye(new hf.a(pd),null,"InsertPictureWebMethod")),L.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.x8}`);else{const gd=Mf.lcl(pd);0!==gd?(L.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${pd}`),this.dPf(gd)):this.b5i(pd)}this.H1b();this.dispose()};this.ARj=pd=>{this.xra(pd,
this.qq)&&this.finalizeUpload(this.qq,null)};this.D4a=pd=>{L.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.qq=pd;if(!this.PHa){if(this.Y3c){if(this.Mcf()||this.J3a&&da.a.aJ){pd.WNb(this.ARj);return}const gd=pd.WNb(null);if(!this.xra(gd,pd))return}this.finalizeUpload(pd,null)}};this.h0j=()=>{this.x8=!0};this.th=F;this.oCe=F.Eh.em("WebServiceCall","InsertPictureOperation");this.coc=Ie.a.instance.create(this.h0j,1E5,bf.a.YLh,!1);this.x8=!1;this.vMc=this.$.ua.InsertPictureMaxFileSizeBytes;
pc&&(this.hpb="TestOnly"in pc);pc&&(this.$Ud="IsCellPicture"in pc);Vc&&this.showDialog()}get $(){return this.th}get AEj(){return this.vMc/1024/1024}dispose(){ra.a.dh(this.coc);this.qq&&this.qq.i2e();this.qq=this.coc=this.th=null}Cek(F){if(!this.$)return L.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),mb.Task.Ua(!0);if(!this.$.bha)return mb.Task.Ua(!0);const ua=new Cc.a,jb=new FileReader;F=F.$O.files[0];const pc=()=>{ua.lF(!0)};jb.onload=()=>{this.yce=jb.result;ua.lF(!0)};
jb.onerror=pc;jb.onabort=pc;jb.readAsDataURL(F);return ua.task}S2g(F){let ua=-1;F=F.$O;(null===F||void 0===F?0:F.files)&&0<F.files.length&&(ua=F.files[0].size);return ua}Uac(F,ua){let jb=Mf.W2h(Ub.xra(F));0===jb?-1!==ua&&(L.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${ua}, maxAllowedSize: ${this.vMc}, remainingWorkbookSize: ${this.$.ea.d6f}`),ua>this.vMc?jb=3:ua>this.$.ea.d6f&&(jb=7)):6===jb&&this.WBj(F);L.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${jb}`);
return jb}xra(F,ua){F=this.Uac(F,this.S2g(ua));return 0!==F?(this.PHa||1===F||this.hte(F),!1):!0}a2g(F){F.SVk()}aLd(F){let ua=0,jb=1,pc=-1100324317,Vc="InsertPictureUnknownError",pd=null;switch(F){case 1:ua=1758;jb=0;pc=940870981;Vc="InsertPictureNoFileSelected";break;case 3:jb=0;pc=1250467391;Vc="InsertPicturePictureTooBig";pd=String.format(na.a.instance.sh(181),this.AEj.toLocaleString());break;case 6:ua=1762;jb=0;pc=1380041209;Vc="InsertPictureUnsupportedFormat";break;case 7:ua=1759;jb=0;pc=-903115058;
Vc="InsertPictureExceedWorkbookSize";break;case 4:ua=1760;jb=0;pc=1218352119;Vc="InsertPictureUploadTimeout";break;case 5:ua=1761,jb=0,pc=1979899005,Vc="InsertPictureServiceNonDeterministicError"}F=Mf.nj(ua,jb,pc,Vc);pd&&(F.Description=pd);return F}showDialog(){if(this.Mcf())this.PHa=!1,this.qq=new Og(this.$.domElement,this.D4a,this.yja,this.fa,!1,this.$,!0,this.$Ud);else if(L.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.hpb&&(da.a.ZR||da.a.aJ&&72>da.a.hff))this.PHa=!1,this.qq=
new Og(this.$.domElement,this.D4a,this.yja,this.fa,!1,this.$);else{this.PHa=!0;const F=Object(rb.d)(za.a.resolve(qa.pd,{va:0}));Ab.TaskExtensions.Xa(F,()=>{this.qq=(new Yg(this,this.$,this.fa,F.result)).qq},this.$.ya,3)}}b5i(F){let ua={};try{if(ua=ha.a.Rp(F),uf.b().vI(this.oCe.id,ua.ServerCorrelationId,"actions","ServerActions"),!ee.a.jl(ua.Errors)&&ua.Result&&(this.$.ea.A8(ua.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.$Ud)){const jb=ua.Result;Sa.a(this.$).YOa(1,jb);const pc=
ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?za.a.nh(qa.Ng):this.$.la.lh(277);pc&&pc.Pnd(this.$,1,ua.Result,ua,"InsertPicture");L.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(jb){L.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${F?F.length:-1}, errror: ${jb}`)}this.W1c(ua,null,"InsertPictureWebMethod")}dPf(F){F=this.aLd(F);const ua=
{};ua.Errors=[F];this.W1c(ua,null,"InsertPictureWebMethod")}W1c(F,ua,jb){this.jQ(F,ua,jb)}jye(F,ua,jb){this.hwa(F,ua,jb)}hte(F){F=this.aLd(F);new Qe.a(this.$,F)}WBj(F){const ua=this.$.ua.InsertPicturUnsupportedExtensionsForLogging;F=ea.a.Xs(F);for(let jb=0;jb<ua.length;++jb)if(F.endsWith(ua[jb])){L.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${ua[jb]}`);break}}static lcl(F){return!F||Va.a.equals(F,Ec.a.insertPictureUnknownError,!0)?2:Va.a.equals(F,Ec.a.insertPictureNoFileSelectedError,
!0)?1:Va.a.equals(F,Ec.a.mej,!0)?3:Va.a.equals(F,Ec.a.pej,!0)?5:0}static nj(F,ua,jb,pc){return ee.a.nj(1,0,0,F,ua,jb,pc)}static W2h(F){switch(F){case 1:return 1;case 2:return 6}return 0}Mcf(){return this.hpb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(C.a)(Mf,"BasePictureUploaderWrapper",Ub,[2]);class og extends Mf{constructor(F,ua,jb,pc,Vc,pd){pd=void 0===pd?!0:pd;super(F,ua,jb,pc,!1);this.hvi=Vc;this.Mxc=F.Eh.em("LoadResource","FileReaderUploaderLoadResource");pd&&
this.showDialog()}JOk(){this.vMc=28E5;this.hte(3)}DGd(F){L.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const ua=new FileReader;F=F.$O.files;if(0==F.length)L.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var jb=F[0];ua.onload=()=>{this.Mxc.stop();this.hvi.C_j(ua.result,this);L.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${jb.type}, Size:${jb.size.toString()}`)};
ua.onerror=()=>{this.Mxc.stop();L.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${jb.type}, Size:${jb.size.toString()}`)};ua.onabort=()=>{this.Mxc.stop();L.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${jb.type}, Size:${jb.size.toString()}`)};this.Mxc.start();ua.readAsDataURL(jb)}}finalizeUpload(F,ua){this.DGd(F,ua)}}Object(C.a)(og,"FileReaderUploaderWrapper",Mf,[738]);class ih{constructor(F,
ua){this.dataUri=this.sheetName=null;this.sheetName=F;this.dataUri=ua}getSheetName(){return this.sheetName}}Object(C.a)(ih,"MacroRecorderPictureInsertedPayload",null,[146]);class tg extends Mf{constructor(F,ua,jb,pc,Vc,pd){pd=void 0===pd?!0:pd;super(F,jb,pc,Vc,!1);this.Nh=ua;pd&&this.showDialog()}DGd(F,ua){super.finalizeUpload(F,ua);wa.a(this.$.userOperationManager,(jb,pc)=>{this.jQ=jb;this.hwa=pc;this.oCe.start();this.coc.LA();this.x8=!1;this.a2g(F);return this.Cek(F)},jb=>{const pc={};this.$.dr(pc);
const Vc=pc.SheetName;jb=new xb.a(510,0,jb,72,()=>new ih(Vc,this.yce?this.yce:""));jb.vPa(()=>!0);jb.Nh=this.Nh;return jb},this.Nh)}finalizeUpload(F,ua){this.DGd(F,ua)}}Object(C.a)(tg,"PictureUploaderWrapper",Mf,[]);class Pg{constructor(F,ua){this.filename=F;this.blob=ua}}Object(C.a)(Pg,"UploadBlobParameters",null,[]);class qg extends tg{constructor(F,ua,jb,pc,Vc,pd,gd){super(F,ua,jb,pc,Vc,!1);this.Y3c=!1;this.jT=gd;this.uEc=qg.xBi(pd);F=this.Uac(this.uEc.name,this.uEc.size);0!==F?(this.hte(F),this.jT.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),
this.dispose()):this.qq=new Og(this.$.domElement,this.D4a,this.yja,pc,!1,this.$)}jye(F,ua,jb){super.jye(F,ua,jb);this.jT.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}W1c(F,ua,jb){super.W1c(F,ua,jb);ee.a.jl(F.Errors)?this.jT.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${ee.a.ei(F.Errors)}`)):this.jT.setResult(!0)}a2g(F){const ua=new Pg(this.uEc.name,this.uEc);F.bZg(ua)}static xBi(F){var ua=
F.split(",");F=ua[0].includes("base64")?window.self.atob(ua[1]):window.self.decodeURI(ua[1]);ua=ua[0].split(":")[1].split(";")[0];const jb=new Uint8Array(F.length);for(let pc=0;pc<F.length;pc++)jb[pc]=F.charCodeAt(pc);F=new Blob([jb],{type:ua});F.name="Image.png";return F}}Object(C.a)(qg,"DataUrlUploaderWrapper",tg,[]);let Na=class{constructor(){}Lcj(F,ua,jb,pc,Vc){-2060689045===ua.command&&(Vc.IsCellPicture=!0);new tg(F,ua,jb,pc,Vc,!0)}zbj(F,ua,jb,pc,Vc,pd){new qg(F,null,ua,jb,pc,Vc,pd)}Pbj(F,ua,
jb,pc,Vc){new og(F,ua,jb,pc,Vc,!0)}};Na=Object(S.__decorate)([Object(za.d)(qa.Lg)],Na);Object(C.a)(Na,"UploaderCreator",null,[722]);let Pa=class{constructor(F,ua){this.a7=()=>{this.Hj||this.V6e()};this.Hj=!1;this.z$=ua.JX;this.ariaLiveNotifier=F;this.DCe=new oa(F,ua);this.z$&&this.z$.pY?this.V6e():this.Hp()}dispose(){this.to();this.ariaLiveNotifier=this.z$=null;this.Hj=!0}Hp(){if(this.z$){this.z$.aA(this.a7);this.z$.za.iy(this.a7);this.z$.hO(this.a7);var F=Object(te.a)(157,this.z$);F&&(F.Fh.Fv(this.a7),
F.ha.Vw(this.a7),F.ha.add_activeCellChanged(this.a7),F.ha.$e.jO(this.a7))}else L.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}to(){if(this.z$){this.z$.za.px(this.a7);this.z$.VP(this.a7);const F=Object(te.a)(157,this.z$);F&&(F.Fh.zv(this.a7),F.ha.rx(this.a7),F.ha.remove_activeCellChanged(this.a7),F.ha.$e.NV(this.a7))}}V6e(){this.DCe.dBg();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.bDk();this.dispose()}};Pa=Object(S.__decorate)([Object(za.d)(qa.Vg),
Object(S.__param)(0,Object(qa.l)()),Object(S.__param)(1,Object(qa.Nb)())],Pa);Object(C.a)(Pa,"WorkbookReadoutHandler",null,[2]);var Oc=a(261);const ge="H1 H2 H3 H4 H5 H6".split(" "),Ae=["TD","TH"],Ye=["P","DIV","TABLE","TBODY","THEAD","TFOOT","ARTICLE","ADDRESS","ASIDE","BLOCKQUOTE","CAPTION","CODE","FORM","DETAILS","SUMMARY","LEGEND","FIELDSET","FOOTER","HEADER","KBD","MAIN","SECTION",...ge],Bf="SPAN A ABBR ACRONYM B STRONG I EM SUB SUP BDO BDI BUTTON CITE DATA LABEL DEL INS DFN DIALOG HGROUP MARK S TIME U V FONT".split(" "),
Pf=["UL","OL","LI","INPUT","SELECT","AREA","AUDIO","B","BASE","BR","CANVAS","COL","COLGROUP","DATALIST","DD","DETAILS","DFN","DIR","DL","DT","EMBED","FIGCAPTION","FIGURE","HR","IFRAME","IMG","LINK","MAP","MENU","MENUITEM","META","METER","NAV","NOSCRIPT","OBJECT","OPTGROUP","OPTION","OUTPUT","PICTURE","PRE","PROGRESS","Q","RP","RT","RUBY","SAMP","SMALL","SOURCE","TEMPLATE","TEXTAREA","TR","TRACK","VAR","VIDEO",...Ye,...Bf,...Ae],mg="table table;table ul;table ol;table dl;ul ul;ol ol;ol ul;ul ol;dl;img".split(";"),
Jf={"sans-serif":"Arial",gul:"Times New Roman",pnl:"Courier New",rll:"Comic Sans MS",Qll:"Algerian"},$f=/^(\d+|\d+\.\d+)(\w+)$/,Yf=/>\s+</g;let ng=class{constructor(F){this.fSd=[];this.WU=[];this.z0d=this.EKc=this.oma=this.rma=0;this.n2b=F}r4j(F,ua){this.OP={O8i:-1,hTf:-1,P8i:-1,nml:F.length,L8i:0};const jb=[];if(!ua.token.NM)try{const pc=this.Xkk(F),Vc=performance.now();this.Imb=this.n2b.Fvk(pc);if(!this.Imb)return L.ULS.sendTraceTag(507377812,0,50,"HtmlProcessor.parseHtml: htmlContent is null after sanitizeAndAppendPastedHtml call"),
Oc.a.Ua({X_a:jb,cseStatus:46,OP:this.OP});this.OP.O8i=performance.now()-Vc;F=!1;for(const ze of mg)if(this.Imb.querySelector(ze)){F=!0;break}if(F){const ze=performance.now();this.n2b.kEg();this.OP.hTf=performance.now()-ze;return Oc.a.Ua({X_a:jb,cseStatus:41,OP:this.OP})}this.t9j();this.initialize();const pd=performance.now(),gd=this.Itj(this.Imb,jb,ua);this.OP.P8i=performance.now()-pd;const Md=performance.now();this.n2b.kEg();this.OP.hTf=performance.now()-Md;return gd?(this.OP.L8i=jb.length,Oc.a.Ua({X_a:jb,
cseStatus:1,OP:this.OP})):Oc.a.Ua({X_a:jb,cseStatus:39,OP:this.OP})}catch(pc){return L.ULS.sendTraceTag(507377811,0,10,"HtmlProcessor.parseHtml: Error parsing the html",pc),Oc.a.Ua({X_a:jb,cseStatus:46,OP:this.OP})}return Oc.a.Ua({X_a:jb,cseStatus:39,OP:this.OP})}initialize(){this.z0d=this.EKc=this.oma=this.rma=0;this.LO=null;this.jUb=!1;this.WU=[]}t9j(){try{L.ULS.sendTraceTag(507377810,0,50,"HtmlProcessor.preprocessStyle: start");const F=this.Imb.getElementsByTagName("style");if(F&&0<F.length){L.ULS.sendTraceTag(507536152,
0,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let ua=0;ua<F.length;ua++)this.Imb=c(this.Imb,F[ua]),F[ua]&&(F[ua].parentNode.removeChild(F[ua]),ua--)}}catch(F){L.ULS.sendTraceTag(507377809,0,10,"HtmlProcessor.preprocessStyle: Error while converting style elements to inline style",F)}}Itj(F,ua,jb){try{const pc=F.childNodes;for(F=0;F<pc.length;F++){if(jb.token.NM)return!1;this.EPf(pc[F],ua)}return!0}catch(pc){return L.ULS.sendTraceTag(507377808,0,10,"HtmlProcessor.iterateOverChildNodesOfBody: Error while iterating over child nodes of body",
pc),!1}}Xkk(F){return F.replace(Yf,"><")}C3a(){this.rma++;this.rma>this.EKc&&(this.EKc=this.rma);this.LO=null}ydg(){this.oma++;this.oma>this.z0d&&(this.z0d=this.oma);this.LO=null}Nsc(F){const ua={borders:[],fontFamily:"",cellText:"",Lwe:0,vBf:!1,color:"",fontSize:11,italic:!1,backgroundColor:"",bold:!1,ND:"",rowIndex:this.rma,colIndex:this.oma};F.push(ua);return ua}jGc(){var F;return!(null===(F=this.LO)||void 0===F?0:F.cellText)||0===this.LO.cellText.length}ZXb(F,ua){F=F.childNodes;for(let jb=0;jb<
F.length;jb++)this.EPf(F[jb],ua)}o5i(F,ua){let jb;if(F.textContent){if(this.WU.map(pc=>pc.element.tagName).some(pc=>Ae.includes(pc))||F.nextElementSibling&&Bf.includes(F.nextElementSibling.nodeName))jb=F.textContent;else if(jb=F.textContent.trim(),!jb||0===jb.length)return;this.LO||(this.LO=this.Nsc(ua));this.LO.cellText=this.LO.cellText?`${this.LO.cellText}${jb}`:jb;F.parentElement?(ua=this.n2b.Zyf(F.parentElement))?this.LO=m(F,ua,this.LO,this.jUb,this.WU):L.ULS.sendTraceTag(507536151,0,50,"Computed style is null for parent element"):
L.ULS.sendTraceTag(507536150,0,50,"Parent element is null")}}n3i(F,ua){const jb=F.getAttribute("href");jb&&0<jb.trim().length&&(this.LO||(this.LO=this.Nsc(ua)),this.LO.ND=jb);this.FPf(F,ua)}WPd(F,ua){this.jGc()||this.C3a();this.WU.push({element:F,ZGa:F.style});this.ZXb(F,ua);this.WU.pop();this.jGc()||this.C3a()}FPf(F,ua){this.WU.push({element:F,ZGa:F.style});this.ZXb(F,ua);this.WU.pop()}j5i(F,ua){const jb=this.oma,pc=this.rma;this.jGc()||this.C3a();this.WU.push({element:F,ZGa:F.style});this.ZXb(F,
ua);this.WU.pop();this.rma=this.EKc;this.rma===pc&&this.oma>jb&&this.C3a();this.oma=jb}i5i(F,ua){const jb=this.rma;this.jUb=!0;this.WU.push({element:F,ZGa:F.style});this.ZXb(F,ua);this.WU.pop();this.jUb=!1;this.rma=jb;this.ydg()}z1i(F){this.LO||(this.LO=this.Nsc(F));this.jUb?this.LO.cellText=`${this.LO.cellText}\n`:this.C3a()}I2i(F,ua){this.WU.push({element:F,ZGa:F.style});this.fSd=[];this.WPd(F,ua);this.WU.pop()}p3i(F,ua){var jb=F.closest("ul, ol");if(jb){this.fSd.push(F);this.jGc()||this.C3a();
var pc=this.oma;if("OL"===jb.nodeName){jb=this.Nsc(ua);jb.cellText=`${this.fSd.length}`;const Vc=this.n2b.Zyf(F);Vc?m(F,Vc,jb,this.jUb,this.WU):L.ULS.sendTraceTag(507536149,0,50,"Computed style is null for list item element");this.ydg()}this.WU.push({element:F,ZGa:F.style});this.ZXb(F,ua);this.WU.pop();this.oma=pc;this.C3a()}}EPf(F,ua){switch(F.nodeName){case "#text":this.o5i(F,ua);break;case "A":this.n3i(F,ua);break;case "TR":this.j5i(F,ua);break;case "TD":case "TH":this.i5i(F,ua);break;case "BR":this.z1i(ua);
break;case "UL":case "OL":this.I2i(F,ua);break;case "LI":this.p3i(F,ua);break;case "CAPTION":F.parentElement&&"TABLE"===F.parentElement.nodeName&&this.WPd(F,ua);break;default:F.nodeType===Node.ELEMENT_NODE&&(-1<Ye.indexOf(F.nodeName)?this.WPd(F,ua):-1<Bf.indexOf(F.nodeName)&&this.FPf(F,ua))}}};ng=Object(S.__decorate)([Object(za.d)(qa.od),Object(S.__param)(0,Object(qa.Ae)())],ng);Object(C.a)(ng,"HtmlProcessor",null,[]);let eg=class{constructor(F){this.Bi=F;this.Xyd()}Fvk(F){try{L.ULS.sendTraceTag(507377807,
0,50,"PastableIframe.sanitizeAndAppendPastedHtml: start");const ua=this.Bi.xVi(F);if(this.xna.contentDocument)return this.xna.contentDocument.body.replaceWith(ua),this.xna.contentDocument.body;L.ULS.sendTraceTag(507529291,0,15,"iframe not loaded when append method was called");return ua}catch(ua){return L.ULS.sendTraceTag(507377806,0,10,"PastableIframe.sanitizeAndAppendPastedHtml: Error while sanitizing and appending html to iframe",ua),null}}kEg(){if(this.xna.contentDocument){var F=this.xna.contentDocument.body;
F?this.Bi.jM(F):L.ULS.sendTraceTag(507529290,0,15,"iframe body itself is null")}}Zyf(F){var ua;const jb=null===(ua=this.xna.contentDocument)||void 0===ua?void 0:ua.body;return(null===jb||void 0===jb?0:jb.contains(F))?getComputedStyle(F):F?F.style:null}Xyd(){const F=performance.now();this.xna=document.createElement("iframe");Object.assign(this.xna.style,{visibility:"hidden",zIndex:"-100",position:"absolute",contain:"strict"});this.xna.setAttribute("sandbox","allow-same-origin");this.xna.setAttribute("data-debug-id",
"paste-iframe");const ua=document.getElementsByTagName("body")[0];ua?ua.appendChild(this.xna):L.ULS.sendTraceTag(507529289,0,15,"Body not found");L.ULS.sendTraceTag(507529288,0,50,"Time taken to create iframe: "+(performance.now()-F))}};eg=Object(S.__decorate)([Object(za.d)(qa.Ae),Object(S.__param)(0,Object(qa.pd)())],eg);Object(C.a)(eg,"PastableIframe",null,[]);const Ig=()=>kd.a.instance.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),Ug=()=>kd.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");
var Cg=a(854),eh=a(648),Fh=a(1177),bh=a(1056),Rg;(function(F){F[F.dCj=0]="loki";F[F.Gkl=1]="augloopACLP"})(Rg||(Rg={}));Object(C.b)("AlternateAuthSupportApp",Rg);var Vg=a(602),fh=a(47);class hh{constructor(){this.Token=null;this.ExpirationTime=0}}Object(C.a)(hh,"WacAlternateAuthToken",null,[]);class Gh{constructor(F,ua){this.L_k=3E5;this.e4j=jb=>{let pc=null;({wz:pc}=fh.d(jb));return pc};if(void 0===F||null===F||void 0===ua||null===ua)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ha=F;this.xcc=new Cg.a(eh.a.zm());this.YCb=new Fh.a(F,ua);void 0!==Vg.a.C3d&&null!==Vg.a.C3d&&void 0!==Vg.a.QLc&&null!==Vg.a.QLc&&0<Vg.a.QLc&&(F=new hh,F.Token=Vg.a.C3d,F.ExpirationTime=Vg.a.QLc,this.xcc.ga("loki",F))}rEi(){let F=null;this.xcc.kh(Rg[0])&&(F=this.xcc.na(Rg[0]));return void 0===F||null===F||this.b_d(F)?this.Mui():Promise.resolve(F.Token)}b_d(F){return F.ExpirationTime-Date.now()<this.L_k}Mui(){const F=new Cg.a(eh.a.zm());F.ga("X-AlternateAuthApp",Rg[0]);return this.YCb.wXa(this.ena("/afhs/AlternateAuthHelperHandler.ashx",
this.Ha.ka("OwlOriginForAFHSIsEnabled")),this.e4j,2,F).then(ua=>{L.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Rg[0]);this.xcc.ga(Rg[0],ua);return ua.Token},ua=>{ua=Object(te.a)(bh.a,ua);L.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",ua.message,ua.httpStatusCode);return null})}ena(F,ua){F=String.format("{0}{1}?{2}",ua?this.Ha.Za("OwlOrigin"):
this.Ha.Za("WebServiceBase"),F,xa.AFrameworkApplication.Jo);ua&&(F+="&usid="+xa.AFrameworkApplication.userSessionId);return F}}Object(C.a)(Gh,"AlternateAuthHelper",null,[737]);var vh=a(1168),Hh=a(1391),Zg=a(1414),pg=a(282),$g=a(1307),Sg=a(1306),di=a(1308),Wg=a(1142);class Fg{constructor(){this.Vh=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}$n(F){this.Vh=F;xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.DemandLoadCloudPolicySettingsHelper",
!1)&&window.IsICloudPolicySettingsHelperRegistered||this.Vh.register(93,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").yi().Ei(()=>xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?Object(Sg.a)():new Hh.a(xa.AFrameworkApplication.fa,xa.AFrameworkApplication.sj));this.Vh.register(90,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").yi().Ei(()=>xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",
!1)?Object(di.a)():new Zg.a(xa.AFrameworkApplication.fa,xa.AFrameworkApplication.sj));this.Vh.register(737,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").yi().Ei(()=>new Gh(xa.AFrameworkApplication.fa,xa.AFrameworkApplication.sj));this.Vh.register(77,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").yi().Ei(()=>xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?(Ug(),Ig(),Object(Wg.a)()):new vh.a(xa.AFrameworkApplication.fa,
xa.AFrameworkApplication.sj,Ug(),Ig(),xa.AFrameworkApplication.yh))}init(){xa.AFrameworkApplication.fa.Tx(()=>{const F=kd.a.instance.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");xa.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(F.isFeatureEnabled("LicensingTestFeature",!1).then(ua=>{L.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",ua,xa.AFrameworkApplication.fa.Za("IsAnonymousUser"));
return null}),F.getFeatureTier("LicensingTestFeature",0).then(ua=>{L.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",ua,xa.AFrameworkApplication.fa.Za("IsAnonymousUser"));return null}));kd.a.instance.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.eYk()})}dispose(){}eYk(){try{xa.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&$g.a.nWg().then(F=>{L.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",F);return F})}catch(F){}}static main(){pg.a.instance.Do(new Fg)}}Object(C.a)(Fg,"ApplicationFeatureHelperPackage",null,[12,13]);var zg=a(428),Ma=a(367),Pb=a(366);const wc=F=>{F?(F.isAsyncCopy=!1,F.isSelectionAllowed=!1,F.isFromCache=!1,F.plainTextPayloadSize=0,F.shadowWorkbookPayloadSize=0,F.htmlPayloadSize=0,F.htmlSizeExceedsLimit=!1,F.clientSideCopyTime=0,F.encounteredDeploymentErrors=!1,F.shadowWorkbookSizeExceedsLimit=
!1,F.originalSourceRangesCountExceedsLimit=!1,F.copyTotalSizeExceedsLimit=!1):L.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.")},Pc=(F,ua,jb,pc,Vc)=>{const pd=F.Stopwatch,gd={};gd.a=Vc;gd.e=pd.id;gd.c="RearrangeRowColumn";gd.b="mouse";gd.d=F.OperationId.toString();gd.f=jb.toString();gd.g=pc.toString();gd.h=ua.toString();gd.i=F.DragDropIsShiftKeyDown;gd.j=!0;gd.o=pd.zi;gd.q=!1;gd.r=F.CopyPasteTargetType.toString();gd.s=F.EncounteredDeploymentErrors;
return gd};class md{constructor(F,ua){this.iBi=()=>{const jb={};jb.SourceItem=this.toString();return jb};this.sessionStateId=F;this.sessionId=ua;this.toJSON=this.iBi}EGc(F){return F?this.sessionStateId===F.sessionStateId&&this.sessionId===F.sessionId:!1}isFromCurrentSession(F){return this.sessionId===F.ua.UserSessionId}}Object(C.a)(md,"SourceItem",null,[]);class Yd extends md{constructor(F,ua,jb,pc,Vc){super(jb,pc);this.activeFloatingObjectControlId=F;this.sheetName=ua;this.type=Vc}isEqual(F){return F&&
Object.getType(F)===Yd?this.EGc(F)&&this.activeFloatingObjectControlId===F.activeFloatingObjectControlId&&this.sheetName===F.sheetName:!1}toString(){return this.type.toString()}}Object(C.a)(Yd,"ArtSourceItem",md,[]);var oe;(function(F){F[F.valid=0]="valid";F[F.notPairwiseDisjoint=1]="notPairwiseDisjoint";F[F.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";F[F.notValidForm=3]="notValidForm";F[F.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(oe||(oe={}));Object(C.b)("CopySourceValidationOptions",
oe);class ca extends md{constructor(F,ua){super(F,ua)}isEqual(F){return this.EGc(F)}}Object(C.a)(ca,"NonGridSourceItem",md,[]);class Eb extends md{constructor(F,ua,jb,pc,Vc){super(pc,Vc);L.ULS.shipAssertTag(537167645,0,!!ua&&0<ua.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=F;this.ranges=ua;this.sheetName=jb}isEqual(F){return F&&Object.getType(F)===Eb?this.EGc(F)&&tc.X(this.ranges,F.ranges)&&this.sheetName===F.sheetName:!1}toString(){return tc.j(this.ranges,",",this.$,
!1)}}Object(C.a)(Eb,"RangeSourceItem",md,[]);const Fc=F=>!!F&&Object.getType(F)===Eb,nd=F=>!!F&&Object.getType(F)===ca;class he{}he.Dal="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(C.a)(he,"ExpectedErrorNames",null,[]);var Xd=a(934);const Fe=F=>F.clipboardItems&&(F=F.clipboardItems.getItem(Xd.a.Ymj))&&"1"===F?!0:!1,jf=F=>Fe(F)&&!(void 0===F.clipboardItems||null===F.clipboardItems)&&!!F.clipboardItems.getItem(Xd.a.png)&&!F.clipboardItems.getItem(Xd.a.plainText),cf=F=>F.clipboardItems&&
(F=F.clipboardItems.getItem(Xd.a.Yhj))&&"1"===F?!0:!1,wf=F=>F&&(F=F.getCachedMetadata(),null===F||void 0===F?0:F.lastCopy)?F.lastCopy:null;class ag{constructor(F,ua,jb,pc,Vc){this.$=F;this.zoom=Vc;this.originalDestinations=ua;this.gxc=jb;this.ahh=pc;this.srh=this.originalDestinations;this.blh=this.gxc;this.Poh="PasteRecoveryUI"}get zoomManager(){return this.zoom.zoomManager}get FFh(){return this.ahh}get N6f(){return this.Poh}get ggk(){return this.srh}get nyf(){return this.blh}yJa(){return ag.c5j}TJi(){return this.gxc&&
1===this.gxc.length?this.UJi(this.gxc[0]):null}OKd(){return"PasteRecoveryUI-Floatie"}UJi(F){var ua=ja.f(this.$);const jb=ua.fh.Lo(F);var pc=ua.yl(F,jb);ua=ua.rtl;if(!pc)return null;F=ja.f(this.$).sl(jb);const Vc=F.Vr;if(!Vc.Xi(pc))return null;pc=Vc.Hk(pc);const pd=pc.topLeft.y;var gd=pc.bottomRight.y;const Md=ua?pc.bottomRight.x:pc.topLeft.x;pc=ua?pc.topLeft.x:pc.bottomRight.x;var ze=new ke.a(pc+(ua?-81:81),gd+38+6);if(Vc.dva(ze))return this.Blb(F,Vc,jb,pc,gd,ua?12:-3,66);ze=new ke.a(pc+(ua?-81:81),
gd);if(Vc.dva(ze))return this.Blb(F,Vc,jb,pc,gd,ua?20:3,22);ze=new ke.a(pc,gd+38+6);if(Vc.dva(ze))return this.Blb(F,Vc,jb,pc,gd,-81+(ua?18:0),66);pc=new ke.a(Md+(ua?81:-81),gd);if(Vc.dva(pc))return this.Blb(F,Vc,jb,Md,gd,-81+(ua?12:-6),22);gd=new ke.a(Md,pd-38-6);return Vc.dva(gd)?this.Blb(F,Vc,jb,Md,pd,ua?15:0,16):this.Blb(F,Vc,jb,ua?Vc.topLeft.x:Vc.bottomRight.x,Vc.bottomRight.y,-81+(ua?15:-6),22)}Blb(F,ua,jb,pc,Vc,pd,gd){var Md=ja.f(this.$);const ze=Md.rtl;F=Sys.UI.DomElement.getLocation(F.domElement);
pc=new Sys.UI.Point(pc+(ze?0:F.x)-ua.topLeft.x,Vc+F.y-ua.topLeft.y);ze&&(Md=Md.view.visibleArea,pc.x=Md.bottomRight.x-Md.topLeft.x-pc.x,2===jb||4===jb)&&(pc.x+=ua.bottomRight.x);pc=this.zoomManager.sga(pc);return new Sys.UI.Point(pc.x+pd,pc.y+gd)}}ag.c5j=["PasteRecoveryUI"];Object(C.a)(ag,"PasteRecoveryUI",null,[782]);var ug=a(651);class vg{}vg.Cwh="ActiveSelection";vg.shadowWorkbook="ShadowWorkbook";vg.Hch="GVML";vg.plainText="PlainText";vg.html="Html";vg.zMh="Bitmap";Object(C.a)(vg,"PayloadType",
null,[]);class ah{}ah.aSk="Slice6";Object(C.a)(ah,"SliceName",null,[]);class Hg{}Hg.tKj="NotCalled";Hg.success="Success";Hg.failed="Failed";Object(C.a)(Hg,"SucceededPopulatingSystemClipboardOptions",null,[]);var We=a(318);const Q=(F,ua)=>F?ua&&ua.ua?F.sessionId!==ua.ua.UserSessionId:(L.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(L.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),Ca=F=>{switch(F){case 0:return"None";case 2:return"Art";case 1:return"Range";
default:return"Unknown"}},ib=F=>{if(!F)return"null";const ua=[];for(const jb of F.get())ua.push(`${jb.clipboardDataFormat}(${jb.data.length})`);ua.sort();return ua.join(",")};var kc;(function(F){F[F.valid=0]="valid";F[F.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";F[F.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";F[F.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";F[F.multipleSourcesAndMultipleDestinationsAreNotSupported=
4]="multipleSourcesAndMultipleDestinationsAreNotSupported";F[F.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";F[F.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";F[F.copySourceNotValid=7]="copySourceNotValid";F[F.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";F[F.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";F[F.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";
F[F.unknown=100]="unknown"})(kc||(kc={}));Object(C.b)("PasteValidationOptions",kc);var Sc=a(243),ld=a(143),vd=a(129),Y=a(665),Ha=a(106);class Hb extends Sys.EventArgs{constructor(F,ua,jb){super();this.command=F;this.destinationRange=ua;this.sourceRange=jb}}Object(C.a)(Hb,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var Zb=a(141);class dd extends ag{constructor(F,ua,jb,pc,Vc){super(F,ua,jb,pc,Vc);this.dwj="DragRecoveryUI"}get N6f(){return this.dwj}yJa(){return dd.eii}OKd(){return"DragRecoveryUI-Floatie"}}
dd.eii=["DragRecoveryUI"];Object(C.a)(dd,"DragFillRecoveryUI",ag,[]);var Pd=a(759),de=a(429);class xe extends de.a{constructor(F,ua,jb){super(F);this.Ph=0;this.initializeAndShow(na.a.instance.ia(1060),ua,jb)}get Di(){return"CopyPasteShortcutReactDialog"}}Object(C.a)(xe,"CopyPasteShortcutReactDialog",de.a,[]);var Pe=a(430);class Ne{constructor(F){this.mK=null;this.OWa=ua=>{this.mK(1===ua?Ne.kLb:Pd.a[ua],!1);Ne.gia=!1};this.$=F}showDialog(F,ua,jb,pc){this.mK=pc;Ne.vWb=da.a.isMac||da.a.oo;this.mK||(this.mK=
()=>{});Ne.gia?pc(Ne.jLb,!1):(Ne.gia=!0,ua={},F?(ua.forwardElementText=na.a.instance.ia(1061),ua.cutText=Ne.vWb?na.a.instance.ia(1050):na.a.instance.ia(1062),ua.copyText=Ne.vWb?na.a.instance.ia(1051):na.a.instance.ia(1063),ua.pasteText=Ne.vWb?na.a.instance.ia(1052):na.a.instance.ia(1064),ua.pasteTextOnly=Ne.vWb?na.a.instance.ia(1055):na.a.instance.ia(1065)):(ua.forwardElementText=na.a.instance.ia(1066),ua.cutText=na.a.instance.ia(1067)),new xe(this.$,this.OWa,{[Pe.a.uy]:Ne.id,["bodyControls"]:ua}))}}
Ne.gia=!1;Ne.vWb=!1;Ne.jLb="notOpened";Ne.kLb="ok";Ne.id="CopyPasteShortcutDialog";Object(C.a)(Ne,"CopyPasteShortcutDialog",null,[780]);class gf extends de.a{constructor(F,ua,jb){super(F);this.Ph=0;this.ri(1,na.a.instance.ia(1054));this.Oia(1);this.initializeAndShow(na.a.instance.ia(1046),ua,jb)}get Di(){return"CopyPasteInstallReactDialog"}}Object(C.a)(gf,"CopyPasteInstallReactDialog",de.a,[]);class Lf{constructor(F){this.mK=null;this.OWa=ua=>{1===ua?(L.ULS.sendTraceTag(508359137,0,50,"User clicked the install button"),
this.L4h(),this.L7j(),this.mK(Lf.kLb,!0)):(L.ULS.sendTraceTag(508359136,0,50,"User clicked the cancel button"),this.mK(Pd.a[ua],!1));Lf.gia=!1};this.$=F}showDialog(F,ua,jb,pc){this.mK=pc=void 0===pc?()=>{}:pc;ua=da.a.isMac||da.a.oo;Lf.gia?pc(Lf.jLb,!1):(Lf.gia=!0,pc={},F&&(pc.extensionStartText=pc.extensionStartText=da.a.fIc?na.a.instance.ia(1048):na.a.instance.ia(1047),pc.extensionLink=null,pc.extensionEndText=null,pc.shortcutsMessageText=na.a.instance.ia(1049),pc.cutText=ua?na.a.instance.ia(1050):
na.a.instance.ia(1062),pc.copyText=ua?na.a.instance.ia(1051):na.a.instance.ia(1063),pc.pasteText=ua?na.a.instance.ia(1052):na.a.instance.ia(1064),pc.pasteTextOnly=ua?na.a.instance.ia(1055):na.a.instance.ia(1065)),new gf(this.$,this.OWa,{[Pe.a.uy]:Lf.id,["bodyControls"]:pc}))}L4h(){void za.a.resolve(qa.C,{va:0}).then(F=>{F.Mm(68,null)})}L7j(){const F=this.$.ua;vb.a.Cm(`${F.ChromeClipboardAccessExtensionLink}${da.a.fIc?F.ChromeClipboardAccessExtensionId:F.OfficeOnlineChromeExtensionId}`,"_blank",void 0,
"ChromeCCPInstallDialog")}}Lf.gia=!1;Lf.jLb="notOpened";Lf.kLb="ok";Lf.id="CopyPasteInstallDialog";Object(C.a)(Lf,"CopyPasteInstallDialog",null,[780]);class Uf extends Sys.EventArgs{constructor(F,ua){super();this.Tdi=F;this.So=ua}}Object(C.a)(Uf,"PasteSucceededEventArgs",Sys.EventArgs,[]);var dg=a(156);class df extends de.a{constructor(F,ua,jb){super(F);this.Ph=0;xa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?this.ri(1,CommonUiStrings.DialogOk):this.ri(1,CommonUIStrings.l_DialogOk);this.Oia(1);
this.initializeAndShow(na.a.instance.ia(2390),ua,jb)}get Di(){return"CopyPasteNoClipboardAccessReactDialog"}}Object(C.a)(df,"CopyPasteNoClipboardAccessReactDialog",de.a,[]);class Ff{constructor(F){this.mK=null;this.OWa=ua=>{1===ua?this.mK(Ff.kLb,!0):this.mK(Pd.a[ua],!1);Ff.gia=!1;this.cyd&&URL.revokeObjectURL(this.cyd)};this.$=F}showDialog(F,ua,jb,pc){this.mK=pc=void 0===pc?()=>{}:pc;ua=da.a.isMac||da.a.oo;Ff.gia?pc(Ff.jLb,!1):(Ff.gia=!0,pc={},F&&(pc.startText=na.a.instance.ia(2391),pc.endText=na.a.instance.ia(2392),
xa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?(pc.cutText=CommonUiStrings.CutString,pc.copyText=CommonUiStrings.CopyString,pc.pasteText=CommonUiStrings.PasteString,pc.cutShortcutText=ua?CommonUiStrings.CutShortcut_Mac:CommonUiStrings.CutShortcut,pc.copyShortcutText=ua?CommonUiStrings.CopyShortcut_Mac:CommonUiStrings.CopyShortcut,pc.pasteShortcutText=ua?CommonUiStrings.PasteShortcut_Mac:CommonUiStrings.PasteShortcut,pc.imageAltText=CommonUiStrings.NoClipboardAccessDialogImageAltText,pc.primaryButtonLabel=
CommonUiStrings.DialogOk):(pc.cutText=CommonUIStrings.l_CutString,pc.copyText=CommonUIStrings.l_CopyString,pc.pasteText=CommonUIStrings.l_PasteString,pc.cutShortcutText=ua?CommonUIStrings.l_CutShortcut_Mac:CommonUIStrings.l_CutShortcut,pc.copyShortcutText=ua?CommonUIStrings.l_CopyShortcut_Mac:CommonUIStrings.l_CopyShortcut,pc.pasteShortcutText=ua?CommonUIStrings.l_PasteShortcut_Mac:CommonUIStrings.l_PasteShortcut,pc.imageAltText=CommonUIStrings.l_NoClipboardAccessDialogImageAltText,pc.primaryButtonLabel=
CommonUIStrings.l_DialogOk),this.cyd=URL.createObjectURL(new Blob(['\n<svg width="440" height="114" viewBox="0 0 457 114" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_dd_2_4645)">\n<rect x="15" y="8" width="427" height="85" rx="8" fill="#F3F3F3"/>\n<g clip-path="url(#clip0_2_4645)">\n<rect x="15" y="8" width="427" height="40" fill="#CECECE"/>\n<mask id="mask0_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="15" y="40" width="427" height="12">\n<rect x="15" y="40" width="427" height="12" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask0_2_4645)">\n<g filter="url(#filter1_dd_2_4645)">\n<rect x="15" y="48" width="427" height="4" fill="#F3F3F3"/>\n</g>\n</g>\n<mask id="mask1_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="23" y="12" width="256" height="36">\n<rect x="23" y="12" width="256" height="36" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask1_2_4645)">\n<g filter="url(#filter2_dd_2_4645)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 24C31 19.5817 34.5817 16 39 16H263C267.418 16 271 19.5817 271 24V40C271 44.4183 274.582 48 279 48V52H271H31H23V48C27.4183 48 31 44.4183 31 40V24Z" fill="#F3F3F3"/>\n</g>\n</g>\n<g clip-path="url(#clip1_2_4645)">\n<path d="M251.089 28.2157L251.146 28.1464C251.32 27.9729 251.589 27.9536 251.784 28.0886L251.854 28.1464L255 31.293L258.146 28.1464C258.342 27.9512 258.658 27.9512 258.854 28.1464C259.049 28.3417 259.049 28.6583 258.854 28.8536L255.707 32L258.854 35.1464C259.027 35.32 259.046 35.5894 258.911 35.7843L258.854 35.8536C258.68 36.0271 258.411 36.0464 258.216 35.9114L258.146 35.8536L255 32.707L251.854 35.8536C251.658 36.0488 251.342 36.0488 251.146 35.8536C250.951 35.6583 250.951 35.3417 251.146 35.1464L254.293 32L251.146 28.8536C250.973 28.68 250.954 28.4106 251.089 28.2157L251.146 28.1464L251.089 28.2157Z" fill="#1A1A1A"/>\n</g>\n<g clip-path="url(#clip2_2_4645)">\n<path d="M55 28.6641V32L52.3359 33L49.6641 32L43 28.6641V25.3359C43 25.1484 43.0651 24.9896 43.1953 24.8594C43.3255 24.7292 43.4818 24.6641 43.6641 24.6641H49.6641L55 28.6641Z" fill="#21A366"/>\n<path d="M55 25.3359V28.6641H49.6641V24.6641H54.3359C54.4245 24.6641 54.5104 24.6823 54.5938 24.7188C54.6719 24.7552 54.7422 24.8047 54.8047 24.8672C54.862 24.9245 54.9089 24.9948 54.9453 25.0781C54.9818 25.1562 55 25.2422 55 25.3359Z" fill="#33C481"/>\n<path d="M55 35.3359V38.6641C55 38.8516 54.9349 39.0104 54.8047 39.1406C54.6745 39.2708 54.5182 39.3359 54.3359 39.3359H43.6641C43.4818 39.3359 43.3255 39.2708 43.1953 39.1406C43.0651 39.0104 43 38.8516 43 38.6641V35.375V32H49.6641L55 35.3359Z" fill="#185C37"/>\n<path d="M49.6641 28.6797V32H43V28.6797H49.6641ZM55 35.3359H49.6641V32.0078H55V35.3359Z" fill="black" fill-opacity="0.5"/>\n<path d="M48.2188 28C48.4375 28 48.6224 28.0755 48.7734 28.2266C48.9245 28.3776 49 28.5625 49 28.7812V36.4297C49 36.5391 48.974 36.6484 48.9219 36.7578C48.8698 36.862 48.7995 36.9583 48.7109 37.0469C48.6224 37.1302 48.5234 37.2005 48.4141 37.2578C48.2995 37.3099 48.1849 37.3359 48.0703 37.3359H43V28H48.2188Z" fill="black" fill-opacity="0.498"/>\n<path d="M47.5547 36.6641H39.7812C39.5625 36.6641 39.3776 36.5911 39.2266 36.4453C39.0755 36.2943 39 36.1094 39 35.8906V28.1094C39 27.8906 39.0755 27.7083 39.2266 27.5625C39.3776 27.4115 39.5625 27.3359 39.7812 27.3359H47.5547C47.7734 27.3359 47.9583 27.4115 48.1094 27.5625C48.2604 27.7083 48.3359 27.8906 48.3359 28.1094V35.8906C48.3359 36.1094 48.2604 36.2943 48.1094 36.4453C47.9583 36.5911 47.7734 36.6641 47.5547 36.6641Z" fill="#107C41"/>\n<path d="M41.2812 34.6641L43.0078 31.9922L41.4297 29.3359H42.7031L43.5625 31.0312C43.6042 31.1146 43.638 31.1849 43.6641 31.2422C43.6849 31.2995 43.7057 31.349 43.7266 31.3906H43.7422C43.7682 31.3281 43.7969 31.2656 43.8281 31.2031C43.8542 31.1406 43.8854 31.0781 43.9219 31.0156L44.8438 29.3359H46.0078L44.3828 31.9766L46.0469 34.6641H44.8047L43.8125 32.7969C43.7656 32.7292 43.724 32.6458 43.6875 32.5469H43.6719C43.6615 32.5781 43.6484 32.6146 43.6328 32.6562C43.612 32.6927 43.5885 32.737 43.5625 32.7891L42.5312 34.6641H41.2812Z" fill="white"/>\n</g>\n<rect x="67" y="29" width="96" height="6" rx="3" fill="#B2AFAC"/>\n<path d="M289 24.5C289 24.2239 288.776 24 288.5 24C288.224 24 288 24.2239 288 24.5V31H281.5C281.224 31 281 31.2239 281 31.5C281 31.7761 281.224 32 281.5 32H288V38.5C288 38.7761 288.224 39 288.5 39C288.776 39 289 38.7761 289 38.5V32H295.5C295.776 32 296 31.7761 296 31.5C296 31.2239 295.776 31 295.5 31H289V24.5Z" fill="#1A1A1A"/>\n</g>\n<rect x="15" y="48" width="427" height="38" fill="#F3F3F3"/>\n<rect x="15" y="86" width="427" height="1" fill="#CCCCCC"/>\n<path d="M42.159 73.3666C42.3629 73.5528 42.6792 73.5384 42.8654 73.3345C43.0515 73.1305 43.0371 72.8143 42.8332 72.6281L36.6653 66.9974H50.4961C50.7722 66.9974 50.9961 66.7735 50.9961 66.4974C50.9961 66.2212 50.7722 65.9974 50.4961 65.9974H36.6682L42.8332 60.3693C43.0371 60.1831 43.0515 59.8668 42.8654 59.6629C42.6792 59.459 42.3629 59.4446 42.159 59.6307L35.2426 65.9448C35.1027 66.0725 35.0229 66.2401 35.0031 66.4132C34.9985 66.4406 34.9961 66.4687 34.9961 66.4974C34.9961 66.5242 34.9982 66.5506 35.0023 66.5763C35.0205 66.7522 35.1006 66.9229 35.2426 67.0526L42.159 73.3666Z" fill="#1A1A1A"/>\n<g opacity="0.3">\n<path d="M87.8371 59.6307C87.6332 59.4446 87.3169 59.459 87.1307 59.6629C86.9446 59.8668 86.959 60.1831 87.1629 60.3693L93.3307 66H79.5C79.2239 66 79 66.2239 79 66.5C79 66.7761 79.2239 67 79.5 67H93.3279L87.1629 72.6281C86.959 72.8143 86.9446 73.1305 87.1307 73.3345C87.3169 73.5384 87.6332 73.5528 87.8371 73.3666L94.7535 67.0526C94.8934 66.9248 94.9732 66.7573 94.993 66.5841C94.9976 66.5568 95 66.5287 95 66.5C95 66.4731 94.9979 66.4468 94.9938 66.421C94.9756 66.2451 94.8955 66.0745 94.7535 65.9448L87.8371 59.6307Z" fill="#1A1A1A"/>\n</g>\n<path d="M124.066 66.05C124.59 62.2198 128.121 59.5401 131.951 60.0648C133.894 60.3309 135.54 61.3695 136.623 62.8297L136.749 63H133.5C133.224 63 133 63.2239 133 63.5C133 63.7761 133.224 64 133.5 64H137.5C137.776 64 138 63.7761 138 63.5V59.5C138 59.2239 137.776 59 137.5 59C137.224 59 137 59.2239 137 59.5V61.7073C135.776 60.3185 134.065 59.3451 132.087 59.074C127.709 58.4744 123.675 61.5369 123.075 65.9143C122.475 70.2917 125.538 74.3264 129.915 74.926C134.293 75.5256 138.327 72.4631 138.927 68.0857C139.001 67.5445 139.019 67.0079 138.986 66.4821C138.968 66.2065 138.73 65.9974 138.455 66.015C138.179 66.0326 137.97 66.2703 137.988 66.5459C138.017 67.0055 138.001 67.4752 137.936 67.95C137.412 71.7802 133.881 74.4599 130.051 73.9353C126.221 73.4106 123.541 69.8802 124.066 66.05Z" fill="#1A1A1A"/>\n<g filter="url(#filter3_d_2_4645)">\n<rect x="159" y="52" width="275" height="30" rx="8" fill="#FBFBFB"/>\n</g>\n<rect x="171" y="55" width="27" height="24" rx="4" fill="#F3F2F1"/>\n<path d="M190.051 65.3663V73H178.527V65.3663H180.686V62.1832C180.686 61.7458 180.782 61.3333 180.973 60.9457C181.159 60.558 181.415 60.2201 181.741 59.9318C182.067 59.6436 182.45 59.4175 182.888 59.2535C183.327 59.0845 183.794 59 184.289 59C184.784 59 185.251 59.0845 185.689 59.2535C186.128 59.4175 186.51 59.6436 186.837 59.9318C187.163 60.2201 187.422 60.558 187.613 60.9457C187.798 61.3333 187.891 61.7458 187.891 62.1832V65.3663H190.051ZM181.412 65.3663H187.166V62.1832C187.166 61.8353 187.09 61.5073 186.938 61.1991C186.786 60.886 186.581 60.6152 186.322 60.3866C186.063 60.158 185.76 59.9766 185.411 59.8424C185.057 59.7082 184.683 59.6411 184.289 59.6411C183.889 59.6411 183.515 59.7082 183.167 59.8424C182.818 59.9766 182.514 60.158 182.256 60.3866C181.997 60.6152 181.792 60.886 181.64 61.1991C181.488 61.5073 181.412 61.8353 181.412 62.1832V65.3663ZM189.325 66H179.252V72.3589H189.325V66Z" fill="black"/>\n</g>\n<defs>\n<filter id="filter0_dd_2_4645" x="0.6" y="4.76837e-07" width="455.8" height="113.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="6.4"/>\n<feGaussianBlur stdDeviation="7.2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1.2"/>\n<feGaussianBlur stdDeviation="1.8"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter1_dd_2_4645" x="7.8" y="44" width="441.4" height="18.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter2_dd_2_4645" x="15.8" y="12" width="270.4" height="50.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter3_d_2_4645" x="155" y="50" width="283" height="38" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="2"/>\n<feGaussianBlur stdDeviation="2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_4645" result="shape"/>\n</filter>\n<clipPath id="clip0_2_4645">\n<path d="M15 16C15 11.5817 18.5817 8 23 8H434C438.418 8 442 11.5817 442 16V48H15V16Z" fill="white"/>\n</clipPath>\n<clipPath id="clip1_2_4645">\n<rect width="12" height="12" fill="white" transform="translate(249 26)"/>\n</clipPath>\n<clipPath id="clip2_2_4645">\n<rect width="16" height="16" fill="white" transform="translate(39 24)"/>\n</clipPath>\n</defs>\n</svg>\n'],
{type:"image/svg+xml"})),pc.imageSrc=this.cyd,pc.learnMoreLink=null),new df(this.$,this.OWa,{[Pe.a.uy]:Ff.id,["bodyControls"]:pc}))}}Ff.gia=!1;Ff.jLb="notOpened";Ff.kLb="ok";Ff.id="CopyPasteNoClipboardAccessDialog";Object(C.a)(Ff,"CopyPasteNoClipboardAccesslDialog",null,[780]);var Vf=a(200),Xf=a(72),Ag=a(66),ch;(function(F){F[F.source=0]="source";F[F.destination=1]="destination"})(ch||(ch={}));Object(C.b)("RangeType",ch);class vf extends pb.a{constructor(F,ua,jb,pc,Vc,pd,gd,Md,ze,T,Za,Bb){Bb=void 0===
Bb?null:Bb;super();this.l0g=this.m0g=this.etb=this.hOb=null;this.Sob=!1;this.j2a=ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StickyFormattingEnabled",!1);this.aqf=()=>{var Gc;(null===(Gc=this.hOb)||void 0===Gc?0:Gc.S1f())&&!tc.X(ja.f(this.$).ha.qa.selectedRanges,this.hOb.BKc)&&(this.hOb.Hva(),this.hOb=null);this.da.ha.rx(this.aqf)};this.t$d=Gc=>{this.nKk(Gc)&&(this.hA.vRd(),L.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.xBj=(Gc,qd)=>{L.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Gc}]. userPressedExtensionLink=${qd}`);this.da.focus()};this.xAj=(Gc,qd)=>{L.ULS.sendTraceTag(508130372,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got No Clipboard Access Dialog, user pressed [${Gc}]. userPressedOK=${qd}`);this.da.focus()};this.Dj=(Gc,qd)=>{qd.i1||qd.dm||this.Ix("OnWorkbookOpened",!1).catch(()=>{})};this.vq=(Gc,qd)=>
{Gc=wf(this.SK);const Rd=this.hA.DBc(Gc);Rd&&(qd.ma&&qd.ma.sheetName===Rd.sheetName&&Rd.isFromCurrentSession(this.$)?this.hA.ASf(Rd.ranges,Gc.commandParameters.commandType):this.hA.vRd())};this.aPc=(Gc,qd)=>{Gc=wf(this.SK);(Gc=this.hA.DBc(Gc))&&qd.item&&qd.item.sheetName===Gc.sheetName&&Gc.isFromCurrentSession(this.$)&&this.Ix("OnItemDeleting",!1).catch(()=>{})};this.Z6=()=>{this.m0g()};this.UY=()=>{this.l0g()};this.D1=(Gc,qd)=>{1===qd.ox&&qd.Ul.operation.flags&2&&this.Ix("OnQueueItemChanged/ItemRemoved",
!1).catch(()=>{})};this.$=F;this.zoom=ze;this.xqh=Za;this.xk=jb;this.da=ja.f(F);this.hA=Vc;this.$dj=pd;this.SK=ua;this.qXa=pc;this.iTf=T;this.getStringifiedError=Bb||copyPasteInfra.getStringifiedError;this.JTg=1===Md;this.Hp();gd||(L.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),gd=vf.Dci);this.userHash=ea.a.rE(gd);this.aGj="CultureTag: "+na.a.instance.auc+" HASH: ";this.SK.addMetadataChangeListener(vf.Scg,this.t$d);this.eFj=this.$.ua.CCPPastePlainTextLimit;
this.TZb=this.$.ua.CCPCopyPasteHtmlLimit;void za.a.rj(qa.Ce).then(Gc=>{this.etb=Gc});this.m0g=Sc.b(()=>{this.s_j()},1,this.$.ya,"CopyPasteInfrastructure.OnStartEditInternal",!0);this.l0g=Sc.b(()=>{this.gRj()},1,this.$.ya,"CopyPasteInfrastructure.onEndEditInternal",!0)}get Uuj(){return this.Koh}XHa(){var F=wf(this.SK);return F?(F=F.sourceItem)&&!F.isFromCurrentSession(this.$)?(L.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return qa.Be.Aa()?this.xqh:this.$.la.lh(373)}ODh(F){this.addHandler(vf.yae,F)}qnk(F){this.removeHandler(vf.yae,F)}umc(F){this.addHandler(vf.N5c,F)}xnk(F){this.removeHandler(vf.N5c,F)}copy(F){F.stopwatch=this.$.Eh.Li("UserAction",uf.b().zp(F.ribbonCommandInfo.command)+"ClientSide");void za.a.resolve(qa.Ce).then(pd=>{this.etb=pd});const ua=!!wf(this.SK);ug.a.D0a&&(this.Sob=!1);this.Ix("Copy/before/"+Ma.a[F.ribbonCommandInfo.method],!1,void 0,!0,F.copyPasteTargetType).catch(()=>
{});var jb=-1985798686===F.ribbonCommandInfo.command;if(1===this.da.Ck&&(jb=this.hA.$Xf(this.da.ha.qa.selectedRanges,jb),0!==jb)){const pd=vf.g2h(jb);this.ONa(pd,oe[jb],!1);return Promise.reject(!1)}F.userHash=this.userHash;F.id=Mc.a.create().toString();const pc=this,Vc=this;return this.qXa.onCopy(F).then(pd=>{var gd;pd.isAsyncCopy||F.stopwatch.stop();pc.pasteIndicationManager.zCd();var Md=We.d(F);L.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${Md}`);
pc.jzj(pd,ua);Md=1===F.copyPasteTargetType;!F.isFormatPainter&&Md&&(pc.etb?pc.etb.Nki():L.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));ya.EwaSettings.Xaa()&&Fc(pd.sourceItem)&&1===pd.sourceItem.ranges.length&&(pd=pd.sourceItem.ranges[0],Md=this.da.za.Uwa(pd,this.$.activeItemName),pd=null===Md||void 0===Md?void 0:Md.qB(pd),this.Koh=null===(gd=null===pd||void 0===pd?void 0:pd.formattedText)||void 0===gd?void 0:gd.Text);return Promise.resolve(!0)},pd=>{let gd=!1,Md="none",
ze=vf.hib,T=!0,Za=-1,Bb=vf.copyErrorName+vf.tIa,Gc=!1,qd=null;if(pd){qd=pd.copyContext;Za=pd.reason;Bb+=vf.JJa(pd);pd.message&&(ze=pd.message);var Rd=vf.f2h(pd);if(Rd)if(3===Rd.copyErrorName)gd=!0,ze=Md="Async Copy canceled by the user.",T=!1;else if(ee.a.Gx(Rd.ewaErrors))if(ze=Vc.qAc(Rd.ewaErrors),ee.a.ko(Rd.ewaErrors,vf.operationSucceededWithAlert))Gc=gd=!0;else if(ee.a.ko(Rd.ewaErrors,vf.pasteDataLimitHit)||ee.a.ko(Rd.ewaErrors,vf.copyThrottlingError))gd=!0;13===pd.reason?(gd=!0,T=!1):11===pd.reason&&
(T=!1)}Rd=pd?Vc.getStringifiedError(pd):"null";gd?(Rd=We.d(F),L.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${T}, Friendly message: ${Md}, Error Message: ${ze}, CommandParameters: ${Rd}`)):L.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${T}, Error Message: ${Rd}, CommandParameters: ${We.d(F)}`);T&&Vc.Ix("Copy/fail/"+Ma.a[F.ribbonCommandInfo.method],
!0,void 0,void 0,F.copyPasteTargetType).catch(()=>{});Vc.E8f(F,gd,ze,Bb,Za,Gc,qd);return Promise.reject(pd)})}writeToClipboard(F){F.stopwatch=this.$.Eh.Li("UserAction",uf.b().zp(F.ribbonCommandInfo.command)+"ClientSide");this.Ix("Copy/before/"+Ma.a[F.ribbonCommandInfo.method],!1,void 0,!0,F.copyPasteTargetType).catch(()=>{});F.userHash=this.userHash;F.id=Mc.a.create().toString();return this.qXa.onCopy(F).then(()=>{F.stopwatch.stop();return Promise.resolve(!0)},ua=>{let jb=vf.hib,pc=-1,Vc=vf.copyErrorName+
vf.tIa,pd=null;ua&&(pd=ua.copyContext,pc=ua.reason,Vc+=vf.JJa(ua),ua.message&&(jb=ua.message));const gd=We.d(F);L.ULS.sendTraceTag(508074081,0,15,`CopyPasteInfrastructure.writeToClipboard: Copy operation failed with an error. Error Message: ${jb}, CommandParameters: ${gd}`);this.E8f(F,!1,jb,Vc,pc,!1,pd);return Promise.reject(ua)})}w5j(F){if(this.XHa())return rb.a(this.JTd(F.commandType,F.ribbonCommandInfo));const ua=tc.d(this.da.ha.qa.selectedRanges);F.originalDestinations=ua;F.expandDestinations=
this.vpc(F.originalDestinations,F.commandType);if(this.Gpc(F.commandType,F.expandDestinations)||this.Ncf())F.userHash=this.userHash,F.id=Mc.a.create().toString(),this.qXa.onPaste(F).then(()=>Promise.resolve(!0),jb=>Promise.reject(jb));return Promise.resolve(!0)}t5j(F){const ua=We.b();ua.ribbonCommandInfo=F;ua.userHash=this.userHash;ua.id=Mc.a.create().toString();ua.isKeyboardEvent=!1;ua.copyPasteTargetType=this.ULa();ua.skipSystemClipboardAccess=!1;ua.stopwatch=this.$.Eh.Li("UserAction",uf.b().zp(ua.ribbonCommandInfo.command)+
"ClientSide");this.Ix("CopyPasteInfrastructure.performFullSheetCopy",!1).catch(jb=>Promise.reject(jb));return this.qXa.onCopy(ua).then(()=>{const jb=We.d(ua);L.ULS.sendTraceTag(507818122,0,50,`CopyPasteInfrastructure.performFullSheetCopy: Operation finished successfully. ${jb}`);return Promise.resolve(!0)},jb=>Promise.reject(jb))}u5j(F,ua){if(this.XHa())return Promise.resolve(null);const jb=We.c();jb.ribbonCommandInfo=F;jb.id=Mc.a.create().toString();jb.clearStateOnFinish=!1;jb.isKeyboardEvent=this.Znb(F,
ua);jb.skipClipboardAccess=Vf.d(ua,X.a.skipClipboardAccess);jb.copyPasteTargetType=this.ULa();jb.skipSystemClipboardAccess=!1;return this.qXa.onPaste(jb).then(pc=>pc).catch(pc=>Promise.reject(pc))}fHc(){var F;return null===(F=wf(this.SK))||void 0===F?void 0:F.isFullSheetCopy}pIi(){var F;return null===(F=wf(this.SK))||void 0===F?void 0:F.sourceItem.sheetName}hkg(F,ua){if(F.method){var jb=new dd(this.$,tc.d(this.da.ha.qa.selectedRanges),tc.d(this.da.ha.qa.selectedRanges),{},this.zoom);(pc=>{const Vc=
Object(rb.d)(za.a.resolve(qa.lf,{va:0}));Ab.TaskExtensions.Xa(Vc,()=>{F.method&&pc(Vc.result)},this.ya,8)})(pc=>{pc.Csd(jb);pc.wte(F.method,ua);this.hOb=pc});L.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.da.ha.Vw(this.aqf)}}paste(F){F.stopwatch=this.$.Eh.Li("UserAction",uf.b().zp(F.ribbonCommandInfo.command)+"ClientSide");ug.a.D0a&&(L.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.Sob=
!1);ja.f(this.$).Gk&&ja.f(this.$).Gk.gQ(this.cNd(F.ribbonCommandInfo.command),F.stopwatch.id);if(F.isPasteCommandFromRecoveryUI){var ua=za.a.nh(qa.lf);var jb=tc.d(ua.BKc);if(!jb)return L.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);ua=ua.y0d;F.pasteRecoveryCachedClipboardItems=ua?ua[vf.qug]:null}else jb=tc.d(this.da.ha.qa.selectedRanges);F.originalDestinations=jb;F.expandDestinations=this.vpc(F.originalDestinations,F.commandType);
if(this.Gpc(F.commandType,F.expandDestinations)||this.Ncf())return F.userHash=this.userHash,F.id=Mc.a.create().toString(),Xg(this.$)&&(F.isAsyncSystemClipboardEnabled=!0),this.qXa.onPaste(F).then(pc=>this.CPc(pc,F),pc=>this.e1b(F,pc));this.$.ti(927125067,xd.a.rh,30,null);jb=tc.j(F.expandDestinations,",",this.$,!1);L.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${jb}, CommandType: ${F.commandType}, copyPasteTargetType="${F.copyPasteTargetType}"`);
return Promise.resolve(!0)}cNd(F){switch(F){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}Ncf(){return!!ja.f(this.$).ha.$e.activeFloatingObjectControlId&&this.$.qy(null,!1,470)}ULa(){const F=wf(this.SK);return F&&F.commandParameters?F.commandParameters.copyPasteTargetType:0}Xmj(){return!!wf(this.SK)&&Q(wf(this.SK),this.$)}Ix(F,ua,jb,pc,Vc){jb=void 0===jb?!1:jb;pc=void 0===pc?!1:pc;Vc=void 0===Vc?0:Vc;try{this.etb&&this.etb.Ouc();
let pd=Vc;const gd=this.Vuj();if(!pc&&2===gd)return L.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${ua}', isExplicit = '${jb}', isForce = '${pc}', Current CCP operation copyPasteTargetType = '${Vc}', LastCopyPasteTargetType = '${gd}'`),Promise.reject(null);0===pd&&(pd=gd);const Md=this.$.Eh.Li("UserAction","ClearCopyState"),ze=Md.id;L.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${ua}', isExplicit = '${jb}', isForce = '${pc}', Current CCP operation copyPasteTargetType = '${Vc}', LastCopyPasteTargetType = '${gd}'`);
this.hA.vRd();this.fdk();return this.qXa.onCancelCopy(ua).then(()=>{ua&&ug.a.D0a&&(this.Sob=!1);Md.stop();this.D8f(F,ze,!0,jb,ua,"","",Md.zi,pd);return Promise.resolve(!0)},T=>{var Za=T?this.getStringifiedError(T):"null";L.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Za}`);Md.stop();Za=vf.WTh+vf.tIa;let Bb=vf.hib;T&&(Za+=vf.JJa(T),T.message&&(Bb=T.message));this.D8f(F,ze,!1,jb,ua,Bb,Za,Md.zi,pd);return Promise.reject(T)})}catch(pd){return Promise.reject(null)}}Vvd(F,
ua,jb,pc){var Vc=void 0;Vc=void 0===Vc?!1:Vc;jb=void 0===jb?!1:jb;pc=void 0===pc?0:pc;return jb||this.XHa()?this.Ix(F,ua,Vc,jb,pc):(L.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}ONa(F,ua,jb){L.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${ua}`);
const pc=new Ha.a;pc.ga("reason",ua);Y.a(ld.a.discontinuousSelectionBlocking,[jb?vd.a.V4j:vd.a.k3h],!0,!0,!1,!1,pc);F=ee.a.nj(1,1,751,F,0,371863010,"DiscontinuousSelectionBlocking");new Qe.a(this.$,F)}Vuj(){const F=wf(this.SK);return F&&F.sourceItem&&Object.getType(F.sourceItem)!==ca?Object.getType(F.sourceItem)===Yd?2:1:0}dii(F,ua,jb,pc,Vc){Vc=void 0===Vc?!1:Vc;F.stopwatch=this.$.Eh.Li("UserAction","DragDropReplaceClientSide");F.isDragDrop=!0;this.Vvd("DragDropReplace/before/"+Ma.a[F.ribbonCommandInfo.method],
!1,void 0,F.copyPasteTargetType).catch(()=>{});const pd=Vc?2:1;let gd=0;gd=Vc?4:pc?256:128;const Md={encounteredDeploymentErrors:!1};Md.commandParameters=F;F.isDragInsert=!1;F.userHash=this.userHash;F.id=Mc.a.create().toString();return this.hA.pasteRange(F.ribbonCommandInfo,tc.s(ua,this.$),tc.s(jb,this.$),pd,gd,[F.stopwatch],Md,!1,()=>{L.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${F.copyPasteTargetType}"`);this.K8f(F,pd,ua,jb,Md)},
ze=>this.vjg(ze,F,pd,ua,jb,Md)).then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},ze=>Promise.reject(ze))}cii(F,ua,jb,pc,Vc){Vc=void 0===Vc?!1:Vc;F.stopwatch=this.$.Eh.Li("UserAction","DragDropInsertClientSide");this.Vvd("DragDropInsert/before/"+Ma.a[F.ribbonCommandInfo.method],!1,void 0,F.copyPasteTargetType).catch(()=>{});const pd=Vc?2:1,gd=tc.R(this.vpc([jb],pd));var Md=this.$.ea.ma.sheetName;const ze=this.$.ea.ma.sheetName,T=tc.x(ua,this.$);T.SheetName=Md;Md=tc.x(gd,this.$);Md.SheetName=
ze;pc=gd.isRow||ua.isRow||pc?1:0;const Za={encounteredDeploymentErrors:!1};F.isDragInsert=!0;Za.commandParameters=F;F.userHash=this.userHash;F.id=Mc.a.create().toString();Vc=this.hA.gii(Za,T,Md,Vc,pc,F.ribbonCommandInfo,()=>{L.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${F.copyPasteTargetType}"`);this.K8f(F,pd,ua,jb,Za)},Bb=>{this.vjg(Bb,F,pd,ua,jb,Za)});return rb.d(Vc.then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},
Bb=>Promise.reject(Bb))).kB(()=>!0)}JTd(F,ua,jb,pc,Vc,pd){var gd=wf(this.SK);if(!gd)return L.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),mb.Task.Ua(!1);if(!Fc(gd.sourceItem))return L.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),mb.Task.Ua(!1);var Md=gd.sourceItem;if(!Md)return L.ULS.shipAssertTag(537167810,0,!!Md,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),mb.Task.Ua(!1);if(1<
Md.ranges.length)return L.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.ONa(2192,"InsertCopiedCutCells",!0),mb.Task.Ua(!1);gd=tc.R(Md.ranges);var ze=this.da.ha.qa.jj.clone();F=tc.R(this.vpc([ze],F));const T=this.Y5f();Md=Md.sheetName;ze=this.$.ea.ma.sheetName;const Za=tc.x(gd,this.$);Za.SheetName=Md;const Bb=tc.x(F,this.$);Bb.SheetName=ze;Md=this.da.ha.qa.activeRange;const Gc=()=>{L.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},
qd=()=>{L.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(F.qk||gd.qk||this.hA.lMk(this.$,gd,Md)?mb.Task.Ua(0):F.isRow||gd.isRow||this.hA.mMk(this.$,gd,Md)?mb.Task.Ua(1):this.$dj.ysc(this.$,ja.f(this.$).rtl)).kB(Rd=>this.XHa()?this.hA.executeInsertCopiedCutCellsOperation(Za,Bb,T,Rd.result,ua,null,null):this.hA.executeInsertCopiedCutCellsAcrossSession(Za,Bb,T,Rd.result,ua,Gc,qd,jb,pc,Vc,pd)).continueWith(()=>{this.Ix("InsertCopiedCutCells/success/"+Ma.a[ua.method],
!0)})}qWb(){const F=wf(this.SK),ua=this.da.ha.qa.Bn;return!!F&&Fc(F.sourceItem)&&ua&&1===F.sourceItem.ranges.length}Y5f(){return this.Z5f(-911352779)}c2a(){var F,ua;const jb=wf(this.SK);return jb?(null===(F=jb.asyncClipboardItemsKeys)||void 0===F?void 0:F.includes(Xd.a.shadowWorkbook))||(null===(ua=jb.syncClipboardItemsKeys)||void 0===ua?void 0:ua.includes(Xd.a.shadowWorkbook))||3!==jb.copyStatus:!1}AKc(){return this.Z5f(-1985798686)}Gpc(F,ua){var jb=new Gd.a(this.$.sa),pc=36===F;const Vc=jb.Wj(4);
F=2===this.ULa()&&jb.Wj(1);pc=pc&&Vc;jb=!jb.wn||!this.AKc()||!Gd.a.kvc(ua,ja.f(this.$));return pc||F||this.$.qy(ua,!0)&&jb}Znb(F,ua){return this.hA.Znb(F,ua)}dispose(){super.dispose();this.to();this.SK.removeMetadataChangeListener(vf.Scg)}nCd(F,ua,jb,pc,Vc){if(!this.UXh(F.commandParameters.ribbonCommandInfo.command))return F.cseStatus=2,!1;if(pc.width%ua.width||pc.height%ua.height)return F.cseStatus=16,!1;if(pc.qk||pc.isRow)return F.cseStatus=31,!1;const pd=pc.Hk(this.da.Dp);if(!pd)return F.cseStatus=
7,!1;var gd=this.Z$e(this.da,F.commandParameters.ribbonCommandInfo.command,ua);if(0!==gd)return F.cseStatus=gd,!1;gd=this.Z$e(this.da,F.commandParameters.ribbonCommandInfo.command,pd);if(0!==gd)return F.cseStatus=gd,!1;gd=tc.x(ua,this.$);gd.SheetName=jb;jb=this.xk.$4j(this.da,gd,tc.x(pd,this.$),F.commandParameters.ribbonCommandInfo.command,F.commandParameters.stopwatch);1===jb&&(Vc&&(ua.Xi(pc)?(pc=tc.fb(ua,F.commandParameters.expandDestinations[0]),this.xk.Ovd(pc,!1,F.commandParameters.id),this.xk.Ovd(pc,
!0,F.commandParameters.id)):(this.xk.Bqc(ua,!1),this.xk.Bqc(ua,!0))),ua=new Hb(F.commandParameters.ribbonCommandInfo.command,pd,ua),ja.f(this.$).zfe(ua),this.pasteIndicationManager.tmb(F.commandParameters.id,!0),this.bwb(F.commandParameters.expandDestinations,F.commandParameters.isPasteCommandFromRecoveryUI),this.Fqc("DoPasteClientEstimation/"+Ma.a[F.commandParameters.ribbonCommandInfo.method],F));F.cseStatus=jb;return 1===jb}Z$e(F,ua,jb){F=new Zb.a("CopyPasteInfrastructure.blockCseForPaste",F,jb);
try{for(;F.moveNext();){const pc=F.get_current().cell;if(pc.$F)return 8;if(237279923===ua||1804571062===ua){if(!ya.EwaSettings.GLa()&&pc.oF)return 18;if(pc.LR)return 19}}}catch(pc){Xf.a.ro(pc,"CopyPasteInfrastructure.BlockCseForPasteRange: exception thrown before CSE")}finally{F&&F.dispose()}return 0}Ovg(){Xg(this.$)?(new Ff(this.$)).showDialog(!0,!1,!1,this.xAj):(da.a.Vv||da.a.fIc||da.a.LXf?new Lf(this.$):new Ne(this.$)).showDialog(!0,!1,!1,this.xBj)}cBj(F,ua,jb,pc){F=Pc(F,ua,jb,pc,this.$.ua.UserSessionId);
F.k=!0;uf.b().Ll(45,F,!0)}jYj(F,ua,jb,pc,Vc){var pd=!1,gd=!1,Md=vf.hib,ze=vf.urf+vf.tIa;F&&(ze+=vf.JJa(F),ee.a.Gx(F.ewaErrors)?(Md=this.qAc(F.ewaErrors),ee.a.ko(F.ewaErrors,[-103190598,1512686094])&&(pd=!0)):F.message&&(Md=F.message));gd||(gd=this.kWd(F));ua=Pc(ua,jb,pc,Vc,this.$.ua.UserSessionId);ua.k=!1;ua.l=gd;ua.n=Md;ua.p=ze;ua.q=pd;uf.b().Ll(45,ua,!0);return Promise.reject(F)}Krd(F,ua,jb,pc){let Vc;if(!this.iTf)return F.cseStatus=40,Oc.a.Ua(!1);const pd=this.jkj(F.commandParameters.ribbonCommandInfo.command,
jb,this.da);if(0!==pd)return F.cseStatus=pd,Oc.a.Ua(!1);Ab.TaskExtensions.ts(Oc.a.delay(0),()=>{Vc=this.iTf.r4j(ua,pc).result;return Oc.a.Ua(!0)},pc.token).continueWith(()=>{L.ULS.sendTraceTag(507582610,0,50,`CopyPasteInfrastructure.AttemptExternalHtmlPasteClientEstimation: pasteId=${F.id}, result=${JSON.stringify(null===Vc||void 0===Vc?void 0:Vc.OP)}`);if(1!==(null===Vc||void 0===Vc?void 0:Vc.cseStatus))return F.cseStatus=Vc?Vc.cseStatus:46,Oc.a.Ua(!1);if(pc.token.NM)return F.cseStatus=39,Oc.a.Ua(!1);
var gd=jb.topLeft?this.M6h(jb.topLeft,Vc.X_a):jb;F.commandParameters.expandDestinations=[gd];if(!ja.h(this.da,gd))return F.cseStatus=7,Oc.a.Ua(!1);F.cseStatus=this.xk.X4j(this.da,Vc.X_a,jb.topLeft,pc,F.commandParameters.stopwatch);return 1===F.cseStatus?(gd=new Hb(F.commandParameters.ribbonCommandInfo.command,jb,null),ja.f(this.$).Gk.gT(F.commandParameters.stopwatch.id,Ag.BasicTelemetryCalculator.TR),ja.f(this.$).zfe(gd),this.pasteIndicationManager.tmb(F.commandParameters.id,!0),this.bwb(F.commandParameters.expandDestinations,
F.commandParameters.isPasteCommandFromRecoveryUI),this.Fqc("AttemptExternalHtmlPasteClientEstimation/"+Ma.a[F.commandParameters.ribbonCommandInfo.method],F),Oc.a.Ua(!0)):Oc.a.Ua(!1)});return Oc.a.Ua(!1)}LKh(F,ua,jb){F.cseStatus=0;F.cseStatus=this.lkj(F.commandParameters.ribbonCommandInfo.command,jb,this.da,ua);if(0!==F.cseStatus)return!1;F.cseStatus=this.xk.a5j(this.da,ua,jb,F.commandParameters.stopwatch);ua=new Hb(F.commandParameters.ribbonCommandInfo.command,jb,null);1===F.cseStatus&&(ja.f(this.$).zfe(ua),
this.pasteIndicationManager.tmb(F.commandParameters.id,!0),this.bwb(F.commandParameters.expandDestinations,F.commandParameters.isPasteCommandFromRecoveryUI),this.Fqc("AttemptExternalPlainTextPasteClientEstimation/"+Ma.a[F.commandParameters.ribbonCommandInfo.method],F));return 1===F.cseStatus}jkj(F,ua,jb){return 237279923!==F?2:jb.oh.pob(ua)?8:jb.oh.vY(ua)?11:this.xk.vvc(ua)?12:0}M6h(F,ua){return new Rb.Range(F.top,F.left,F.top+Math.max(...ua.map(jb=>jb.rowIndex)),F.left+Math.max(...ua.map(jb=>jb.colIndex)),
!0,!0)}lkj(F,ua,jb,pc){if(-875588320!==F&&-185374993!==F&&237279923!==F)return 2;if(jb.oh.pob(ua))return 8;if(!ya.EwaSettings.GLa()&&jb.oh.ytj(ua))return 18;if(jb.oh.vY(ua))return 11;if(this.xk.vvc(ua))return 12;F=this.aSh(ua,pc);return ja.h(this.da,F)?0:7}aSh(F,ua){var jb=ua.indexOf("\r");jb=-1!==jb?"\n"===ua[jb+1]?ua.split("\r\n"):ua.split("\r"):ua.split("\n");ua=jb.length;jb=jb[0].split("\t").length;return new Rb.Range(F.top,F.left,F.top+ua-1,F.left+jb-1,!0,!0)}UXh(F){switch(F){case 237279923:case 808159687:case -185374993:case 1804571062:case -875588320:return!0;
default:return!1}}Z5f(F){const ua=wf(this.SK);return ua?ua.commandParameters.ribbonCommandInfo.command===F:!1}nKk(F){return F&&F.lastCopy?Q(F.lastCopy,this.$):!0}hGf(F,ua,jb,pc,Vc){const pd={};pd.a=this.$.ua.UserSessionId;pd.e=F.stopwatch.id;pd.c=uf.b().zp(F.ribbonCommandInfo.command);pd.b=Ma.a[F.ribbonCommandInfo.method];pd.d=F.id;pd.f=jb.toString();pd.g=pc.toString();pd.h=ua.toString();pd.o=F.stopwatch.zi;pd.q=!1;pd.r=F.copyPasteTargetType.toString();pd.s=Vc.encounteredDeploymentErrors;pd.i=Vc.commandParameters.dragDropIsShiftKeyDown;
pd.j=Vc.commandParameters.isDragInsert;ya.EwaSettings.HC()&&(pd.t=Vc.commandParameters.isHeaderDrag);return pd}K8f(F,ua,jb,pc,Vc){F=this.hGf(F,ua,jb,pc,Vc);F.k=!0;uf.b().Ll(45,F,!0)}rzj(F,ua,jb,pc,Vc,pd,gd,Md,ze){F=this.hGf(F,ua,jb,pc,ze);F.k=!1;F.l=Vc;F.n=pd;F.p=gd;F.q=Md;uf.b().Ll(45,F,!0)}D8f(F,ua,jb,pc,Vc,pd,gd,Md,ze){const T={};T.a=this.$.ua.UserSessionId;T.b=ua;T.c=F;T.f=jb;T.e=pc;T.d=Vc;T.g=pd;T.h=gd;T.i=Md;T.j=ze.toString();uf.b().Ll(46,T,!0)}jzj(F,ua){F=this.CFf(F.commandParameters,F);F.l=
!0;F.j=ua;uf.b().Ll(43,F,!0)}E8f(F,ua,jb,pc,Vc,pd,gd){F=this.CFf(F,gd);F.l=!1;F.m=ua;F.o=jb;F.y=pc;F.x=Vc;F.z=pd;uf.b().Ll(43,F,!0);L.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${F.y},ErrorReason=${F.x},IsExpectedError=${F.m},IsSucceededWithAlert=${F.z},ErrorMessage=${F.o}`)}CFf(F,ua){const jb={};jb.a=this.$.ua.UserSessionId;jb.f=F.stopwatch.id;jb.g=F.id;jb.c=uf.b().zp(F.ribbonCommandInfo.command);jb.b=Ma.a[F.ribbonCommandInfo.method];jb.q=F.stopwatch.zi;
jb.bd=vf.wzc();jb.bg=F.copyPasteHandlerName;jb.bj=void 0===F.ribbonCommandInfo.ik||null===F.ribbonCommandInfo.ik?null:Pb.a[F.ribbonCommandInfo.ik];jb.bq=F.uploadToClipService;jb.br=F.floatingObjectType;jb.s=F.copyPasteTargetType.toString();jb.bc=Ca(F.copyPasteTargetType);jb.z=!1;if(ua){jb.bk=ua.id;jb.bl=ua.serverRequestTimeInMs;ua.requestTelemetryData&&(jb.bm=ua.requestTelemetryData.EcsOperationDuration,jb.bn=ua.requestTelemetryData.EcsRequestDuration,jb.bo=ua.requestTelemetryData.WfeRequestDuration);
jb.d=ua.sourceItem?ua.sourceItem.toString():null;jb.e=-1;if(Fc(ua.sourceItem)){jb.e=0;F=ua.sourceItem.ranges;for(const pc of F)jb.e+=pc.qz}jb.h=ua.isAsyncCopy;jb.i=ua.isFromCache;jb.k=ua.isSelectionAllowed;jb.r=ua.plainTextPayloadSize;jb.u=ua.htmlPayloadSize;jb.v=ua.htmlSizeExceedsLimit;jb.w=ua.copyTotalSizeExceedsLimit;jb.t=ua.shadowWorkbookPayloadSize;jb.p=ua.clientSideCopyTime;jb.ba=ua.encounteredDeploymentErrors;jb.bb=ua.shadowWorkbookSizeExceedsLimit;jb.be=ua.syncClipboardItemsKeys;jb.bf=ua.asyncClipboardItemsKeys;
jb.bh=this.tjf(ua.succeededPopulatingSystemClipboardSync);jb.bi=this.tjf(ua.succeededPopulatingSystemClipboardAsync);Xg(this.$)&&(jb.bs=ua.commandParameters.isAsyncClipboardAPI)}return jb}bwb(F,ua){ua=void 0===ua?!1:ua;if(!this.da.isEditing&&!this.da.kq){var jb=this.da.ha.qa,pc=!ua&&1===F.length&&tc.X(F,jb.selectedRanges),Vc=pc?jb.activeCell:F[0].topLeft;F[0].contains(Vc)||(L.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${jb.selectedRanges}, IndexOfActiveRange ${jb.Fy}, ActiveCell ${jb.activeCell}, calculatedDestinationRanges ${F}, keepThePreviousActiveCell ${pc}, newActiveCell ${Vc}, isPasteCommandFromRecoveryUI ${ua}`),
Vc=F[0].topLeft);this.da.ha.uN(F,0,Vc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}cKf(F,ua){const jb={};jb.a=this.$.ua.UserSessionId;jb.g=F.stopwatch.id;jb.t=F.stopwatch.zi;jb.bz=!1;ua&&(jb.bv=ua.id,jb.bw=ua.serverRequestTimeInMs,jb.n=ua.commandParameters.clipboardFormatReadTimes,jb.o=ua.commandParameters.clipboardFormatReadStatus,jb.q=ua.commandParameters.asyncApiReadTimedOut,ua.requestTelemetryData&&(jb.cb=ua.requestTelemetryData.EcsOperationDuration,jb.cc=ua.requestTelemetryData.EcsRequestDuration,
jb.cd=ua.requestTelemetryData.WfeRequestDuration));jb.x=F.copyPasteTargetType.toString();jb.bl=Ca(F.copyPasteTargetType);jb.br=F.copyPasteHandlerName;jb.i=(null===ua||void 0===ua?0:ua.isHtmlPaste)?tc.j(tc.h(ua.pastedRange.Ranges),",",this.$,!1):tc.j(F.expandDestinations,",",this.$,!1);jb.h=tc.j(F.originalDestinations,",",this.$,!1);jb.e=F.id;jb.d=F.commandType;jb.c=uf.b().zp(F.ribbonCommandInfo.command);jb.b=Ma.a[F.ribbonCommandInfo.method];jb.bf=!1;jb.bg=!1;jb.bp=vf.wzc();jb.bt=void 0===F.ribbonCommandInfo.ik||
null===F.ribbonCommandInfo.ik?null:Pb.a[F.ribbonCommandInfo.ik];jb.cj=F.isPasteCommandFromEnterShortcut;if(jb.ca=F.isPasteCommandFromRecoveryUI)jb.cf=F.pasteRecoveryUndoStopwatch.id,jb.cg=F.pasteRecoveryUndoStopwatch.zi;if(ua){if((F=ua.copyContextSnapshot)&&!ua.wasLastCopyExternal){jb.f=F.commandParameters.id;jb.j=F.sourceItem.toString();jb.k=-1;if(Fc(F.sourceItem)){jb.k=0;const pc=F.sourceItem.ranges;for(const Vc of pc)jb.k+=Vc.qz}jb.bg=1===F.commandParameters.commandType}else ua.clipboardItems?
jb.f=ua.clipboardItems.getItem(Xd.a.hsc):L.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");jb.bz=ua.pasteRecoveryUIDisplayed;jb.ci=ua.cseStatus}else L.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return jb}GAj(F,ua,jb,pc,Vc,pd,gd,Md,ze){var T,Za;F=this.cKf(F,Md);F.l=!1;F.m=ua;F.s=jb;F.bc=pc;F.be=Vc;F.bd=pd;F.bf=gd;if(Md){F.y=Fe(Md)||!Md.copyContextSnapshot;F.bi=!F.y&&Q(Md.copyContextSnapshot,
this.$);F.bj=Md.shadowWorkbookSizeExceedsLimit;F.v=Md.shadowWorkbookPayloadSize;F.w=Md.htmlPayloadSize;F.bq=ib(Md.clipboardItems);F.bb=Md.activeSelectionType;F.bs=Md.isSameSession;F.bn=Md.payloadOrigin;F.bo=Md.payloadType;F.bu=Md.externalAppSource;F.bx=Md.indicationDisplayScheduled;F.by=Md.pasteIndicationDisplayStatus;F.ck=Md.pasteDestinationHasMergedCells;if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",
!1))F.cl=Md.ArtSourceItemType;Xg(this.$)&&(F.cm=null===(T=Md.commandParameters)||void 0===T?void 0:T.isAsyncClipboardAPI);ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(F.cn=null===(Za=Md.commandParameters)||void 0===Za?void 0:Za.isChromiumExtension)}else F.bi=Q(ze,this.$);uf.b().Ll(44,F,!0);L.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${F.be},ErrorReason=${F.bd},IsExpectedError=${F.m},IsSucceededWithAlert=${F.bf},ErrorMessage=${F.s}`)}IAj(F){var ua,
jb;const pc=this.cKf(F.commandParameters,F);pc.y=F.wasLastCopyExternal;pc.l=!0;pc.u=F.plainTextPayloadSize;pc.v=F.shadowWorkbookPayloadSize;pc.w=F.htmlPayloadSize;pc.z=F.isClipboardDataContainShadowWorkbook;pc.ba=F.isShadowWorkbookParsedSuccessfully;pc.bb=F.activeSelectionType;pc.bc=F.pasteResult;pc.bh=F.encounteredDeploymentErrors;pc.bj=F.shadowWorkbookSizeExceedsLimit;pc.bk=cf(F);pc.bq=ib(F.clipboardItems);pc.bs=F.isSameSession;pc.bn=F.payloadOrigin;pc.bo=F.payloadType;pc.bu=F.externalAppSource;
pc.bx=F.indicationDisplayScheduled;pc.by=F.pasteIndicationDisplayStatus;pc.ck=F.pasteDestinationHasMergedCells;pc.bm=F.clipboardItems?F.clipboardItems.getItem(Xd.a.IWh):null;pc.bi=!F.isSameSession&&!F.wasLastCopyExternal;pc.ci=F.cseStatus;if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))pc.cl=F.ArtSourceItemType;Xg(this.$)&&(pc.cm=null===(ua=F.commandParameters)||
void 0===ua?void 0:ua.isAsyncClipboardAPI);ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(pc.cn=null===(jb=F.commandParameters)||void 0===jb?void 0:jb.isChromiumExtension);uf.b().Ll(44,pc,!0)}Hp(){this.$.sa.pn(this.vq);this.$.sa.SCh(this.aPc);this.$.userOperationManager.kw(this.D1);this.$.kr(this.Dj);ja.f(this.$).Fh.Fv(this.Z6);ja.f(this.$).Fh.bU(this.UY)}to(){this.$&&this.$.sa&&(this.$.sa.Gn(this.vq),this.$.sa.Gmk(this.aPc));this.$&&this.$.userOperationManager&&
this.$.userOperationManager.su(this.D1);this.da&&this.da.Fh&&(this.da.Fh.zv(this.Z6),this.da.Fh.mZ(this.UY))}e1b(F,ua){var jb=null;let pc=!1;var Vc=null;let pd="UnknownFailure",gd=-1,Md=vf.hib,ze=vf.pasteErrorName+vf.tIa,T=!1;this.pasteIndicationManager.tmb(F.id,!1);this.pasteDestinationHasMergedCells(F.expandDestinations)&&(ua.pasteContext.pasteDestinationHasMergedCells=!0);const Za=wf(this.SK);(F.clearStateOnFinish||F.clearSystemClipboard)&&this.Ix("Paste/fail/"+Ma.a[F.ribbonCommandInfo.method],
!0,void 0,void 0,F.copyPasteTargetType).catch(()=>{});if(ua){gd=ua.reason;ze+=vf.JJa(ua);ua.message&&(Md=ua.message);if(jb=vf.w2h(ua))if(1===jb.pasteErrorName)pc=!0,pd="CopyPasteLengthTooLongPopup",Md=Vc="The pasted content is too long. Popup a dialog to the user.",L.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${F.copyPasteTargetType}"`),jb=ee.a.nj(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),new Qe.a(this.$,jb);else if(7===jb.pasteErrorName)pc=
!0,pd="No-Op",Md=Vc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",L.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${F.copyPasteTargetType}"`);else if(8===jb.pasteErrorName)pc=!0,pd="UseShortcutsPopup",Md=Vc="Unable to paste content from the system clipboard. Popup dialog to the user.",L.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${F.copyPasteTargetType}"`),
this.Ovg();else if(18===jb.pasteErrorName){pc=!0;pd="PasteExternalNotSupportMultipleSelectionPopup";Md="Paste external not support multiple selection.";Vc="Unknown";var Bb=2192;100!==jb.validationFailureReason&&(Vc=kc[jb.validationFailureReason],Bb=vf.jjf(jb.validationFailureReason));this.ONa(Bb,Vc,!0)}else 20===jb.pasteErrorName||19===jb.pasteErrorName?(pc=!0,20===jb.pasteErrorName?(pd="PasteAcrossSessionNotSupportMultipleSelectionPopup",Md="Paste across session does not support multiple selection."):
(pd="PasteInSameSessionNotSupportMultipleSelectionPopup",Md="This kind of multiple selection is not supported for same session paste."),Vc="Unknown",Bb=2192,100!==jb.validationFailureReason&&(Vc=kc[jb.validationFailureReason],Bb=vf.jjf(jb.validationFailureReason)),jb=6===jb.validationFailureReason,this.Gpc(F.commandType,F.expandDestinations)&&jb&&this.bwb(F.expandDestinations),this.ONa(Bb,Vc,!0)):6===jb.pasteErrorName?(pc=!0,pd="No-Op",Md=Vc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
L.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${F.copyPasteTargetType}"`)):17===jb.pasteErrorName?(pc=!0,pd="No-Op",Md=Vc="Paste text on Art is not yet a supported operation",L.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${F.copyPasteTargetType}"`)):16===jb.pasteErrorName?(pc=!0,pd="No-Op",Md=Vc="Paste has failed because the previous copy has failed",jb=this.getStringifiedError(jb),L.ULS.sendTraceTag(537167771,
0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${F.copyPasteTargetType}", error=${jb}`)):ee.a.Gx(jb.ewaErrors)?(ee.a.Cea(jb.ewaErrors)||ee.a.ko(jb.ewaErrors,ee.a.yCc())?(pc=!0,pd="CommunicationError",Vc=ee.a.ei(jb.ewaErrors),L.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Md} copyPasteTargetType="${F.copyPasteTargetType}"`)):ee.a.ko(jb.ewaErrors,vf.xwk)?(pc=!0,pd="SavingWorkbookError",Vc=ee.a.ei(jb.ewaErrors),L.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Md} copyPasteTargetType="${F.copyPasteTargetType}"`)):
ee.a.ko(jb.ewaErrors,vf.operationSucceededWithAlert)&&(T=pc=!0,pd="OperationSucceededWithAlert",Vc=ee.a.ei(jb.ewaErrors),L.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Md} copyPasteTargetType="${F.copyPasteTargetType}"`)),pc||(Md=this.qAc(jb.ewaErrors),pc=this.kWd(ua))):11===jb.pasteErrorName&&(pc=!0,pd="No-Op",Md="Paste has failed because user try copy cross-session oart object");15===ua.reason&&(pc=!0,pd="No-Op",Md="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Va.a.equals(ze,he.Dal,!1)&&(pc=!0,pd="No-Op",Md="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}pc||(jb=ua?this.getStringifiedError(ua):"null",L.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${jb}, copyPasteTargetType="${F.copyPasteTargetType}"`));this.GAj(F,pc,Md,pd,ze,gd,T,ua.pasteContext,Za);return Promise.reject(ua)}CPc(F,ua){var jb;L.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${ua.copyPasteTargetType}"`);
this.pasteIndicationManager.tmb(ua.id,!0);if(this.f5j(ua.copyPasteTargetType,F)){ug.a.D0a&&F.wasLastCopyExternal&&F.payloadType===vg.shadowWorkbook&&(this.Sob=!0);let pc=null;(null===(jb=F.pastedRange)||void 0===jb?0:jb.Ranges)&&0<F.pastedRange.Ranges.length?pc=tc.h(F.pastedRange.Ranges):F.wasLastCopyExternal||(pc=ua.expandDestinations);this.Dyk(F,pc);if(this.LMk(F,pc)){jb=tc.d(ua.originalDestinations);const Vc=1028===ua.commandType?tc.d(ua.expandDestinations):tc.d(pc);let pd=null;F.wasLastCopyExternal&&
(ua.isKeyboardEvent||ua.isPasteCommandFromRecoveryUI)&&(pd={[vf.qug]:F.clipboardItems});this.pasteDestinationHasMergedCells(ua.expandDestinations)&&(F.pasteDestinationHasMergedCells=!0);F.pasteRecoveryUIDisplayed=!0;const gd=new ag(this.$,jb,Vc,pd,this.zoom),Md=Object(rb.d)(za.a.resolve(qa.lf,{va:0}));264209770===ua.ribbonCommandInfo.command?this.da.za.hNa(()=>{Ab.TaskExtensions.Xa(Md,()=>{const ze=Md.result;ze.Csd(gd);ze.wte(ua.ribbonCommandInfo.method)},this.ya,8)}):Ab.TaskExtensions.Xa(Md,()=>
{const ze=Md.result;ze.Csd(gd);ze.wte(ua.ribbonCommandInfo.method,ua.event)},this.ya,8)}this.fQj(F,pc)}this.Fqc("Paste/success/"+Ma.a[ua.ribbonCommandInfo.method],F);this.IAj(F);this.JTg&&(!ua.isKeyboardEvent||cf(F))&&this.$.ea.Vn.get(66)&&(L.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.JTg=!1,this.k4h());F=new Uf(ua.expandDestinations,F.commandParameters.ribbonCommandInfo.command);this.Lck(F);return Promise.resolve(!0)}fQj(F,
ua){qa.xg.Aa()?void za.a.resolve(qa.xg,{va:1}).then(jb=>{jb.k2g(F,ua)}):Ab.TaskExtensions.Xa(Xb.GetServiceTaskFactory.Tj(this.$.la,534,535,1),jb=>{jb.result.k2g(F,ua)},this.$.ya,3)}LMk(F,ua){return!ua||1!==ua.length||F.commandParameters.clearSystemClipboard||F.commandParameters.clearStateOnFinish||F.commandParameters.skipClipboardAccess?!1:Fe(F)&&(ua=F.clipboardItems.getItem(Xd.a.plainText),F=F.clipboardItems.getItem(Xd.a.html),void 0===ua||null===ua||ua.length>this.eFj||void 0===F||null===F||F.length>
this.TZb)?(L.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}f5j(F,ua){return 1===F||ua.payloadType===vg.plainText||ua.payloadType===vg.html||ug.a.D0a&&ua.payloadType===vg.shadowWorkbook}pasteDestinationHasMergedCells(F){const ua=ja.f(this.$).za.nA();if(!ua||!ua.length)return!1;for(const jb of ua)if(jb.GD(F[0]))return!0;return!1}Fqc(F,ua){let jb;(()=>{let pc=this.Vhj(ua);({KWa:jb}=pc);return pc})().returnValue&&
this.Ix(F,jb,void 0,void 0,ua.commandParameters.copyPasteTargetType).catch(()=>{})}vjg(F,ua,jb,pc,Vc,pd){const gd=F?this.getStringifiedError(F):"null";let Md=!1,ze=!1,T=!1,Za=vf.hib,Bb=vf.urf+vf.tIa;F&&(Bb+=vf.JJa(F),ee.a.Gx(F.ewaErrors)?(Za=this.qAc(F.ewaErrors),ee.a.ko(F.ewaErrors,vf.operationSucceededWithAlert)&&(Md=!0),ee.a.ko(F.ewaErrors,vf.dragDropNonEmptyRange)&&(ze=T=!0)):F.message&&(Za=F.message));T||(T=this.kWd(F));ze?this.da.ha.selectionType=-1:this.hA.ngk(Vc);T||L.ULS.sendTraceTag(24150918,
0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${gd}, copyPasteTargetType="${ua.copyPasteTargetType}`);this.rzj(ua,jb,pc,Vc,T,Za,Bb,Md,pd)}vpc(F,ua){let jb=F;const pc=this.SOi();if(null===pc||void 0===pc?0:pc.ranges)jb=this.hA.zSh(ua,pc.ranges,F);return jb}SOi(){const F=wf(this.SK);return F&&Fc(F.sourceItem)?F.sourceItem:null}fdk(){this.raiseEvent(vf.yae,null)}Lck(F){Object(dg.d)(()=>{this.raiseEvent(vf.N5c,F)})}Dyk(F,ua){const jb=F.commandParameters.originalDestinations;ua&&(tc.X(this.da.ha.qa.selectedRanges,
jb)?(this.bwb(ua),F=ae.HelperMethods.XIb(ua),L.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${F}`)):F.commandParameters.isPasteCommandFromRecoveryUI?(this.bwb(ua,!0),L.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${ua}, active cell: ${ua[0].topLeft}`)):(F=ae.HelperMethods.XIb(jb),L.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${F}`)))}Vhj(F){if(F.isPlainTextPaste||
F.isHtmlPaste||jf(F)||F.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,KWa:!1};var ua=F.copyContextSnapshot;if(F.commandParameters.clearStateOnFinish)return{returnValue:!0,KWa:!0};if(ua&&Fc(ua.sourceItem)){var jb=ua.sourceItem;if(!jb.isFromCurrentSession(this.$))return{returnValue:!1,KWa:!0};ua=-1985798686===ua.commandParameters.ribbonCommandInfo.command;if(!(1<jb.ranges.length||1<F.commandParameters.expandDestinations.length)){const pc=tc.R(jb.ranges),Vc=tc.R(F.commandParameters.expandDestinations),
pd=this.$.ea.ma.sheetName;jb=jb.sheetName;if(jb===pd&&Vc.equals(pc))return{returnValue:!1,KWa:!0};if(jb===pd&&Vc.Hk(pc))return{returnValue:!(this.j2a&&F.commandParameters.isFormatPainter),KWa:!1}}return{returnValue:ua,KWa:!0}}return{returnValue:!1,KWa:!0}}s_j(){wf(this.SK)&&this.Ix("OnStartEdit",!1).catch(()=>{})}gRj(){wf(this.SK)&&this.Ix("OnEndEdit",!0).catch(()=>{})}qAc(F){F=ee.a.RKi(F,vf.tIa);return this.aGj+ea.a.rE(F).toString()}kWd(F){F=vf.JJa(F);return!!F&&Va.a.DOb(F,vf.$Fj)}k4h(){const F=
ee.a.nj(1,2,327,328,da.a.Vv?329:da.a.sP?330:331,530046625,"ActivateLocalStorage"),ua=Object(rb.d)(za.a.resolve(qa.C,{va:0}));Ab.TaskExtensions.Xa(ua,()=>{ua.result.Mm(43,F)},this.ya,3)}tjf(F){return void 0===F||null===F?Hg.tKj:F?Hg.success:Hg.failed}static w2h(F){const ua=F.innerError;return ua&&0!==ua.pasteErrorName?F.innerError:null}static f2h(F){const ua=F.innerError;return ua&&0!==ua.copyErrorName?F.innerError:null}static JJa(F){let ua="";if(!F)return vf.Xnf;F.errorName&&(ua=F.errorName,F.innerError&&
(ua+=vf.tIa+vf.JJa(F.innerError)));ua||(ua=F&&F.name?F.name:vf.Xnf);return ua}static wzc(){vf.Oa||(vf.Oa=ah.aSk);return vf.Oa}static jjf(F){switch(F){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return L.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${F}`),2199}}static g2h(F){switch(F){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;
default:return L.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${F}`),2199}}}vf.Scg="EwaJsMetadataChangeListenerId";vf.yae="cpiOSC";vf.N5c="cpiPS";vf.Dci="cpiDID";vf.hib="Unknown";vf.Xnf="UnknownError";vf.tIa="_";vf.urf="DragAndDropError";vf.pasteErrorName="PasteError";vf.WTh="CancelError";vf.copyErrorName="CopyError";vf.$Fj="MergedCellOverlap";vf.qug="PasteRecoveryCachedClipboardItems";vf.xwk=[1352631530,1679665408];
vf.operationSucceededWithAlert=[-103190598,1512686094];vf.pasteDataLimitHit=[1306609195];vf.copyThrottlingError=[-386183710];vf.dragDropNonEmptyRange=[563945982];vf.Oa=null;Object(C.a)(vf,"CopyPasteInfrastructure",pb.a,[764,765,2]);class wh{constructor(){this.Rgb=this.egf=null}}Object(C.a)(wh,"ClipboardPlatformInitializationResult",null,[]);var mh=a(769),Ih=a(768),ph=a(245),Xh=a(119);const Di=(F,ua,jb,pc,Vc,pd,gd,Md)=>{Md=void 0===Md?null:Md;gd=F.$a(1,gd);gd.pasteHtmlParameters=ua;return Zc.h(F,"PasteHtmlContent",
gd,jb,pc,Vc,pd,64,Md)},Oi=(F,ua,jb,pc,Vc,pd,gd,Md,ze,T)=>{T=void 0===T?null:T;ze=F.$a(9,ze);const Za={};Za.DestinationRange=ua;Za.Source=jb;Za.AutoAdjustColumnsOn=pc;ze.pasteStringParameters=Za;return Zc.h(F,"PasteString",ze,Vc,pd,gd,Md,64,T)},Yh=(F,ua,jb,pc,Vc,pd,gd,Md)=>{Md=void 0===Md?null:Md;gd=F.$a(1,void 0===gd?null:gd);gd.copyParameters=ua;return Zc.h(F,"Copy",gd,jb,pc,Vc,pd,0,Md)},Ei=(F,ua,jb,pc,Vc,pd,gd,Md)=>{Md=void 0===Md?null:Md;gd=F.$a(1,void 0===gd?null:gd);gd.pasteParameters=ua;return Zc.h(F,
"Paste",gd,jb,pc,Vc,pd,64,Md)};class Fi{constructor(F,ua,jb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=F;this.destinationRange=ua;this.pasteFlags=jb}}Object(C.a)(Fi,"MacroRecorderPasteRangePayload",null,[146]);class sh{constructor(F,ua){this.content=this.destinationRange=null;this.destinationRange=F;this.content=ua}getContent(){return this.content}}Object(C.a)(sh,"MacroRecorderPasteStringPayload",null,[146]);class Gi{constructor(F){this.pasteParameters=null;this.pasteParameters=
F}}Object(C.a)(Gi,"MacroRecorderPastePayload",null,[146]);var mi=a(692),Ti=a(242);class ri{constructor(F){this.parameters=null;this.parameters=F}getParameters(){return this.parameters}}Object(C.a)(ri,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[146]);class ei{constructor(F){this.sheetName=null;this.sheetName=F}getSheetName(){return this.sheetName}}Object(C.a)(ei,"MacroRecorderFullSheetCopyPayload",null,[146]);class nh{constructor(F,ua){this.qYb=this.Uya=null;this.gGc=ya.EwaSettings.getBooleanFeatureGate(ug.a.IMb,
!1);this.nUd=!1;this.F_=null;this.UE=(jb,pc)=>{if(2===pc.ox)this.FB=[],this.Uya=null;else if(1===pc.ox&&this.FB&&this.FB.includes(pc.Ul)){jb=Xh.a(pc.Ul.operation.operationName);const Vc=pc.Ul.dequeueUtcTime.getTime()-pc.Ul.enqueueUtcTime.getTime();L.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${jb} returned, it took ${Vc} milliseconds to complete.`);this.FB.splice(this.FB.indexOf(pc.Ul),1);this.Uya=null}};this.$=F;this.da=ua;this.nUd&&(this.$.userOperationManager.kw(this.UE),
this.FB=[]);zb.a.Vna()&&void za.a.resolve(qa.q,{va:1}).then(jb=>{this.F_=jb})}get TZb(){return this.$.ua.CCPCopyPasteHtmlLimit}get Wbg(){return this.$.ua.CCPPastePlainTextLimit}copy(F,ua,jb,pc,Vc){pc=void 0===pc?null:pc;Vc=void 0===Vc?null:Vc;const pd=this.$.pa.ta.Wh();this.nUd&&this.G9();this.qYb=pd.ClientRequestId;var gd=new xb.a(505,0,(Md,ze,T)=>{const Za={CopyPasteTargetType:1};Za.SourceRanges=F;Za.CopyOperationId=ua.id;return this.Uya=Yh(this.$.pa.dyd,Za,Rc.c(Md,jb),pc?Rc.b(ze,pc):ze,T,ua.ribbonCommandInfo,
pd,Vc)},80);gd=this.$.userOperationManager.enqueueOperation(gd,ua.ribbonCommandInfo);this.nUd&&this.FB.push(gd)}fullSheetCopy(F,ua,jb,pc){pc=void 0===pc?null:pc;const Vc=this.$.pa.ta.Wh();this.qYb=Vc.ClientRequestId;const pd=new xb.a(609,0,(gd,Md,ze)=>{var T=this.$.pa.ta;gd=Rc.c(gd,jb);Md=pc?Rc.b(Md,pc):Md;var Za=ua.ribbonCommandInfo;const Bb=T.$a(1,void 0===Vc?null:Vc);Bb.sheetName=F;return this.Uya=Zc.h(T,"CopySheetToShadowWorkbook",Bb,gd,Md,ze,Za,0)},80,()=>new ei(F));this.$.userOperationManager.enqueueOperation(pd,
ua.ribbonCommandInfo)}pug(F,ua,jb,pc,Vc,pd){return new Promise((gd,Md)=>{var ze;const T=pd.commandParameters.stopwatch.zi;let Za=2;20===pd.commandParameters.commandType&&(Za=16);36===pd.commandParameters.commandType&&(Za=32);68===pd.commandParameters.commandType&&(Za=64);zb.a.O_d(this.$)&&1028===pd.commandParameters.commandType&&(Za=1024);4100===pd.commandParameters.commandType&&(Za=4096);let Bb=null;if(null===(ze=pd.copyContextSnapshot)||void 0===ze?0:ze.commandParameters)Bb=pd.copyContextSnapshot.commandParameters.id;
nh.goe(this.$,F,pc,ua,jb,null,Gc=>{nh.XCc(Gc,pd,gd,Md,T,this.$,null,!0,null,null)},Gc=>{pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.zi-T;Gc=ic.a.kk(Gc.data);Md(new rc(5,Gc))},Vc,Za,Bb,pd.commandParameters.id)})}pasteRange(F,ua,jb,pc,Vc,pd,gd,Md,ze,T){return new Promise((Za,Bb)=>{const Gc=gd.commandParameters.stopwatch.zi;nh.Ozk(this.$,F,ua,jb,pc|-5&Vc,qd=>{nh.XCc(qd,gd,Za,Bb,Gc,this.$,null,!0,ze,T)},qd=>{gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.zi-Gc;qd=ic.a.kk(qd.data);
qd=new rc(5,qd);null===T||void 0===T?void 0:T(qd);Bb(qd)},pd,Md)})}W$j(F,ua,jb,pc,Vc,pd,gd,Md){const ze=new mh.a;return new Promise((T,Za)=>{if(ua)if(ua.length>this.TZb){var Bb=gd.clipboardItems.getItem(Xd.a.plainText);let Gc=-1;void 0!==Bb&&null!==Bb&&(Gc=Bb.length);L.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${ua.length}, MaxHtmlImportLength: ${this.TZb}, PlainTextLength: ${Gc}`);Za(new rc(1))}else Bb=new xb.a(204,
0,(Gc,qd,Rd)=>{this.$.WC();const je=gd.commandParameters.stopwatch.zi;Gc=Rc.c(Gc,Tf=>{qa.od.Aa()&&ze.cancel();nh.XCc(Tf,gd,T,Za,je,this.$,ua,!1,null,null)});qd=Rc.b(qd,Tf=>{gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.zi-je;Tf=ic.a.kk(Tf.data);qa.od.Aa()&&ze.cancel();Za(new rc(3,Tf))});const Ge=this.$.pa.ta.Wh(),af=tc.x(F,this.$),mf={};mf.SourceHtml=ua;mf.DestinationRanges=af?tc.u(af):null;mf.CopyOperationId=jb;mf.PasteId=pc;mf.AutoAdjustColumnsOn=this.YL();return Di(this.$.pa.dyd,mf,Gc,
qd,Rd,null,Ge,pd)},65),this.$.userOperationManager.enqueueOperation(Bb,Vc),qa.od.Aa()&&this.Krd(gd,ua,F,Md,ze),this.HAj(ua);else T("")})}Krd(F,ua,jb,pc,Vc){return pc.Krd(F,ua,jb,Vc)}HAj(F){if(F&&F.trim()&&ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8472105_EnablePasteHtmlTelemetry")){var ua=performance.now(),jb=(new DOMParser).parseFromString(F,"text/html");if(jb){F=[];jb.querySelector("table table")&&F.push("NestedTable");jb.querySelector("table ol")&&F.push("OrderedListInsideTable");jb.querySelector("table ul")&&
F.push("UnorderedListInsideTable");jb.querySelector("ol table")&&F.push("TableInsideOrderedList");jb.querySelector("ul table")&&F.push("TableInsideUnorderedList");jb.querySelector("ol ol")&&F.push("NestedOrderedList");jb.querySelector("ul ul")&&F.push("NestedUnorderedList");jb.querySelector("ol ul")&&F.push("UnorderedListInsideOrderedList");jb.querySelector("ul ol")&&F.push("OrderedListInsideUnorderedList");jb.querySelector("td[rowspan], td[colspan], th[rowspan], th[colspan]")&&F.push("TableWithCellSpan");
var pc=new Set;jb.querySelectorAll("*").forEach(Vc=>{Vc.nodeType===Node.ELEMENT_NODE&&ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8708534_PasteHtmlTelemetryFix")&&Pf.includes(Vc.tagName)&&pc.add(Vc.tagName)});jb=Array.from(pc);F.push(...jb);ua=performance.now()-ua;L.ULS.sendTraceTag(507545676,0,50,`htmlClipboardItem.logPasteHtmlStructureTelemetry | tagAnalysisTotalTime: ${ua.toFixed(2)} ms, htmlTagAnalysisResult: ${JSON.stringify(F)}`)}}}YL(){return null==this.F_?!1:this.F_.YL}X$j(F,ua,jb,pc,Vc){return new Promise((pd,
gd)=>{L.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Vc.id}`);ua&&(ua=Va.a.trimEnd(ua,"\n","\r"));L.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Vc.id}`);if(ua)if(ua.length>this.Wbg)L.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",
ua.length,this.Wbg),gd(new rc(1));else{let ze,T;const Za=tc.x(F,this.$);L.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Vc.id}`);var Md=!this.$.ea.isNamedObjectViewMode&&!ua.includes("\n")&&!ua.includes("\t");L.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Vc.id}. treatAsLink=${Md}`);Md=Md&&Va.a.e0f(ua);L.ULS.sendTraceTag(537167750,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Vc.id}. treatAsLink=${Md}`);const Bb=this.$.pa.ta.Wh();if(Md){T=526;L.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Vc.id}`);const Gc=Ti.a.oyc(ua);L.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Vc.id}`);const qd=tc.u(Za);Md=(Rd,
je,Ge)=>{const af=Vc.commandParameters.stopwatch.zi;Rd=Rc.c(Rd,mf=>{L.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Vc.id}`);Vc.requestTelemetryData=mf.RequestTelemetryData;Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.zi-af;mf.Errors&&0<mf.Errors.length?gd(new rc(2,mf.Errors)):pd(ua)});je=Rc.b(je,mf=>{Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.zi-af;mf=ic.a.kk(mf.data);gd(new rc(2,
mf))});this.$.WC();L.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Vc.id}`);return Zc.b(this.$.pa.ta,qd,ua,Gc,!1,!1,63,Rd,je,Ge,F,Bb,pc)};ze=()=>new mi.a(qd,ua,Gc)}else T=180,Md=(Gc,qd,Rd)=>{this.$.WC();const je=Vc.commandParameters.stopwatch.zi;Gc=Rc.c(Gc,Ge=>{L.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Vc.id}`);nh.XCc(Ge,
Vc,pd,gd,je,this.$,ua,!1,null,null)});qd=Rc.b(qd,Ge=>{Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.zi-je;Ge=ic.a.kk(Ge.data);gd(new rc(4,Ge))});L.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Vc.id}`);return Oi(this.$.pa.dyd,Za,ua,this.YL(),Gc,qd,Rd,null,Bb,pc)},ze=()=>new sh(Za,ua);L.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Vc.id}`);
Md=new xb.a(T,0,Md,65,ze);L.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Vc.id}`);this.$.userOperationManager.enqueueOperation(Md,jb)}else pd("")})}ASf(F,ua){ua=[1===ua?4:5];this.da.Gh.aQ(De.a.t9a(be.d(this.$.ma),F),ua,!0);this.da.Gh.Jw(ua);this.da.Gh.update(!0)}vRd(){const F=[4,5];this.da.Gh.Mq(F,!1,!1);this.da.Gh.qt(null,F,!1);1===this.da.ha.Ck&&this.da.Jw(!1,!1);this.da.Gh.update(!1,!1)}zSh(F,ua,jb){const pc=[];for(const Vc of jb)pc.push(this.GSh(F,
ua,Vc));return pc}G9(){if(this.FB)for(const F of this.FB)if(this.$&&this.$.userOperationManager){if(F.operation){const ua=Xh.a(F.operation.operationName);L.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${ua}.`)}this.UTh();this.$.userOperationManager.Dva(F)}}UTh(){if(this.Uya){const F=this.Uya.sD;L.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${F}`);ic.a.gE(F);!ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&
this.qYb&&Zc.i(this.$.pa.ta,this.qYb,null,null,null);this.qYb=this.Uya=null}}GSh(F,ua,jb){L.ULS.shipAssertTag(537167713,0,!!ua,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");L.ULS.shipAssertTag(537167712,0,0<ua.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let pc=0,Vc=0;var pd=new Set;const gd=new Set;for(const Md of ua){ua=`${Md.left}_${Md.right}`;const ze=`${Md.top}_${Md.bottom}`;gd.has(ua)||(gd.add(ua),Vc+=Md.width);pd.has(ze)||
(pd.add(ze),pc+=Md.height)}if(36===F)return jb.isSingle?nh.kyf(Vc,pc,jb):jb.clone();516===F&&(F=pc,pc=Vc,Vc=F);F=!(jb.width%Vc)&&!(jb.height%pc);pd=jb.g1&&!(jb.height%pc);jb.fba&&!(jb.width%Vc)||pd?jb=nh.kyf(Vc,pc,jb):F?jb=jb.clone():(jb=jb.clone(),jb.bottom=Math.min(Ec.a.fl,jb.top+pc-1),jb.right=Math.min(Ec.a.Nk,jb.left+Vc-1));return jb}rJh(F,ua,jb,pc,Vc,pd,gd,Md,ze,T,Za){if(!pc||!pc.length)return 1;if(1<pc.length){if(!this.gGc&&pd)return 3;if(T)return 0;if(Md)return 9;if(ze)return 8;if(Za)return 2;
if(1<ua.length)return 4;const Bb=ua[0];if(!gd&&!ph.a.all(pc,Gc=>Gc.isSingle||!(Gc.width%Bb.width)&&!(Gc.height%Bb.height)))return 5;if((!this.gGc||!pd)&&Va.a.equals(F,jb,!0))for(const Gc of Vc)if(Gc.Xi(Bb)&&!Gc.equals(Bb))return 6}else if(ua&&0<ua.length){if(0!==this.$Xf(ua,ze))return 7;if(1<ua.length){if(!this.gGc&&pd)return 3;if((!this.gGc||!pd)&&Va.a.equals(F,jb,!0))for(const Bb of ua)if(F=Vc[0],Bb.Xi(F)&&!Bb.equals(F))return 6}}return 0}$Xf(F,ua){if(!F||1>=F.length)return 0;if(ua)return 2;if(!tc.Z(F))return 1;
ua=new Ih.a(eh.a.zm());for(const jb of F)for(const pc of F){const Vc=jb.top===pc.top&&jb.bottom===pc.bottom,pd=jb.left===pc.left&&jb.right===pc.right,gd=Math.max(jb.left,pc.left)<Math.min(jb.right,pc.right);if(Math.max(jb.top,pc.top)<Math.min(jb.bottom,pc.bottom)&&!Vc||gd&&!pd)return 3;ua.add(`${jb.top}-${jb.bottom}-${pc.left}-${pc.right}`);ua.add(`${pc.top}-${pc.bottom}-${jb.left}-${jb.right}`)}for(const jb of F)ua.remove(`${jb.top}-${jb.bottom}-${jb.left}-${jb.right}`);return 0<ua.count?3:0}ngk(F){const ua=
this.da.ha;ua.updateSelection(F,F.topLeft,0);ua.selectionType=-1}DBc(F){if(null===F||void 0===F?0:F.sourceItem){if(!Fc(F.sourceItem))return null;if((F=F.sourceItem)&&tc.mb(F.ranges,!0))return F}return null}Znb(F,ua){L.ULS.shipAssertTag(537167711,0,!!F,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return ua&&X.a.gF in ua||F.tabName?!1:1===F.method}static Ozk(F,ua,jb,pc,Vc,pd,gd,Md,ze){const T=F.pa.ta.Wh(ze?{lza:!0,Uxa:1}:{lza:!1,Uxa:0});ze=new xb.a(506,0,(Za,Bb,Gc)=>{F.WC();
var qd=F.pa.ta;Za=Rc.c(Za,pd);Bb=Rc.b(Bb,gd);var Rd=Md;Rd=void 0===Rd?null:Rd;const je=qd.$a(9,T);je.sourceRanges=jb;je.destinationRanges=pc;je.flags=Vc;return Zc.h(qd,"PasteRange",je,Za,Bb,Gc,null,64,Rd)},65,()=>new Fi(jb,pc,Vc));F.userOperationManager.enqueueOperation(ze,ua)}static XCc(F,ua,jb,pc,Vc,pd,gd,Md,ze,T){gd=void 0===gd?null:gd;L.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${ua.id}`);ua.requestTelemetryData=
F.RequestTelemetryData;ua.serverRequestTimeInMs=ua.commandParameters.stopwatch.zi-Vc;ee.a.jl(F.Errors)?ee.a.gua(F.Errors)?(ua&&(ua.encounteredDeploymentErrors=!0),F=ee.a.ei(F.Errors),L.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${F}`)):(F=new rc(5,F.Errors),null===T||void 0===T?void 0:T(F),pc(F)):F.Result?(pc=!!F&&!!F.RequestTelemetryData,ja.f(pd).Gk.t1(ua.commandParameters.stopwatch.id,
F.StateId,pc?F.RequestTelemetryData.EcsOperationDuration:0,pc?F.RequestTelemetryData.EcsRequestDuration:0,pc?F.RequestTelemetryData.WfeRequestDuration:0),pc=F.Result,ua.pastedRange=pc.SheetMultiRange,L.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${ua.id}`),null===ze||void 0===ze?void 0:ze(),jb(!0),ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&Md&&!ua.commandParameters.isDragDrop?(ua=za.a.nh(qa.te))&&ua.oja(6,F):zb.a.Vna()&&pc.AutoAdjustedColumns&&void za.a.resolve(qa.q,{va:1}).then(Za=>{Za.lhg("Paste")})):(L.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${ua.id}`),jb(gd||!0))}static goe(F,ua,jb,pc,Vc,pd,gd,Md,ze,T,Za,Bb){const Gc=F.pa.ta.Wh(),qd=nh.Slf(jb,pc,Vc,T,Za,Bb);jb=new xb.a(503,0,(Rd,je,Ge)=>{F.WC();return Ei(F.pa.ta,
qd,Rc.c(Rd,gd),Rc.b(je,Md),Ge,pd,Gc,ze)},65,()=>new Gi(qd));F.userOperationManager.enqueueOperation(jb,ua)}static Slf(F,ua,jb,pc,Vc,pd){const gd={};gd.ShadowWorkbookBase64=F.shadowWorkbookBase64;gd.SourceRanges={};gd.SourceRanges.Ranges=Array(1);gd.SourceRanges.Ranges[0]={};gd.SourceRanges.Ranges[0].FirstRow=F.rangeRowStart;gd.SourceRanges.Ranges[0].LastRow=F.rangeRowEnd;gd.SourceRanges.Ranges[0].FirstColumn=F.rangeColumnStart;gd.SourceRanges.Ranges[0].LastColumn=F.rangeColumnEnd;ya.EwaSettings.getBooleanFeatureGate(ug.a.IMb,
!1)?jb?gd.DestinationRanges=tc.w(jb.SheetName,jb.NamedObjectName,tc.h(jb.Ranges)):(L.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),gd.DestinationRanges=null):gd.DestinationRanges=ua?tc.u(ua):null;gd.CopyPasteTargetType=1;gd.PasteType=pc;gd.CopyOperationId=Vc;gd.PasteId=pd;gd.SourceClientPath=F.sourceClientPath;gd.SourceSheetName=F.sourceSheetName;gd.SourceWorkbookName=F.sourceWorkbookName;if(!F.originalSourceRangesCountExceedsLimit&&
F.originalSourceRanges&&0<F.originalSourceRanges.length&&1024===pc){gd.OriginalSourceMultiRange={};ua=Array(F.originalSourceRanges.length);for(jb=0;jb<ua.length;++jb)ua[jb]={},ua[jb].FirstRow=F.originalSourceRanges[jb][0],ua[jb].FirstColumn=F.originalSourceRanges[jb][1],ua[jb].LastRow=F.originalSourceRanges[jb][2],ua[jb].LastColumn=F.originalSourceRanges[jb][3];gd.OriginalSourceMultiRange.Ranges=ua}return gd}static kyf(F,ua,jb){jb=jb.clone();jb.height<ua&&(jb.bottom=Math.min(Ec.a.fl,jb.top+ua-1));
jb.width<F&&(jb.right=Math.min(Ec.a.Nk,jb.left+F-1));return jb}mMk(F,ua,jb){return(F=ja.f(F).oh.Kl(jb))?ua.width===F.usedRange.width&&jb.left===F.usedRange.left||jb.left===F.usedRange.left&&jb.right===F.usedRange.right&&0===jb.width%ua.width:!1}lMk(F,ua,jb){return(F=ja.f(F).oh.Kl(jb))?ua.height===F.usedRange.height&&jb.top===F.usedRange.top||jb.top===F.usedRange.top&&jb.bottom===F.usedRange.bottom&&0===jb.height%ua.height:!1}executeInsertCopiedCutCellsOperation(F,ua,jb,pc,Vc,pd,gd){pd=void 0===pd?
null:pd;gd=void 0===gd?null:gd;const Md={};Md.InsertDirection=pc;Md.SourceRange=F;Md.DestRange=ua;Md.CopyCutOperation=jb?0:1;const ze=this.$.pa.ta,T=this.$.pa.ta.Wh(),Za=()=>new ri(Md);return wa.a(this.$.userOperationManager,(Bb,Gc,qd)=>{Bb=pd?Rc.c(Bb,pd):Bb;Gc=gd?Rc.b(Gc,gd):Gc;const Rd=ze.$a(41,null);Rd.insertCopiedCutCellsParameters=Md;return Zc.h(ze,"InsertCopiedCutCellsV2",Rd,Bb,Gc,qd,T,0)},Bb=>new xb.a(104,0,Bb,void 0,Za),Vc)}gii(F,ua,jb,pc,Vc,pd,gd,Md){return new Promise((ze,T)=>{this.executeInsertCopiedCutCellsOperation(ua,
jb,pc,Vc,pd,Za=>{F.requestTelemetryData=Za.RequestTelemetryData;if(Za.Errors&&0<Za.Errors.length){const Bb=new rc(21,Za.Errors);null===Md||void 0===Md?void 0:Md(Bb);T(new rc(21,Za.Errors))}else null===gd||void 0===gd?void 0:gd(),ze(!0)},Za=>{Za=ic.a.kk(Za.data);Za=new rc(21,Za);null===Md||void 0===Md?void 0:Md(Za);T(Za)})})}executeInsertCopiedCutCellsAcrossSession(F,ua,jb,pc,Vc,pd,gd,Md,ze,T,Za){pd=void 0===pd?null:pd;gd=void 0===gd?null:gd;const Bb={};Bb.PasteParameters=nh.Slf(T,Md,ze,2,Za.copyContextSnapshot.commandParameters.id,
Za.commandParameters.id);Bb.InsertDirection=pc;Bb.SourceRange=F;Bb.DestRange=ua;Bb.CopyCutOperation=jb?0:1;const Gc=this.$.pa.ta,qd=this.$.pa.ta.Wh(),Rd=()=>new ri(Bb);return wa.a(this.$.userOperationManager,(je,Ge,af)=>{je=pd?Rc.c(je,pd):je;Ge=gd?Rc.b(Ge,gd):Ge;const mf=Gc.$a(41,null);mf.insertCopiedCutCellsParameters=Bb;return Zc.h(Gc,"InsertCopiedCutCellsCrossSession",mf,je,Ge,af,qd,0)},je=>new xb.a(106,0,je,void 0,Rd),Vc)}}Object(C.a)(nh,"CopyPasteUtils",null,[763]);var vi=a(502),wi;(function(F){F[F.range=
0]="range";F[F.art=1]="art";F[F.nonGrid=2]="nonGrid";F[F.fullSheet=3]="fullSheet"})(wi||(wi={}));Object(C.b)("SourceItemType",wi);class Hi extends md{constructor(F,ua,jb){super(ua,jb);this.sheetName=F}isEqual(F){return F&&Object.getType(F)===Hi?this.EGc(F)&&this.sheetName===F.sheetName:!1}}Object(C.a)(Hi,"FullSheetSourceItem",md,[]);class Ph{constructor(F){this.RYg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1,["SourceItemType.NonGrid"]:2,["SourceItemType.FullSheet"]:3};this.G8a={};this.NYg=
{["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.urd={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",
["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.QYg={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686,["RibbonCommand.WriteToClipboard"]:396830482,["RibbonCommand.FullSheetCopy"]:-207190267};this.Yle={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut",
["396830482"]:"RibbonCommand.WriteToClipboard",["-207190267"]:"RibbonCommand.FullSheetCopy"};this.PYg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.Rxa={};this.OYg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.ukb={};this.SYg={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,
["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,
["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.TA={};this.$=F;this.Rxa.notDefined="InputManager.InputMethod.NotDefined";this.Rxa.unknown="InputManager.InputMethod.Unknown";this.Rxa.keyboard="InputManager.InputMethod.Keyboard";this.Rxa.mouse="InputManager.InputMethod.Mouse";this.Rxa.touch="InputManager.InputMethod.Touch";this.Rxa.crossSlide="InputManager.InputMethod.CrossSlide";this.ukb.none="FrameMode.None";
this.ukb.reading="FrameMode.Reading";this.ukb.edit="FrameMode.Edit";this.TA.unknown="UILocation.Unknown";this.TA.upperRibbon="UILocation.UpperRibbon";this.TA.ribbon="UILocation.Ribbon";this.TA.QAT="UILocation.QAT";this.TA.jewel="UILocation.Jewel";this.TA.navigationPane="UILocation.NavigationPane";this.TA.keyboardShortcut="UILocation.KeyboardShortcut";this.TA.statusBar="UILocation.StatusBar";this.TA.dialog="UILocation.Dialog";this.TA.floatie="UILocation.Floatie";this.TA.notificationBar="UILocation.NotificationBar";
this.TA.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.TA.taskPane="UILocation.TaskPane";this.TA.heroDock="UILocation.HeroDock";this.TA.singleLineRibbon="UILocation.SingleLineRibbon";this.TA.multilineRibbon="UILocation.MultilineRibbon";this.TA.overflow="UILocation.Overflow";this.TA.tellMe="UILocation.TellMe";this.TA.farPeripheralControls="UILocation.FarPeripheralControls";this.TA.header="UILocation.Header";this.TA.fileMenu="UILocation.FileMenu";this.TA.contextMenu="UILocation.ContextMenu";
this.TA.dialogMenu="UILocation.DialogMenu";this.TA.toolbar="UILocation.Toolbar";this.TA.canvas="UILocation.Canvas";this.G8a.range="SourceItemType.Range";this.G8a.art="SourceItemType.Art";this.G8a.nonGrid="SourceItemType.NonGrid";this.G8a.fullSheet="SourceItemType.FullSheet"}serializeSourceItem(F){const ua={};if(F&&Object.getType(F)===Eb)ua.sheetName=F.sheetName,ua.topArray=ph.a.map(F.ranges,jb=>jb.top),ua.leftArray=ph.a.map(F.ranges,jb=>jb.left),ua.bottomArray=ph.a.map(F.ranges,jb=>jb.bottom),ua.rightArray=
ph.a.map(F.ranges,jb=>jb.right),ua.sessionStateId=F.sessionStateId,ua.sessionId=F.sessionId,ua.sourceItemType=this.xXc(0);else if(F&&Object.getType(F)===Yd)ua.activeFloatingObjectControlId=F.activeFloatingObjectControlId,ua.sheetName=F.sheetName,ua.sessionStateId=F.sessionStateId,ua.sessionId=F.sessionId,ua.floatingObjectType=this.yAk(F.type),ua.sourceItemType=this.xXc(1);else if(F&&Object.getType(F)===ca)ua.sessionStateId=F.sessionStateId,ua.sessionId=F.sessionId,ua.sourceItemType=this.xXc(2);else if(F&&
Object.getType(F)===Hi)ua.sheetName=F.sheetName,ua.sessionStateId=F.sessionStateId,ua.sessionId=F.sessionId,ua.sourceItemType=this.xXc(3);else return L.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(ua)}serializeCommandParameters(F){if(!F)return L.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const ua={};ua.id=F.id;ua.commandType=
F.commandType;ua.copyPasteTargetType=F.copyPasteTargetType;F.ribbonCommandInfo&&(ua.ribbonCommandName=this.IAk(F.ribbonCommandInfo.command),ua.inputMethodName=this.CAk(F.ribbonCommandInfo.method),ua.frameModeName=this.AAk(F.ribbonCommandInfo.mode),ua.uiLocationName=this.MAk(F.ribbonCommandInfo.ik),ua.tabName=F.ribbonCommandInfo.tabName);return JSON.stringify(ua)}deserializeSourceItem(F){if(!F)return null;try{const ua=JSON.parse(F);if(!ua)return L.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;let jb=null;switch(this.Qdi(ua.sourceItemType)){case 0:jb=new Eb(this.$,this.Ndi(ua),ua.sheetName,ua.sessionStateId,ua.sessionId);break;case 1:jb=new Yd(ua.activeFloatingObjectControlId,ua.sheetName,ua.sessionStateId,ua.sessionId,this.Kdi(ua.floatingObjectType));break;case 2:jb=new ca(ua.sessionStateId,ua.sessionId);break;case 3:jb=new Hi(ua.sheetName,ua.sessionStateId,ua.sessionId)}return jb}catch(ua){return L.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${F?
F.length:0}, errror: ${ua}`),null}}deserializeCommandParameters(F){if(!F)return null;try{const ua=JSON.parse(F);if(!ua)return L.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const jb=We.a();jb.id=ua.id;jb.ribbonCommandInfo=this.Pdi(ua);jb.commandType=ua.commandType;jb.copyPasteTargetType=ua.copyPasteTargetType;return jb}catch(ua){return L.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${F?
F.length:0}, errror: ${ua}`),null}}Ndi(F){const ua=[];L.ULS.shipAssertTag(537167699,0,!!F.topArray&&0<F.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${F.topArray?"empty":"null"}.`);L.ULS.shipAssertTag(537167698,0,!!F.leftArray&&0<F.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${F.leftArray?"empty":"null"}.`);L.ULS.shipAssertTag(537167697,0,!!F.bottomArray&&0<F.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${F.bottomArray?
"empty":"null"}.`);L.ULS.shipAssertTag(537167696,0,!!F.rightArray&&0<F.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${F.rightArray?"empty":"null"}.`);if(!(F.topArray&&F.leftArray&&F.bottomArray&&F.rightArray))return ua;L.ULS.shipAssertTag(537167695,0,F.topArray.length===F.bottomArray.length&&F.topArray.length===F.leftArray.length&&F.topArray.length===F.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${F.topArray.length}), BottomArray(${F.bottomArray.length}), LeftArray(${F.leftArray.length}), RightArray(${F.rightArray.length}) should be the same.`);
const jb=Math.min(F.topArray.length,F.bottomArray.length,F.leftArray.length,F.rightArray.length);for(let pc=0;pc<jb;pc++)ua.push(new Rb.Range(F.topArray[pc],F.leftArray[pc],F.bottomArray[pc],F.rightArray[pc],!1,!1));return ua}Pdi(F){return new Db.a(this.Odi(F.ribbonCommandName),this.Mdi(F.inputMethodName),this.Ldi(F.frameModeName),this.Sdi(F.uiLocationName),F.tabName)}IAk(F){return void 0!==F&&null!==F&&F.toString()in this.Yle?this.Yle[F.toString()]:(L.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${F}`),
this.Yle["-911352779"])}Odi(F){return F&&F in this.QYg?this.QYg[F]:(L.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${F}`),-911352779)}CAk(F){return void 0!==F&&null!==F&&Ma.a[F]in this.Rxa?this.Rxa[Ma.a[F]]:(L.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${F}`),this.Rxa.unknown)}Mdi(F){return F&&
F in this.PYg?this.PYg[F]:(L.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${F}`),0)}AAk(F){return void 0!==F&&null!==F&&vi.a[F]in this.ukb?this.ukb[vi.a[F]]:(L.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${F}`),this.ukb.edit)}Ldi(F){return F&&F in this.OYg?this.OYg[F]:(L.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${F}`),
2)}xXc(F){return void 0!==F&&null!==F&&wi[F]in this.G8a?this.G8a[wi[F]]:(L.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${F}`),this.G8a.range)}Qdi(F){return F&&F in this.RYg?this.RYg[F]:(L.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${F}`),0)}yAk(F){return void 0!==F&&null!==F&&F.toString()in this.urd?this.urd[F.toString()]:(L.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${F}`),
this.urd["99"])}Kdi(F){return F&&F in this.NYg?this.NYg[F]:(L.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${F}`),99)}MAk(F){return void 0!==F&&null!==F&&Pb.a[F]in this.TA?this.TA[Pb.a[F]]:(L.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${F}`),this.TA.ribbon)}Sdi(F){return F&&F in this.SYg?this.SYg[F]:(L.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${F}`),
2)}}Object(C.a)(Ph,"EnvironmentSerializationHelper",null,[]);class bg{}bg.JKg="SameSession";bg.Pzd="CrossSession";bg.Q6f="LegacyCrossSession";bg.external="External";Object(C.a)(bg,"PayloadOrigin",null,[]);const Mg=F=>F?F.shadowWorkbookSizeExceedsLimit&&void 0!==F.shadowWorkbookBlockedSize&&null!==F.shadowWorkbookBlockedSize?F.shadowWorkbookBlockedSize:F.shadowWorkbookBase64?F.shadowWorkbookBase64.length:0:0,Qh=F=>F.shadowWorkbookSizeExceedsLimit?!0:Mg(F)>Ec.a.AMc;var jh=a(101);class Kh{constructor(F,
ua,jb){jb=void 0===jb?null:jb;this.iVa=!1;this._name=ua;this.$=F;this.Vq=na.a.instance;this.hA=new nh(F,ja.f(F));this.aMb=jb}get name(){return this._name}get ZIb(){return this.Vq.Ea(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}l3k(F){let ua;ua=null;try{const jb=F.getItem(Xd.a.shadowWorkbook);if(!jb)return{returnValue:!1,vN:ua};ua=JSON.parse(jb);return{returnValue:this.Zsj(ua),vN:ua}}catch(jb){return L.ULS.sendTraceTag(537167835,0,50,
"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+jb),{returnValue:!1,vN:ua}}}Zsj(F){return!!F&&(!!F.shadowWorkbookBase64||F.shadowWorkbookSizeExceedsLimit)&&void 0!==F.rangeRowStart&&void 0!==F.rangeRowEnd&&void 0!==F.rangeColumnStart&&void 0!==F.rangeColumnEnd}eRc(F){F.wasLastCopyExternal=!0;ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&F.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(F.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.Ytc?20:4);if(ug.a.D0a&&516!==F.commandParameters.commandType&&1028!==F.commandParameters.commandType){let ua=null;if((()=>{let jb=this.l3k(F.clipboardItems);({vN:ua}=jb);return jb})().returnValue)return F.isShadowWorkbookParsedSuccessfully=!0,this.W4j(F,ua)}if(516!==F.commandParameters.commandType&&36!==F.commandParameters.commandType&&4100!==F.commandParameters.commandType){if(20!==F.commandParameters.commandType){const ua=F.clipboardItems.getItem(Xd.a.html),
jb=this.d4f(ua),pc=F.clipboardItems.getItem(Xd.a.hsc),Vc=Ia.f(F.clipboardItems.getItem(Xd.a.plainText));return!jb||!pc&&Vc?(Vc&&L.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.Zbe(F)):this.lug(F,ua,void 0===pc?null:pc)}return this.Zbe(F)}return Promise.reject(new rc(6))}W4j(F,ua){L.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");F.pasteResult="SystemClipboardShadowWorkbookPaste";
F.payloadType=vg.shadowWorkbook;F.payloadOrigin=bg.external;F.shadowWorkbookPayloadSize=Mg(ua);F.shadowWorkbookSizeExceedsLimit=Qh(ua);let jb=null,pc=null;const Vc=F.commandParameters.originalDestinations;ya.EwaSettings.getBooleanFeatureGate(ug.a.IMb,!1)?jb=tc.t(Vc,this.$):pc=tc.x(tc.R(Vc),this.$);ua.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(F.originalSourceRangesCountExceedsLimit=ua.originalSourceRangesCountExceedsLimit);if(F.shadowWorkbookSizeExceedsLimit)return L.ULS.sendTraceTag(537167833,
0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${F.shadowWorkbookPayloadSize}) is over the limit(${Ec.a.AMc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ua.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new rc(1));L.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${F.commandParameters.id}`);return this.hA.pug(F.commandParameters.ribbonCommandInfo,pc,jb,ua,[F.commandParameters.stopwatch],
F)}Zbe(F){var ua=F.clipboardItems.getItem(Xd.a.plainText);if(void 0!==ua&&null!==ua&&ua.trim()===this.ZIb)return Promise.reject(new rc(7));void 0!==ua&&null!==ua&&(F.plainTextPayloadSize=ua.length);let jb=!1;null!==this.aMb&&(jb=this.aMb.LKh(F,Va.a.trimEnd(ua,"\n","\r"),tc.R(F.commandParameters.originalDestinations)));jb&&ja.f(this.$).Gk.gT(F.commandParameters.stopwatch.id,Ag.BasicTelemetryCalculator.TR);this.iVa||(this.iVa=!0,jh.b("AutoAdjustColumnWidthTriggered"));F.isPlainTextPaste=!0;F.pasteResult=
"SystemClipboardPaste";F.payloadOrigin=cf(F)?bg.Q6f:bg.external;F.payloadType=vg.plainText;L.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${F.id}, PasteOperationId=${F.commandParameters.id}`);ua=this.hA.X$j(tc.R(F.commandParameters.originalDestinations),ua,F.commandParameters.ribbonCommandInfo,[F.commandParameters.stopwatch],F);L.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${F.id}`);
return ua}lug(F,ua,jb){this.iVa||(this.iVa=!0,jh.b("AutoAdjustColumnWidthTriggered"));F.htmlPayloadSize=ua.length;F.isHtmlPaste=!0;F.pasteResult="SystemClipboardHtmlPaste";F.payloadType=vg.html;F.payloadOrigin=cf(F)?bg.Q6f:bg.external;F.cseStatus=3;L.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${F.commandParameters.id}`);return this.hA.W$j(tc.R(F.commandParameters.originalDestinations),ua,jb,F.commandParameters.id,F.commandParameters.ribbonCommandInfo,
[F.commandParameters.stopwatch],F,this.aMb)}yzd(F){const ua={};F&&(ua.shadowWorkbookBase64=F.ShadowWorkbookBase64,ua.shadowWorkbookSizeExceedsLimit=F.ShadowWorkbookSizeExceedsLimit,ua.originalSourceRangesCountExceedsLimit=F.OriginalSourceRangesCountExceedsLimit,ua.originalSourceRangesCount=F.OriginalSourceRangesCount,ua.shadowWorkbookBlockedSize=F.ShadowWorkbookBlockedSize);return ua}E8g(F,ua){const jb=Fe(F),pc=32===(F.commandParameters.commandType&32),Vc=1024===(F.commandParameters.commandType&1024);
let pd=!1,gd=null,Md=null,ze=!1;if(!jb){pd=-1985798686===F.commandParameters.ribbonCommandInfo.command;var T=F.copyContextSnapshot;if(ua)ze=!T.sourceItem.isFromCurrentSession(this.$);else if(T=this.hA.DBc(T))gd=T.ranges,Md=T.sheetName,ze=!F.isSameSession}return this.hA.rJh(Md,gd,this.$.ma.sheetName,F.commandParameters.originalDestinations,F.commandParameters.expandDestinations,ze,pc,Vc,pd,ua,jb)}d4f(F){return!(void 0===F||null===F)&&!!F&&F.trim()!==this.ZIb&&(F.startsWith("<")||da.a.Am&&F.startsWith("\n<"))}}
Object(C.a)(Kh,"BaseCopyPasteHandler",null,[818,779,819]);class Lh{constructor(F){this.clipboardItems=this.key=null;this.U_=F}BK(F){return this.key&&this.key.isEqual(F)?this.createClipboardItems(this.clipboardItems):null}setValue(F,ua){this.key=F;this.clipboardItems=this.createClipboardItems(ua)}createClipboardItems(F){const ua=this.U_.create();var jb=F.getItem(Xd.a.plainText);jb&&ua.setItem(Xd.a.plainText,jb);(jb=F.getItem(Xd.a.shadowWorkbook))&&ua.setItem(Xd.a.shadowWorkbook,jb);(F=F.getItem(Xd.a.html))&&
ua.setItem(Xd.a.html,F);return ua}}Object(C.a)(Lh,"CopyCache",null,[]);class xi extends Kh{constructor(F,ua,jb,pc,Vc){Vc=void 0===Vc?null:Vc;super(F,pc,ua);this.aMb=ua;this.U_=jb;this.ZLb=Vc||new Lh(this.U_);this.da=ja.f(F);this.ha=this.da.ha;ya.EwaSettings.hVd()||(this.clipboardRangeFactory=F.la.lh(169))}getSourceItem(){const F=tc.d(this.da.ha.qa.selectedRanges);return new Eb(this.$,F,this.$.ea.ma.sheetName,this.$.ea.yk,this.$.ua.UserSessionId)}beforeSerialize(F){F.isSelectionAllowed=!1;F.isAsyncCopy=
!1;F.isFromCache=!1;F.encounteredDeploymentErrors=!1;F.plainTextPayloadSize=0;F.shadowWorkbookPayloadSize=0;F.htmlPayloadSize=0;F.clientSideCopyTime=0;if(!F.isFullSheetCopy){var ua=new Gd.a(this.$.sa),jb=F.sourceItem;F.isSelectionAllowed=ph.a.all(jb.ranges,pc=>this.isSelectionAllowed(ua,pc));F.isSelectionAllowed&&this.hA.ASf(jb.ranges,F.commandParameters.commandType)}}R1a(F){return this.da.za.a6()&&ja.h(this.da,F)}y5j(F,ua,jb,pc){if(!this.$.sa.Lq(jb.sheetName))return Promise.reject(new rc(5));let Vc=
!1;const pd=1===ua.commandParameters.commandType,gd=pc[0].qz;1===jb.ranges.length&&1===pc.length?pd&&1!==gd&&gd!==jb.ranges[0].qz?F.cseStatus=17:Vc=this.aMb.nCd(F,tc.R(jb.ranges),jb.sheetName,tc.R(F.commandParameters.expandDestinations),pd):F.cseStatus=5;Vc&&ja.f(this.$).Gk.gT(F.commandParameters.stopwatch.id,Ag.BasicTelemetryCalculator.TR);return this.d5j(F,jb,tc.w(this.$.ma.sheetName,null,pc),ua.commandParameters.commandType,Vc)}isSelectionAllowed(F,ua){return F.Zob(ua,this.da)}d5j(F,ua,jb,pc,Vc){ua=
tc.w(ua.sheetName,null,ua.ranges);F.pasteResult="SameSessionPaste";F.payloadOrigin=bg.JKg;F.payloadType=vg.Cwh;L.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${F.commandParameters.id}`);return this.hA.pasteRange(F.commandParameters.ribbonCommandInfo,ua,jb,pc,F.commandParameters.commandType,[F.commandParameters.stopwatch],F,Vc,null,null)}}Object(C.a)(xi,"BaseRangeCopyPasteHandler",Kh,[]);class oh{constructor(F){this.N4=new Mb.a(!0);
this.$=F}onDeferredPasteStarted(F){this.N4.kh(F.id)||this.N4.add(F.id,!0);if(0<this.N4.count)if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void za.a.resolve(qa.C,{va:0}).then(ua=>{ua.Mm(28,null)});else{const ua=Object(rb.d)(za.a.resolve(qa.C,{va:0}));Ab.TaskExtensions.Xa(ua,()=>{ua.result.Mm(28,null)},this.$.ya,3)}}onDeferredPasteCompleted(F){const ua=0<this.N4.count;this.N4.kh(F.id)&&this.N4.remove(F.id);if(ua&&!this.N4.count)if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))void za.a.resolve(qa.C,{va:0}).then(jb=>{jb.removeEntry(28)});else{const jb=Object(rb.d)(za.a.resolve(qa.C,{va:0}));Ab.TaskExtensions.Xa(jb,()=>{jb.result.removeEntry(28)},this.$.ya,3)}}}Object(C.a)(oh,"DeferredPasteTracker",null,[]);var Qd;(function(F){F[F.none=0]="none";F[F.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";F[F.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";F[F.asyncCopyCanceled=3]="asyncCopyCanceled";F[F.loadCopiedArtDataFromServerFailed=4]=
"loadCopiedArtDataFromServerFailed"})(Qd||(Qd={}));Object(C.b)("CopyErrorType",Qd);class we extends $a{constructor(F,ua){ua=void 0===ua?null:ua;super(Qd[F]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=F;this.ewaErrors=ua;if(null===ua||void 0===ua?0:ua.length)this.innerError=new Wb(ua,null)}}Object(C.a)(we,"CopyInnerError",$a,[]);var qh=a(718);class Jg extends xi{constructor(F,ua,jb,pc){super(F,ua,jb,"AcrossSessionRangeCopyPasteHandler",void 0===pc?null:pc);this.N4=new oh(F)}serialize(F){const ua=
F.sourceItem,jb={};let pc=this.ZLb.BK(ua);if(pc)jb.synchronousResult=pc,F.isFromCache=!0,F.clientSideCopyTime=F.commandParameters.stopwatch.zi;else{let pd=null;var Vc=tc.K(ua.ranges);if(!zb.a.x_f()&&this.R1a(Vc)){L.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Vc=ya.EwaSettings.hVd()?new qh.a(this.da,Vc):this.clipboardRangeFactory.create(Vc);try{pd=Vc.toString(),pc=this.U_.create(),pc.setItem(Xd.a.plainText,
pd),this.ZLb.setValue(ua,pc),jb.synchronousResult=pc,F.clientSideCopyTime=F.commandParameters.stopwatch.zi}finally{Vc&&Vc.dispose()}}else F.isAsyncCopy=!0,jb.synchronousResult=this.U_.create(),jb.synchronousResult.setItem(Xd.a.plainText,this.ZIb);jb.asynchronousResult=this.IZa(F,ua,pd)}F.syncClipboardItemsKeys=ib(jb.synchronousResult);return jb}shouldWaitForCopyToComplete(F){if(!F||!F.copyContextSnapshot)return L.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;L.ULS.shipAssertTag(537167906,0,!!this.$.ua,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(F.copyContextSnapshot.sessionId===this.$.ua.UserSessionId)return L.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;L.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(F){this.N4.onDeferredPasteStarted(F)}onDeferredPasteCompleted(F){this.N4.onDeferredPasteCompleted(F)}deserialize(F){var ua;
F.isClipboardDataContainShadowWorkbook=!(void 0===F.clipboardItems.getItem(Xd.a.shadowWorkbook)||null===F.clipboardItems.getItem(Xd.a.shadowWorkbook));if(ja.f(this.$).ha.Ck&326)return Fe(F)&&(F.wasLastCopyExternal=!0),Promise.reject(new rc(17));var jb=this.E8g(F,!1);if(0!==jb)return Promise.reject(new rc(Fe(F)?18:F.isSameSession?19:20,void 0,void 0,void 0,jb));jb=F.copyContextSnapshot;var pc=this.hA.DBc(jb);if(Fe(F)||(null===(ua=F.copyContextSnapshot)||void 0===ua?0:ua.sourceItem)&&nd(F.copyContextSnapshot.sourceItem))return this.eRc(F);
ua=F.commandParameters.originalDestinations;if(pc&&F.isSameSession)return this.y5j(F,jb,pc,ua);if(516!==F.commandParameters.commandType){let Vc=null;if((()=>{let pd=this.R$b(F.clipboardItems);({vN:Vc}=pd);return pd})().returnValue)return F.isShadowWorkbookParsedSuccessfully=!0,pc=jb=null,ya.EwaSettings.getBooleanFeatureGate(ug.a.IMb,!1)?jb=tc.t(ua,this.$):pc=tc.x(tc.R(ua),this.$),this.T4j(F,pc,jb,Vc);if(F.isClipboardInaccessible)return Promise.reject(new rc(8));if(36!==F.commandParameters.commandType)return this.Zbe(F)}return Promise.reject(new rc(6))}beforePaste(F){qa.Be.Aa()?
za.a.nh(qa.Be).HLg(F):this.$.la.lh(373).HLg(F);F.indicationDisplayScheduled=!0}uye(F){let ua;if(!(F&&F.SourceRanges&&F.SourceRanges.Ranges&&F.SourceRanges.Ranges.length&&(F.OriginalSourceRangesCountExceedsLimit||F.OriginalSourceMultiRange&&F.OriginalSourceMultiRange.Ranges&&F.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,vN:null};var jb=F.SourceRanges.Ranges[0];if(!F.ShadowWorkbookBase64&&!F.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,vN:null};ua=this.yzd(F);ua.rangeRowStart=
jb.FirstRow;ua.rangeRowEnd=jb.LastRow;ua.rangeColumnStart=jb.FirstColumn;ua.rangeColumnEnd=jb.LastColumn;ua.sourceClientPath=F.SourceClientPath;ua.sourceSheetName=F.SourceSheetName;ua.sourceWorkbookName=F.SourceWorkbookName;if(!F.OriginalSourceRangesCountExceedsLimit)for(F=F.OriginalSourceMultiRange.Ranges,ua.originalSourceRanges=Array(F.length),jb=0;jb<F.length;++jb)ua.originalSourceRanges[jb]=[F[jb].FirstRow,F[jb].FirstColumn,F[jb].LastRow,F[jb].LastColumn];return{returnValue:!0,vN:ua}}R$b(F){let ua;
ua=null;F=F.getItem(Xd.a.shadowWorkbook);if(!F)return{returnValue:!1,vN:ua};ua=JSON.parse(F);return{returnValue:this.z_d(ua),vN:ua}}IZa(F,ua,jb){L.ULS.shipAssertTag(537167901,0,!!F,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const pc=F.commandParameters.stopwatch.zi,Vc=tc.w(ua.sheetName,null,ua.ranges);return new Promise((pd,gd)=>{L.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${F.id}`);
this.hA.copy(Vc,F.commandParameters,Md=>{F.requestTelemetryData=Md.RequestTelemetryData;F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-pc;if(ee.a.jl(Md.Errors))if(ee.a.gua(Md.Errors))F.encounteredDeploymentErrors=!0,Md=ee.a.ei(Md.Errors),L.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Md}. copy Id: ${F.id}`);else{var ze=ee.a.ei(Md.Errors);if(ee.a.ko(Md.Errors,
[-591377245])){var T=this.FE(Vc);if(T){T=String.format(this.Vq.sh(218),T.toLocaleUpperCase());var Za=Md.Errors.findIndex(qd=>-591377245===qd.MessageId);Md.Errors[Za].Description=T;L.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${F.id}`)}}L.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ze}. copy Id: ${F.id}`);
gd(new we(2,Md.Errors))}else if(L.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${F.id}`),F.markForCancellation)gd(new we(3,Md.Errors));else{var Bb=Md.Result;T=Bb.PlainTextResult;void 0!==jb&&null!==jb&&(T=jb);void 0!==T&&null!==T&&(F.plainTextPayloadSize=T.length);ze=this.U_.create();var Gc;(()=>{let qd=this.uye(Bb);({vN:Gc}=qd);return qd})().returnValue&&(F.shadowWorkbookPayloadSize=Mg(Gc),F.shadowWorkbookSizeExceedsLimit=
Qh(Gc),F.originalSourceRangesCountExceedsLimit=Bb.OriginalSourceRangesCountExceedsLimit,Za=JSON.stringify(Gc),ze.setItem(Xd.a.shadowWorkbook,Za));ze.setItem(Xd.a.plainText,T);zb.a.x_f()&&(T=Bb.HtmlResult,F.htmlSizeExceedsLimit=Bb.HtmlSizeExceedsLimit,void 0!==T&&null!==T&&(F.htmlPayloadSize=T.length),ze.setItem(Xd.a.html,T));F.copyTotalSizeExceedsLimit=Bb.CopyTotalSizeExceedsLimit;ze.setItem(Xd.a.hsc,F.commandParameters.id);this.ZLb.setValue(ua,ze);F.asyncClipboardItemsKeys=ib(ze);pd(ze);ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&(ze=1===F.commandParameters.commandType?8:7,(T=za.a.nh(qa.te))&&T.oja(ze,Md))}},Md=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-pc;Md=ic.a.kk(Md.data);const ze=ee.a.ei(Md);L.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ze}. copy Id: ${F.id}`);gd(new we(2,Md))},[F.commandParameters.stopwatch])})}z_d(F){return!!F&&(!!F.shadowWorkbookBase64||F.shadowWorkbookSizeExceedsLimit)&&void 0!==F.rangeRowStart&&
void 0!==F.rangeRowEnd&&void 0!==F.rangeColumnStart&&void 0!==F.rangeColumnEnd}T4j(F,ua,jb,pc){L.ULS.shipAssertTag(537167903,0,!!pc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");F.pasteResult="CrossSessionPaste";F.payloadOrigin=bg.Pzd;F.payloadType=vg.shadowWorkbook;F.shadowWorkbookPayloadSize=Mg(pc);F.shadowWorkbookSizeExceedsLimit=Qh(pc);F.cseStatus=3;pc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(F.originalSourceRangesCountExceedsLimit=
pc.originalSourceRangesCountExceedsLimit);if(F.shadowWorkbookSizeExceedsLimit)return L.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${F.shadowWorkbookPayloadSize}) is over the limit(${Ec.a.AMc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${pc.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new rc(1));if(1028===F.commandParameters.commandType&&F.originalSourceRangesCountExceedsLimit)return L.ULS.sendTraceTag(572617859,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${pc.originalSourceRangesCount}) is over the limit(${Ec.a.JEj}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${pc.originalSourceRangesCountExceedsLimit}`),Promise.reject(new rc(1));L.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${F.commandParameters.id}`);return this.hA.pug(F.commandParameters.ribbonCommandInfo,
ua,jb,pc,[F.commandParameters.stopwatch],F)}FE(F){return null==F||null==F.Ranges||0===F.Ranges.length?(L.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===F.Ranges.length?tc.F(F.Ranges[0]):tc.K(tc.h(F.Ranges))).toString()}}Object(C.a)(Jg,"AcrossSessionRangeCopyPasteHandler",xi,[]);var Ii=a(1298);class yi{constructor(F,ua,jb,pc,Vc,pd,gd){this.floatingObjectId=F;this.commandParameters=ua;this.jQ=jb;this.Qai=pc;this.iwa=void 0===pd?null:
pd;this.XAe=void 0===gd?null:gd;this.d3h=Vc}}Object(C.a)(yi,"CopyArtRequest",null,[]);class Bh{constructor(F,ua,jb,pc,Vc,pd,gd,Md,ze){this.promise=null;this.ribbonCommandInfo=F;this.destination=ua;this.Tof=jb;this.XAe=Vc;this.vN=pd;this.item=gd;this.pasteContext=Md;this.f3a=jb||ua.FirstRow+"_"+ua.FirstColumn;this.X_f=!0;this.agf=ze}}Object(C.a)(Bh,"PasteArtRequest",null,[]);class Ji{constructor(F,ua){this.n5b=new Ha.a;this.GVa=F;this.$=ua;this.zak=jb=>Promise.resolve(jb);this.e1b=jb=>Promise.reject(jb)}w4i(F){if(this.yoj(F.f3a)){L.ULS.sendTraceTag(537167681,
5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${F.f3a}`);const ua=this.n5b.na(F.f3a);this.n5b.ga(F.f3a,F);const jb=ua.promise;ua.X_f=!1;return this.oli(F,jb)}this.n5b.ga(F.f3a,F);return this.Wvj(F)}yoj(F){return this.n5b.kh(F)}Wvj(F){return new Promise((ua,jb)=>{F.promise=this.GVa.kug(F).then(pc=>{ua(null);return this.CPc(F,pc)},pc=>{jb(null);return this.e1b(pc)})})}oli(F,ua){return new Promise((jb,pc)=>{F.promise=ua.then(Vc=>{this.e9k(F,
Vc);return this.GVa.kug(F).then(pd=>{jb(null);return this.CPc(F,pd)},pd=>{pc(null);return this.e1b(pd)})},Vc=>this.e1b(Vc))})}CPc(F,ua){F.X_f&&(this.uXh(F.f3a),this.Jne(F,ua));return this.zak(ua)}uXh(F){this.n5b.remove(F)}Jne(F,ua){const jb=this.RVi();F.f3a===jb&&this.GVa.Jne(F.destination,ua,F.item.type)}RVi(){var F=ja.f(this.$).ha.$e.activeFloatingObjectControlId;F||(F=tc.x(ja.f(this.$).ha.qa.activeCell,this.$),F=F.FirstRow+"_"+F.FirstColumn);return F}e9k(F,ua){F.destination=null;F.Tof=ua}}Object(C.a)(Ji,
"PasteArtRequestManager",null,[]);var Mh=a(212);class Ki extends Kh{constructor(F,ua,jb,pc,Vc){Vc=void 0===Vc?null:Vc;super(F,"ArtCopyPasteHandler");this.lYh="XLO";this.mYh="3";this.N4=new oh(F);this.U_=ua;this.GVa=jb;this.ha=ja.f(F).ha;this.fsc=Vc||new Lh(this.U_);this.U4j=new Ji(jb,F);this.YIb=pc}getSourceItem(){L.ULS.shipAssertTag(537167896,0,!!this.ha.$e.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");L.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.$e.activeFloatingObjectControlId}]`);
return new Yd(this.ha.$e.activeFloatingObjectControlId,this.$.ea.ma.sheetName,this.$.ea.yk,this.$.ua.UserSessionId,this.ha.$e.Lh.floatingObject.type)}beforeSerialize(F){F&&F.commandParameters?(wc(F),F.commandParameters.copyPasteTargetType=2):L.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(F){const ua=F.sourceItem,jb={};if(!ua)return L.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),
jb;if(!this.Krj())return L.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),jb;L.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${ua.activeFloatingObjectControlId}]`);this.Ade();let pc=this.fsc.BK(ua);if(pc)jb.synchronousResult=pc,F.isFromCache=!0,F.isAsyncCopy=!1,F.clientSideCopyTime=F.commandParameters.stopwatch.zi,1===F.commandParameters.commandType&&
this.$.ti(2045211913,F.commandParameters.ribbonCommandInfo.method,F.commandParameters.ribbonCommandInfo.ik,null);else{F.isFromCache=!1;F.isAsyncCopy=!0;pc=this.U_.create();if(F.commandParameters.uploadToClipService){const Vc={};Vc["data-clipservice-ccpid"]=F.commandParameters.id;Vc["data-pkey"]=F.commandParameters.pKey;Vc["data-clipservice-type"]=F.commandParameters.clipServiceDataType;Vc["data-clipservice-count"]=F.commandParameters.objectCount.toString();Vc["data-clipservice-dc"]=F.commandParameters.clipServiceDataCenter;
Vc["data-clipservice-client"]=this.lYh;Vc["data-TimeStamp"]=(new Date).toUTCString();Vc["data-clipservice-version"]=this.mYh;pc.setItem(Xd.a.GFh,JSON.stringify(Vc))}zb.a.nya()?(jb.synchronousResult=this.RXi(pc),jb.asynchronousResult=this.QEi(F,ua,pc)):(jb.synchronousResult=this.C2e(pc),jb.asynchronousResult=this.IZa(F,ua,pc))}F.syncClipboardItemsKeys=ib(jb.synchronousResult);return jb}RXi(F){return this.ha.$e.Lh.floatingObject.Oaa?(F.setItem(Xd.a.plainText,this.ZIb),F):this.C2e(F)}C2e(F){L.ULS.shipAssertTag(537167891,
0,!!this.ha.$e.Lh,"Expecting a floating object to be currently selected for copy");F||(F=this.U_.create());const ua=this.ha.$e.Lh.zQb();ua&&F.setItem(Xd.a.html,`<img src='${ua}'>`);return F}Ade(){const F=this.ha.$e.Lh;this.YIb.Ade(Ra.a.Tgb(F.floatingObject),Ra.a.oYh(F.yz))}shouldWaitForCopyToComplete(){L.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(F){this.N4.onDeferredPasteStarted(F)}onDeferredPasteCompleted(F){this.N4.onDeferredPasteCompleted(F)}deserialize(F){var ua=
Fe(F),jb=null;let pc=null;var Vc=!1;if(!ua){jb=F.copyContextSnapshot;pc=jb.sourceItem;if(!pc)return Promise.reject(new rc(10));Vc=pc.isFromCurrentSession(this.$)}var pd=this.E8g(F,!0);if(0!==pd)return Promise.reject(new rc(ua?18:Vc?19:20,void 0,void 0,void 0,pd));if(ua)return this.eRc(F);if(!Vc&&!Ki.Hij(pc))return F=`User attempted to paste art of type [${pc.type}] between sessions.`,L.ULS.sendTraceTag(537167889,0,50,F),Promise.reject(new rc(11,void 0,void 0,F));if(jb.isAsyncSerializeFailed)return Promise.reject(new rc(16,
void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let gd;try{const Md=F.clipboardItems.getItem(Xd.a.shadowWorkbook);if(zb.a.nya()&&!Md&&1===pc.type)return this.F$j(F);gd=JSON.parse(Md)}catch(Md){return F=copyPasteInfra.getStringifiedError(Md),L.ULS.sendTraceTag(507798424,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${F}`),Promise.reject(new rc(12,void 0,Md))}gd.floatingObjectId!==pc.activeFloatingObjectControlId?
L.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${pc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${gd.floatingObjectId}]`):L.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${pc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${gd.floatingObjectId}]`);if(!gd||
!gd.shadowWorkbookBase64)return Promise.reject(new rc(13,void 0,void 0,`shadowWorkbookPayload is null = ${!gd}`));F.isShadowWorkbookParsedSuccessfully=!0;F.shadowWorkbookPayloadSize=Mg(gd);F.shadowWorkbookSizeExceedsLimit=Qh(gd);F.payloadOrigin=Vc?bg.JKg:bg.Pzd;F.payloadType=vg.Hch;F.cseStatus=0;if(Qh(gd))return F=`Shadow workbook size [${F.shadowWorkbookPayloadSize}] is over the limit [${Ec.a.AMc}]. ShadowWorkbookSizeExceedsLimit: ${gd.shadowWorkbookSizeExceedsLimit}`,L.ULS.sendTraceTag(36304156,
0,15,`ArtCopyPasteHandler.Deserialize: ${F}`),Promise.reject(new rc(1,void 0,void 0,F));jb=ua=null;ja.f(this.$).ha.Ck&326?jb=ja.f(this.$).ha.$e.activeFloatingObjectControlId:ua=this.$.ma&&this.$.ma.activeCell?tc.x(this.$.ma.activeCell,this.$):tc.x(tc.R(F.commandParameters.originalDestinations),this.$);Vc||!ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||
(F.ArtSourceItemType=Ii.a[pc.type],L.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${pc.type}] between sessions.`));Vc=null;if(this.YIb.gTg(pc))try{Vc=this.YIb.nCd(),F.cseStatus=1}catch(Md){F.cseStatus=15,pd=copyPasteInfra.getStringifiedError(Md),L.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${pd}`)}else F.cseStatus=26;return this.U4j.w4i(new Bh(F.commandParameters.ribbonCommandInfo,
ua,jb,F.commandParameters.commandType,[F.commandParameters.stopwatch],gd,pc,F,Vc))}eRc(F){F.wasLastCopyExternal=!0;if(F.clipboardItems.getItem("image/png")){const ua=F.commandParameters.stopwatch.zi;F.payloadType=vg.zMh;return rb.c(this.$.ti(1403967063,F.commandParameters.ribbonCommandInfo.method,F.commandParameters.ribbonCommandInfo.ik,{["dataUrl"]:F.clipboardItems.getItem("image/png")})).then(jb=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-ua;return jb?Promise.resolve(null):Promise.reject(new rc(15))},
()=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-ua;return Promise.reject(new rc(15))})}L.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.eRc(F)}F$j(F){try{const ua=F.clipboardItems.getItem(Xd.a.html);return this.d4f(ua)?this.lug(F,ua,null):Promise.reject(new rc(23))}catch(ua){return F=copyPasteInfra.getStringifiedError(ua),L.ULS.sendTraceTag(507782405,0,10,`ArtCopyPasteHandler.processClipboardHtml: Failed to process clipboard html with exception: ${F}`),
Promise.reject(new rc(24,void 0,ua))}}Krj(){const F=ja.f(this.$).ha;return F.$e.activeFloatingObjectControlId&&F.$e.Lh&&F.$e.Lh.floatingObject?F.$e.Lh.floatingObject.Ive():!1}QEi(F,ua,jb){return this.ha.$e.Lh.floatingObject.Oaa?new Promise((pc,Vc)=>{const pd=this.REi(F,jb),gd=this.IZa(F,ua,jb);void Promise.allSettled([pd,gd]).then(Md=>{var [ze,T]=Md;"rejected"===ze.status?(1===F.commandParameters.commandType&&this.GVa.P3g(ua.type,ua.activeFloatingObjectControlId),Vc(ze.reason)):("rejected"===T.status&&
L.ULS.sendTraceTag(507811728,0,50,`ArtCopyPasteHandler.getAsyncData: Promise fetching data from server has failed with error ${T.reason}. Proceeding with resolving clipboard items from asyncArtData.`),Md=ze.value,this.fsc.setValue(ua,Md),pc(Md))})}):this.IZa(F,ua,jb)}REi(F,ua){return new Promise((jb,pc)=>{const Vc=this.ha.$e.Lh;Vc.Gkb().continueWith(pd=>{var gd;try{const Md=pd.result;ua.setItem(Xd.a.plainText,"");if(Md){const ze=new Image;ze.src=Md;ua.setItem(Xd.a.html,Se.b(ze))}else return L.ULS.sendTraceTag(507811727,
0,15,`ArtCopyPasteHandler.getAsyncImageData: Base64 URL of picture is null. ArtSourceItem id: ${Vc.floatingObject.wi}`),pc(new we(4));F.asyncClipboardItemsKeys=ib(ua);jb(ua)}catch(Md){pd=null===(gd=null===Vc||void 0===Vc?void 0:Vc.floatingObject)||void 0===gd?void 0:gd.wi,L.ULS.sendTraceTag(507811726,0,10,`ArtCopyPasteHandler.getAsyncImageData: Failed to fetch base64 URL of picture. ArtSourceItem id: ${pd}. Exception: ${Md}`),pc(new we(4))}})})}IZa(F,ua,jb){return new Promise((pc,Vc)=>{const pd=F.commandParameters.stopwatch.zi,
gd=this.ha.$e.Lh;L.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.GVa.g3h(new yi(ua.activeFloatingObjectControlId,F.commandParameters,Md=>{var ze;F.requestTelemetryData=Md.RequestTelemetryData;F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-pd;if(ee.a.jl(Md.Errors))if(ee.a.gua(Md.Errors))F.encounteredDeploymentErrors=!0,Md=ee.a.ei(Md.Errors),L.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Md}`);
else{var T=ee.a.ei(Md.Errors);L.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${T}`);Vc(new we(4,Md.Errors))}else if(L.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${ua.activeFloatingObjectControlId}].`),F.markForCancellation)Vc(new we(3,Md.Errors));else{if(ee.a.Gx(Md.Errors)){var Za=ee.a.ei(Md.Errors);L.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Za}`)}if(Za=
Md.Result){Za=this.yzd(Za);Za.floatingObjectId=ua.activeFloatingObjectControlId;F.shadowWorkbookPayloadSize=Mg(Za);F.shadowWorkbookSizeExceedsLimit=Qh(Za);try{T=JSON.stringify(Za)}catch(Bb){Vc(new rc(14,void 0,Bb,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${F.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Za.floatingObjectId}]`));return}L.ULS.shipAssertTag(537167881,0,!!jb,"Expecting syncClipboardItems to be defined");zb.a.nya()&&(null===
(ze=null===gd||void 0===gd?void 0:gd.floatingObject)||void 0===ze?0:ze.Oaa)?(ze=new Blob([T]),1048576<ze.size?L.ULS.sendTraceTag(507798425,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: ShadowWorkbookPayload size is ${ze.size} for floating object id ${gd.floatingObject.wi}. Ignoring shadow workbook to avoid failure in saving to local storage.`):jb.setItem(Xd.a.shadowWorkbook,T)):jb.setItem(Xd.a.shadowWorkbook,T);1===F.commandParameters.commandType&&(this.Y8j(ua.type,ua.activeFloatingObjectControlId,
Md.StateId),this.deleteFloatingObject(ua.activeFloatingObjectControlId,ua.type));this.fsc.setValue(ua,jb);F.asyncClipboardItemsKeys=ib(jb);pc(jb)}else L.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${ua.activeFloatingObjectControlId}`),pc(this.fsc.BK(ua))}},F.commandParameters.commandType,ua.type,Md=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-pd;Md=ic.a.kk(Md.data);1!==F.commandParameters.commandType||
zb.a.nya()&&gd.floatingObject.Oaa||this.GVa.P3g(ua.type,ua.activeFloatingObjectControlId);const ze=ee.a.ei(Md);L.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ze}`);Vc(new we(4,Md))},[F.commandParameters.stopwatch]))})}deleteFloatingObject(F,ua){F=Mh.a.bH(ua,F);if(F=Sa.a(this.$).Ox(F))Sa.a(this.$).deleteFloatingObject(F,14,!0),ja.f(this.$).ha.$e.sK=null}Y8j(F,ua,jb){const pc=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?
za.a.nh(qa.Ng):this.$.la.lh(277);if(pc){let pd=null;F=Mh.a.bH(F,ua);F=Sa.a(this.$).Ox(F);if(null===F||void 0===F?0:F.Xp)pd=F.Xp.block;if(pd){var Vc=F.floatingObject.rn();pc.xlc(()=>!pd.ap.kh(Vc),jb,"CutArt")}}}static Hij(F){return 1===F.type||5===F.type||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===F.type||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)&&8===F.type}}Object(C.a)(Ki,"ArtCopyPasteHandler",
Kh,[]);class Zh extends Gi{constructor(F,ua,jb,pc){super(F);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=ua;this.top=jb;this.left=pc}}Object(C.a)(Zh,"MacroRecorderPasteArtPayload",Gi,[]);class th{constructor(F,ua){this.$=F;this.YIb=ua}J$i(F,ua,jb,pc,Vc,pd,gd){pd=void 0===pd?null:pd;gd=void 0===gd?null:gd;const Md=this.$.pa.ta.Wh();let ze=null;const T={CopyPasteTargetType:2};T.FloatingObjectId=F;T.CopyOperationId=jb.id;jb.floatingObjectType=ua;T.UploadToClipService=jb.uploadToClipService;
T.PKey=jb.pKey;T.ClipServiceDataCenter=jb.clipServiceDataCenter;let Za=0;2===Vc?(Vc=505,Za=16,ze=(Bb,Gc,qd)=>Yh(this.$.pa.ta,T,Rc.c(Bb,pc),pd?Rc.b(Gc,pd):Gc,qd,jb.ribbonCommandInfo,Md,gd)):(Vc=179,ze=(Bb,Gc,qd)=>{this.Zgi(ua,F);this.$.WC();var Rd=this.$.pa.ta;Bb=Rc.c(Bb,pc);Gc=pd?Rc.b(Gc,pd):Gc;var je=jb.ribbonCommandInfo,Ge=gd;Ge=void 0===Ge?null:Ge;const af=Rd.$a(1,void 0===Md?null:Md);af.copyParameters=T;return Zc.h(Rd,"Cut",af,Bb,Gc,qd,je,0,Ge)});this.$.userOperationManager.enqueueOperation(new xb.a(Vc,
0,ze,Za|64),jb.ribbonCommandInfo)}Zgi(F,ua){var jb=Mh.a.bH(F,ua);(jb=Sa.a(this.$).Ox(jb))?(ja.f(this.$).ha.$e.qR(jb),jb.isVisible=!1):L.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${F}, FloatingObjectId: ${ua}`)}P3g(F,ua){F=Mh.a.bH(F,ua);if(F=Sa.a(this.$).Ox(F))F.isVisible=!0}g3h(F){this.J$i(F.floatingObjectId,F.d3h,F.commandParameters,F.jQ,F.Qai,F.iwa,F.XAe)}paj(F,ua,jb,pc,Vc,pd,gd,Md,ze){Md=void 0===Md?null:Md;ze=
void 0===ze?!0:ze;return new Promise((T,Za)=>{const Bb=pd.commandParameters.stopwatch.zi;this.goe(F,Vc,ua,jb,Gc=>{pd.requestTelemetryData=Gc.RequestTelemetryData;pd.serverRequestTimeInMs=pd.commandParameters.stopwatch.zi-Bb;if(ee.a.gua(Gc.Errors))pd&&(pd.encounteredDeploymentErrors=!0),Gc=ee.a.ei(Gc.Errors),L.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Gc}`);else if(ee.a.jl(Gc.Errors)){var qd=
ee.a.ei(Gc.Errors);L.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${qd}`);Za(new rc(9,Gc.Errors))}else Gc.Result?(qd=Gc.Result,L.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.j9j(gd,qd.FloatingObjectId,Gc.StateId),T(th.BSd(qd.FloatingObjectId))):(L.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Za(new rc(9,Gc.Errors)))},Gc=>{pd.serverRequestTimeInMs=
pd.commandParameters.stopwatch.zi-Bb;Gc=ic.a.kk(Gc.data);L.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${ee.a.ei(Gc)}`);Za(new rc(9,Gc))},pc,Md,ze)})}j9j(F,ua,jb){const pc=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?za.a.nh(qa.Ng):this.$.la.lh(277);if(pc){const Vc=Mh.a.bH(F,th.BSd(ua));pc.xlc(()=>!!Sa.a(this.$).Ox(Vc),jb,"PasteArt")}}Tye(F,ua){ua&&this.YIb.Tye(F,Mh.a.bH(F.type,ua))}kug(F){return this.paj(F.ribbonCommandInfo,
F.destination,F.Tof,F.XAe,F.vN,F.pasteContext,F.item.type,F.agf,F.item.isFromCurrentSession(this.$)).then(ua=>ua,ua=>{this.Tye(F.item,F.agf);return Promise.reject(ua)})}Jne(F,ua,jb){F||(F=tc.x(ja.f(this.$).ha.qa.activeCell,this.$));ja.f(this.$).BIc(tc.H(F),1)?Sa.a(this.$).YOa(jb,ua,!0):ja.f(this.$).ha.$e.DWa(F,ua,jb).continueWith(pc=>{pc.result?L.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${ua}]`):L.ULS.sendTraceTag(537167842,
5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${ua}]`)})}goe(F,ua,jb,pc,Vc,pd,gd,Md,ze){ze=void 0===ze?!0:ze;const T=this.$.pa.ta.Wh(),Za={};Za.ShadowWorkbookBase64=ua.shadowWorkbookBase64;Za.FloatingObjectId=pc;Za.DestinationRanges=jb?tc.u(jb):null;Za.CopyPasteTargetType=2;Za.ClientEstimationFloatingObjectId=Md;jb=new xb.a(503,0,(Bb,Gc,qd)=>{Md||this.$.WC();return Ei(this.$.pa.ta,Za,Rc.c(Bb,Vc),Rc.b(Gc,pd),qd,null,T,gd)},void 0,()=>{if(ze){let Bb;Bb=
ha.a.Rp(ha.a.Ci(Za));Bb.FloatingObjectId=ua.floatingObjectId;Za.DestinationRanges||(Bb.DestinationRanges=tc.r(this.$.sa.ma.sheetName,"",0,0,0,0));return new Zh(Bb,ze,0,0)}return new Zh(Za,ze,0,0)});jb.flags=65;this.$.userOperationManager.enqueueOperation(jb,F)}static BSd(F){return`${F.length+2}.{${F.toUpperCase()}}`}}Object(C.a)(th,"ArtCopyPasteUtils",null,[809]);var lj=a(207);class Qi{constructor(F){this.Yxd=this.iHa=null;this.dtb=15;this.$=F}Ade(F,ua){this.iHa=F;this.Yxd=ua}nCd(){if(!this.iHa||
!this.Yxd)return L.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const F=Ra.a.Tgb(new Mh.a(this.iHa));F.Id=th.BSd(Mc.a.create().toString());F.Version=-1;F.Name="";F.IsClientEstimation=!0;var ua=this.Sbj(F);if(!ua)return null;const jb=new Mh.a(F);ua.block.ap.add(jb);jb.uvb();const pc=Sa.a(this.$);pc.wsc(jb,ua);ua=pc.Ox(Mh.a.hNi(F));!ua||ua.floatingObject.MK||ua.floatingObject.Z1a||
ua.D7a(this.Yxd);pc.YOa(F.Type,F.Id,!0);return F.Id}gTg(F){return ya.EwaSettings.Ra(205)&&F.isFromCurrentSession(this.$)&&!ja.f(this.$).rtl&&!ja.f(this.$).fh.pp}Tye(F,ua){this.gTg(F)&&(F=Sa.a(this.$).Ox(ua))&&(L.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${ua}] of type [${F.floatingObject.type}]`),Sa.a(this.$).deleteFloatingObject(F,15,!0),F.Xp&&F.Nub(F.Xp,!1))}Sbj(F){if(!F)return L.ULS.sendTraceTag(537167839,
0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(ja.f(this.$).ha.$e.activeFloatingObjectControlId){var ua=ja.f(this.$).ha.$e.sK.floatingObject;F.OriginDeltaX=ua.offsetX+this.dtb;F.OriginDeltaY=ua.offsetY+this.dtb;F.AbsoluteLeft+=this.dtb;F.AbsoluteTop+=this.dtb;F.AbsoluteRight+=this.dtb;F.AbsoluteBottom+=this.dtb;F.ZOrder=ua.LJ+1;return ja.f(this.$).ha.$e.sK.Xp}if(!this.$.ma||!this.$.ma.activeCell)return L.ULS.sendTraceTag(537167838,0,
15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var jb=this.$.ma.activeCell;ua=ja.f(this.$).zW(jb);if(!ua)return L.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${jb.toString()} is null.`),null;const pc=ae.HelperMethods.ZMd(ua.domElement,ua.Iq.domElement);jb=ua.da.yl(jb,2);if(!pc||!jb)return L.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!pc}. cellPositionRelativeToGridOrigin is null: ${!jb} .`),
null;F.OriginDeltaX=jb.topLeft.x-pc.x;F.OriginDeltaY=jb.topLeft.y-pc.y;F.AbsoluteLeft=jb.topLeft.x;F.AbsoluteTop=jb.topLeft.y;F.AbsoluteRight=F.AbsoluteLeft+Math.abs(this.iHa.AbsoluteRight-this.iHa.AbsoluteLeft);F.AbsoluteBottom=F.AbsoluteTop+Math.abs(this.iHa.AbsoluteBottom-this.iHa.AbsoluteTop);F.ZOrder=this.iHa.ZOrder+100;return new lj.a(ua.da.za.Wn(ua.hashCode),ua.hashCode)}}Object(C.a)(Qi,"ArtPasteClientEstimation",null,[807]);class hi{create(){const F=window.clipboardPlatform;return F?F.createClipboardItems():
null}}Object(C.a)(hi,"ClipboardItemsFactory",null,[806]);class Lg{}Lg.undefined="Undefined";Object(C.a)(Lg,"CCPTelemetryConsts",null,[]);class xh{}xh.cells="Cells";xh.floatingObject="FloatingObject";xh.unknown="Unknown";Object(C.a)(xh,"ActiveSelection",null,[]);class bj extends Jg{constructor(F,ua,jb,pc){super(F,ua,jb,void 0===pc?null:pc);this.rXa=null}beforePaste(){L.ULS.sendTraceTag(508121693,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(F){F.isClipboardDataContainShadowWorkbook=
!(void 0===F.clipboardItems.getItem(Xd.a.shadowWorkbook)||null===F.clipboardItems.getItem(Xd.a.shadowWorkbook));const ua=F.commandParameters.originalDestinations;if(!F.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let jb=null;if((()=>{let pc=this.R$b(F.clipboardItems);({vN:jb}=pc);return pc})().returnValue){F.isShadowWorkbookParsedSuccessfully=!0;let pc=null,Vc=null;ya.EwaSettings.getBooleanFeatureGate(ug.a.IMb,!1)?pc=tc.t(ua,this.$):Vc=tc.x(tc.R(ua),this.$);return this.r5j(F,Vc,
pc,jb)}return F.isClipboardInaccessible?Promise.reject(new rc(8)):Promise.reject(new rc(6))}get copyPasteInfrastructure(){var F;null!==(F=this.rXa)&&void 0!==F?F:this.rXa=this.$.la.lh(254,!0);return this.rXa}Zdj(F,ua,jb,pc){return this.copyPasteInfrastructure?rb.a(this.copyPasteInfrastructure.JTd(null,pc.commandParameters.ribbonCommandInfo,F,ua,jb,pc)):Promise.reject(new rc(0))}r5j(F,ua,jb,pc){F.pasteResult="CrossSessionPaste";F.payloadOrigin=bg.Pzd;F.payloadType=vg.shadowWorkbook;F.shadowWorkbookPayloadSize=
Mg(pc);F.shadowWorkbookSizeExceedsLimit=Qh(pc);pc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(F.originalSourceRangesCountExceedsLimit=pc.originalSourceRangesCountExceedsLimit);return F.shadowWorkbookSizeExceedsLimit?Promise.reject(new rc(1)):1028===F.commandParameters.commandType&&F.originalSourceRangesCountExceedsLimit?Promise.reject(new rc(1)):this.Zdj(ua,jb,pc,F)}}Object(C.a)(bj,"AcrossSessionInsertCopiedCutCellsHandler",Jg,[]);class yh{constructor(F,ua){this.$=F;this.U_=ua}get name(){return"NonGridCopyHandler"}getSourceItem(){return new ca(this.$.ea.yk,
this.$.ua.UserSessionId)}beforeSerialize(F){wc(F);F.commandParameters.copyPasteTargetType=0}serialize(F){const ua={};if(!F.sourceItem)return L.ULS.sendTraceTag(508074082,0,10,"NonGridCopyHandler.Serialize: sourceItem should not be null"),ua;F.isFromCache=!1;F.isAsyncCopy=!1;const jb=this.U_.create();Xd.a.plainText in F.commandParameters.clipboardItems&&jb.setItem(Xd.a.plainText,F.commandParameters.clipboardItems[Xd.a.plainText]);Xd.a.html in F.commandParameters.clipboardItems&&jb.setItem(Xd.a.html,
F.commandParameters.clipboardItems[Xd.a.html]);ua.synchronousResult=jb;return ua}}Object(C.a)(yh,"NonGridCopyHandler",null,[779]);class zi extends Jg{constructor(F,ua,jb,pc){super(F,ua,jb,void 0===pc?null:pc)}getSourceItem(){return new Hi(this.$.ea.ma.sheetName,this.$.ea.yk,this.$.ua.UserSessionId)}beforeSerialize(F){F.isFullSheetCopy=!0;super.beforeSerialize(F)}uye(F){if(!F.ShadowWorkbookBase64&&!F.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,vN:null};const ua=this.yzd(F);ua.sourceClientPath=
F.SourceClientPath;ua.sourceSheetName=F.SourceSheetName;ua.sourceWorkbookName=F.SourceWorkbookName;return{returnValue:!0,vN:ua}}IZa(F,ua){L.ULS.shipAssertTag(507834589,0,!!F,"AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const jb=F.commandParameters.stopwatch.zi;return new Promise((pc,Vc)=>{L.ULS.sendTraceTag(507815952,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${F.id}`);
this.hA.fullSheetCopy(ua.sheetName,F.commandParameters,pd=>{F.requestTelemetryData=pd.RequestTelemetryData;F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-jb;if(!ee.a.jl(pd.Errors)){L.ULS.sendTraceTag(507834588,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for copy Id: ${F.id}`);const gd=this.U_.create();let Md;const ze=pd.Result;(()=>{let T=this.uye(ze);({vN:Md}=T);return T})().returnValue&&(F.shadowWorkbookPayloadSize=Mg(Md),F.shadowWorkbookSizeExceedsLimit=
Qh(Md),F.originalSourceRangesCountExceedsLimit=ze.OriginalSourceRangesCountExceedsLimit,ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8790502_FullSheetCCPEnhancement")&&!F.shadowWorkbookSizeExceedsLimit&&(pd=JSON.stringify(Md),gd.setItem(Xd.a.shadowWorkbook,pd)));gd.setItem(Xd.a.hsc,F.commandParameters.id);this.ZLb.setValue(ua,gd);F.asyncClipboardItemsKeys=ib(gd);pc(gd)}},pd=>{F.serverRequestTimeInMs=F.commandParameters.stopwatch.zi-jb;pd=ic.a.kk(pd.data);const gd=ee.a.ei(pd);L.ULS.sendTraceTag(507834587,
0,10,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${gd}. copy Id: ${F.id}`);Vc(new we(2,pd))})})}beforePaste(){}deserialize(F){F.isClipboardDataContainShadowWorkbook=!F.clipboardItems.getItem(Xd.a.shadowWorkbook);return F.isClipboardDataContainShadowWorkbook?this.R$b(F.clipboardItems).returnValue?(F.isShadowWorkbookParsedSuccessfully=!0,Promise.resolve(!0)):F.isClipboardInaccessible?Promise.reject(new rc(8)):Promise.reject(new rc(6)):Promise.resolve(!0)}serialize(F){const ua=
F.sourceItem,jb={},pc=this.ZLb.BK(ua);pc?(jb.synchronousResult=pc,F.isFromCache=!0,F.clientSideCopyTime=F.commandParameters.stopwatch.zi):(F.isAsyncCopy=!0,jb.synchronousResult=this.U_.create(),jb.synchronousResult.setItem(Xd.a.plainText,this.ZIb),jb.asynchronousResult=this.IZa(F,ua,null));F.syncClipboardItemsKeys=ib(jb.synchronousResult);return jb}}Object(C.a)(zi,"AcrossSessionFullSheetCopyPasteHandler",Jg,[]);class Ch{constructor(F){this.lgd=this.Lad=this.tcd=this.D7c=this.Qhd=null;this.$=F}get kKj(){!this.lgd&&
this.$.la.lh(254,!0)&&(this.lgd=new yh(this.$,new hi));return this.lgd}get Hfe(){if(!this.Qhd){const F=this.$.la.lh(254,!0);F&&(this.Qhd=new Jg(this.$,F,new hi))}return this.Qhd}get bej(){if(!this.tcd){const F=this.$.la.lh(254,!0);F&&(this.tcd=new bj(this.$,F,new hi))}return this.tcd}get oCf(){if(!this.Lad){const F=this.$.la.lh(254,!0);F&&(this.Lad=new zi(this.$,F,new hi))}return this.Lad}get trd(){if(!this.D7c&&this.$.la.lh(254,!0)){const F=new Qi(this.$);this.D7c=new Ki(this.$,new hi,new th(this.$,
F),F)}return this.D7c}getCopyFlowHandler(F){if(-207190267===F.commandParameters.ribbonCommandInfo.command)return this.oCf;if(F.commandParameters.clipboardItems)return this.kKj;const ua=this.sIi(ja.f(this.$).Ck);F.commandParameters.copyPasteHandlerName=ua.name;return ua}getPasteFlowHandler(F){var ua=F.copyContextSnapshot;switch(F.commandParameters.ribbonCommandInfo.command){case 440556491:return F=this.oCf;case -160032004:case -1065525230:return F=this.bej;default:return ua=jf(F)?this.trd:Fe(F)?this.Hfe:
(null===ua||void 0===ua?0:ua.sourceItem)&&Object.getType(ua.sourceItem)===Yd?this.trd:this.Hfe,F.commandParameters.copyPasteHandlerName=ua.name,ua}}initializePasteContext(F){if(F){F.isSameSession=!1;F.isShadowWorkbookParsedSuccessfully=!1;F.pasteResult=Lg.undefined;F.payloadOrigin=Lg.undefined;F.payloadType=Lg.undefined;F.encounteredDeploymentErrors=!1;F.shadowWorkbookSizeExceedsLimit=!1;F.originalSourceRangesCountExceedsLimit=!1;F.activeSelectionType=this.JDi();F.indicationDisplayScheduled=!1;F.pasteDestinationHasMergedCells=
!1;F.cseStatus=0;F.pasteIndicationDisplayStatus=Ee.ggi;if(ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))F.ArtSourceItemType=Lg.undefined;if(F.copyContextSnapshot){var ua=F.copyContextSnapshot;const gd=Fc(ua.sourceItem);var jb=ua.sourceItem;var pc=!!jb&&Object.getType(jb)===Yd;jb=0;var Vc=!1;gd?(Vc=ua.sourceItem,F.isSameSession=Vc.isFromCurrentSession(this.$),
jb=1,Vc=this.Boj(Vc,F)):pc&&(F.isSameSession=ua.sourceItem.isFromCurrentSession(this.$),jb=2);if(F.copyContextSnapshot.commandParameters){const Md=-1985798686===ua.commandParameters.ribbonCommandInfo.command;pc=F.commandParameters;var pd=this.$;ua?pd&&pd.ua?ua=ua.sessionId===pd.ua.UserSessionId:(L.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),ua=!1):(L.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),ua=!1);pc.clearSystemClipboard=ua&&Md&&gd&&!Vc;F.commandParameters.copyPasteTargetType=
jb}}}}getSessionId(){return this.$.ua.UserSessionId}Boj(F,ua){const jb=F.ranges.some(pc=>pc.qk)&&ua.commandParameters.originalDestinations.some(pc=>1!==pc.top);return F.ranges.some(pc=>pc.isRow)&&ua.commandParameters.originalDestinations.some(pc=>1!==pc.left)||jb}sIi(F){switch(F){case 1:return this.Hfe;case 64:case 4:case 2:case 256:return this.trd;default:throw Error.invalidOperation("Unsupported selection");}}JDi(){return ja.f(this.$).ha.Ck&470?xh.floatingObject:1===ja.f(this.$).ha.Ck?xh.cells:
xh.unknown}getDialogResponse(){}}Object(C.a)(Ch,"ExcelCopyPasteApplicationHost",null,[762]);class zh extends de.a{constructor(F,ua){super(F);this.uC=null;this.aej=(jb,pc)=>{1===jb?(jb=zh.ofi[pc[zh.nfi]],L.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===jb?"Horizontal":"Vertical"}`),this.uC.setResult(jb)):(L.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),
this.uC.XC())};this.Ym(ua)}get Di(){return"InsertCopiedCutCellsDialog"}Ym(F){this.uC=new Cc.a;const ua=na.a.instance.ia(16);F=this.FR(F);this.initializeAndShow(ua,this.aej,F)}FR(F){return{[zh.uy]:this.Di,[zh.nqj]:F}}}zh.nfi="direction";zh.nqj="isRtl";zh.ofi={["Vertical"]:1,["Horizontal"]:0};Object(C.a)(zh,"InsertCopiedCutCellsDialog",de.a,[]);class Th{ysc(F,ua){return(new zh(F,ua)).uC.task}}Object(C.a)(Th,"InsertCopiedCutCellsDialogFactory",null,[761]);var Rh=a(1206),mj=a(921),Rf=a(609);const ii=
()=>{var F=navigator.userAgentData;if(F)for(let ua=0;ua<F.brands.length;ua++){if("Microsoft Edge"===F.brands[ua].brand&&79<=parseFloat(F.brands[ua].version))return!0}else if(navigator.userAgent&&(F=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&79<=parseFloat(F[2]))return!0;return!1},Xg=F=>{const ua=ug.a.Mgj&&!F.isMobileMode,jb=ug.a.Ngj&&F.isMobileMode&&F.isEditMode;F=F.uk.get(57);return(ua||jb)&&!F&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&
(ii()||da.a.Vv&&da.a.YKa(86)))};class dh extends zg.a{constructor(F){super();this.kYh="clipboard-read";this.$=F;this.Vq=na.a.instance;this.Zhj=ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8282600_EnableClipboardPermissionLogging");this.gm()}create(){const F=ac.a.E6([75,76],4,this.xh,void 0,void 0,void 0,dh.O6b),ua=Object(rb.d)(za.a.resolve(qa.xc,{va:this.xh})),jb=Object(rb.d)(za.a.resolve(qa.ah)),pc=qa.od.Aa()?Object(rb.d)(za.a.resolve(qa.od,{va:this.xh})):Oc.a.Ua(null),Vc=qa.Be.Aa()?Object(rb.d)(za.a.resolve(qa.Be,
{va:this.xh})):Oc.a.Ua(null);Ab.TaskExtensions.Xa(Ab.TaskExtensions.Wo([ua,F,jb,pc,Vc],this.ya),()=>{const pd=new Rh.a;let gd=null;this.m0h(pd).then(Md=>{gd=Md.egf;const ze=copyPasteInfra.createCopyPasteInfra(gd,new Ch(this.$),pd);L.ULS.shipAssertTag(537167762,0,!!this.$.ua,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");L.ULS.shipAssertTag(537167761,0,!!this.$.ua&&!!this.$.ua.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
const T=gd.getMetadataManager();var Za=Object(mj.a)(this.$.la,254,()=>new vf(this.$,T,ua.result,ze,new nh(this.$,ja.f(this.$)),new Th,this.$.ua.DocumentHostInfo.UserId,gd.getInitializationError(),jb.result,pc.result,Vc.result));this.Bk(Za);if(Md.Rgb){Za=vf.wzc();const Bb=JSON.stringify(Md.Rgb.dataClipboardCapabilities),Gc=Md.Rgb.clipboardStrategiesToInitialize[0].clipboardStrategyType===Md.Rgb.dataClipboardStrategyType,qd=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();L.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${Za}, StrategyType=${Md.Rgb.dataClipboardStrategyType}, StrategyCapabilities=${Bb}, IsBestStrategyTypeInitialized=${Gc}, InfraLoadTimeMS=${qd}`)}else L.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},Md=>{const ze=
vf.wzc();Md=Md?copyPasteInfra.getStringifiedError(Md):"null";L.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${ze} error: ${Md}`)})},this.ya,3)}dispose(){super.dispose()}m0h(F){var ua,jb;let pc=null;var Vc=window.clipboardPlatform;Vc&&(pc=Vc.getClipboardPlatformEnvironment(),null===(ua=Vc.setClipboardPlatformFeatureGateManager)||void 0===ua?void 0:
ua.call(Vc,Rf.a()));if(!pc)return L.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);ua=this.$.ua;Vc=[ua.OfficeOnlineChromeExtensionId,ua.ChromeClipboardAccessExtensionId];const pd=this.Vq.Ea(5),gd=this.$.uk.get(57);let Md=!gd&&this.$.uk.get(5);var ze=this.$.ea.Kh;ze&&(ze.inWebPart||ze.inViewerFromWebPart||ze.isDivSyndicated)&&(Md=!1);(ze=Xg(this.$))&&L.ULS.sendTraceTag(508703874,
0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");try{this.Zhj&&(null===(jb=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===jb?0:jb.query)&&navigator.permissions.query({name:this.kYh}).then(T=>{L.ULS.sendTraceTag(508151361,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Clipboard read permission state: ${null===T||void 0===T?void 0:T.state}`)}).catch(T=>{L.ULS.sendTraceTag(508151360,
0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(T)}`)})}catch(T){L.ULS.sendTraceTag(508151331,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(T)}`)}jb=this.hHi(Md,!gd,ze);L.ULS.shipAssertTag(537167758,0,!!ua.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");
return pc.init(F,Vc,ua.SharedClipboardHostingApp,ua.SharedClipboardHostingApps,ua.SharedClipboardHostingEnvironments,ua.SharedClipboardOverrideOrigin,ua.SharedClipboardSchemaVersion,ua.SharedClipboardExpirationInMinutes,ua.ClipboardPromiseTimeoutInMinutes,pd,ua.MachineCluster,new Ph(this.$),jb,ua.DocumentHostInfo.UserId,ua.ClipboardTtlInMS,ya.EwaSettings.Ra(273),ua.UserSessionId,ua.BulsEndpointUrl).then(T=>Object(re.a)(new wh,{egf:pc,Rgb:T}),T=>Promise.reject(T))}hHi(F,ua,jb){const pc=[];F&&jb&&pc.push(this.wmf(9));
F&&ua&&pc.push(this.wmf(6));ua&&(pc.push(this.Hzd(7)),pc.push(this.Hzd(0)));F&&pc.push(this.slf());pc.push({clipboardStrategyType:4});jb=pc?pc.map(Vc=>JSON.stringify(Vc)).join(","):"[]";L.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${F}, isSystemClipboardAllowed=${ua}, result = ${jb}`);return pc}slf(){const F=this.$.ua,ua={clipboardStrategyType:5};ua.sessionId=F.UserSessionId;ua.useSharedClipboardIframe=
!0;ua.sharedClipboardHostingApp=F.SharedClipboardHostingApp;ua.sharedClipboardHostingApps=F.SharedClipboardHostingApps;ua.sharedClipboardHostingEnvironments=F.SharedClipboardHostingEnvironments;ua.sharedClipboardOverrideOrigin=F.SharedClipboardOverrideOrigin;ua.sharedClipboardSchemaVersion=F.SharedClipboardSchemaVersion;ua.sharedClipboardExpirationInMinutes=F.SharedClipboardExpirationInMinutes;ua.wacCluster=F.MachineCluster;return ua}wmf(F){const ua={};ua.clipboardStrategyType=F;ua.localStorageStrategyParameters=
this.slf();ua.systemClipboardStrategyParameters=this.Hzd(0);return ua}Hzd(F){const ua={};ua.clipboardStrategyType=F;ua.skipFilesIfPlainTextExists=!0;return ua}static Ba(F){qa.Be.Aa()||F.la.Hh(373,new ef(F));F.la.Hh(dh.O6b,new dh(F))}}dh.O6b=255;Object(C.a)(dh,"CopyPasteInfrastructureFactory",zg.a,[]);var kh=a(9),ni=a(592),Uh=a(210),Ui=a(444);class ji{constructor(){this.Upa=this.uDf=null}}Object(C.a)(ji,"GestureAdapterInfo",null,[]);var Vi=a(530),cj=a(293);class oi{constructor(){this.d$c=null}txj(){if(!this.d$c){var F=
"hammer.min.js";xa.AFrameworkApplication.fa.Jv("IsServerFlavorDebug")&&(F=xa.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");F=xa.AFrameworkApplication.vJ(String.format("{0}",F),5);F=cj.a.create(F,null,null);Vi.a.Wva(F);this.d$c=F.pqb}return this.d$c}static get instance(){oi.Va||(oi.Va=new oi);return oi.Va}}oi.Va=null;Object(C.a)(oi,"HammerJsDependencyLoader",null,[810]);var $h;(function(F){F[F.none=-1]="none";F[F.xRc=0]="pinch";F[F.pan=1]="pan";F[F.Wve=2]="swipe"})($h||
($h={}));Object(C.b)("GestureEvent",$h);var nj=a(82);class dj extends nj.a{constructor(F,ua,jb,pc,Vc,pd,gd,Md){super(F,jb,pc,pd);this.dBb=ua;this.dta=gd;this.Z8=Md;this.Tlh=Vc}get shiftKey(){return this.dta}get ctrlKey(){return this.Z8}get clientPoint(){return this.dBb}get gJa(){return this.Tlh}static create(F,ua,jb,pc,Vc,pd){if(jb.rawEvent)if(pd){var gd=jb.rawEvent;gd=new Sys.UI.Point(gd.clientX,gd.clientY)}else gd=nj.a.YQb(jb);else gd=new Sys.UI.Point(jb.clientX,jb.clientY);return new dj(F,gd,ua,
jb,pc,Vc,jb.shiftKey,jb.ctrlKey,pd)}}Object(C.a)(dj,"GestureEventArgs",nj.a,[]);class Ai{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(C.a)(Ai,"GestureManagerData",
null,[]);class ai{}ai.weh=2;ai.xeh=4;ai.yeh=8;ai.zeh=8;Object(C.a)(ai,"HammerConstants",null,[]);var ej=a(108),Wi=a(221),$e=a(172);class uh extends uc.a{constructor(F,ua){super();this.jEa=Ui.a.qDi;this.shd=!!window.PointerEvent;this.b_e=window.hasOwnProperty("ontouchstart");this.gbb=this.FEb=null;this.rka=!1;this.q3=new Ha.a;this.ZEb=new Ha.a;this.Ulh=new Uh.a;this.FDa=null;this.eab=this.fbd=this.DIe=this.K8c=this.efd=this.oWe=this.JIe=this.GGb=!1;this.jEb=-1;this.curRecognizer=this.element=this.handlers=
this.session=this.zkd=null;this.oNa=(jb,pc,Vc)=>{jb=this.$Hf(jb);pc=this.XNi(Vc);Hammer.inputHandler(this,jb,pc);this.rka&&Vc.preventDefault();return this.rka};this.t4a=(jb,pc,Vc)=>{var pd=Vc.rawEvent.pointerType.toString();const gd=Vc.rawEvent.pointerId.toString();if("touch"!==pd)return!1;jb=this.$Hf(jb);if(1!==jb&&!this.q3.kh(gd))return!1;this.JIe&&1===jb&&Vc.rawEvent.isPrimary&&this.q3.count&&(L.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Mpc());this.GGb?this.azh(gd,
pc,Vc):this.q3.ga(gd,Vc);this.efd&&2===jb&&(!this.K8c||this.K8c&&"function"===typeof Vc.rawEvent.getCoalescedEvents)&&(pc=Vc.rawEvent.getCoalescedEvents())&&this.tQf()&&(this.jEb=Math.max(this.jEb,pc.length));this.oWe&&(this.rka=!1);pd=this.WNi(this.q3,Vc,pd);Hammer.inputHandler(this,jb,pd);if(4===jb||8===jb)this.GGb?this.mEg(gd):this.q3.remove(gd),this.q3.count||(this.session=null,this.efd&&-1!==this.jEb&&(L.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.jEb),this.jEb=
-1));this.rka&&Vc.preventDefault();return this.rka};this.qPc=()=>!1;this.jk=ej.EventHandlerManager.instance;this.shd?(L.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.FEb=this.t4a,this.gbb=hb.a.sDi):this.b_e?(L.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.FEb=this.oNa,this.gbb=hb.a.Pyb):(L.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.FEb=this.qPc,this.gbb=hb.a.rDi);this.Io=ua;this.$ra=F;xa.AFrameworkApplication.fa&&(this.GGb=xa.AFrameworkApplication.fa.ka("UsePointerCaptureIsEnabled"),
this.JIe=xa.AFrameworkApplication.fa.ka("ClearCacheOnPrimaryPointerIsEnabled"),this.oWe=xa.AFrameworkApplication.fa.ka("ResetHandledBeforeInputHandlerIsEnabled"),this.efd=xa.AFrameworkApplication.fa.ka("LogCoalescedEventsIsEnabled"),this.K8c=xa.AFrameworkApplication.fa.ka("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.DIe=xa.AFrameworkApplication.fa.ka("CheckIfHammerExistsAfterDownloadIsEnabled"),this.fbd=xa.AFrameworkApplication.fa.ka("HammerJsPerformanceTimersIsEnabled"),this.eab=this.GGb&&
xa.AFrameworkApplication.fa.ka("CancelDragFromGestureInputManagerIsEnabled")&&xa.AFrameworkApplication.fa.ka("UseGestureInputManagerPointerCacheIsEnabled"))}LMi(){return this.shd?0:this.b_e?1:2}Rv(F){super.Rv(F);this.jk.Pxa(this.gbb,F,0,this.FEb)}Iu(F){super.Iu(F);this.jk.ZXa(F,this.gbb)}whk(F,ua,jb){jb=void 0===jb?null:jb;var pc=void 0===pc?null:pc;xa.AFrameworkApplication.UHc()?oi.instance.txj().continueWith(Vc=>{this.AUk();if(Vc.Fm||Vc.mo)L.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",
Vc.status);else{L.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Vc.status);if(this.DIe){Vc=window.Hammer;if("undefined"===typeof Vc){L.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.Y_c();return}if("undefined"===typeof Vc.inputHandler){L.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.Y_c();return}}if(!F)throw this.Y_c(),Error.argumentNull("source element can not be null");Vc=Wi.a.QJa(F,this.jEa);if(void 0===Vc||null===Vc)Vc=new Ha.a,
Wi.a.Hwb(F,this.jEa,Vc),this.xhk(F);var pd=null;if(!Vc.kh($h[0])){pd=Object;var gd=pd.assign,Md=new ji,ze=$h[0],T=pc;T=void 0===T?null:T;if(void 0===this||null===this)throw L.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Za=null;switch(ze){case hb.a.xRc:Za=new Hammer.Pinch(T);break;case hb.a.pan:Za=new Hammer.Pan(T)}Za&&(Za.manager=this);pd=gd.call(pd,Md,{Upa:Za,uDf:ua});Vc.add($h[0],pd)}if(void 0!==jb&&null!==jb)for(gd=0;gd<jb.length;gd++)Vc.kh($h[jb[gd]])&&
(Md=Vc.na($h[jb[gd]]),pd.Upa.recognizeWith(Md.Upa))}this.Y_c()}):L.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}AUk(){this.fbd&&(this.Io?this.zkd=this.Io.Li("Task","RegisterGestureAdapterAfterLoad"):L.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}Y_c(){this.fbd&&(this.zkd?this.zkd.stop():L.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}xhk(F){this.Ulh.add(F);this.jk.Pxa(this.gbb,
F,0,this.FEb)}recognize(F){var ua=Array(F.pointers.length);for(var jb=0;jb<F.pointers.length;jb++)ua[jb]=F.pointers[jb].target;jb=null;for(this.FDa=this.xPi(ua);void 0!==this.FDa&&null!==this.FDa&&(jb=Wi.a.QJa(this.FDa,this.jEa),void 0===jb||null===jb);this.FDa=this.FDa.parentNode);if(void 0!==jb&&null!==jb){this.curRecognizer&&this.curRecognizer.state===ai.zeh&&(this.curRecognizer=null);ua=jb.keys;for(const pc of ua){ua=jb.na(pc);void 0!==ua&&null!==ua&&void 0!==ua.Upa&&null!==ua.Upa&&(void 0===
this.curRecognizer||null===this.curRecognizer||ua.Upa===this.curRecognizer||ua.Upa.canRecognizeWith(this.curRecognizer))&&ua.Upa.recognize(F);const Vc=ua.Upa.state;this.curRecognizer||ai.weh!==Vc&&ai.xeh!==Vc&&ai.yeh!==Vc||(this.curRecognizer=ua.Upa)}}}emit(F,ua){if("hammer.input"!==F){this.rka=!1;ua=dj.create(F,this.FDa,ua.srcEvent,ua,3,this.shd);var jb=Wi.a.QJa(this.FDa,this.jEa);if(this.Hoj(F))var pc=0;else if(this.soj(F))pc=1;else if(this.Prj(F))pc=2;else{L.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:jb}=jb.wj($h[pc]));void 0!==jb&&null!==jb&&((jb=jb.uDf,jb.ylj())?F.endsWith("start")?this.rka=jb.CSj(ua):F.endsWith("end")?(jb.ASj(ua),this.rka=!0):F.endsWith("cancel")?(jb.zSj(ua),this.rka=!0):F.endsWith("move")&&(this.rka=jb.BSj(ua)):L.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",F))}}get(F){return Object(te.a)(Hammer.Recognizer,F)}xPi(F){if(1>F.length)return null;if(1===F.length)return F[0];var ua=F[0],jb=!0;for(let pc=1;pc<F.length;pc++){if(!F[pc])return null;
if(ua!==F[pc]){jb=!1;break}}if(jb)return ua;ua=this.JDf(F[0]);jb=0;for(const pc of F){F=this.JDf(pc);if(ua.na(ua.count-1)!==F.na(F.count-1))return null;for(let Vc=ua.count-2,pd=F.count-2;Vc>=jb&&0<=pd;Vc--,pd--)if(ua.na(Vc)!==F.na(pd)){jb=Vc+1;break}}return ua.na(jb)}JDf(F){const ua=new Uh.a;for(;void 0!==F&&null!==F;F=F.parentNode)ua.add(F);return ua}$Hf(F){switch(F){case hb.a.Jm:case hb.a.Bua:return 1;case hb.a.Jn:case hb.a.WVa:return 2;case hb.a.ml:case hb.a.FJb:return 4;case hb.a.N1c:case hb.a.ctd:return 8}return 0}tQf(){return 1<
this.q3.count}Mpc(){L.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.GGb)for(const F of this.q3)this.mEg(F.key);else this.q3=new Ha.a;this.session=null}azh(F,ua,jb){L.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",F);if(!this.ZEb.kh(F)){try{ua.setPointerCapture(F)}catch(pc){L.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",pc)}this.ZEb.add(F,ua)}this.q3.ga(F,jb);this.eab&&1<this.q3.count&&this.$ra&&!this.$ra.pKb&&(this.$ra.pKb=!0)}mEg(F){L.ULS.sendTraceTag(594055957,
310,50,"RemovePointerFromCaches: pointerId: {0}",F);if(this.ZEb.kh(F)){try{this.ZEb.na(F).releasePointerCapture(F)}catch(ua){L.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ua)}this.ZEb.remove(F)}else L.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",F);this.q3.remove(F);this.eab&&1>=this.q3.count&&this.$ra&&this.$ra.pKb&&(this.$ra.pKb=!1)}XNi(F){const ua=new Ai;var jb=F.rawEvent;const pc=jb.touches;jb=jb.changedTouches;ua.pointers=Array.clone(pc);
ua.pointers=Array.clone(0<pc.length?pc:jb);ua.changedPointers=Array.clone(jb);ua.srcEvent=F;ua.pointerType="touch";return ua}WNi(F,ua,jb){const pc=new Ai;pc.pointers=$e.toArray(F.values);pc.changedPointers=[ua];pc.pointerType=jb;pc.srcEvent=ua;return pc}Hoj(F){return ea.a.startsWith(F,hb.a.xRc)}soj(F){return ea.a.startsWith(F,hb.a.pan)}Prj(F){return ea.a.startsWith(F,hb.a.Wve)}}Object(C.a)(uh,"GestureInputManager",uc.a,[759,760]);var fj=a(386);class oj{constructor(){this.Vh=null;this.FG=!1}get name(){return"Common.App.GestureInputManager"}$n(F){F.register(uh,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").yi().Ei(()=>new uh(fj.a.instance,xa.AFrameworkApplication.ra.wL));this.Vh=F}init(){this.FG||(kd.a.instance.resolve("Common.App.GestureManager.GestureInputManager"),this.FG=!0)}dispose(){}static main(){pg.a.instance.Do(new oj)}}Object(C.a)(oj,"GestureInputManagerPackage",null,[12,13]);const Xi=()=>kd.a.instance.Ho("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");var si=a(113);class nf extends si.a{constructor(){super()}static instance(){return nf.Va||
(nf.Va=new nf)}}nf.Z_j="OnTextSelectionHighlightChangeEvent";nf.Va=null;Object(C.a)(nf,"TextSelectionHighlightChangeEvent",si.a,[]);class gj extends Hc.a{constructor(F,ua){super(!1,!1,!0);this.D5b=(jb,pc)=>{1===jb&&(this.yRa.eSd=pc.tooltipPersistenceEnabled,jb=pc.textSelectionChangeEnabled,this.yRa.f$b!==jb&&this.quh.raiseEvent(nf.Z_j),this.yRa.f$b=jb)};this.yRa=F;this.quh=ua}start(){const F={["tooltipPersistenceEnabled"]:this.yRa.eSd};F.textSelectionChangeEnabled=this.yRa.f$b;this.initializeAndShow("",
this.D5b,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:F});L.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(C.a)(gj,"AccessibilitySettingsDialog",Hc.a,[]);var Bi=a(136),sj=a(26);class yg{constructor(F,ua){this.HNk=()=>{(new gj(this.yRa,nf.instance())).start();return 32};this.$f=F;this.yRa=ua}ho(){this.$f.Uh(sj.a.GNk,Bi.a.frame,this.HNk)}}Object(C.a)(yg,"AccessibilitySettingsDialogActor",null,[767]);const ti=F=>{const ua=new Cc.a;xa.AFrameworkApplication.sj.lv(Dg(F),
1,null,null,!0,2,jb=>{200===jb.data.httpStatus?ua.setResult("true"===jb.data.responseData.toLowerCase()):ua.setResult(!1)},()=>{ua.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ua.task},hj=(F,ua)=>{xa.AFrameworkApplication.sj.lv(Dg(F),2,ua.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Dg=F=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",xa.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",F,xa.AFrameworkApplication.Jo);
var Dh=a(117);class Li{constructor(){this.rdb=this.pbb=null}get eSd(){return!!this.pbb}set eSd(F){F!==this.pbb&&(this.pbb=F,Dh.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(F),this.TIc()&&hj("saveHoverableRibbonTooltipIsEnabled",F))}get f$b(){return!!this.rdb}set f$b(F){F!==this.rdb&&(this.rdb=F,this.TIc()&&hj("saveTextSelectionHighlightChangeIsEnabled",F))}Bxj(){const F=new Cc.a;if(this.pbb)F.setResult(this.pbb);else if(this.TIc()){const ua=ti("getHoverableRibbonTooltipIsEnabled");
ua.continueWith(()=>{this.pbb=ua.result;Dh.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ua.result);F.setResult(ua.result)},8)}else F.setResult(!1)}$xj(){const F=new Cc.a;if(this.rdb)F.setResult(this.rdb);else if(this.TIc()){const ua=ti("getTextSelectionHighlightChangeIsEnabled");ua.continueWith(()=>{this.rdb=ua.result;F.setResult(ua.result)},8)}else F.setResult(!1)}TIc(){const F=xa.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),ua=xa.AFrameworkApplication.fa.ka("IsAnonymousUser");
return F&&!ua}}Object(C.a)(Li,"AccessibilitySettingsInfo",null,[766]);var Ci=a(102);class Mi{constructor(){this.Vh=null}get name(){return"Common.App.AccessibilitySettings"}$n(F){this.Vh=F;this.Vh.register(Li,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ei(()=>new Li).yi();this.Vh.register(yg,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ei(()=>
new yg(xa.AFrameworkApplication.yh,Xi())).yi()}init(){const F=Xi(),ua=kd.a.instance.Ho("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");F&&ua?(ua.ho(),F.Bxj(),F.$xj(),Ci.a(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",F.f$b)):Ci.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){pg.a.instance.Do(new Mi)}}Object(C.a)(Mi,"AccessibilitySettingsPackage",
null,[12,13]);class Nh extends Hc.a{constructor(F,ua){super(!1,!1,!0);this.D5b=(jb,pc)=>{if(1===jb){jb=pc.showRibbonChoice;if(this.EWe!==pc.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.vYe!==jb&&("AlwaysShow"===jb?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.EWe=F;this.vYe=ua}start(){this.initializeAndShow("",this.D5b,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.EWe,["showRibbonChoice"]:this.vYe}})}}Object(C.a)(Nh,
"RibbonSettingsDialog",Hc.a,[]);class pi{constructor(F){this.$f=F}ho(){this.$f.Uh(sj.a.zQk,Bi.a.frame,this.AQk)}AQk(){let F="SingleLineRibbon";"Multiline"===appChrome.selectors.getRibbonMode()&&(F="ClassicRibbon");const ua=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new Nh(F,ua)).start();return 32}}Object(C.a)(pi,"RibbonSettingsDialogActor",null,[758]);class bi{constructor(){this.Vh=null}get name(){return"Common.App.RibbonSettings"}$n(F){this.Vh=F;this.Vh.register(pi,
"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").Ei(()=>new pi(xa.AFrameworkApplication.yh)).yi()}init(){const F=kd.a.instance.Ho("Common.App.RibbonSettings.IRibbonSettingsDialogActor");F?F.ho():Ci.a(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){pg.a.instance.Do(new bi)}}Object(C.a)(bi,"RibbonSettingsPackage",null,[12,13]);class Oh extends zg.a{constructor(F){super();
this.$=F;this.gm()}create(){const F=Object(rb.d)(za.a.resolve(qa.pd,{va:this.xh}));Ab.TaskExtensions.Xa(Ab.TaskExtensions.Wo([F],this.$.ya),()=>{this.Bk(this.$.la.lh(211)||new Ua(this.$,F.result,this.$.pK,this.$.Cl))},this.ya,3)}static Ba(F){F.la.Hh(212,new Oh(F))}}Object(C.a)(Oh,"AriaLiveNotifierFactory",zg.a,[]);var Ah=a(598),qi=a(1269),P=a(1417);class pa extends P.a{constructor(){super();this.Akd=this.XEb=null;this.state=0;this.zcd=this.iOe=!1}get gZ(){return this.XEb}get RBa(){return this.Akd}get Iej(){return this.iOe}bLf(){return"GetMoreInfo Result"}}
Object(C.a)(pa,"GetMoreInfoResult",P.a,[842,435]);var Wa=a(1126),Sb=a(124);class ec{constructor(F,ua,jb){this.cjc=this.zq=null;this.Eid=0;this.vsh=F;this.Fk=ua;this.kKe=jb}hGh(){this.Eid=this.Cvb+1}mle(F){this.zq&&(this.Fk.Kx(this.zq),this.zq=null);F&&(this.Eid=0)}rUk(F){const ua=this.KZk;0<=ua?(this.hGh(),this.mle(!1),this.zq=new Sb.a(4,1,ua,F,107),this.Fk.wm(this.zq)):(this.mle(!0),L.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.kKe}))}get Cvb(){return this.Eid}get KZk(){return this.Cvb>=
this.DNg.length?-1:this.DNg[this.Cvb]}get DNg(){if(!this.cjc){const F=(this.vsh.value||"0").split(",");this.cjc=[];for(let ua=0;ua<F.length;ua++){const jb=parseInt(F[ua]);isNaN(jb)?L.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.kKe,["Entry"]:F[ua]}):Array.add(this.cjc,jb)}}return this.cjc}}Object(C.a)(ec,"RetryHelper",null,[]);class Jc extends qi.a{constructor(F,ua){super();this.Qda=F;this.zFb=new ec(ua,this.j_b.tNc,"GetMoreInfo");this.Wz=
new pa}rDj(){this.F4d("Document opened")}s7h(F){return()=>{this.F4d(F,!0)}}wpg(F,ua){ua=void 0===ua?null:ua;L.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:F});3===this.Wz.state?(ua&&this.Rsf(ua,this.Wz),L.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:F})):this.F4d(F);return this.Wz}F4d(F,ua){this.zFb.mle(!(void 0===ua?0:ua));1===this.Wz.state?L.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
{["Trigger"]:F,["RetryIndex"]:this.zFb.Cvb}):(L.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:F,["RetryIndex"]:this.zFb.Cvb}),this.Wz.state=1,ua=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.j_b.w1,xa.AFrameworkApplication.Jo),this.j_b.vrb.uea(ua,1,null,null,[Jc.SUe,Jc.aZe],!1,5,this.w6h(),this.v6h(F),null))}w6h(){return F=>{var ua=!1;let jb=!1;var pc=!1,Vc;if(xa.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody"))if(F.data.responseData){let pd=fh.d(F.data.responseData);
({wz:Vc}=pd);pd.returnValue?Vc?(pc=!0,this.Wz.Akd=Vc.StorageServiceDisplayName,this.Wz.XEb=Jc.i4f(Vc.PersonalFileStorageUrl)?Vc.PersonalFileStorageUrl:"",""===this.Wz.gZ&&"SharePointOnlineConsumer"===xa.AFrameworkApplication.fa.Za("FileSource")&&(this.Wz.XEb=cd.a.fca(xa.AFrameworkApplication.breadcrumbFolderUrl)),ua=""===this.Wz.gZ&&""!==this.Wz.RBa):L.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
L.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else L.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");pc||((Vc=F.data.responseHeaders)?(this.Wz.Akd=(Vc[Jc.aZe]||"").toString(),ua=(Vc[Jc.SUe]||"").toString(),this.Wz.XEb=Jc.i4f(ua)?ua:"",""===this.Wz.gZ&&"SharePointOnlineConsumer"===xa.AFrameworkApplication.fa.Za("FileSource")?
(this.Wz.XEb=cd.a.fca(xa.AFrameworkApplication.breadcrumbFolderUrl),ua=""===this.Wz.gZ&&""!==this.Wz.RBa):ua=""===ua&&""!==this.Wz.RBa):(L.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),jb=!0));pc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.zFb.Cvb,jb,ua,pc);this.j_b.Qoa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",F.data,pc);this.SNg(3,ua,jb)}}v6h(F){return ua=>{this.j_b.Qoa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
ua.data,"Failure");this.SNg(2);this.zFb.rUk(this.s7h(F))}}SNg(F,ua,jb){this.Wz.state=F;this.Wz.iOe=void 0===ua?!1:ua;this.Wz.zcd=void 0===jb?!1:jb;this.vDd(this.Wz)}get j_b(){return this.Qda.value}static get instance(){return Jc.Va||(Jc.Va=Jc.dY())}static dY(){return new Jc(new Ah.a(()=>Wa.a.instance),new Ah.a(()=>xa.AFrameworkApplication.gQi))}static i4f(F){if(!F)return L.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(ea.a.Xs(F).startsWith("https://"))return!0;
L.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Jc.SUe="PersonalFileStorageUrl";Jc.aZe="StorageServiceDisplayName";Jc.Va=null;Object(C.a)(Jc,"GetMoreInfoActor",qi.a,[]);class td{constructor(F,ua,jb,pc,Vc){this.Zmh=6E4;this.$Tf="inactive";this.b1e="active";this.UJ=!0;this.Fk=F;this.amh=ua;this.Vad=jb;this.gkc=pc;this.hh=new si.a;Vc&&this.gUk();this.rQe=this.sIf()}V1e(F){this.hh.addHandler(this.b1e,F)}Zyh(F){this.hh.addHandler(this.$Tf,F)}gUk(){const F=new Sb.a(5,2,this.Zmh,
Object(gg.a)(this,this.P9i,"inactiveLoop"),108);this.Q9i.wm(F)}P9i(){const F=this.sIf(),ua=this.SF()-F;ua>this.r1c&&this.UJ&&(L.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ua}),this.UJ=!1,this.hh.raiseEvent(this.$Tf));F-this.rQe>this.r1c&&(this.UJ=!0,this.hh.raiseEvent(this.b1e));this.rQe=F}get Q9i(){return this.Fk.value}get sIf(){return this.amh}get SF(){return this.Vad}get r1c(){return this.gkc.value}static get instance(){return td.Va||(td.Va=td.dY())}static dY(){return new td(new Ah.a(()=>
ka.TaskManager.instance),()=>xa.AFrameworkApplication.H2a.getTime(),()=>(new Date).getTime(),new Ah.a(()=>xa.AFrameworkApplication.r1c),!0)}}td.Va=null;Object(C.a)(td,"InactivityManager",null,[]);var Jd=a(1392);class le{constructor(){this.FGb=this.UVe=this.Vh=null;this.jv=!1;this.jdi=()=>{ka.TaskManager.instance.Kx(this.Fdg)};this.y2e=()=>{ka.TaskManager.instance.wm(this.Fdg)}}get name(){return"Common.App.NewAndOpen.Core"}$n(F){this.Vh=F;F.register(433,"Common.INewAndOpenCommonHelpers").yi().Ei(()=>
Wa.a.instance);F.register(436,"Common.IEventEmitter<Common.IGetMoreInfoResult>").yi().Ei(()=>Jc.instance);F.register(436,"Common.IEventEmitter<Common.IMruResult>").yi().Ei(()=>Jd.a.instance)}init(){xa.AFrameworkApplication.fa.Tx(()=>{this.oUb()})}oUb(){kd.a.instance.resolve("Common.INewAndOpenCommonHelpers");kd.a.instance.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");kd.a.instance.resolve("Common.IEventEmitter<Common.IMruResult>");var F=!1;Wa.a.instance.bhk();xa.AFrameworkApplication.hN&&
(F=!0);xa.AFrameworkApplication.ZAg&&(Jd.a.instance.tDj(),0<xa.AFrameworkApplication.Edg&&this.y2e(),this.sIk(),F=!0);xa.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&F&&Jc.instance.rDj();xa.AFrameworkApplication.H8k&&(F=Jd.a.instance,F.Zik(),F.CDj(),ka.TaskManager.instance.wm(this.I8k))}sIk(){td.instance.V1e(Object(gg.a)(Jd.a.instance,Jd.a.instance.sDj,"makeGetMruRequestActivityTrigger"));td.instance.V1e(this.y2e);td.instance.Zyh(this.jdi)}get Fdg(){return this.UVe||(this.UVe=new Sb.a(5,
2,xa.AFrameworkApplication.Edg,Object(gg.a)(Jd.a.instance,Jd.a.instance.qQi,"getMruFromServerTask"),109))}get I8k(){return this.FGb||(this.FGb=new Sb.a(2,2,6E4*xa.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(gg.a)(Jd.a.instance,Jd.a.instance.DDj,"makeUpdateMruTask"),197))}dispose(){this.jv||(this.jv=!0,this.FGb&&(ka.TaskManager.instance.Kx(this.FGb),this.FGb=null))}}Object(C.a)(le,"CorePackageManager",null,[12,13,2]);var Be=a(968);
class Te{constructor(F,ua){this.Njd=this.Mjd=null;this.cdb=new Cc.a;this.x1b=jb=>{let pc=null;pc&&pc.length||!jb||!jb.data||(pc=jb.data.responseData);if(pc&&pc.length)try{const Vc=fh.a(pc);this.Mjd=Vc.NavBarDataJson;L.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.Mjd?(()=>{let pd=fh.d(Vc.NavBarDataJson);({wz:this.Njd}=pd);return pd})().returnValue?(this.vAj(this.Njd),this.cdb.setResult(this.Njd)):(L.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",
{["ShellData"]:Be.a.D9a(this.Mjd)}),this.cdb.XC()):(L.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.cdb.XC())}catch(Vc){L.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.cdb.XC()}else L.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.F0b=()=>{this.cdb.XC();L.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Yn=F;this.Yka=ua.appSettings[Te.Wdl]||""}get KJk(){return this.cdb.task}get Ula(){return this.Yn.value}rrk(){const F=
{};F[Te.C5i]=xa.AFrameworkApplication.Jo;F["Content-Type"]="application/json; charset=utf-8";L.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ua=cd.a.Gr(this.Yka+Te.LJk,Te.gMj,xa.AFrameworkApplication.ra.$g.kn.toString());this.Ula.lv(ua,1,"",F,!0,2,this.x1b,this.F0b,null,void 0,void 0,void 0,void 0,"20")}vAj(F){try{const ua={};ua.FlightName=F.FlightName;ua.SessionID=F.SessionID;L.ULS.sendTraceTag(594883776,215,50,fh.c(ua))}catch(ua){L.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}static get instance(){return Te.Va||(Te.Va=Te.rZa())}static rZa(){return new Te(new Ah.a(()=>xa.AFrameworkApplication.sj),xa.AFrameworkApplication.fa,xa.AFrameworkApplication.ra.$g.kn)}}Te.C5i="X-qs";Te.gMj="at";Te.LJk="O365ShellServiceProxy.ashx";Te.Va=null;Te.Wdl="ShellWebServiceBase";Object(C.a)(Te,"O365ShellActor",null,[752]);class kf{constructor(){this.Vh=null;this.WK=()=>{xa.AFrameworkApplication.useO365ShellService&&xa.AFrameworkApplication.ra.$g.Bw&&kd.a.instance.resolve("Common.App.O365Shell.O365ShellActor").rrk()}}get name(){return"Common.App.O365Shell"}$n(F){this.Vh=
F;this.Vh.register(Te,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").yi().Ei(()=>new Te(new Ah.a(()=>xa.AFrameworkApplication.sj),xa.AFrameworkApplication.fa,xa.AFrameworkApplication.ra.$g.kn))}init(){xa.AFrameworkApplication.fa.Tx(this.WK)}dispose(){}static main(){pg.a.instance.Do(new kf)}}Object(C.a)(kf,"PackageManager",null,[12,13]);class yf extends zg.a{constructor(F,ua){super();this.activityName=F;this.vU=ua;this.gm()}create(){this.Bk(new ta(this.activityName,
this.vU,Fa.a.WG,Fa.a.Sp,Fa.a.Nyb))}static Ba(F){F.la.Hh(143,new yf(Fa.a.zqa,Fa.a.zfb));F.la.Hh(144,new yf(Fa.a.R6b,Fa.a.xNa));F.la.Hh(145,new yf(Fa.a.S6b,Fa.a.AQc));F.la.Hh(154,new yf(Fa.a.mPa,Fa.a.xW))}}Object(C.a)(yf,"SessionReloadSilentActivityFactory",zg.a,[]);var Zf=a(285),kg=a(145),Bg=a(1057);class Ng{constructor(F){this.V$f=F}get name(){return"CopilotBootVisibilityCheck"}$n(){}init(){const F=ua=>{const jb=this;return Lo(function*(){var pc=Date.now();const Vc=yield ua.isFeatureEnabled("Copilot",
!1);pc=Date.now()-pc;L.ULS.sendTraceTag(507839317,3050,50,"[Copilot Chat] Early call to Copilot license check latency: "+pc);xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)&&Object(Bg.b)(jb.V$f,Vc);kg.a.get_instance().Qm(10,()=>{Dh.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(jb.V$f,!Vc)),L.ULS.sendTraceTag(507839316,306,50,"Copilot Chat visibility marked early"))})})};xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",
!1)?xa.AFrameworkApplication.fa.Tx(()=>F(Object(Wg.a)())):Object(Zf.a)().execute(F)}dispose(){}}Object(C.a)(Ng,"CopilotBootVisibilityCheck",null,[12,13]);(()=>{var F;null!==(F=xa.AFrameworkApplication.fa)&&void 0!==F&&F.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DemandLoadApplicationFeatureHelper",!1)||(Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Fg.main())})();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
(()=>{kh.a.gh(F=>{dh.Ba(F)})})();ni.a.yw(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Type.registerNamespace("Common.App.GestureManager");oj.main();Type.registerNamespace("Common.App.AccessibilitySettings");Mi.main();Type.registerNamespace("Common.App.RibbonSettings");bi.main();(()=>{kh.a.gh(F=>{ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||Oh.Ba(F)})})();ni.a.yw(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(1px + 4px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:calc(-1px - 2px/var(--zoom-level-canvas,1));height:calc(1px + 2px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-left{top:0;left:calc(-1px - 1px/var(--zoom-level-canvas,1));bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-left:1.5px solid transparent}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-right:1.5px solid transparent}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-drag-tooltip-fluent{position:absolute;background-color:#fff;box-shadow:0 0 2px 0 #0000001f,0 4px 8px 0 #00000024;outline:1px solid transparent;border-radius:4px;height:fit-content;width:max-content;font-size:10px;padding:4px 8px 6px 8px}.ewr-selection-drag-tooltip-shift-instruction{font-style:italic;color:#8a8886}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right-enhanced,.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left-enhanced,.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px/var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107c41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107c41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107c41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107c41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr_selection_rearrange-flange-left,.ewr_selection_rearrange-fullrowcol-flange-left{border-left:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;left:-2px;top:-3.5px}.ewr_selection_rearrange-flange-right,.ewr_selection_rearrange-fullrowcol-flange-right{border-right:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;right:-5px;top:-3.5px}.ewr_selection_rearrange-flange-top,.ewr_selection_rearrange-fullrowcol-flange-top{border-top:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;top:-2px;left:-3.5px}.ewr_selection_rearrange-flange-bottom,.ewr_selection_rearrange-fullrowcol-flange-bottom{border-bottom:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;bottom:-5px;left:-3.5px}.ewr_selection_rearrange-fullrowcol-flange-left{left:0}.ewr_selection_rearrange-fullrowcol-flange-right{right:-3px}.ewr_selection_rearrange-fullrowcol-flange-top{top:0}.ewr_selection_rearrange-fullrowcol-flange-bottom{bottom:-3px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-drag-shadow{position:absolute;top:0;background-color:#107c41;opacity:15%;z-index:52;pointer-events:none;border-radius:2px}.ewa-grid-ltr .ewr-selection-drag-shadow{left:0}.ewa-grid-rtl .ewr-selection-drag-shadow{right:0}@media(forced-colors:active){.ewr-selection-drag-shadow{forced-color-adjust:none;background-color:#fff;opacity:20%}}@media(forced-colors:active) and (prefers-color-scheme:light){.ewr-selection-drag-shadow{background-color:#000}}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107c41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
Type.registerNamespace("Common.App.NewAndOpen.Core");pg.a.instance.Do(new le);Type.registerNamespace("Common.App.O365Shell");kf.main();ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1309);pg.a.instance.Do(new Ng("Copilot"));(()=>{kh.a.gh(F=>{qa.Hf.Aa()||yf.Ba(F)})})();String(n);String(u);String(v);String(w);String(x);String(l);String(y);String(B);String(A);String(E);String(N);String(D);String(U);String(K);String(M);String(O);String(R);String(J);String(aa);
window.___1710439927620_closurehack=n;window.___1710439927620_closurehack=u;window.___1710439927620_closurehack=v;window.___1710439927620_closurehack=w;window.___1710439927620_closurehack=x;window.___1710439927620_closurehack=l;window.___1710439927620_closurehack=y;window.___1710439927620_closurehack=B;window.___1710439927620_closurehack=A;window.___1710439927620_closurehack=E;window.___1710439927620_closurehack=N;window.___1710439927620_closurehack=D;window.___1710439927620_closurehack=U;window.___1710439927620_closurehack=
K;window.___1710439927620_closurehack=M;window.___1710439927620_closurehack=O;window.___1710439927620_closurehack=R;window.___1710439927620_closurehack=J;window.___1710439927620_closurehack=aa}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/7ba8619f6b64e3fb82a71bc1acd6e24a/EwaTS.frs.js.map