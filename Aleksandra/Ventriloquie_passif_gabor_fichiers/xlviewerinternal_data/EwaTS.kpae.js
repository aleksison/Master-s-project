'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1155:function(z,t,a){function c(){return"undefined"===typeof h.globalThis.q6c?r:h.globalThis.q6c()}function b(e,k){var m;return null!==(m=c()[e])&&void 0!==m?m:k}Object.defineProperty(t,"__esModule",{value:!0});t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.BJf=t.getBooleanFeatureGate=t.getStringFeatureGate=t.oRb=void 0;var h=a(1362),r={};t.oRb=c;t.getStringFeatureGate=b;t.getBooleanFeatureGate=function(e,
k){var m;e=null===(m=b(e))||void 0===m?void 0:m.trim().toLowerCase();return"true"===e?!0:"false"===e?!1:k};t.BJf=function(e,k){var m;e=null===(m=b(e))||void 0===m?void 0:m.trim().toLowerCase();if(void 0===e)return k;if("infinity"===e||"+infinity"===e)return Infinity;if("-infinity"===e)return-Infinity;m=parseFloat(e);return isNaN(m)?k:m};t.getIntFeatureGate=function(e,k){var m;e=null===(m=b(e))||void 0===m?void 0:m.trim();if(void 0===e)return k;m=parseInt(e,10);return isNaN(m)?k:m};t.setFeatureGateDictionaryGetter=
function(e){var k=h.globalThis.q6c;h.globalThis.q6c=e;return k}},1156:function(z,t,a){function c(){return"undefined"===typeof b.globalThis.p6c?{}:b.globalThis.p6c()}Object.defineProperty(t,"__esModule",{value:!0});t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.Dzc=void 0;var b=a(1362);t.Dzc=c;t.isChangeGateEnabled=function(h){var r;return null!==(r=c()[h])&&void 0!==r?r:!0};t.setChangeGateDictionaryGetter=function(h){var r=b.globalThis.p6c;b.globalThis.p6c=h;return r}},1362:function(z,t,
a){Object.defineProperty(t,"__esModule",{value:!0});t.globalThis=void 0;z=a(1499);t.globalThis=z},1498:function(z,t,a){Object.defineProperty(t,"__esModule",{value:!0});var c=a(135);c.__exportStar(a(1155),t);c.__exportStar(a(1502),t);c.__exportStar(a(1156),t);c.__exportStar(a(1503),t);c.__exportStar(a(1504),t);c.__exportStar(a(1505),t)},1499:function(z,t,a){z.exports=a(1500)()?globalThis:a(1501)},1500:function(z){z.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===
Array:!1}},1501:function(z){function t(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}z.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(a){return t()}try{return __global__?__global__:t()}finally{delete Object.prototype.ckl}}()},1502:function(z,t,a){Object.defineProperty(t,"__esModule",{value:!0});t.uDj=
void 0;var c=a(1155);t.uDj=function(b){return function(h){var r=b[h];switch(typeof r){case "boolean":return(0,c.getBooleanFeatureGate)(h,r);case "number":return(0,c.BJf)(h,r);case "string":return(0,c.getStringFeatureGate)(h,r);default:throw Error("Wrong defaultValue type");}}}},1503:function(z,t,a){Object.defineProperty(t,"__esModule",{value:!0});t.BDj=void 0;var c=a(1156);t.BDj=function(){return function(b){return(0,c.isChangeGateEnabled)(b)}}},1504:function(z,t,a){function c(r){var e=(0,h.setChangeGateDictionaryGetter)(void 0);
(0,h.setChangeGateDictionaryGetter)(function(){var k=void 0!==e?e():{};return b.__assign(b.__assign({},k),r)});return e}Object.defineProperty(t,"__esModule",{value:!0});t.l3j=t.d3j=void 0;var b=a(135),h=a(1156);t.d3j=c;t.l3j=function(r,e){return c(e)}},1505:function(z,t,a){function c(r){function e(){return{}}for(var k,m,x={},n=0,u=Object.keys(r);n<u.length;n++){var v=u[n];x[v]=null===(k=r[v])||void 0===k?void 0:k.toString()}var w=null!==(m=(0,h.setFeatureGateDictionaryGetter)(void 0))&&void 0!==m?
m:e;(0,h.setFeatureGateDictionaryGetter)(function(){return b.__assign(b.__assign({},w()),x)});return w}Object.defineProperty(t,"__esModule",{value:!0});t.m3j=t.i3j=void 0;var b=a(135),h=a(1155);t.i3j=c;t.m3j=function(r,e){return c(e)}},213:function(z,t,a){function c(sb){if(window&&window.performance&&window.performance.mark)try{window.performance.mark(sb)}catch(lc){}}function b(){return{show:{count:0,repairCounts:[]},hideDurations:{escape:[],ignore:[],selection:[],edit:[],commit:[],scroll:[]}}}a.r(t);
var h={};a.r(h);a.d(h,"AutoSumCommandHandler",function(){return qa});var r={};a.r(r);a.d(r,"CellImageToFloatingObjectController",function(){return mb});var e={};a.r(e);a.d(e,"ClearCommandHandler",function(){return bc});var k={};a.r(k);a.d(k,"ClearContentNotifier",function(){return ad});var m={};a.r(m);a.d(m,"DefinedNameManager",function(){return Aa});var x={};a.r(x);a.d(x,"FileCollectionOperation",function(){return hc});var n={};a.r(n);a.d(n,"FloatingObjectToCellImageController",function(){return yd});
var u={};a.r(u);a.d(u,"FontDropdownHelper",function(){return $c});var v={};a.r(v);a.d(v,"FormatCellsCommandHandler",function(){return $a});var w={};a.r(w);a.d(w,"FormulaAnonymizer",function(){return Wb});var l={};a.r(l);var y={};a.r(y);a.d(y,"FormulaRepairTelemetry",function(){return Bc});var B={};a.r(B);a.d(B,"FreezePanesDragDirection",function(){return pf});a.d(B,"FreezePaneDragOrigin",function(){return qf});a.d(B,"FreezePaneDragAction",function(){return of});var A={};a.r(A);a.d(A,"FreezePanesCommandHandler",
function(){return Ub});var E={};a.r(E);a.d(E,"HeaderInsert",function(){return kd});var N={};a.r(N);a.d(N,"ImageInCellCommandHandler",function(){return zc});var D={};a.r(D);a.d(D,"NameManagerCommandHandler",function(){return Le});var U={};a.r(U);a.d(U,"OfficePyUXCommandHandler",function(){return cd});var K=a(135),M=a(0),O=a(15),R=a(261),J=a(233),aa=a(64);const S=(sb,lc,Uc,od,sd,be)=>{if(lc){const Ee=sb.Wa;sb.isEditing||sb.startEdit(lc,!0);sb.sYd=!0;sb.text=Uc;Ee.caretPosition=sd;sd<be&&(od&&sb.VPa(),
Ee.selectRange(0,be+1),Ee.selectRange(sd,be))}};var C=a(65);class L{constructor(sb,lc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=sb;this.type=lc}Hlb(){return this.sharedSheetRange}}Object(M.a)(L,"MacroRecorderAutoSumPayload",null,[146]);var V=a(46),X=a(427),la=a(216),Va=a(77),na=a(39),db=a(359),ja=a(36),ea=a(1),Z=a(211),ba=a(264),ya=a(23),Qa=a(143),va=a(665),Ia=a(67),Sa=a(5),Xa=a(95),da=a(91),Ea=a(27);let qa=class extends J.a{constructor(sb){super();this.r2j={[-134268171]:"+",[406756244]:"-",
[1405397228]:"*",[-264074569]:"/"};this.xNj=lc=>{const Uc=ya.f(this.$);if(lc=lc.Result){let od=V.H(lc.NewSelection),sd=V.H(lc.NewActiveCell);if(od&&sd)if(!lc.Committed&&lc.AutoSumFormula){const be=Uc.zh(sd);be&&(Uc.ha.updateSelection(od,sd,60),od=sd=V.H(lc.MarkedArea),Uc.xM=2,S(Uc.cellTextEditBox,be,lc.AutoSumFormula,!!od,lc.FormulaMarkStart,lc.FormulaMarkEnd),od&&sd&&Uc.ha.updateSelection(od,sd,0),na.TaskExtensions.Xa(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?Object(da.d)(Xa.a.resolve(Sa.l,{va:0})):Va.GetServiceTaskFactory.Tj(this.$.la,211,212,0),Ee=>{Ee.result.$ba(Uc.cellTextEditBox.text)},this.$.ya,3),Uc.cellTextEditBox.sYd=!1,void Xa.a.resolve(Sa.Wc,{va:0}).then(Ee=>{Ee.mjb(null)}))}else Uc.ha.updateSelection(od,sd,60)}};this.$=sb}Ri(){return!1}executeCommand(sb,lc,Uc){sb=lc.command;switch(sb){case 1220954656:case 505713221:lc=this.Eqf(0,lc);break;case -1537138325:lc=this.Eqf(parseInt(Uc[C.a.Qi].toString(),10),lc);break;case -134268171:case 406756244:case 1405397228:case -264074569:lc=
this.v1i(lc);break;default:lc=Z.a(sb)}return lc}Gi(sb,lc){if(sb=1===sb)switch(lc.command){case 1220954656:case 505713221:case -1537138325:break;case -134268171:case 406756244:case 1405397228:case -264074569:sb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BasicArithmeticOperations",!1);break;default:sb=!1}return sb}dj(){return!1}d4h(sb,lc){const Uc=sb.ha.qa.activeCell;var od=3<=Uc.top?1:-1;const sd=Ie=>new Ea.Range(Uc.top-Ie,Uc.left,Uc.bottom-Ie,Uc.right,!0,!0),[be,Ee]=[sd(od),sd(2*
od)];lc=`=${Ee} ${lc} `;od=sb.Fh;sb.startEdit(!0,1);od.text=`${lc}`;od.Wa.Bwb(lc.length);od.Wa.caretPosition=lc.length;sb.ha.updateSelection(be,Uc,60)}v1i(sb){const lc=ya.f(this.$),Uc=this.r2j[sb.command];return Uc?R.a.Ua(Xa.a.resolve(Sa.Ec,{va:0}).then(()=>{this.d4h(lc,Uc);return!0}).catch(od=>{O.ULS.sendTraceTag(507381573,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Error occurred while resolving FormulaAssistanceManagerService: ${od}`);return!1})):(O.ULS.sendTraceTag(507388317,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Unhandled command ${sb.command}`),
R.a.Ua(!1))}Eqf(sb,lc){const Uc=ya.f(this.$);Uc.co.lU(!1);if(!ya.f(this.$).ha.qa.Bn)return lc=ya.f(this.$).ha.qa.vS,O.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${sb} due to discontinuous selection. Number of selected ranges is ${lc}`),this.ONa(),Ia.Task.Ua(!1);const od=Uc.AK();if(!od)return null;const sd=V.x(Uc.ha.qa.jj,this.$),be=V.q(Uc.ha.qa.activeCell,this.$),Ee=V.q(od,this.$),Ie=this.$.pa.ta.Wh(),bf=()=>new L(sd,sb);return this.$.qy(Uc.ha.qa.selectedRanges,
!0)?X.a(this.$.userOperationManager,(Xe,Ze,tf)=>{var ff=this.$.pa.ta;Xe=ba.c(Xe,this.xNj);const ef=ff.$a(9,Ie);ef.selectedRange=sd;ef.activeCell=be;ef.autoSumType=sb;ef.topLeftCell=Ee;return aa.h(ff,"AutoSum",ef,Xe,Ze,tf,sb,0)},Xe=>new la.a(502,0,Xe,64,bf),lc):Ia.Task.Ua(!1)}ONa(){va.a(Qa.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);const sb=ja.a.nj(1,1,751,2192,0,371863010,"DiscontinuousSelectionBlocking");new db.a(this.$,sb)}};qa=Object(K.__decorate)([Object(Xa.d)(Sa.t),Object(K.__param)(0,
Object(Sa.Nb)())],qa);Object(M.a)(qa,"AutoSumCommandHandler",J.a,[43]);var za=a(78),ma=a(773),Da=a(181),Ua=a(35),ka=a(922),xa=a(12),Fb=a(83),bb=a(126),Ja=a(139);let mb=class extends za.a{constructor(sb,lc,Uc,od){super();this.vj=()=>{this.button.getButton(this.da.fh.Lo(this.da.ha.qa.activeCell)).wtb();Da.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:bb.a.Pm({["buttonType"]:"CellImageToFloatingObject"})});const sd=new Fb.a(2000316912,C.a.rh,this.$.ii,9,null);this.$.Ma.qh(sd,
null)};this.sm=()=>{this.Bca()};this.mq=()=>{this.Bca()};this.QE=()=>{this.Bca()};this.Qy=()=>{this.Bca()};this.Cn=()=>{this.jY()};this.Tu=()=>{this.jY()};this.EA=()=>{this.Bca()};this.$=sb;this.button=Uc.wMb(sb,lc,this.vj,null,null,xa.a.instance.ia(2318),"CellImageToFloatingObjectPointerDown");this.isVisible=!1;this.da=ya.f(this.$);this.da.ha.oX(this.sm);this.da.Fh.iO(this.Cn);this.da.aA(this.QE);this.$.xI(this.mq);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
this.$.ea.cK(this.EA);this.da.view.lz(this.Qy);this.da.ha.$e.jO(this.Tu);this.ariaLiveNotifier=od}dispose(){this.da&&(this.da.ha.oZ(this.sm),this.da.view.Yx(this.Qy),this.da.$E(this.QE),this.da.ha.$e.NV(this.Tu),this.da.Fh&&this.da.Fh.qN(this.Cn));this.$&&(this.$.fL(this.mq),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.XH(this.EA));this.button.dispose();this.ariaLiveNotifier=this.$=this.da=this.button=null;super.dispose()}umd(){this.isVisible&&this.vj(null,
null)}Bca(){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.jY();else{ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8478102_HideOOUIOnFloatingObjectSelected")&&this.da.ha.$e.isFloatingObjectSelected&&this.jY();var sb=this.da.ha.qa.activeCell;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){var lc=new Ja.a(this.$.sa);if(lc&&lc.wn&&(lc.D2f(sb,this.da)||!lc.Wj(1))){this.jY();return}}lc=this.da.za.Mx(sb);
null!=lc&&lc.I_a?this.Lqa(sb):this.jY()}}Lqa(sb){const lc=this.da.fh.Lo(sb);sb=this.da.yl(sb,lc);const Uc=this.da.sl(lc).Vr;var od=this.da.ha.qa.activeCell;if(!(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8352188_DisableInCellOOUIForFormulaBasedImage")&&od&&this.da.oh.hVb(od)&&this.da.oh.YUd(od)||ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8352225_DisableInCellOOUIForPivotTable")&&this.da.oh.vY(od)))if(1===this.da.ha.Ck&&sb&&sb.Xi(Uc)&&Uc.width>sb.width){od=sb.bottomRight.x+this.IE;let sd=sb.topLeft.y-
this.IE-this.button.buttonWidth;od+this.button.buttonWidth>Uc.bottomRight.x&&(od=sb.topLeft.x-this.IE-this.button.buttonWidth);sd<Uc.topLeft.y+this.IE&&(sd=Uc.topLeft.y+this.IE);this.dv(od,sd,this.da.rtl,lc)}else this.jY()}dv(sb,lc,Uc,od){this.button.m3c(ka.a.oej,xa.a.instance.ia(2318),od);this.button.O2c(xa.a.instance.ia(2318),od);this.button.dv(sb,lc,Uc,od,!1,!0);this.isVisible=!0;this.rHh()}jY(){this.button.hide();this.isVisible=!1}rHh(){let sb;sb=Ua.a.isMac?xa.a.instance.ia(2321):xa.a.instance.ia(2320);
this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.$ba(sb)}get IE(){return this.button.IE}};mb=Object(K.__decorate)([Object(Xa.d)(Sa.N),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(ma.i)()),Object(K.__param)(2,Object(Sa.Qf)()),Object(K.__param)(3,Object(Sa.l)())],mb);Object(M.a)(mb,"CellImageToFloatingObjectController",za.a,[]);var sa=a(189),oa=a(245),cb=a(40),Ka=a(1291),Oa=a(254),gb=a(66);let bc=class extends cb.a{constructor(sb,lc,Uc,od){super();this.$=sb;this.Qj=lc;this.xk=
Uc;this.clearContentNotifier=od;this.KOj=(sd,be)=>{if(!Oa.a(sd)&&be){const Ee=!!sd&&!!sd.RequestTelemetryData;ya.f(this.$).Gk.t1(be.toString(),sd.StateId,Ee?sd.RequestTelemetryData.EcsOperationDuration:0,Ee?sd.RequestTelemetryData.EcsRequestDuration:0,Ee?sd.RequestTelemetryData.WfeRequestDuration:0)}}}Ri(){return!1}executeCommand(sb,lc){sb=lc.command;switch(sb){case -730106152:lc=this.YPd(lc,3);break;case -1228228458:lc=this.YPd(lc,4);break;case -848953656:case 2045211913:if(this.Yoj()){lc=Ia.Task.Ua(!0);
break}lc=this.YPd(lc,1);break;default:lc=Z.a(sb)}return lc}Gi(sb,lc){if(sb=1===sb)switch(lc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:sb=!1}return sb}dj(){return!1}YPd(sb,lc){const Uc=ya.f(this.$),od=Uc.ha.qa.selectedRanges,sd=sb.command,be=sa.a.create().toString();if(!this.$.qy(od,!0)&&-730106152!==sd)return Ia.Task.Ua(!0);const Ee=V.t(od,this.$);this.nPk(sd,Uc,od,be);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
this.clearContentNotifier.Zbk();const Ie=this.$.pa.ta.Wh({lza:!0,Uxa:1}),bf=()=>new Ka.a(lc,Ee);return X.a(this.$.userOperationManager,(Xe,Ze,tf)=>{this.$.WC();return aa.d(this.$.pa.ta,lc,Ee,!1,ba.c(Xe,this.KOj),Ze,tf,be,Ie)},Xe=>new la.a(508,0,Xe,67,bf),sb)}nPk(sb,lc,Uc,od){if(-848953656!==sb&&2045211913!==sb&&-730106152!==sb&&-1228228458!==sb)O.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${sb}.`);else if(!oa.a.any(Uc,be=>0<lc.getRangeInformation(be).length)){var sd=
oa.a.any(Uc,be=>this.Qj.RZd(be));if(-730106152!==sb&&-1228228458!==sb||!sd)this.NTk(lc,sb,od,Uc),-730106152!==sb&&-1228228458!==sb||this.xk.Nqa(lc,-730106152,{}),-1228228458!==sb&&2045211913!==sb&&-848953656!==sb||this.xk.Ovd(Uc,!0,od),lc.Gk.gT(od,gb.BasicTelemetryCalculator.TR)}}NTk(sb,lc,Uc,od){let sd="";switch(lc){case -1228228458:sd="ClearAll";break;case 2045211913:case -848953656:sd="ClearContent";break;case -730106152:sd="ClearFormat";break;default:O.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${lc}.`)}lc=
od.length;od=V.b(od);sb.Gk.gQ(15,Uc,sd+(", ranges to clear: "+lc+", cells to clear: "+od))}Yoj(){if(ya.f(this.$).ZF){const sb=this.$.la.lh(296);return!!sb&&sb.X4.NK}return!1}};bc=Object(K.__decorate)([Object(Xa.d)(Sa.W),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.vg)()),Object(K.__param)(2,Object(Sa.xc)()),Object(K.__param)(3,Object(Sa.X)())],bc);Object(M.a)(bc,"ClearCommandHandler",cb.a,[43]);var Dc=a(365);let ad=class extends cb.a{uod(sb){this.addHandler("ekcvc",sb)}tUc(sb){this.removeHandler("ekcvc",
sb)}Zbk(){this.raiseEvent("ekcvc",new Dc.a)}};ad=Object(K.__decorate)([Object(Xa.d)(Sa.X)],ad);Object(M.a)(ad,"ClearContentNotifier",cb.a,[357]);var Ac=a(123),mc=a(74),Gb;(function(sb){sb[sb.NameManagerListView=0]="NameManagerListView";sb[sb.NameManagerItemView=1]="NameManagerItemView";sb[sb.NameManagerMultiSelectView=2]="NameManagerMultiSelectView";sb[sb.NameManagerClosedView=3]="NameManagerClosedView";sb[sb.NameManagerErrorView=4]="NameManagerErrorView"})(Gb||(Gb={}));var Ba;(function(sb){sb[sb.Workbook=
0]="Workbook";sb[sb.Sheet=1]="Sheet"})(Ba||(Ba={}));var Xb;(function(sb){sb[sb.NameInput=0]="NameInput";sb[sb.ReferenceInput=1]="ReferenceInput";sb[sb.CommentInput=2]="CommentInput"})(Xb||(Xb={}));var Ab;(function(sb){sb[sb.NamedRange=0]="NamedRange";sb[sb.Table=1]="Table";sb[sb.NamedFormula=2]="NamedFormula";sb[sb.NamedConstant=3]="NamedConstant";sb[sb.Lambda=4]="Lambda";sb[sb.TableSlicer=5]="TableSlicer";sb[sb.PrintArea=6]="PrintArea";sb[sb.Others=7]="Others"})(Ab||(Ab={}));var Db;(function(sb){sb[sb.ASC=
0]="ASC";sb[sb.DESC=1]="DESC"})(Db||(Db={}));var xc;(function(sb){sb[sb.Default=0]="Default";sb[sb.Name=1]="Name";sb[sb.Scope=2]="Scope"})(xc||(xc={}));var vc;(function(sb){sb[sb.Workbook=0]="Workbook";sb[sb.Worksheets=1]="Worksheets";sb[sb.withErrors=2]="withErrors";sb[sb.withoutErrors=3]="withoutErrors";sb[sb.DefinedNames=4]="DefinedNames";sb[sb.TableNames=5]="TableNames"})(vc||(vc={}));class zb{}zb.Nal="utf-8";zb.HRi="GetOperationTimer";zb.sdi="DeleteOperationTimer";zb.cal="UpsertOperationTimer";
zb.aci=[Ab.NamedRange,Ab.Table,Ab.PrintArea,Ab.Others];zb.GIj=[0];zb.dxk=[0,1];Object(M.a)(zb,"ConstantsDefinedNameManager",null,[]);class tb extends Sys.EventArgs{constructor(sb,lc,Uc,od){od=void 0===od?!1:od;super();this.status=sb;this.operationType=lc;this.twb=Uc;this.Kmj=od}}Object(M.a)(tb,"DefinedNameOperationEventArgs",Sys.EventArgs,[]);var ab=a(61);class La{static create(sb){const lc=new La;Object.assign(lc,sb);return ab.a.Ci(lc)}}Object(M.a)(La,"NameManagerTelemetryData",null,[]);class pb{static OE(sb,
lc){(sb||lc)&&O.ULS.sendTraceTag(507581128,0,sb,lc)}static ona(sb){switch(sb){case "success":return 50;case "successWithServerException":case "failure":return 10}}}Object(M.a)(pb,"NameManagerTelemetry",null,[]);var ia=a(28);const kb={namedrange:Ab.NamedRange,table:Ab.Table,others:Ab.Others,print_area:Ab.PrintArea},fb={global:0,local:1},hb=[1546370075,472177316,-1818810228,-201732986],Jb={[0]:sb=>0===sb.scope,[1]:sb=>1===sb.scope,[2]:sb=>sb.isInvalidReference,[3]:sb=>!sb.isInvalidReference,[4]:sb=>
sb.type===Ab.NamedRange,[5]:sb=>sb.type===Ab.Table},ub=(sb,lc,Uc,od,sd)=>{sb=Object.assign({},{method:`NameManagerUtils.${Uc}`,executionTime:lc-sb},od&&{input_length:od},sd&&{output_length:sd});O.ULS.sendTraceTag(507581578,0,50,ab.a.Ci(sb))};class nb{static C6i(sb,lc,Uc,od,sd){return void 0===od&&0!==(null===sb||void 0===sb?void 0:sb.length)&&0!==(null===lc||void 0===lc?void 0:lc.length)?!0:od&&sb&&lc&&sd?(sd=sd.find(be=>be.runtimeUid===od))?(null===sd||void 0===sd?void 0:sd.name)!==sb||(null===sd||
void 0===sd?void 0:sd.reference)!==lc||(null===sd||void 0===sd?void 0:sd.comment)!==Uc:!1:!1}static yQi(sb){return void 0!==sb?kb[sb.toLowerCase()]:null}static AVi(sb){return void 0!==sb?fb[sb.toLowerCase()]:null}static search(sb,lc){if(!sb||0===sb.length||!lc)return sb;const Uc=performance.now(),od=sb.filter(be=>be.name.toLowerCase().includes(lc.toLowerCase().trim())),sd=performance.now();ub(Uc,sd,"search",sb.length,od.length);return od}static yJi(sb,lc){return null!==sb&&void 0!==sb&&sb.length&&
null!==lc&&void 0!==lc&&0!==lc.length?sb.find(Uc=>Uc.runtimeUid===lc):null}static ONi(sb,lc){return null!==sb&&void 0!==sb&&sb.length&&null!==lc&&void 0!==lc&&0!==lc.length?sb.findIndex(Uc=>Uc.metadata.runtimeUid===lc):-1}static fZc(sb){return sb?hb.includes(sb):!1}static UKi(sb){if(!sb||!sb.twb||sb.status)return null;const lc=[];let Uc;if(nb.fZc(sb.twb))switch(null===sb||void 0===sb?void 0:sb.twb){case 472177316:lc.push({target:1,errorMessage:xa.a.instance.Ea(912)});break;case 1546370075:lc.push({target:0,
errorMessage:xa.a.instance.Ea(911)});break;case -1818810228:Uc=xa.a.instance.Ea(1008);break;default:Uc=nb.RFf(sb.operationType)}return{Wdg:lc,s$b:Uc}}static RFf(sb){if(sb)switch(sb){case "add":return xa.a.instance.Ea(905);case "update":return xa.a.instance.Ea(906);case "delete":return xa.a.instance.Ea(907)}return null}static scl(sb,lc,Uc,od,sd){const be=[];let Ee;sd!==Ab.Table&&(Ee=nb.lUh(Uc,sb));sb=nb.jUh(od);lc=nb.kUh(lc);Ee&&be.push(Ee);sb&&be.push(sb);lc&&be.push(lc);return be}static aOd(sb){return sb&&
1===sb.length?sb[0].MessageId:null}static kUh(sb){let lc;var Uc;if(!(Uc=!sb||0===(null===sb||void 0===sb?void 0:sb.length)||255<(null===sb||void 0===sb?void 0:sb.length))){a:{for(Uc=0;Uc<sb.length;Uc++){const od=sb.charAt(Uc),sd=sb.charCodeAt(Uc);if(!Uc){if("\\"!==od&&"_"!==od&&!ia.a.isLetter(sd)){Uc=!1;break a}}else if("_"!==od&&"."!==od&&!ia.a.a0f(sd)&&!ia.a.isNumeral(sd)){Uc=!1;break a}}Uc=!0}Uc=!Uc}if(Uc||ia.a.cI(sb,"_xl"))lc=xa.a.instance.Ea(910);return lc?{target:0,errorMessage:lc}:null}static jUh(sb){let lc;
255<(null===sb||void 0===sb?void 0:sb.length)&&(lc=xa.a.instance.Ea(914));return lc?{target:2,errorMessage:lc}:null}static lUh(sb,lc){if(sb&&0===sb.length)sb=xa.a.instance.Ea(912);else switch(lc(sb)){case "valid":return null;case "notFormulaString":sb=xa.a.instance.Ea(913);break;default:sb=xa.a.instance.Ea(912)}return{target:1,errorMessage:sb}}static filterBy(sb,lc){if(!sb||0===sb.length||void 0===lc)return sb;const Uc=performance.now();lc=sb.filter(Jb[lc]);const od=performance.now();ub(Uc,od,"filterBy",
sb.length,lc.length);return lc}static z3h(sb){const lc={[0]:0,[1]:0,[2]:0,[3]:0,[4]:0,[5]:0};if(!sb||0===sb.length)return lc;const Uc=performance.now();for(var od of sb)for(const sd in Jb)Jb[sd](od)&&lc[sd]++;od=performance.now();ub(Uc,od,"countByFilter",sb.length);return lc}static groupBy(sb,lc,Uc){const od={};lc.forEach(sd=>{od[sd]=[]});for(const sd of sb)sb=Uc(sd),od[sb].push(sd);return od}static aNi(sb){switch(sb){case 0:return{QPd:zb.aci,RPd:lc=>lc.type};case 1:return{QPd:zb.GIj,RPd:()=>0};case 2:return{QPd:zb.dxk,
RPd:lc=>lc.scope}}}static sort(sb,lc){switch(lc){case 0:return sb.sort((Uc,od)=>Uc.name.localeCompare(od.name));case 1:return sb.sort((Uc,od)=>od.name.localeCompare(Uc.name))}}static PPd(sb,lc,Uc){if(!sb||0===sb.length||void 0===lc||void 0===Uc)return sb;const od=performance.now(),{QPd:sd,RPd:be}=nb.aNi(lc),Ee=nb.groupBy(sb,sd,be),Ie=[];sd.forEach(bf=>{Ie.push(...nb.sort(Ee[bf],Uc))});lc=performance.now();ub(od,lc,"groupAndSortBy",sb.length,Ie.length);return Ie}static A3h(sb){if(!sb)return null;const lc=
{};sb.forEach(Uc=>{const od=Uc.scope;Uc=Uc.metadata.type;lc[od]||(lc[od]={});lc[od][Uc]||(lc[od][Uc]=0);lc[od][Uc]++});return lc}}Object(M.a)(nb,"NameManagerUtils",null,[]);let Aa=class{constructor(sb,lc){this.eh=new cb.a;this.stateId=0;this.ZDh=Uc=>{this.eh.addHandler("dnek",Uc)};this.A_d=Uc=>this.Sj.A_d(Uc);this.Fl=()=>{var Uc;const od=null===(Uc=this.$.ea.Qq)||void 0===Uc?void 0:Uc.NamedManagerResponseStateId;od>this.stateId&&(this.stateId=od,O.ULS.sendTraceTag(507639444,0,50,"DefinedNameManager.OnWorkbookMetadataChanged : Received a stateId change and Invoked GetDefinedNames API"),
this.uvg(!0))};this.uvg=Uc=>{this.SJa=this.$.Eh.Li("WebServiceCall",zb.HRi);const od=be=>{this.W1i(be,Uc)},sd=be=>{var Ee,Ie;null===(Ee=this.SJa)||void 0===Ee?void 0:Ee.stop();be=Ac.a.kk(be.data);be=ja.a.ei(be);Ee=La.create({operationType:"get",status:"failure",executionTime:null===(Ie=this.SJa)||void 0===Ie?void 0:Ie.zi,error:be});pb.OE(pb.ona("failure"),Ee);this.XXa=null;this.raiseEvent("dnek",new tb(!1,"get",null,Uc))};X.a(this.$.userOperationManager,(be,Ee,Ie)=>{var bf=this.$.pa.ta;be=ba.c(be,
od);Ee=ba.b(Ee,sd);var Xe=this.$;const Ze=bf.$a(1,null);return aa.h(bf,"GetDefinedNames",Ze,be,Ee,Ie,Xe,0)},be=>new la.a(1037,0,be,16),null)};this.raiseEvent=(Uc,od)=>{this.eh.raiseEvent(Uc,od)};this.upsertDefinedName=(Uc,od,sd,be,Ee)=>{var Ie;this.Gzb=this.$.Eh.Li("WebServiceCall",zb.cal);const bf=nb.ONi(null===(Ie=this.XXa)||void 0===Ie?void 0:Ie.nameManagerItems,be),Xe=ff=>{this.u5i(ff,bf,Ee)},Ze=ff=>{var ef,Sf;null===(ef=this.Gzb)||void 0===ef?void 0:ef.stop();ff=Ac.a.kk(ff.data);ff=ja.a.ei(ff);
ef=La.create({operationType:-1!==bf?"update":"add",status:"failure",executionTime:null===(Sf=this.Gzb)||void 0===Sf?void 0:Sf.zi,error:ff,type:Ee});pb.OE(pb.ona("failure"),ef);this.raiseEvent("dnuek",new tb(!1,-1!==bf?"update":"add",null))},tf={Name:Uc,Reference:od,SheetName:"",Comment:sd,Type:Ee,RuntimeUid:be};X.a(this.$.userOperationManager,(ff,ef,Sf)=>{var zf=this.$.pa.ta;ff=ba.c(ff,Xe);ef=ba.b(ef,Ze);var sf=this.$;const lf=zf.$a(9,null);lf.definedNameRequest=tf;return aa.h(zf,"UpsertDefinedName",
lf,ff,ef,Sf,sf,0)},ff=>new la.a(1035,0,ff),null)};this.$=sb;this.Sj=lc}$Eh(sb){this.eh.addHandler("dnuek",sb)}XBh(sb){this.eh.addHandler("dndok",sb)}Bnk(sb){this.eh.removeHandler("dnek",sb)}Aok(sb){this.eh.removeHandler("dnuek",sb)}Tlk(sb){this.eh.removeHandler("dndok",sb)}mz(){var sb;this.$.ea.mz(this.Fl);this.$.ea.Qq&&(this.stateId=null===(sb=this.$.ea.Qq)||void 0===sb?void 0:sb.NamedManagerResponseStateId)}KA(){this.$.ea.KA(this.Fl)}W1i(sb,lc){var Uc,od,sd,be,Ee,Ie,bf,Xe,Ze;let tf=!1,ff;try{if(sb&&
!Oa.a(sb)){const ef=new Uint8Array(sb.Result),Sf=(new TextDecoder(zb.Nal)).decode(ef.buffer);this.XXa=JSON.parse(Sf);null===(Uc=this.SJa)||void 0===Uc?void 0:Uc.stop();tf=!0;const zf=La.create({operationType:"get",status:"success",executionTime:null===(od=this.SJa)||void 0===od?void 0:od.zi,count:null===(be=null===(sd=this.XXa)||void 0===sd?void 0:sd.nameManagerItems)||void 0===be?void 0:be.length,metadata:nb.A3h(null===(Ee=this.XXa)||void 0===Ee?void 0:Ee.nameManagerItems)});pb.OE(pb.ona("success"),
zf)}else{null===(Ie=this.SJa)||void 0===Ie?void 0:Ie.stop();ff=nb.aOd(null===sb||void 0===sb?void 0:sb.Errors);this.XXa=null;const ef=La.create({operationType:"get",status:"successWithServerException",executionTime:null===(bf=this.SJa)||void 0===bf?void 0:bf.zi,serverMessageId:ff.toString()});pb.OE(pb.ona("successWithServerException"),ef)}}catch(ef){this.XXa=null,null===(Xe=this.SJa)||void 0===Xe?void 0:Xe.stop(),sb=La.create({operationType:"get",status:"failure",executionTime:null===(Ze=this.SJa)||
void 0===Ze?void 0:Ze.zi,error:"JsonParsingError"}),pb.OE(pb.ona("failure"),sb)}this.raiseEvent("dnek",new tb(tf,"get",ff,lc))}juc(sb){this.pib=this.$.Eh.Li("WebServiceCall",zb.sdi);const lc=od=>{this.X1i(od,sb)},Uc=od=>{var sd,be;null===(sd=this.pib)||void 0===sd?void 0:sd.stop();od=Ac.a.kk(od.data);od=ja.a.ei(od);sd=La.create({operationType:"delete",status:"failure",executionTime:null===(be=this.pib)||void 0===be?void 0:be.zi,error:od});pb.OE(pb.ona("failure"),sd);this.raiseEvent("dndok",new tb(!1,
"delete",null))};X.a(this.$.userOperationManager,(od,sd,be)=>{var Ee=this.$.pa.ta;od=ba.c(od,lc);sd=ba.b(sd,Uc);var Ie=this.$;const bf=Ee.$a(9,null);bf.definedNameIds=sb;return aa.h(Ee,"DeleteDefinedNames",bf,od,sd,be,Ie,0)},od=>new la.a(1036,0,od),null)}X1i(sb,lc){var Uc,od,sd;let be=!1,Ee;if(sb&&!Oa.a(sb)&&lc){be=!0;null===(Uc=this.pib)||void 0===Uc?void 0:Uc.stop();var Ie=La.create({operationType:"delete",status:"success",executionTime:null===(od=this.pib)||void 0===od?void 0:od.zi,countOfNamesDeleted:lc.length});
pb.OE(pb.ona("success"),Ie)}else Ee=nb.aOd(null===sb||void 0===sb?void 0:sb.Errors),null===(sd=this.pib)||void 0===sd?void 0:sd.stop(),nb.fZc(Ee)&&mc.a(this.$).xj.VL(Ee),od=La.create({operationType:"delete",status:"successWithServerException",executionTime:null===(Ie=this.pib)||void 0===Ie?void 0:Ie.zi,serverMessageId:Ee.toString(),countOfNamesDeleted:lc.length}),pb.OE(pb.ona("successWithServerException"),od);this.raiseEvent("dndok",new tb(be,"delete",Ee))}u5i(sb,lc,Uc){var od,sd,be;let Ee=!1,Ie;
if(sb&&!Oa.a(sb)){Ee=!0;null===(od=this.Gzb)||void 0===od?void 0:od.stop();var bf=La.create({operationType:-1!==lc?"update":"add",status:"success",executionTime:null===(sd=this.Gzb)||void 0===sd?void 0:sd.zi,type:Uc});pb.OE(pb.ona("success"),bf)}else null===(be=this.Gzb)||void 0===be?void 0:be.stop(),Ie=nb.aOd(null===sb||void 0===sb?void 0:sb.Errors),nb.fZc(Ie)&&mc.a(this.$).xj.VL(Ie),Uc=La.create({operationType:-1!==lc?"update":"add",status:"successWithServerException",type:Uc,executionTime:null===
(bf=this.Gzb)||void 0===bf?void 0:bf.zi,serverMessageId:Ie.toString()}),pb.OE(pb.ona("successWithServerException"),Uc);this.raiseEvent("dnuek",new tb(Ee,-1!==lc?"update":"add",Ie))}};Aa=Object(K.__decorate)([Object(Xa.d)(Sa.zb),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.E)())],Aa);Object(M.a)(Aa,"DefinedNameManager",null,[356]);var ra=a(6),vb=a(136),rb=a(53),Nb=a(13),Qc=a(240);class jd{}jd.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(M.a)(jd,"FileUploadDialogHTML",null,[]);var xd=a(169),ae=a(26),Sd=a(22);class fc extends Qc.a{constructor(sb){super(!1,!1,fc.D2);this.g4d=!1;this.Xag=!0;this.bag=0;this.pwj=(lc,Uc)=>{const od=Uc[fc.Otd]||"";let sd=!0;void 0!==Uc[fc.hpc]&&null!==Uc[fc.hpc]&&(sd=Uc[fc.hpc]);this.xD(lc,od,sd)};this.Vfe=(lc,Uc)=>{this.xD(lc,Uc.text||"",Uc.reportErrorChecked)};this.OXj=lc=>{ra.AFrameworkApplication.yh.ek(ae.a.k3b,2,lc)};this.Ph=1;this.ri(1,Object(Sd.a)("Send"));this.ri(0,Object(Sd.a)("NoThanks"));
this.kp=jd.HTML;this.S$f=sb;this.kl=fc.iRh}Ip(sb,lc,Uc,od,sd){sd=void 0===sd?!0:sd;this.g4d=void 0===od?!1:od;this.vOk(lc);this.bag=sb;sd&&ra.AFrameworkApplication.VC(sb)}vOk(sb){if(fc.D2)this.pQk(sb);else{var lc={};lc[fc.eRh]=sb;lc[fc.kRh]=Object(Sd.a)("SendFileErrorReportMessage");lc[fc.lRh]=Object(Sd.a)("SendFileErrorReportTextCaption");lc[fc.Otd]="";lc[fc.hRh]=Object(Sd.a)("UserReportLinkText");lc[fc.hpc]=!0;this.initializeAndShow(Object(Sd.a)("DefaultDialogTitle"),this.pwj,lc);this.Pia(fc.rRh)}}pQk(sb){sb=
{["id"]:this.kl,["bodyControls"]:{["reportErrorCheckboxProps"]:this.g4d?{["label"]:Object(Sd.a)("UserReportLinkText")}:null,["textAreaProps"]:this.Xag?{}:null,["privacyStatementLinkProps"]:{["text"]:Object(Sd.a)("PrivacyStatement"),["handler"]:{["href"]:ra.AFrameworkApplication.privacyUrl,["target"]:"_blank"}}},["errorMessage"]:sb,["errorReportMessage"]:Object(Sd.a)("SendFileErrorReportMessage"),["errorTextPrompt"]:Object(Sd.a)("SendFileErrorReportTextCaption")};this.initializeAndShow(Object(Sd.a)("DefaultDialogTitle"),
this.Vfe,sb)}YOc(){if(!fc.D2){var sb=document.getElementById(fc.nRh);sb&&(sb.className=fc.mRh,sb.appendChild(xd.a(32,32,fc.jRh,null,!0,Object(Sd.a)("DialogError"))));if(sb=document.getElementById(fc.pRh))sb.innerText=Object(Sd.a)("PrivacyStatement"),sb.href=ra.AFrameworkApplication.privacyUrl,rb.a.addHandler(sb,"click",this.OXj);this.Xag||(sb=document.getElementById(fc.Otd))&&sb.parentNode&&sb.parentNode.removeChild(sb);this.g4d||(sb=document.getElementById(fc.gRh))&&sb.parentNode&&sb.parentNode.removeChild(sb)}}dT(){fc.D2||
(super.dT(),document.getElementById(this.hp("WACDialogPanel")).style.width=String.format("{0}px",400))}xD(sb,lc,Uc){this.S$f&&(Uc&&O.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.bag),this.S$f(sb,lc,Uc))}get Rea(){return!1}static get D2(){return ra.AFrameworkApplication.ra.$g.VM&&ra.AFrameworkApplication.ra.$g.ypj}}fc.eRh="WACDialogErrorMessage";fc.kRh="WACDialogErrorReportMessage";fc.lRh="WACDialogErrorTextPrompt";fc.Otd="WACDialogInput";fc.pRh="WACDialogPrivacyText";
fc.nRh="WACDialogIconPanel";fc.jRh="CancelRequest_32x32x32";fc.mRh="WACDialogIcon";fc.rRh="WACDialogTextPanel";fc.hpc="WACDialogSendFileCheckbox";fc.gRh="WACDialogSendFileCheckboxContainer";fc.hRh="WACDialogSendFileCheckboxText";fc.iRh="FileUploadErrorDialog";Object(M.a)(fc,"FileUploadErrorDialog",Qc.a,[]);var uc;let hc=uc=class extends cb.a{constructor(sb){super();this.$=sb;this.ixg=0;this.zM=null;this.$jk=lc=>{this.Glk(lc)};this.bZh=(lc,Uc)=>{if(1===lc&&this.zM.FileCollectionErrorStateId){lc=this.$.pa.ta;
var od=this.zM.MessageId,sd=this.zM.OriginalEcsServerId,be=this.zM.FileCollectionErrorStateId;const Ee=lc.$a(0);Ee.errorMessageId=od;Ee.ecsServerId=sd;Ee.fileCollectionErrorStateId=be;Ee.userComment=Uc;lc.aud("CollectFile",Ee,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)}}JBh(sb){this.addHandler("fileCollectionComplete",sb)}Glk(sb){this.removeHandler("fileCollectionComplete",sb)}aZh(sb,lc,Uc){this.ixg=lc;this.zM=sb;this.JBh(Uc);ra.AFrameworkApplication.privacyUrl=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;
sb=new fc(this.bZh);ra.AFrameworkApplication.yh.Uh(ae.a.k3b,vb.a.frame,uc.u$j);sb.Ip(0,"",null,!1,!1)}static u$j(sb,lc,Uc,od,sd){rb.a.iB(sd);ra.AFrameworkApplication.privacyUrl&&Nb.HelperMethods.Cm(ra.AFrameworkApplication.privacyUrl,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}};hc=uc=Object(K.__decorate)([Object(Xa.d)(Sa.gc),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.cb)())],hc);Object(M.a)(hc,"FileCollectionOperation",cb.a,[358,2]);var Ec=a(71);let yd=class extends za.a{constructor(sb,
lc,Uc,od){super();this.ul=null;this.vj=()=>{this.button.getButton(this.ul.xm.paneType).wtb();Da.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:bb.a.Pm({["buttonType"]:"FloatingObjectToCellImage"})});const sd=new Fb.a(-700002548,C.a.rh,this.$.ii,9,null);this.$.Ma.qh(sd,null)};this.QE=()=>{this.Bca()};this.Ejg=()=>{this.nyb()};this.RPc=()=>{this.nyb()};this.WPc=()=>{this.nyb()};this.zmg=()=>{this.nyb()};this.R0b=()=>{this.nyb()};this.Bmg=()=>{this.nyb()};this.mq=
()=>{this.Bca()};this.Qy=()=>{this.Bca()};this.Tu=()=>{this.Bca()};this.EA=()=>{this.Bca()};this.$=sb;this.isVisible=!1;this.button=Uc.wMb(sb,lc,this.vj,null,null,xa.a.instance.ia(2319),"FloatingObjectToCellImagePointerDown");this.da=ya.f(this.$);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")&&this.da.aA(this.QE);this.$.xI(this.mq);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.cK(this.EA);this.da.view.lz(this.Qy);
this.da.ha.$e.jO(this.Tu);this.ariaLiveNotifier=od}dispose(){this.da&&(this.da.view.Yx(this.Qy),this.da.ha.$e.NV(this.Tu));this.$&&(this.$.fL(this.mq),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.XH(this.EA));this.button.dispose();this.$=this.da=this.button=null;super.dispose()}umd(){this.isVisible&&this.vj(null,null)}Bca(){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.jY();else{var sb=
this.da.ha.$e;if(sb.isFloatingObjectSelected&&1===sb.Lh.floatingObject.type){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){const lc=new Ja.a(this.$.sa);if(lc&&lc.wn){this.jY();return}}null!==this.ul&&this.SDg(this.ul);this.ul=sb.Lh;this.Lqa()}else this.jY()}}Lqa(){const sb=this.ul.xm.Vr,lc=this.ul.floatingObject;this.ayh(this.ul);let Uc=lc.u_+this.cpc,od=lc.Xz,sd=0;var be=0;switch(this.ul.xm.paneType){case 3:sd=this.da.fh.hz;be=this.da.fh.Xz-this.da.Gw.y;
break;case 4:sd=this.da.fh.hz-this.da.Gw.x;be=this.da.fh.Xz;break;case 1:sd=this.da.fh.hz;be=this.da.fh.Xz;break;case 2:sd=this.da.fh.hz-this.da.Gw.x,be=this.da.fh.Xz-this.da.Gw.y}Uc-=sd;od-=be;be=new Ec.a(lc.hz-sd,od,lc.width,lc.height);Uc+this.button.buttonWidth>sb.bottomRight.x&&(Uc=lc.hz-sd-this.cpc-this.button.buttonWidth);od<sb.topLeft.y+this.cpc&&(od=sb.topLeft.y+this.cpc);4===this.da.ha.Ck&&sb.Xi(be)&&sb.width>lc.width?this.dv(Uc,od,this.da.rtl,this.ul.xm.paneType,!0):this.jY()}dv(sb,lc,Uc,
od,sd){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")||this.da.aA(this.QE);this.button.m3c(ka.a.W5j,xa.a.instance.ia(2319),od);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8352230_UpdateDivTitleForSVGLaunchButtonOOUI")&&this.button.O2c(xa.a.instance.ia(2319),od);this.button.dv(sb,lc,Uc,od,!1,sd);this.isVisible=!0;this.qHh()}jY(){this.da.$E(this.QE);null!==this.ul&&(this.SDg(this.ul),this.ul=null);this.button.hide();this.isVisible=!1}nyb(){this.button.hide();
this.isVisible=!1}qHh(){let sb;sb=Ua.a.isMac?xa.a.instance.ia(2323):xa.a.instance.ia(2322);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.$ba(sb)}get cpc(){return this.button.CKb}ayh(sb){var lc,Uc,od,sd,be,Ee;if(sb=sb.extension)null===(lc=sb.H$)||void 0===lc?void 0:lc.b4e(this.Ejg),null===(Uc=sb.vvb)||void 0===Uc?void 0:Uc.ppd(this.RPc),null===(od=sb.OJg)||void 0===od?void 0:od.tEh(this.WPc),null===(sd=sb.vP)||void 0===sd?void 0:sd.Uod(this.R0b),null===(be=sb.vP)||void 0===be?void 0:be.XCh(this.zmg),
null===(Ee=sb.vP)||void 0===Ee?void 0:Ee.$Ch(this.Bmg)}SDg(sb){var lc,Uc,od,sd,be,Ee;if(sb=sb.extension)null===(lc=sb.H$)||void 0===lc?void 0:lc.cFg(this.Ejg),null===(Uc=sb.vvb)||void 0===Uc?void 0:Uc.IFg(this.RPc),null===(od=sb.OJg)||void 0===od?void 0:od.Unk(this.WPc),null===(sd=sb.vP)||void 0===sd?void 0:sd.Yie(this.R0b),null===(be=sb.vP)||void 0===be?void 0:be.Lmk(this.zmg),null===(Ee=sb.vP)||void 0===Ee?void 0:Ee.Omk(this.Bmg)}};yd=Object(K.__decorate)([Object(Xa.d)(Sa.tc),Object(K.__param)(0,
Object(Sa.Nb)()),Object(K.__param)(1,Object(ma.i)()),Object(K.__param)(2,Object(Sa.Qf)()),Object(K.__param)(3,Object(Sa.l)())],yd);Object(M.a)(yd,"FloatingObjectToCellImageController",za.a,[]);var Ad=a(488),$b=a(432),Ob=a(33),Yc=a(627),zd=a(592),Dd=a(1290);a(227);var oc=a(25);Object(Xa.b)(Sa.vc,{Ek:"singleton"})(sb=>Lo(function*(){const lc=yield Xa.a.resolve(Sa.Nb,sb),Uc=oc.a.dl()?yield Xa.a.resolve(Sa.wc,sb):null;return new $c(lc,Uc)}));class $c{constructor(sb,lc){this.$=sb;this.lA=lc;this.menuId=
this.Ftd=this.Ica=this.ywa=null;this.RHd=0;this.zGj="+mn-lt";this.iDj="+mj-lt";this.LPc=Uc=>{this.RWb=!0;this.$.C5(od=>{od.Atb("FontName_New")});O.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Uc}`)};this.jhj=!!String.fromCodePoint&&!Ua.a.wA&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.RWb=!1;this.da=ya.f(this.$);this.dl=oc.a.dl();this.F0f=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1);this.dl&&this.lA&&(this.lA.Qkj?
this.GOg():this.lA.CAc(()=>{this.GOg()}))}get Kw(){this.MG||(this.MG=Xa.a.nh(Sa.Dg));return this.MG}GOg(){this.Ica=this.lA.AZg;this.ywa=this.lA.Tyi;this.RHd=2;this.RWb=this.lA.RWb}get AZg(){return this.Ica}RCf(sb,lc,Uc,od){od=void 0===od?null:od;const sd=Object.assign(new Ad.a,{Id:"FontDropdownMenu"});sd.MenuSectionList=[];this.Kw&&(this.Kw.FIa(od),od=Object.assign(new $b.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:xa.a.instance.ia(1337),ControlList:this.yYi(sb,lc,Uc)}),sd.MenuSectionList.push(od));
od=Object.assign(new $b.a,{ControlsId:"FontsMenuSectionControl"});od.Title=xa.a.instance.ia(1338);od.ControlList=this.dMi(sb,lc,Uc);sd.MenuSectionList.push(od);return sd}yYi(sb,lc,Uc){var od;const sd=[];var be=this.da.ha.$e.Lh;be=5===(null===(od=null===be||void 0===be?void 0:be.floatingObject)||void 0===od?void 0:od.type);let Ee,Ie;this.Kw.Zy?(Ee=this.Kw.Zy.U5d,Ie=this.Kw.Zy.C4d):O.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(od=this.Amf(Ie,1,be,sb,lc,Uc))&&sd.push(od);(sb=this.Amf(Ee,
2,be,sb,lc,Uc))&&sd.push(sb);return sd}Amf(sb,lc,Uc,od,sd,be){var Ee=2===lc?this.zGj:this.iDj;let Ie;sb?(Uc=Uc?Ee:Ob.a.om(sb),Ee=Ob.a.om(Nb.HelperMethods.uSb(sb,lc)),Ie=Ob.a.om(sb)):(Uc=Uc?Ee:void 0,Ee=Ob.a.om(String.fromCodePoint(0)),Ie="msofp");return Object.assign(new Yc.a,{MenuItemId:2===lc?Dd.b:Dd.a,CommandValueId:Uc,LabelText:Ee,LabelCss:String.format("font-size:12pt;font-family:{0};",Ie),Styles:$c.aSb(Ie),AriaLabel:Ee,Alt:Ee,Command:od.toString(),CommandPreviewId:sd.toString(),CommandRevertId:be.toString(),
Disabled:!sb})}dMi(sb,lc,Uc){if(this.Ftd)return this.Ftd.HAd;let od;const sd=Nb.HelperMethods.eN(()=>{const be=this.jhj&&!this.RWb;let Ee=!1;this.ywa||(this.fVf(),Ee=!0,O.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));od=this.Vkf(sb,lc,Uc,this.ywa,be,Ee);od.eZc&&!Ee&&(O.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),
this.fVf(),od=this.Vkf(sb,lc,Uc,this.ywa,be,od.eZc));this.dl&&!od.eZc&&(this.Ftd=od);be&&!this.dl&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.LPc)});10<sd&&O.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${sd}`);return od.HAd}Vkf(sb,lc,Uc,od,sd,be){const Ee=[];let Ie;const bf=this.dl&&!be;Ie=bf?"msofpNew":this.F0f?"msofp_v4_29":"msofp";for(const ef in od){var Xe=ef,Ze=od[ef],tf=Ob.a.om(Xe),ff=void 0;
if(bf)if(ff=this.Ica?this.Ica[Xe]:null)ff=Ob.a.om(ff);else return O.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Xe}`),{eZc:!0,HAd:[]};else ff=Ob.a.om(Nb.HelperMethods.Ica[Xe]);Xe=Ob.a.om(Xe);sd||(Ze=0);tf=Object.assign(new Yc.a,{MenuItemId:tf,CommandValueId:tf,LabelText:sd&&0<Ze?Ob.a.om(String.fromCodePoint(Ze)):ff,LabelCss:String.format("font-size:12pt;font-family:{0};",sd&&0<Ze?Ie:Xe),Styles:$c.aSb(sd&&
0<Ze?Ie:Xe),AriaLabel:ff,Alt:ff,Command:sb.toString(),CommandPreviewId:lc.toString(),CommandRevertId:Uc.toString()});Ee.push(tf)}return{eZc:be,HAd:Ee}}SEk(sb){this.menuId=sb}Skj(){return 2!==this.RHd&&3!==this.RHd?!1:!0}fVf(){this.F0f?(this.ywa={["Angsana New"]:983051,["Aptos Display"]:983056,["Aptos Narrow"]:983060,["Arial Black"]:983065,["Arial"]:983064,["Batang"]:983087,["Book Antiqua"]:983104,["Browallia New"]:983109,["Calibri"]:983112,["Cambria"]:983116,["Candara"]:983118,["Century"]:983121,
["Comic Sans MS"]:983128,["Consolas"]:983134,["Constantia"]:983135,["Corbel"]:983139,["Cordia New"]:983140,["Courier New"]:983142,["DilleniaUPC"]:983153,["Dotum"]:983155,["FangSong"]:983175,["Garamond"]:983193,["Georgia"]:983195,["Gulim"]:983222,["GungSuh"]:983226,["KaiTi"]:983263,["JasmineUPC"]:983258,["Malgun Gothic"]:983302,["Mangal"]:983306,["Meiryo"]:983309,["Microsoft JhengHei"]:983317,["Microsoft YaHei"]:983329,["MingLiU"]:983337,["MingLiU_HKSCS"]:983341,["MS Gothic"]:983290,["MS Mincho"]:983292,
["MS PGothic"]:983294,["MS PMincho"]:983296,["PMingliU"]:983372,["PMingLiU-ExtB"]:983374,["SimHei"]:983441,["SimSun"]:983443,["SimSun-ExtB"]:983445,["Source Sans Pro"]:983464,["Tahoma"]:983472,["THSarabunPSK"]:983471,["Times New Roman"]:983484,["Trebuchet MS"]:983495,["Verdana"]:983519,["Yu Gothic"]:983540,["Yu Mincho"]:983550},zd.a.yw('@font-face{font-family:"msofp_v4_29";font-style:normal;font-weight:normal;src:url("https://fs.microsoft.com/fs/4.35/flat_officeFontsPreview.ttf") format(\'truetype\')}')):
this.ywa={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,
["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,
["Yu Mincho"]:983474}}static aSb(sb){const lc={};lc["font-family"]=sb;lc["font-size"]="12pt";sb={};sb.optionText=lc;return sb}}Object(M.a)($c,"FontDropdownHelper",null,[273]);var yb=a(857),qb;(function(sb){sb[sb.FormatCellsListView=0]="FormatCellsListView";sb[sb.NumberFormatItemView=1]="NumberFormatItemView";sb[sb.AlignmentItemView=2]="AlignmentItemView";sb[sb.FontItemView=3]="FontItemView";sb[sb.BorderItemView=4]="BorderItemView"})(qb||(qb={}));var Cb;(function(sb){sb[sb.General=0]="General";sb[sb.Number=
1]="Number";sb[sb.Currency=2]="Currency";sb[sb.Accounting=3]="Accounting";sb[sb.Date=4]="Date";sb[sb.Time=5]="Time";sb[sb.Percentage=6]="Percentage";sb[sb.Fraction=7]="Fraction";sb[sb.Scientific=8]="Scientific";sb[sb.Text=9]="Text";sb[sb.Special=10]="Special";sb[sb.Custom=11]="Custom"})(Cb||(Cb={}));var gc=a(10),Mc=a(217),bd=a(1498);Object(bd.isChangeGateEnabled)("OfficeVSO:8756610_UserBrowserPerformanceAPI");class Id{constructor(sb,lc,Uc){this.Z9=!1;this.R0a=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");
this.JK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.TE=()=>{this.dispose()};this.X6=()=>{this.to()};this.onActiveCellChanged=(od,sd)=>{sd&&sd.description===qb[qb.AlignmentItemView]&&this.MPa()};this.Tu=(od,sd)=>{sd&&sd.hId===qb.AlignmentItemView&&(this.JK?0!==(sd.Ck&470)?this.lp.i8(qb.AlignmentItemView,null):this.MPa():this.lp.i8(qb.AlignmentItemView,null,!0))};this.CB=(od,sd)=>{sd&&sd.description===qb[qb.AlignmentItemView]&&this.MPa()};this.mOc=
(od,sd)=>{sd&&sd.description===qb[qb.AlignmentItemView]&&(this.reactRibbonRoot.Dn(),this.MPa())};this.$=sb;this.properties=lc;this.Nh=Uc;this.lp=dc.FAc(this.$,this.properties,this.Nh);this.alignmentModel={horizontalAlignmentType:0,verticalAlignmentType:0,readingOrderType:0,isJustifyDistributed:!1,indent:0,orientation:0,isWrapText:!1,isShrinkToFit:!1,isMergeCells:!1,isMergeCellsDisabled:!1,isFlipVertical:!1,disableAllControls:!1};this.EBf={};this.R0a&&(this.reactRibbonRoot=sb.la.lh(337,!0))}static getInstance(sb,
lc,Uc){return this.Va||(this.Va=new this(sb,lc,Uc))}MPa(){var sb;const lc=ya.f(this.$),Uc=null===(sb=lc.zh(lc.ha.qa.activeCell))||void 0===sb?void 0:sb.cell;Uc&&(c("AlignmentTab::Update::Start"),this.alignmentModel.horizontalAlignmentType=Uc.PH,this.alignmentModel.verticalAlignmentType=Uc.verticalAlignment,this.alignmentModel.isJustifyDistributed=8===Uc.PH?!0:!1,this.alignmentModel.indent=Uc.indentation||0,this.alignmentModel.isWrapText=Uc.oF,this.alignmentModel.isShrinkToFit=Uc.M8b,this.alignmentModel.isMergeCells=
Uc.$F,this.alignmentModel.isMergeCellsDisabled=Mc.c(lc),this.alignmentModel.readingOrderType=Uc.iTc,this.R0a&&(this.alignmentModel.disableAllControls=lc.Fh.isEditing),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8475627_FixVerticalTextOrientation")?(this.alignmentModel.orientation=Uc.IJc?0:Uc.iF||0,this.alignmentModel.isFlipVertical=Uc.IJc):(this.alignmentModel.orientation=Uc.iF||0,this.alignmentModel.isFlipVertical=this.alignmentModel.orientation===gc.a.verticalText?!0:!1),this.I7k(this.alignmentModel))}I7k(sb){this.EBf.alignmentModel=
sb;this.lp.i8(qb.AlignmentItemView,this.EBf);this.Z9||this.Hp()}qh(sb,lc){c("AlignmentTab::CmdUpdate::Start");lc=Object.assign({},lc);lc[yb.a.Uia]=!1;this.$.ti(sb,C.a.rh,12,lc);O.ULS.sendTraceTag(508389411,0,50,`Ribbon command called from Alignment Task Pane: ${sb}`)}Uze(sb){switch(sb){case 0:this.Uze(this.alignmentModel.horizontalAlignmentType);break;case 1:this.qh(-1150205178,null);break;case 2:this.qh(-1142465846,null);break;case 3:this.qh(-286432209,null);break;case 6:this.qh(2007171328,null)}}sJa(){return{onHorizontalAlignmentChange:sb=>
{this.alignmentModel.horizontalAlignmentType!==sb&&this.Uze(sb)},onVerticalAlignmentChange:sb=>{switch(sb){case 0:this.qh(-394785302,null);break;case 1:this.qh(1041132226,null);break;case 2:this.qh(-571165336,null)}},justifyDistributed:sb=>{sb&&this.Uze(8)},onTextDirectionChange:()=>{},onIndentationChange:sb=>{const lc=this.alignmentModel.indent;this.qh(sb>lc?-1942512156:-1920201820,{Indentation:sb-lc});this.MPa()},onOrientationChange:sb=>{this.qh(-1220714308,{Orientation:sb});this.MPa()},wrapText:()=>
{this.qh(-1116189897,null)},mergeCells:sb=>{this.qh(sb?1097660126:155820588,null)},flipVertical:()=>{this.qh(-1526602249,null)}}}dispose(){this.to();this.lp.Mie(this.TE);Id.Va=null}Hp(){this.lp.Jod(this.X6);this.lp.Iod(this.TE);this.lp.add_activeCellChanged(this.onActiveCellChanged);this.lp.jO(this.Tu);this.lp.G4e(this.CB);this.R0a&&(this.lp.xBh(this.mOc),this.lp.wBh(this.mOc));this.Z9=!0;O.ULS.sendTraceTag(508355650,0,50,"AlignmentViewModel events registered")}to(){this.lp.Nie(this.X6);this.lp.remove_activeCellChanged(this.onActiveCellChanged);
this.lp.NV(this.Tu);this.lp.BFg(this.CB);this.R0a&&(this.lp.wlk(this.mOc),this.lp.vlk(this.mOc));this.Z9=!1;O.ULS.sendTraceTag(508355649,0,50,"AlignmentViewModel events Unregistered")}}Object(M.a)(Id,"AlignmentTaskPaneManager",null,[2]);var Vd=a(182),ce=a(1431);class ee{constructor(sb,lc){this.JK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.$=lc;this.lp=sb}showTaskPane(sb,lc,Uc){void Vd.a.ep().then(od=>{od.showTaskPane("FormatCellsTaskPane",this.Ht(sb,
lc,Uc));return null})}updateTaskPane(sb,lc,Uc){void Vd.a.ep().then(od=>{od.updateTaskPane("FormatCellsTaskPane",this.Ht(sb,lc,Uc));return null})}hideTaskPane(){void Vd.a.ep().then(sb=>{sb.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");}Ht(sb,lc,Uc){sb={type:"FormatCellsTaskPaneProps",activePage:sb,callbacks:this.lp.sJa(),viewModelData:lc,isFloatingObjectSelected:Uc};return Object.assign(new ce.a,{contentProps:sb,actionButtonProps:sb.activePage!==
qb.FormatCellsListView&&(this.JK||!Uc)&&{label:xa.a.instance.ia(2351),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(qb.FormatCellsListView,null,this.JK?void 0:Uc);this.lp.activePage=qb.FormatCellsListView}},title:sb.activePage===qb.FormatCellsListView?xa.a.instance.ia(2304):xa.a.instance.ia(2305),onShow:()=>{this.lp.uXj()},onHide:()=>{this.lp.X6()},onClose:()=>{this.lp.TE()},width:320})}}Object(M.a)(ee,"FormatCellsTaskPane",null,[421]);var Je=a(1293);class Ue extends Sys.EventArgs{constructor(sb,
lc,Uc,od){super();this.So=sb;this.cellFormat=lc;this.hId=Uc;this.Ck=od}}Object(M.a)(Ue,"FormatCellsTaskPaneEventArgs",Sys.EventArgs,[]);class jc extends cb.a{constructor(sb,lc,Uc){super();this.hY=!1;this.R0a=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");this.JK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.activePage=qb.FormatCellsListView;this.isFloatingObjectSelected=this.gpb=!1;this.hRi=()=>this.activePage===qb.NumberFormatItemView?
dc.VMd(this.$,this.properties,this.Nh).sJa():null;this.fEi=()=>this.activePage===qb.AlignmentItemView?dc.FJd(this.$,this.properties,this.Nh).sJa():null;this.Vhg=()=>{this.raiseEvent("CellEditingStarted",new Je.a(qb[this.activePage],null))};this.Uhg=()=>{this.raiseEvent("CellEditingEnded",new Je.a(qb[this.activePage],null))};this.onActiveCellChanged=()=>{this.raiseEvent("ActiveCellChanged",new Je.a(qb[this.activePage],null));this.activePage===qb.FormatCellsListView&&this.isFloatingObjectSelected&&
this.i8(qb.FormatCellsListView,null,this.JK?void 0:!1);this.JK||(this.isFloatingObjectSelected=!1)};this.Tu=(od,sd)=>{this.isFloatingObjectSelected=this.JK?sd&&0!==(sd.Ck&470):!0;this.activePage===qb.FormatCellsListView?this.i8(qb.FormatCellsListView,null,this.JK?void 0:!0):this.raiseEvent("FloatingObjectSelectionChanged",new Ue(1461300262,null,this.activePage,sd.Ck))};this.FYb=()=>{this.$.ea.yk!==gc.a.Dk&&this.$.ea.ki&&(this.hY=!0)};this.CB=()=>{this.$.ea.yk!==gc.a.Dk&&this.hY&&(this.hY=!1,(new Ja.a(this.$.sa)).Wj(4)?
this.raiseEvent("OnGridConsistent",new Je.a(qb[this.activePage],null)):this.mkb.hideTaskPane())};this.ej=(od,sd)=>{!sd.dm&&this.gpb&&this.mkb.hideTaskPane()};this.$=sb;this.properties=lc;this.Nh=Uc;this.mkb=new ee(this,sb);this.da=ya.f(this.$);this.i_d=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AsyncTaskPaneUITiming",!1);this.JK&&(this.isFloatingObjectSelected=this.da.ha.$e.isFloatingObjectSelected)}static getInstance(sb,lc,Uc){return this.Va||(this.Va=new this(sb,lc,Uc))}i8(sb,
lc,Uc){Uc=void 0===Uc?this.JK?this.yMk(sb)?this.isFloatingObjectSelected:!1:!1:Uc;this.gpb?this.mkb.updateTaskPane(sb,lc,Uc):(this.i_d&&void this.L0k(),this.mkb.showTaskPane(sb,lc,Uc),this.gpb=!0,this.Mz());this.activePage=sb}Jod(sb){this.addHandler("FCPaneCollapsed",sb)}Nie(sb){this.removeHandler("FCPaneCollapsed",sb)}Iod(sb){this.addHandler("FCPaneClosed",sb)}Mie(sb){this.removeHandler("FCPaneClosed",sb)}add_activeCellChanged(sb){this.addHandler("ActiveCellChanged",sb)}remove_activeCellChanged(sb){this.removeHandler("ActiveCellChanged",
sb)}jO(sb){this.addHandler("FloatingObjectSelectionChanged",sb)}NV(sb){this.removeHandler("FloatingObjectSelectionChanged",sb)}G4e(sb){this.addHandler("OnGridConsistent",sb)}BFg(sb){this.removeHandler("OnGridConsistent",sb)}xBh(sb){this.addHandler("CellEditingStarted",sb)}wlk(sb){this.removeHandler("CellEditingStarted",sb)}wBh(sb){this.addHandler("CellEditingEnded",sb)}vlk(sb){this.removeHandler("CellEditingEnded",sb)}X6(){this.raiseEvent("FCPaneCollapsed");this.m2c();this.gpb=!1;O.ULS.sendTraceTag(508385100,
0,50,"TaskPane Collapsed")}TE(){this.raiseEvent("FCPaneClosed");this.m2c();window.setTimeout(()=>{this.dispose()},0);O.ULS.sendTraceTag(508385099,0,50,"TaskPane Closed")}uXj(){this.JK&&(this.isFloatingObjectSelected=this.da.ha.$e.isFloatingObjectSelected);if(!this.gpb)if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8593272_FormatCellSheetProtectionFix")&&!(new Ja.a(this.$.sa)).Wj(4))this.mkb.hideTaskPane();else switch(this.activePage){case qb.NumberFormatItemView:dc.VMd(this.$,this.properties,this.Nh).qVg(this.properties);
O.ULS.sendTraceTag(508389441,0,50,"NumberFormatTaskPane Opened");break;case qb.AlignmentItemView:dc.FJd(this.$,this.properties,this.Nh).MPa();O.ULS.sendTraceTag(508389440,0,50,"Alignment TaskPane Opened");break;case qb.FontItemView:dc.dCc(this.$,this.properties,this.Nh).G8b(qb.FontItemView);O.ULS.sendTraceTag(508078217,0,50,"Font tab opened");break;case qb.BorderItemView:dc.dCc(this.$,this.properties,this.Nh).G8b(qb.BorderItemView),O.ULS.sendTraceTag(507896131,0,50,"Border tab opened")}}dispose(){this.mkb=
this.$=null;this.gpb=!1;this.properties=null;jc.Va=null}L0k(){const sb=this;return Lo(function*(){var lc;if(null!==(lc=sb.properties)&&void 0!==lc&&lc.event){lc=sb.properties.event.rawEvent||sb.properties.event;var Uc=lc.type.includes("key")?"keyboard":"mouse";(yield Xa.a.resolve(Sa.Ed)).SA(lc,`task_pane_open_format_cell_${Uc}`,null,["task-pane"])}})}Mz(){this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.ha.$e.jO(this.Tu);this.$.ea&&(this.$.ea.dK(this.FYb),this.$.ea.VFa(this.CB));
this.$.fq(this.ej);this.R0a&&(this.da.Fh.iO(this.Uhg),this.da.Fh.bU(this.Vhg))}m2c(){this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);this.da.ha.$e.NV(this.Tu);this.$.ea&&(this.$.ea.gL(this.FYb),this.$.ea.EAa(this.CB));this.$.Wu(this.ej);this.R0a&&(this.da.Fh.qN(this.Uhg),this.da.Fh.mZ(this.Vhg))}sJa(){return{onItemClick:sb=>{if(this.JK||!this.isFloatingObjectSelected){this.activePage===qb.FormatCellsListView&&O.ULS.sendTraceTag(507597594,0,50,`User switched from Format Cells List View to ${qb[sb]}`);
var lc={};lc[yb.a.Uia]=!1;switch(sb){case qb.NumberFormatItemView:this.$.ti(-395879625,C.a.rh,12,lc);break;case qb.AlignmentItemView:this.$.ti(-2019948858,C.a.rh,12,lc);break;case qb.FontItemView:this.$.ti(456320978,C.a.rh,12,lc);break;case qb.BorderItemView:this.$.ti(119664190,C.a.rh,12,lc)}}},numberFormatCallbacks:this.hRi(),alignmentCallbacks:this.fEi()}}yMk(sb){switch(sb){case qb.AlignmentItemView:case qb.NumberFormatItemView:return!0;default:return!1}}}Object(M.a)(jc,"FormatCellsTaskPaneManager",
cb.a,[]);var tc=a(974),Kc=a(2);class wd{constructor(sb,lc,Uc){this.Z9=!1;this.yN=this.FBf=this.qw=null;this.X_b=-1;this.YYc=!0;this.cQ=!1;this.JK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.categoryDescriptionStrings=[xa.a.instance.ia(2306),xa.a.instance.ia(2307),xa.a.instance.ia(2308),xa.a.instance.ia(2309),xa.a.instance.ia(2310),xa.a.instance.ia(2311),xa.a.instance.ia(2312),xa.a.instance.ia(2313),xa.a.instance.ia(2314),xa.a.instance.ia(2315),
xa.a.instance.ia(2316),xa.a.instance.ia(2317)];this.logUserAction=od=>{this.yN[od]=this.yN[od]?this.yN[od]+1:1;this.yN.Total+=1};this.TE=()=>{this.dispose()};this.X6=()=>{this.z4g()};this.jNa=()=>{const od=this.numberFormatViewModel.RHc(4,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded"),sd=this.numberFormatViewModel.RHc(3,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");if(sd||od)this.lp.i8(qb.NumberFormatItemView,this.ZGf()),sd?(this.YYc?(this.numberFormatViewModel.formatCells(this.numberFormatViewModel.WZa(),
this.Nh),this.X_b=-1):this.YYc=!0,O.ULS.sendTraceTag(508355619,0,50,"NumberFormatViewModel Loaded by the TaskPane")):O.ULS.sendTraceTag(508355618,0,50,"NumberFormatViewModel Loaded by the Active Cell")};this.iNa=()=>{O.ULS.sendTraceTag(508889099,0,50,"NumberFormatTaskPaneManager.onNumberFormatViewModelFailedLoad - Webservice call failed")};this.onActiveCellChanged=(od,sd)=>{var be;if(sd&&sd.description===qb[qb.NumberFormatItemView]){this.logUserAction("ActiveCellChange");od=null===(be=ya.f(this.$).zh(null))||
void 0===be?void 0:be.cell;if(!this.JK&&this.lp.isFloatingObjectSelected||this.T0f(od))this.JK||(this.lp.isFloatingObjectSelected=!1),this.U5(!0,4);!ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&od&&(this.Umd=od)}};this.Tu=(od,sd)=>{sd&&sd.hId===qb.NumberFormatItemView&&(this.JK?0!==(sd.Ck&470)?this.lp.i8(qb.NumberFormatItemView,null):this.U5(!0,4):this.lp.i8(qb.NumberFormatItemView,null,!0))};this.CB=(od,sd)=>{var be,Ee;sd&&sd.description===qb[qb.NumberFormatItemView]&&
(od=null===(be=ya.f(this.$).zh(null))||void 0===be?void 0:be.cell,this.T0f(od)&&!this.cQ?(this.YYc=!1,this.U5(!0)):(this.cQ=!1,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&(this.X_b=null!==(Ee=null===od||void 0===od?void 0:od.qo)&&void 0!==Ee?Ee:-1)))};this.$=sb;this.properties=lc;this.Nh=Uc;this.lp=dc.FAc(this.$,this.properties,this.Nh);this.yN={Total:0}}static getInstance(sb,lc,Uc){return this.Va||(this.Va=new this(sb,lc,Uc))}qVg(sb){this.lp.i8(qb.NumberFormatItemView,
this.FBf);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8589523_AvoidApplyingFormatOnPaneOpen")&&(this.YYc=!1);this.U5(!0,3,sb)}dispose(){O.ULS.sendTraceTag(507875737,0,20,`Number format usage ${JSON.stringify(this.yN)}`);this.z4g();this.lp.Mie(this.TE);wd.Va=null}sJa(){return{onCategoryTypeChange:sb=>{this.logUserAction("CategoryTypeChange");this.qw.NumberFormatCategory=sb;this.cQ=!0;switch(sb){case 0:case 9:this.rla();break;default:this.U5()}O.ULS.sendTraceTag(508387598,0,50,`Number Format Category Changed ${sb}`)},
onThousandSeparatorChanged:sb=>{this.logUserAction("ThousandsSeparatorChange");this.qw.IsComma=sb;this.cQ=!0;this.U5();O.ULS.sendTraceTag(508368995,0,50,`Thousand Separator Changed ${sb}`)},onDecimalPlacesChanged:sb=>{this.logUserAction("DecimalPlacesChange");this.qw.DecimalPlaces=sb;this.cQ=!0;switch(this.qw.NumberFormatCategory){case 3:case 6:case 8:ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8507884_FixIncreaseDecreaseDecimalFlicker")?this.U5():this.rla();break;default:this.U5()}O.ULS.sendTraceTag(508368994,
0,50,`Decimal Places Changed ${sb}`)},onLocaleChanged:sb=>{this.logUserAction("LocaleChange");this.qw.LocaleType=sb;this.cQ=!0;this.U5();O.ULS.sendTraceTag(508389409,0,50,`Locale Changed ${sb}`)},overrideLocale:()=>{this.logUserAction("overrideLocale");this.cQ=!0;this.$.ti(151715844,C.a.rh,12,{selectedIndex:this.qw.LocaleType});O.ULS.sendTraceTag(508389408,0,50,`Override default Locale button clicked ${this.qw.LocaleType}`)},onInputCalendarChecked:sb=>{this.logUserAction("InputCalendarChecked");this.cQ=
!0;this.qw.IsInputCalendar=sb;this.U5();O.ULS.sendTraceTag(508387596,0,50,"Change in Input Calendar Type")},onGannenChecked:sb=>{this.logUserAction("GannenChecked");this.qw.IsGannen=sb;this.cQ=!0;this.U5();O.ULS.sendTraceTag(508389407,0,50,`Gannen changed ${this.qw.LocaleType} ${sb}`)},onCalendarTypeChanged:sb=>{this.logUserAction("CalendarTypeChange");this.qw.CalendarType=sb;this.cQ=!0;this.U5();O.ULS.sendTraceTag(508389406,0,50,`Calendar Type changed ${sb}`)},onSymbolChanged:sb=>{this.logUserAction("SymbolChange");
this.qw.CurrencyType=sb;this.cQ=!0;3===this.qw.NumberFormatCategory?this.rla():this.U5();O.ULS.sendTraceTag(508387595,0,50,`Currency Symbol changed ${sb}`)},onNegativeNumberTypeChanged:sb=>{this.logUserAction("NegativeNumberTypeChange");this.cQ=!0;this.qw.NegativeNumberType=sb;this.rla();O.ULS.sendTraceTag(508387594,0,50,`Negative Number Type changed ${sb}`)},onDateTypeChanged:sb=>{this.logUserAction("DateTypeChange");this.cQ=!0;this.qw.DateType=sb;this.rla();O.ULS.sendTraceTag(508387593,0,50,`Date Type Changed ${sb}`)},
onTimeTypeChanged:sb=>{this.logUserAction("TimeTypeChange");this.cQ=!0;this.qw.TimeType=sb;this.rla();O.ULS.sendTraceTag(508387592,0,50,`Time Type changed ${sb}`)},onFractionTypeChanged:sb=>{this.logUserAction("FractionTypeChange");this.cQ=!0;this.qw.FractionType=sb;this.rla();O.ULS.sendTraceTag(508387591,0,50,`Fraction Type changed ${sb}`)},onSpecialTypeChanged:sb=>{this.logUserAction("SpecialTypeChange");this.cQ=!0;this.qw.SpecialType=sb;this.rla();O.ULS.sendTraceTag(508387590,0,50,`Special Type changed ${sb}`)},
onCustomTypeChanged:sb=>{this.logUserAction("CustomTypeChange");this.cQ=!0;this.qw.CustomType=sb;this.rla();O.ULS.sendTraceTag(508387589,0,50,`CustomType changed ${sb}`)},onNegativeCurrencyTypeChanged:sb=>{this.logUserAction("NegativeCurrencyTypeChange");this.cQ=!0;this.qw.NegativeCurrencyType=sb;this.rla();O.ULS.sendTraceTag(508387588,0,50,`Negative Currency Type changed ${sb}`)}}}U5(sb,lc,Uc){lc=void 0===lc?3:lc;let od=null;if(this.activeCell=this.fzc())c("NumberFormatTab::DelayedUpdate::Start"),
Uc&&(Uc.currencyType||C.a.Qi in Uc&&Uc[C.a.Qi])&&(od=parseInt(Uc[C.a.Qi].toString(),10)),this.numberFormatViewModel?(this.Z9||this.LTc(),od||sb?this.C7f(od,lc,Uc):(this.qw.Caller=lc,this.numberFormatViewModel.OOb(this.activeCell,this.qw))):this.Y7h(od)}Y7h(sb){void Xa.a.resolve(Sa.ie,{va:0}).then(lc=>{this.numberFormatViewModel=lc;this.Z9||this.LTc();this.numberFormatViewModel.qle();this.C7f(sb)})}LTc(){this.Z9=!0;this.numberFormatViewModel.reb(this.jNa);this.numberFormatViewModel.Xod(this.iNa);this.lp.Jod(this.X6);
this.lp.Iod(this.TE);this.lp.add_activeCellChanged(this.onActiveCellChanged);this.lp.jO(this.Tu);this.lp.G4e(this.CB);O.ULS.sendTraceTag(508355648,0,50,"NumberFormatViewModel events Registered")}C7f(sb,lc,Uc){lc=void 0===lc?3:lc;sb=Object(Kc.a)(new tc.a,{Caller:lc,NumberFormatCategory:null!==sb&&void 0!==sb?sb:-1});Uc&&Uc.currencyType&&(sb.CurrencyType=Uc.currencyType,sb.NumberFormatCategory=3);this.numberFormatViewModel.OOb(this.activeCell,sb)}ZGf(sb){var lc=this.numberFormatViewModel.rp.NumberFormatElement.toString();
this.qw=sb=sb?this.bFf():this.numberFormatViewModel.WZa();return this.FBf=lc={numberFormatModel:{categories:this.numberFormatViewModel.rp.Categories,categoryDescriptionStrings:this.categoryDescriptionStrings,negativeNumberTypes:this.numberFormatViewModel.rp.NegativeNumberTypes,negativeCurrencyTypes:this.numberFormatViewModel.rp.NegativeCurrencyTypes,currencySymbols:this.numberFormatViewModel.rp.CurrencySymbols,dateTypes:this.numberFormatViewModel.rp.DateTypes,timeTypes:this.numberFormatViewModel.rp.TimeTypes,
fractionTypes:this.numberFormatViewModel.rp.FractionTypes,specialTypes:this.numberFormatViewModel.rp.SpecialTypes,customTypes:this.numberFormatViewModel.rp.CustomTypes,localeOptions:this.numberFormatViewModel.rp.Locales,calendarTypes:this.numberFormatViewModel.rp.Calendars,isInputCalendarCheckboxRequired:"57607"===lc||"319751"===lc?!0:!1,isGannenCheckboxRequired:"319751"===lc?!0:!1,currentCategory:sb.NumberFormatCategory,decimalPlaces:sb.DecimalPlaces,isComma:sb.IsComma,currencyType:sb.CurrencyType,
negativeNumberType:sb.NegativeNumberType,dateType:sb.DateType,timeType:sb.TimeType,fractionType:sb.FractionType,specialType:sb.SpecialType,customType:sb.CustomType,negativeCurrencyType:sb.NegativeCurrencyType,calendarType:sb.CalendarType,localeIndex:sb.LocaleType,isInputCalendarChecked:sb.IsInputCalendar,isGannenChecked:sb.IsGannen}}}fzc(){var sb,lc;let Uc;const od=ya.f(this.$),sd=od.ha.qa.activeCell;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")){var be=null===
(sb=od.zh(sd))||void 0===sb?void 0:sb.cell;this.X_b=null!==(lc=null===be||void 0===be?void 0:be.qo)&&void 0!==lc?lc:-1}else this.Umd=null===(be=od.zh(sd))||void 0===be?void 0:be.cell;sd&&(Uc=V.q(sd,this.$));return Uc}z4g(){this.Z9=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.Yub(this.jNa),this.numberFormatViewModel.bje(this.iNa),this.lp.Nie(this.X6),this.lp.remove_activeCellChanged(this.onActiveCellChanged),this.lp.NV(this.Tu),this.lp.BFg(this.CB),O.ULS.sendTraceTag(508355617,0,50,"NumberFormatViewModel events Un-registered"))}bFf(){const sb=
this.numberFormatViewModel.WZa();sb.NumberFormatCategory=this.qw.NumberFormatCategory;sb.NegativeNumberType=this.qw.NegativeNumberType;sb.NegativeCurrencyType=this.qw.NegativeCurrencyType;sb.DateType=this.qw.DateType;sb.TimeType=this.qw.TimeType;sb.FractionType=this.qw.FractionType;sb.SpecialType=this.qw.SpecialType;sb.CustomType=this.qw.CustomType;sb.DecimalPlaces=this.qw.DecimalPlaces;sb.CurrencyType=this.qw.CurrencyType;return sb}rla(){c("NumberFormatTab::InstantUpdate::Start");this.numberFormatViewModel.formatCells(this.bFf(),
this.Nh);this.X_b=-1;this.lp.i8(qb.NumberFormatItemView,this.ZGf(!0))}T0f(sb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")?sb&&sb.qo!==this.X_b:sb&&this.Umd&&sb.qo!==this.Umd.qo}}Object(M.a)(wd,"NumberFormatTaskPaneManager",null,[2]);class Rb{constructor(sb,lc,Uc){this.Z9=!1;this.activePage=qb.FormatCellsListView;this.isFloatingObjectSelected=!1;this.JK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.TE=()=>
{this.dispose()};this.X6=()=>{this.to()};this.onActiveCellChanged=(od,sd)=>{this.isFloatingObjectSelected&&sd&&sd.description===qb[this.activePage]&&(this.G8b(this.activePage),this.isFloatingObjectSelected=!1)};this.Tu=(od,sd)=>{sd&&sd.hId===this.activePage&&(this.isFloatingObjectSelected=!0,this.lp.i8(this.activePage,null,!0))};this.lp=dc.FAc(sb,lc,Uc);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&(this.reactRibbonRoot=sb.la.lh(337,!0))}static getInstance(sb,
lc,Uc){return this.Va||(this.Va=new this(sb,lc,Uc))}G8b(sb){this.lp.i8(sb,null);this.activePage=sb;this.Z9||this.Hp();ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&requestAnimationFrame(()=>{this.reactRibbonRoot.Dn()})}dispose(){this.to();this.lp.Mie(this.TE);Rb.Va=null}Hp(){this.lp.Jod(this.X6);this.lp.Iod(this.TE);this.JK||(this.lp.add_activeCellChanged(this.onActiveCellChanged),this.lp.jO(this.Tu));this.Z9=!0;O.ULS.sendTraceTag(508078168,0,50,"Events registered")}to(){this.lp.Nie(this.X6);
this.JK||(this.lp.remove_activeCellChanged(this.onActiveCellChanged),this.lp.NV(this.Tu));this.Z9=!1;O.ULS.sendTraceTag(508078167,0,50,"Events unregistered")}}Object(M.a)(Rb,"StoreConnectedItemViewTaskPaneManager",null,[2]);class dc{constructor(){}static FAc(sb,lc,Uc){return jc.getInstance(sb,lc,Uc)}static VMd(sb,lc,Uc){return wd.getInstance(sb,lc,Uc)}static FJd(sb,lc,Uc){return Id.getInstance(sb,lc,Uc)}static dCc(sb,lc,Uc){return Rb.getInstance(sb,lc,Uc)}}Object(M.a)(dc,"FormatCellsTaskPaneHelper",
null,[]);let $a=class{constructor(sb,lc){this.qK=lc;this.$=sb}Ri(){return!1}executeCommand(sb,lc,Uc){var od;sb=!1;const sd=lc.command;switch(sd){case 2055979337:dc.FAc(this.$,Uc,lc).i8(qb.FormatCellsListView,null);sb=!0;O.ULS.sendTraceTag(508369024,0,50,"FormatCellsTaskPane opened using FormatCells Command");break;case -395879625:dc.VMd(this.$,Uc,lc).qVg(Uc);sb=!0;O.ULS.sendTraceTag(508385094,0,50,"NumberFormat Tab in FormatCellsTaskPane opened using showNumberFormat");break;case -2019948858:dc.FJd(this.$,
Uc,lc).MPa();sb=!0;O.ULS.sendTraceTag(508385093,0,50,"Alignment Tab in FormatCellsTaskPane opened using showAlignmentPane");break;case 456320978:dc.dCc(this.$,Uc,lc).G8b(qb.FontItemView);sb=!0;O.ULS.sendTraceTag(508078218,0,50,"Font Tab in FormatCellsTaskPane opened.");break;case 119664190:dc.dCc(this.$,Uc,lc).G8b(qb.BorderItemView),sb=!0,O.ULS.sendTraceTag(507896130,0,50,"Border Tab in FormatCellsTaskPane opened.")}ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8607151_FormatTaskpaneFloatieUI")&&
(lc=null!==(od=Uc[yb.a.J9a])&&void 0!==od?od:0,sb&&9===lc&&this.qK.TVb()&&this.qK.OI());return sb?Ia.Task.Ua(!0):Z.a(sd)}Gi(sb,lc){switch(lc.command){case 2055979337:case -395879625:case -2019948858:case 456320978:case 119664190:return!0;default:return!1}}dj(){return!1}};$a=Object(K.__decorate)([Object(Xa.d)(Sa.yc),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.eb)())],$a);Object(M.a)($a,"FormatCellsCommandHandler",null,[43]);Object(Xa.b)(Sa.Bc)(sb=>Lo(function*(){const lc=yield Xa.a.resolve(Sa.Ic,
sb),Uc=yield Xa.a.resolve(Sa.E,sb);yield Uc.RUf;return new Wb(lc.getFormulaAnonymizer(Uc.config))}));class Wb{constructor(sb){this.sHh=sb}anonymize(sb,lc){return this.sHh.anonymize(sb,{row:lc.top-1,col:lc.left-1,rows:1,cols:1})}}Object(M.a)(Wb,"FormulaAnonymizer",null,[]);class rc{constructor(sb,lc,Uc,od){this.$=sb;this.formulaAssistanceUIControl=lc;this.cD=Uc;this.PF=od;this.NZb=oc.a.p0f();this.qya=this.COe=!1;this.lba={repairs:[],cell:null};this.da=Object(ya.f)(this.$);this.container=document.createElement("div");
this.$.domElement.appendChild(this.container)}get XKa(){return this.COe}set XKa(sb){this.COe=sb;this.PF.$o=sb}xQk(sb,lc,Uc,od){od=void 0===od?"beside":od;this.wrd("card");this.cD.hke("repair",lc.repairs.length);this.XKa=!0;const sd=this.Rud(sb),be=Object.assign({},lc,{callbacks:Uc,Ttl:od});this.lba={repairs:lc.repairs,cell:sb.xC};this.formulaAssistanceUIControl.renderFormulaRepair(this.container,sd,be);this.kAe=Ee=>{Ee=Object.assign({},be,{repairs:Ee});this.formulaAssistanceUIControl.renderFormulaRepair(this.container,
sd,Ee)}}RQk(sb,lc){this.wrd("card");this.cD.hke("errorIndication");this.XKa=!0;sb=this.Rud(sb);this.formulaAssistanceUIControl.renderSyntaxErrorIndication(this.container,sb,lc)}QOk(sb,lc){this.wrd("icon");this.cD.hke("icon");this.qya=!0;sb=this.Rud(sb);this.formulaAssistanceUIControl.renderFormulaRepairIcon(this.container,sb,lc)}hide(sb){let lc=!1;this.qya&&(lc=!0,this.qya=!1);this.XKa&&(this.NZb&&"commit"!==sb&&this.lba.repairs&&0<this.lba.repairs.length&&this.lba.cell&&this.cD.aae(this.lba),lc=
!0,this.XKa=!1,this.kAe=null);lc&&(this.formulaAssistanceUIControl.dismiss(this.container),this.cD.nqk(sb),this.lba={repairs:[],cell:null});return lc}wrd(sb){O.ULS.shipAssertTag(508315279,0,!this.XKa&&!this.qya,`FormulaRepairControl: Trying to show ${sb} while a ui is shown. Card: ${this.XKa}, icon:${this.qya}.`)}Rud(sb){sb=this.da.getCellBounds(sb,!0);return{top:sb.y,bottom:sb.y+sb.height,left:sb.x,right:sb.x+sb.width}}}Object(M.a)(rc,"FormulaRepairControl",null,[]);var xb=a(307),ic=a(7),Rc=a(305),
Zc=a(16);class Kd{constructor(sb,lc,Uc){this.$=sb;this.zne=lc;this.formulaAssistanceUIControl=Uc;this.rWa=!1}get $o(){return this.rWa}set $o(sb){this.rWa!==sb&&(sb?Rc.a(this.$).Tq(this):Rc.a(this.$).WH(this),this.rWa=sb)}get hl(){return this.zne}get hj(){return this.dt}set hj(sb){this.dt=sb}Up(sb,lc){sb=!1;lc||(sb=this.formulaAssistanceUIControl.focusElement(this.hj));return sb}sq(sb){return null!=this.hj?Zc.DOMElementExtensions.eo(this.hj,sb):!1}Js(){}lu(){}}Object(M.a)(Kd,"FormulaRepairFocusManager",
null,[52]);var fe=a(283),Ld=a(649);class Gd{constructor(sb,lc,Uc,od,sd){this.$=sb;this.pluginScheduler=lc;this.A3g=Uc;this.cD=od;this.wBe=sd;this.n0d=oc.a.CHc();this.isValuePreviewEnabled=this.Z0f=this.r_d=!1;this.wSc=this.ttc=null;this.Lr={id:0,active:!1,cell:null};this.onActiveCellChanged=(be,Ee)=>{var Ie,bf;this.r_d=!1;this.Lr.active&&Object(xb.b)(Ee.cell)&&Ee.cell.range.toString()===(null===(Ie=this.Lr.cell)||void 0===Ie?void 0:Ie.xC.toString())||(Object(xb.b)(this.wSc)?(be=null===(bf=this.da.zh(this.wSc))||
void 0===bf?void 0:bf.cell,void this.CVc("editCommitted",be),this.wSc=null):(this.hide("selection"),void this.CVc("selection")))};this.onScroll=()=>{this.hide("scroll")};this.N0j=(be,Ee)=>{const Ie=this.Lr.cell;if(Object(xb.c)(be))this.control.RQk(Ie,this.sJa("SyntaxErrorIndication"));else{this.ttc=be;var bf;this.isValuePreviewEnabled&&(bf=this.gni(this.ttc.repairs));this.Ikj&&"editCommitted"!==Ee?this.Fxb("icon"):this.isValuePreviewEnabled?void this.kel(bf):this.Fxb("card")}};this.Fxb=be=>{this.Z0f||
this.da.domElement.addEventListener("scroll",this.onScroll);"card"===be?this.control.xQk(this.Lr.cell,this.ttc,this.sJa("FormulaRepairCard"),this.QSi()):"icon"===be&&this.control.QOk(this.Lr.cell,this.RUj)};this.RUj=()=>{this.control.hide("commit");this.Fxb("card")};this.sJa=be=>({onCommit:this.onCommit,onFeedback:this.onFeedback(be),onDismiss:this.onDismiss,onIgnore:this.onIgnore,onRender:this.onRender,getItemHighlights:this.JUi});this.onCommit=be=>{const Ee=this.Lr.cell.xC;this.da.setCell({Text:be.text,
Fonts:[],TextRuns:[]},Ee,0,127,null);this.n0d&&this.cD.o0d.frg({Aq:Ee,cellText:be.text,committed:!0});this.hide("commit")};this.onDismiss=()=>{this.ttc=null};this.onIgnore=()=>{this.dsg("ignore")};this.onFeedback=be=>()=>{const Ee={};Ee[ic.a.ZO]=be;this.$.ti(802602464,0,19,Ee)};this.onRender=be=>{be&&(this.PF.hj=be)};this.ejk=be=>{const Ee=this.Lr.id,Ie=()=>{this.Lr.id===Ee&&void this.CVc(be,this.Lr.cell);this.da.za.px(Ie)};this.da.za.iy(Ie)};this.JUi=be=>{this.DD||O.ULS.sendTraceTag(508347539,0,
15,"FormulaRepair.getRepairItemHighlights: formulaHighlightsControl is null");var Ee=this.DD.uYi(be.text,[Ld.HighlightKind.Parentheses]);if(!Ee)return null;const Ie=Ee.highlightRanges;var bf=Ee.f1c;Ee=[];var Xe=0;for(var Ze=0;Ze<bf.length;Ze++){const tf=bf[Ze];Ee.push({start:Xe,end:Xe+tf.text.length,color:tf.color});Xe+=tf.text.length}be=be.repairedFormulaParts;bf=[];for(Ze=Xe=0;Xe<be.length&&Ze<Ee.length;)bf.push({location:{start:Math.max(be[Xe].location.start,Ee[Ze].start),end:Math.min(be[Xe].location.end,
Ee[Ze].end)},type:be[Xe].type,color:Ee[Ze].color}),be[Xe].location.end<Ee[Ze].end?Xe++:(be[Xe].location.end>Ee[Ze].end||Xe++,Ze++);return{coloredParts:bf,highlightRanges:Ie}};this.Cn=()=>{this.hide("edit")};this.Rl=(be,Ee)=>{be=Ee.committed;const Ie=Ee.YHa;Ee=Ee.Aq;const bf="keydown"===(null===Ie||void 0===Ie?void 0:Ie.type);!be||!bf||null!==Ie&&void 0!==Ie&&Ie.ctrlKey?bf&&void this.CVc(be?"editCommitted":"editDismissed"):this.wSc=Ee};this.da=Object(ya.f)(this.$);this.PF=new Kd(this.$,fe.a.ZBf,this.A3g);
this.control=new rc(this.$,this.A3g,od,this.PF);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.Fh.iO(this.Cn);this.da.Fh.jy(this.Rl);Sa.Ec.Aa()?void Xa.a.rj(Sa.Ec).then(be=>{this.DD=be.DD}):this.$.la.fi(464,be=>{this.DD=be.DD});this.isValuePreviewEnabled=oc.a.coa();this.Ikj=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRepairIcon",!1)&&"renderFormulaRepairIcon"in Uc}dsg(sb){this.hide(sb)&&(this.r_d=!0)}CVc(sb,lc){lc=void 0===lc?null:lc;const Uc=this;return Lo(function*(){var od;
if(!Uc.da.isEditing&&!Uc.r_d){var sd=null!==lc&&void 0!==lc?lc:null===(od=Uc.da.zh(null))||void 0===od?void 0:od.cell;Uc.Lr={active:!1,id:Uc.Lr.id+1,cell:sd};Uc.da.za.a6()?!Object(xb.c)(sd)&&sd.hasError&&(Uc.Lr.active=!0,Uc.cD.addressable.selected++,od=Uc.pluginScheduler.requester().formulaRepair({formula:Uc.Lr.cell.text},Ld.PluginGroup.Excel,null),od=yield Uc.tCe(od),Object(xb.c)(od)||"Done"!==od.kind?Uc.Lr.active=!1:Uc.N0j(od.payload,sb)):Uc.ejk(sb)}})}kel(sb){const lc=this;return Lo(function*(){let Uc;
var od=new Promise(sd=>{Uc=setTimeout(()=>{sd(!0)},100)});od=Promise.race([od,sb]).finally(()=>clearTimeout(Uc));(yield lc.tCe(od))&&lc.Fxb("card")})}gni(sb){const lc=this;return Lo(function*(){const Uc=Array(sb.length);for(let sd=0;sd<sb.length;sd++){var od=lc.wBe.Pke({text:sb[sd].text,index:0,length:sb[sd].text.length},2E3,!1);if((od=yield lc.tCe(od))&&"Success"===od.kind)Uc[sd]=od.value;else return!1}sb.forEach((sd,be)=>sd.formulaValue=Uc[be]);lc.control.XKa&&Object(xb.b)(lc.control.kAe)&&lc.control.kAe(sb);
return!0})}tCe(sb){const lc=this;return Lo(function*(){const Uc=lc.Lr.id,od=yield sb;return lc.Lr.id===Uc&&lc.Lr.active?od:null})}hide(sb){this.Lr.active=!1;this.Lr.cell=null;this.Z0f&&this.da.domElement.removeEventListener("scroll",this.onScroll);return this.control.hide(sb)}QSi(){const sb=this.da.ha.qa.activeCell,lc=this.Lr.cell.xC;if(sb&&lc&&sb.left!==lc.left)return"below"}}Object(M.a)(Gd,"FormulaRepair",null,[]);Object(Xa.b)(Sa.Rc,{Ek:"singleton"})(sb=>Lo(function*(){var lc;const Uc=yield Xa.a.resolve(Sa.Nb,
sb),od=Xa.a.resolve(ma.g,sb),sd=Object(da.e)(Va.GetServiceTaskFactory.Tj(Uc.la,448,449,null!==(lc=sb.va)&&void 0!==lc?lc:0));var be=Sa.Ec.Aa();lc=be?Promise.resolve(void 0):Xa.a.resolve(Sa.Wc,sb);be=be?Xa.a.resolve(Sa.Ec,sb):Promise.resolve(void 0);const Ee=Xa.a.resolve(Sa.Sc,sb),Ie=Xa.a.resolve(Sa.Hc,sb),[bf,Xe,Ze,tf,ff]=yield Promise.all([od,sd,lc,Ee,Ie,be]);return new Gd(Uc,bf,Xe,tf,ff,Ze)}));class Zd{constructor(sb){this.$=sb;this.lba=null;this.M4d=0;this.Rl=(lc,Uc)=>{this.to();this.Wjj(Uc)&&
this.M4d++;this.lba=null};this.da=ya.f(this.$)}aae(sb){this.lba=sb;this.registerEvent()}registerEvent(){this.da.cellTextEditBox.bU(this.Rl)}to(){this.da.cellTextEditBox.mZ(this.Rl)}Wjj(sb){return sb.committed&&null!==this.lba&&sb.Aq.equals(this.lba.cell)&&this.lba.repairs.some(lc=>lc.text.toLowerCase().replace(/\s+/g,"")===sb.cellText.toLowerCase().replace(/\s+/g,""))}}Object(M.a)(Zd,"ManualFormulaRepairTelemetry",null,[]);let Bc=class{constructor(sb,lc){this.o0d=sb;this.$=lc;this.n0d=oc.a.CHc();
this.NZb=oc.a.p0f();this.id=0;this.Vya=null;this.Tk={reportName:"FormulaRepair",addressable:{selected:0,committed:0},repairUsage:b(),indicationUsage:b(),iconUsage:b()};this.Tk.repairUsage.keptData=this.o0d.nMd();this.NZb&&(this.L4d=new Zd(this.$),this.Tk.repairUsage.manualRepair=this.L4d.M4d);this.repairUsage=this.Tk.repairUsage;this.indicationUsage=this.Tk.indicationUsage;this.iconUsage=this.Tk.iconUsage;this.addressable=this.Tk.addressable;this.$ik()}hke(sb,lc){switch(sb){case "repair":this.eHb=
this.repairUsage;this.eHb.show.repairCounts.push(lc);break;case "icon":this.eHb=this.iconUsage;break;case "errorIndication":this.eHb=this.indicationUsage}this.eHb.show.count++;this.Vya=performance.now();this.VVf()}nqk(sb){if(null!==this.Vya){const lc=performance.now()-this.Vya;this.eHb.hideDurations[sb].push(lc)}else O.ULS.sendTraceTag(508370960,1,10,"FormulaRepairTelemetry.reportHide: lastShowTime is null");this.VVf();this.Vya=null}aae(sb){this.NZb&&this.L4d.aae(sb)}$ik(){this.$.la.fi(276,sb=>{sb.O3(this.Tk)})}VVf(){O.ULS.sendTraceTag(509137429,
1,50,`${JSON.stringify({id:this.id++,addressable:this.addressable,repairUsage:this.repairUsage,indicationUsage:this.indicationUsage,keptData:this.n0d?this.o0d.nMd():"",manualRepair:this.NZb?this.L4d.M4d:""})}`)}};Bc=Object(K.__decorate)([Object(Xa.d)(Sa.Sc),Object(K.__param)(0,Object(Sa.Hd)()),Object(K.__param)(1,Object(Sa.Nb)())],Bc);Object(M.a)(Bc,"FormulaRepairTelemetry",null,[]);var Lc=a(29),Cd=a(925),Fd=a(116),te=a(485);class ye{static getSelection(sb,lc,Uc){var od=sb.qa;sb=od.activeCell.clone();
od=od.activeRange;od.qk&&(O.ULS.sendTraceTag(507556643,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${sb.top}) and firstUnfreezeCell.Bottom (${sb.bottom}) to equal topLeftRange.Top (${lc.top})`),sb.top=sb.bottom=lc.top);od.isRow&&(O.ULS.sendTraceTag(507556642,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${sb.left}) and firstUnfreezeCell.Right (${sb.right}) to equal topLeftRange.Left (${lc.left})`),
sb.left=sb.right=lc.left);if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(Uc.command){case -73576432:case -1156879868:sb.top===sb.maxRows&&(sb.top=sb.bottom=sb.maxRows-1);break;case -1564089444:case -1929078919:sb.left===sb.maxColumns&&(sb.left=sb.right=sb.maxColumns-1)}return sb}static VWb(sb,lc){if(sb.bG(lc))return!0;for(const Uc of sb.Uu){if(!sb.fh.HD(Uc.paneType))continue;const od=sb.yl(lc,Uc.paneType),sd=Uc.Vr;if(od&&sd&&ye.jVb(od,sd))return!0}return!1}static jVb(sb,
lc){return!sb||lc.topLeft.y>sb.bottomRight.y||lc.topLeft.x>sb.bottomRight.x||lc.bottomRight.y<sb.bottomRight.y||lc.bottomRight.x<sb.bottomRight.x?!1:!0}static AP(sb,lc,Uc,od){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var sd="FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",be={};be.operationType=te.a(lc.command);be.isSuccessful=Uc;be.preExistingPanes=sb.fh.By;be.message=od?od:"";sd+=ab.a.Ci(be);O.ULS.sendTraceTag(507556641,0,50,sd)}}static DLc(sb,
lc,Uc,od){O.ULS.sendTraceTag(507381773,0,50,JSON.stringify({preExistingPanes:sb.fh.By,message:"",dragOrigin:lc,dragDirection:Uc,eventName:od}))}static sRb(sb){var lc,Uc=null!==(lc=sb.Mlb())&&void 0!==lc?lc:sb.E5();if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix"))return lc=sb.kj,sb=Math.max(Uc.top,lc.I0(Uc.top,!0,!0)),Uc=Math.max(Uc.left,lc.I0(Uc.left,!1,!0)),{rowNumber:sb,columnNumber:Uc};lc=sb.X$(!0);sb=sb.X$(!1);return{rowNumber:lc>Uc.top?lc:Uc.top,columnNumber:sb>
Uc.left?sb:Uc.left}}}Object(M.a)(ye,"FreezePanesUtils",null,[]);var ue=a(137),De;(function(sb){sb[sb.HORIZONTAL=0]="HORIZONTAL";sb[sb.VERTICAL=1]="VERTICAL";sb[sb.BOTH=2]="BOTH"})(De||(De={}));Object(M.b)("FreezePanesPreviewDirection",De);var Ke;(function(sb){sb[sb.TOPLEFT=0]="TOPLEFT";sb[sb.BOTTOMRIGHT=1]="BOTTOMRIGHT"})(Ke||(Ke={}));Object(M.b)("FreezePanesPreviewPosition",Ke);class pe{constructor(sb){this.da=sb}r6h(sb){pe.fEa||sb===De.VERTICAL||(pe.fEa=document.createElement("div"),pe.fEa.classList.add(Lc.Gb),
pe.fEa.role="presentation",this.da.yn.appendChild(pe.fEa));pe.iea||sb===De.HORIZONTAL||(pe.iea=document.createElement("div"),pe.iea.classList.add(Lc.Hb),pe.iea.role="presentation",this.da.yn.appendChild(pe.iea))}LGd(sb,lc){lc=void 0===lc?Ke.BOTTOMRIGHT:lc;var Uc=this.da.fh.IJ,od=this.da.fh.CL;var sd=this.da.fh.Rm;const be=this.da.fh.fn,{EJ:Ee,BB:Ie}=this.da.D5(),bf=this.da.kj;if(bf){var Xe=this.D0(bf,Ee.top,Ee.left);lc=this.D0(bf,sb.top+lc,sb.left+lc);var Ze=this.D0(bf,sd,be);var tf=Ie.x+Xe.wk-Ze.wk,
ff=Ie.y+Xe.lk-Ze.lk;Xe=this.da.ps;var ef=this.da.qC;Ze=ef+lc.lk-ff;0<Uc&&(Uc=this.Iwa(bf,0,0),Ze=sb.top<sd?ef+lc.lk-Uc.lk:ef+lc.lk-Uc.lk-ff);sd=Xe+lc.wk-tf;0<od&&(od=this.Iwa(bf,0,0),sd=be>sb.left?Xe+lc.wk-od.wk:Xe+lc.wk-od.wk-tf);return{Bmb:sd,Tzb:Ze}}}Cxb(sb,lc,Uc){Uc=void 0===Uc?Ke.BOTTOMRIGHT:Uc;sb=this.LGd(sb,Uc);void 0!==sb?this.VOk(sb.Bmb,sb.Tzb,lc):Ia.Task.Ua(!1)}VOk(sb,lc,Uc){this.r6h(Uc);Uc!==De.BOTH&&Uc!==De.HORIZONTAL||!this.JTh(lc)||(pe.fEa.style.top=Nb.HelperMethods.Ki(Math.max(lc,this.da.qC)));
Uc!==De.BOTH&&Uc!==De.VERTICAL||!this.NTh(sb)||(this.da.rtl?(pe.iea.style.left="unset",pe.iea.style.right=Nb.HelperMethods.Ki(Math.max(sb,this.da.ps))):(pe.iea.style.right="unset",pe.iea.style.left=Nb.HelperMethods.Ki(Math.max(sb,this.da.ps))));Ia.Task.Ua(!0)}JTh(sb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?sb>=this.da.yn.clientHeight-ue.a.Zx?(this.CKa(De.HORIZONTAL),!1):!0:!0}NTh(sb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?
sb>=this.da.yn.clientWidth-ue.a.Zx?(this.CKa(De.VERTICAL),!1):!0:!0}CKa(sb){sb=void 0===sb?De.BOTH:sb;sb!==De.HORIZONTAL&&sb!==De.BOTH||!pe.fEa||(this.da.yn.removeChild(pe.fEa),pe.fEa=null);sb!==De.VERTICAL&&sb!==De.BOTH||!pe.iea||(this.da.yn.removeChild(pe.iea),pe.iea=null);return Ia.Task.Ua(!0)}D0(sb,lc,Uc){return sb.JU(Fd.a.vi(lc,Uc))}Iwa(sb,lc,Uc){const {rowNumber:od,columnNumber:sd}=ye.sRb(this.da);return this.D0(sb,od+lc,sd+Uc)}freezePanesRowAndColumnPreview(sb,lc){let Uc=!0,od=!0,sd=Ke.TOPLEFT;
var be=this.da.kj;if(!be)return ye.AP(this.da,sb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);lc=ye.getSelection(this.da.ha,lc,sb);if(!ye.VWb(this.da,lc))return ye.AP(this.da,sb,!0,"Preview not shown as selection is not in visible area"),Ia.Task.Ua(!0);switch(sb.command){case -1006176541:var Ee=this.da.fh.Rm;const bf=this.da.fh.fn,{EJ:Xe,BB:Ze}=this.da.D5(),tf=this.Iwa(be,0,0);var Ie=this.D0(be,Xe.top,Xe.left);const ff=this.D0(be,lc.top,lc.left);be=this.D0(be,Ee,bf);Ee=Ze.x+Ie.wk-be.wk;
Ie=Ze.y+Ie.lk-be.lk;if(ff.lk===tf.lk&&ff.wk===tf.wk)return this.g2b(sb);if(ff.lk===tf.lk||ff.lk<=tf.lk||ff.sJ>=be.sJ&&ff.lk<be.lk+Ie)Uc=!1;if(ff.lk===tf.lk&&ff.wk===tf.wk||ff.wk<=tf.wk||ff.GI>=be.GI&&ff.wk<be.wk+Ee)od=!1;break;case -1156879868:sd=Ke.BOTTOMRIGHT;od=!1;break;case -1929078919:sd=Ke.BOTTOMRIGHT;Uc=!1;break;default:return ye.AP(this.da,sb,!1,"Unexpected preview Ribbon Command"),Ia.Task.Ua(!0)}od&&this.Cxb(lc,De.VERTICAL,sd);Uc&&this.Cxb(lc,De.HORIZONTAL,sd);ye.AP(this.da,sb,!0);return Ia.Task.Ua(!0)}g2b(sb){const {rowNumber:lc,
columnNumber:Uc}=ye.sRb(this.da),od=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Ea.Range.vi(lc,Uc):this.da.E5();this.Cxb(od,De.HORIZONTAL,Ke.BOTTOMRIGHT);ye.AP(this.da,sb,!0);return Ia.Task.Ua(!0)}Pbe(sb){const {rowNumber:lc,columnNumber:Uc}=ye.sRb(this.da),od=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Ea.Range.vi(lc,Uc):this.da.E5();this.Cxb(od,De.VERTICAL,Ke.BOTTOMRIGHT);ye.AP(this.da,sb,!0);return Ia.Task.Ua(!0)}}Object(M.a)(pe,
"FreezePanesPreviewManager",null,[]);var pf;(function(sb){sb.HORIZONTAL="horizontal";sb.VERTICAL="vertical"})(pf||(pf={}));Object(M.b)("FreezePanesDragDirection",pf);var qf;(function(sb){sb.HEADER="header";sb.FREEZEPANELINE="freezepaneline"})(qf||(qf={}));Object(M.b)("FreezePaneDragOrigin",qf);let of=class{constructor(sb,lc){this.da=sb;this.sA=lc;this.Edb=this.nbb=null;this.uLe=!1;this.$ad=this.Fdb=this.obb=this.Y_e=this.tNe=null;this.eEa=this.zFa=qf.HEADER;this.Nlg=Uc=>{Uc.preventDefault();this.tNe=
Uc.clientY;this.sA.startTrackAnimation(Uc,this.eEa===qf.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");this.N5e(pf.HORIZONTAL);this.NQ||(this.NQ=document.createElement("div"),this.NQ.classList.add(Lc.Db),this.da.yn.appendChild(this.NQ));this.$ad=this.da.yn.getBoundingClientRect();this.NQ.style.display="block";this.NQ.style.top=Uc.clientY/this.da.FW-this.$ad.top+"px";this.NQ.setPointerCapture(Uc.pointerId);this.NQ.style.cursor="grabbing";ye.DLc(this.da,this.eEa,pf.HORIZONTAL,
"FreezePaneDragStarted");this.NQ.addEventListener("pointermove",this.Llg);this.NQ.addEventListener("pointerup",this.Mlg);this.NQ.addEventListener("pointercancel",this.Klg)};this.msg=Uc=>{this.sA.startTrackAnimation(Uc,this.zFa===qf.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");Uc.preventDefault();this.Y_e=Uc.clientX;this.N5e(pf.VERTICAL);this.XQ||(this.XQ=document.createElement("div"),this.XQ.classList.add(Lc.Ib),this.da.yn.appendChild(this.XQ));this.XQ.style.display=
"block";this.XQ.style.left=Uc.clientX/this.da.FW+"px";this.XQ.setPointerCapture(Uc.pointerId);this.XQ.style.cursor="grabbing";ye.DLc(this.da,this.zFa,pf.VERTICAL,"FreezePaneDragStarted");this.XQ.addEventListener("pointermove",this.ksg);this.XQ.addEventListener("pointerup",this.lsg);this.XQ.addEventListener("pointercancel",this.jsg)};this.Llg=Uc=>{const od=Nb.HelperMethods.Ki(this.da.qC),sd=Nb.HelperMethods.Ki(Uc.clientY/this.da.FW-this.$ad.top),be=`calc(100% - ${Nb.HelperMethods.Ki(ue.a.Zx)} - 2px)`;
this.NQ.style.top=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${od}, ${sd}, ${be})`:sd;(this.obb=this.vwi(Uc))?this.aEa.Cxb(this.obb,0):this.aEa.CKa(0)};this.ksg=Uc=>{const od=this.da.rtl?Nb.HelperMethods.Ki(ue.a.Zx):Nb.HelperMethods.Ki(this.da.ps),sd=Nb.HelperMethods.Ki(Uc.clientX/this.da.FW),be=`calc(100% - ${Nb.HelperMethods.Ki(this.da.rtl?this.da.ps:ue.a.Zx)} - 2px)`;this.XQ.style.left=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?
`clamp(${od}, ${sd}, ${be})`:sd;(this.Fdb=this.Rwi(Uc))?this.aEa.Cxb(this.Fdb,1):this.aEa.CKa(1)};this.Klg=Uc=>this.Jlg(Uc,!0);this.jsg=Uc=>this.isg(Uc,!0);this.lsg=Uc=>this.isg(Uc,!1);this.Mlg=Uc=>this.Jlg(Uc,!1);this.Jlg=(Uc,od)=>{const sd=performance.now();ye.DLc(this.da,this.eEa,pf.HORIZONTAL,od?"FreezePaneDragCancelled":"FreezePaneDragEnded");this.NQ.style.display="none";this.NQ.removeEventListener("pointermove",this.Llg);this.NQ.removeEventListener("pointerup",this.Mlg);this.NQ.removeEventListener("pointercancel",
this.Klg);this.aEa.CKa(0);this.sA.stopTrackAnimation(this.eEa===qf.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");if(this.tNe===Uc.clientY)return!0;this.obb?this.da.$.ti(-73576432,2,30,{dragProperties:{dragDirection:pf.HORIZONTAL,dragOrigin:this.eEa,target:this.$Fh(this.obb),dragReleasedTime:sd}}):this.da.$.ti(83934709,2,30,{dragProperties:{dragDirection:pf.HORIZONTAL,dragOrigin:this.eEa,target:null,dragReleasedTime:sd,unfreeze:!0}});this.obb=null;return!0};this.isg=
(Uc,od)=>{const sd=performance.now();this.XQ.style.display="none";ye.DLc(this.da,this.zFa,pf.VERTICAL,od?"FreezePaneDragCancelled":"FreezePaneDragEnded");this.XQ.removeEventListener("pointermove",this.ksg);this.XQ.removeEventListener("pointerup",this.lsg);this.XQ.removeEventListener("pointercancel",this.jsg);this.aEa.CKa(1);this.sA.stopTrackAnimation(this.zFa===qf.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");if(this.Y_e===Uc.clientX)return!0;this.Fdb?this.da.$.ti(-1564089444,
2,30,{dragProperties:{dragDirection:pf.VERTICAL,dragOrigin:this.zFa,target:this.ZFh(this.Fdb),dragReleasedTime:sd}}):this.da.$.ti(83934709,2,30,{dragProperties:{dragDirection:pf.VERTICAL,dragOrigin:this.zFa,target:null,dragReleasedTime:sd,unfreeze:!0}});this.Fdb=null;return!0};this.vwi=Uc=>{const {position:od,area:sd,wgf:be}=this.Kzf(Uc);if(!be)return null;if(od.y-sd.topLeft.y<sd.height/2){Uc=this.da.kj.DQb(be);Uc=Ea.Range.vi(Uc.top,Uc.left);if(Uc.equals(be))return null;const Ee=this.aEa.LGd(Uc);
return void 0!==Ee&&Ee.Tzb<=this.da.qC?null:Uc}return be};this.Rwi=Uc=>{const {position:od,area:sd,wgf:be}=this.Kzf(Uc);if(null===be)return null;if(od.x-sd.topLeft.x<sd.width/2){Uc=this.da.kj.LRb(be);Uc=Ea.Range.vi(Uc.top,Uc.left);if(Uc.equals(be))return null;const Ee=this.aEa.LGd(Uc);return void 0!==Ee&&Ee.Bmb<=this.da.ps?null:Uc}return be};this.aEa=new pe(this.da)}ccj(){this.nbb&&this.Edb||(this.nbb=Zc.DOMElementExtensions.getElementById(this.da.yn,ic.a.fCf),this.Edb=Zc.DOMElementExtensions.getElementById(this.da.yn,
ic.a.gCf));this.uLe||(this.nbb.addEventListener("pointerdown",this.Nlg),this.Edb.addEventListener("pointerdown",this.msg),this.uLe=!0)}X5g(sb,lc){sb?(this.nbb.className=Lc.Eb,this.eEa=qf.FREEZEPANELINE):(this.nbb.className=Lc.Jb,this.eEa=qf.HEADER);lc?(this.Edb.className=Lc.Fb,this.zFa=qf.FREEZEPANELINE):(this.Edb.className=Lc.Kb,this.zFa=qf.HEADER)}dispose(){this.nbb.removeEventListener("pointerdown",this.Nlg);this.Edb.removeEventListener("pointerdown",this.msg);this.NQ&&this.da.yn.removeChild(this.NQ);
this.XQ&&this.da.yn.removeChild(this.XQ)}N5e(sb){const lc=this.da.fh;if(lc.By){var Uc=lc.IJ,od=lc.CL;sb===pf.HORIZONTAL&&0<Uc?this.da.AC(Ea.Range.IU(lc.Rm,lc.Rm,!0),60,"FreezePaneDragAction.adjustScroll"):sb===pf.VERTICAL&&0<od&&this.da.AC(Ea.Range.ZX(lc.fn,lc.fn,!0),60,"FreezePaneDragAction.adjustScroll")}}Kzf(sb){var lc=new Sys.UI.DomEvent(sb);sb=new Sys.UI.Point(sb.clientX/this.da.FW,sb.clientY/this.da.FW);lc=this.da.ha.a4(sb,lc.target,-1,!0);const Uc=this.da.yl(lc,this.da.paneType,!0),od=this.da.sl(this.da.paneType);
return{position:Cd.a.az(od.view.xn,this.da.domElement.parentNode,sb,this.da.rtl),area:Uc,wgf:lc}}$Fh(sb){return sb&&sb.top===gc.a.fl?Object(V.E)(this.da.kj.DQb(sb)):sb}ZFh(sb){return sb&&sb.left===gc.a.Nk?Object(V.E)(this.da.kj.LRb(sb)):sb}};of=Object(K.__decorate)([Object(Xa.d)(Sa.Tc),Object(K.__param)(0,Object(Sa.id)()),Object(K.__param)(1,Object(Sa.Ed)())],of);Object(M.a)(of,"FreezePaneDragAction",null,[354,2]);var Ef=a(667),Nf=a(94);class Kf{}Object(M.a)(Kf,"FreezePanesCommandParameters",null,
[]);var Qf=a(407),Hf=a(32),If=a(311),ac=a(275);class Yb{constructor(sb){this.freezeOptions=null;this.freezeOptions=sb}getSheetName(){return this.freezeOptions.SheetName}}Object(M.a)(Yb,"MacroRecorderSheetPaneFrozenPayload",null,[146]);var Cc=a(44),Of=a(308),Qb=a(19),Ic,hd;(function(sb){sb[sb.horizontal=0]="horizontal";sb[sb.vertical=1]="vertical"})(hd||(hd={}));Object(M.b)("Direction",hd);var Ga;(function(sb){sb.DRAG_HANDLE="DRAG_HANDLE";sb.RIBBON="RIBBON"})(Ga||(Ga={}));Object(M.b)("FreezePanesRequestInitiator",
Ga);let Ub=Ic=class{constructor(sb,lc,Uc,od){this.$=sb;this.da=Uc;this.xkb=this.Ree=null;this.AOb=this.BDd=this.a9f=this.btf=this.ajb=!1;this.Gja=Qb.a.BD;this.Och=ic.a.hCf;this.qfh=ic.a.iCf;this.AId=this.iZa=this.s1a=!1;this.Naa=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8683456_FreezePanePreviewRefactor");this.OMd=(sd,be,Ee,Ie)=>{const bf=this.da.fh,Xe=this.da.BR(),Ze=bf.IJ,tf=bf.CL;let ff=0,ef=0,Sf=0,zf=0;const sf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8528403_FixFreezePaneCalcWhenGridUnderPane");
switch(sd.command){case 1844679312:ff=Ee.top-1;ef=Ee.left-1;Sf=ff-(be.top-1);zf=ef-(be.left-1);sf&&bf.By&&(Ze&&Xe&&Sf>=Xe.bottom-Xe.top+1+Ze&&(Sf=Ze+(Ee.top-Xe.top)+1),tf&&Xe&&zf>=Xe.right-Xe.left+1+tf&&(zf=tf+(Ee.left-Xe.left)+1));break;case -73576432:ff=Ee.top;Sf=ff-(be.top-1);sf&&bf.By&&Ze&&Xe&&Sf>=Xe.bottom-Xe.top+1+Ze&&(Sf=Ze+(Ee.top-Xe.top)+1);Ie&&(ef=bf.fn-1,zf=ef-be.left+1,sf&&bf.By&&tf&&Xe&&zf>=Xe.right-Xe.left+1+tf&&(zf=tf+(bf.fn-Xe.left)+1));break;case -1564089444:ef=Ee.left,zf=ef-(be.left-
1),sf&&bf.By&&tf&&Xe&&zf>=Xe.right-Xe.left+1+tf&&(zf=tf+(Ee.left-Xe.left)+1),Ie&&(ff=bf.Rm-1,Sf=ff-be.top+1,sf&&bf.By&&Ze&&Xe&&Sf>=Xe.bottom-Xe.top+1+Ze&&(Sf=Ze+(bf.Rm-Xe.top)+1))}return{Hbe:ff,Gbe:ef,FId:Sf,EId:zf}};this.Mkg=()=>{ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8593029_RevertFPLinesIfExist")&&(this.Naa?this.jZa.CKa():this.dxg());ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8551192_HighlightSelectionPostFreezeOp")&&
(this.da.Gh.Azb(),this.da.Gh.Cca());if(this.xkb){const sd=If.a(Hf.a.ih.$j,this.xkb);Ic.oJ.totalDuration=sd;const be=Ic.oJ;this.btf?window.requestIdleCallback?window.requestIdleCallback(()=>{this.z2e(be);this.J9d(be)}):window.setTimeout(()=>{this.z2e(be);this.J9d(be)},100):this.J9d(be)}Ic.oJ={};this.xkb=null;this.CQc()};this.wSj=(sd,be)=>{var Ee,Ie,bf,Xe;Ic.oJ.EcsOperationDuration=null===(Ee=sd.RequestTelemetryData)||void 0===Ee?void 0:Ee.EcsOperationDuration;Ic.oJ.WfeRequestDuration=null===(Ie=sd.RequestTelemetryData)||
void 0===Ie?void 0:Ie.WfeRequestDuration;Ic.oJ.EcsRequestDurations=null===(bf=sd.RequestTelemetryData)||void 0===bf?void 0:bf.EcsRequestDuration;Ic.oJ.isSuccessful=!(0<(null===(Xe=sd.Errors)||void 0===Xe?void 0:Xe.length));this.s1a&&(Ee=!!sd&&!!sd.RequestTelemetryData,!Oa.a(sd)&&be&&be.correlationId&&this.da.Gk.t1(be.correlationId,sd.StateId,Ee?sd.RequestTelemetryData.EcsOperationDuration:0,Ee?sd.RequestTelemetryData.EcsRequestDuration:0,Ee?sd.RequestTelemetryData.WfeRequestDuration:0))};this.x8f=
()=>{if(this.xkb){const sd=If.a(Hf.a.ih.$j,this.xkb);Ic.oJ.lastCacheUpdateDuration=sd}};this.$=sb;this.da=ya.f(sb);this.gridInstantaneousAction=od;this.aN=lc.HMb(this.$.domElement,500,null,null);this.ajb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8406295_AddFreezePanePropsTo8cadq");this.btf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8452940_AddGridContentPropsToFreezePaneTelemtry");this.a9f=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606820_addHasPanesLogTo8cadq");this.AOb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8561471_EstimatePaneDataFix");
this.BDd=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnablePaneEstimationForAllFpOps",!1);this.jZa=new pe(this.da);this.s1a=ea.EwaSettings.Ynb();ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&(this.Cna=document.getElementById(this.Och),this.G2=document.getElementById(this.qfh));this.iZa=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",
!1);this.AId=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8797568_FreezePaneDragTelemetry")}Ri(sb,lc,Uc){let od=!1;switch(lc){case 1844679312:od=1!==sb&&!this.da.fh.By;break;case -73576432:case -1564089444:if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1)&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8764078_EnableFPCommandsForDrag")){Uc&&"dragProperties"in Uc&&(od=!1);break}ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8475425_DisableFreezeUpToCommandsWhenSelectionNotCell")&&
(od=1!==sb);break;case -1006176541:case 179232729:case -1156879868:case -247664224:case -1929078919:od=!(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1))}this.$.ea.isEditMode||this.$.ea.Kh.allowViewCollab||(od=!0);return od}executeCommand(sb,lc,Uc){var od;sb=this.da.fh;const sd=null!==(od=this.da.Mlb())&&void 0!==od?od:this.da.E5();this.s6(lc);od=this.Naa?ye.getSelection(this.da.ha,
sd,lc):this.getSelection(sd,lc);switch(lc.command){case 1844679312:return this.setFreezePanes(lc,sd,sb.pp);case 83934709:return this.I3g(lc,sd,Uc);case -73576432:return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.hwg(od,lc.command,lc.ik)?this.jpe(lc,sd,!1,Uc):Ia.Task.Ua(!1):this.jpe(lc,sd,sb.pp,Uc);case -1564089444:return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.hwg(od,lc.command,lc.ik)?
this.ipe(lc,sd,!1,Uc):Ia.Task.Ua(!1):this.ipe(lc,sd,sb.pp,Uc);case 340334732:return sb.iyc?Ia.Task.Ua(!1):this.PDk(lc,sd);case -806625837:return sb.z9a?Ia.Task.Ua(!1):this.QDk(lc,sd);case -1006176541:return this.Naa?this.jZa.freezePanesRowAndColumnPreview(lc,sd):this.freezePanesRowAndColumnPreview(lc,sd);case -342472547:case 1558501543:case -2036655906:case 1870830702:case -1588000013:return this.Naa?this.jZa.CKa():this.dxg();case 179232729:if(this.Naa)return this.jZa.g2b(lc);this.da.AK();return this.g2b(lc);
case -1156879868:return this.Naa?this.jZa.freezePanesRowAndColumnPreview(lc,sd):this.freezePanesRowAndColumnPreview(lc,sd);case -247664224:if(this.Naa)return this.jZa.Pbe(lc);this.da.AK();return this.Pbe(lc);case -1929078919:return this.Naa?this.jZa.freezePanesRowAndColumnPreview(lc,sd):this.freezePanesRowAndColumnPreview(lc,sd)}return Ia.Task.Ua(!1)}Gi(sb,lc){sb=!1;switch(lc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:case 83934709:sb=!0;break;case -73576432:case -1564089444:sb=
ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1);break;case -1006176541:case -342472547:case 179232729:case 1558501543:case -1156879868:case -2036655906:case -247664224:case 1870830702:case -1929078919:case -1588000013:sb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)}return sb}dj(){return!1}s6(sb){ra.AFrameworkApplication.ra.$g.ZI&&this.$.s6&&
(1844679312===sb.command||340334732===sb.command||-806625837===sb.command)&&Ef.a.zX(1,2)}hwg(sb,lc,Uc){const od=this.da.fh;if(!od.pp||this.iZa&&30===Uc||od.IJ&&od.CL)return!0;switch(lc){case -73576432:return sb.top!==od.Rm-1;case -1564089444:return sb.left!==od.fn-1}return!1}jVb(sb,lc){return!sb||lc.topLeft.y>sb.bottomRight.y||lc.topLeft.x>sb.bottomRight.x||lc.bottomRight.y<sb.bottomRight.y||lc.bottomRight.x<sb.bottomRight.x?!1:!0}VWb(sb){if(this.da.bG(sb))return!0;for(const lc of this.da.Uu){if(!this.da.fh.HD(lc.paneType))continue;
const Uc=this.da.yl(sb,lc.paneType),od=lc.Vr;if(Uc&&od&&this.jVb(Uc,od))return!0}return!1}nBe(sb,lc,Uc,od){const sd=this.da.yl(sb),be=this.da.view.visibleArea;return(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.Naa?ye.VWb(this.da,sb):this.VWb(sb):this.Naa?ye.jVb(sd,be):this.jVb(sd,be))?0>=lc&&0>=Uc?(O.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),sb=ya.f(this.$).rtl?
1493:1492,lc=ya.f(this.$).rtl?-2131054257:-1953454131,sb=ja.a.nj(1,0,26,sb,0,lc,"FreezePaneA1SelectedErr"),this.kqf(this.$,sb,od),!1):!0:(O.ULS.sendTraceTag(537159583,0,50,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")?`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${sb}, rangeViewportArea=${sd?sd.toString():"null"}, visibleArea=${be.toString()}, requestInitiator=${od}`:`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${sb}, rangeViewportArea=${sd?
sd.toString():"null"}, visibleArea=${be.toString()}`),sb=ja.a.nj(1,0,26,1491,0,2105967339,"FreezePaneSelectionNotInViewErr"),this.kqf(this.$,sb,od),!1)}getSelection(sb,lc){var Uc=this.da.ha.qa;const od=Uc.activeCell.clone();Uc=Uc.activeRange;Uc.qk&&(O.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${od.top}) and firstUnfreezeCell.Bottom (${od.bottom}) to equal topLeftRange.Top (${sb.top})`),od.top=od.bottom=sb.top);
Uc.isRow&&(O.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${od.left}) and firstUnfreezeCell.Right (${od.right}) to equal topLeftRange.Left (${sb.left})`),od.left=od.right=sb.left);if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(lc.command){case -73576432:case -1156879868:od.top===od.maxRows&&(od.top=od.bottom=od.maxRows-1);break;case -1564089444:case -1929078919:od.left===
od.maxColumns&&(od.left=od.right=od.maxColumns-1)}return od}I3g(sb,lc,Uc){if(this.iZa&&Uc&&"dragProperties"in Uc){const od=Uc.dragProperties,sd=od.dragDirection;if("horizontal"===sd&&this.da.fh.HD(4))return this.da.fh.HD(3)?this.ipe(new Fb.a(-1564089444,sb.method,sb.mode,sb.ik,sb.tabName),lc,!1,{dragProperties:{dragDirection:"vertical",dragOrigin:od.dragOrigin,target:Ea.Range.ZX(this.da.fh.fn-1,this.da.fh.fn,!1),unfreeze:!0}}):Ia.Task.Ua(!0);if("vertical"===sd&&this.da.fh.HD(3))return this.da.fh.HD(4)?
this.jpe(new Fb.a(-73576432,sb.method,sb.mode,sb.ik,sb.tabName),lc,!1,{dragProperties:{dragDirection:"horizontal",dragOrigin:od.dragOrigin,target:Ea.Range.IU(this.da.fh.Rm-1,this.da.fh.Rm,!1),unfreeze:!0}}):Ia.Task.Ua(!0)}this.uud(Uc);return this.mwb(sb,!1,0,0,0,0,lc,null)}setFreezePanes(sb,lc,Uc){if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)||!Uc){Uc=this.Naa?ye.getSelection(this.da.ha,lc,sb):this.getSelection(lc,sb);Uc.top===lc.top&&Uc.left===lc.left&&(Uc=
Ea.Range.vi(Uc.top+1,Uc.left));const {Hbe:od,Gbe:sd,FId:be,EId:Ee}=this.OMd(sb,lc,Uc,!1);return this.nBe(Uc,be,Ee,Ga.RIBBON)?this.mwb(sb,!0,od,sd,be,Ee,lc,Uc):(this.$.Dm(),this.CQc(),Ia.Task.Ua(!0))}return this.I3g(sb,lc)}qJf(sb,lc){const Uc=this.da.kj;let od=null;lc===hd.vertical?od=Uc.vZa(sb):lc===hd.horizontal&&(od=Uc.f_a(sb));if(od&&od!==sb)return new Ea.Range(od.top,od.left,od.bottom,od.right,!1,!1);O.ULS.sendTraceTag(507790169,0,50,`Could Not get First Scrollable Cell for : ${lc===hd.horizontal?
"horizontal":"vertical"}`);return sb}QEf(sb,lc,Uc){return this.iZa&&Uc&&"dragProperties"in Uc?(sb=Uc.dragProperties,lc=sb.dragDirection,{L0d:sb.target,tUd:sb.unfreeze?!1:this.da.fh.HD(3)&&"vertical"===lc||this.da.fh.HD(4)&&"horizontal"===lc}):{L0d:this.Naa?ye.getSelection(this.da.ha,lc,sb):this.getSelection(lc,sb),tUd:!1}}jpe(sb,lc,Uc,od){if(Uc)return Ia.Task.Ua(!1);const {L0d:sd,tUd:be}=this.QEf(sb,lc,od),{Hbe:Ee,Gbe:Ie,FId:bf,EId:Xe}=this.OMd(sb,lc,sd,be);if(!this.nBe(sd,bf,Xe,od&&"dragProperties"in
od?Ga.DRAG_HANDLE:Ga.RIBBON))return this.$.Dm(),this.CQc(),Ia.Task.Ua(!0);this.uud(od);return this.mwb(sb,!0,Ee,Ie,bf,Xe,lc,this.AOb?this.qJf(sd,hd.vertical):sd)}uud(sb){var lc;if(this.AId&&this.iZa&&sb&&"dragProperties"in sb){sb=sb.dragProperties;const Uc=sb.dragReleasedTime;Ic.oJ.isDrag=!0;Ic.oJ.dragDirection=sb.dragDirection;Ic.oJ.dragOrigin=sb.dragOrigin;Ic.oJ.isUnfreezeFromDrag=null!==(lc=sb.unfreeze)&&void 0!==lc?lc:!1;Uc&&(Ic.oJ.dragReleaseToFreezeApplied=performance.now()-Uc)}}ipe(sb,lc,Uc,
od){if(Uc)return Ia.Task.Ua(!1);const {L0d:sd,tUd:be}=this.QEf(sb,lc,od),{Hbe:Ee,Gbe:Ie,FId:bf,EId:Xe}=this.OMd(sb,lc,sd,be);if(!this.nBe(sd,bf,Xe,od&&"dragProperties"in od?Ga.DRAG_HANDLE:Ga.RIBBON))return this.$.Dm(),this.CQc(),Ia.Task.Ua(!0);this.uud(od);return this.mwb(sb,!0,Ee,Ie,bf,Xe,lc,this.AOb?this.qJf(sd,hd.horizontal):sd)}PDk(sb,lc){let Uc=0;const od=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");od&&(Uc=ye.sRb(this.da).columnNumber);return this.mwb(sb,
!0,0,od?Uc:lc.left,0,od?Uc-lc.left+1:1,lc,null)}QDk(sb,lc){let Uc=0;const od=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");od&&(Uc=ye.sRb(this.da).rowNumber);return this.mwb(sb,!0,od?Uc:lc.top,0,od?Uc-lc.top+1:1,0,lc,null)}kqf(sb,lc,Uc){this.iZa&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")&&Uc===Ga.DRAG_HANDLE?this.FUg(xa.a.instance.ia(2560)):ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",
!1)?this.FUg(xa.a.instance.ia(2427)):this.Ip(sb,lc)}FUg(sb){sb=Of.a.dB.UK.IX(sb,!1);sb.image=oc.a.Fob()?1:0;Of.a.dB.UK.EF(sb)}Ip(sb,lc){new db.a(this.$,lc)}mwb(sb,lc,Uc,od,sd,be,Ee,Ie){var bf;this.Ree=Cc.a(this.$).Rta(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.ajb&&this.da.za.kz(this.x8f);this.da.O9(this.Mkg);this.aN.K8a();this.da.tUk(lc?"":"UnsetFreezePane");const Xe=Object(Kc.a)(new Kf,{SheetName:null===(bf=this.$.ma)||void 0===bf?void 0:bf.name,Freeze:lc,FrozenRows:sd,FrozenColumns:be,
FirstRow:Uc,FirstColumn:od});O.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${lc}, FrozenRows=${sd}, FrozenColumns=${be}, FirstRow=${Uc}, FirstColumn=${od} `);const Ze=()=>new Yb(Xe),tf=sa.a.create().toString();this.ajb&&(Ic.oJ.isFreeze=lc,Ic.oJ.operationType=te.a(sb.command),Ic.oJ.frozenRows=sd,Ic.oJ.frozenColumns=be,Ic.oJ.firstRow=Uc,Ic.oJ.firstColumn=od,Ic.oJ.referencedBlocksBefore=this.da.za.mBc(),this.a9f&&(Ic.oJ.hasPanes=this.da.fh.By));this.xkb=
Hf.a.ih.$j;this.s1a&&this.D1k(sb,Xe,Ee,Ie,tf);return X.a(this.$.userOperationManager,(ff,ef,Sf)=>{if(ea.EwaSettings.Ra(59)){var zf=window.performance;zf.clearMarks();zf.mark("FreezePanes request sent")}zf=this.da.kj;var sf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"),lf=this.da.fh.pp;sf=sf?lf||!lc:!0;zf&&(sf||this.BDd)?this.AOb&&lf?this.$.WC():(zf=this.Cuf(Xe,zf,Ee,Ie),this.x1k(zf)):this.$.WC();lf=ba.c(ff,this.wSj);zf=this.$.pa.ta;ff=this.ajb?lf:ff;lf=this.s1a?{setPanes:lc,correlationId:tf}:
lc;sf=zf.$a(9,null);sf.freezeSettings=Xe;return aa.h(zf,"FreezeOrUnfreezePanes",sf,ff,ef,Sf,lf,0)},ff=>new la.a(151,0,ff,void 0,Ze),sb)}D1k(sb,lc,Uc,od,sd){O.ULS.sendTraceTag(507577612,0,50,"FreezePanesCommandHandler.triggerFreezePaneCSE triggerFreezePaneCSE Initiated ");const be=this.da.kj;this.da.fh.pp?O.ULS.sendTraceTag(507574365,0,15,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${sb.command}, parameter = ActiveSheetProcessedData, value = null reason = No active sheet processed data`):
(this.gridInstantaneousAction.Hge(),window.setTimeout(()=>{this.da.Gk.mza();this.da.Gk.gQ(23,sd,te.a(sb.command));const Ee={Kz:this.Cuf(lc,be,Uc,od)};this.gridInstantaneousAction.Lrd(sb.command,void 0,Ee);O.ULS.sendTraceTag(507585429,0,50,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${sb.command}, parameter = FreezePaneCSEAttempted, value = Success reason = Initiated FreezePane CSE`)},10))}Cuf(sb,lc,Uc,od){O.ULS.shipAssertTag(537159580,1,!!lc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");
if(!sb.Freeze)return null;const sd=ac.a();sd.State=1;sd.IsEstimated=!0;let be=!1,Ee=!1;const Ie=lc.JU(Ea.Range.vi(Uc.top,Uc.left));if(null===Ie)return O.ULS.sendTraceTag(507893269,1,50,"EstimatePaneViewDataOnPaneRequest.topLeftAllPanesOffsetData Null"),null;let bf=sb.FrozenRows;var Xe=sb.FrozenColumns;1!==sb.FrozenRows||sb.FrozenColumns?sb.FrozenRows||1!==sb.FrozenColumns?(Xe=lc.JU(Ea.Range.vi(sb.FirstRow+1,sb.FirstColumn+1)),lc=lc.JU(Ea.Range.vi(Uc.top,Uc.left)),sd.Width=Xe.wk-Ie.wk,sd.Height=Xe.lk-
Ie.lk,this.AOb&&(0>sd.Width?sd.Width=0:sd.Width,0>sd.Height?sd.Height=0:sd.Height),0<sb.FrozenRows&&(sd.AbsoluteTop=Xe.lk,Ee=!0),0<sb.FrozenColumns&&(sd.AbsoluteLeft=Xe.wk,be=!0),bf=Xe.sJ-lc.sJ,Xe=Xe.GI-lc.GI):(sd.Width=lc.FBc(Fd.a.vi(Uc.top,Uc.left)),od=Ea.Range.vi(Uc.top,Uc.left+1),sd.AbsoluteLeft=Ie.wk+sd.Width,be=!0):(sd.Height=lc.CBc(Fd.a.vi(Uc.top,Uc.left)),od=Ea.Range.vi(Uc.top+1,Uc.left),sd.AbsoluteTop=Ie.lk+sd.Height,Ee=!0);Ee&&(sd.FirstFrozenRow=Uc.top,sd.FirstScrollableRow=od.top);be&&
(sd.FirstFrozenColumn=Uc.left,sd.FirstScrollableColumn=od.left);sd.VisibleRows=bf;sd.VisibleColumns=Xe;return sd}x1k(sb){Ia.Task.delay(this.$.ua.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.ma&&this.$.ea&&(this.$.ea.A8(gc.a.Dk,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Qf.b(this.$.ma,sb,-1,void 0,!0))})}CQc(){this.aN.Q8a();Nf.a.dh(this.Ree);this.Ree=null;this.da.X1(this.Mkg);this.ajb&&this.da.za.Vy(this.x8f)}J9d(sb){let lc=`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${sb.totalDuration} `;
if(this.ajb){var Uc=this.aRb();Uc&&(Uc=this.da.oh.lBc(Array(Uc)),sb.activeCells=Uc);sb.referencedBlocksAfter=this.da.za.mBc();sb.enabledExperiments=[];this.BDd&&sb.enabledExperiments.push("paneEstimation");this.s1a&&sb.enabledExperiments.push("cseEnabled");this.iZa&&this.AId&&sb.enabledExperiments.push("freezePanesDrag");ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&
sb.enabledExperiments.push("freezePanesNewEntries");ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&sb.enabledExperiments.push("previewFreezePanes");lc+=ab.a.Ci(sb)}O.ULS.sendTraceTag(570949840,0,50,lc)}z2e(sb){let lc=0,Uc=0,od=0,sd=0;const be=new Set,Ee=new Set,Ie=new Set,bf=Nb.HelperMethods.eN(()=>{var Xe=this.da.za.oJa(this.da.BR(),this.$.ma.name);if(Xe)for(var Ze of Xe)if(0!==Ze.Rs){if(Xe=Mc.b(this.da.$,Ze.yj,!0))for(var tf of Xe){Xe=tf.type;const ff=tf.Wq;
if(""!==ff||null!=ff)2===Xe?Ee.add(ff):1===Xe&&Ie.add(ff)}if(Ze.$Jb)for(const ff of Ze.$Jb)be.add(ff.Id);tf=Ze.Pi;Ze=Ze.ZJa();if(Ze=null===Ze||void 0===Ze?void 0:Ze.Cells)for(const ff of Ze)if(Ze=this.da.za.$If(tf,ff.Row,ff.Col))lc+=Ze.$F?1:0,od+=Ze.LR?1:0,sd+=Ze.G_a?1:0,Uc+=Ze.DC?1:0;break}});sb.mergedCells=lc;sb.formulaCells=Uc;sb.conditionalFormatting=od;sb.coloredCells=sd;sb.tables=Ee.size;sb.pivotTables=Ie.size;sb.floatingObjects=be.size;sb.gridContentLogTime=bf}aRb(){const sb=this.da.E5(),lc=
this.da.uzc();return null===sb||null===lc?null:new Ea.Range(sb.top,sb.left,lc.bottom,lc.right,!0,!0)}D0(sb,lc,Uc){return sb.JU(Fd.a.vi(lc,Uc))}Pbe(sb){const lc=this.da.fh.CL;var {BB:Uc}=this.da.D5(),od=this.da.kj;if(null===od)return this.AP(sb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);const sd=this.Iwa(od,0,0);od=this.Iwa(od,0,1);Uc=this.da.ps+od.wk-(Uc.x+sd.wk);0<lc&&(Uc=this.da.ps+od.wk-sd.wk);if(null!==this.G2)this.da.rtl?this.G2.style.right=Nb.HelperMethods.Ki(Uc):this.G2.style.left=
Nb.HelperMethods.Ki(Uc),this.G2.classList.remove(this.Gja);else return this.AP(sb,!1,"verticalPreviewBar is null"),Ia.Task.Ua(!0);this.AP(sb,!0);return Ia.Task.Ua(!0)}g2b(sb){const lc=this.da.fh.IJ;var Uc=this.da.kj;if(null===Uc)return this.AP(sb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);({BB:sd}=this.da.D5());const od=this.Iwa(Uc,0,0);Uc=this.Iwa(Uc,1,0);var sd=this.da.qC+Uc.lk-(sd.y+od.lk);0<lc&&(sd=this.da.qC+Uc.lk-od.lk);if(null!==this.Cna)this.Cna.style.top=Nb.HelperMethods.Ki(sd),
this.Cna.classList.remove(this.Gja);else return this.AP(sb,!1,"horizontalPreviewBar is null"),Ia.Task.Ua(!0);this.AP(sb,!0);return Ia.Task.Ua(!0)}freezePanesRowAndColumnPreview(sb,lc){let Uc,od;let sd=!0,be=!0;const Ee=this.da.fh.IJ,Ie=this.da.fh.CL,bf=this.da.fh.Rm,Xe=this.da.fh.fn,{EJ:Ze,BB:tf}=this.da.D5();var ff=this.da.kj;if(null===ff)return this.AP(sb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);const ef=this.Iwa(ff,0,0);lc=this.getSelection(lc,sb);if(!this.VWb(lc))return this.AP(sb,
!0,"Preview not shown as selection is not in visible area"),Ia.Task.Ua(!0);var Sf=this.D0(ff,Ze.top,Ze.left);const zf=this.D0(ff,lc.top+0,lc.left+0);var sf=this.D0(ff,lc.top+1,lc.left);const lf=this.D0(ff,lc.top,lc.left+1);ff=this.D0(ff,bf,Xe);const Ra=tf.x+Sf.wk-ff.wk;Sf=tf.y+Sf.lk-ff.lk;if(-1006176541===sb.command){sf=zf;if(zf.lk===ef.lk&&zf.wk===ef.wk)return this.g2b(sb);if(zf.lk===ef.lk||zf.lk<=ef.lk||zf.sJ>=ff.sJ&&zf.lk<ff.lk+Sf)sd=!1}sd&&(od=this.da.qC+sf.lk-Sf,0<Ee&&(od=lc.top<bf?this.da.qC+
sf.lk-ef.lk:this.da.qC+sf.lk-ef.lk-Sf));if(-1006176541===sb.command){if(sf=zf,zf.lk===ef.lk&&zf.wk===ef.wk||zf.wk<=ef.wk||zf.GI>=ff.GI&&zf.wk<ff.wk+Ra)be=!1}else sf=lf;be&&(Uc=this.da.ps+sf.wk-Ra,0<Ie&&(Uc=Xe>lc.left?this.da.ps+sf.wk-ef.wk:this.da.ps+sf.wk-ef.wk-Ra));if(null!==this.Cna&&sd)this.Cna.style.top=Nb.HelperMethods.Ki(od),this.Cna.classList.remove(this.Gja);else if(sd)return this.AP(sb,!1,"horizontalPreviewBar is null"),Ia.Task.Ua(!0);if(null!==this.G2&&be)this.da.rtl?this.G2.style.right=
Nb.HelperMethods.Ki(Uc):this.G2.style.left=Nb.HelperMethods.Ki(Uc),this.G2.classList.remove(this.Gja);else if(be)return this.AP(sb,!1,"verticalPreviewBar is null"),Ia.Task.Ua(!0);-1156879868===sb.command&&this.G2.classList.add(this.Gja);-1929078919===sb.command&&this.Cna.classList.add(this.Gja);this.AP(sb,!0);return Ia.Task.Ua(!0)}dxg(){this.G2&&(this.G2.style.left=null,this.G2.style.right=null,this.G2.classList.contains(this.Gja)||this.G2.classList.add(this.Gja));this.Cna&&(this.Cna.classList.contains(this.Gja)||
this.Cna.classList.add(this.Gja));return Ia.Task.Ua(!0)}AP(sb,lc,Uc){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var od="FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",sd={};sd.operationType=te.a(sb.command);sd.isSuccessful=lc;sd.preExistingPanes=this.da.fh.By;sd.message=Uc?Uc:"";od+=ab.a.Ci(sd);O.ULS.sendTraceTag(507655369,0,50,od)}}Iwa(sb,lc,Uc){var od;const sd=null!==(od=this.da.Mlb())&&void 0!==od?od:this.da.E5();od=this.da.X$(!0);const be=this.da.X$(!1);
return this.D0(sb,(od>sd.top?od:sd.top)+lc,(be>sd.left?be:sd.left)+Uc)}};Ub.oJ={};Ub=Ic=Object(K.__decorate)([Object(Xa.d)(Sa.Uc),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.Qf)()),Object(K.__param)(2,Object(Sa.id)()),Object(K.__param)(3,Object(Sa.gd)())],Ub);Object(M.a)(Ub,"FreezePanesCommandHandler",null,[43]);var yc;let kd=yc=class{constructor(sb,lc){this.da=sb;this.$=lc;this.selectedRanges=[];this.O5=this.AVf=this.wTc=this.joa=this.OWd=!1;this.xPf=()=>{this.o3c(this.selectedRanges,
!1);this.lSf();this.nt&&this.iac(this.nt.rv,this.nt.ZH,this.nt.isRow,!0,!0,!1);this.OWd=!0};this.wPf=()=>{this.OWd=!1;this.o3c(this.selectedRanges,!0);this.nt&&this.iLa(this.nt.isRow)&&this.iac(this.nt.rv,this.nt.ZH,this.nt.isRow,!0,!0,!0)};this.joa=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8756282_HeaderInsertAllowedRefactor");this.wTc=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8797344_refactorGetAdjacentCellIndex");this.AVf=this.joa&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8797454_insertBasedOnAdjacentSelection");
this.O5=ea.EwaSettings.QWd()}isHeaderInsertAllowed(sb,lc,Uc){return this.joa?this.Qt&&this.Qt.isRow===lc&&(this.Qt.ZH===sb&&this.Qt.cya===Uc||this.Qt.Spd===sb&&this.Qt.cya===!Uc):this.iLa(lc)&&(!this.P0a(sb,lc)||!!this.ynb(sb,lc,Uc))}FRf(sb,lc,Uc,od){od?(!this.nt||this.nt.ZH===lc&&this.nt.isRow===Uc||this.FRf(this.nt.rv,this.nt.ZH,this.nt.isRow,!1),this.nt={isRow:Uc,ZH:lc,rv:sb}):(this.nt&&this.nt.ZH===lc&&this.nt.isRow===Uc||O.ULS.sendTraceTag(507581474,0,15,"HeaderInsert.headerCellHoveredCallback: Got unset hover event for a cell that was not previously hovered."),
this.nt=void 0);this.iLa(Uc)&&!this.P0a(lc,Uc)&&this.iac(sb,lc,Uc,!0,!0,!0)}headerInsertHitAreaHoveredCallback(sb,lc,Uc,od){od?(!this.Qt||this.Qt.ZH===sb&&this.Qt.isRow===lc&&this.Qt.cya===Uc||this.headerInsertHitAreaHoveredCallback(this.Qt.ZH,this.Qt.isRow,this.Qt.cya,!1),this.joa?this.kPk(sb,lc,Uc):this.Qt={isRow:lc,ZH:sb,Spd:void 0,cya:Uc}):(this.Qt&&this.Qt.ZH===sb&&this.Qt.isRow===lc&&this.Qt.cya===Uc||O.ULS.sendTraceTag(507581473,0,15,"HeaderInsert.headerInsertHitAreaHoveredCallback: Got unset hover event for a hit region that was not previously hovered."),
this.joa?this.lSf():this.Qt=void 0);!this.joa&&this.isHeaderInsertAllowed(sb,lc,Uc)&&(this.i6g(sb,lc,Uc),od?this.ZUg(sb,lc,Uc):this.mSf(lc))}headerInsertButtonInvokedCallback(sb,lc,Uc){1!==this.da.ha.Ck&&this.da.c8();if(this.AVf){var od=Uc;let be=this.ynb(sb,lc,Uc);if(!be){var sd=-1;this.Qt.isRow===lc&&this.Qt.ZH===sb?sd=this.Qt.Spd:O.ULS.sendTraceTag(507355294,0,15,"HeaderInsert.headerInsertButtonInvokedCallback: hoveredHitRegion should be set to the current cell at this point.");if(sd=this.ynb(sd,
lc,!Uc))od=!Uc,be=sd}null!==be&&void 0!==be?be:be=lc?Ea.Range.IU(sb,sb):Ea.Range.ZX(sb,sb);this.da.$.ti(od?lc?-1113896058:1415868706:lc?75170472:-612877076,2,32,{[ic.a.Q6a]:[be]})}else sb=(od=this.P0a(sb,lc))?[od]:[lc?Ea.Range.IU(sb,sb):Ea.Range.ZX(sb,sb)],this.da.$.ti(Uc?lc?-1113896058:1415868706:lc?75170472:-612877076,2,32,{[ic.a.Q6a]:sb})}cDc(sb){var lc,Uc;sb=sb.filter(od=>od.isRow||od.qk);if(0!==this.selectedRanges.length||0!==sb.length)this.o3c(this.selectedRanges,!1),this.selectedRanges=sb,
this.o3c(this.selectedRanges,!0),this.nt&&this.iLa(this.nt.isRow)&&this.iac(this.nt.rv,this.nt.ZH,this.nt.isRow,!0,!0,!0),this.joa||!this.Qt||this.Qt.isRow===(null===(lc=this.nt)||void 0===lc?void 0:lc.isRow)&&this.Qt.ZH===(null===(Uc=this.nt)||void 0===Uc?void 0:Uc.ZH)||!this.iLa(this.Qt.isRow)||this.i6g(this.Qt.ZH,this.Qt.isRow,this.Qt.cya)}K2i(sb){sb?this.xPf():this.wPf()}yPf(sb){sb?this.xPf():this.wPf()}ZUg(sb,lc,Uc){Uc||sb++;Uc=lc?Ea.Range.IU(sb,sb):Ea.Range.ZX(sb,sb);lc=lc?yc.KVf:yc.CVf;this.da.Gh.qt(Uc,
lc,!1);this.da.Gh.Jw(lc,void 0,void 0,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?!0:void 0)}mSf(sb){this.da.Gh.Mq(sb?yc.KVf:yc.CVf,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?!0:void 0)}iLa(sb){var lc;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8740942_DisableHeaderInsertEditing")){if(this.O5&&this.OWd||!this.$.ea.isEditMode||this.da.isEditing)return!1;null!==(lc=this.bE)&&void 0!==lc?lc:this.bE=new Ja.a(this.$.sa);return!this.bE.Wj(sb?
64:32)||this.$.vh.ME?!1:!0}this.bE||(this.bE=new Ja.a(this.$.sa));return this.bE.Wj(sb?64:32)&&this.$.ea.isEditMode&&!this.$.vh.ME}o3c(sb,lc){sb.forEach(Uc=>{var od=Uc.isRow;if(this.iLa(od)){var sd=od?Uc.top:Uc.left,be=this.Wjb(od,sd);this.Iwb(be,sd,!0,lc?0:void 0);Uc=od?Uc.bottom:Uc.right;od=Uc===sd?be:this.Wjb(od,Uc);this.Iwb(od,Uc,!1,lc?0:void 0)}})}iac(sb,lc,Uc,od,sd,be){od&&this.Iwb(sb,lc,!0,this.hMd(lc,Uc,!0,be));sd&&this.Iwb(sb,lc,!1,this.hMd(lc,Uc,!1,be))}GMk(sb,lc,Uc,od){if(!od)return!1;
od=!!this.P0a(sb,lc);return!od&&this.nt&&this.nt.isRow===lc&&this.nt.ZH===sb||this.ynb(sb,lc,Uc)||!od&&this.SWf(sb,lc,!Uc)?!0:!1}EMk(sb,lc,Uc){return this.iLa(lc)&&(!this.P0a(sb,lc)||!!this.ynb(sb,lc,Uc))}kPk(sb,lc,Uc){this.EMk(sb,lc,Uc)&&(this.Iwb(this.Wjb(lc,sb),sb,Uc,1),this.ZUg(sb,lc,Uc),this.Qt={isRow:lc,ZH:sb,Spd:this.BJd(sb,lc,!Uc),cya:Uc})}lSf(){if(this.Qt){var sb=this.Qt.isRow,lc=this.Qt.ZH,Uc=this.Qt.cya;this.Qt=void 0;this.Iwb(this.Wjb(sb,lc),lc,Uc,this.hMd(lc,sb,Uc,this.iLa(sb)));this.mSf(sb)}}i6g(sb,
lc,Uc){var od,sd,be;const Ee=sb===(null===(od=this.nt)||void 0===od?void 0:od.ZH)&&lc===(null===(sd=this.nt)||void 0===sd?void 0:sd.isRow)?null===(be=this.nt)||void 0===be?void 0:be.rv:this.Wjb(lc,sb);Ee&&this.iac(Ee,sb,lc,Uc,!Uc,!0)}Wjb(sb,lc){if(this.joa&&this.nt&&this.nt.isRow===sb&&this.nt.ZH===lc)return this.nt.rv;sb=sb?this.da.Kbe:this.da.d2b;for(const Uc of sb)if(sb=Uc.twi(lc))return sb}hMd(sb,lc,Uc,od){const sd=!!this.P0a(sb,lc),be=!!this.ynb(sb,lc,Uc);if(this.Qt&&this.Qt.ZH===sb&&this.Qt.isRow===
lc&&this.Qt.cya===Uc&&(this.joa||!sd||be))return 1;if(this.joa){if(this.GMk(sb,lc,Uc,od))return 0}else if(this.nt&&this.nt.isRow===lc&&this.nt.ZH===sb&&!sd||be||!sd&&this.SWf(sb,lc,!Uc))return 0}Iwb(sb,lc,Uc,od){var sd;if(sb&&!sb.jQg(lc,Uc,od)){const be=this.BJd(lc,sb.isRow,!Uc);if(this.wTc?yc.a4f(be,sb.isRow):be!==lc)null===(sd=this.Wjb(sb.isRow,be))||void 0===sd?void 0:sd.jQg(be,!Uc,od)}}P0a(sb,lc){var Uc;return null===(Uc=this.selectedRanges)||void 0===Uc?void 0:Uc.find(od=>lc?od.isRow&&od.X1a(sb):
od.qk&&od.W0a(sb))}ynb(sb,lc,Uc){return this.selectedRanges.find(od=>lc?od.isRow&&(Uc?od.top===sb:od.bottom===sb):od.qk&&(Uc?od.left===sb:od.right===sb))}SWf(sb,lc,Uc){Uc=this.BJd(sb,lc,Uc);return(this.wTc?yc.a4f(Uc,lc):Uc!==sb)?!!this.P0a(Uc,lc):!1}BJd(sb,lc,Uc){const od=this.da.kj;if(this.wTc)return od.I0(Uc?sb+1:sb-1,lc,Uc);if(lc)return sb=Fd.a.vi(sb,1),Uc?od.vZa(sb).top:od.DQb(sb).top;sb=Fd.a.vi(1,sb);return Uc?od.f_a(sb).left:od.LRb(sb).left}static a4f(sb,lc){lc=lc?gc.a.fl:gc.a.Nk;return 0<sb&&
sb<=lc}};kd.KVf=[70,72];kd.CVf=[71,73];kd=yc=Object(K.__decorate)([Object(Xa.d)(Sa.jd),Object(K.__param)(0,Object(Sa.id)()),Object(K.__param)(1,Object(Sa.Nb)())],kd);Object(M.a)(kd,"HeaderInsert",null,[]);class Nd{constructor(sb,lc){this.selectedRanges=null;this.fRemoveOriginRef=!1;this.selectedRanges=sb;this.fRemoveOriginRef=lc}}Object(M.a)(Nd,"MacroRecorderImageInCellConvertToFloatingObjectPayload",null,[146]);var wa=a(168),wb=a(103);let zc=class{constructor(sb,lc,Uc){this.LPj=od=>{let sd;!od||
ja.a.jl(od.Errors)||ia.a.Gm(sd=od.Result)?od&&ja.a.jl(od.Errors)&&O.ULS.sendTraceTag(509142304,0,50,`ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${ja.a.ei(od.Errors)}`):(O.ULS.sendTraceTag(509142305,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded"),wa.a(this.$).F5a(3),wb.a(this.$).YOa(1,sd))};this.KPj=()=>{O.ULS.sendTraceTag(509142303,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oFailed: operation failed")};
this.$=sb;this.da=ya.f(this.$);this.QUh=lc;this.Yxi=Uc;this.JXb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.yVb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",!1);this.Ghj=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CellImagesOnObjectUI",!1)}Ri(){return!1}executeCommand(sb,lc){na.TaskExtensions.Gq();sb=V.t(this.da.ha.qa.selectedRanges,this.$);const Uc=lc.command;switch(Uc){case 2000316912:lc=
this.gjf(sb,!0,lc);break;case 1983877126:lc=this.gjf(sb,!1,lc);break;case -1125542248:lc=this.popInCellImageToFloatingFromOnObjectUI();break;case 457756232:lc=this.Mak();break;default:return Z.a(Uc)}return lc||Ia.Task.Ua(!0)}Gi(sb,lc){sb=!1;switch(lc.command){case 457756232:case -1125542248:sb=this.$.isEditMode&&this.JXb&&this.yVb&&this.Ghj;break;case 2000316912:case 1983877126:sb=this.$.isEditMode&&this.JXb&&this.yVb}return sb}dj(){return!1}popInCellImageToFloatingFromOnObjectUI(){if(!this.$.qy(null,
!1))return Ia.Task.Ua(!0);this.QUh.umd();return Ia.Task.Ua(!0)}Mak(){if(!(new Ja.a(this.$.sa)).Wj(1))return Ia.Task.Ua(!0);this.Yxi.umd();return Ia.Task.Ua(!0)}gjf(sb,lc,Uc){if(!this.$.qy(null,!1))return Ia.Task.Ua(!0);const od=()=>new Nd(sb,lc);return X.a(this.$.userOperationManager,(sd,be,Ee)=>{var Ie=this.$.pa.ta;sd=ba.c(sd,this.LPj);be=ba.b(be,this.KPj);const bf=Ie.$a(41,null);bf.selectedRanges=sb;bf.fRemoveOriginRef=lc;return aa.h(Ie,"ConvertToFloatingE2o",bf,sd,be,Ee,null,0)},sd=>new la.a(268,
0,sd,void 0,od),Uc)}};zc=Object(K.__decorate)([Object(Xa.d)(Sa.sd),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.N)()),Object(K.__param)(2,Object(Sa.tc)())],zc);Object(M.a)(zc,"ImageInCellCommandHandler",null,[43]);var Hc=a(905),ed=a(906);class rd{constructor(sb,lc,Uc,od){this.$=sb;this.Mz=lc;this.O9a=Uc;this.Ugb=od}showTaskPane(sb,lc,Uc,od,sd,be,Ee,Ie){oc.a.Rt()?void Xa.a.resolve(Sa["if"],{va:0}).then(bf=>bf.DS("NameManagerTaskPane",this.Ht(sb,lc,Uc,od,sd,void 0,be,Ee,Ie))):
Vd.a.ep().then(bf=>{bf.showTaskPane("NameManagerTaskPane",this.Ht(sb,lc,Uc,od,sd,void 0,be,Ee,Ie));return null}).catch(()=>{throw Error("showTaskPane: Error while opening task pane");})}updateTaskPane(sb,lc,Uc,od,sd,be,Ee,Ie,bf){oc.a.Rt()?void Xa.a.resolve(Sa["if"],{va:0}).then(Xe=>Xe.updateTaskPane("NameManagerTaskPane",this.Ht(sb,lc,Uc,od,sd,be,Ee,Ie,bf))):Vd.a.ep().then(Xe=>{Xe.updateTaskPane("NameManagerTaskPane",this.Ht(sb,lc,Uc,od,sd,be,Ee,Ie,bf));return null}).catch(()=>{throw Error("updateTaskPane: Error while opening task pane");
})}hideTaskPane(){oc.a.Rt()?void Xa.a.resolve(Sa["if"],{va:0}).then(sb=>sb.hideTaskPane("NameManagerTaskPane")):Vd.a.ep().then(sb=>{sb.hideTaskPane("NameManagerTaskPane",2);return null}).catch(()=>{throw Error("hideTaskPane: Error while hiding task pane");})}EX(){this.v_g&&this.v_g()}getTitle(sb,lc){switch(sb){case 1:return xa.a.instance.Ea(lc?1003:902);case 0:case 2:return xa.a.instance.Ea(901);default:return""}}Ht(sb,lc,Uc,od,sd,be,Ee,Ie,bf){Uc={type:"NameManagerTaskPaneProps",activePage:sb,showLoader:Ee,
rangePickerController:ya.f(this.$).co.$Za(),callbacks:Uc,items:lc,errors:Ie,updateView:od,toast:sd,filterCountMap:bf};return Object.assign(new ce.a,{id:"NameManagerTaskPane",title:this.getTitle(sb,this.gob(lc)),actionButtonProps:be,contentProps:Uc,width:320,onOpen:()=>{this.Mz()},onClose:()=>{this.O9a()},preventCloseCallback:Xe=>{this.v_g=Xe;ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8720866_XLONameManagerApplyChangesToast")?1===sb?this.Ugb(lc):Xe():Xe()}})}gob(sb){return sb&&null===sb[0]?!0:!1}}
Object(M.a)(rd,"NameManagerTaskPane",null,[275]);class ve{constructor(sb,lc){this.U0g=0;this.qWc=[];this.searchText="";this.Mz=()=>{this.KX.ZDh(this.vof);this.KX.$Eh(this.A5g);this.KX.XBh(this.juc);this.KX.mz();this.$.fq(this.tNa)};this.callbacks={onItemClick:Uc=>{this.d3i(Uc)},onItemSave:(Uc,od,sd,be,Ee)=>{this.HPf(Uc,od,sd,be,Ee)},onItemsDelete:Uc=>{Uc&&(this.qWc=Uc,this.KX.juc(Uc))},onSearch:(Uc,od)=>{this.searchText=Uc;this.xnc=od;if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",
!1)){O.ULS.sendTraceTag(507610080,Hc.a.G3a,ed.a.info,ab.a.Ci({isSearching:""!==Uc,sortBy:od.sortBy,sortOrder:od.sortOrder,filterBy:od.filterBy}));const sd=nb.filterBy(this.items,od.filterBy);Uc=nb.search(sd,Uc);od=nb.PPd(Uc,od.sortBy,od.sortOrder);this.B8(0,void 0,od)}else O.ULS.sendTraceTag(507581340,Hc.a.G3a,ed.a.info,"NameManagerTaskPaneController.callbacks Search functionality is used"),od=nb.search(this.items,Uc),this.B8(0,void 0,od)},onCloseButtonClick:(Uc,od,sd,be,Ee)=>{nb.C6i(Uc,od,sd,be,
this.getDefinedNames())?(this.m5b={name:Uc,reference:od,comment:sd,type:Ee,runtimeUid:be,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""},this.toast=this.kCc(xa.a.instance.Ea(915),xa.a.instance.Ea(916),()=>{this.HPf(Uc,od,sd,be,Ee)},!0,()=>{this.nrb.EX()}),this.B8(1,this.yfb(),[this.m5b],null)):this.nrb.EX()}};this.updateView=(Uc,od)=>{switch(Uc){case 1:case 3:this.B8(Uc,this.yfb(),[od]);break;case 0:this.B8(Uc,void 0);break;default:this.B8(Uc,this.yfb())}};this.yfb=
()=>({label:xa.a.instance.Ea(903),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateView(0)},onTabKeyDown:()=>{}});this.vof=(Uc,od)=>{this.U0h();(null===od||void 0===od?0:od.Kmj)?this.$4i():this.updateView(this.items?0:4)};this.A5g=(Uc,od)=>{let sd;Uc=null===od||void 0===od?void 0:od.status;!Uc&&(sd=nb.UKi(od),null===sd||void 0===sd?0:sd.s$b)&&(this.toast=this.kCc(sd.s$b,null,null));Uc?this.B8(0,null,this.getDefinedNames(),null===sd||void 0===sd?void 0:sd.Wdg):this.B8(1,this.yfb(),
[this.m5b],null===sd||void 0===sd?void 0:sd.Wdg)};this.juc=(Uc,od)=>{(null===od||void 0===od?0:od.status)&&this.items&&(this.items=this.items.filter(sd=>!this.qWc.includes(sd.runtimeUid)));this.toast=(null===od||void 0===od?0:od.status)?this.LYi(od):this.KYi(od);this.B8(0,null,this.items,null)};this.tNa=(Uc,od)=>{!od.dm&&this.nrb&&this.nrb.hideTaskPane()};this.O9a=()=>{this.KX.Bnk(this.vof);this.KX.Aok(this.A5g);this.KX.Tlk(this.juc);this.KX.KA();this.$.Wu(this.tNa)};this.Ugb=Uc=>{this.B8(3,this.yfb(),
Uc)};this.$=sb;this.KX=lc;this.da=ya.f(sb);this.nrb=new rd(sb,this.Mz,this.O9a,this.Ugb)}EPk(){this.U0g=0;this.toast={sequenceNumber:0,message:"",actionButtonText:"",onActionButtonClick:null,autoHide:!1,onCloseButtonClick:null,allowDismiss:!1};this.xnc={filterBy:void 0,sortOrder:0,sortBy:0};this.nrb.showTaskPane(0,this.getDefinedNames(),this.callbacks,this.updateView,this.toast,!0,void 0,this.filterCountMap);this.KX.uvg(!1)}B8(sb,lc,Uc,od){this.Cai=sb;this.nrb.updateTaskPane(sb,Uc||this.getDefinedNames(),
this.callbacks,this.updateView,this.toast,lc,!1,od,this.filterCountMap);this.m5b=null}d3i(sb){if(sb=nb.yJi(this.items,sb)){sb=V.kb(sb.reference.slice(1),this.$.listSeparator,this.$.sa);const lc=ya.f(this.$).ha;this.da.N0(sb&&sb.v7&&sb.sheetName?sb.v7:[lc.qa.daa],ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8756334_NameManagerSelectionUpdateAfterDiscontinuousSelection")?0:lc.qa.Fy,sb.sheetName,null,null,null,null,3,"NameManager.SelectNamedRange",null,null,null,!0)}}$4i(){switch(this.Cai){case 0:if(this.items)if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",
!1)){var sb=nb.filterBy(this.items,this.xnc.filterBy);sb=nb.search(sb,this.searchText);sb=nb.PPd(sb,this.xnc.sortBy,this.xnc.sortOrder);this.B8(0,void 0,sb)}else sb=nb.search(this.items,this.searchText),this.B8(0,void 0,sb);else this.updateView(4);break;case 4:this.updateView(this.items?0:4);break;case 2:this.updateView(this.items?2:4)}}U0h(){const sb=this.KX.XXa;sb?(this.items=[],0!==sb.nameManagerItems.length&&(sb.nameManagerItems.forEach(lc=>{lc&&lc.metadata&&lc.metadata.isVisibleToNameManager&&
this.items.push({runtimeUid:lc.metadata.runtimeUid,name:lc.name,reference:"="+lc.reference,comment:lc.comment,type:nb.yQi(lc.metadata.type),scope:nb.AVi(lc.scope),referenceSheetName:lc.referenceSheetName,isInvalidReference:lc.isInvalidReference,topLeft:lc.topLeft,bottomRight:lc.bottomRight})}),this.items=nb.PPd(this.items,0,0),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)&&(this.filterCountMap=nb.z3h(this.items)))):this.items=null}KYi(sb){return sb&&!sb.status&&
sb.twb?nb.fZc(sb.twb)?this.kCc(nb.RFf("delete"),null,null):null:null}LYi(sb){var lc,Uc;if(!sb||!sb.status||sb.twb)return null;sb=1===(null===(lc=this.qWc)||void 0===lc?void 0:lc.length)?xa.a.instance.Ea(908):String.format(xa.a.instance.Ea(909),null===(Uc=this.qWc)||void 0===Uc?void 0:Uc.length);return this.kCc(sb,xa.a.instance.Ea(904),()=>{this.$.ti(-1502853784,C.a.rh,12,null)})}getDefinedNames(){return this.items}kCc(sb,lc,Uc,od,sd){return sb?{sequenceNumber:++this.U0g,message:sb,actionButtonText:lc,
onActionButtonClick:Uc,autoHide:void 0===od?!0:od,onCloseButtonClick:void 0===sd?null:sd,allowDismiss:!0}:null}HPf(sb,lc,Uc,od,sd){const be=nb.scl(this.KX.A_d,sb,lc,Uc,sd);this.m5b={name:sb,reference:lc,comment:Uc,type:sd,runtimeUid:od,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""};0!==be.length?this.B8(1,this.yfb(),[this.m5b],be):this.KX.upsertDefinedName(sb,lc,Uc,od,Ab[sd])}}Object(M.a)(ve,"NameManagerTaskPaneController",null,[]);let Le=class{constructor(sb,lc){this.Uda=
null;this.$=sb;this.KX=lc}Ri(){return!1}get XQc(){this.Uda||(this.Uda=new ve(this.$,this.KX));return this.Uda}executeCommand(sb,lc){sb=!1;lc=lc.command;switch(lc){case 1910465940:this.XQc.EPk(),sb=!0}return sb?Ia.Task.Ua(!0):Z.a(lc)}Gi(sb,lc){switch(lc.command){case 1910465940:return!0;default:return!1}}dj(){return!1}};Le=Object(K.__decorate)([Object(Xa.d)(Sa.Wd),Object(K.__param)(0,Object(Sa.Nb)()),Object(K.__param)(1,Object(Sa.zb)())],Le);Object(M.a)(Le,"NameManagerCommandHandler",null,[43]);var Qe=
a(188);class Vb extends Qe.a{constructor(){super();this.xD=()=>{this.hide()}}showDialog(sb,lc){try{this.kl="OfficePyBlockPythonEditDialog",this.Ph=0,this.show({["type"]:"StandardDialogProps",["id"]:this.kl,["headerText"]:sb,["resultHandler"]:this.xD,["titleText"]:lc})}catch(Uc){this.I5c(sb,lc)}}I5c(sb){const lc=new Qc.a(!1,!1,!1);lc.Ph=0;lc.kl="OfficePyBlockPythonEditLegacyDialog";lc.initializeAndShow(sb,this.Jdh,null)}Jdh(){this.hide()}}Object(M.a)(Vb,"OfficePyBlockPythonEditDialog",Qe.a,[]);let cd=
class{constructor(sb){this.$=sb}Ri(){return!1}executeCommand(sb,lc){sb=!1;lc=lc.command;switch(lc){case 883532127:(new Vb).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),sb=!0}return sb?Ia.Task.Ua(!0):Z.a(lc)}Gi(sb,lc){switch(lc.command){case 883532127:return ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",
!1);default:return!1}}dj(){return!1}};cd=Object(K.__decorate)([Object(Xa.d)(Sa.ne),Object(K.__param)(0,Object(Sa.Nb)())],cd);Object(M.a)(cd,"OfficePyUXCommandHandler",null,[43]);var Ud=a(9),re=a(914);class qe extends re.a{constructor(sb){super(sb)}Gt(){const sb=Object(da.d)(Xa.a.resolve(Sa.Qf,{va:this.xh})),lc=Object(da.d)(Xa.a.resolve(Sa.gd,{va:this.xh}));na.TaskExtensions.Xa(sb,Uc=>{Uc=Uc.result;const od=ya.f(this.$);this.Qr([new Ub(this.$,Uc,od,lc.result)])},this.$.ya)}static Ba(sb){sb.la.Hh(116,
new qe(sb))}}Object(M.a)(qe,"FreezePanesCommandHandlerFactory",re.a,[]);var Se=a(428),Ve=a(921);class rf extends Se.a{constructor(sb){super();this.$=sb;this.gm()}create(){oc.a.dl()?void Xa.a.rj(Sa.wc).then(sb=>{this.Bk(Object(Ve.a)(this.$.la,502,()=>new $c(this.$,sb)))}):this.Bk(Object(Ve.a)(this.$.la,502,()=>new $c(this.$,null)))}static Ba(sb){sb.la.Hh(503,new rf(sb))}}Object(M.a)(rf,"FontDropdownHelperFactory",Se.a,[]);(()=>{Ud.a.gh(sb=>{Sa.Uc.Aa()||qe.Ba(sb)})})();(()=>{Ud.a.gh(sb=>{Sa.vc.Aa()||
rf.Ba(sb)})})();String(h);String(r);String(e);String(k);String(m);String(x);String(n);String(u);String(v);String(w);String(l);String(y);String(B);String(A);String(E);String(N);String(D);String(U);window.___1710439927641_closurehack=h;window.___1710439927641_closurehack=r;window.___1710439927641_closurehack=e;window.___1710439927641_closurehack=k;window.___1710439927641_closurehack=m;window.___1710439927641_closurehack=x;window.___1710439927641_closurehack=n;window.___1710439927641_closurehack=u;window.___1710439927641_closurehack=
v;window.___1710439927641_closurehack=w;window.___1710439927641_closurehack=l;window.___1710439927641_closurehack=y;window.___1710439927641_closurehack=B;window.___1710439927641_closurehack=A;window.___1710439927641_closurehack=E;window.___1710439927641_closurehack=N;window.___1710439927641_closurehack=D;window.___1710439927641_closurehack=U}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kpae.js.map/c14e64dfda919b7583e2c601079cb27c/EwaTS.kpae.js.map