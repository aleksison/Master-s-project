'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[37],{781:function(z,t,a){function c($a){return 0<$a&&$a<=mb.a.fl}function b($a){return 0<$a&&$a<=mb.a.Nk}function h($a,Wb){let rc="";Wb.sort((Zc,Kd)=>Zc.start-Kd.start);let xb=0,ic=Wb.shift();const Rc=$a.length;for(;xb<Rc&&ic;)xb===ic.start?(rc+=ic.value,ic.pLa&&(rc+="#"),xb=ic.end,ic=Wb.shift()):(rc+=$a[xb],xb++);xb<Rc&&(rc+=$a.substring(xb));return rc}function r($a,Wb){return $a.top<=Wb.top&&$a.left<=Wb.left&&
$a.bottom>=Wb.bottom&&$a.right>=Wb.right}function e($a,Wb,rc,xb){const ic=rc.FirstScrollableRow,Rc=rc.FirstScrollableColumn;switch(Wb){case 1:var Zc=$a.XG.length;return $a.MB[$a.MB.length-1]>=ic&&$a.XG[Zc-1]>=Rc;case 4:var Kd;Zc=rc.FirstScrollableRow;rc=rc.FirstScrollableColumn;xb=null===(Kd=$a.MB)||void 0===Kd?void 0:Kd.length;return 0<xb&&$a.MB[xb-1]>=Zc&&rc>=$a.XG[0];case 3:Kd=rc.FirstScrollableRow;rc=rc.FirstScrollableColumn;var fe=Number.MAX_VALUE;for(const Gd of xb)Gd.ar.Y<fe&&(fe=Gd.ar.Y);
$a.ar.Y>fe&&Kd<$a.MB[0]?$a=!1:(xb=null===(Zc=$a.XG)||void 0===Zc?void 0:Zc.length,$a=0<xb&&$a.XG[xb-1]>=rc);return $a;case 2:var Ld;Zc=rc.FirstScrollableRow;rc=rc.FirstScrollableColumn;return 0<(null===(fe=$a.XG)||void 0===fe?void 0:fe.length)&&$a.XG[0]<=rc&&0<(null===(Ld=$a.MB)||void 0===Ld?void 0:Ld.length)&&$a.MB[0]<=Zc}return!1}function k($a,Wb,rc){const xb=$a.kj;var ic=Ua.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxHiddenRangeCountForFreezeCSE",1);const Rc=Ua.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxHiddenRowColCountForFreezeCSE",
10),{WRf:Zc,smb:Kd}=x($a,Wb.FirstScrollableRow,!0),{WRf:fe,smb:Ld}=x($a,Wb.FirstScrollableColumn,!1);if(Zc>ic||fe>ic||Kd>Rc||Ld>Rc)return n(`Hidden Row/Col, exceeds supported hidden range limit, hiddenRowCount: ${Kd}, hiddenColCount: ${Ld}, hiddenRowRangeCount: ${Zc}, hiddenColRangeCount: ${fe}`,rc),!1;$a=mb.a.oR;ic=mb.a.pR;if(Kd&&Wb.FirstScrollableRow>ic+Kd&&(ic=Math.ceil((Wb.FirstScrollableRow-Kd)/ic)*ic-Wb.FirstScrollableRow+Kd,ic<Kd))return n(`Hidden Row/Col, CSE at block end, rowCountFromBlockEnd: ${ic}`,
rc),!1;if(Ld&&Wb.FirstScrollableColumn>$a+Ld&&($a=Math.ceil((Wb.FirstScrollableColumn-Ld)/$a)*$a-Wb.FirstScrollableColumn+Ld,$a<Ld))return n(`Hidden Row/Col, CSE at block end, colCountFromBlockEnd: ${$a}`,rc),!1;Wb=new qa.Range(Math.max(1,Wb.FirstScrollableRow-1),Math.max(1,Wb.FirstScrollableColumn-1),Wb.FirstScrollableRow,Wb.FirstScrollableColumn,!1,!1);return xb.roa(Wb)?(n("Hidden Row/Col, Adjacent range hidden",rc),!1):!0}function m($a){var Wb;const rc=null!==(Wb=$a.Mlb())&&void 0!==Wb?Wb:$a.E5();
$a=$a.uzc();return null===rc||null===$a?null:new qa.Range(rc.top,rc.left,$a.bottom,$a.right,!0,!0)}function x($a,Wb,rc){var xb;const ic=$a.kj;$a=null!==(xb=m($a))&&void 0!==xb?xb:new qa.Range(1,1,Wb,Wb,!0,!0);xb=ic.NAc([$a]).filter(Zc=>rc&&!Zc.isRow||!rc&&!Zc.qk||rc&&Zc.top>Wb||!rc&&Zc.left>Wb?!1:rc?Zc.isRow:Zc.qk);let Rc=0;xb.forEach(Zc=>{Rc=rc?Rc+(Math.min(Zc.bottom,Wb)-Zc.top+1):Rc+(Math.min(Zc.right,Wb)-Zc.left+1)});return{WRf:xb.length,smb:Rc}}function n($a,Wb){Da.ULS.sendTraceTag(507368522,
0,20,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Wb}, CSE Unattempted Reason=${$a}`)}function u($a,Wb){if(!$a.length||$a[0]>Wb)return 0;let rc=0;for(let xb=0;xb<$a.length&&!($a[xb]>=Wb);xb++)0<xb&&(rc+=$a[xb]-$a[xb-1]-1);return rc}function v($a,Wb,rc,xb){var ic,Rc,Zc;const Kd=Wb.FirstScrollableColumn;Wb=mb.a.oR;const fe=Kd>Wb?Kd<=Wb+xb?Kd:Kd%Wb:Kd;let Ld=0,Gd=fe-1;const Zd=null===(ic=$a.ColumnNumbers)||void 0===ic?void 0:ic.length;ic=xb?u($a.ColumnNumbers,Kd):0;
switch(rc){case 1:Kd<=Wb+xb?Ld=Gd-xb:($a=Kd>$a.ColumnNumbers[Zd-1]?0:fe-1,$a=0>$a?Wb-Math.abs($a):$a,Ld=$a-xb);Gd-=xb;Gd=xb&&0>Gd?Wb-Math.abs(Gd):Gd;break;case 2:Kd<=Wb+xb?Ld=Zd-Gd+xb:(Gd=$a=Kd>$a.ColumnNumbers[Zd-1]?$a.ColumnNumbers[Zd-1]:Kd-(null===(Rc=$a.ColumnNumbers)||void 0===Rc?NaN:Rc[0]),Ld=Zd-Gd+ic);break;case 3:Kd<=Wb+xb||($a=Kd>$a.ColumnNumbers[Zd-1]?$a.ColumnNumbers[Zd-1]:fe-1,Gd=$a=0>$a?Wb-Math.abs($a):$a);Ld=Gd-xb;break;case 4:Kd<=Wb+xb?Ld=Zd-Gd+xb:(Gd=$a=Kd>$a.ColumnNumbers[Zd-1]?$a.ColumnNumbers[Zd-
1]:Kd-(null===(Zc=$a.ColumnNumbers)||void 0===Zc?NaN:Zc[0]),Ld=Zd-Gd+ic)}return{S5b:0,iWc:0,oLb:Gd,$qc:Ld-1}}function w($a,Wb,rc,xb){var ic,Rc,Zc;const Kd=Wb.FirstScrollableRow;Wb=mb.a.pR;const fe=Kd>Wb?Kd<=Wb+xb?Kd:Kd%Wb:Kd;let Ld=0,Gd=fe-1;const Zd=null===(ic=$a.RowNumbers)||void 0===ic?void 0:ic.length;ic=xb?u($a.RowNumbers,Kd):0;switch(rc){case 1:Kd<=Wb+xb?Ld=Gd-xb:($a=Kd>$a.RowNumbers[Zd-1]?0:fe-1,$a=0>$a?Wb-Math.abs($a):$a,Ld=$a-xb);Gd-=xb;Gd=xb&&0>Gd?Wb-Math.abs(Gd):Gd;break;case 2:Kd<=Wb+
xb?Ld=Zd-Gd+xb:(Gd=$a=Kd>$a.RowNumbers[Zd-1]?$a.RowNumbers[Zd-1]:Kd-(null===(Rc=$a.RowNumbers)||void 0===Rc?NaN:Rc[0]),Ld=Zd-Gd+ic);break;case 3:Kd<=Wb+xb?Ld=Zd-Gd+xb:(Gd=$a=Kd>$a.RowNumbers[Zd-1]?$a.RowNumbers[Zd-1]:Kd-(null===(Zc=$a.RowNumbers)||void 0===Zc?NaN:Zc[0]),Ld=Zd-Gd+ic);break;case 4:Kd<=Wb+xb||($a=Kd>$a.RowNumbers[Zd-1]?$a.RowNumbers[Zd-1]:fe-1,Gd=$a=0>$a?Wb-Math.abs($a):$a),Ld=Gd-xb}return{S5b:Gd,oLb:0,iWc:Ld-1,$qc:0}}function l($a,Wb,rc){var xb,ic,Rc,Zc,Kd;return(null===(xb=$a.MB)||
void 0===xb?void 0:xb[0])<=Wb&&(null===(ic=$a.MB)||void 0===ic?void 0:ic[$a.MB.length-1])>=Wb&&(null===(Rc=$a.XG)||void 0===Rc?void 0:Rc[0])<=rc&&(null===(Zc=$a.XG)||void 0===Zc?void 0:Zc[(null===(Kd=$a.XG)||void 0===Kd?NaN:Kd.length)-1])>=rc}function y($a,Wb){const rc={};rc.X=$a.X-Wb.X;rc.Y=$a.Y-Wb.Y;return rc}function B($a,Wb,rc,xb,ic){return Ua.EwaSettings.w1a()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade($a,Wb,rc,xb,ic):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade($a,
Wb,xb,ic)}function A($a,Wb,rc,xb){switch(rc){case -706918724:case 674605324:var ic=$a.destination.yj;if(!ic)return V("shouldCurrentBlockPairBeProcessed",rc),!1;if(ic.right<Wb.left)return $a.eV=!0,Da.ULS.sendTraceTag(508150742,0,50,`GridInstantaneousAction.processGridAction command=${rc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${Wb.left}, blockRangeRightMostValue=${ic.right}, hashCode=${$a.destination.Pi}, isRow=${xb}`),!1;break;case 369708605:case 1415868706:ic=$a.source.yj;
if(!ic)return V("shouldCurrentBlockPairBeProcessed",rc),!1;if(ic.right<Wb.left)return $a.eV=!0,Da.ULS.sendTraceTag(508150741,0,50,`GridInstantaneousAction.processGridAction command=${rc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${Wb.left}, blockRangeRightMostValue=${ic.right}, hashCode=${$a.source.Pi}, isRow=${xb}`),!1;break;case 1542466017:case -1113896058:ic=$a.source.yj;if(!ic)return V("shouldCurrentBlockPairBeProcessed",rc),!1;if(ic.bottom<Wb.top)return $a.eV=!0,Da.ULS.sendTraceTag(508150740,
0,50,`GridInstantaneousAction.processGridAction command=${rc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${Wb.top}, blockRangeBottomMostValue=${ic.bottom}, hashCode=${$a.source.Pi}, isRow=${xb}`),!1;break;case 1051390410:case 1554436520:ic=$a.destination.yj;if(!ic)return V("shouldCurrentBlockPairBeProcessed",rc),!1;if(ic.bottom<Wb.top)return $a.eV=!0,Da.ULS.sendTraceTag(508150739,0,50,`GridInstantaneousAction.processGridAction command=${rc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${Wb.top}, blockRangeBottomMostValue=${ic.bottom}, hashCode=${$a.destination.Pi}, isRow=${xb}`),
!1}return!0}function E($a,Wb,rc,xb,ic){if(Ua.EwaSettings.K1a()&&$a.fh.By&&1===ic.length){var Rc=ic[0],Zc=$a.fh.fn,Kd=$a.fh.Rm;ic=[];if(!rc&&Rc.right<Zc){Zc=N(Wb,rc,xb,2);$a=N(Wb,rc,xb,4);var fe=[],Ld=[];-706918724!==xb&&(Rc.top<Kd&&(Ld=N(Wb,rc,xb,3)),fe=N(Wb,rc,xb,1));ic.push(...Zc);ic.push(...$a);ic.push(...Ld);ic.push(...fe);return ic}if(!rc&&Rc.left>=Zc)return Rc=N(Wb,rc,xb,3),Wb=N(Wb,rc,xb,1),ic.push(...Rc),ic.push(...Wb),ic;if(rc&&Rc.bottom<Kd)return Kd=N(Wb,rc,xb,2),$a=N(Wb,rc,xb,3),fe=[],Ld=
[],1051390410!==xb&&(Rc.left<Zc&&(Ld=N(Wb,rc,xb,4)),fe=N(Wb,rc,xb,1)),ic.push(...Kd),ic.push(...$a),ic.push(...Ld),ic.push(...fe),ic;if(rc&&(Rc.top>=Kd||$a.fh.AYd(Rc)))return Rc=N(Wb,rc,xb,4),Wb=N(Wb,rc,xb,1),ic.push(...Rc),ic.push(...Wb),ic}return N(Wb,rc,xb,1)}function N($a,Wb,rc,xb){const ic=$a.filter(Kd=>Kd.yK().paneType===xb),Rc=Wb?aa(ic):J(ic),Zc=[];if(!Ua.EwaSettings.kha()&&0===Rc&&1===$a.length)return Zc.push({destination:$a[0],source:null,eV:!1}),Zc;if(Ua.EwaSettings.sya()||Ua.EwaSettings.rya()||
Ua.EwaSettings.$Ka())Zc.push(...U(ic,Rc,Wb,rc));else for(let Kd=0;Kd<=Rc;Kd++)for($a=ic.filter(fe=>fe.yK().topLeft.Y===Kd),Wb=0;Wb<$a.length;Wb+=1)Zc.push({destination:$a[Wb],source:$a[Wb+1]?$a[Wb+1]:null,eV:!1});Da.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${Zc.length}`);return Zc}function D($a){const Wb=aa($a),rc=J($a),xb=[],ic={};$a.forEach(Rc=>{const {X:Zc,Y:Kd}=Rc.yK().topLeft;ic[`${Zc},${Kd}`]=Rc});for($a=0;$a<=Wb;$a++)for(let Rc=
0;Rc<=rc;Rc++){const Zc=ic[`${$a+1},${Rc}`],Kd=ic[`${$a},${Rc+1}`],fe=ic[`${$a+1},${Rc+1}`],Ld=ic[`${$a},${Rc}`];xb.push({destination:null!==Ld&&void 0!==Ld?Ld:null,nXg:null!==Zc&&void 0!==Zc?Zc:null,jXg:null!==Kd&&void 0!==Kd?Kd:null,kXg:null!==fe&&void 0!==fe?fe:null,eV:!1})}Da.ULS.sendTraceTag(507586694,0,50,`GridInstantaneousAction.getadjacentBlocksInViewport parameter = blockPairsLength, value=${xb.length}`);return xb}function U($a,Wb,rc,xb){const ic=[];for(let Rc=0;Rc<=Wb;Rc++){const Zc=$a.filter(fe=>
rc?fe.yK().topLeft.X===Rc:fe.yK().topLeft.Y===Rc),Kd=Zc.length;for(let fe=0;fe<Kd;fe+=1)switch(xb){case -1113896058:case 1542466017:ic.push({source:Zc[fe],destination:K(fe+1,Zc),eV:!1});break;case 1554436520:case 1051390410:ic.push({destination:Zc[fe],source:K(fe+1,Zc),eV:!1});break;case 1415868706:case 369708605:ic.push({source:Zc[fe],destination:K(fe+1,Zc),eV:!1});break;case 674605324:case -706918724:ic.push({destination:Zc[fe],source:K(fe+1,Zc),eV:!1})}}return ic}function K($a,Wb){return $a<Wb.length?
Wb[$a]:null}function M($a,Wb,rc,xb,ic,Rc){let Zc,Kd=0;Kd=Va(xb)?za.HelperMethods.eN(()=>{Zc=gridRenderer.CanvasRendererGlobals.performModelRowColOperation($a,Wb,rc,xb,ic)}):za.HelperMethods.eN(()=>{Zc=gridRenderer.CanvasRendererGlobals.hideRowCols($a,Wb,ic)});S("HideRowCols",Kd,Rc);return Zc}function O($a,Wb,rc,xb,ic,Rc,Zc){let Kd;if(!$a||!Wb)return Kd;Kd=Va(ic)?gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations($a,Wb,rc,xb,ic,Rc):gridRenderer.CanvasRendererGlobals.performModelCascade($a,
Wb,rc,Rc);Kd.metric&&S("ModelCascade",Kd.metric.Vul,Zc);return Kd}function R($a,Wb,rc,xb){return rc?-1113896058===xb||1542466017===xb?$a.RowNumbers[$a.RowNumbers.length-Wb-1]:$a.RowNumbers[0]:1415868706===xb||369708605===xb?$a.ColumnNumbers[$a.ColumnNumbers.length-Wb-1]:$a.ColumnNumbers[0]}function J($a){let Wb=-1;for(let rc=0;rc<$a.length;rc++){const xb=$a[rc].yK().topLeft.Y;xb>Wb&&(Wb=xb)}return Wb}function aa($a){let Wb=-1;for(let rc=0;rc<$a.length;rc++){const xb=$a[rc].yK().topLeft.X;xb>Wb&&(Wb=
xb)}return Wb}function S($a,Wb,rc){rc=Ac?Oa.b().zp(rc):rc;Dc?Da.ULS.sendTraceTag(509723719,0,20,`GridInstantaneousAction: Time taken to complete operation=${$a} is time=${Wb} and command=${rc}`):Da.ULS.sendTraceTag(507869347,0,50,`GridInstantaneousAction: Time taken to complete operation=${$a} is time=${Wb} and command=${rc}`)}function C($a,Wb,rc){var xb,ic;for(const Zc of Wb)if(!Ua.EwaSettings.kha()||Zc.source&&Zc.destination){if(!(Ua.EwaSettings.kha()||Zc.source&&Zc.destination))return!0;var Rc=
null===(xb=Zc.destination)||void 0===xb?void 0:xb.yj;Wb=null===(ic=Zc.source)||void 0===ic?void 0:ic.yj;if(Ua.EwaSettings.pHc()&&(!Rc||!Wb))return V("isFirstRowColOfNextBlockHidden",rc),!0;Rc=$a.AJd(Rc);Wb=$a.AJd(Wb);switch(rc){case -706918724:case 674605324:return Rc&&Rc.IsFirstColOfNextBlockHidden;case 369708605:case 1415868706:return Rc&&(null===Rc||void 0===Rc?void 0:Rc.IsLastColOfPrevBlockHidden)||Wb&&(null===Wb||void 0===Wb?void 0:Wb.IsFirstColOfNextBlockHidden);case 1051390410:case 1554436520:return Rc&&
Rc.IsFirstRowOfNextBlockHidden;case 1542466017:case -1113896058:return Rc&&(null===Rc||void 0===Rc?void 0:Rc.IsLastRowOfPrevBlockHidden)||Wb&&(null===Wb||void 0===Wb?void 0:Wb.IsFirstRowOfNextBlockHidden)}}return!1}function L($a,Wb,rc){for(const xb of Wb){if(Ua.EwaSettings.Plj()&&!xb)return Da.ULS.sendTraceTag(508339915,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: blockPair or sourceBlock is null and command=${rc}`),!0;if(!xb.source||!xb.destination)if(Ua.EwaSettings.kha())continue;
else return Da.ULS.sendTraceTag(507875778,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: sourceBlock or destination Block is null and command=${rc}`),!0;if(Ua.EwaSettings.pHc()){Wb=xb.source.yj;const ic=xb.destination.yj;if(!Wb||!ic)return V("isSelectedRangeAcrossBlocks",rc),!0;if(Ua.EwaSettings.Olj()){if(Wb.Xi($a)&&ic.Xi($a))return!0}else{const Rc=-706918724===rc||674605324===rc||1051390410===rc||1554436520===rc;if(Rc&&Wb.Xi($a)||!Rc&&ic.Xi($a))return!0}}else if(xb.source.yj.Xi($a))return!0}return!1}
function V($a,Wb){Da.ULS.sendTraceTag(508347672,0,50,`GridInstantaneousAction: BlockRange was null in the method = ${$a} and command =${Wb}`)}function X($a,Wb,rc){if(-706918724===Wb||674605324===Wb||1051390410===Wb||1554436520===Wb){if($a.destination)return $a=$a.destination.yj,$a?$a.Xi(rc):(V("doesBlockRangeIntersectWithSelectedRange",Wb),!1);V("doesBlockRangeIntersectWithSelectedRange destinationBlock",Wb)}else if(369708605===Wb||1415868706===Wb||1542466017===Wb||-1113896058===Wb){if($a.source)return $a=
$a.source.yj,$a?$a.Xi(rc):(V("doesBlockRangeIntersectWithSelectedRange",Wb),!1);V("doesBlockRangeIntersectWithSelectedRange sourceBlock",Wb)}return!1}function la($a){switch($a){case -706918724:case 1051390410:return gb.Hide;case 369708605:case 1542466017:return gb.Unhide;case 674605324:case 1554436520:return gb.Delete;case 1415868706:case -1113896058:return gb.Insert}throw Error(`GridInstantaneousAction::getGridInstantaneousOperation: Command ${$a} not supported currently`);}function Va($a){switch($a){case gb.Hide:return Ua.EwaSettings.w1a()||
Ua.EwaSettings.qHc();case gb.Insert:return Ua.EwaSettings.sya()||Ua.EwaSettings.rya();case gb.Delete:return Ua.EwaSettings.$Ka()||Ua.EwaSettings.Hnb();default:return!1}}function na($a){const Wb=Ua.EwaSettings.sya()&&-1113896058===$a;return Ua.EwaSettings.rya()&&1415868706===$a||Wb}function db($a){const Wb=Ua.EwaSettings.qHc()&&1051390410===$a;return Ua.EwaSettings.cob()&&-706918724===$a||Wb}function ja($a){const Wb=Ua.EwaSettings.$Ka()&&1554436520===$a;return Ua.EwaSettings.Hnb()&&674605324===$a||
Wb}function ea(){return bc}function Z(){bc={dispose(){}}}function ba($a,Wb,rc){const xb=$a.Pj.PaneViewData;$a=$a.ZJa();const ic={};switch(Wb){case -1113896058:ic.Height=$a.BlockHeight;ic.AbsoluteTop=$a.BlockHeight;ic.FirstScrollableRow=xb.FirstScrollableRow+rc;ic.VisibleRows=xb.VisibleRows+rc;ic.FirstFrozenRow=xb.FirstFrozenRow;break;case 1554436520:case 1051390410:ic.Height=$a.BlockHeight;ic.AbsoluteTop=$a.BlockHeight;ic.FirstScrollableRow=xb.FirstScrollableRow-rc;ic.VisibleRows=xb.VisibleRows-rc;
ic.FirstFrozenRow=xb.FirstFrozenRow;break;default:ic.Height=xb.Height,ic.AbsoluteTop=xb.AbsoluteTop,ic.FirstScrollableRow=xb.FirstScrollableRow,ic.VisibleRows=xb.VisibleRows,ic.FirstFrozenRow=xb.FirstFrozenRow}switch(Wb){case 1415868706:ic.AbsoluteLeft=$a.BlockWidth;ic.Width=$a.BlockWidth;ic.VisibleColumns=xb.VisibleColumns+rc;ic.FirstScrollableColumn=xb.FirstScrollableColumn+rc;ic.FirstFrozenColumn=xb.FirstFrozenColumn;break;case 674605324:ic.AbsoluteLeft=$a.BlockWidth;ic.Width=$a.BlockWidth;ic.VisibleColumns=
xb.VisibleColumns-rc;ic.FirstScrollableColumn=xb.FirstScrollableColumn-rc;ic.FirstFrozenColumn=xb.FirstFrozenColumn;break;case -706918724:ic.FirstScrollableColumn=xb.FirstScrollableColumn;ic.AbsoluteLeft=$a.BlockWidth;ic.Width=$a.BlockWidth;ic.VisibleColumns=xb.VisibleColumns-rc;ic.FirstFrozenColumn=xb.FirstFrozenColumn;break;default:ic.AbsoluteLeft=xb.AbsoluteLeft,ic.Width=xb.Width,ic.VisibleColumns=xb.VisibleColumns,ic.FirstScrollableColumn=xb.FirstScrollableColumn,ic.FirstFrozenColumn=xb.FirstFrozenColumn}ic.State=
xb.State;ic.IsEstimated=xb.IsEstimated;return ic}function ya($a,Wb,rc){if(-706918724===Wb||1051390410===Wb)return!1;let xb=!0;if($a)switch(Wb){case 1415868706:Qa($a,rc,!0,!1);break;case 674605324:Qa($a,rc,!1,!1);break;case -1113896058:Qa($a,rc,!0,!0);break;case 1554436520:Qa($a,rc,!1,!0)}else xb=!1;return xb}function Qa($a,Wb,rc,xb){if(rc)if(xb)for(rc=0;rc<$a.RowNumbers.length;rc++)$a.RowNumbers[rc]+=Wb;else for(rc=0;rc<$a.ColumnNumbers.length;rc++)$a.ColumnNumbers[rc]+=Wb;else if(xb)for(rc=0;rc<
$a.RowNumbers.length;rc++)$a.RowNumbers[rc]-=Wb;else for(rc=0;rc<$a.ColumnNumbers.length;rc++)$a.ColumnNumbers[rc]-=Wb}function va($a){return mc?Math.max($a-1,1):$a-1}a.r(t);var Ia={};a.r(Ia);a.d(Ia,"GridInstantaneousOperation",function(){return gb});a.d(Ia,"GridInstantaneousAction",function(){return Ab});a.d(Ia,"canRowColHideOrCascade",function(){return B});a.d(Ia,"testableGetBlockPairsInViewport",function(){return E});a.d(Ia,"testablePerformModelRowColOperation",function(){return M});a.d(Ia,"testablePerformModelCascade",
function(){return O});a.d(Ia,"testableGetPartialInteractivityState",function(){return ea});a.d(Ia,"testableInitPartialInteractivityState",function(){return Z});a.d(Ia,"testableIsFirstRowColOfNextBlockHidden",function(){return C});a.d(Ia,"testableIsSelectedRangeAcrossBlocks",function(){return L});a.d(Ia,"testableGetRowColNumberForCascade",function(){return R});var Sa={};a.r(Sa);a.d(Sa,"ResizeCommandHandler",function(){return fc});var Xa=a(135),da=a(0),Ea=a(23),qa=a(27),za=a(13),ma=a(189),Da=a(15),
Ua=a(1),ka=a(44),xa=a(12),Fb=a(94),bb=a(5),Ja=a(95),mb=a(10),sa=a(1086);class oa{constructor($a,Wb,rc){this.FVb=!0;this.Sj=$a;this.qia=Wb;this.FVb=rc||Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8453101_deleteRowsRefUpdate")}C9k($a,Wb,rc,xb){if($a){var ic=$a.includes(this.qia);if(!this.Sj)return{isRefError:$a.includes(this.qia),newFormula:$a};var Rc=this.Sj.YFd($a);if(Rc){var Zc=0>rc||0>Wb,Kd=[];try{for(const Ld of Rc){const Gd=Ld.ref;switch(Gd.type){case sa.a.cell:Rc=Gd;const Zd=Rc.row,Bc=Rc.col,
Lc="Abs"===Zd.kind,Cd="Abs"===Bc.kind,Fd=Zd.index+1,te=Bc.index+1,ye=qa.Range.vi(Fd,te),ue=Rc.span;if(Zc&&r(xb,ye)){Kd.push({value:this.qia,start:ue.start,end:ue.end});ic=!0;break}const De=0===rc?!0:ye.left<xb.right,Ke=0===Wb?!0:ye.bottom<xb.top;if(De&&Ke)break;Rc=Ke?Fd:Fd+Wb;var fe=De?te:te+rc;if(!c(Rc)||!b(fe)){Kd.push({value:this.qia,start:ue.start,end:ue.end});ic=!0;break}const pe=qa.Range.vi(Rc,fe).uga(Cd,Lc,Cd,Lc);Kd.push({value:pe,start:ue.start,end:ue.end,pLa:this.Sj.zWa(ue.end,$a)});break;
case sa.a.column:if(!rc)break;Rc=Gd;const pf=Rc.startIndex,qf=Rc.endIndex,of=pf.index+1,Ef=qf.index+1,Nf="Abs"===pf.kind,Kf="Abs"===qf.kind,Qf=qa.Range.ZX(of,Ef),Hf=Rc.span;if(Zc&&r(xb,Qf)){Kd.push({value:this.qia,start:Hf.start,end:Hf.end});ic=!0;break}const If=Qf.left<xb.left,ac=Qf.right<xb.left;if(If&&ac)break;Rc=If?of:of+rc;fe=ac?Ef:Ef+rc;Zc&&0<=fe-Rc&&1>Rc&&(Rc=1);this.FVb&&0>rc&&If&&!ac&&xb.right>Ef&&1<=xb.left-1&&(fe=xb.left-1);if(!b(Rc)||!b(fe)){Kd.push({value:this.qia,start:Hf.start,end:Hf.end});
ic=!0;break}const Yb=qa.Range.ZX(Rc,fe).uga(Nf,!1,Kf,!1);Kd.push({value:Yb,start:Hf.start,end:Hf.end});break;case sa.a.row:if(!Wb)break;Rc=Gd;const Cc=Rc.startIndex,Of=Rc.endIndex,Qb="Abs"===Cc.kind,Ic="Abs"===Of.kind,hd=Cc.index+1,Ga=Of.index+1,Ub=qa.Range.IU(hd,Ga),yc=Rc.span;if(Zc&&r(xb,Ub)){Kd.push({value:this.qia,start:yc.start,end:yc.end});ic=!0;break}const kd=Ub.top<xb.top,Nd=Ub.bottom<xb.top;if(kd&&Nd)break;Rc=kd?hd:hd+Wb;fe=Nd?Ga:Ga+Wb;Zc&&0<=fe-Rc&&1>Rc&&(Rc=1);this.FVb&&0>Wb&&kd&&!Nd&&
xb.bottom>Ga&&1<=xb.top-1&&(fe=xb.top-1);if(!c(Rc)||!c(fe)){Kd.push({value:this.qia,start:yc.start,end:yc.end});ic=!0;break}const wa=qa.Range.IU(Rc,fe).uga(!1,Qb,!1,Ic);Kd.push({value:wa,start:yc.start,end:yc.end});break;case sa.a.range:Rc=Gd;const wb=Rc.top,zc=Rc.left,Hc=Rc.bottom,ed=Rc.right,rd=wb.index+1,ve=zc.index+1,Le=Hc.index+1,Qe=ed.index+1,Vb="Abs"===wb.kind,cd="Abs"===zc.kind,Ud="Abs"===Hc.kind,re="Abs"===ed.kind,qe=new qa.Range(rd,ve,Le,Qe,!1,!1),Se=Rc.topLeftSpan,Ve=Rc.bottomRightSpan;
if(Zc&&r(xb,qe)){Kd.push({value:this.qia,start:Se.start,end:Ve.end});ic=!0;break}const rf=0===Wb?!0:qe.top<xb.top,sb=0===rc?!0:qe.left<xb.left,lc=0===Wb?!0:qe.bottom<xb.top,Uc=0===rc?!0:qe.right<xb.left;if(rf&&sb&&lc&&Uc)break;Rc=rf?rd:rd+Wb;fe=lc?Le:Le+Wb;let od=sb?ve:ve+rc,sd=Uc?Qe:Qe+rc;this.FVb&&0>Wb&&rf&&!lc&&xb.bottom>Le&&1<=xb.top-1&&(fe=xb.top-1);this.FVb&&0>rc&&sb&&!Uc&&xb.right>Qe&&1<=xb.left-1&&(sd=xb.left-1);Zc&&0<=fe-Rc&&1>Rc&&(Rc=1);Zc&&0<=fe-od&&1>od&&(od=1);if(!b(od)||!c(Rc)){Kd.push({value:this.qia,
start:Se.start,end:Se.end});ic=!0;break}if(!b(sd)||!c(fe)){Kd.push({value:this.qia,start:Ve.start,end:Ve.end});ic=!0;break}const be=qa.Range.vi(Rc,od).uga(Vb,cd,!1,!1),Ee=qa.Range.vi(fe,sd).uga(Ud,re,!1,!1);Kd.push({value:be,start:Se.start,end:Se.end,pLa:this.Sj.zWa(Se.end,$a)});Kd.push({value:Ee,start:Ve.start,end:Ve.end,pLa:this.Sj.zWa(Ve.end,$a)})}}return{newFormula:h($a,Kd),isRefError:ic}}catch(Ld){if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8793263_improvedExceptionHandlingGlobalStyles"))Da.ULS.sendTraceTag(507360605,
0,15,`GridReferenceUpdates.UpdateReference failed with error: ${Ld}`);else throw Ld;}}}}dispose(){this.Sj=null}}Object(da.a)(oa,"GridReferenceUpdate",null,[2]);var cb=a(407),Ka=a(217),Oa=a(62),gb;(function($a){$a.Hide="Hide";$a.Unhide="Unhide";$a.Insert="Insert";$a.Delete="Delete";$a.FreezePane="FreezePane"})(gb||(gb={}));Object(da.b)("GridInstantaneousOperation",gb);let bc=null,Dc=!1;const ad=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8524738_CanvasAndSelectionHighlightBugFix");let Ac=!1,mc=!1,
Gb=!1;const Ba=mb.a.nR/4,Xb=mb.a.e0/4;let Ab=class{constructor($a,Wb,rc){this.$=$a;this.Sj=Wb;this.xk=rc;this.O3b="!REF#";this.vp=()=>{bc&&(Fb.a.dh(bc),bc=null);this.foa&&(this.$.MWd=!1)};this.Sng=()=>{this.O3b=this.TTd.zk.ErrorNames[3];this.LPd=new oa(this.Sj,this.O3b)};this.da=Ea.f(this.$);this.za=this.da.za;this.Bya=!1;this.RMb=this.$.ea.yk;this.A5b={};this.Iy={};this.Lla={};this.foa=Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GlobalStylesSlice1",!1);this.s1a=Ua.EwaSettings.Ynb();
this.za.iy(this.vp);this.ojj=Ua.EwaSettings.$Ka();this.Dmj=Ua.EwaSettings.sya();this.zmj=Ua.EwaSettings.rya();this.njj=Ua.EwaSettings.Hnb();this.jLa=this.zmj||this.Dmj||this.ojj||this.njj;this.p2f=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8619261_EnableRowColCSEForCellEntryPoint");this.uUd=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8645280_EnablingRowColCSEIfFirstRowColOfNextBlockHidden");this.oHc=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8702535_EnablingHiddenRangeSlice2Ewa");this.rhj=
Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8682827_CSEUnattemptedBugFix");this.Z2a=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8780264_logFpCseUnattemptedInSingleTag");this.eHc=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&Ua.EwaSettings.FWd();this.KWf=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8788453_hideSelectionForFreezePanesCse");this.jLa&&void Ja.a.rj(bb.Cd).then(xb=>{this.TTd=xb;xb.zk?(xb.zk.ErrorNames&&3<xb.zk.ErrorNames.length&&(this.O3b=
xb.zk.ErrorNames[3]),this.LPd=new oa(this.Sj,this.O3b)):xb.Yod(this.Sng)});Dc=Ua.EwaSettings.tpb();Ac=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8554527_newOpDuration");mc=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8575809_mathMax");Gb=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8699403_measureValidations");this.pnb=Ua.EwaSettings.Ynb()&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8771915_enableAsyncFreezePanesCSEOperation");this.rnj=Ua.EwaSettings.FWd()&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells")}dispose(){this.da=
this.$=null;this.Iy={};this.Bya=!1;this.A5b={};this.za.px(this.vp);this.TTd&&this.TTd.HUc(this.Sng)}Lrd($a,Wb,rc){try{if(this.Bya)Da.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${$a}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=${Wb}`);else if(this.plj($a)){const Bc=this.za.qzc();this.MKh($a,null===rc||void 0===rc?void 0:rc.Kz,Bc)}else{var xb=Ua.EwaSettings.w1a()?Ua.EwaSettings.qme():Ua.EwaSettings.Z4d(),
ic=this.za.qzc(1554436520===$a||1051390410===$a?xb:0,674605324===$a||-706918724===$a?xb:0);this.LF=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8627749_EnabledSelectedRangePassingAsParameter")&&(null===rc||void 0===rc?0:rc.selectedRanges)?null===rc||void 0===rc?void 0:rc.selectedRanges:this.da.ha.qa.selectedRanges;if(this.p2f){const Bc=this.LF[0];var Rc=Wb?!(1===Bc.left&&Bc.right===Bc.maxColumns):!(1===Bc.top&&Bc.bottom===Bc.maxRows)}else Rc=!1;this.eqj=Rc;if(this.p2f&&this.eqj){var Zc=this.LF;if(0===
Zc.length)var Kd=null;else{xb=[];for(const Bc of Zc){const Lc=Bc.clone();Wb?(Lc.left=1,Lc.right=Lc.maxColumns):(Lc.top=1,Lc.bottom=Lc.maxRows);xb.push(Lc)}Kd=xb}this.LF=Kd}var fe=E(this.da,ic,Wb,$a,this.LF);this.Iy={};this.jLa&&(this.Lla={},this.Cub=0,this.uLb=rc);if(!Gb||!this.EFa("WebServiceResponseReceivedInAttemptInstantaneousGridAction",ic,$a,Wb)){var Ld=performance.now();this.n7d=this.XQi($a,Wb);var Gd=this.Emj($a,ic,fe,Wb),Zd=performance.now()-Ld;Zd&&Gb&&Da.ULS.sendTraceTag(507556638,0,50,
`GridInstantaneousAction.attemptInstantaneousGridAction command=${$a}, time taken for isInstantaneousGridActionPossible=${Zd}, isRow=${Wb}`);Gd?(this.Bya=!0,this.$.MWd=!0,Ac&&(this.Ssg=performance.now()),this.$xg($a,Wb,fe,ic)):this.da.Gk.mza(!1)}}}catch(Bc){this.UCc("GridInstantaneousAction.AttemptInstantaneousGridAction",Bc,$a)}}Hge(){this.RMb=this.$.ea.yk}MKh($a,Wb,rc){if(this.olj($a,rc,Wb)){this.Ssg=performance.now();this.Bya=!0;const xb=D(rc);this.Iy={};this.pnb?(this.Sce(rc),this.Fee($a,xb,rc,
Wb,new Map,new Map)):this.Fee($a,xb,rc,Wb)}else this.da.Gk.mza(!1)}olj($a,Wb,rc){var xb,ic,Rc;if(!this.nlj($a))return!1;if(isNullOrUndefined(rc))return this.Z2a&&n("PaneViewData Null",$a),!1;var Zc=this.da;const Kd=Zc.kj;if(this.eHc){var fe=null!==(xb=Zc.Mlb())&&void 0!==xb?xb:Zc.E5();if(null===fe||1!==fe.top||1!==fe.left)return n("Horizontal/Vertical Scroll",$a),!1;if(!k(Zc,rc,$a))return!1}else if(rc.VisibleColumns+1!==rc.FirstScrollableColumn||rc.VisibleRows+1!==rc.FirstScrollableRow)return this.Z2a?
n("Horizontal/Vertical Scroll",$a):Da.ULS.sendTraceTag(507650447,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${$a}, parameter = Scroll present`),!1;for(const Cd of Wb){xb=Cd.Pj;if(0<(null===(Rc=null===(ic=null===xb||void 0===xb?void 0:xb.Content)||void 0===ic?void 0:ic.MergedRanges)||void 0===Rc?void 0:Rc.length)){if(!this.rnj)return this.Z2a?n("Merged Cell",$a):Da.ULS.sendTraceTag(507650446,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${$a}, parameter = Merged Cell present`),
!1;a:{var Ld=Wb,Gd=Cd;Zc=rc;fe=this.da;if(!Gd&&0>=Gd.Rs){xb=!0;break a}xb=Gd.Pj.GridBlockModel;const Fd=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&Ua.EwaSettings.FWd();var Zd=Ld,Bc=Gd,Lc=Zc;if(e(Bc,1,Lc,Zd)||e(Bc,4,Lc,Zd))if(Zd=w(xb,Zc,1,Fd?x(fe,Zc.FirstScrollableRow,!0).smb:0),Zd=xb.RowNumbers[0]+Zd.S5b-1,Zd=Zd<xb.RowNumbers[0]?xb.RowNumbers[0]:Zd,!B(xb,Zd,0,!0,"FreezePane")){xb=!1;break a}Zd=Zc;if(e(Gd,1,Zd,Ld)||e(Gd,3,Zd,Ld))if(Zc=v(xb,Zc,1,Fd?x(fe,
Zc.FirstScrollableColumn,!1).smb:0),Zc=xb.ColumnNumbers[0]+Zc.oLb-1,Zc=Zc<xb.ColumnNumbers[0]?xb.ColumnNumbers[0]:Zc,!B(xb,Zc,0,!1,"FreezePane")){xb=!1;break a}xb=!0}if(!xb)return this.Z2a?n("Merged Cells Spanblocks",$a):Da.ULS.sendTraceTag(507360354,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${$a}, parameter = Merged Cells Spanblocks present`),!1}if(0<Cd.ap.count)return this.Z2a?n("Floating Objects",$a):Da.ULS.sendTraceTag(507650445,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${$a}, parameter = FO present`),
!1;if(Cd.ql.getHasTable())return this.Z2a?n("Table/PivotTable",$a):Da.ULS.sendTraceTag(507650444,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${$a}, parameter = Table present`),!1;if(!this.eHc&&Kd.roa(Cd.yj))return this.Z2a?n("Hidden Row/Col",$a):Da.ULS.sendTraceTag(507650443,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${$a}, parameter = Hidden row/col present`),!1}return!0}Emj($a,Wb,rc,xb){const ic=this.da,Rc=this.da.Gk;if(!this.tXf($a))return Rc.IY("CSENotEnabledForCommand"),
!1;if(ic.rtl)return Da.ULS.sendTraceTag(508171339,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = hasRtl, value=true, isRow=${xb}`),Rc.IY("RTL"),!1;if(!Ua.EwaSettings.K1a()&&ic.fh.By)return Da.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = hasPanes, value=true, isRow=${xb}`),!1;var Zc=ic.kj,Kd=this.LF,fe=this.LF[0],Ld=Kd.length;if(1<Ld)return Da.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = SelectedRanges, value=${Ld}, reason = Discontinuous selection, isRow=${xb}`),
Rc.IY("Discontinuous selection"),!1;var Gd=Ua.EwaSettings.sya()&&-1113896058===$a;Ld=Ua.EwaSettings.rya()&&1415868706===$a;if(Gd||Ld){if(Gd){if(1!==fe.top){var Zd=new qa.Range(fe.top-1,fe.left,fe.top-1,fe.right,!1,!1);Zd=Zc.Lob(Zd)}}else 1!==fe.left&&(Zd=new qa.Range(fe.top,fe.left-1,fe.bottom,fe.left-1,!1,!1),Zd=Zc.Bnb(Zd));if(Zd)return Da.ULS.sendTraceTag(508072654,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isPreviousRowColHidden, value=true, isRow=${xb}`),
Rc.IY("isPreviousRowColHidden"),!1;var Bc;a:{for(const Ke of rc){if(Ua.EwaSettings.kha()){if(!Ke.source)continue}else if(!Ke.source)break;Zd=null===(Bc=Ke.source)||void 0===Bc?void 0:Bc.yj;if(!Zd){V("isFirstRowColOfNonInitialModel",$a);break}if(Zd.Xi(fe)){Bc=!1;Gd?1!==Zd.top&&fe.top===Zd.top&&(Bc=!0):Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8690337_InsertColumnFlickerBugFixV2")&&1===Zd.left||fe.left!==Zd.left||(Bc=!0);break a}}Bc=!0}if(Bc)return Da.ULS.sendTraceTag(508065493,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isFirstRowColInNonInitialModel, value=true, isRow=${xb}`),
Rc.IY("isFirstRowColInNonInitialModel"),!1}if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8598978_EnablingCseForHiddenRangesSlice1")){if(!this.oHc&&!this.Ycf(fe,xb))return Da.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isPartOfRangeHidden, value=true, isRow=${xb}`),!1}else if(Zc.roa(fe))return Da.ULS.sendTraceTag(507635548,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isPartOfRangeHidden, value=true, isRow=${xb}`),
!1;Zc=this.n7d;if(Ua.EwaSettings.w1a()?Zc>Ua.EwaSettings.qme():Zc>Ua.EwaSettings.Z4d())return Da.ULS.sendTraceTag(508409418,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = rowColCount, value=${Zc}, reason = rowColCount is higher than the limit, isRow=${xb}`),Rc.IY("rowColCount is higher than the limit"),!1;if(Gd&&(Gd=ic.usedRange.bottom+Zc,Gd>mb.a.eG))return Da.ULS.sendTraceTag(508061699,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = newRowCount, value=${Gd}, reason = newRowCount is higher than the MaxRows, isRow=${xb}`),
Rc.IY("newRowCount is higher than the MaxRows"),!1;if(Ld&&(Ld=ic.usedRange.right+Zc,Ld>mb.a.PE))return Da.ULS.sendTraceTag(508061698,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = newColCount, value=${Ld}, reason = newColCount is higher than the MaxRows, isRow=${xb}`),Rc.IY("newColCount is higher than the MaxCols"),!1;if(L(fe,rc,$a))return Da.ULS.sendTraceTag(508404044,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isSelectedRangeAcrossBlocks, value=true, isRow=${xb}`),
Rc.IY("isSelectedRangeAcrossBlocks"),!1;if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8624357_DisableRowColCSEForTables")&&!this.hTh(fe,$a))return Da.ULS.sendTraceTag(507855194,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = selectedRangeContainingTable, value=true, isRow=${xb}`),Rc.IY("selectedRangeContainingTable"),!1;Ld=Wb.length;if(Ld>Ua.EwaSettings.zEj())return Da.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = BlocksInViewport, value=${Ld}, reason = Blocks in viewport limit exceeded, isRow=${xb}`),
Rc.IY("Blocks in viewport limit exceeded"),!1;a:{Ld=Zc-1;for(Lc of rc){if(!Lc){Da.ULS.sendTraceTag(509649925,0,50,`GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null and command=${$a}`);var Lc=!1;break a}Zc=Lc.source;if(!Ua.EwaSettings.kha()||Zc){if(!Ua.EwaSettings.kha()&&!Zc){Lc=!1;break a}Zc=Zc.Pj.GridBlockModel;Gd=R(Zc,Ld,xb,$a);if(!B(Zc,Gd,Ld,xb,la($a))){Lc=!1;break a}}}Lc=!0}if(!Lc)return Da.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=${xb}`),
Rc.IY("Model has complex cells"),!1;a:{Lc=xb?fe.top:fe.left;Ld=xb?fe.bottom-fe.top:fe.right-fe.left;if(fe=this.za.oJa(fe,this.$.activeItemName))for(Cd of fe)if(!B(Cd.Pj.GridBlockModel,Lc,Ld,xb,la($a))){var Cd=!1;break a}Cd=!0}if(!Cd)return Da.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=${xb}`),Rc.IY("Selected row or Col has complex cells"),
!1;a:{Kd=Kd[0];Cd=0;for(Fd of rc)if(!Ua.EwaSettings.kha()||Fd.source&&Fd.destination){if(!(Ua.EwaSettings.kha()||Fd.source&&Fd.destination))break;Lc=Fd.destination.yj;fe=Fd.source.yj;if(null===Lc||null===fe){V("getTransitionCount source or destination block range is null",$a);var Fd=Ua.EwaSettings.$4d()+1;break a}if(!Lc&&Ua.EwaSettings.pHc()){V("getTransitionCount",$a);Fd=Ua.EwaSettings.$4d()+1;break a}Ld=Kd;(fe=369708605===$a||1415868706===$a||1542466017===$a||-1113896058===$a?fe.Xi(Ld):Lc.Xi(Ld))||
(fe=$a,Zc=Fd,Lc=Kd,!Ua.EwaSettings.kha()||Zc.source&&Zc.destination?(Ld=Zc.source.yj,Zc=Zc.destination.yj,!Ua.EwaSettings.pHc()||Zc&&Ld?fe=-706918724===fe||674605324===fe?Zc.left>Lc.right:369708605===fe||1415868706===fe?Ld.left>Lc.right:1051390410===fe||1554436520===fe?Zc.top>Lc.bottom:Ld.top>Lc.bottom:(V("shouldPerformTransitions",fe),fe=!1)):fe=!1);fe&&(Cd+=1)}Fd=Cd}if(Fd>Ua.EwaSettings.$4d())return Da.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = TransitionCount, value=${Fd}, reason = Transition count limit exceeded, isRow=${xb}`),
Rc.IY("Transition count limit exceeded"),!1;if(!this.uUd&&C(ic,rc,$a))return Da.ULS.sendTraceTag(508564123,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=${xb}`),!1;if(rc=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8683331_OutlineBugFix")){var te;a:{var ye,ue,De;for(const Ke of Wb)if(Wb=Ke.ZJa(),xb&&Wb&&0<(null===(te=Wb.RowOutlines)||void 0===te?void 0:te.length)&&0<(null===(ye=Wb.RowOutlinesInformation)||
void 0===ye?void 0:ye.length)||!xb&&Wb&&0<(null===(ue=Wb.ColumnOutlines)||void 0===ue?void 0:ue.length)&&0<(null===(De=Wb.ColumnOutlinesInformation)||void 0===De?void 0:De.length)){te=!1;break a}te=!0}rc=!te}if(rc)return Da.ULS.sendTraceTag(507566090,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = outlines, value=true, isRow=${xb}`),Rc.IY("Outlines are present"),!1;Da.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${$a}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=${xb}`);
return!0}m3b($a,Wb,rc,xb,ic,Rc,Zc){const Kd=Rc?ic.iWc:ic.$qc;ic=Rc?ic.oLb:ic.S5b;const fe=Rc?"FreezeRow":"FreezeColumn";a:{const Ld=rc.FirstScrollableRow;rc=rc.FirstScrollableColumn;switch(xb){case 1:xb={hWc:Rc?$a.RowNumbers[0]:$a.ColumnNumbers[0],rRc:!Zc,qRc:!0,performDiagonalCascading:Zc,skipCascadingBeforeRowColIndex:!Zc};break a;case 2:xb={hWc:Rc?Ld:rc,rRc:!0,qRc:!1,performDiagonalCascading:Zc,skipCascadingBeforeRowColIndex:!1};break a;case 3:xb={hWc:Rc?Ld:$a.ColumnNumbers[0],rRc:!0,qRc:Rc?!1:
!0,performDiagonalCascading:Zc,skipCascadingBeforeRowColIndex:!1};break a;case 4:xb={hWc:Rc?$a.RowNumbers[0]:rc,rRc:!0,qRc:Rc?!0:!1,performDiagonalCascading:Zc,skipCascadingBeforeRowColIndex:!1};break a}xb=null}if(!xb)return Da.ULS.sendTraceTag(507569417,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${fe}, parameter = isHideRowColumnSuccessful, value=false, reason = "fpConstructionParams failed", `),!1;if($a&&0<=Kd){if(xb.rRc&&!gridRenderer.CanvasRendererGlobals.performModelRowColOperation($a,
xb.hWc,Kd,gb.FreezePane,Rc))return Da.ULS.sendTraceTag(507586704,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${fe}, parameter = freezePaneRestructureSuccessful, isRow =${Rc}, value=false, reason = "Restructuring was failure", `),!1;if(Wb&&$a&&xb.qRc)if(gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(Wb,$a,Rc?Wb.RowNumbers[0]:Wb.ColumnNumbers[0],Kd,gb.FreezePane,Rc,{rowColIndexToEndRangeCascade:ic,skipCascadingBeforeRowColIndex:xb.skipCascadingBeforeRowColIndex,
performDiagonalCascading:xb.performDiagonalCascading}).isSuccess)Da.ULS.sendTraceTag(507576470,0,50,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${fe}, parameter = freezePaneBlockCascadeOperation, value=true, isRow =${Rc}, reason = "BlockCascadeRowColsOperations success", `);else return Da.ULS.sendTraceTag(507586703,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${fe}, parameter = freezePaneBlockCascadeOperation, value=false, isRow =${Rc}, reason = "BlockCascadeRowColsOperations was failure", `),
!1}return!0}$xg($a,Wb,rc,xb){var ic;try{if(this.tXf($a)){var Rc=za.HelperMethods.Jh(),Zc=Ua.EwaSettings.wMc(),Kd=rc.filter(Fd=>!Fd.eV),fe=this.LF[0],Ld=this.oHc?this.n7d-1:Wb?fe.bottom-fe.top:fe.right-fe.left,Gd=la($a);for(const Fd of Kd){if(this.EFa("WebServiceResponseReceivedInProcessGridAction",xb,$a,Wb))return;if(this.jLa){if(!A(Fd,fe,$a,Wb))continue}else{const pe=Fd.destination.yj;if(!pe){V("processGridAction",$a);return}if(pe.right<fe.left){Fd.eV=!0;Da.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${$a}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${fe.left}, blockRangeRightMostValue=${pe.right}, hashCode=${Fd.destination.Pi}, isRow=false`);
continue}}const te=Wb?fe.topLeft.top:fe.topLeft.left;let ye,ue;Ua.EwaSettings.kha()?(ye=Fd.source?this.Hwa("SourceModel",Fd.source,$a):null,ue=Fd.destination?this.Hwa("DestinationModel",Fd.destination,$a):null):(ye=this.Hwa("SourceModel",Fd.source,$a),ue=this.Hwa("DestinationModel",Fd.destination,$a));const De=Fd.destination?Fd.destination.Pi:Fd.source.Pi;rc=!1;const Ke=Gd===gb.Hide||Gd===gb.Delete?ue:ye;if(X(Fd,$a,fe)){if(!M(Ke,te,Ld,Gd,Wb,$a)){this.UT();Da.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${$a}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${De}, isRow=${Wb}, rowColNumber=${te}`);
return}Da.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${$a}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${De}, isRow=${Wb}, rowColNumber=${te}`)}else if(Ua.EwaSettings.K1a()&&this.da.fh.AYd(fe)){const pe=this.da.fh.Rm;if(fe.right<=this.da.fh.fn||fe.bottom<=pe)rc=ya(Ke,$a,Ld+1)}if(ye&&ue&&!rc){let pe;pe=this.jLa?R(ye,Ld,Wb,$a):ye.ColumnNumbers[0];const pf=Fd.source.Pi;if(O(ye,ue,pe,Ld,Gd,Wb,$a).isSuccess)Fd.eV=
!0,this.uUd&&(this.Iy[pf]||this.AEg(ye,Wb),this.Iy[null===(ic=null===Fd||void 0===Fd?void 0:Fd.destination)||void 0===ic?void 0:ic.Pi]||this.AEg(ue,Wb),this.X5k(ye,ue,Gd,Wb)),Da.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${$a}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${pf}, isRow=${Wb}, rowColNumber=${pe}`);else{this.UT();Da.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${$a}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${pf}, isRow=${Wb}, rowColNumber=${pe}`);
return}}else Fd.eV=!0;this.vVk(ue,ye,Fd);if(za.HelperMethods.Jh()-Rc>Zc){this.Zwk($a,Wb,Kd,xb);return}}var Zd=()=>{try{this.j_h(Wb,$a,xb,fe),S("ProcessGridAction",za.HelperMethods.Jh()-Rc,$a)}catch(Fd){this.UCc("GridInstantaneousAction.ProcessGridAction",Fd,$a)}};if(this.jLa&&this.uLb&&this.uLb.aFc&&this.uLb.aFc.InsertDeleteRangeItems&&0<this.uLb.aFc.InsertDeleteRangeItems.length)if(this.LPd){var Bc=this.uLb.aFc.InsertDeleteRangeItems[0],Lc=(Fd,te)=>0!==Bc.DeltaRow?Fd>=fe.top:0!==Bc.DeltaColumn?te>=
fe.left:!1,Cd=Fd=>this.LPd.C9k(Fd,Bc.DeltaRow,Bc.DeltaColumn,fe);Gb?window.setTimeout(()=>{this.iAe(xb,$a,Wb,Lc,Cd,Zd)},0):this.iAe(xb,$a,Wb,Lc,Cd,Zd)}else this.Bya=!1,this.da.Gk.mza(!1),Da.ULS.sendTraceTag(508063873,0,15,`GridInstantaneousAction:processGridAction gridReferenceUpdates is null command=${$a}`);else Zd()}else this.Bya=!1,this.da.Gk.mza(!1)}catch(Fd){this.UCc("GridInstantaneousAction.ProcessGridAction",Fd,$a)}}X0h($a,Wb,rc,xb,ic,Rc){var Zc,Kd,fe,Ld,Gd,Zd,Bc=w($a,ic,Rc,this.eHc?x(this.da,
ic.FirstScrollableRow,!0).smb:0);const Lc=v($a,ic,Rc,this.eHc?x(this.da,ic.FirstScrollableColumn,!1).smb:0);Bc={S5b:Bc.S5b,iWc:Bc.iWc,oLb:Lc.oLb,$qc:Lc.$qc};switch(Rc){case 1:if(!this.m3b($a,rc,ic,Rc,Bc,!0,!1))return this.UT(),Da.ULS.sendTraceTag(507568152,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${Rc} failed, cascadingType=Row`),null;if(!this.m3b($a,Wb,ic,Rc,Bc,!1,!1))return this.UT(),Da.ULS.sendTraceTag(507568151,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${Rc} failed, cascadingType=Col`),
null;if(!this.m3b($a,xb,ic,Rc,Bc,!1,!0))return this.UT(),Da.ULS.sendTraceTag(507568150,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${Rc} failed, cascadingType=Diagonal-Col`),null;break;case 2:case 3:case 4:if(!this.m3b($a,rc,ic,Rc,Bc,!0,!1))return this.UT(),Da.ULS.sendTraceTag(507568149,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${Rc} failed, cascadingType=Row`),null;if(!this.m3b($a,Wb,ic,Rc,Bc,!1,!1))return this.UT(),Da.ULS.sendTraceTag(507568148,
0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${Rc} failed, cascadingType=Col`),null;break;default:return null}return new qa.Range(null===(Zc=$a.RowNumbers)||void 0===Zc?void 0:Zc[0],null===(Kd=$a.ColumnNumbers)||void 0===Kd?void 0:Kd[0],null===(fe=$a.RowNumbers)||void 0===fe?void 0:fe[(null===(Ld=$a.RowNumbers)||void 0===Ld?NaN:Ld.length)-1],null===(Gd=$a.ColumnNumbers)||void 0===Gd?void 0:Gd[(null===(Zd=$a.ColumnNumbers)||void 0===Zd?NaN:Zd.length)-1],!1,!1)}$0h($a,
Wb,rc,xb,ic,Rc){a:{var Zc=rc.FirstScrollableRow,Kd=rc.FirstScrollableColumn;for(fe of xb)if(l(fe,Zc,Kd)){Zc={};Zc.X=fe.ar.X;Zc.Y=fe.ar.Y;var fe=Zc;break a}fe=null}if(!fe||!rc)return Da.ULS.sendTraceTag(507576400,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Wb}, parameter = getRootBlockPostionOfFP, value=false, reason = "Construction failed", blockPosition= Failed to receive the root of FP ops `),!1;Zc=rc.FirstScrollableRow;Kd=rc.FirstScrollableColumn;for(let ye=
1;4>=ye;ye++)if(e($a.destination,ye,rc,xb)){var Ld=$a.destination,Gd=Zc,Zd=Kd,Bc=ye,Lc=fe,Cd={};if(l(Ld,Gd,Zd))switch(Bc){case 1:Cd.X=0;Cd.Y=0;break;case 4:Cd.X=Ld.ar.X;Cd.Y=0;break;case 3:Cd.X=0;Cd.Y=Ld.ar.Y;break;case 2:Cd.X=Ld.ar.X,Cd.Y=Ld.ar.Y}else switch(Bc){case 1:Ld=y(Ld.ar,Lc);Cd.X=Ld.X;Cd.Y=Ld.Y;break;case 4:var Fd=Zd=void 0,te=void 0;(null===(te=Ld.MB)||void 0===te?void 0:te[0])<=Gd&&(null===(Fd=Ld.MB)||void 0===Fd?void 0:Fd[(null===(Zd=Ld.MB)||void 0===Zd?NaN:Zd.length)-1])>=Gd?(Cd.X=Ld.ar.X,
Cd.Y=0):(Lc=y(Ld.ar,Lc),Cd.X=Ld.ar.X,Cd.Y=Lc.Y);break;case 3:te=Fd=Gd=void 0;(null===(te=Ld.XG)||void 0===te?void 0:te[0])<=Zd&&(null===(Fd=Ld.XG)||void 0===Fd?void 0:Fd[(null===(Gd=Ld.XG)||void 0===Gd?NaN:Gd.length)-1])>=Zd?Cd.X=0:(Lc=y(Ld.ar,Lc),Cd.X=Lc.X);Cd.Y=Ld.ar.Y;break;case 2:Cd.X=Ld.ar.X,Cd.Y=Ld.ar.Y}Cd.PaneType=Bc;Bc=Cd;Cd=this.Hwa("DestinationModel",$a.destination,Wb);Ld=$a.jXg?this.Hwa("SourceModel",$a.jXg,Wb):null;Lc=$a.nXg?this.Hwa("SourceModel",$a.nXg,Wb):null;Gd=1===ye?$a.kXg?this.Hwa("SourceModel",
$a.kXg,Wb):null:null;if(Ld=this.X0h(Cd,Lc,Ld,Gd,rc,ye))ic.set(Ld,Cd),Rc.set(Ld,{ar:Bc,yj:Ld,Pbf:$a.destination}),Da.ULS.sendTraceTag(507586701,0,50,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Wb}, parameter = isNewBlockConstructionSuccessful, value=true, reason = "Construction Successful", blockPosition=${JSON.stringify(Bc)}, paneType=${ye}, `);else return Da.ULS.sendTraceTag(507586700,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Wb}, parameter = isNewBlockConstructionSuccessful, value=false, reason = "Construction failed", blockPosition=${JSON.stringify(Bc)}, paneType=${ye}, `),
!1}return!0}d5g($a,Wb,rc,xb){if(this.pnb&&this.EFa("WebServiceResponseReceivedInUpdateBlockCacheWithConstructedBlock",xb,1844679312,void 0))return Da.ULS.sendTraceTag(507381976,0,15,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),!1;try{const ic=za.HelperMethods.Jh();let Rc=!0;$a.forEach((Zc,Kd)=>{if(Rc)if(Kd=Wb.get(Kd)){var fe=this.za.rn(Kd.Pbf.ma,Kd.ar);this.wVk(Zc,fe);this.za.e$j(Kd.ar,
Kd.Pbf.ma)?Rc=this.za.S6k(fe,Zc,Kd.ar,this.RMb,rc):(Da.ULS.sendTraceTag(507570071,0,50,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=freezeOrUnfreezeOperation, parameter = primeCacheItem, value=false, reason = "Prime Cache Items failed"'),Rc=!1)}else Rc=!1});if(!Rc)return!1;S("updateBlockCacheWithConstructedBlock",za.HelperMethods.Jh()-ic,1844679312);return!0}catch(ic){return Da.ULS.sendTraceTag(507570070,0,10,`encountered exception in updateBlockCacheWithConstructedBlock : ${ic}`),
!1}}Fee($a,Wb,rc,xb,ic,Rc){xb=void 0===xb?null:xb;try{if(this.EFa("WebServiceResponseReceivedInProcessFreezePanesGridAction",rc,$a,void 0))Da.ULS.sendTraceTag(507586699,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${$a}, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" `);else{var Zc=za.HelperMethods.Jh(),Kd=Ua.EwaSettings.wMc(),fe=[];if(this.pnb){fe=Wb.filter(Zd=>!Zd.eV);var Ld=ic;var Gd=Rc}else this.Sce(rc),fe=Wb,Ld=new Map,Gd=new Map;
for(const Zd of fe)if(Zd.destination){if(!this.$0h(Zd,$a,xb,rc,Ld,Gd)){this.UT();Da.ULS.sendTraceTag(507586698,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${$a}, parameter = isBlockConstructionForPairSuccessful, value=false, reason = "Construction failed", hashCode = ${Zd.destination.Pi} , `);return}if(this.pnb&&(Zd.eV=!0,za.HelperMethods.Jh()-Zc>Kd)){this.Ywk($a,Wb,rc,xb,Ld,Gd);return}}Ld.size!==Gd.size?Da.ULS.sendTraceTag(507576399,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${$a}, parameter = processFreezePaneGridOperation, value=false, reason = "Constructed models not matching with constructed panes" `):
(Wb=!1,(Wb=this.pnb?this.d5g(Ld,Gd,xb,rc):this.d5g(Ld,Gd,xb))?this.Xok($a,xb,rc)?(Da.ULS.sendTraceTag(507360353,0,50,`GridInstantaneousAction.processFreezePanesGridAction command=${$a}, parameter = processFreezePanesGridAction, value=true, reason = "Freeze Panes CSE operation complete" `),S("ProcessFreezePanesGridAction",za.HelperMethods.Jh()-Zc,$a)):(this.kme(rc),Da.ULS.sendTraceTag(507381975,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${$a}, parameter = renderFreezePanesGrid, value=false, reason = "Updating constructing model failed" `)):
(this.kme(rc),Da.ULS.sendTraceTag(507570069,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${$a}, parameter = updateBlockCacheItem, value=false, reason = "Updating constructing model failed" `)))}}catch(Zd){this.kme(rc),this.UCc("GridInstantaneousAction.ProcessFreezePanesGridAction",Zd,$a)}}j_h($a,Wb,rc,xb){if(!this.EFa("CommitGridInstantaneousActionResults",rc,Wb,$a)){var ic=za.HelperMethods.Jh();if(this.Iy&&0!==Object.keys(this.Iy).length){if(na(Wb))for(var Rc=0;Rc<rc.length;Rc++){var Zc=
rc[Rc].Pi;Zc&&(Zc=this.Iy[Zc])&&gridRenderer.CanvasRendererGlobals.removeExtraModelRowCol(Zc)}if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8712164_ACEFix_AbortRowColCSEWhenRowColOffsetsAreOutOfBoundsV2"))for(Rc=Object.keys(this.Iy),Zc=0;Zc<Rc.length;Zc++){var Kd=this.Iy[Rc[Zc]];if(Kd){if(30<Kd.ColumnOffsets.length){Da.ULS.sendTraceTag(507556629,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Wb},
              block # of columns = ${Kd.ColumnOffsets.length} > MaxAllowedRowColCount`);this.UT();return}if(28<Kd.RowOffsets.length){Da.ULS.sendTraceTag(507556628,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Wb},
              block # of Rows = ${Kd.RowOffsets.length} > MaxAllowedRowColCount`);this.UT();return}}}var fe=[];fe.push(...rc);ad&&!this.da.fh.By&&(Rc=this.za.nA().filter(Lc=>this.$.activeItemName===Lc.ma.sheetName),this.B8k($a,Rc,fe,Wb));this.Sce(fe);if(na(Wb)||ja(Wb)){Rc=this.da.usedRange;for(var Ld of fe)Ld.cH=4,this.rhj&&(Ld.r3a=!0),Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8578927_blockModelRestoringBugFix")?this.Iy[Ld.Pi]&&!this.iel($a,Ld.ZJa(),this.Iy[Ld.Pi],Ld.yK().paneType)?this.Iy[Ld.Pi]=
null:Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&this.za.PAa(Ld.Pi):this.hKk(Ld,Rc,xb,$a,Wb)?this.Iy[Ld.Pi]=null:Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&this.za.PAa(Ld.Pi)}if(this.jLa&&this.Lla)for(var Gd in this.Lla)Ld=this.Lla[Gd],(Rc=Ld.X9j)&&Ld.gVd&&this.xk.Bqc(Rc.range,!0);if(this.mfh(Wb,fe)){Gd=ma.a.create().toString();Ld=this.da.kj;Rc=this.LF;if(db(Wb)||ja(Wb))var Zd=0;else if(na(Wb)){Zd=$a?va(xb.top):
xb.top;Zc=$a?va(xb.bottom):xb.bottom;Kd=$a?xb.left:va(xb.left);var Bc=$a?xb.right:va(xb.right);Zd=new qa.Range(Zd,Kd,Zc,Bc,!1,!1);Zd=$a?Ld.getCellHeight(Zd):Ld.getCellWidth(Zd)}Ld.pac(Rc,Zd,$a);if(Ua.EwaSettings.K1a()&&this.da.fh.By){Zd=this.kVi(xb,$a);Rc=!1;Zc={};for(const Lc of rc)Lc.cH=4,rc=Lc.yK().paneType,Kd=this.da.fh.fn,Bc=this.da.fh.Rm,(4===rc&&!$a||3===rc&&(xb.right<=Kd||xb.bottom<=Bc))&&0===Object.keys(Zc).length&&(Zc=ba(Lc,Wb,Zd)),0!==Object.keys(Zc).length&&(Lc.Pj.PaneViewData=Zc,Rc=!0,
cb.b(Lc.ma,Zc,Lc.vk.Revision,void 0,!0));Rc&&this.da.aq.vye(Ld,this.da.fh,!0,Ba,Xb,this.da.PU())}xb=Object.keys(this.Iy);this.za.RSc(xb,Gd,$a?"row":"column",!0,Wb);this.Bya=!1;bc=ka.a(this.$).Tm.KFa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,xa.a.instance.ia(2188));S("CommitGridInstantaneousActionResults",za.HelperMethods.Jh()-ic,Wb);this.jLa&&this.Lla?window.setTimeout(()=>{this.EFa("commitGridInstantaneousActionResults",fe,Wb,$a)||(this.Lzk(),this.JBg())},Ua.EwaSettings.wMc()):
this.JBg()}else this.LIg(fe),this.UT()}else this.UT(),Da.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Wb}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${$a}`)}}Xok($a,Wb,rc){const xb=za.HelperMethods.Jh();if(this.pnb&&this.EFa("WebServiceResponseReceivedInRenderFreezePanesGridInstantaneousActionResults",rc,1844679312,void 0))return Da.ULS.sendTraceTag(507381974,0,15,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),
!1;rc=ma.a.create().toString();cb.b(this.$.ma,Wb,this.RMb,void 0,!0);Wb=this.da.kj;this.KWf&&this.da.Gh.HTb();this.da.aq.vye(Wb,this.da.fh,!0,Ba,Xb,this.da.PU());Wb=Object.keys(this.Iy);this.za.RSc(Wb,rc,"both",!0);this.KWf&&(this.da.Gh.Azb(),this.da.Gh.Cca({g2:!0,V0:!0}));this.Bya=!1;bc=ka.a(this.$).Tm.KFa(6,"GridInstantaneousAction.renderFreezePanesGridInstantaneousActionResults",void 0,xa.a.instance.ia(2188));this.M8f();S("renderFreezePaneGridInstantaneousActionResults",za.HelperMethods.Jh()-xb,
$a);return!0}kme($a){$a.forEach(Wb=>{Wb.cH=0;Wb.Pj.PaneViewData=null});this.za.WOa({xIa:!0,yIa:"FreezePaneNewCseBlocksDisposed"});this.LIg($a);this.UT()}iel($a,Wb,rc,xb){if(this.uUd&&(null===rc||void 0===rc?void 0:rc.AdjacentBlocksHiddensInfo)!==(null===Wb||void 0===Wb?void 0:Wb.AdjacentBlocksHiddensInfo)||Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8632989_FreezePanesRowColCSEFlickerBugFix")&&(2===xb||3===xb||4===xb)||Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8595615_CSElogsBugFix")&&!this.G_h(Wb,
rc,$a))return!0;xb=this.LF[0];var ic=$a?xb.top:xb.left;const Rc=$a?null===Wb||void 0===Wb?void 0:Wb.RowNumbers[(null===Wb||void 0===Wb?NaN:Wb.RowNumbers.length)-1]:null===Wb||void 0===Wb?void 0:Wb.ColumnNumbers[(null===Wb||void 0===Wb?NaN:Wb.ColumnNumbers.length)-1],Zc=this.da.usedRange,Kd=$a?Wb.RowHeights:Wb.ColumnWidths,fe=$a?rc.RowHeights:rc.ColumnWidths;if(($a?xb.bottom:xb.right)<($a?null===Wb||void 0===Wb?void 0:Wb.RowNumbers[0]:null===Wb||void 0===Wb?void 0:Wb.ColumnNumbers[0]))return 0<Wb.Cells.length||
Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8615878_willServerSendReponseInsertBugFix")&&0<rc.Cells.length||!this.Ohf(Kd,fe);if(ic>Rc)return!1;ic=this.jXi($a,ic,Wb);return this.Ohf(Kd,fe)&&($a&&xb.top>Zc.bottom||!$a&&xb.left>Zc.right||!this.pYf(Wb,ic,$a)&&!this.pYf(rc,ic,$a))?!1:!0}G_h($a,Wb,rc){$a=rc?$a.RowNumbers:$a.ColumnNumbers;Wb=rc?Wb.RowNumbers:Wb.ColumnNumbers;for(rc=0;rc<Math.min($a.length,Wb.length);rc++)if($a[rc]!==Wb[rc])return!1;return!0}jXi($a,Wb,rc){$a=$a?rc.RowNumbers:rc.ColumnNumbers;
for(rc=0;rc<$a.length;rc++)if($a[rc]===Wb)return rc;return!(Wb<$a[0])&&Wb>$a[$a.length-1]?$a.length-1:0}Ohf($a,Wb){for(let rc=0;rc<Math.min($a.length,Wb.length);rc++)if($a[rc]!==Wb[rc])return!1;return!0}pYf($a,Wb,rc){if(0===$a.Cells.length)return!1;if(rc)return $a.Cells[$a.Cells.length-1].Row>=Wb;for(rc=0;rc<$a.Cells.length;rc++)if($a.Cells[rc].Col>=Wb)return!0;return!1}Ycf($a,Wb){const rc=this.da.kj,xb=Wb&&rc.Lob($a);$a=!Wb&&rc.Bnb($a);return!xb&&!$a}B8k($a,Wb,rc,xb){for(const ic of Wb){const Rc=
ic.Pi,Zc=this.Hwa("SourceModel",ic,xb);if(!this.Iy[Rc]){const Kd=this.uIi($a,ic,Wb);if(!Kd)continue;const fe=this.Iy[Kd.Pi];if(!fe||!Kd)break;this.S7k($a,Zc,fe);ic.Y7b=!0;this.Iy[Rc]=Zc;rc.push(ic)}}}S7k($a,Wb,rc){$a?(Wb.RowNumbers=rc.RowNumbers,Wb.RowHeights=rc.RowHeights,Wb.RowOffsets=rc.RowOffsets,Wb.RowOutlinesInformation=rc.RowOutlinesInformation,Wb.RowOutlines=rc.RowOutlines,Wb.BlockHeight=rc.BlockHeight):(Wb.ColumnNumbers=rc.ColumnNumbers,Wb.ColumnWidths=rc.ColumnWidths,Wb.ColumnOffsets=rc.ColumnOffsets,
Wb.ColMetadata=rc.ColMetadata,Wb.FixedColumns=rc.FixedColumns,Wb.BlockWidth=rc.BlockWidth)}uIi($a,Wb,rc){for(const xb of rc)if($a){if(Wb.yK().topLeft.Y===xb.yK().topLeft.Y&&this.Iy[xb.Pi])return xb}else if(Wb.yK().topLeft.X===xb.yK().topLeft.X&&this.Iy[xb.Pi])return xb;return null}Lzk(){const $a=[];for(const rc in this.Lla){const xb=this.Lla[rc];if(!xb.gVd){var Wb=qa.Range.vi(xb.rowNum,xb.colNum);(Wb=this.da.zh(Wb))&&$a.push({xfa:Wb,editText:xb.cellText})}}0<$a.length&&this.xk.WRh($a)}Hwa($a,Wb,rc){let xb=
this.Iy[Wb.Pi];if(!xb){const ic=za.HelperMethods.eN(()=>{xb=Wb.iHi()});S($a,ic,rc)}return xb}Sce($a){for(const Wb of $a)$a=Wb.Pi,this.A5b[$a]||(this.A5b[$a]=Wb.ZJa())}LIg($a){for(const Wb of $a){$a=Wb.Pi;const rc=this.A5b[$a];if(rc&&!Wb.Rje(rc)){Da.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${$a}`);this.UT();break}}}mfh($a,Wb){for(const rc of Wb)if(Wb=rc.Pi,this.Iy[Wb]){if(!rc.Rje(this.Iy[Wb]))return Da.ULS.sendTraceTag(509657993,
0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${$a}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${Wb}, isRow=false`),!1;Dc&&(rc.r3a=!0)}return!0}Zwk($a,Wb,rc,xb){window.setTimeout(()=>{this.$xg($a,Wb,rc,xb)},0)}Ywk($a,Wb,rc,xb,ic,Rc){window.setTimeout(()=>{this.Fee($a,Wb,rc,xb,ic,Rc)},0)}Esj($a){for(const Wb of $a)if(Wb.Pj.Information.Revision>this.RMb)return!0;return!1}EFa($a,Wb,rc,xb){return this.Esj(Wb)?(this.RMb=this.$.ea.yk,
this.UT(),Da.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${rc}, parameter = ${$a}, value=true, reason = "Server response received before completing client side estimation", isRow=${xb}}`),!0):!1}UT(){this.Iy={};this.Bya=!1;this.A5b={};this.da.Gk.mza(!1);this.jLa&&(this.Cub=0,this.Lla={})}UCc($a,Wb,rc){this.UT();Da.ULS.sendTraceTag(509723721,0,10,`${$a} encountered exception ${Wb} for command=${rc}`)}vVk($a,Wb,rc){$a&&(this.Iy[rc.destination.Pi]=$a);
Wb&&(this.Iy[rc.source.Pi]=Wb)}wVk($a,Wb){this.Iy[Wb]=$a}hKk($a,Wb,rc,xb,ic){const Rc=xb?$a.yj.top>Wb.bottom:$a.yj.left>Wb.right;Wb=this.Iy[$a.Pi];if(!Wb)return!1;if($a=(xb?rc.top>$a.yj.bottom:rc.left>$a.yj.right)||Rc){if(0<Wb.Cells.length)return!1;if(na(ic)?xb?28<Wb.RowNumbers.length:30<Wb.ColumnNumbers.length:xb?28>Wb.RowNumbers.length:30>Wb.ColumnNumbers.length)return!0}return $a}iAe($a,Wb,rc,xb,ic,Rc){if(!this.EFa("updateReferenceForBlocks",$a,Wb,rc))if($a.length-1===this.Cub)Rc();else{for(var Zc=
za.HelperMethods.Jh();za.HelperMethods.Jh()-Zc<Ua.EwaSettings.wMc()&&$a.length-1>=this.Cub;){var Kd=$a[this.Cub].Pi;this.Cub++;var fe=this.TRi(Kd);fe=gridRenderer.CanvasRendererGlobals.getChangedCells(fe,xb);for(const Ld of fe)fe=qa.Range.vi(Ld.rowNum,Ld.colNum),fe=this.da.zh(fe),this.Lla[Ld.rowNum+"|"+Ld.colNum]=Object.assign({},Ld,{gVd:!0,X9j:fe});Kd=gridRenderer.CanvasRendererGlobals.updateReferenceUpdateForModel(this.Iy[Kd],this.O3b,xb,ic);for(const Ld of Kd)this.Lla[Ld.rowNum+"|"+Ld.colNum]=
Object.assign({},Ld,{gVd:!1})}$a.length-1>this.Cub?window.setTimeout(()=>{this.iAe($a,Wb,rc,xb,ic,Rc)},0):Rc()}}TRi($a){return this.za.Wn($a).Pj.GridBlockModel}hTh($a,Wb){if(674605324===Wb||-706918724===Wb)return!0;$a=Object(Ka.a)(this.da.$,$a);if(!$a)return!0;$a=$a.usedRange;if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8616266_RowColCSETableCheckBugFix")){if((Wb=this.da.fh.By?this.da.aRb():this.da.BR())&&Wb.Xi($a))return!1}else if(this.da.BR().contains($a))return!1;return!0}plj($a){return-73576432===
$a||-806625837===$a||-1564089444===$a||340334732===$a||1844679312===$a||83934709===$a?!0:!1}nlj($a){switch($a){case -806625837:case 340334732:case 1844679312:case -1564089444:case -73576432:return this.s1a;case 83934709:return!1;default:return!1}}tXf($a){return-1113896058===$a||1415868706===$a||1554436520===$a||674605324===$a||1051390410===$a?Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8551204_globalStyle")?this.foa&&gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():
gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():-706918724===$a}JBg(){Ac&&this.M8f()}M8f(){const $a=performance.now()-this.Ssg;this.da.Gk&&this.$.ea&&this.da.Gk.gEj(this.$.ea.yk,$a)}AEg($a,Wb){if($a.AdjacentBlocksHiddensInfo){var rc={},xb=Wb?$a.RowNumbers[0]:$a.ColumnNumbers[0],ic=Wb?$a.RowNumbers[$a.RowNumbers.length-1]:$a.ColumnNumbers[$a.ColumnNumbers.length-1],Rc=Wb?this.LF[0].top:this.LF[0].left,Zc=Wb?
this.LF[0].bottom:this.LF[0].right,Kd=!1;Wb?($a.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&(Kd=rc.IsFirstColOfNextBlockHidden=!0),$a.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&(Kd=rc.IsLastColOfPrevBlockHidden=!0),$a.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&ic<Zc&&(Kd=rc.IsFirstRowOfNextBlockHidden=!0),$a.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&xb<Rc&&(Kd=rc.IsLastRowOfPrevBlockHidden=!0)):($a.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&
(Kd=rc.IsFirstRowOfNextBlockHidden=!0),$a.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&(Kd=rc.IsLastRowOfPrevBlockHidden=!0),$a.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&ic<Zc&&(Kd=rc.IsFirstColOfNextBlockHidden=!0),$a.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&xb<Rc&&(Kd=rc.IsLastColOfPrevBlockHidden=!0));$a.AdjacentBlocksHiddensInfo=Kd?rc:void 0}}X5k($a,Wb,rc,xb){const ic=this.ogj(xb?$a.RowNumbers:$a.ColumnNumbers,xb?Wb.RowNumbers:Wb.ColumnNumbers,rc);if(ic)switch(rc){case gb.Hide:case gb.Delete:ic&&
(xb?(this.OFa($a,{IsLastRowOfPrevBlockHidden:!0}),this.OFa(Wb,{IsFirstRowOfNextBlockHidden:!0})):(this.OFa($a,{IsLastColOfPrevBlockHidden:!0}),this.OFa(Wb,{IsFirstColOfNextBlockHidden:!0})));break;case gb.Insert:case gb.Unhide:ic&&(xb?(this.OFa($a,{IsFirstRowOfNextBlockHidden:!0}),this.OFa(Wb,{IsLastRowOfPrevBlockHidden:!0})):(this.OFa($a,{IsFirstColOfNextBlockHidden:!0}),this.OFa(Wb,{IsLastColOfPrevBlockHidden:!0})))}}ogj($a,Wb,rc){const xb=$a.length,ic=Wb.length;switch(rc){case gb.Hide:case gb.Delete:return $a[0]-
1!==Wb[ic-1];case gb.Insert:case gb.Unhide:return $a[xb-1]+1!==Wb[0]}return!1}OFa($a,Wb){$a.AdjacentBlocksHiddensInfo?(Wb.IsFirstRowOfNextBlockHidden&&($a.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden=!0),Wb.IsLastRowOfPrevBlockHidden&&($a.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden=!0),Wb.IsFirstColOfNextBlockHidden&&($a.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden=!0),Wb.IsLastColOfPrevBlockHidden&&($a.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden=!0)):$a.AdjacentBlocksHiddensInfo=
Wb}XQi($a,Wb){if(!this.oHc||this.Ycf(this.LF[0],Wb)||-1113896058===$a||1415868706===$a)return Wb?this.LF[0].bottom-this.LF[0].top+1:this.LF[0].right-this.LF[0].left+1;$a=this.da.kj.NAc([this.LF[0]]).filter(xb=>Wb?xb.isRow:xb.qk);let rc=0;for(const xb of $a)rc+=Wb?xb.bottom-xb.top+1:xb.right-xb.left+1;return(Wb?this.LF[0].bottom-this.LF[0].top+1:this.LF[0].right-this.LF[0].left+1)-rc}kVi($a,Wb){return this.oHc?this.n7d:Wb?$a.bottom-$a.top+1:$a.right-$a.left+1}};Ab=Object(Xa.__decorate)([Object(Ja.d)(bb.gd),
Object(Xa.__param)(0,Object(bb.Nb)()),Object(Xa.__param)(1,Object(bb.E)()),Object(Xa.__param)(2,Object(bb.xc)())],Ab);Object(da.a)(Ab,"GridInstantaneousAction",null,[221]);var Db=a(485),xc=a(46),vc=a(427),zb=a(216),tb=a(139),ab=a(39),La=a(254),pb=a(264),ia=a(66);class kb{constructor($a,Wb){this.isRow=!1;this.autoFitRange=null;this.isRow=$a;this.autoFitRange=Wb}}Object(da.a)(kb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[146]);class fb{constructor($a){this.resizeParameters=null;this.resizeParameters=
$a}}Object(da.a)(fb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[146]);var hb=a(153),Jb=a(429),ub=a(65),nb=a(28);class Aa{constructor($a){this.OCd=$a}ojf($a){$a=za.HelperMethods.DRc($a);return Math.max(0,Math.min(Aa.kcg,$a))}ajf($a){return this.s6j($a)}mZh($a){return Math.round(this.OCd*$a+2*this.jGf()+1)}s6j($a){return Math.max(0,Math.min(Aa.Obg,(Math.max(0,Math.min(mb.a.yMc,$a))-2*this.jGf()-1)/this.OCd))}jGf(){return Math.floor(Math.max((this.OCd+3)/4,2))}dBc($a,Wb){return Wb?$a?Aa.kcg:
mb.a.f5d:$a?Aa.Obg:mb.a.yMc}}Aa.kcg=409;Aa.Obg=255;Object(da.a)(Aa,"ResizeHeadersConverter",null,[]);class ra extends Jb.a{constructor($a,Wb){super($a);this.ina=(rc,xb)=>{rc=this.gMd(rc,xb);return this.$Id(rc)};this.vsk=(rc,xb)=>{var ic=this.wXb=xb[ra.kjj];1===rc?(rc=xb[ra.yRk],ic=this.mNf(rc,ic),Da.ULS.shipAssertTag(537153996,0,ic!==ra.Rna,`ResizeHeadersDialogHandler - invalid size input, size = ${rc}`),rc=ic!==this.iTd,Da.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",
this.isRow,this.wXb,ic,rc),rc&&this.g4h(ic)):Da.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Wb.command;this.da=Ea.f(this.$);this.KVc=new Aa(this.$.workbookContext.DxDigitNormal);this.iTd=this.tSh();$a=this.K2h(this.iTd);Wb=this.M2h(this.iTd);this.dialogTitle=xa.a.instance.ia(this.isRow?478:479);$a=this.FR($a,Wb);this.initializeAndShow(this.dialogTitle,this.vsk,$a);Da.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Di(){return"ResizeHeadersDialog"}get wXb(){return ra.QPe}set wXb($a){ra.QPe=
$a}FR($a,Wb){return{[ra.QR]:this.Di,[ra.hqj]:this.isRow,[ra.ebj]:$a,[ra.dbj]:Wb,[ra.tmj]:this.wXb,[ra.fMd]:this.ina}}tSh(){const $a=this.IDi();try{return this.KIi($a)}finally{$a&&$a.dispose()}}g4h($a){const Wb={};Wb.SheetMultiRange=xc.t(this.da.ha.qa.selectedRanges,this.$);ra.Kpe(Wb,this.isRow,$a);this.$.ti(this.isRow?745189930:-445963340,ub.a.rh,8,{["resizeRowColumnParameters"]:Wb})}mNf($a,Wb){return nb.a.gha($a)?Wb?this.J2h($a):this.L2h($a):ra.Rna}L2h($a){return Math.floor(parseFloat($a))}J2h($a){$a=
parseFloat($a);return 0>$a?ra.Rna:$a?this.isRow?za.HelperMethods.D6j($a):this.KVc.mZh($a):0}M2h($a){return $a===ra.Rna?"":this.isRow?this.KVc.ojf($a).toString():this.KVc.ajf($a).toFixed(2)}K2h($a){return $a===ra.Rna?"":$a.toString()}KIi($a){if(!$a||!$a.$$mn()||!$a.Du)return ra.Rna;var Wb=Object(hb.a)(29,$a.Du);if(!Wb)return ra.Rna;for(Wb=this.isRow?Wb.l0a:Wb.gTd;$a.$$mn();){const rc=Object(hb.a)(29,$a.Du);if(rc&&(this.isRow?rc.l0a:rc.gTd)!==Wb)return ra.Rna}return Wb}IDi(){const $a=[];for(const rc of this.da.ha.qa.selectedRanges){const xb=
rc.clone();var Wb=this.da.sl(this.da.fh.Lo(xb));Wb=xb.Hk(Wb.Dp);if(!Wb)return null;this.isRow?xb.right=xb.left=Wb.left:xb.top=xb.bottom=Wb.top;$a.push(xb)}return $a.length?this.da.lfa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",$a):null}gMd($a,Wb){if(!nb.a.gha($a))return 1;$a=this.mNf($a,Wb);return 0!==$a||this.da.kj.Jcf(this.da.ha.qa.selectedRanges,this.isRow)?this.ctj($a)?0:2:3}$Id($a){let Wb="";switch($a){case 0:Wb="";break;case 1:Wb=xa.a.instance.ia(767);break;case 2:Wb=String.format(xa.a.instance.sh(99),
0,this.dBc(this.wXb));break;case 3:Wb=xa.a.instance.ia(768)}return Wb}ctj($a){return 0<=$a&&$a<=this.dBc(!1)}dBc($a){return this.KVc.dBc($a,this.isRow)}static Kpe($a,Wb,rc){if(Wb){$a.ColumnWidth=ra.Rna;$a.RowHeight=rc;for(const xb of $a.SheetMultiRange.Ranges)xb.FirstColumn=0,xb.LastColumn=0}else{$a.RowHeight=ra.Rna;$a.ColumnWidth=rc;for(const xb of $a.SheetMultiRange.Ranges)xb.FirstRow=0,xb.LastRow=0}}}ra.QR="id";ra.hqj="isRow";ra.ebj="initialSizeInPx";ra.dbj="initialSizeInDefaultUnits";ra.tmj="isInitialUnitsDefaultUnits";
ra.fMd="getInputErrorIfInvalid";ra.yRk="size";ra.kjj="isDefaultUnits";ra.Rna=-1;ra.QPe=!0;Object(da.a)(ra,"ResizeHeadersDialog",Jb.a,[]);var vb=a(64);const rb=($a,Wb,rc,xb,ic,Rc,Zc)=>{Zc=$a.$a(41,void 0===Zc?null:Zc);Zc.resizeRowColumnParameters=Wb;return vb.h($a,"ResizeRowsColumns",Zc,rc,xb,ic,Rc,0)};var Nb=a(77),Qc=a(324),jd=a(156),xd=a(36),ae=a(359),Sd=a(101);let fc=class{constructor($a,Wb,rc,xb){this.EYj=(ic,Rc)=>{if(!La.a(ic)&&Rc){const Zc=!!ic&&!!ic.RequestTelemetryData;Ea.f(this.$).Gk.t1(Rc,
ic.StateId,Zc?ic.RequestTelemetryData.EcsOperationDuration:0,Zc?ic.RequestTelemetryData.EcsRequestDuration:0,Zc?ic.RequestTelemetryData.WfeRequestDuration:0)}};this.fPj=(ic,Rc)=>{bb.xg.Aa()?void Ja.a.resolve(bb.xg,{va:1}).then(Zc=>{Zc.j2g(Rc)}):ab.TaskExtensions.Xa(Nb.GetServiceTaskFactory.Tj(this.$.la,534,535,1),Zc=>{Zc.result.j2g(Rc)},this.$.ya,3)};this.$=$a;this.xk=Wb;this.gridInstantaneousAction=rc;this.grid=Ea.f(this.$);this.ISb=xb}Ri($a,Wb){$a=!0;switch(Wb){case -445963340:case 1391094586:$a=
this.Wj(8);break;case 745189930:case 146338636:$a=this.Wj(16)}return!$a}executeCommand($a,Wb,rc){var xb=Ea.f(this.$),ic=Wb.command;$a=ma.a.create().toString();var Rc=ab.TaskExtensions.Gq();switch(ic){case 1391094586:case 146338636:Rc=1391094586===ic;($a=rc.autoFitRanges)&&$a.Ranges&&$a.Ranges.length||($a=xc.t(xb.ha.qa.selectedRanges,this.$));Rc=this.Wgi(Rc?1:0,$a,Wb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Rc=-445963340===ic||-706918724===
ic||369708605===ic;var Zc=Ua.EwaSettings.cob()||Ua.EwaSettings.w1a(),Kd=Ua.EwaSettings.qHc();(Zc&&-706918724===ic||Kd&&1051390410===ic)&&xb.Gk.gQ(18,$a,Db.a(ic));if(-445963340===ic||745189930===ic){var fe=Db.a(Wb.command);xb.Gk.gQ(16,$a,fe);var Ld=rc.resizeRowColumnParameters}else{rc=Ua.EwaSettings.m_d()&&(369708605===ic||1542466017===ic)&&rc.rangeToUnhide?[rc.rangeToUnhide]:xb.ha.qa.selectedRanges;xb=0;Zc=!1;Kd="";let Bc=!1;const Lc=Ua.EwaSettings.fWb();Lc&&(Kd=Db.a(Wb.command),Zc=1<rc.length?!0:
!1);for(var Gd of rc){if(Lc&&this.ISb){var Zd=this.grid.za.bY(Gd);this.ISb.Fnd(Zd,Kd)}if(-706918724===ic||369708605===ic)Zd=Gd.right-Gd.left+1,xb+=0<Zd?Zd:-1*Zd;else if(1542466017===ic||1051390410===ic)Bc=!0,xb+=Gd.bottom-Gd.top+1}Lc&&this.ISb&&(this.ISb.c3e(xb,Kd),this.ISb.b2e(Kd,Bc,xb,rc[0],Wb.command));if(369708605===ic||1542466017===ic){if(Da.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${xb}, isDiscontinuous=${Zc}`),Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8373854_LogUnhideButtonClickOnNoHiddenRangePresent")){xb=
Gd=!1;Zc=this.grid.kj;for(Ld of rc)if(Gd=Ld.isRow&&Zc.Lob(Ld),xb=Ld.qk&&Zc.Bnb(Ld),Gd||xb)break;Gd||xb||Da.ULS.sendTraceTag(508061769,0,50,"ResizeCommandHandler.doResize: unhide Rows/Columns clicked when no hidden range in selected range")}}else-706918724!==ic&&1051390410!==ic||Da.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${xb}, isDiscontinuous=${Zc}`);ic=369708605===ic||1542466017===ic?-2:0;Ld={};Ld.SheetMultiRange=xc.t(rc,this.$);if(Rc)for(fe of Ld.SheetMultiRange.Ranges)fe.FirstRow=
0,fe.LastRow=0;else for(const Cd of Ld.SheetMultiRange.Ranges)Cd.FirstColumn=0,Cd.LastColumn=0;Ld.RowHeight=Rc?-1:ic;Ld.ColumnWidth=Rc?ic:-1}Rc=this.ohi(Ld,Wb,$a,Rc);break;case 957527587:case 2040891415:Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===Wb.tabName&&Sd.b("HomeTabFormat"),new ra(this.$,Wb)}return Rc}Gi($a,Wb,rc,xb){if($a=!!rc&&!!xb&&1===xb.wO)switch(Wb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:$a=!1}return $a}dj(){return!1}bAj($a){Da.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Qc.c)($a)}. Reason: ${Object(Qc.c)($a)?void 0:$a.reason}.`)}Wj($a){return(new tb.a(this.$.sa)).Wj($a)}Wgi($a,Wb,rc){const xb=this.$.pa.ta.Wh(),ic=0===$a,Rc=()=>new kb(ic,Wb);return vc.a(this.$.userOperationManager,(Zc,Kd,fe)=>{var Ld=this.$.pa.ta;Zc=pb.c(Zc,this.fPj);var Gd={gij:!ic,bsd:Wb};const Zd=Ld.$a(41,xb);Zd.isRow=ic;Zd.autoFitRanges=
Wb;return vb.h(Ld,"AutoFit",Zd,Zc,Kd,fe,Gd,0)},Zc=>new zb.a(135,0,Zc,void 0,Rc),rc)}ohi($a,Wb,rc,xb){const ic=Wb.command,Rc=Ea.f(this.$),Zc=xc.h($a.SheetMultiRange.Ranges);if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Kd=-706918724===ic||-445963340===ic&&0===$a.ColumnWidth,fe=Rc.kj;if((1051390410===ic||745189930===ic&&0===$a.RowHeight||Kd)&&!fe.Jcf(Zc,!xb))return this.$fi(xb),ab.TaskExtensions.Gq()}let Ld;Kd=(Ua.EwaSettings.cob()||Ua.EwaSettings.w1a())&&-706918724===
ic;fe=Ua.EwaSettings.qHc()&&1051390410===ic;let Gd=void 0;if(745189930===ic||-445963340===ic||Kd||fe)Da.ULS.shipAssertTag(537154002,0,this.$.activeItemName===$a.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Kd||fe?(this.gridInstantaneousAction.Hge(),Gd=()=>{Rc.Gk.mza();this.gridInstantaneousAction.Lrd(ic,!xb)},Ua.EwaSettings.XHc()||Object(jd.e)(()=>{Gd()},this.$.ya,0)):(Ld=this.xk.gte(Rc,Zc,xb?$a.ColumnWidth:$a.RowHeight,!xb),this.bAj(Ld),Object(Qc.c)(Ld)&&
Rc.Gk.gT(rc,ia.BasicTelemetryCalculator.TR));const Zd=this.$.pa.ta.Wh({lza:!0,Uxa:3});Kd=(Lc,Cd,Fd)=>{this.$.WC();xc.j(Zc,",",this.$,!1);return rb(this.$.pa.ta,$a,pb.c(Lc,this.EYj),Cd,Ua.EwaSettings.XHc()?pb.a(Fd,()=>{window.setTimeout(()=>{Gd&&Gd()},0)}):Fd,rc,Zd)};const Bc=()=>new fb($a);return Ld&&Object(Qc.c)(Ld)?vc.a(this.$.userOperationManager,Kd,Lc=>new zb.a(136,0,Lc,64,Bc),Wb):vc.a(this.$.userOperationManager,Kd,Lc=>new zb.a(136,0,Lc,void 0,Bc),Wb)}$fi($a){$a=xd.a.nj(1,0,$a?769:771,$a?770:
772,0,$a?-2037763134:503471870,$a?"HideAllColumnsError":"HideAllRowsError");new ae.a(this.$,$a)}};fc=Object(Xa.__decorate)([Object(Ja.d)(bb.tf),Object(Xa.__param)(0,Object(bb.Nb)()),Object(Xa.__param)(1,Object(bb.xc)()),Object(Xa.__param)(2,Object(bb.gd)()),Object(Xa.__param)(3,Object(bb.Zc)())],fc);Object(da.a)(fc,"ResizeCommandHandler",null,[43]);var uc=a(592),hc=a(9),Ec=a(428),yd=a(19),Ad=a(75),$b=a(71),Ob=a(7),Yc=a(29);class zd{}zd.qpi="ewa-resizehdr-row-hidden";zd.ppi="ewa-resizehdr-col-hidden";
Object(da.a)(zd,"CssClassNames",null,[]);var Dd=a(306),oc=a(17),$c=a(193),yb=a(764),qb=a(35),Cb=a(290),gc=a(6),Mc=a(245),bd=a(154),Id=a(60),Vd=a(16),ce=a(69),ee=a(105),Je=a(325),Ue=a(155),jc=a(431),tc=a(114);class Kc{constructor($a,Wb,rc,xb,ic,Rc,Zc){this.wKa=$a;this.k_b=Wb;this.TMa=rc;this.hRd=xb;this.xvb=ic;this.L3f=Rc;this.P5i=Zc}}Object(da.a)(Kc,"HeaderEventCachedInfo",null,[]);var wd=a(176);class Rb extends ee.a{constructor($a,Wb){super(Wb.domElement);this.p9=this.zIg=!1;this.Zn=this.Npb=this.WPa=
null;this.Uke=!0;this.QIc=!1;this.f6b=this.Gs=this.offset=0;this.iY=this.a2=this.Lca=null;this.$6i="headerResizeTooltip";this.uW=this.f3d=null;this.esd=this.Gda=this.GOa=!1;this.ntg=this.Msb=mb.a.TKa;this.nbc=!1;this.dXb=Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ResizeHeaderUXModernization",!1);this.b2f=Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8511759_RemoveResizeTooltip");this.C0a=Ua.EwaSettings.C0a();this.vLa=Ua.EwaSettings.vLa();this.O5=Ua.EwaSettings.j6()&&Ua.EwaSettings.QWd();
this.VYd=!1;this.wre=!0;this.mJ=rc=>{if(this.grid.fp)return!1;rc=tc.a().il(rc);if(3===rc.Dh&&!this.M3f(rc.La)||!this.zwg(rc,!1))return!1;Da.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const xb=this.UZc();this.iJd(rc.clientPoint,xb,!0);this.GOa||(Dd.a.instance.xa(oc.a.wv,this.domElement.ownerDocument.body,this.Wrb),$c.a.instance.xa(oc.a.Jn,this.domElement.ownerDocument.body,this.Wrb),this.GOa=!0);this.p9&&this.NTf(rc);return!1};this.A0b=rc=>{rc=tc.a().il(rc);
this.esd&&this.NTf(rc);if(!rc.La.type.includes("touch")&&rc.La.button!==Sys.UI.MouseButton.leftButton||!this.V1a)return!1;ce.g(rc.La);this.ztf();rc=this.grid.fp?this.Msb:mb.a.TKa;if(this.grid.fp&&this.Zn){var xb=rc!==this.Gs;!xb&&this.nbc&&(this.fk.removeRowColFromModel(this.Zn.NGb,this.Zn.i6a),this.fk.vja(this.grid.ha.qa.selectedRanges),this.fk.vr("HeaderResizeBehavior::onDocumentMouseUp"))}else this.Zn&&(rc=this.Gda?this.VKd():this.Zn.oga()),xb=rc!==this.Gs;if(this.WPa&&xb&&rc!==mb.a.TKa){rc=this.grid;
var ic=this.MNd(rc);xb={};xb.SheetMultiRange=xc.t(ic,rc.$);Rb.Kpe(xb,this.isRow,this.Gs);if(this.grid.fp){ic=this.Zn?this.Zn.NGb:-1;const Rc=xb.SheetMultiRange.Ranges[0],Zc=Rb.loa()&&0===this.Gs?20:50;Da.ULS.sendTraceTag(509694147,2,Zc,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${ic}, isResizingHiddenHeader=${this.Gda}, headerViewBlockHashCode=${this.fk.hashCode},
          rangeFirstRow=${Rc.FirstRow}, rangeFirstColumn=${Rc.FirstColumn}, rangeLastRow=${Rc.LastRow}, rangeLastColumn=${Rc.LastColumn},`)}this.pli(xb);rc.eXk=!0}else this.sm(null,null),this.r4b();this.nbc=this.Gda=!1;this.C0a&&this.Dqc("onDocumentMouseUp");return!1};this.R6=rc=>{if(this.grid.fp)return!1;rc=yb.a.create(rc.eventName,rc.li,rc.La,rc.Dh);rc=tc.a().il(rc);if(!this.zwg(rc,!0))return!1;rc=this.grid;var xb=this.MNd(rc);xb=xc.t(xb,rc.$);this.dXb?rc.Gh.Mq([this.isRow?51:52]):rc.Gh.Mq([this.isRow?
13:14]);rc.Gh.Cca();this.r4b();rc.$.ti(this.isRow?146338636:1391094586,ub.a.rh,30,{["autoFitRanges"]:xb});return!1};this.Elg=rc=>{this.p9?(this.Gda&&!this.nbc&&(this.syh(),this.fk.vr("HeaderResizeBehavior::onHeaderResizeChanged")),this.QIc||this.jVf(),rc=new Sys.UI.DomEvent(rc),rc=yb.a.create(oc.a.WVa,this.domElement,rc,2),rc=tc.a().il(rc),this.W9d(rc.clientPoint),this.wre&&(this.wre=!1,this.fk.xSg()&&(this.fk.FIh(),this.w_f=!0))):Da.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Zn?
this.Zn.NGb:-1}, isRow = ${this.isRow}`)};this.Flg=rc=>{rc=new Sys.UI.DomEvent(rc);rc=yb.a.create(oc.a.WVa,this.domElement,rc,2);this.A0b(rc)};this.IUj=rc=>{var xb;if(Rb.loa()&&!this.Zn){rc=!!this.fk;const ic=null===(xb=this.fk)||void 0===xb?void 0:xb.hashCode;Da.ULS.sendTraceTag(508368662,2,15,`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, isViewBlockSet=${rc}, this.viewBlock.hashCode=${ic}`)}else this.Pha(rc,
this.Zn,!1)};this.Wrb=rc=>{rc=tc.a().il(rc);ce.g(rc.La);return this.W9d(rc.clientPoint)};this.zS=rc=>{if(this.grid.fp)return!1;rc=tc.a().il(rc);let xb;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return ka.a(this.grid.$).tv()&&(xb=this.ULd(rc))&&(xb.wKa.style.cursor=""),!1;if(this.p9)return this.jVf(),!1;xb=this.ULd(rc);if(!xb)return!1;xb.wKa.style.cursor=!this.grid.isEditing&&this.Q_d(xb)?this.isRow?"row-resize":"col-resize":"";ce.g(rc.La);return!0};this.Ry=()=>{this.r4b()};
this.sm=()=>{if((3===ub.a.rh||qb.a.Ux)&&this.grid.ha.qa.Bn){var rc=this.grid.ha.qa.jj;if(!(!rc.isRow&&!rc.qk||!this.domElement||rc.isRow&&this.isRow&&!this.fk.JD.includes(rc.top)||rc.qk&&!this.isRow&&!this.fk.JD.includes(rc.left))){var xb=this.grid.yl(rc,this.fk.Iq.paneType);if(xb){if(this.grid.fp){const ic=this.isRow?rc.bottom:rc.right;this.Zn=this.fk.qB(qa.Range.vi(rc.bottom,rc.right));if(!this.Zn){Da.ULS.sendTraceTag(522826880,2,Rb.loa?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${ic}, is row ${this.isRow}`);
return}}this.uW||this.H$h();rc.isRow&&this.isRow?(this.DYc(!0,"onSelectionEnded"),this.uW.style.top=xb.bottomRight.y-this.uW.offsetHeight/2+"px"):rc.isRow||this.isRow||(this.DYc(!0,"onSelectionEnded"),Je.c(this.uW.style,this.grid.rtl,xb.bottomRight.x-this.uW.offsetWidth/2+"px"))}}}};this.$Y=(rc,xb)=>{Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&Da.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${xb.YT}`);
xb.YT&&this.sKb()};this.fk=Wb;this.isRow=Wb.isRow;this.rtl=Wb.Iq.rtl;this.grid=$a;this.Qbg=this.isRow?mb.a.f5d:mb.a.yMc;this.V6i=xa.a.instance.ia(436);this.d7i=xa.a.instance.ia(435);this.Y6i=xa.a.instance.ia(437);Ue.a(this.grid.$,rc=>{this.f3d=rc.b0(bd.a.Esk,!1)});this.nhk();this.grid.ha.oX(this.sm);this.grid.ha.ila(this.Ry);this.grid.aA(this.sm);ka.a(this.grid.$).Tm.Wta(this.$Y)}get V1a(){return this.p9}get I6a(){var $a,Wb;return null!==(Wb=null===($a=this.Zn)||void 0===$a?void 0:$a.i6a)&&void 0!==
Wb?Wb:-1}get Gsk(){this.imi();return Rb.yvb}GUj($a){Ua.EwaSettings.bXb()&&!this.V1a&&this.$sj($a.i6a)&&this.fk.EYc($a.i6a,!1)}JUj($a,Wb){Ua.EwaSettings.bXb()&&!this.V1a&&this.fk.EYc($a.i6a,Wb)}Pha($a,Wb,rc){var xb,ic=new Sys.UI.DomEvent($a);ic=yb.a.create(oc.a.WVa,this.domElement,ic,2);ic=tc.a().il(ic);this.ywg(Wb,ic.clientPoint.x,ic.clientPoint.y,!1,rc,$a);this.O5&&(null===(xb=Ja.a.nh(bb.jd))||void 0===xb?void 0:xb.yPf(!0));$a=this.UZc();this.iJd(this.WPa,$a,!0);this.GOa||($a=this.domElement.ownerDocument.body,
$a.addEventListener("pointermove",this.Elg),$a.addEventListener("pointerup",this.Flg),this.GOa=!0)}FUj($a,Wb,rc){this.ywg(Wb,$a.clientX,$a.clientY,!0,rc,$a);$a=this.grid;Wb=this.MNd($a);Wb=xc.t(Wb,$a.$);this.dXb?$a.Gh.Mq([this.isRow?51:52]):$a.Gh.Mq([this.isRow?13:14]);$a.Gh.Cca();this.r4b();$a.$.ti(this.isRow?146338636:1391094586,ub.a.rh,30,{["autoFitRanges"]:Wb})}dispose(){this.Dqc("dispose");this.grid.ha&&(this.grid.ha.oZ(this.sm),this.grid.ha.uia(this.Ry));this.grid.$E(this.sm);ka.a(this.grid.$)&&
ka.a(this.grid.$).Tm.HAa(this.$Y);Cb.a.instance.Qa(oc.a.Nr,this.domElement,this.R6);Dd.a.instance.Qa(oc.a.Co,this.domElement.ownerDocument.body,this.A0b);$c.a.instance.Qa(oc.a.ml,this.domElement.ownerDocument.body,this.A0b);qb.a.Ux||(Dd.a.instance.Qa(oc.a.qj,this.domElement,this.mJ),Dd.a.instance.Qa(oc.a.wv,this.domElement,this.zS));this.GOa&&(Dd.a.instance.Qa(oc.a.wv,this.domElement.ownerDocument.body,this.Wrb),$c.a.instance.Qa(oc.a.Jn,this.domElement.ownerDocument.body,this.Wrb),this.GOa=!1);this.uW&&
(Dd.a.instance.Qa(oc.a.qj,this.uW,this.mJ),Cb.a.instance.Qa(oc.a.Nr,this.uW,this.R6),Rb.loa()?this.zEg("dispose"):(this.Dqc(""),this.uW=null));this.zIg&&(Vd.DOMElementExtensions.$m(Rb.yvb),Rb.yvb=null);this.fk=null;super.dispose()}nhk(){Cb.a.instance.xa(oc.a.Nr,this.domElement,this.R6);Dd.a.instance.xa(oc.a.Co,this.domElement.ownerDocument.body,this.A0b);$c.a.instance.xa(oc.a.ml,this.domElement.ownerDocument.body,this.A0b);qb.a.Ux||(Dd.a.instance.xa(oc.a.qj,this.domElement,this.mJ),Dd.a.instance.xa(oc.a.wv,
this.domElement,this.zS))}imi(){if(!Rb.yvb){document.getElementById(Rb.yIg);this.zIg=!0;var $a=Rb.yvb=document.createElement("div");this.grid.$.frame.dna().appendChild($a);$a.id=Rb.yIg;$a.className=Yc.jb;Vd.DOMElementExtensions.setVisible($a,!1)}}$sj($a){return-1<=$a?!0:!1}ztf(){var $a;if(this.GOa){const Wb=this.domElement.ownerDocument.body;this.grid.fp?(Wb.removeEventListener("pointermove",this.Elg),Wb.removeEventListener("pointerup",this.Flg)):(Dd.a.instance.Qa(oc.a.wv,Wb,this.Wrb),$c.a.instance.Qa(oc.a.Jn,
Wb,this.Wrb));this.GOa=!1}this.p9=!1;Ua.EwaSettings.bXb()&&this.fk.EYc(this.Zn.i6a,!1);this.Lkk();jc.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation");this.O5&&(null===($a=Ja.a.nh(bb.jd))||void 0===$a?void 0:$a.yPf(!1))}Qtk(){this.dXb?this.VYd?(this.VYd=!1,this.grid.Gh.Mq(this.isRow?[49,51]:[50,52])):this.grid.Gh.Mq(this.isRow?[51]:[52]):this.grid.Gh.Mq([this.isRow?13:14]);this.grid.Gh.Cca()}syh(){this.fk.addRowColToModel(this.Zn.NGb-1,this.Zn.i6a);this.nbc=!0}W9d($a){if(!this.p9)return!1;
const Wb=this.isRow;if(!this.grid.fp&&!this.Lca){this.Lca=document.createElement("div");this.Lca.style.cssText="position: relative; width: inherit; height: inherit;"+(Wb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var rc=this.Zn.fP();rc.nextSibling;)this.Lca.appendChild(rc.nextSibling);rc.parentNode.appendChild(this.Lca)}rc=Wb?$a.y-this.Npb.y:(this.rtl?-1:1)*($a.x-this.Npb.x);const xb=Wb?$a.y-this.WPa.y:(this.rtl?-1:1)*($a.x-this.WPa.x),ic=this.grid.fp?this.Msb:this.Zn.oga();if(ic===mb.a.TKa)return!1;
rc&&(0<this.Gs||0<ic+xb)&&ic+xb<=this.Qbg&&(this.Gs=this.UZc(xb),this.iJd($a,this.Gs,!1),this.grid.fp?this.Gs>=Rb.GRf?(this.Uke=!0,this.Zn.setCellExtent(this.Gs)):this.Uke&&(this.Uke=!1,this.Zn.setCellExtent(Rb.GRf)):(Vd.DOMElementExtensions.GCa(this.Zn.fP(),!Wb,Math.max(this.f6b+xb,0)),this.Lca.style[Wb?"top":this.rtl?"right":"left"]=Math.max(xb,-this.f6b)+"px"),rc=(this.grid.fp?this.ntg:Wb?this.Zn.fk.ZL:this.Zn.fk.$L)+Math.max(xb,this.grid.fp?-this.Msb+Rb.GCc:-this.f6b),Vd.DOMElementExtensions.GCa(this.Zn.fk.domElement,
!Wb,rc),this.grid.fp&&this.Zn.fk.MBk(rc),this.Npb=new Sys.UI.Point($a.x,$a.y),this.DYc(!1,"onHeaderResizeChangedInternal"));return!0}DYc($a,Wb){var rc;Vd.DOMElementExtensions.setVisible(this.uW,$a);Rb.loa()&&Da.ULS.sendTraceTag(508150752,2,50,`HeaderResizeBehavior.setTouchResizerVisible: called with visible: ${$a}. caller:${Wb} isRow: ${this.isRow}, blockHash: ${null===(rc=this.fk)||void 0===rc?void 0:rc.hashCode}`)}oga(){return this.Zn?this.Gda?Rb.m7i:this.Zn.oga():mb.a.TKa}iJd($a,Wb,rc){this.b2f||
(this.iY&&rc&&(Da.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.rEg()),this.iY||rc||Da.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead"),this.f3d&&this.f3d(()=>({["Location"]:"canvas"})),this.iY?this.oDf(Wb):(this.iY=document.createElement("div"),this.iY.id=this.$6i,this.oDf(Wb),this.iY.className=
Yc.K,Wb=document.getElementById(this.grid.$.xi+Ob.a.Mdg),Wb.insertBefore(this.iY,Wb.firstChild),$a=tc.a().sga($a),this.iY.style.left=(this.rtl?Math.max($a.x-this.iY.offsetWidth,0):$a.x-Math.max($a.x+this.iY.offsetWidth-Wb.offsetWidth,0)).toString()+"px",Wb=document.getElementById(Ob.a.lGa),this.iY.style.top=($a.y-(gc.AFrameworkApplication.ra&&gc.AFrameworkApplication.ra.$g.el?0:Wb.offsetHeight)-this.iY.offsetHeight).toString()+"px"))}rEg(){this.b2f||(Vd.DOMElementExtensions.$m(this.iY),this.iY=null)}oDf($a){var Wb=
new Aa(this.grid.$.workbookContext.DxDigitNormal);Wb=this.isRow?Wb.ojf($a).toFixed(2):Wb.ajf($a).toFixed(2);this.iY.innerText=`${this.isRow?this.V6i:this.d7i} ${Wb} (${$a.toString()} ${this.Y6i})`}zwg($a,Wb){let rc;const xb=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===$a.Dh&&$a.La.button!==Sys.UI.MouseButton.leftButton||!this.Q_d(rc=this.ULd($a))||!xb)return!1;ce.g($a.La);this.WPa=this.Npb=new Sys.UI.Point($a.clientPoint.x,$a.clientPoint.y);this.BRh(rc,Wb);if(!this.Zn)return!1;
this.p9=!0;this.Spj(this.Zn,rc)&&this.Daj();this.f6b=this.VKd();return this.Awg($a.La.rawEvent,Wb)}ywg($a,Wb,rc,xb,ic,Rc){this.p9=!0;this.Gda=ic;this.Zn=$a;this.Y9f("prepareResizeOperation");this.QIc=!1;this.WPa=this.Npb=new Sys.UI.Point(Wb,rc);$a=this.Zn.getRange();this.a2=ic?this.L5e($a):$a;this.Msb=this.oga();this.ntg=this.isRow?this.Zn.fk.ZL:this.Zn.fk.$L;this.Awg(Rc,xb)}Awg($a,Wb){const rc=this.grid.fp?{["IsResizingHiddenHeader"]:this.Gda,["IsAutoFitting"]:Wb,["NumberOfSelectedRanges"]:this.grid.ha.qa.vS,
["Location"]:"canvas",["ResizeRange"]:this.a2,["ResizedCellAbsoluteIndex"]:this.Zn.NGb,["HeaderViewBlockHashCode"]:this.fk.hashCode}:{["IsResizingHiddenHeader"]:this.Gda,["IsAutoFitting"]:Wb,["NumberOfSelectedRanges"]:this.grid.ha.qa.vS,["Location"]:"canvas"};Ue.b(this.grid.$).Aj(bd.a.usk,rc);this.grid.kNk&&(Wb=Wb?"header_resize_autofit":"header_resize_start",wd.b(this.grid.$).SA($a,Wb,void 0));this.offset=this.Zn.qna();this.Gs=this.grid.fp?this.Msb:this.Zn.oga();if(this.Gs===mb.a.TKa)return!1;jc.c(this.grid.$,
!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Spj($a,Wb){var rc=this.Zn.fP();if(!rc)return Da.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;rc=rc.nextSibling;if(!rc)return!1;$a=$a.getRange();rc=this.fk.vJa(rc).getRange();if(!$a||!rc)return Da.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;$a=this.isRow?$a.bottom:$a.right;rc=this.isRow?rc.bottom:rc.right;return $a+1!==rc&&$a!==rc&&this.Q_d(Wb,!0)}Daj(){var $a=this.Zn.fP();
const Wb=this.fk.vJa($a.nextSibling);Rb.Tpj(Wb,this.isRow)?(this.Zn=Wb,this.a2=this.Zn.getRange()):(this.tyh($a),this.Zn=Wb,$a=this.Zn.getRange(),this.a2=this.L5e($a),this.Gda=!0)}L5e($a){return this.isRow?new qa.Range($a.top-1,$a.left,$a.top-1,$a.right,!1,!0):new qa.Range($a.top,$a.left-1,$a.bottom,$a.left-1,!1,!0)}tyh($a){const Wb=this.fk.vJa($a.nextSibling),rc=Rb.H6h(Wb,this.isRow,this.rtl);rc&&$a.parentNode.insertBefore(rc,Wb.fP())}MNd($a){const Wb=this.a2,rc=$a.ha.qa.selectedRanges;if($a.ha.qa.aOb(Wb))if(this.isRow){if(Mc.a.all(rc,
xb=>xb.isRow))return rc}else if(Mc.a.all(rc,xb=>xb.qk))return rc;return[Wb]}getCellExtent(){return this.Zn.getCellExtent()}VKd(){const $a=this.Zn.fP().style;return Math.max(0,Math.min(this.Qbg,0|parseInt(this.isRow?$a.height:$a.width,10)))}UZc($a){$a=void 0===$a?0:$a;const Wb=this.grid;var rc=this.fk.Iq.paneType;var xb=this.isRow?3===rc?[3,2]:[1,4]:4===rc?[2,4]:[1,3];var ic=Math.max(this.grid.fp?this.Msb:this.Zn.oga(),0);ic=this.Gda&&!this.grid.fp?Math.max(this.VKd(),0):Math.max(ic+$a,0);this.dXb?
0===$a?$a=[this.isRow?51:52]:(this.VYd=!0,$a=[this.isRow?49:50]):$a=[this.isRow?13:14];Wb.Gh.qt(new qa.Range(1,1,mb.a.fl,mb.a.Nk,!1,!0),$a,!1);if(this.vLa){rc=new Map;for(var Rc of xb)xb=Wb.sl(Rc),xb=this.isRow?new $b.a(xb.Vr.topLeft.x,this.offset,xb.QH.x,ic):new $b.a(this.offset,xb.Vr.topLeft.y,ic,xb.QH.y),rc.set(Rc,xb);Wb.Gh.Jw($a,null,null,!1,!0,rc)}else Rc=Wb.CPi(rc,this.isRow),Rc=this.isRow?new $b.a(0,this.offset,Rc,ic):new $b.a(this.offset,0,ic,Rc),Wb.Gh.Jw($a,Rc,xb);return ic}Dqc($a){this.a2=
this.WPa=this.Npb=null;if(this.Lca){const Wb=this.Lca.parentNode;if(Wb)for(Wb.removeChild(this.Lca);this.Lca.firstChild;)Wb.appendChild(this.Lca.firstChild);this.Lca=null}Rb.loa()?this.Zn&&(this.Zn=null,this.Y9f("clearResizeState::"+$a)):this.Zn=null;this.wre=!0;this.p9=!1}Lkk(){this.QIc=!1;this.rEg();this.w_f&&(this.fk.lkk(),this.w_f=!1);Vd.DOMElementExtensions.setVisible(Rb.yvb,!1);this.DYc(!1,"removeResizeArtifacts");this.Qtk()}ULd($a){if(Vd.DOMElementExtensions.QM($a.li,"a"))return null;const Wb=
this.M3f($a.La);if(Wb&&this.grid.ha.qa.Bn){var rc=this.grid.ha.qa.jj;rc=this.fk.qB(qa.Range.vi(rc.bottom,rc.right))}else rc=this.fk.vJa($a.li);if(!rc)return null;const xb=rc.fP(),ic=new Sys.UI.Bounds(xb.offsetLeft,xb.offsetTop,xb.offsetWidth,xb.offsetHeight);var Rc=Vd.DOMElementExtensions.getBoundingClientRect($a.li);Rc=new Sys.UI.Point($a.clientPoint.x-Rc.x,$a.clientPoint.y-Rc.y);this.isRow&&!Wb&&(Rc.y+=za.HelperMethods.uH($a.li,xb,this.rtl).y);return new Kc(xb,Rc,ic,rc.getRange(),Math.max(Rb.rGj,
Math.min(Rb.kFj,(this.isRow?ic.height:ic.width)*Rb.Fsk)),Wb,!this.isRow&&0<xb.getElementsByTagName("input").length)}Q_d($a,Wb){Wb=void 0===Wb?!1:Wb;if(!$a||this.grid.isEditing)return!1;if($a.L3f)return!0;var rc=$a.TMa;const xb=$a.xvb;var ic=this.fk.Iq.paneType,Rc=this.grid.sl(ic).Dp,Zc=!!Rc&&Rc.top===$a.hRd.top,Kd=!!Rc&&Rc.left===$a.hRd.left;ic=!!Rc&&Rc.bottom===$a.hRd.bottom&&(3===ic||2===ic);this.isRow?(Kd=$a.k_b.y,$a=Kd<=xb&&!Zc,rc=Kd>=rc.height-xb-(ic?Rb.iAi:0),Wb=Wb?$a:rc||$a):(ic=$a.P5i,Zc=
this.rtl,Rc=$a.k_b.x,$a=Rc<=xb&&(!Kd||Zc)&&(!ic||!Zc),rc=Rc>=rc.width-xb&&(!Zc||!Kd)&&(!ic||Zc),Wb=Wb?Zc?rc:$a:$a||rc);return Wb}BRh($a,Wb){const rc=this.isRow;if($a.L3f)this.Zn=this.fk.vJa($a.wKa);else if(rc&&$a.k_b.y<=$a.xvb&&$a.TMa.height>$a.xvb||!rc&&$a.TMa.width>$a.xvb&&(!this.rtl&&$a.k_b.x<=$a.xvb||this.rtl&&$a.k_b.x>=$a.TMa.width-$a.xvb)){if(this.Zn=$a.wKa.previousSibling?this.fk.vJa($a.wKa.previousSibling):this.POi(),Wb&&$a.wKa.classList.contains(rc?Yc.Pc:Yc.Ic)&&($a=this.fk.vJa($a.wKa)))$a=
$a.getRange(),this.a2=rc?new qa.Range($a.top-1,$a.left,$a.top-1,$a.right,!1,!0):new qa.Range($a.top,$a.left-1,$a.bottom,$a.left-1,!1,!0)}else this.Zn=this.fk.vJa($a.wKa);!this.a2&&this.Zn&&(this.a2=this.Zn.getRange())}POi(){var $a=this.isRow?1:0;return($a=this.fk.Iq.AL(this.fk.Iq.za.rn(this.grid.$.ma,Ad.a.rU(this.fk.position.X+$a-1,this.fk.position.Y-$a,this.fk.position.PaneType))))?$a.OOi():null}jVf(){this.QIc=!0;const $a=this.Gsk;Vd.DOMElementExtensions.setVisible($a,!0);$a.style.cursor=this.dXb?
this.isRow?"ns-resize":"ew-resize":this.isRow?Yc.lb:Yc.g;this.UZc()}pli($a){this.grid.$.ti(this.isRow?745189930:-445963340,ub.a.rh,30,{["resizeRowColumnParameters"]:$a})}H$h(){const $a=document.createElement("div");$a.className=Yc.pb;const Wb=document.createElement("div");Wb.className=yd.a.o4;$a.appendChild(Wb);const rc=document.createElement("img");rc.src=Id.a.An(0);rc.className=this.isRow?yd.a.opi:yd.a.npi;Wb.appendChild(rc);this.fk.GF.domElement.parentNode.insertBefore($a,this.fk.GF.domElement);
this.grid.fp?$a.addEventListener("pointerdown",this.IUj):(Dd.a.instance.xa(oc.a.qj,$a,this.mJ),Cb.a.instance.xa(oc.a.Nr,$a,this.R6));Vd.DOMElementExtensions.setVisible($a,!1);this.uW=$a}Y9f($a){Rb.loa()&&!this.Zn&&Da.ULS.sendTraceTag(508368661,2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${$a}`)}r4b(){this.grid.fp&&Rb.loa()&&!this.Zn||this.Dqc("removeResizer");this.zEg("removeResizer")}zEg($a){var Wb,rc,xb,ic;if(this.uW){const Rc=null===(xb=null===
(rc=null===(Wb=this.fk)||void 0===Wb?void 0:Wb.GF)||void 0===rc?void 0:rc.domElement)||void 0===xb?void 0:xb.parentNode;Rb.loa()&&Rc?Rc.removeChild(this.uW):this.fk.GF.domElement.parentNode.removeChild(this.uW);this.uW=null;Rb.loa()&&Da.ULS.sendTraceTag(508150751,2,50,`HeaderResizeBehavior.removeTouchResizer: Touch resized removed. Was called from caller:${$a}.isRow: ${this.isRow}, blockHash: ${null===(ic=this.fk)||void 0===ic?void 0:ic.hashCode}, is flowContainer define: ${!!Rc}`)}}M3f($a){return Vd.DOMElementExtensions.eo(this.uW,
$a.target)}sKb(){this.p9&&(this.grid.fp&&this.W9d(this.WPa),this.ztf(),this.grid.fp||Vd.DOMElementExtensions.GCa(this.Zn.fP(),!this.isRow,this.f6b),this.r4b(),this.nbc=this.Gda=!1)}NTf($a){($a=$a.La.rawEvent)&&$a.detail===Rb.dyk&&($a.type===oc.a.Py?(this.p9=!1,this.esd=!0):$a.type===oc.a.pS&&(this.p9=!0,this.esd=!1))}static E6h($a,Wb){return new Rb($a,Wb)}static Kpe($a,Wb,rc){if(Wb){$a.ColumnWidth=-1;$a.RowHeight=rc;for(const xb of $a.SheetMultiRange.Ranges)xb.FirstColumn=0,xb.LastColumn=0}else{$a.RowHeight=
-1;$a.ColumnWidth=rc;for(const xb of $a.SheetMultiRange.Ranges)xb.FirstRow=0,xb.LastRow=0}}static Tpj($a,Wb){if(!$a||!$a.fP())return Da.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const rc=$a.getRange();$a=$a.fP().style;if(!rc||!$a)return Da.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;$a=Wb?$a.height:$a.width;return(Wb?rc.top:rc.left)===(Wb?mb.a.fl:mb.a.Nk)&&$a===Rb.O$g}static H6h($a,Wb,rc){if(!$a)return Da.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),
null;var xb=$a.fP();if(!xb||!xb.style)return Da.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;$a=document.createElement("div");const ic=xb.style;$a.style.top=Wb?ic.top:Rb.O$g;Wb||(rc?$a.style.right=ic.right:$a.style.left=ic.left);$a.classList.add(Wb?zd.qpi:zd.ppi);$a.classList.add(Wb?Yc.Rc:Yc.Kc);rc=document.createElement("div");rc.classList.add(Wb?Yc.zc:Yc.xb);xb=Wb?Number.parseInvariant(xb.innerText):qa.Range.Ygb(xb.innerText);rc.innerText=Wb?(xb-1).toString():
qa.Range.nU(xb-1);$a.appendChild(rc);return $a}static loa(){return Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8257683_JSCrash_during_touch_resizeV2")}}Rb.rGj=0;Rb.kFj=5;Rb.GCc=1;Rb.GRf=1;Rb.m7i=0;Rb.iAi=3;Rb.Fsk=.1;Rb.yIg="ewa-rszrbg";Rb.O$g="0px";Rb.dyk=2;Rb.yvb=null;Object(da.a)(Rb,"HeaderResizeBehavior",ee.a,[262]);class dc extends Ec.a{constructor(){super();this.gm()}create(){this.Bk(Rb.E6h)}static Ba($a){$a.la.Hh(136,new dc)}}Object(da.a)(dc,"HeaderResizeBehaviorFactory",Ec.a,[]);uc.a.yw(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");
(()=>{hc.a.gh($a=>{dc.Ba($a)})})();String(Ia);String(Sa);window.___1710439927688_closurehack=Ia;window.___1710439927688_closurehack=Sa}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/640e366f0a7ed3748f13e610d7ae7657/EwaTS.rsz.js.map