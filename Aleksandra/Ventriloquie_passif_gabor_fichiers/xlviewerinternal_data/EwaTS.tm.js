'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1005:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{static moe(){}static NAd(){}}c.sendTraceTag=c.moe;c.debugAssertTag=c.NAd;Object(z.a)(c,"BULS",null,[])},1068:function(z,t,a){a.d(t,"a",function(){return r});z=a(0);var c=a(15);class b{}Object(z.a)(b,"ExtraInfo",null,[]);class h{}Object(z.a)(h,"PerfOperation",null,[]);class r{constructor(e,k){this.SN=this.ft=null;this.Ow=e;this.Er=k}get St(){return!!this.ft}get zi(){return this.ft?
(new Date).getTime()-this.ft.getTime():0}get id(){throw Error.notImplemented();}start(){this.ft=new Date;return this.SN=null}stop(){this.ft&&c.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{["Operation"]:this.Ow,["Target"]:this.Er,["StartTime"]:this.ft.toUTCString(),["DurationInMilliseconds"]:this.zi})}reset(){this.stop();this.SN=this.ft=null}Gm(e){return!e||""===e}}Object(z.a)(r,"Stopwatch",null,[94,35])},1092:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{}c.TCd="stid";
c.RCd="iid";c.SCd="DynamicImageProvider.aspx";c.Z1="RequestStartTime";c.isEwaJsSplitEnabled="IsEwaJsSplitEnabled";c.D1a="IsJsSelfProfilerOnBootEnabled";Object(z.a)(c,"WebServiceConstants",null,[])},1169:function(z,t,a){a.d(t,"a",function(){return n});z=a(0);var c=a(15);t=a(941);var b=a(598),h=a(6),r=a(17),e=a(124);class k{constructor(u,v,w,l){this.origin=u;this.data=v;this.source=w;this.La=void 0===l?null:l}}Object(z.a)(k,"MessageEventArgs",null,[]);class m{constructor(u,v){this.FUa=null;this.ide=
w=>this.Csa?this.Csa(new k(w.origin,w.data,w.source,w.La)):!1;this.imd=u;this.Fk=v;this.Csa=null}get gCa(){return this.imd.value}get nW(){return this.Fk.value}gJb(u,v){this.Csa=u;this.FUa=this.ide;this.gCa.addHandler(r.a.message,this.FUa,v)}ANb(){this.Csa=null;this.gCa.removeHandler(r.a.message,this.FUa)}inb(u,v){const w=new e.a(0,1,1,()=>{u(v)},7);this.nW.wm(w)}fUd(u,v){const w=new e.a(0,1,1,()=>{u(v)},7);this.nW.wm(w)}static get instance(){return m.rZa()}static rZa(){return new m(new b.a(()=>h.AFrameworkApplication.gCa),
new b.a(()=>h.AFrameworkApplication.Vp))}}Object(z.a)(m,"MessageEventHandler",null,[316]);var x=a(1005);class n extends t.a{constructor(u,v,w){super(u,v,(void 0===w?null:w)||m.instance,n.lTd)}static lTd(){x.a.sendTraceTag=n.loe;x.a.debugAssertTag=n.MAd}static loe(u,v,w,...l){c.ULS.sendTraceTag.apply(null,[u,204,n.Ozd(v),w].concat(l))}static MAd(){}static Ozd(u){switch(u){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}n.uSc="wdPreviousSession";
n.vtc="wdUserSession";Object(z.a)(n,"CommonCrossDocumentMessenger",t.a,[])},1175:function(z,t,a){a.r(t);a.d(t,"RenderingFidelityTracker",function(){return n});z=a(135);t=a(0);var c=a(15),b=a(107),h=a(78),r=a(13),e=a(428);class k extends e.a{constructor(u){super();this.$=u;this.gm()}create(){const {RenderingFidelityTracker:u}=a(1175);let v=this.$.la.lh(462);v||(v=this.$.la.Hh(462,new u));this.Bk(v)}}Object(t.a)(k,"RenderingFidelityTrackerFactory",e.a,[]);var m=a(45);e=a(5);var x=a(95);let n=class extends h.a{constructor(){super();
this.yGj=3E4;this.Kyb={};this.JBe={};this.baf={};b.Health.instance.addQosPillar("Fidelity")}static Ba(u){u.la.Hh(463,new k(u))}C6e(u,v,w,l){if(!(m.a.instance.vga(new Date)<this.yGj)){var y=r.HelperMethods.eN(()=>{var B=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(v),A=Object.keys(B),E=this.baf[u];for(var N=0;N<A.length;N++){var D=A[N];this.JBe[D]||(null===E||void 0===E?0:E[D])&&this.Kyb[D]&&(this.Kyb[D]-=E[D])}this.baf[u]=B;for(N=0;N<A.length;N++)if(E=A[N],!this.JBe[E])if(D=B[E],
this.Kyb[E]&&(D+=this.Kyb[E]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(E,D)){this.JBe[E]=!0;B=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(E);A=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(E);N=!("ThickBorder"===E||"MediumBorder"===E);B&&A&&N&&b.Health.instance.recordQosError(B,[A],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+E+", isHC:"+w+", scaleFactor:"+l+"}");break}else this.Kyb[E]=
D});1<y&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${y}`)}}};n=Object(z.__decorate)([Object(x.d)(e.rf)],n);Object(t.a)(n,"RenderingFidelityTracker",h.a,[561,2])},1221:function(z,t,a){a.d(t,"a",function(){return b});z=a(0);var c=a(15);class b{static oXa(h){h=new Date(h);return c.ULS.dif([b.Byh(h.getUTCFullYear()),"-",b.beb(h.getUTCMonth()+1),"-",b.beb(h.getUTCDate()),"T",b.beb(h.getUTCHours()),
":",b.beb(h.getUTCMinutes()),":",b.beb(h.getUTCSeconds()),".",b.E2e(h.getUTCMilliseconds()),"Z"])}static Byh(h){return 1E3>h?"0"+b.E2e(h):h.toString()}static E2e(h){return 100>h?"0"+b.beb(h):h.toString()}static beb(h){return 10>h?"0"+h:h.toString()}}Object(z.a)(b,"UlsUtils",null,[])},362:function(z,t,a){function c(Na){switch(!0){case Na.$F:return R.MergedCell;case Na.LR:return R.zbh;case Na.DC:return R.Formula;case Na.hasAutoFilter:return R.AutoFilter;case Na.vna:return R.PivotFilter;case !!Na.zRc:return R.PivotTable;
case Na.wxa:return R.Comment;case Na.nmb:return R.Sparkline;case Na.I_a:return R.InCellImage;case Na.hasRichText:return R.oeh;default:return""}}function b(Na){if(Ia.get(Na))return Ia.get(Na);var Pa=Na.replace(/-.*/g,()=>"");Pa=Ia.get(Pa);return null!==Pa&&void 0!==Pa?Pa:Na.startsWith("ooux")?"ooux":"other"}a.r(t);var h={};a.r(h);a.d(h,"DocumentVisibilityObserver",function(){return U});var r={};a.r(r);a.d(r,"GridActionTelemetryManager",function(){return J});var e={};a.r(e);a.d(e,"EwaHostMessenger",
function(){return ba});var k={};a.r(k);a.d(k,"InteractivityTrackerService",function(){return Ea});var m={};a.r(m);a.d(m,"PageLoadEngagementInfo",function(){return sa});var x={};a.r(x);a.d(x,"ServiceWorkerRegistrationManager",function(){return gb});var n={};a.r(n);a.d(n,"ValidationTelemetryManager",function(){return Gb});var u={};a.r(u);a.d(u,"VirtualGetRangeTelemetryManager",function(){return Ba});var v=a(135),w=a(0),l=a(94),y=a(40),B=a(131),A=a(32),E=a(159),N=a(5),D=a(95);let U=class extends y.a{constructor(){super();
this.IT=!1;this.EQe=this.DQe=null;this.r9d=()=>{this.l6g()};this.K$d=()=>{l.a.dh(this.F$);l.a.dh(this.au)};this.F$=E.a.instance.uXa();this.au=E.a.instance.tU();this.F$.Ba("visibilitychange",this.r9d);this.au.Ba("pagehide",this.K$d);this.l6g()}get un(){return this.IT}get B5f(){return this.DQe}get iKc(){return this.EQe}Q9(Na){this.addHandler("ekdh",Na)}w6a(Na){this.removeHandler("ekdh",Na)}R3(Na){this.addHandler("ekduh",Na)}yOa(Na){this.removeHandler("ekduh",Na)}PM(Na){return this.un?!0:this.iKc?B.getElapsedMilliseconds(this.iKc,
A.a.ih.si)<Na:!1}dispose(){l.a.dh(this.F$);l.a.dh(this.au);super.dispose()}l6g(){this.IT="hidden"===window.document.visibilityState;this.un?(this.raiseEvent("ekdh"),this.DQe=A.a.ih.si):(this.raiseEvent("ekduh"),this.EQe=A.a.ih.si)}};U=Object(v.__decorate)([Object(D.d)(N.Cb)],U);Object(w.a)(U,"DocumentVisibilityObserver",y.a,[236,2]);var K=a(15),M=a(1),O=a(23);const R={MergedCell:"MergedCell",zbh:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",
PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",oeh:"RichText"};let J=class{constructor(Na){this.ej=()=>{const Pa=JSON.stringify(this.fhf),Oc=JSON.stringify(this.ehf);K.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${Pa}}`);K.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${Oc}}`)};this.$=Na;this.fhf=[];this.ehf=[];M.EwaSettings.fWb()&&this.$.fq(this.ej)}dispose(){this.$=
null}c3e(Na,Pa){this.fhf.push({commandName:Pa,rowColCount:Na.toString()})}Fnd(Na,Pa){if(Na&&0!==Na.length){var Oc=[];const ge={};for(const Ae of Na)Ae.Hhj()&&(Na=c(Ae),""!==Na&&(ge[Na]=ge[Na]?ge[Na]+1:1));for(const Ae of Object.keys(ge))Oc.push({cellType:Ae,count:ge[Ae]});0!==Oc.length&&this.ehf.push({commandName:Pa,complexCellTypes:Oc})}}b2e(Na,Pa,Oc,ge,Ae){const Ye=O.f(this.$);var Bf=M.EwaSettings.w1a()?M.EwaSettings.qme():M.EwaSettings.Z4d(),Pf=Ye.za.qzc(1554436520===Ae||1051390410===Ae?Bf:0,674605324===
Ae||-706918724===Ae?Bf:0);Ae=[];Bf=!1;"UnhideColumn"!==Na&&"UnhideRow"!==Na&&"insertColumns"!==Na&&"insertRows"!==Na||(Bf=!0);for(const ng of Pf){{Pf=ng.yj;var mg=ge,Jf=Oc,$f=Pa,Yf=Bf;let eg=null;if(mg&&Pf||!M.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))Yf?Pf.Xi(mg)&&(eg=Pf,$f?eg.top=eg.bottom-Jf+1:eg.left=eg.right-Jf+1):Pf.Xi(mg)||(eg=Pf,$f?eg.bottom=eg.top+Jf-1:eg.right=eg.left+Jf-1);Pf=eg}Pf&&(Pf=Ye.za.bY(Pf))&&(Ae=[...Ae,...Pf])}this.Fnd(Ae,Na+"Cascade")}};
J=Object(v.__decorate)([Object(D.d)(N.Zc),Object(v.__param)(0,Object(N.Nb)())],J);Object(w.a)(J,"GridActionTelemetryManager",null,[563,2]);var aa=a(1169),S=a(6),C=a(42),L=a(113),V=a(144),X=a(394),la=a(235),Va=a(267),na=a(63),db=a(83),ja=a(28),ea=a(162),Z=a(941);Object(D.b)(N.nd,{Ek:"singleton"})(Na=>Lo(function*(){const Pa=yield D.a.resolve(N.Nb,Na),Oc=window.parent,ge=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?Pa.ua.DocumentHostInfo.PostMessageOrigin||Z.a.eU:S.AFrameworkApplication.RRc||
Z.a.eU,Ae=S.AFrameworkApplication.fa.ka("HostSendReadyToAcceptPostMessage");C.a.instance.register(ba,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").yi().Ei(()=>new ba(Pa,Oc,ge,Ae));return C.a.instance.resolve("Postmessage.IHostPostmessenger")}));class ba extends aa.a{constructor(Na,Pa,Oc){super(Pa,Oc);this.eh=new L.a;this.v8i=ge=>{if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Ae=ge.Values.m_Origin;S.AFrameworkApplication.wopiHostOriginFromPostMessage||
(S.AFrameworkApplication.wopiHostOriginFromPostMessage=Ae)}switch(ge.MessageId){case V.a.VRd:ea.a(this.$).DPf(ge);break;case V.a.q2d:Va.a.ltas(null);break;case V.a.hEc:this.NUj();break;case V.a.ZRd:this.MUj(ge)}};this.$=Na;Oc!==Z.a.eU&&this.x_(Oc);this.Xcj();this.bcj();Na=this.v8i;this.wq(V.a.VRd,Na);this.wq(V.a.q2d,Na);this.wq(V.a.hEc,Na);this.wq(V.a.ZRd,Na)}dispose(){this.$=null;super.dispose()}Xcj(){this.$r(V.a.Fcf);this.$r(V.a.VRd);this.$r(V.a.hEc);this.$r(V.a.ZRd);this.Zdb(V.a.q2d);this.$r(V.a.YRd)}bcj(){this.w_("App_EwrWorkbookNotSupportedCancelResponse");
this.w_(V.a.GFa);this.w_(V.a.S4);this.w_("App_CloseTab");this.w_(V.a.t$a);this.w_(V.a.u$a);this.w_(V.a.PSf);this.w_(V.a.dEc);this.w_("App_ModifyURLState")}NUj(){const Na={};Na.hostMessageReceived=(new Date).getTime();K.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");S.AFrameworkApplication.iJc=!0;Na.appUnloadStart=(new Date).getTime();Na.sendBeaconFlight=S.AFrameworkApplication.fa.ka("SendBeaconOnShuttingDownRequestsEnabled");Na.sendBeaconSupported=na.a.yqa();na.a.r7e();Na.appUnloadEnd=
(new Date).getTime();Na.appMessageSent=(new Date).getTime();this.sendMessage(V.a.MHh,Na)}MUj(Na){K.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Na.Values&&X.a.$6d in Na.Values&&ja.a.equals(Na.Values[X.a.$6d],la.a.edit,!0)&&!this.$.isEditMode&&(K.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${Na.Values[X.a.$6d]}`),Na=new db.a(-8805455,0,1,0,null),this.$.Ma.qh(Na))}}Object(w.a)(ba,"EwaHostMessenger",aa.a,[562,333,2]);var ya=a(17),Qa=a(45);
const va="context-menu floatie task-pane context-menu-auto-filter context-menu-auto-filter-items dialog".split(" "),Ia=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])},{name:"scroll_animation",actions:new Set(["viewport_scroll"])},{name:"zoom_animation",actions:new Set(["viewport_zoom"])},{name:"drag_animation",actions:new Set("drag_range_insert drag_range_replace drag_table_row_rearrange drag_table_column_rearrange drag_row_insert drag_row_replace drag_column_insert drag_column_replace drag_pivot_replace drag_pivot_row_rearrange drag_pivot_column_rearrange".split(" "))},{name:"async_ui",actions:new Set(va)},{name:"freeze_pane_drag_animation",
actions:new Set(["freeze_pane_header_drag_vertical","freeze_pane_header_drag_horizontal","freeze_pane_line_drag_vertical","freeze_pane_line_drag_horizontal"])}].forEach(Na=>{Na.actions.forEach(Pa=>{Ia.set(Pa,Na.name)})});class Sa{constructor(Na){this.$=Na}getAppState(){const Na=Qa.a.instance.vga(new Date);return-1===Na?"boot":3E4>Na?"postboot":"steady"}isChangeGateEnabled(Na){return M.EwaSettings.isChangeGateEnabled(Na)}getBooleanFeatureGate(Na,Pa){return M.EwaSettings.getBooleanFeatureGate(Na,Pa)}getCurrentAppInfo(){return{appState:this.getAppState(),
appInfoProperties:[{key:"coauthCount",value:this.$.ea.Ut.length.toString()}]}}sendBeaconTraceTag(Na,Pa,Oc,ge){this.$.sendBeaconTraceTag(Na,Pa,Oc,ge)}getActionBucket(Na){return b(Na)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.vFj}`}logSlowActionsHandler(){return""}logAsyncActionHandler(){return""}}Object(w.a)(Sa,"InteractivityTrackerCallbacks",null,[]);var Xa=a(916);const da=(Na,Pa)=>Lo(function*(){return Object(Xa.a)("interactivity",Pa)});Object(D.b)(N.Ed,{Ek:"singleton"})(Na=>
Lo(function*(){const Pa=yield D.a.resolve(N.Nb,Na);yield da(Pa,Na);const Oc=interactivity.InteractivityTrackerFactoryGlobal.create();return new Ea(Pa,Oc)}));class Ea{constructor(Na,Pa){this.sA=void 0===Pa?null:Pa;Ea.BHc?K.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(Na),Ea.BHc=!0)}initialize(Na){K.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");this.sA?(M.EwaSettings.h_d()&&
Ea.t0c.push(ya.a.Bua),Ea.t0c.push("mouseup"),Ea.t0c.push("touchstart"),Na={events:Ea.t0c,durationThresholdInMs:Ea.durationThresholdInMs,callbacks:new Sa(Na)},M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncUI",!1)&&(Na.asyncUiTracking={slowUiEventThresholdMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowUIEventThresholdMs",500),asyncUiEventTimeoutMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AsyncUIEventTimeoutMs",3E4),allowedAsyncUiNames:[...va],slowActionTimeoutOverrides:[]}),
Na.periodicReport={isPassiveTestEnabled:!1,intervalMs:6E4},M.EwaSettings.isChangeGateEnabled("OfficeVSO:8570179_TrackingScrollAnimation")&&(Na.animationTracking={chunkDurationMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationChunkDurationMs",100),minFramesPerChunk:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationMinFramesPerChunk",3),animationTimeoutMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.animationTimeoutMs",5E3)}),Na=
this.sA.start(Na),Na.started?K.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):K.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Na.failureReason)):K.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}SA(Na,Pa,Oc,ge){if(this.sA)return this.sA.trackInteraction(Na,Pa,Oc,ge);K.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Pa}`)}pmf(){return this.sA?
this.sA.createActionsRetriever():(K.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.sA&&(this.sA.stop(),this.sA=null)}addContext(Na,Pa,Oc){this.sA?this.sA.addContext(Na,Pa,Oc):K.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}startTrackAnimation(Na,Pa){return this.sA?Ea.BHc?this.sA.startTrackAnimation(Na,Pa):(K.ULS.sendTraceTag(507847813,
0,50,"InteractivityTrackerService.startTrackAnimation: trying startTrackAnimation but interactivityTrackerService instance was no created."),!1):(K.ULS.sendTraceTag(508343192,0,50,"InteractivityTrackerService.startTrackAnimation: interactivityTracker not initialized."),!1)}stopTrackAnimation(Na){this.sA?M.EwaSettings.isChangeGateEnabled("OfficeVSO:8500180_checkIfInteractivityServiceExistsBeforeStartTracking")&&!Ea.BHc?K.ULS.sendTraceTag(507847812,0,50,"InteractivityTrackerService.startTrackAnimation: trying stopTrackAnimation but interactivityTrackerService instance was no created."):
this.sA.stopTrackAnimation(Na):K.ULS.sendTraceTag(508343191,0,50,"InteractivityTrackerService.endTrackAnimation: interactivityTracker not initialized.")}}Ea.durationThresholdInMs=100;Ea.t0c="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");Ea.BHc=!1;Object(w.a)(Ea,"InteractivityTrackerService",null,[170]);var qa=a(2),za=a(154),ma=a(58),Da=a(54);class Ua{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(w.a)(Ua,"ActionData",
null,[]);class ka{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(w.a)(ka,"BlockedEngagementInfo",null,[]);class xa extends Ua{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(w.a)(xa,"SuccessfulActionData",Ua,[]);class Fb{constructor(){this.successfulActions=[]}}Object(w.a)(Fb,"SuccessfulEngagementInfo",null,[]);var bb=a(44),Ja=a(47),mb;let sa=mb=class{constructor(Na){this.VYa=new Set;this.C9b=null;this.vAf=this.pZg=!1;this.Esb=(Pa,Oc)=>{this.BJb.hasBlockedActions=
!0;Pa=this.BJb.blockedActions.length;const ge=Oc.details?Oc.actionName+"_"+Oc.details:Oc.actionName;Oc=Object(qa.a)(new Ua,{order:Pa+1,name:ge,componentName:Oc.componentName,timeFromNavigationStart:Oc.timeFromNavigationStart});this.BJb.blockedActions.push(Oc)};this.Hm=()=>{bb.a(this.$).L4b(this.Esb);this.Syj();this.C9b=ma.a.instance.create(()=>{this.iZb()},mb.hWk,Da.a.iZb)};this.ej=()=>{this.iZb()};this.Bfe=()=>{this.$.ti(2009315810,-1,0,null);this.bse=!1};this.BJb=new ka;this.BJb.hasBlockedActions=
!1;this.ayb=new Fb;this.zvi();this.$=Na;M.EwaSettings.vl()?this.$.ea.Yq(this.Hm):this.$.ea.jr(this.Hm);this.$.fq(this.ej);this.kWk=0;this.bse=!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.yjf=new Promise(Pa=>{this.b3h=Pa}));bb.a(this.$).smc(this.Esb)}dispose(){this.$.ea&&!M.EwaSettings.vl()&&this.$.ea.yv(this.Hm);this.$.Wu(this.ej);l.a.dh(this.C9b);this.$=this.C9b=null}agk(Na,Pa,Oc){if(void 0!==Na&&null!==Na&&Pa){var ge=this.ayb.successfulActions.length+
1,Ae="InputMethod"in Pa?Pa.InputMethod:"",Ye="IsCommand"in Pa&&Pa.IsCommand;if(this.Jsj(Na,Pa,Ae,Ye)){++this.kWk===mb.sal?(this.bse=!0,this.D5j=ma.a.instance.create(this.Bfe,5E3,Da.a.Bfe)):this.bse&&this.D5j.LA();if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const Bf=!Ye&&Na;this.vAf||Bf===za.a.C9g||Bf===za.a.D9g||Bf===za.a.x9g||Bf===za.a.y9g||(this.vAf=!0,this.b3h(void 0))}ge>mb.Tbg||(Na=Object(qa.a)(new xa,{order:ge,name:Na,componentName:"Location"in
Pa?Pa.Location:"",timeFromNavigationStart:Oc,inputMethod:Ae,isCommand:Ye}),this.ayb.successfulActions.push(Na),1===ge?this.Nzj():ge===mb.Tbg&&this.iZb())}}}Syj(){K.ULS.sendTraceTag(254546634,0,50,`${Ja.c(this.BJb)}`)}Nzj(){Qa.a.instance.vga(new Date)>mb.Ovi?K.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${Ja.c(this.ayb.successfulActions[0])}`):K.ULS.sendTraceTag(254563592,0,50,`${Ja.c(this.ayb.successfulActions[0])}`)}iZb(){!this.pZg&&this.ayb.successfulActions.length&&(this.pZg=
!0,l.a.dh(this.C9b),this.C9b=null,this.$.sendBeaconTraceTag(254559496,50,!1,Ja.c(this.ayb)))}zvi(){this.VYa.add(za.a.Zmd);this.VYa.add(za.a.Rne);this.VYa.add(za.a.Nde);this.VYa.add(za.a.Fwg);this.VYa.add(za.a.Hwg);this.VYa.add(za.a.Jwg)}Jsj(Na,Pa,Oc,ge){Oc=!Oc||"unknown"===Oc;const Ae="IsSystemInitiated"in Pa&&Pa.IsSystemInitiated;Pa="NoReporting"in Pa&&Pa.NoReporting;const Ye=this.VYa.has(Na);Na=ja.a.equals(Na,za.a.eXc,!0)&&Oc;return!Ae&&!Pa&&!Ye&&!Na&&!(ge&&Oc)}};sa.Tbg=10;sa.Ovi=6E4;sa.hWk=12E4;
sa.sal=25;sa=mb=Object(v.__decorate)([Object(D.d)(N.ve),Object(v.__param)(0,Object(N.Nb)())],sa);Object(w.a)(sa,"PageLoadEngagementInfo",null,[]);var oa=a(1175),cb=a(10),Ka=a(35),Oa;let gb=Oa=class{constructor(){this.s4i=()=>{const Na=this;return Lo(function*(){M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseServiceWorker",!1)?yield Na.register():yield Na.unregister()})};this.init().then(()=>{K.ULS.sendTraceTag(507654145,0,50,"ServiceWorkerRegistrationManager.init: Initialization complete")}).catch(Na=>
{K.ULS.sendTraceTag(507654144,0,15,`ServiceWorkerRegistrationManager.init: Initialization failed: ${Na}`)})}init(){const Na=this;return Lo(function*(){Ka.a.YNh&&navigator.serviceWorker.getRegistrations?(Qa.a.instance.Nm("ServiceWorkerSupported"),navigator.serviceWorker.controller&&Qa.a.instance.Nm("ServiceWorkerControlled"),yield Na.s4i(),Na.yMh()):Qa.a.instance.Nm("ServiceWorkerNotSupported")})}register(){return Lo(function*(){try{const Na=yield navigator.serviceWorker.register(`${cb.a.XAk}`);K.ULS.sendTraceTag(507795410,
0,15,`ServiceWorkerRegistrationManager.register: Registration succeeded. workerState = ${Na.active?"active":Na.waiting?"waiting":Na.installing?"installing":"none"}, scope = ${Na.scope}`)}catch(Na){K.ULS.sendTraceTag(507795409,0,15,`ServiceWorkerRegistrationManager.register: call to serviceWorker.register failed: ${Na}`)}})}unregister(){return Lo(function*(){try{const Na=yield navigator.serviceWorker.getRegistrations();for(const Pa of Na)(yield Pa.unregister())?K.ULS.sendTraceTag(507795408,0,15,"ServiceWorkerRegistrationManager.unregister: Unregistration succeeded"):
K.ULS.sendTraceTag(507795407,0,10,"ServiceWorkerRegistrationManager.unregister: Unregistration failed")}catch(Na){K.ULS.sendTraceTag(507795406,0,50,`ServiceWorkerRegistrationManager.unregister: call to serviceWorker.unregister failed: ${Na}`)}})}static I4i(Na){try{const Pa=Date.now(),Oc=JSON.parse(Na.data).serviceWorkerTime;K.ULS.sendTraceTag(507606657,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: delta between sending message from SW to processing message in main thread: ${Pa-
Oc}`)}catch(Pa){K.ULS.sendTraceTag(507606656,0,10,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: failed: ${Pa}`)}}static J4i(Na){M.EwaSettings.isChangeGateEnabled("OfficeVSO:8617694_HandleServiceWorkerHeartbeat")&&Na.data.includes("heartbeat")?Oa.I4i(Na):K.ULS.sendTraceTag(507795405,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerMessage: ${Na.data}`)}yMh(){navigator.serviceWorker.addEventListener("message",Oa.J4i)}};gb=Oa=Object(v.__decorate)([Object(D.d)(N.Ff)],
gb);Object(w.a)(gb,"ServiceWorkerRegistrationManager",null,[]);var bc=a(210),Dc=a(212),ad=a(103);class Ac{constructor(Na,Pa,Oc){this.vcl=Na;this.i5=Pa;this.name=Oc}}Object(w.a)(Ac,"Validation",null,[]);var mc;let Gb=mc=class{constructor(Na){this.Mrb=()=>{this.Dug(this.LAf)};this.vp=()=>{this.Dug(this.HMh)};this.$=Na;this.HMh=new bc.a;this.LAf=new bc.a;O.f(this.$).za.iy(this.vp);O.f(this.$).za.J3e(this.Mrb)}Pnd(Na,Pa,Oc,ge,Ae){if(Na&&ge){const Ye=Dc.a.bH(Pa,Oc);this.xlc(()=>!!ad.a(Na).Ox(Ye),ge.StateId,
Ae)}}xlc(Na,Pa,Oc){this.LAh(this.LAf,Na,Pa,Oc)}LAh(Na,Pa,Oc,ge){Na&&Pa&&Oc!==cb.a.Dk&&Na.add(new Ac(Pa,Oc,ge))}Dug(Na){if(Na){var Pa=new bc.a;for(const Oc of Na){if(Oc.i5===this.$.ea.yk)try{Oc.vcl()||K.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${Oc.name}]`)}catch(ge){K.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${Oc.name}]. Exception: [${ge}]`)}Pa.add(Oc)}for(const Oc of Pa)Na.remove(Oc)}else K.ULS.shipAssertTag(537151011,
0,!!Na,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){O.f(this.$)&&O.f(this.$).za&&(O.f(this.$).za.px(this.vp),O.f(this.$).za.zie(this.Mrb));this.$=null}static Ba(Na){const Pa=new mc(Na);Na.la.Hh(277,Pa)}};Gb=mc=Object(v.__decorate)([Object(D.d)(N.Ng),Object(v.__param)(0,Object(N.Nb)())],Gb);Object(w.a)(Gb,"ValidationTelemetryManager",null,[560,2]);let Ba=class{constructor(Na){this.u5a=void 0;this.Bbg=()=>{this.Y8g(!0)};this.Abg=()=>{this.Y8g(!1)};this.B1=
(Pa,Oc)=>{Oc.r8d!==cb.a.Dk&&(this.u5a=Oc.OJj===cb.a.Dk?this.$.ea.KC:Oc.r8d)};this.P_c=new Map;Na.ea.dK(this.B1);this.da=O.f(Na);this.$=Na}zbg(Na){this.P_c.set(this.$.ea.KC,Na);this.ryh()}Y8g(Na){if(void 0!==this.u5a&&this.P_c.has(this.u5a)){const Pa=this.P_c.get(this.u5a);this.QAj(Pa,this.u5a,Na);this.P_c.delete(this.u5a)}else this.PAj(this.u5a);this.gkk()}QAj(Na,Pa,Oc){K.ULS.sendTraceTag(507623310,1,20,`VirtualGetRangeTelemetryManager.logPrefetchResult. PrefetchResult is ${Oc} for the operation with the details OpName ${Na} and stateId ${Pa}`)}PAj(Na){K.ULS.sendTraceTag(507623309,
1,20,`VirtualGetRangeTelemetryManager.logPrefetchErrorForStateId. currentStateID ${Na} is not present in StateIdToOperationData`)}ryh(){this.da.aq.eFh(this.Bbg);this.da.aq.dFh(this.Abg)}gkk(){this.da.aq.Fok(this.Bbg);this.da.aq.Eok(this.Abg)}};Ba=Object(v.__decorate)([Object(D.d)(N.Tg),Object(v.__param)(0,Object(N.Nb)())],Ba);Object(w.a)(Ba,"VirtualGetRangeTelemetryManager",null,[559]);class Xb{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=
this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(w.a)(Xb,"BrowserInfo",
null,[]);class Ab{constructor(){this.Version=this.Name=null}}Object(w.a)(Ab,"PluginInfo",null,[]);class Db{static Zzj(){if(S.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var Na=Db.UAi();try{const Pa=JSON.stringify(Na);K.ULS.sendTraceTag(6903563,102,50,Pa)}catch(Pa){K.ULS.sendTraceTag(6903564,102,15,Pa.message)}}else K.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static FSi(){const Na=window.navigator.plugins;if(!Na||!Na.length)return null;const Pa=[];for(let Oc=
0;Oc<Na.length;Oc++){const ge=Na[Oc].name,Ae=Na[Oc].version;Array.add(Pa,Object.assign(new Ab,{Name:ge,Version:Ae}))}return Pa}static UAi(){const Na=new Xb,Pa=new Sys.StringBuilder;Db.yC(Oc=>{Na.DocElemClientHeight=Oc},()=>document.documentElement.clientHeight,Pa);Db.yC(Oc=>{Na.DocElemClientWidth=Oc},()=>document.documentElement.clientWidth,Pa);Db.yC(Oc=>{Na.DocElemOffsetHeight=Oc},()=>document.documentElement.offsetHeight,Pa);Db.yC(Oc=>{Na.DocElemOffsetWidth=Oc},()=>document.documentElement.offsetWidth,
Pa);Db.yC(Oc=>{Na.ScreenAvailHeight=Oc},()=>window.screen.availHeight,Pa);Db.yC(Oc=>{Na.ScreenAvailWidth=Oc},()=>window.screen.availWidth,Pa);Db.yC(Oc=>{Na.ScreenWidth=Oc},()=>window.screen.width,Pa);Db.yC(Oc=>{Na.ScreenHeight=Oc},()=>window.screen.height,Pa);Db.yC(Oc=>{Na.ScreenLogicalXdpi=Oc},()=>window.screen.logicalXDPI,Pa);Db.yC(Oc=>{Na.ScreenLogicalYdpi=Oc},()=>window.screen.logicalYDPI,Pa);Db.yC(Oc=>{Na.ScreenDeviceXdpi=Oc},()=>window.screen.deviceXDPI,Pa);Db.yC(Oc=>{Na.ScreenDeviceYdpi=Oc},
()=>window.screen.deviceYDPI,Pa);Db.yC(Oc=>{Na.WinInnerHeight=Oc},()=>window.self.innerHeight,Pa);Db.yC(Oc=>{Na.WinInnerWidth=Oc},()=>window.self.innerWidth,Pa);Db.yC(Oc=>{Na.WinOuterHeight=Oc},()=>window.self.outerHeight,Pa);Db.yC(Oc=>{Na.WinOuterWidth=Oc},()=>window.self.outerWidth,Pa);Db.yC(Oc=>{Na.WinOrientation=Oc},()=>window.self.orientation,Pa);Db.yC(Oc=>{Na.WinDevicePixelRatio=Oc},()=>window.self.devicePixelRatio,Pa);Db.yC(Oc=>{Na.SupportsTouch=Oc},()=>Ka.a.w0c,Pa);Db.yC(Oc=>{Na.NavAppName=
Oc},()=>window.navigator.appName,Pa);Db.yC(Oc=>{Na.NavAppVersion=Oc},()=>window.navigator.appVersion,Pa);Db.yC(Oc=>{Na.NavLanguage=Oc},()=>window.navigator.browserLanguage||window.navigator.language,Pa);Db.yC(Oc=>{Na.NavUserAgent=Oc},()=>window.navigator.userAgent,Pa);Db.yC(Oc=>{Na.NavPlatform=Oc},()=>window.navigator.platform,Pa);S.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipLoggingPluginsEnabled",!1)||Db.yC(Oc=>{Na.NavPlugins=Oc},Db.FSi,Pa);Db.yC(Oc=>{Na.CalculatedDevicePixelRatio=
Oc},()=>Db.devicePixelRatio,Pa);Na.Error=Pa.toString();return Na}static get devicePixelRatio(){const Na=window.devicePixelRatio;return isNaN(Na)?window.screen.deviceXDPI/window.screen.logicalXDPI:Na}static yC(Na,Pa,Oc){try{const ge=Pa();Na(ge)}catch(ge){Oc.isEmpty()||Oc.append(" | "),Oc.append(ge.message||"null")}}}Object(w.a)(Db,"BrowserInfoLogger",null,[]);var xc=a(282);class vc{get name(){return"Common.App.BrowserInfoLogger"}$n(){}init(){Db.Zzj()}dispose(){}static main(){xc.a.instance.Do(new vc)}}
Object(w.a)(vc,"BrowserInfoLoggerPackage",null,[12,13]);var zb=a(79);class tb{constructor(Na){this.i7c=Na}FYf(Na){if(!this.i7c)return!0;Na=zb.a.WLd(Na);if(!Na)return!1;Na=Na.toLowerCase();for(let Pa=0;Pa<this.i7c.length;Pa++)if(Na.endsWith(this.i7c[Pa]))return!0;return!1}}Object(w.a)(tb,"DomainAllowListManager",null,[]);class ab{constructor(Na,Pa){this.I4=null;this.nld=Na;this.url=Pa}get MAe(){return zb.a.fca(this.url)}get Qz(){return this.nld}pxe(){const Na={},Pa=this.Qz;Na.a=this.MAe;Na.b=this.round(Pa.navigationStart);
Na.c=this.round(Pa.unloadEventStart);Na.d=this.round(Pa.unloadEventEnd);Na.e=this.round(Pa.redirectStart);Na.f=this.round(Pa.redirectEnd);Na.g=this.round(Pa.fetchStart);Na.h=this.round(Pa.domainLookupStart);Na.i=this.round(Pa.domainLookupEnd);Na.j=this.round(Pa.connectStart);Na.k=this.round(Pa.connectEnd);Na.l=void 0!==Pa.secureConnectionStart&&null!==Pa.secureConnectionStart?this.round(Pa.secureConnectionStart):0;Na.m=this.round(Pa.requestStart);Na.n=this.round(Pa.responseStart);Na.o=this.round(Pa.responseEnd);
Na.q=this.round(Pa.domInteractive);Na.r=this.round(Pa.domContentLoadedEventStart);Na.s=this.round(Pa.domContentLoadedEventEnd);Na.t=this.round(Pa.domComplete);Na.u=this.round(Pa.loadEventStart);Na.v=this.round(Pa.loadEventEnd);Na.w=this.I4;return Na}round(Na){return Math.round(1E3*Na)/1E3}}Object(w.a)(ab,"PerformanceTimingEntry",null,[]);const La=(Na,Pa)=>{var Oc,ge;const Ae={};let Ye=null;switch(Na){case 0:Ye="ResourceTiming";Na=Pa.a;null!=Na&&(Ae.Url=Na);Na=Pa.b;null!=Na&&(Ae.InitiatorType=Na);
Na=null==Pa.c?null:Pa.c.toString();null!=Na&&(Ae.RedirectStart=Na);Na=null==Pa.d?null:Pa.d.toString();null!=Na&&(Ae.RedirectEnd=Na);Na=null==Pa.e?null:Pa.e.toString();null!=Na&&(Ae.FetchStart=Na);Na=null==Pa.f?null:Pa.f.toString();null!=Na&&(Ae.DomainLookupStart=Na);Na=null==Pa.g?null:Pa.g.toString();null!=Na&&(Ae.DomainLookupEnd=Na);Na=null==Pa.h?null:Pa.h.toString();null!=Na&&(Ae.ConnectStart=Na);Na=null==Pa.i?null:Pa.i.toString();null!=Na&&(Ae.ConnectEnd=Na);Na=null==Pa.j?null:Pa.j.toString();
null!=Na&&(Ae.SecureConnectionStart=Na);Na=null==Pa.k?null:Pa.k.toString();null!=Na&&(Ae.RequestStart=Na);Na=null==Pa.l?null:Pa.l.toString();null!=Na&&(Ae.ResponseStart=Na);Na=null==Pa.m?null:Pa.m.toString();null!=Na&&(Ae.ResponseEnd=Na);Na=Pa.n;null!=Na&&(Ae.CustomText=Na);Na=null==Pa.o?null:Pa.o.toString();null!=Na&&(Ae.DecodedBodySize=Na);Na=null==Pa.p?null:Pa.p.toString();null!=Na&&(Ae.EncodedBodySize=Na);Na=null==Pa.q?null:Pa.q.toString();null!=Na&&(Ae.TransferSize=Na);Pa=null!==(ge=null===(Oc=
Pa.r)||void 0===Oc?void 0:Oc.toString())&&void 0!==ge?ge:null;null!=Pa&&(Ae.responseStatus=Pa);break;case 1:Ye="PerformanceTiming",Oc=Pa.a,null!=Oc&&(Ae.Url=Oc),Oc=null==Pa.b?null:Pa.b.toString(),null!=Oc&&(Ae.NavigationStart=Oc),Oc=null==Pa.c?null:Pa.c.toString(),null!=Oc&&(Ae.UnloadEventStart=Oc),Oc=null==Pa.d?null:Pa.d.toString(),null!=Oc&&(Ae.UnloadEventEnd=Oc),Oc=null==Pa.e?null:Pa.e.toString(),null!=Oc&&(Ae.RedirectStart=Oc),Oc=null==Pa.f?null:Pa.f.toString(),null!=Oc&&(Ae.RedirectEnd=Oc),Oc=
null==Pa.g?null:Pa.g.toString(),null!=Oc&&(Ae.FetchStart=Oc),Oc=null==Pa.h?null:Pa.h.toString(),null!=Oc&&(Ae.DomainLookupStart=Oc),Oc=null==Pa.i?null:Pa.i.toString(),null!=Oc&&(Ae.DomainLookupEnd=Oc),Oc=null==Pa.j?null:Pa.j.toString(),null!=Oc&&(Ae.ConnectStart=Oc),Oc=null==Pa.k?null:Pa.k.toString(),null!=Oc&&(Ae.ConnectEnd=Oc),Oc=null==Pa.l?null:Pa.l.toString(),null!=Oc&&(Ae.SecureConnectionStart=Oc),Oc=null==Pa.m?null:Pa.m.toString(),null!=Oc&&(Ae.RequestStart=Oc),Oc=null==Pa.n?null:Pa.n.toString(),
null!=Oc&&(Ae.ResponseStart=Oc),Oc=null==Pa.o?null:Pa.o.toString(),null!=Oc&&(Ae.ResponseEnd=Oc),Oc=null==Pa.p?null:Pa.p.toString(),null!=Oc&&(Ae.DomLoading=Oc),Oc=null==Pa.q?null:Pa.q.toString(),null!=Oc&&(Ae.DomInteractive=Oc),Oc=null==Pa.r?null:Pa.r.toString(),null!=Oc&&(Ae.DomContentLoadedEventStart=Oc),Oc=null==Pa.s?null:Pa.s.toString(),null!=Oc&&(Ae.DomContentLoadedEventEnd=Oc),Oc=null==Pa.t?null:Pa.t.toString(),null!=Oc&&(Ae.DomComplete=Oc),Oc=null==Pa.u?null:Pa.u.toString(),null!=Oc&&(Ae.LoadEventStart=
Oc),Oc=null==Pa.v?null:Pa.v.toString(),null!=Oc&&(Ae.LoadEventEnd=Oc),Pa=Pa.w,null!=Pa&&(Ae.CustomText=Pa)}Ae.Table=Ye;return Sys.Serialization.JavaScriptSerializer.serialize(Ae)};var pb=a(56),ia=a(173),kb=a(489);class fb{constructor(Na,Pa,Oc){this.sI=Na;this.LAe=this;this.Zlh=(void 0===Pa?null:Pa)||(()=>window.location.href);this.q$c=new tb(void 0===Oc?null:Oc)}run(){if(fb.i4(window.performance))try{const Ae=this.Zlh();if(fb.Ouh.exec(Ae)&&this.q$c.FYf(Ae)){var Na=new ab(window.performance.timing,
Ae);kb.a.instance.vfk(Na.Qz.fetchStart);kb.a.instance.wfk(Na.Qz.navigationStart);kb.a.instance.WZb(pb.a.Qzi,"connectStart","requestStart");kb.a.instance.WZb(pb.a.Yzi,"requestStart","responseStart");kb.a.instance.WZb(pb.a.aAi,"responseStart","responseEnd");this.LAe.Ll(1,Na.pxe());this.sI.Zq(pb.a.bJa,Na.Qz.fetchStart);this.sI.Zq(pb.a.Vzi,Na.Qz.domainLookupStart);this.sI.Zq(pb.a.Uzi,Na.Qz.domainLookupEnd);this.sI.Zq(pb.a.Szi,Na.Qz.connectStart);this.sI.Zq(pb.a.bAi,Na.Qz.secureConnectionStart);this.sI.Zq(pb.a.Rzi,
Na.Qz.connectEnd);this.sI.Zq(pb.a.Zzi,Na.Qz.requestStart);this.sI.Zq(pb.a.sQb,Na.Qz.responseStart);this.sI.Zq(pb.a.Wzi,Na.Qz.responseEnd-Na.Qz.responseStart);this.sI.Zq(pb.a.$zi,Na.Qz.responseStart-Na.Qz.requestStart);var Pa=0,Oc=0,ge=0;(()=>{let Ye=this.j3k(Ae);({transferSize:Pa,DDd:Oc,RAd:ge}=Ye);return Ye})().returnValue&&(this.sI.Zq(pb.a.cAi,Pa),this.sI.Zq(pb.a.Tzi,ge),this.sI.Zq(pb.a.Xzi,Oc));this.sI.Zq(pb.a.yId,Na.Qz.navigationStart)}}catch(Ae){K.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",
Ae)}}j3k(Na){let Pa,Oc,ge;ge=Oc=Pa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Pa,DDd:Oc,RAd:ge};Na=window.performance.getEntriesByName(Na,"navigation");if(void 0===Na||null===Na||1!==Na.length)return{returnValue:!1,transferSize:Pa,DDd:Oc,RAd:ge};Na=Na[0];var Ae=Na.transferSize;void 0!==Pa&&null!==Pa&&(Pa=Ae);Ae=Na.decodedBodySize;void 0!==Ae&&null!==Ae&&(ge=Ae);Na=Na.encodedBodySize;void 0!==Na&&null!==Na&&(Oc=
Na);return{returnValue:!0,transferSize:Pa,DDd:Oc,RAd:ge}}Ll(Na,Pa){K.ULS.sendTraceTag(4551815,306,50,La(Na,Pa))}static get instance(){return fb.Va||(fb.Va=new fb(ia.a.instance,null,S.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?S.AFrameworkApplication.fa.pA("ResourceLoggerDomainAllowList"):null))}static i4(Na){return!(void 0===Na||null===Na)&&!(void 0===Na.timing||null===Na.timing)}}fb.Va=null;fb.Ouh=RegExp("^https?://.*","i");Object(w.a)(fb,"PerformanceTimingLogger",null,
[596]);var hb=a(153);class Jb{constructor(Na,Pa){this.I4=null;this.nld=Na;this.behavior=Pa;this.url=this.Qz.name}get MAe(){return 2===this.behavior?this.url:zb.a.fca(this.url)}get Qz(){return this.nld}pxe(){const Na={},Pa=this.Qz;Na.a=this.MAe;Na.b=Pa.initiatorType;Na.c=this.round(Pa.redirectStart);Na.d=this.round(Pa.redirectEnd);Na.e=this.round(Pa.fetchStart);Na.f=this.round(Pa.domainLookupStart);Na.g=this.round(Pa.domainLookupEnd);Na.h=this.round(Pa.connectStart);Na.i=this.round(Pa.connectEnd);
Na.j=void 0!==Pa.secureConnectionStart&&null!==Pa.secureConnectionStart?this.round(Pa.secureConnectionStart):0;Na.k=this.round(Pa.requestStart);Na.l=this.round(Pa.responseStart);Na.m=this.round(Pa.responseEnd);Na.o=this.round(Jb.cxa(Pa,"decodedBodySize"));Na.p=this.round(Jb.cxa(Pa,"encodedBodySize"));Na.q=this.round(Jb.cxa(Pa,"transferSize"));Na.n=this.I4;Na.r=Jb.cxa(Pa,"responseStatus")||0;return Na}round(Na){return Math.round(1E3*Na)/1E3}static cxa(Na,Pa){return Na[Pa]}}Object(w.a)(Jb,"ResourceTimingEntry",
null,[610]);var ub=a(107),nb=a(202),Aa=a(92);class ra{constructor(Na,Pa,Oc){this.TYe=!1;this.dHe=Na;this.Jjc=void 0===Pa?null:Pa;this.iDa={};this.Bih=void 0===Oc?100:Oc;this.RGe=S.AFrameworkApplication&&S.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)}w2k(Na){var Pa=Na.name.toLowerCase();const Oc=zb.a.pga(Pa);this.GIg(Oc,Pa)&&(Oc in this.iDa?K.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
Oc):(Pa={},Pa.starttime=Na.startTime,Pa.workerstart=Na.workerStart,Pa.redirectstart=Na.redirectStart,Pa.redirectend=Na.redirectEnd,Pa.fetchstart=Na.fetchStart,Pa.domainlookupstart=Na.domainLookupStart,Pa.domainlookupend=Na.domainLookupEnd,Pa.connectstart=Na.connectStart,Pa.secureconnectionstart=Na.secureConnectionStart,Pa.connectend=Na.connectEnd,Pa.requeststart=Na.requestStart,Pa.responsestart=Na.responseStart,Pa.responseend=Na.responseEnd,Pa.iscached=this.F3f(Na),Pa.nexthopprotocol=Na.nextHopProtocol,
Pa.encodedsize=Jb.cxa(Na,"encodedBodySize"),Pa.decodedsize=Jb.cxa(Na,"decodedBodySize"),this.iDa[Oc]=Pa))}x2k(Na){var Pa=Na.name.toLowerCase();const Oc=zb.a.pga(Pa);this.Zsk(Oc,Pa)&&(Oc in this.iDa?K.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",Oc):(Pa={},Pa.starttime=Na.startTime,Pa.workerstart=Na.workerStart,Pa.redirectstart=Na.redirectStart,Pa.redirectend=Na.redirectEnd,Pa.fetchstart=Na.fetchStart,Pa.domainlookupstart=Na.domainLookupStart,
Pa.domainlookupend=Na.domainLookupEnd,Pa.connectstart=Na.connectStart,Pa.secureconnectionstart=Na.secureConnectionStart,Pa.connectend=Na.connectEnd,Pa.requeststart=Na.requestStart,Pa.responsestart=Na.responseStart,Pa.responseend=Na.responseEnd,Pa.iscached=this.F3f(Na),Pa.nexthopprotocol=Na.nextHopProtocol,Pa.encodedsize=Jb.cxa(Na,"encodedBodySize"),Pa.decodedsize=Jb.cxa(Na,"decodedBodySize"),Pa.it=Na.initiatorType,Pa.ress=Na.responseStart,Pa.cs=Na.connectStart,Pa.ce=Na.connectEnd,Pa.dls=Na.domainLookupStart,
Pa.dle=Na.domainLookupEnd,Pa.rs=Na.redirectStart,Pa.re=Na.redirectEnd,Pa.reqs=Na.requestStart,Pa.scs=Na.secureConnectionStart,this.iDa[Oc]=Pa))}GIg(Na,Pa){if(this.dHe)return Array.contains(this.dHe,Na);if(this.Jjc)for(Na=zb.a.OU(Pa),Pa=0;Pa<this.Jjc.length;Pa++)if(this.Jjc[Pa]&&Na.endsWith(this.Jjc[Pa]))return!0;return!1}Zsk(Na,Pa){return this.GIg(Na,Pa)?Na.endsWith(".js")||Na.endsWith(".css"):!1}F3f(Na){try{const Pa=Jb.cxa(Na,"transferSize");if(void 0!==Pa&&null!==Pa)return!Pa;K.ULS.sendTraceTag(51652510,
306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return Na.responseEnd-Na.fetchStart<this.Bih}catch(Pa){K.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Pa.message)}return!1}Zfk(){if(Aa.a.Gm(this.iDa))K.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else if(S.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StaticResourceMetricsForKpiLogOnlyOnce",
!1)&&this.TYe)K.ULS.sendTraceTag(507581086,306,15,"Static Resource Metrics already logged in KPI");else{var Na=S.AFrameworkApplication.flightId?S.AFrameworkApplication.flightId.split(";"):[],Pa=Object.assign({},{extendedProperties:nb.a.sy()});Pa.extendedProperties.set("Flights",Ja.c(Na));this.hAj(Pa,this.iDa,ub.Health.instance);this.TYe=!0}}EJd(Na){var Pa,Oc;let ge=0,Ae=0,Ye=0,Bf=0,Pf=0;const mg=this.iDa;for(const Yf in mg){var Jf=Yf,$f=mg[Yf];Jf.endsWith(".js")&&($f=Object(hb.a)(Object,$f),$f.responseend<
Na&&(ge+=1,Ae+=$f.decodedsize,Bf+=$f.encodedsize,Ye+=$f.iscached?0:$f.encodedsize,Jf=Jf.toLowerCase(),this.RGe&&((null===(Oc=null===(Pa=S.AFrameworkApplication.fa)||void 0===Pa?void 0:Pa.Za("Slice1Name"))||void 0===Oc?0:Oc.toLowerCase().endsWith(Jf))?Pf|=1:Jf.endsWith(".common.js")||Jf.endsWith(".othercommon.js")||Jf.endsWith(".ext.js")?Pf|=2:Jf.endsWith("common50.min.js")&&(Pf|=4))))}Na={};Na.filesLoaded=ge;Na.decodedBytes=Ae;Na.transferredBytes=Ye;Na.encodedBytes=Bf;this.RGe&&(Na.lazyChunksLoaded=
Pf);return Na}hAj(Na,Pa,Oc){if(Pa){var ge=0,Ae=0,Ye=0,Bf=0,Pf=0,mg=0,Jf=0,$f=0,Yf=0,ng=0,eg=0;for(const Ug in Pa){var Ig=Pa[Ug];try{const Cg=Object(hb.a)(Object,Ig);if(!Cg)continue;const eh=Cg.iscached?Boolean.parse(Cg.iscached.toString()):!1,Fh=Cg.fetchstart?this.parseFloat(Cg.fetchstart.toString()):0,bh=(Cg.responseend?this.parseFloat(Cg.responseend.toString()):0)-Fh,Rg=Cg.encodedsize?this.parseFloat(Cg.encodedsize.toString()):0,Vg=Cg.decodedsize?this.parseFloat(Cg.decodedsize.toString()):0;ge+=
bh;Bf+=Rg;Jf+=Vg;ng++;eh?(Ye+=bh,mg+=Rg,Yf+=Vg,eg++):(Ae+=bh,Pf+=Rg,$f+=Vg)}catch(Cg){K.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Cg.message)}}Na.extendedProperties.set("StaticResources",Ja.c(Pa));Na.extendedProperties.set("TotalResourceDownloadLatency",ge.toString());Na.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Ae.toString());Na.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Ye.toString());Na.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
Bf.toString());Na.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Pf.toString());Na.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",mg.toString());Na.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Jf.toString());Na.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",$f.toString());Na.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Yf.toString());Na.extendedProperties.set("TotalNumberOfResourcesDownloaded",
ng.toString());Na.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",eg.toString());Oc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);Oc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Na)}}parseFloat(Na){if(!Na)return 0;Na=parseFloat(Na);return isNaN(Na)?0:Na}}Object(w.a)(ra,"AppStaticResourceManager",null,[]);class vb extends Sys.EventArgs{constructor(Na){super();this.entries=Na}}Object(w.a)(vb,"EntriesAvailableEventArgs",
Sys.EventArgs,[]);var rb=a(124);class Nb{constructor(Na,Pa,Oc,ge,Ae,Ye){Oc=void 0===Oc?null:Oc;ge=void 0===ge?null:ge;Ae=void 0===Ae?100:Ae;Ye=void 0===Ye?!1:Ye;this.Pdd=!1;this.zq=null;this.zBb=0;this.hh=new L.a;this.GRa=null;this.UJ=!1;this.WZe=0;this.Fk=Na;this.YJe=0;this.LAe=this;this.q$c=new tb(Oc);this.oE=Pa;ge&&(this.GRa=new ra(null,ge,Ae));this.ehh=Ye}get Oaf(){try{return!(void 0===this.oE||null===this.oE)&&!(void 0===this.oE.getEntriesByType||null===this.oE.getEntriesByType)}catch(Na){return K.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Na),!1}}get Sbi(){return this.YJe}get isActive(){return this.UJ}get dxe(){return this.WZe}eCh(Na){this.hh.addHandler(Nb.cEd,Na)}Zlk(Na){this.hh.removeHandler(Nb.cEd,Na)}$n(Na,Pa){const Oc=this.dxe!==Na;this.WZe=Na;this.isActive&&this.Fk&&Oc&&(this.Kx(),this.wm());this.YJe=Pa}activate(){!this.isActive&&this.Oaf&&(this.wm(),this.UJ=!0)}deactivate(Na){this.isActive&&(this.Kx(),Na&&this.flush(),this.UJ=!1)}flush(){if(this.isActive&&
this.Oaf)try{var Na=window.performance.getEntriesByType("resource");0<Na.length-this.zBb&&K.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Na.length-this.zBb);const Pa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Pa&&(window.performance.clearResourceTimings(),this.zBb=0);const Oc=[];for(let ge=this.zBb;ge<Na.length;ge++)this.q$c.FYf(Na[ge].name)&&(this.GRa&&(this.ehh?
this.GRa.x2k(Na[ge]):this.GRa.w2k(Na[ge])),Oc.push(new Jb(Na[ge],this.Sbi)));Pa||(this.zBb=Na.length);this.hh.raiseEvent(Nb.cEd,new vb(Oc));for(Na=0;Na<Oc.length;Na++)0!==Oc[Na].behavior&&2!==Oc[Na].behavior||this.LAe.Ll(0,Oc[Na].pxe());0<Oc.length&&K.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",Oc.length)}catch(Pa){K.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Pa)}}Ll(Na,Pa){K.ULS.sendTraceTag(4310804,
306,50,La(Na,Pa))}ufk(){this.GRa.Zfk()}EJd(Na){return this.GRa.EJd(Na)}wm(){this.Fk&&0<this.dxe&&(this.zq=new rb.a(3,2,1E3*this.dxe,()=>{this.flush()},5),this.Fk.wm(this.zq),this.Pdd=!0)}Kx(){this.Pdd&&(this.Fk.Kx(this.zq),this.zq=null,this.Pdd=!1)}}Nb.cEd="EntriesAvailable";Object(w.a)(Nb,"ResourceTimingLogger",null,[583,596]);var Qc=a(138);class jd{constructor(){this.Vh=null}get name(){return"Common.ResourceTiming"}init(){C.a.instance.resolve("Common.NetworkTiming.IResourceTimingLogger");fb.instance.run()}dispose(){}$n(Na){this.Vh=
Na;let Pa=null;if(S.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{Pa=S.AFrameworkApplication.fa.pA("ResourceLoggerDomainAllowList")}catch(Ye){K.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const Oc=[];Oc.push(zb.a.OU(Qc.a.lW).toLowerCase());Oc.push(zb.a.OU(Qc.a.Ywb).toLowerCase());const ge=S.AFrameworkApplication.fa.Lj("AppStaticResourceMonitorCacheThresholdInMs",100),Ae=S.AFrameworkApplication.fa.ka("PPTAggregateResourceTimingV2Enabled");
Na.register(583,"Common.NetworkTiming.IResourceTimingLogger").yi().Ei(()=>new Nb(S.AFrameworkApplication.Vp,window.performance,Pa,Oc,ge,Ae))}static main(){xc.a.instance.Do(new jd)}}Object(w.a)(jd,"ResourceTimingPackage",null,[12,13]);var xd=a(142);class ae extends Sys.EventArgs{constructor(Na,Pa){super();this.JYk=Na;this.actualValue=Pa}}Object(w.a)(ae,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var Sd=a(102);class fc{constructor(){this.oab=[];this.yJe=this.I9c=0;this.Qra=null;this.hh=
new L.a;this.F3h=(Na,Pa)=>{Sd.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.H5h(Pa.JYk,Pa.actualValue))}}init(Na,Pa,Oc){this.Qra=Na;this.I9c=Pa;this.yJe=Oc;this.Qra.F4e(Object(xd.a)(this,this.SPj,"onCpuMeterFrameAvailable"));this.yDh(this.F3h)}SPj(Na,Pa){Pa.Geg&&(Array.enqueue(this.oab,Pa.Geg.CP),this.oab.length>this.yJe&&(Array.dequeue(this.oab),this.XVh()))}XVh(){var Na=this.oab.length;let Pa=0;for(let Oc=0;Oc<Na;Oc++){const ge=Array.dequeue(this.oab);Pa+=ge;Array.enqueue(this.oab,
ge)}Na=Pa/Na;Na>this.I9c&&this.hh.raiseEvent("CPTTE",new ae(this.I9c,Na))}yDh(Na){this.hh.addHandler("CPTTE",Na)}H5h(Na,Pa){const Oc={};Oc.ThresholdValue=Na;Oc.ActualValue=Pa;return Oc}}Object(w.a)(fc,"CpuMeterMonitor",null,[598]);var uc=a(183);class hc{constructor(){this.S=this.T=this.M=this.C=0}}Object(w.a)(hc,"ProfileInformation",null,[]);var Ec=a(53),yd=a(292);class Ad{constructor(Na,Pa){this.fcd=!1;this.NSa={};this.Ogc=void 0===Na?0:Na;this.Xgc=void 0===Pa?0:Pa;this.Dld=0;Ec.a.addHandler(window.self,
ya.a.sGh,()=>{this.fcd=!0});Ec.a.addHandler(window.self,ya.a.tGh,()=>{this.fcd=!1})}a6e(Na,Pa,Oc){const ge=Ad.generateKey(Pa,Oc);ge in this.NSa?Pa=this.NSa[ge]:(Pa=new hc,Pa.S=Oc?1:0,this.NSa[ge]=Pa,this.Dld++);Pa.C++;Pa.M=Na>Pa.M?Na:Pa.M;Pa.T+=Na}lla(Na,Pa){this.a6e(Na,Pa,!1);this.fcd&&this.a6e(Na,Pa,!0)}getData(){if(0<this.Xgc&&this.Dld>this.Xgc)return this.FIi();const Na=0<this.Ogc,Pa={},Oc=this.NSa;for(const Ae in Oc){var ge=Ae;const Ye=Oc[Ae];this.RJg(Ye);Na&&Ye.T>=this.Ogc&&(Pa[ge]=Ye)}return Na?
Aa.a.Gm(Pa)?null:Pa:this.NSa}FIi(){var Na=0<this.Ogc,Pa=[];const Oc=this.NSa;for(const ge in Oc){const Ae={key:ge,value:Oc[ge]},Ye=Ae.value;(!Na||Ye.T>=this.Ogc)&&Array.add(Pa,Ae)}if(Pa.length>this.Xgc)Pa.sort((ge,Ae)=>Ae.value.T-ge.value.T),Pa=Pa.slice(0,this.Xgc);else if(!Pa.length)return null;Na={};for(const ge of Pa)Pa=ge.value,this.RJg(Pa),Na[ge.key]=Pa;return Na}RJg(Na){Na.M=yd.a.Cia(Na.M,0);Na.T=yd.a.Cia(Na.T,0)}reset(){this.NSa={};this.Dld=0}static generateKey(Na,Pa){return Pa?Na+" [it]":
Na}}Object(w.a)(Ad,"FunctionCallAggregator",null,[597]);class $b{}$b.$Lh="BatchedOperation";$b.Lpk="Replication";$b.S3k="25";$b.Mpk="9_"+$b.$Lh+"_"+$b.Lpk;Object(w.a)($b,"CpuMeterConstants",null,[]);class Ob{}Object(w.a)(Ob,"CpuMeterFrame",null,[]);class Yc extends Sys.EventArgs{constructor(Na){super();this.Geg=Na}}Object(w.a)(Yc,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class zd{}Object(w.a)(zd,"MiniTaskItemInfo",null,[]);class Dd{}Object(w.a)(Dd,"TaskItemInfo",null,[]);var oc=a(598),$c=
a(106);class yb{static S_i(){if(!yb.vcc&&(yb.vcc=new $c.a,S.AFrameworkApplication.fa&&S.AFrameworkApplication.fa.Jv("AggregatorIdDisabledList"))){const Na=S.AFrameworkApplication.fa.pA("AggregatorIdDisabledList");for(let Pa=0;Pa<Na.length;Pa++)yb.vcc.ga(Na[Pa],!0)}return yb.vcc}}yb.vcc=null;Object(w.a)(yb,"DisabledAggregatorListStore",null,[]);var qb=a(296);class Cb{constructor(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf){Ye=void 0===Ye?!0:Ye;Bf=void 0===Bf?null:Bf;this.onf=Pf;this.d9=this.iZe=this.YPe=!1;this.Fk=null;
if(!Na)throw qb.a.argument("taskManagerLazy");if(!Ae)throw qb.a.argument("dataAggregator");this.cuh=Na;this.xgd=Pa;this._id=Oc;this.kOe=6E4*ge;this.Pdc=Ae;this.nWe=Ye;this.CFb=Bf;yb.S_i().kh(this._id.toString())&&(this.d9=!0)}get nW(){return this.Fk||(this.Fk=this.cuh.value)}track(Na,Pa){Pa=void 0===Pa?null:Pa;this.d9||(this.qmi(),this.Uwk(),this.Pdc.lla(Na,Pa))}Uwk(){!this.YPe&&0<this.kOe&&(this.YPe=!0,this.OLg())}OLg(){const Na=new rb.a(5,1,this.kOe,()=>{this.jzk()},19,this._id.toString());this.nW.wm(Na)}jzk(){!this.CFb||
this.CFb.gKk()?this.aNg():this.nWe&&this.Pdc.reset();this.OLg()}aNg(){const Na=this.Pdc.getData();if(Na){const Pa=parseInt(String(Na.length));if(isNaN(Pa)||0<Pa)this.sXc(Na),this.onf&&this.onf(Na),this.nWe&&this.Pdc.reset()}}sXc(Na){K.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:Na})}qmi(){this.iZe||(this.xgd(()=>{this.aNg()}),this.iZe=!0)}static dY(Na,Pa,Oc,ge,Ae,Ye){return new Cb(new oc.a(()=>S.AFrameworkApplication.Vp),S.AFrameworkApplication.bQa,Na,Pa,
Oc,ge,Ae,Ye)}static Okb(Na,Pa,Oc){return Cb.dY(Na,Pa,Oc,!0,null,void 0)}}Object(w.a)(Cb,"Aggregator",null,[600]);class gc{constructor(Na){Na=void 0===Na?null:Na;this.gv=null;this.reset();this.CFb=Na}lla(Na,Pa){if(!this.CFb||this.CFb.gKk())Pa in this.gv||(this.gv[Pa]=[]),this.gv[Pa].push(Na)}getData(){return Aa.a.count(this.gv)?this.gv:null}reset(){this.gv={}}}Object(w.a)(gc,"NamedValuesAggregator",null,[597]);var Mc=a(245);class bd{constructor(Na,Pa,Oc,ge,Ae){this.kUa=0;this.YN=null;this.Pic=this.RYe=
0;this.dXe=!1;this.Rab=0;this.rDb=!1;this.QEa=null;this.Kfc=0;this.NTe=new L.a;this.auh=[];this.OW=Na;this.nfd=Pa;this.Oad=Oc;this.ZRe=ge;S.AFrameworkApplication.fa&&S.AFrameworkApplication.fa.ka("WrapSetTimeoutForTelemetryIsEnabled")&&this.m0d();this.clh=Ae;this.Pad=new Ad(100);this.iph=Cb.Okb(1,5,new gc)}F4e(Na){this.NTe.addHandler("OnCpuMeterFrameAvailable",Na)}Wtb(Na,Pa,Oc,ge){Oc=(ge=void 0===ge?null:ge)?ge.priority:7;const Ae=this.OW();this.start(Pa,Oc);try{Na()}finally{this.stop(Pa,ge),Na=this.OW()-
Ae,this.ZRe.track(Na,Pa)}}s7(Na,Pa){const Oc=this.OW();try{Na()}finally{Na=this.OW()-Oc,this.Oad.lla(Na,Pa),0<this.kUa&&this.Pad.lla(Na,Pa),this.ZRe.track(Na,Pa)}}Bae(Na){const Pa=new Dd;Pa.TN=Na.PLc;Pa.TP=Na.priority;this.Yzg(1,Pa)}Rqb(Na){this.Kfc|=Na}start(Na,Pa){if(!this.kUa){this.Pad.reset();const Oc=this.X3f(Na);Oc&&this.U4d(1);this.YN=new Dd;this.YN.TN=Na;this.YN.TP=Pa;this.YN.ST=(new Date).toISOString();this.YN.STS=yd.a.Cia(this.OW(),2);Oc?this.YN.UI=1:this.Dnj(Na)?this.YN.UI=2:this.YN.UI=
0}this.kUa++}U4d(Na){this.Rab|=Na}Hvd(Na,Pa){this.Rab=void 0===Na||Na?0:this.Rab&~(void 0===Pa?0:Pa)}stop(Na,Pa){Pa=void 0===Pa?null:Pa;let Oc;this.kUa--;0>=this.kUa&&this.YN&&(Oc=this.OW()-this.YN.STS,this.Pic+=Oc,this.nfd.lla(Oc,Na),this.X3f(Na)&&this.Hvd(!1,1),this.YN.TRT=yd.a.Cia(Oc,2),Pa&&(this.YN.TQT=yd.a.Cia(Pa.Mbk,2),this.YN.TDT=yd.a.Cia(Pa.z5f,2)),this.clh&&(this.Yzg(0,this.YN),this.wqk()),this.kUa=0);0<=Na.indexOf($b.S3k)&&this.Rqb(2);0<=Na.indexOf($b.Mpk)&&this.Rqb(4);1===(this.Rab&1)&&
this.Rqb(1);2===(this.Rab&2)&&this.Rqb(8)}wqk(){var Na=this.YN.TRT;if(750<Na){let Oc=this.Pad.getData();if(Oc){const ge={};for(const Ae in Oc){var Pa=Oc[Ae];const Ye=Ae;Ye.startsWith("SiOp_")||Ye.endsWith("[it]")||(ge[Ye]=Math.round(100*Pa.T/Na))}Oc=ge}Na=Object.assign(new zd,{B:this.YN.STS,T:Na,S:Oc});this.iph.track(Na,this.YN.TN)}}LSk(){var Na=this.OW()-this.RYe,Pa=yd.a.Cia(this.Pic/Na*100,2);Na=new Ob;Na.CP=Pa;Na.II=this.Kfc;Pa=this.nfd.getData();Aa.a.count(Pa)&&(Na.LRT=Pa);Pa=this.Oad.getData();
Aa.a.count(Pa)&&(Na.FP=Pa);this.NTe.raiseEvent("OnCpuMeterFrameAvailable",new Yc(Na));this.KXg()}KXg(){this.nfd.reset();this.Oad.reset();this.Pic=this.kUa=0;this.RYe=this.OW();this.Kfc=0;this.YN=null}run(){this.dXe?this.LSk():(this.KXg(),this.dXe=!0);this.QEa?this.QEa(Object(xd.a)(this,this.run,"run"),1E3):window.setTimeout(Object(xd.a)(this,this.run,"run"),1E3)}Yzg(Na,Pa){Na=this.auh[Na];if(!Mc.a.Gm(Na))for(let ge=0;ge<Na.length;ge++){var Oc=Na[ge];const Ae=Oc[0];Oc=Oc[1];Ae&&!Ae(Pa)||Oc(Pa)}}m0d(){if(!this.rDb){const Na=
window.setTimeout;this.QEa=(Pa,Oc)=>Na(Pa,Oc);this.rDb=!0}}X3f(Na){return Na.startsWith("key")||Na.startsWith("input")}Dnj(Na){return Na.startsWith("click")||Na.startsWith("mouse")||Na.startsWith("pointer")}}Object(w.a)(bd,"CpuMeter",null,[70]);class Id{constructor(Na){this.xBb=null;this.ht=new uc.a;this.OW=Na}initialize(Na,Pa,Oc,ge){this.xBb||(this.xBb=new bd(this.OW,Na,Pa,Oc,void 0===ge?!1:ge),this.ht.setResult(this.xBb));return this.xBb}}Object(w.a)(Id,"CpuMeterProvider",null,[599]);class Vd{constructor(Na){this.AF=
[];this.Xdc=[];this._count=void 0===Na?1:Na}ywi(){let Na=0;for(let Pa=0;Pa<this.AF.length;Pa++)this.AF[Pa]<this.AF[Na]&&(Na=Pa);return Na}lla(Na,Pa){Na=yd.a.Cia(Na,2);if(this.AF.length<this._count)Array.add(this.AF,Na),Array.add(this.Xdc,Pa);else{var Oc=this.ywi();Na>this.AF[Oc]&&(this.AF[Oc]=Na,this.Xdc[Oc]=Pa)}}getData(){return this.AF.length?{["Vals"]:this.AF,["Desc"]:this.Xdc}:null}reset(){this.AF=[];this.Xdc=[]}}Object(w.a)(Vd,"MaxDataAggregator",null,[597]);var ce=a(59);class ee{get name(){return"Common.App.CpuMeter"}$n(Na){Na.register(Id,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").yi().Ei(()=>new Id(ce.a.Ej));Na.register(fc,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").yi().Ei(()=>new fc)}init(){const Na=S.AFrameworkApplication.fa;if(Na.ka("CpuMeterIsEnabled")&&!Na.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableCpuMeter",!1)){const Pa=C.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");kb.a.instance.h7e.continueWith(()=>{ee.xbj(Na,Pa)})}}dispose(){}static xbj(Na,
Pa){const Oc=Cb.Okb(10,5,new Ad(Na.Lj("TaskManagerLoggingThreshold",0),Na.Lj("CpuMeterMaximumEntriesToLog",0)));Pa=Pa.initialize(new Vd(5),new Ad,Oc,Na.ka("CPUMeterExposeTaskDetailsIsEnabled"));Na.ka("WordEditorInteractivePerfDisableCpuMeterFrames")||(Pa.run(),Na.ka("CpuMeterMonitorIsEnabled")&&C.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Pa,Na.lga("CpuMeterAverageCpuPercentThreshold",80),Na.Lj("CpuMeterRollingAverageFramesCount",15)));Sd.a(16827671,306,50,"Initializing CpuMeter")}static main(){xc.a.instance.Do(new ee)}}
Object(w.a)(ee,"CpuMeterPackage",null,[12,13]);var Je=a(1165);class Ue{get name(){return"Common.App.EventsCachePackage"}$n(){}init(){Je.a.instance.init()}dispose(){}static main(){xc.a.instance.Do(new Ue)}}Object(w.a)(Ue,"EventsCachePackage",null,[12,13]);var jc=a(9),tc=a(428);class Kc extends tc.a{constructor(Na){super();this.Whf=!1;this.$=Na;this.gm()}create(){const Na=this.$.la,Pa=C.a.instance;if(!this.Whf){this.Whf=!0;let Oc;Oc=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?
this.$.ua.DocumentHostInfo.PostMessageOrigin||Z.a.eU:S.AFrameworkApplication.RRc||Z.a.eU;Pa.register(ba,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").yi().Ei(()=>new ba(this.$,window.parent,Oc,S.AFrameworkApplication.fa.ka("HostSendReadyToAcceptPostMessage")))}this.Bk(Na.lh(21)||Na.Hh(21,Pa.resolve("Postmessage.IHostPostmessenger")))}}Object(w.a)(Kc,"HostMessengerFactory",tc.a,[]);var wd=a(126),Rb=a(181),dc=a(854),$a=a(648),Wb=a(78),rc=a(243),
xb=a(367),ic=a(366),Rc=a(502),Zc=a(7),Kd=a(62),fe=a(65);class Ld{constructor(Na,Pa,Oc){this.correlations=this.properties=this.operation=null;this.operation=Na;this.properties=Pa;this.correlations=Oc}static Sti(Na,Pa,Oc){const ge={},Ae=Kd.b();switch(Na.command){case -1537138325:ge.Action=Pa.LabelText;break;case -1104934572:ge.PrevTab=Ae.zp(parseInt(Pa.OldContextCommand,10));ge.NextTab=Ae.zp(parseInt(Pa.NewContextCommand,10));break;case 802602464:ge.Origin=Pa[Zc.a.ZO];break;case -1027730316:case -1059615499:ge.MenuType=
Pa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Pa&&(ge.SqmControlId=Pa.SqmControlId);break;case 1371713064:case 875133075:fe.a.Qi in Pa&&(ge.SampleTableId=Pa[fe.a.Qi])}ge.InputMethod=xb.a[Na.method];ge.Location=ic.a[Na.ik];ge.Mode=Rc.a[Na.mode];ge.ParentName=Na.tabName;ge.IsSystemInitiated="IsSystemInitiated"in Pa?Pa.IsSystemInitiated:!1;ge.NoReporting="NoReporting"in Pa?Pa.NoReporting:!1;"ControlIdToLog"in Pa&&(ge.ControlId=
Pa.ControlIdToLog);"TerminalParentControlIdToLog"in Pa&&(ge.TerminalParentControlId=Pa.TerminalParentControlIdToLog);for(const Ye of Object.keys(Oc))ge[Ye]=Oc[Ye];return ge}}Object(w.a)(Ld,"InteractivityRecord",null,[]);class Gd extends Ld{constructor(Na,Pa,Oc){super(Na.operation,Na.properties,Na.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Pa;this.timeFromNavigationStart=Oc}}Object(w.a)(Gd,"FirstUserInteractivityRecord",Ld,[]);var Zd=a(768);
class Bc{constructor(){this.commandSurface=this.triggerMethod=wd.a.ezb}static Qbj(){Bc.Zjb||(Bc.Zjb=new Zd.a($a.a.zm()),Bc.Zjb.add("InputMethod"),Bc.Zjb.add("Location"),Bc.Zjb.add("Mode"))}}Bc.Zjb=null;Object(w.a)(Bc,"ExcelUserAction",null,[]);var Lc=a(203),Cd=a(500),Fd=a(115),te=a(156),ye=a(110);class ue extends Wb.a{constructor(Na){super();this.UVf=0;this.wAf=!1;this.X0d=Array(ue.Vqb);this.qtc=0;this.$=Na;this.u3f=M.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");
wd.a.XRi();this.Qna={};ue.Nkc||(ue.Nkc=new dc.a($a.a.zm()),ue.Uaj(ue.Nkc));Bc.Qbj();if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Na=0;Na<ue.Vqb;Na++)this.X0d[Na]="NA"}dispose(){this.$=this.Qna=null;super.dispose()}JGg(Na,Pa,Oc){const ge=Kd.b().zp(Na.command),Ae=JSON.stringify(Na);ge||K.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${ge}, command: ${Na.command}, commandInfo: ${Ae}`);Pa=
Ld.Sti(Na,Pa,Oc);Oc=!!Pa&&(!("IsSystemInitiated"in Pa)||!Pa.IsSystemInitiated);this.$&&this.$.ea.lm&&Oc&&Je.a.instance.vBg("OtelUserAction",new Cd.a(ge,Na.tabName,Date.now()));this.XGg(ge,Pa,null,!0,!0)}Aj(Na,Pa,Oc,ge){this.XGg(Na,Pa,void 0===Oc?null:Oc,!1,void 0===ge?!1:ge)}OXg(Na){if(this.Qna){++this.UVf;this.Qna[Na]||(this.Qna[Na]=[]);var Pa=this.UVf.toString();this.Qna[Na].push(Pa);K.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${Na}', correlation=${Pa}`)}else K.ULS.shipAssertTag(537155554,
0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Na}] == null`)}vYg(Na){if(this.Qna&&this.Qna[Na]){var Pa=this.Qna[Na],Oc=Pa.pop().toString();Pa.length||delete this.Qna[Na];K.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${Na}', correlation=${Oc}`)}else K.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Na}] == null`)}b0(Na,Pa,Oc){Oc=void 0===
Oc?!1:Oc;return rc.b(ge=>{this.Aj(Na,ge(),void 0,Oc)},ue.LYk,this.ya,Da.a.Rej,!1,!Pa)}cke(){let Na="";for(let Pa=0;Pa<ue.Vqb;Pa++)Na+=this.X0d[(this.qtc+ue.Vqb-Pa-1)%ue.Vqb]+",";K.ULS.sendTraceTag(557188890,0,15,`Last operations ${Na}`)}t8k(Na){Na&&(this.X0d[this.qtc]=Na,this.qtc=(this.qtc+1)%ue.Vqb)}dAj(Na,Pa,Oc){S.AFrameworkApplication.hwc();const ge=Na.operation,Ae=Na.properties;void 0!==Oc?void D.a.resolve(N.ve,{va:0}).then(Ye=>{Ye.agk(ge,Ae,Oc)}):this.b4k(Na);this.c4k(Na);this.C2j(Pa,Ae,ge)}b4k(Na){this.QRk(Na)||
(this.wAf=!0,Na=new Gd(Na,Qa.a.instance.vga(new Date),Object(ye.b)()),Na=Sys.Serialization.JavaScriptSerializer.serialize(Na),K.ULS.sendTraceTag(458261331,0,50,`${Na}`))}QRk(Na){const Pa=Na.properties;Na=Na.operation;return this.wAf||void 0===Na||null===Na||Na===za.a.Zmd||Na===za.a.Rne||Na===za.a.Nde||na.a.vYd(Na)||!!Pa&&"IsSystemInitiated"in Pa&&Pa.IsSystemInitiated}c4k(Na){M.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.t8k(Na.operation);Na=Sys.Serialization.JavaScriptSerializer.serialize(Na);
K.ULS.sendTraceTag(21542793,0,50,`${Na}`)}C2j(Na,Pa,Oc){wd.a.Mya()&&(Pa?"NoReporting"in Pa&&Pa.NoReporting||"IsSystemInitiated"in Pa&&Pa.IsSystemInitiated||!Na&&!this.u3f||((Na=wd.a.Pm(Pa,ue.Nkc,Bc.Zjb))?(Pa=ue.aui(Pa))?Rb.a.sendUserActionEvent(wd.a.Xsc(Oc,null,Pa.triggerMethod,Pa.commandSurface,Na)):K.ULS.sendTraceTag(537155550,0,50,"user action was null"):K.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):K.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${Oc}`))}XGg(Na,
Pa,Oc,ge,Ae){const Ye=Lc.a(this.$);if(this.u3f){let Pf=null;ja.a.equals(Na,za.a.eXc,!0)&&Pa&&"InputMethod"in Pa&&(Pf=za.a.HBf(Na,Pa.InputMethod));Ye.g5b(Pf||Na,Oc)}else ja.a.equals(Na,za.a.eXc,!0)&&Pa&&"InputMethod"in Pa&&(Na=za.a.HBf(Na,Pa.InputMethod)),Ye.g5b(Na,Oc);Pa&&(Pa.IsCommand=ge);const Bf="ActionRelativeTime"in Pa?Pa.ActionRelativeTime:Object(ye.b)();Object(te.e)(()=>{const Pf=new Ld(Na,Pa,this.Qna);this.dAj(Pf,Ae,Bf)},this.$.ya,50)}static aui(Na){if(!Na)return null;const Pa=new Bc;"InputMethod"in
Na&&(Pa.triggerMethod=Na.InputMethod);"Location"in Na&&(Pa.commandSurface=Na.Location);return Pa}static Uaj(Na){Na?(Na.add("Origin",Fd.g.String),Na.add("InputMethod",Fd.g.String),Na.add("ButtonType",Fd.g.String),Na.add("selectedRange",Fd.g.String),Na.add("SelectedRanges",Fd.g.String),Na.add("editRange",Fd.g.String),Na.add("Location",Fd.g.String),Na.add("Mode",Fd.g.String),Na.add("CurrentSelectionMode",Fd.g.String),Na.add("Action",Fd.g.String),Na.add("type",Fd.g.String),Na.add("floatingObjectType",
Fd.g.String),Na.add("PrevTab",Fd.g.String),Na.add("NextTab",Fd.g.String),Na.add("DialogName",Fd.g.String),Na.add("dx",Fd.g.Int64),Na.add("dy",Fd.g.Int64),Na.add("NumberOfSelectedRanges",Fd.g.Int64),Na.add("IsCommand",Fd.g.Boolean),Na.add("IsInFormulaBarEdit",Fd.g.Boolean),Na.add("isLink",Fd.g.Boolean),Na.add("isSheetRef",Fd.g.Boolean),Na.add("isEmptyText",Fd.g.Boolean),Na.add("isFormula",Fd.g.Boolean),Na.add("IsResizingHiddenHeader",Fd.g.Boolean)):K.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}
ue.LYk=1E3;ue.Vqb=40;ue.Nkc=null;Object(w.a)(ue,"InteractivityLogger",Wb.a,[27]);var De=a(77),Ke=a(84),pe=a(145),pf=a(597),qf=a(87),of=a(61),Ef=a(308),Nf=a(39),Kf=a(41),Qf=a(262);class Hf extends Sys.EventArgs{constructor(Na){super();this.XO=Na}}Object(w.a)(Hf,"ErrorDataArgs",Sys.EventArgs,[]);var If=a(772);class ac{constructor(Na,Pa){this.mdc=null;this.Ltc=this.QRd=!1;this.pXe=this.qXe=null;this.Fmb=this.Emb=0;this.$Lg=Na;this.vUe=Pa}get Ctg(){return this.vUe}get i6b(){return this.qXe}get ZLg(){return this.pXe}get iuj(){return this.scf(this.$Lg.getTime())}get H3j(){return this.scf(this.ZLg.getTime())}get YSg(){return!(this.Ltc||
void 0===window.bsqmXLSPageLoadStartTime)}get dwd(){try{return this.mdc||(this.mdc=B.toUtc(window.bsqmXLSPageLoadStartTime)),this.mdc}catch(Na){return null}}set dwd(Na){this.mdc=Na}nGk(Na){this.Ltc||(this.qXe=Na,this.pXe=B.toUtc(this.i6b))}C8i(Na){if(Na.Values&&(!this.Emb||!this.Fmb))try{X.a.USf in Na.Values&&(this.Emb=parseInt(Na.Values[X.a.USf].toString(),10));X.a.VSf in Na.Values&&(this.Fmb=parseInt(Na.Values[X.a.VSf].toString(),10));const Pa=kb.a.instance;0<this.Emb&&(this.d9f(this.Emb,"PageLoadFromHostClick"),
Pa.cgk(this.Emb));0<this.Fmb&&(this.d9f(this.Fmb,"PageLoadFromHostFrameCreation"),Pa.egk(this.Fmb));const Oc=Na.Values[X.a.F8i]||0,ge=Na.Values[X.a.D8i]||Na.Values[X.a.E8i]||0;0<ge&&Pa.Hfk(ge);Pa.Ifk(Oc)}catch(Pa){}}lsk(){this.$Lg=this.dwd=A.a.ih.si;this.vUe=0;this.QRd=this.Ltc=!1}scf(Na){const Pa=this.dwd.getTime();return Pa>=Na?0:Na-Pa+this.Ctg}d9f(Na,Pa){if(Na){const Oc=Kd.b();Oc.J_c("UserAction",Pa,Pa,A.a.D4d(Na),If.EcmaDateClock.instance.appStart);Oc.ewc(Pa,B.toTimestamp(this.i6b))}}}Object(w.a)(ac,
"PageLoadPerfInfo",null,[]);var Yb=a(69);class Cc{constructor(Na,Pa,Oc){this.qkd=Na.keyCode;this.W6b(Na.ctrlKey,1);this.W6b(Na.shiftKey,2);this.W6b(Na.altKey,4);this.W6b(Yb.b(Na),8);this.W6b(Oc,16);this.qkd=this.Pxb|Pa<<24}get Pxb(){return this.qkd}get keyCode(){return this.Pxb&65535}W6b(Na,Pa){Na&&(this.qkd=this.Pxb|Pa<<16)}}Object(w.a)(Cc,"ShortcutSqmData",null,[]);class Of{constructor(){this.A3d=null;this.DZh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.kIg()}mUh(Na,Pa,Oc){0===
Oc&&(Oc=this.DZh[Pa.toString()]);return Of.shouldLog(Na,Oc)&&(Na=new Cc(Na,Oc,Ka.a.isMac),!Kf.a.Wm(this.A3d,Na.Pxb.toString()))?(this.A3d[Na.Pxb.toString()]=!0,Na):null}kIg(){this.A3d={}}static slj(Na){return 112<=Na&&123>=Na||61440<=Na&&61451>=Na}static inj(Na){return 17!==Na&&18!==Na&&16!==Na&&91!==Na&&93!==Na}static shouldLog(Na,Pa){let Oc=Na.ctrlKey||Na.altKey||Yb.b(Na);Na=Na.keyCode;Oc=Of.slj(Na)||Oc;Oc=Of.inj(Na)&&Oc;return 0!==Pa&&Oc}}Object(w.a)(Of,"UnhandledShortcutLogger",null,[]);class Qb{constructor(Na){this.lrc=
[];this.KHh=null;this.sqmManager=Na}slc(Na){this.lrc.push(Na)}H6(Na,Pa,Oc){try{if(Pa)Pa.endTime=Oc,this.sqmManager.$1e(Pa);else for(let ge=0,Ae=this.lrc.length;ge<Ae;ge++){const Ye=this.lrc[ge];Na?(Ye.endTime=Ye.startTime,Ye.ghf=0):Ye.endTime=Oc;this.sqmManager.$1e(Ye)}}catch(ge){}finally{this.lrc.length=0}}}Object(w.a)(Qb,"UserInteractionPerfInfo",null,[]);var Ic=a(37),hd=a(74),Ga=a(259);class Ub extends Wb.a{constructor(Na,Pa){super();this.GQd=this.j5b=!1;this.aTg=!0;this.eh=new y.a;this.M9c=!1;
this.ej=()=>{const Oc=hd.a(this.$).xj.activityState,ge=Kf.a.Wm(Oc,Ic.a.E1e);Kf.a.Wm(Oc,Ic.a.fHb)||ge||this.upload()};this.$=Na;this.mRb=Pa;this.ea=Na.ea;this.$.fq(this.ej);this.U3g=new Of;this.Q4a=new ac(na.a.Wme,Na.ua.PageGenerationMetrics.TimeToCompleteFirstFlush);this.h4c=new Qb(this)}Dod(Na){this.eh.addHandler("EREK",Na)}Iie(Na){this.eh.removeHandler("EREK",Na)}get Eai(){return this.M9c}get Nej(){return this.$.frame.h1?cb.a.Pej:cb.a.Oej}get workbookContext(){return this.$.workbookContext}get j4(){Ub.LAb||
(Ub.LAb=this.Ltf());Ub.gtd||(Ub.gtd=!0,this.WUf());return Ub.LAb}set j4(Na){Ub.LAb=Na;Ub.LAb||(Ub.gtd=!1)}get Sea(){return qf.a(this.$.ua,3)}dispose(){this.Eai&&S.AFrameworkApplication.$t&&S.AFrameworkApplication.$t.disable();this.$&&this.$.Wu(this.ej);this.$=this.h4c=this.Q4a=this.j4=null;super.dispose()}DPf(Na){this.Q4a.C8i(Na);this.Uzj()}Foe(Na){this.setDw(9415,Na)}slc(Na){this.h4c.slc(Na)}H6(Na,Pa,Oc){this.h4c.H6(Na,Pa,Oc)}S2d(Na){if(this.Sea){Na=this.$.isEditMode||Na&&!!(this.ea.workbookContext.Options&
512);if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:8784630_SupportCollabViewInApplicationModeExtended")){const Pa=this.ea.V0a;Na=Na?2:Pa?20:this.ea.Kh.inEmbedView?14:1}else Na=Na?2:this.ea.Kh.inEmbedView?14:1;this.setDw(8721,Na);this.Bxi(Na);this.M9c=!1}}t9f(){const Na=this.Q4a;this.Sea&&Na.YSg&&(this.setDw(9450,Na.Ctg),this.setDw(9085,Na.iuj))}u9f(Na){if(!this.j5b){this.j5b=!0;const Pa=this.Q4a;let Oc=0;this.Sea&&Pa.YSg?(Pa.nGk(Na),this.h4c.KHh=Pa.ZLg,this.setDw(9086,Pa.H3j),Pa.Ltc=!0,Oc=this.Q4a.i6b.getTime()):
Oc=Na.getTime();Nf.TaskExtensions.Xa(this.mRb.value,ge=>{ge.result.sendMessage(V.a.EHh,{[X.a.FHh]:Oc})},this.ya,3)}}$1e(Na){this.Sea&&Na&&1!==Na.Tqa&&this.Qta(8327,Qf.b(Na),Qf.l(Na),Qf.a(Na),2,Na.ghf,Qf.m(Na),Qf.d(Na),Qf.e(Na))}Zje(Na,Pa){Na&&Na.MessageIdHash&&this.Yje(Na.MessageIdHash,Na.MessageIdName,Na.MessageId,Na.ErrorCause?Na.ErrorCause:Ke.a.r2c,!1,Pa,Na,null)}Yje(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf){Ub.xqd||(Ub.xqd=!0,pe.a.get_instance().isCompleted(13)||(pe.a.get_instance().$x(13),K.ULS.sendTraceTag(537151323,
0,50,"App encountered its first error so updating app init status")));Na=this.qjb(Na);const mg=!!Bf,Jf={};Jf.ErrorName=Pa;Jf.ErrorHashCode=Na.toString();Jf.ErrorId=Oc.toString();Jf.ErrorCause=ge.toString();Jf.ErrorType=0===Ye?"ErrorDialog":"BusinessBar";Jf.BusinessBarEntryName=Pf||"null";Jf.ServerCorrelationId=mg?Bf.CorrelationId:"null";Jf.WebMethodName=mg?Bf.WebMethodName:"null";Jf.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Jf.WfeServerId=mg?Bf.WfeServerId:
"null";Pa=of.a.Ci(Jf);this.eh.raiseEvent("EREK",new Hf(Jf));K.ULS.sendTraceTag(1881314,0,15,Pa);this.Sea&&(nb.a.xBg(Na.toString()),this.Qta(9134,Na,ge,Ke.a.Xye),this.ea.uA||Ae||(this.setDw(10459,Na),this.S2d(!0),this.GQd=!0,this.upload(),this.WUf()))}qjb(Na){return 5439488|(Na>>>16^Na&65535)&65535}s3d(Na,Pa,Oc){Na=this.U3g.mUh(Na,Pa,Oc);this.Sea&&Na&&this.Qta(11007,Na.Pxb)}upload(){!this.Sea||!this.j5b&&!this.GQd||Ka.a.Am&&S.AFrameworkApplication.Xl?Ka.a.Am&&S.AFrameworkApplication.Xl&&K.ULS.sendTraceTag(537151320,
0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.j4.Fac(),this.M9c=!0);S.AFrameworkApplication.$t=this.j4=null;this.Q4a.lsk();this.j5b=!1;S.AFrameworkApplication.$t=this.j4=this.Ltf();this.U3g.kIg()}Uzj(){const Na=this.Q4a;if(this.Sea&&!Na.QRd){var Pa=Na.Emb,Oc=Na.Fmb,ge=Na.i6b.getTime();S.AFrameworkApplication.LX=Na.i6b;Pa&&this.setDw(10324,Pa>ge?0:ge-Pa);Oc&&this.setDw(10325,Oc>ge?0:ge-Oc);Na.QRd=!0}}Qta(Na,...Pa){this.Sea&&this.j4.Qta(Na,...Pa)}setDw(Na,Pa){this.Sea&&this.j4.setDw(Na,Pa)}Ltf(){Ef.a.iuf(this.$.ua);
return S.AFrameworkApplication.$t}Bxi(Na){let Pa;try{Pa=Object(hb.a)(Object,of.a.Rp(S.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(Oc){K.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${Oc.message}`);return}if(Pa){let Oc=Object(hb.a)(String,Pa.ApplicationModeExtended),ge=Object(hb.a)(String,Pa.ApplicationMode);Oc&&ge&&(Oc=Oc.toUpperCase(),2!==Na&&16!==Na||"VIEW"!==Oc&&"UNIFIED"!==Oc?1!==Na||"EDIT"!==Oc&&"UNIFIED"!==Oc||(Oc="VIEW",ge="View"):(Oc=
"EDIT",ge="Edit"),Pa.ApplicationModeExtended=Oc,Pa.ApplicationMode=ge,S.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=of.a.Ci(Pa))}}WUf(){const Na=this.$.ua;this.j4.yY=!0;this.j4.Y9a(Na.BWsaStartTime);this.setDw(59,83);this.j5b=!1;if(this.Sea){const Pa=Na.DocumentHostInfo;this.j$h();this.setDw(8491,this.$.zN);this.setDw(9236,Na.RequestedUILcid);this.setDw(8473,Na.WacHostId);this.setDw(9902,Qf.c(Pa.ClusterId));M.EwaSettings.Ra(398)?this.j4.aPg(""):this.j4.aPg(Na.FlightHolder?Na.FlightHolder.FlightId:
"");this.Foe(this.ea.Kh.inEmbedView?1:0);this.GQd=!1;this.setDw(9104,Qf.c(Pa.FileSourceId));this.setDw(10309,this.Nej);this.qIk();S.AFrameworkApplication.yh.vhe(pf.a.getInstance(!1))}}qIk(){kb.a.instance.$aj(this.j4);if(this.aTg){const Na=kb.a.instance;Na.Bfk();Na.Yfk();Na.Vfk();Na.Ufk();Na.Ofk();this.aTg=!1}}j$h(){this.createStream(8327,1,Ga.a.rci,Ga.a.iib);this.createStream(9134,1,3,Ga.a.iib);this.createStream(11007,1,1,Ga.a.iib)}createStream(Na,Pa,Oc,ge){this.j4.createStream(Na,Pa,Oc,ge)}}Ub.LAb=
null;Ub.gtd=!1;Ub.xqd=!1;Object(w.a)(Ub,"SqmManager",Wb.a,[580,581]);var yc=a(91),kd=a(943);class Nd{constructor(Na,Pa){this.entryTypes=null;this.buffered=!1;this.entryTypes=Na;this.buffered=void 0===Pa?!1:Pa}}Object(w.a)(Nd,"PerformanceObserverInit",null,[]);class wa extends Sys.EventArgs{constructor(Na){super();this.luf=Na}}Object(w.a)(wa,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class wb extends Sys.EventArgs{constructor(Na){super();this.YEc=Na}}Object(w.a)(wb,"LongTaskPerformanceObserverInitializedEventArgs",
Sys.EventArgs,[]);class zc{constructor(Na){this.eh=new y.a;this.qcd=!1;this.Hm=()=>{if(Ka.a.Vv){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.kCj)).observe(new Nd([cb.a.E3d])),this.qcd=!0)}catch(Pa){this.qcd=!1,K.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Pa}`)}this.eh.raiseEvent("ltpoiek",new wb(this.YEc))}};this.kCj=Pa=>{this.eh.raiseEvent("ltoek",new wa(Pa))};this.$=Na;this.$.ea.lm?this.Hm():M.EwaSettings.vl()?
this.$.ea.Yq(this.Hm):this.$.ea.jr(this.Hm)}get YEc(){return this.qcd}v4e(Na){this.eh.addHandler("ltoek",Na)}Vmk(Na){this.eh.removeHandler("ltoek",Na)}iDh(Na){this.eh.addHandler("ltpoiek",Na)}Wmk(Na){this.eh.removeHandler("ltpoiek",Na)}dispose(){M.EwaSettings.vl()||this.$.ea.yv(this.Hm);l.a.dh(this.eh);this.$=this.eh=null}}Object(w.a)(zc,"LongTaskPerformanceObserver",null,[2]);var Hc=a(184);class ed{constructor(Na,Pa){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===
Na?0:Na;this.longTaskDuration=void 0===Pa?0:Pa}get F3d(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}gtj(Na){return 100*this.F3d>Na}yAh(Na){this.u3e(Na.longTaskDuration);this.lod(Na.activeSessionDuration)}u3e(Na){this.longTaskDuration+=Na}lod(Na){this.activeSessionDuration+=Na}}Object(w.a)(ed,"LongTaskPerformanceData",null,[]);class rd{constructor(Na,Pa,Oc,ge,Ae){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;
this.maxUsersCount=0;this.isVetoSession=Na;this.entireSessionData=Pa;this.worstWindowData=Oc;this.postBootWindowData=ge;this.maxUsersCount=Ae}get reportName(){return"LongTaskPerformance"}static get zki(){return new rd(!1,new ed,new ed,new ed,0)}}Object(w.a)(rd,"LongTaskPerformanceDataStatistics",null,[154]);class ve extends Sys.EventArgs{constructor(Na){super();this.G3d=Na}}Object(w.a)(ve,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Le=a(436),Qe=a(310),Vb=a(357);class cd{constructor(Na,Pa){this.eh=
new y.a;this.C2a=this.wha=this.K2=this.tk=null;this.p5f=this.wse=this.yJc=!1;this.d3a=null;this.maxUsersCount=0;this.jPc=(Oc,ge)=>{Oc=ge.luf.getEntriesByType(cb.a.E3d);for(const Ae of Oc)this.tk.PM(Ae.duration)||S.AFrameworkApplication.h2a||(this.K2.u3e(Ae.duration),this.eh.raiseEvent("lttek",new ve(Ae)),Oc={},Oc.LongTaskDuration=Ae.duration,Oc.LongTaskStartTime=Ae.startTime,K.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Oc)))};this.Hm=()=>{this.wse=!0;this.p9b()};this.VE=(Oc,ge)=>{ge&&(this.maxUsersCount=
Math.max(this.maxUsersCount,ge.g8g));this.wha.maxUsersCount=this.maxUsersCount};this.Dj=()=>{this.p9b()};this.ej=()=>{this.u9b()};this.Ymg=(Oc,ge)=>{ge.YEc&&this.p9b()};this.b$f=()=>{this.K2.lod(B.getElapsedMilliseconds(this.C2a,A.a.ih.si));this.Cue(!0);var Oc=!1;this.wha.postBootWindowData.activeSessionDuration?(!this.p5f&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Kd.b().$Gg(2),ub.Health.instance.recordKpiUsage(Qe.a.longJsTask,Vb.b.FailureBased,Le.a.juj,null),
this.p5f=!0),!this.wha.isVetoSession&&this.K2.gtj(this.k9g)&&(this.wha.isVetoSession=!0,M.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Kd.b().aHg(2,this.iCj),ub.Health.instance.recordKpiFailure(Qe.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.wha.worstWindowData.F3d<=this.K2.F3d&&(this.wha.worstWindowData=this.K2),this.wha.entireSessionData.yAh(this.K2)):(this.wha.postBootWindowData=new ed(this.K2.activeSessionDuration,this.K2.longTaskDuration),Oc=
!0);const ge={};ge.LastWindowScore=this.K2;ge.postBootWindow=Oc;ge.CoauthersNumber=this.$.ea.Ut.length;Oc=JSON.stringify(ge);K.ULS.sendTraceTag(20779346,0,50,Oc);this.K2=new ed};this.bOc=()=>{this.tk.un||S.AFrameworkApplication.h2a||this.Cue(!1)};this.aOc=()=>{this.K2.lod(B.getElapsedMilliseconds(this.C2a,A.a.ih.si));this.C2a=null;this.d3a.cancel()};this.$=Na;this.k9g=Na.ua.LongTaskPerformanceVetoThreshold;this.iCj="PercentageOver_"+this.k9g.toString();this.H3d=Na.ua.LongTaskPerformanceWindowDurationInMs;
this.GY=Pa;M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void D.a.resolve(N.Cb).then(Oc=>{this.tk=Oc;this.p9b()}):this.$.la.fi(291,Oc=>{this.tk=Oc;this.p9b()});this.$.ea.lm?this.Hm():M.EwaSettings.vl()?this.$.ea.Yq(this.Hm):this.$.ea.jr(this.Hm);this.GY.iDh(this.Ymg);this.$.kr(this.Dj);this.$.fq(this.ej)}jDh(Na){this.eh.addHandler("lttek",Na)}Xmk(Na){this.eh.removeHandler("lttek",Na)}dispose(){this.wse=!1;this.u9b();this.$.Wr(this.Dj);this.$.Wu(this.ej);
this.GY.Wmk(this.Ymg);l.a.dh(this.d3a);this.GY=this.$=this.d3a=null;void 0!==this.tk&&null!==this.tk&&l.a.dh(this.tk)}p9b(){void 0===this.tk||null===this.tk?K.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.GY.YEc?this.yJc?K.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.wse?(this.yJc=
!0,this.wha=rd.zki,this.K2=new ed,this.$.ea.wea(this.VE),this.maxUsersCount=this.$.ea.Ut.length,this.GY.v4e(this.jPc),this.tk.Q9(this.aOc),this.tk.R3(this.bOc),S.AFrameworkApplication.sod(this.aOc),S.AFrameworkApplication.tod(this.bOc),this.d3a=ma.a.instance.create(this.b$f,this.H3d,Da.a.i9f,!1),Lc.a(this.$).O3(this.wha),this.tk.un||S.AFrameworkApplication.h2a||this.Cue(!0),K.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):K.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):K.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}u9b(){this.yJc&&(this.yJc=!1,M.EwaSettings.vl()||this.$.ea.yv(this.Hm),this.GY.Vmk(this.jPc),this.$.ea.E7(this.VE),void 0!==this.tk&&null!==this.tk&&(this.tk.w6a(this.aOc),this.tk.yOa(this.bOc)),
S.AFrameworkApplication.JEg(this.aOc),S.AFrameworkApplication.KEg(this.bOc),this.d3a.cancel(),this.C2a=this.K2=this.wha=null,this.maxUsersCount=0)}Cue(Na){Na||void 0===this.C2a||null===this.C2a?(this.C2a=A.a.ih.si,this.d3a=Hc.AsyncMethodContext.yMb(this.b$f,Na?this.H3d:this.H3d-this.K2.activeSessionDuration,Da.a.i9f,this.d3a)):K.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}
Object(w.a)(cd,"LongTaskPerformanceTracker",null,[2]);var Ud=a(25);class re extends y.a{constructor(Na,Pa){super();this.statusBarManager=this.tk=null;this.Zmg=(Oc,ge)=>{ge.G3d&&ge.G3d.duration>=this.lCj&&(this.u$f++,this.S5f=ge.G3d.duration)};this.$=Na;this.$.la.fi(29,Oc=>{this.statusBarManager=Oc;Oc.dO(this)});M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void D.a.resolve(N.Cb).then(Oc=>{this.tk=Oc}):this.$.la.fi(291,Oc=>{this.tk=Oc});this.S5f=
this.u$f=0;this.lCj=Na.ua.LongTaskThresholdMs;this.Cqb=Pa;this.Cqb.jDh(this.Zmg)}ky(Na){this.addHandler("LTSCEK",Na)}Xx(Na){this.removeHandler("LTSCEK",Na)}Yv(){this.pr("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}xy(Na,Pa){if("QueryLongTasksCount"!==Na)return!1;this.d4i(Pa);return!0}pr(){return M.EwaSettings.Ra(505)}dispose(){this.statusBarManager&&(this.statusBarManager.pN(this),this.statusBarManager=null);this.Cqb.Xmk(this.Zmg);super.dispose()}d4i(Na){const Pa=`Long Tasks: ${this.u$f} | Last Task Duration: ${Math.round(this.S5f)}ms`;
Ud.a.Mo(this.$)?(Na.LabelText=Pa,Na.Visible=!0):Na.Value=Pa}}Object(w.a)(re,"LongTasksStatusBarManager",y.a,[2,168,169]);var qe=a(13);class Se{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(w.a)(Se,"NetworkInfoData",null,[]);class Ve extends y.a{constructor(Na){super();this.statusBarManager=null;this.Vnd=!1;this.zfg=()=>{this.raiseEvent("NetworkInformation")};this.$=Na;M.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.rS=this.zye("connection")||this.zye("mozConnection")||this.zye("webkitConnection"))&&M.EwaSettings.Ra(410)&&Na.la.fi(29,Pa=>{this.statusBarManager=Pa;Pa.dO(this);this.rS.addEventListener("change",this.zfg);this.Vnd=!0})}ky(Na){this.addHandler("NetworkInformation",Na)}Xx(Na){this.removeHandler("NetworkInformation",Na)}PJa(){return this.rS?Object(qa.a)(new Se,{bandwidthMps:this.rS.downlink,rttMs:this.rS.rtt,connectionType:this.rS.type,effectiveConnection:this.rS.effectiveType,downlinkMaxMps:this.rS.downlinkMax}):
null}xy(Na,Pa){if("QueryNetworkInformation"!==Na)return!1;this.e4i(Pa);return!0}pr(){return this.Vnd}dispose(){this.Vnd&&(this.statusBarManager&&(this.statusBarManager.pN(this),this.statusBarManager=null),this.rS&&this.rS.removeEventListener("change",this.zfg));this.$=null;super.dispose()}zye(Na){return qe.HelperMethods.Wv(window.navigator,Na)?window.navigator[Na]:null}e4i(Na){const Pa="Network: "+this.rS.downlink.toString()+" Mbps, "+this.rS.rtt.toString()+" ms";Ud.a.Mo(this.$)?(Na.LabelText=Pa,
Na.Visible=!0):Na.Value=Pa}}Object(w.a)(Ve,"NetworkInformationManager",y.a,[168,169]);class rf{constructor(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf,mg,Jf){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===Na?"":Na;this.startTime=void 0===Pa?-1:Pa;this.startToNextFrame=void 0===Oc?-1:Oc;this.startToResponseRenderEnd=
void 0===ge?-1:ge;this.wasHidden=void 0===Ae?!1:Ae;this.isUserOperation=void 0===Ye?!0:Ye;this.isGroupBreaking=void 0===Bf?!0:Bf;this.operationThatLedToLogging=void 0===mg?"":mg;this.startToOperationThatLedToLogging=void 0===Jf?-1:Jf;this.isPartOfGroup=void 0===Pf?!1:Pf}}Object(w.a)(rf,"OperationStatisticsData",null,[]);class sb{constructor(){this.operationsGroups=null;this.kaj()}isGroup(Na,Pa,Oc){const ge=new bc.a;ge.addRange(Na);ge.addRange(Pa);for(let Ae=0;Ae<this.operationsGroups.count;Ae++)if(this.Uoj(this.operationsGroups.na(Ae),
ge,Oc))return K.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${Oc}' is part of a group ( operationsList: ${this.ktg(Na)} , frameOperationsList: ${this.ktg(Pa)})`),!0;K.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${Oc}' is NOT part of a group.`);return!1}Uoj(Na,Pa,Oc){let ge=0;for(let Ae=0;Ae<Pa.count;Ae++)if(Pa.na(Ae).isGroupBreaking){if(Na.count<=ge||!ja.a.equals(Pa.na(Ae).name,Na.na(ge),!0))return!1;ge++}return Na.count>ge&&ja.a.equals(Oc,Na.na(ge),
!0)}ktg(Na){return`[${Na.toArray().map(Pa=>Pa.name).join(", ")}]`}kaj(){this.operationsGroups=new bc.a;this.ceb(new bc.a(["Paste","SelectingRange_unknown"]));this.ceb(new bc.a(["AutoSum","SelectingRange_unknown"]));this.ceb(new bc.a(["ChangeSheetDirection","ActiveItemChanged"]));this.ceb(new bc.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.ceb(new bc.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.ceb(new bc.a(["EditBoxEndEdit","SetCell",
"SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}ceb(Na){this.operationsGroups.add(Na)}}Object(w.a)(sb,"OperationsGroupDetector",null,[]);var lc=a(26);class Uc{constructor(Na,Pa,Oc,ge){this.framePerformanceTracker=this.$4b=this.Kba=this.Kca=null;this.jqk=()=>{this.sqd=-1;const Ae=qe.HelperMethods.Jh();this.c$k(Ae);this.q6b&&(K.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.vac(this.KO,
Ae),this.q6b=!1);this.EHc&&(this.vac(this.NP,Ae),this.q6b||this.vac(this.KO,Ae));window.setTimeout(this.Rzj,0)};this.Rzj=()=>{var Ae=[];const Ye=this.$.ua.OperationToPrevOperationThreshold;for(var Bf=0;Bf<this.KO.count;Bf++){var Pf=this.KO.na(Bf);Bf<Ye&&Ae.push(Pf);this.NP.add(Pf)}O.f(this.$)&&O.f(this.$).za?((Bf=this.sessionStatisticsManager.GKd(0))?(Pf=JSON.stringify(this.pZb),Ae=JSON.stringify(Ae),K.ULS.sendTraceTag(237798547,1,50,`DOM count: (${Bf.qGj}, ${Bf.HLh}, ${Bf.YEj}), long tasks: ${Pf}, operations count: ${this.KO.count}, operations: ${Ae}`)):
K.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.KO.count>Ye&&K.ULS.sendTraceTag(537153875,1,50,`More than ${Ye} operations are in the operationsList. count: ${this.KO.count}`),this.KO.clear(),this.pZb.clear()):K.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.jPc=(Ae,Ye)=>{this.jCj(Ye.luf)};this.$=Na;this.$S=Pa;this.Yp=this.Yp||A.a.ih;this.NP=new bc.a;this.KO=new bc.a;this.sqd=this.Lpb=-1;this.pZb=new bc.a;this.p2j=new sb;this.q6b=
this.EHc=!1;this.Oaj();this.maj();this.laj();this.sessionStatisticsManager=Oc;this.GY=ge;this.GY.v4e(this.jPc);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8759538_removeXLFPSTag")||this.$.la.fi(263,Ae=>{this.framePerformanceTracker=Ae})}g5b(Na,Pa){var Oc=qe.HelperMethods.Jh();const ge=this.p2j.isGroup(this.NP,this.KO,Na);(this.EHc=this.joj(Na))&&0<this.NP.count&&!ge&&(this.Y8k(),this.X8k(Na,Oc),this.jyi());this.Lpb=-1;if(O.f(this.$)&&O.f(this.$).za){var Ae=!this.Kca.contains(Na);Oc=new rf(Na,Oc,
void 0,void 0,void 0,Ae,this.EHc,ge);this.KO.add(Oc);this.framePerformanceTracker&&this.framePerformanceTracker.uUk(Oc.name,Pa);!this.q6b&&this.$4b.contains(Na)&&(this.q6b=!0);-1===this.sqd&&(this.sqd=window.requestAnimationFrame(this.jqk))}else K.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}lVc(){this.Lpb=qe.HelperMethods.Jh()}uVc(){this.NP.count||this.KO.count?(this.vac(this.KO,this.Lpb),this.vac(this.NP,this.Lpb)):K.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistent when no operations in the list. Last block render time: ${this.Lpb}`);
this.Lpb=-1}joj(Na){return!this.Kba.contains(Na)&&!Na.includes("Menu")&&!Na.includes("TellMe")}jyi(){for(let Na=0;Na<this.NP.count;Na++){const Pa=this.NP.na(Na);this.$S.cwh(Pa);this.yAj(Pa)}this.NP.clear()}c$k(Na){for(let Pa=0;Pa<this.KO.count;Pa++)this.KO.na(Pa).startToNextFrame=this.aNd(this.KO.na(Pa).startTime,Na),this.KO.na(Pa).wasHidden=kd.a.PM(this.KO.na(Pa).startToNextFrame)}X8k(Na,Pa){for(let Oc=0;Oc<this.NP.count;Oc++)-1===this.NP.na(Oc).startToResponseRenderEnd&&(this.NP.na(Oc).operationThatLedToLogging=
Na,this.NP.na(Oc).startToOperationThatLedToLogging=this.aNd(this.NP.na(Oc).startTime,Pa))}Y8k(){var Na=!1;for(const Pa of this.NP)if(Pa.isPartOfGroup){Na=!0;break}if(Na)for(Na=0;Na<this.NP.count;Na++)this.NP.na(Na).isPartOfGroup=this.NP.na(Na).isGroupBreaking}vac(Na,Pa){for(let Oc=0;Oc<Na.count;Oc++)Na.na(Oc).startToResponseRenderEnd=this.aNd(Na.na(Oc).startTime,Pa),Na.na(Oc).wasHidden=kd.a.PM(Na.na(Oc).startToResponseRenderEnd)}yAj(Na){Na=JSON.stringify(Na);K.ULS.sendTraceTag(2020372336,1,50,`${Na}`)}aNd(Na,
Pa){return-1===Na?-1:-1===Pa?-2:Pa-Na}jCj(Na){Na=Na.getEntriesByType(cb.a.E3d);for(let Pa=0;Pa<Na.length;Pa++)if(30>this.pZb.count)if(this.KO.count)this.pZb.add(this.B5j(Na[Pa]));else{const Oc=Na[Pa];if(null===Oc||void 0===Oc?0:Oc.attribution)void 0!==Oc.attribution.containerSrc&&null!==Oc.attribution.containerSrc&&(Oc.attribution.containerSrc=""),void 0!==Oc.attribution.containerId&&null!==Oc.attribution.containerId&&(Oc.attribution.containerId=""),void 0!==Oc.attribution.containerName&&null!==Oc.attribution.containerName&&
(Oc.attribution.containerName="");K.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{K.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${Na.length} First long task: ${this.pZb.na(0)}`);break}}B5j(Na){return`name:${Na.name}, startTime:${Na.startTime}, duration:${Na.duration}`}Oaj(){this.Kca||(this.Kca=new Zd.a($a.a.zm()),this.Kca.add("ActiveItemChanged"),this.Kca.add(Kd.b().zp(-1398645260)),
this.Kca.add(Kd.b().zp(722290388)),this.Kca.add(Kd.b().zp(974713501)),this.Kca.add(lc.a.H0(lc.a.Xqc)),this.Kca.add(lc.a.H0(lc.a.Wqc)),this.Kca.add(lc.a.H0(lc.a.mLb)),this.Kca.add(lc.a.H0(lc.a.Iyg)),this.Kca.add(lc.a.H0(lc.a.kqa)))}maj(){this.Kba||(this.Kba=new Zd.a($a.a.zm()),this.Kba.add("PromptEditInBrowser"),this.Kba.add(Kd.b().zp(-1398645260)),this.Kba.add(Kd.b().zp(722290388)),this.Kba.add(Kd.b().zp(974713501)),this.Kba.add(lc.a.H0(lc.a.Xqc)),this.Kba.add(lc.a.H0(lc.a.Wqc)),this.Kba.add(lc.a.H0(lc.a.mLb)),
this.Kba.add(lc.a.H0(lc.a.Iyg)),this.Kba.add(lc.a.H0(lc.a.kqa)))}laj(){this.$4b||(this.$4b=new Zd.a($a.a.zm()),this.$4b.add("SelectingRange_keyboard"),this.$4b.add("SelectingRange_mouse"))}}Object(w.a)(Uc,"OperationStatistics",null,[]);var od=a(688);class sd{constructor(Na,Pa){this.messageIdName=null;this.errorCause=0;this.messageIdName=Na;this.errorCause=Pa}}Object(w.a)(sd,"RequestError",null,[]);class be{constructor(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf,mg,Jf,$f,Yf,ng,eg,Ig,Ug,Cg){this.requestName=null;this.isPromotedUTRRequest=
this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=
null;this.responseToCallbackTime=0;this.requestName=Na;this.isUserTriggeredRequest=be.tOi(Na);this.isFullyLoggedKPIRequest=be.jOi(Na);this.isPromotedUTRRequest=be.lOi(Na);this.requestDuration=Pa;this.totalOperationDuration=Oc;this.requestTimeInQueue=ge;this.requestInvokedTime=Ae;this.ecsOperationDuration=Ye.EcsOperationDuration;this.EcsRequestDuration=Ye.EcsRequestDuration;this.WfeRequestDuration=Ye.WfeRequestDuration;this.TimeFromLastEcsFreeze=Ye.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Ye.DuringLoadOnDemand;
this.correlationID=Bf;this.errors=be.b1h(Pf);this.httpStatus=mg;this.requestResourceTiming=Jf;this.communicationErrorRetryCount=$f;this.successfulCall=Yf;this.isDocumentHidden=ng;this.coauthorsCount=eg;this.responseSize=Ig;this.networkInfoData=Ug;this.responseToCallbackTime=Cg}static b1h(Na){if(!Na)return[];const Pa=[];for(const Oc of Na)Pa.push(new sd(Oc.MessageIdName,Oc.ErrorCause));return Pa}static tOi(Na){return!be.lKj.contains(Na)}static aRi(){const Na=new Zd.a($a.a.zm());Na.add("CheckPersistedContentUpdate");
Na.add("GetContentBundle");Na.add("GetSessionStatus");Na.add("GetStatusBarAggregates");Na.add("PollSessionStatus");Na.add("UpdatePresenceUsers");Na.add("UploadLatencyTelemetry");return Na}static jOi(Na){return be.xAi.contains(Na)}static lOi(Na){return be.tak.contains(Na)}static CMi(){const Na=new Zd.a($a.a.zm());Na.add("SetRichTextCell");Na.add("Copy");Na.add("FormatCells");Na.add("PasteRange");Na.add("FindCell");Na.add("ApplyToRangesV2");Na.add("ResizeRowsColumns");Na.add("InsertDeleteCells");Na.add("FillRange");
Na.add("PasteHtmlContent");Na.add("ApplyFilter");Na.add("PasteString");Na.add("Undo");Na.add("LineageUpdateView");Na.add("FindAll");Na.add("ApplyHyperlink");Na.add("AutoFit");Na.add("GetPrintSettings");Na.add("GetEdgeCell");Na.add("Paste");Na.add("MoveAndResizeFloatingObject");Na.add("FindRange");Na.add("SetCustomFilter");Na.add("RenameSheet");Na.add("ApplyThreadedComment");Na.add("SortFilterColumn");Na.add("InsertCopiedCutCellsV2");Na.add("InsertSheet");Na.add("ToggleAutoFilter");Na.add("ReorderSheets");
Na.add("SetOutlineLevel");Na.add("RefreshAll");Na.add("LineageOpenPaneOrChangeFilter");Na.add("ApplySlicerSelection");Na.add("GetCardViewCardByCell");Na.add("AutoSum");Na.add("LineageClosePane");Na.add("Sort");Na.add("ClearAutoFilter");Na.add("DeleteSheet");Na.add("Redo");M.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Na.add("RemovePageBreak"),Na.add("InsertPageBreak"),Na.add("SetPrintArea"),Na.add("ClearPrintArea"));return Na}static mOi(){const Na=new Zd.a($a.a.zm());
Na.add("DeleteConditionalFormattingRules");Na.add("GetConditionalFormattingRules");Na.add("AddConditionalFormattingRule");Na.add("QuickEditConditionalFormattingRule");Na.add("GetPrintSettings");Na.add("UpdatePresenceUsers");Na.add("GetThemeInfo");Na.add("InsertCopiedCutCellsV2");Na.add("PasteRange");Na.add("FillRange");Na.add("InsertCopiedCutCellsCrossSession");M.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(Na.add("LineageOpenPaneOrChangeFilter"),Na.add("LineageUpdateView"),
Na.add("LineageRefreshView"),Na.add("LineageLoadMore"));M.EwaSettings.isChangeGateEnabled("OfficeVSO:8609133_PromoteGetNumberFormatViewModelData")&&Na.add("GetNumberFormatViewModelData");Na.add("PasteString");return Na}}be.lKj=be.aRi();be.xAi=be.CMi();be.tak=be.mOi();Object(w.a)(be,"RequestStatisticsData",null,[]);class Ee{constructor(Na,Pa,Oc){this.$=Na;this.$S=Pa;this.vza=Oc}yVc(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf,mg,Jf,$f,Yf,ng,eg){Yf=od.a(Yf);Na=new be(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf,mg,Yf,Jf,$f,kd.a.PM(Pa),this.oMd(null),
ng,this.vza.PJa(),eg);this.Eke(Na)}xp(Na,Pa){Na="UnknownMethodName";var Oc=-1;void 0!==Pa.context&&null!==Pa.context&&(Na=Pa.context.methodName,Oc=Pa.context.communicationErrorRetryCount);let ge,Ae={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Pa.nk?(ge=Pa.nk.Errors||[],this.$S.bqk(Pa.nk.EditSessionIsDirty),void 0!==Pa.nk.RequestTelemetryData&&null!==Pa.nk.RequestTelemetryData&&(Ae=Pa.nk.RequestTelemetryData)):ge=[];const Ye=Pa.duration,
Bf=od.a(Pa.url);Na=new be(Na,Ye,Pa.totalOperationDuration,Pa.Uwe,Pa.pP,Ae,Pa.poe,ge,Pa.httpStatus,Bf,Oc,!0,kd.a.PM(Ye),this.oMd(Pa.nk),Pa.responseSize,this.vza.PJa(),Pa.responseToCallbackTime);this.Eke(Na);Na.requestResourceTiming&&(Oc=Na.requestResourceTiming.totalDuration-Na.WfeRequestDuration,Oc>=this.$.ua.LongNetworkTimeTelemetryThresholdInMilliseconds&&Pa.responseHeaders&&K.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${Na.requestName}, requestDuration = ${Na.requestDuration}, networkTime = ${Oc},  ServerCorrelation = ${Na.correlationID}, msEdgeHeader = ${cb.a.q_b in
Pa.responseHeaders?Pa.responseHeaders[cb.a.q_b]:""}, backendDatacenter = ${cb.a.d8d in Pa.responseHeaders?Pa.responseHeaders[cb.a.d8d]:""}, proxyDatacenter = ${cb.a.f8d in Pa.responseHeaders?Pa.responseHeaders[cb.a.f8d]:""}`))}Sy(Na,Pa){Na="UnknownMethodName";let Oc=-1;void 0!==Pa.context&&null!==Pa.context&&(Na=Pa.context.methodName,Oc=Pa.context.communicationErrorRetryCount);const ge=Pa.duration,Ae=od.a(Pa.url);Pa=new be(Na,ge,Pa.totalOperationDuration,Pa.Uwe,Pa.pP,{EcsOperationDuration:-1,EcsRequestDuration:-1,
WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},Pa.poe,Pa.errors||[],Pa.httpStatus,Ae,Oc,!1,kd.a.PM(ge),this.oMd(null),-1,this.vza.PJa(),Pa.responseToCallbackTime);this.Eke(Pa)}Eke(Na){this.$S.xGh(Na);if(M.EwaSettings.Ra(212)){var Pa=Na.requestName;if(Pa!==cb.a.XJa&&"SetCell"!==Pa&&"FindRange"!==Pa&&"FindAll"!==Pa&&"FindCell"!==Pa)return}Pa=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Na.requestName||null===Na.requestName)&&Na.isPromotedUTRRequest;
Ee.xii(Na,Pa);this.$S.dwh(Na)}oMd(Na){var Pa;if(null===(Pa=null===Na||void 0===Na?void 0:Na.CollaborationResult)||void 0===Pa?0:Pa.Users)return Na.CollaborationResult.Users.length;Na=this.$.ea.Ut.length;return 0<Na?Na:1}static xii(Na,Pa){Pa?Kd.b().uXc(388829456,0,15,Na):(Pa=Sys.Serialization.JavaScriptSerializer.serialize(Na),K.ULS.sendTraceTag(388829456,0,50,Pa));if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Na.requestName&&null!==Na.requestName&&Na.isFullyLoggedKPIRequest){Pa=
new Map;Pa.set("isUserTriggeredRequest",Na.isUserTriggeredRequest.toString());Pa.set("requestDuration",Na.requestDuration.toString());Pa.set("totalOperationDuration",Na.totalOperationDuration.toString());Pa.set("requestTimeInQueue",Na.requestTimeInQueue.toString());Pa.set("requestInvokedTime",Na.requestInvokedTime.toString());Pa.set("ecsOperationDuration",Na.ecsOperationDuration.toString());Pa.set("ecsRequestDuration",Na.EcsRequestDuration.toString());Pa.set("wfeRequestDuration",Na.WfeRequestDuration.toString());
Pa.set("timeFromLastEcsFreeze",Na.TimeFromLastEcsFreeze.toString());Pa.set("duringLoadOnDemand",Na.DuringLoadOnDemand.toString());Pa.set("correlationID",Na.correlationID);Pa.set("errors",Na.errors.toString());Pa.set("httpStatus",Na.httpStatus.toString());if(Na.networkInfoData){var Oc=Na.networkInfoData;Pa.set("networkInfoData_bandwidthMps",void 0===Oc.bandwidthMps||null===Oc.bandwidthMps?"NA":Oc.bandwidthMps.toString());Pa.set("networkInfoData_rttMs",void 0===Oc.rttMs||null===Oc.rttMs?"NA":Oc.rttMs.toString());
Pa.set("networkInfoData_effectiveConnection",void 0===Oc.effectiveConnection||null===Oc.effectiveConnection?"NA":Oc.effectiveConnection)}Na.requestResourceTiming&&(Oc=Na.requestResourceTiming,Pa.set("requestResourceTiming_fetchStart",void 0===Oc.downloadDuration||null===Oc.downloadDuration?"NA":Oc.downloadDuration.toString()));Pa.set("communicationErrorRetryCount",Na.communicationErrorRetryCount.toString());Pa.set("successfulCall",Na.successfulCall.toString());Pa.set("isDocumentHidden",Na.isDocumentHidden.toString());
Pa.set("coauthorsCount",Na.coauthorsCount.toString());Pa.set("responseSize",Na.responseSize.toString());Pa.set("responseToCallbackTime",Na.responseToCallbackTime.toString());Kd.b().vVc(Na.requestName,Na.successfulCall,Pa)}}}Object(w.a)(Ee,"RequestStatistics",null,[]);var Ie=a(236),bf=a(64),Xe=a(266);class Ze{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=
null}}Object(w.a)(Ze,"OperationTypeStatisticsData",null,[]);class tf{constructor(Na,Pa){this.data=new Ze;this.data.operationName=Na;this.data.isUserOperation=Pa;this.data.totalCount=0;this.aYg=[];this.bYg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Aj(Na){this.data.totalCount<tf.NCd&&(this.aYg.push(Na.startToNextFrame),this.bYg.push(Na.startToResponseRenderEnd));this.data.totalCount++;
this.data.longestStartToNextFrame<Na.startToNextFrame&&(this.data.longestStartToNextFrame=Na.startToNextFrame);this.data.longestStartToResponse<Na.startToResponseRenderEnd&&(this.data.longestStartToResponse=Na.startToResponseRenderEnd)}BGd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.eKf(this.aYg),this.data.startToResponsePercentiles=this.eKf(this.bYg))}eKf(Na){Na.sort(qe.HelperMethods.uS);let Pa;Pa="("+kd.a.Pwa(Na,25).toString();Pa=Pa+", "+kd.a.Pwa(Na,50).toString();Pa=Pa+
", "+kd.a.Pwa(Na,75).toString();Pa=Pa+", "+kd.a.Pwa(Na,95).toString();return Pa+")"}}tf.NCd=1E3;Object(w.a)(tf,"OperationTypeStatistics",null,[]);class ff{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=
this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(w.a)(ff,"RequestTypeStatisticsData",null,[]);class ef{constructor(Na){this.data=new ff;this.data.requestName=Na;this.data.totalCount=0;this.nvb=[];this.Vxe=this.Lxe=this.Mxe=this.Sxe=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=
-1;this.data.requestDurationPercentile95=-1}Mqk(Na){this.data.totalCount<ef.NCd&&this.nvb.push(Na.requestDuration);this.data.totalCount++;this.Sxe+=Na.requestDuration;this.Mxe+=ef.yJd(Na.ecsOperationDuration);this.Lxe+=ef.yJd(Na.EcsRequestDuration);this.Vxe+=ef.yJd(Na.WfeRequestDuration);0<Na.TimeFromLastEcsFreeze&&Na.TimeFromLastEcsFreeze<ef.hAi&&this.data.callsDuringEcsFreeze++;Na.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Na.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;
if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<Na.requestDuration)this.data.longestRequest=Na}BGd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.Sxe/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.Mxe/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.Lxe/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.Vxe/this.data.successfulCalls)):
(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.nvb.sort(qe.HelperMethods.uS),this.data.requestDurationPercentile25=kd.a.Pwa(this.nvb,25),this.data.requestDurationPercentile50=kd.a.Pwa(this.nvb,50),this.data.requestDurationPercentile75=kd.a.Pwa(this.nvb,75),this.data.requestDurationPercentile95=kd.a.Pwa(this.nvb,95))}static yJd(Na){return 0>Na?0:Na}}ef.hAi=3E3;ef.NCd=1E3;Object(w.a)(ef,"RequestTypeStatistics",null,[]);class Sf{constructor(Na,
Pa,Oc,ge,Ae,Ye,Bf,Pf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Na;this.ocsCapable=Pa;this.endedBySplashScreen=Oc;this.dirtySessionOnLastRecordedRequest=ge;this.loadOnDemandCount=Ae;this.maxCoauthorsCount=Ye;this.everConnectedToOcs=Bf;Na=[];for(const mg in Pf)Pa=Pf[mg],Pa.BGd(),Na.push(Pa.data);this.requests=Na}}Object(w.a)(Sf,"SessionStatisticsData",
null,[]);class zf{constructor(Na){this.dirtySessionOnLastRecordedRequest=this.wue=!1;this.E7f=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Na;this.RGb={};this.QGb={};this.nAd={}}ej(){var Na=this.gai();if(na.a.yqa()){var Pa={};Pa.xlendJson=Na;this.$.eBa(Ie.a.afl,Pa,!1)}else bf.O(this.$.pa.ta,Na,null,null,null,null,null);Na=this.hai();na.a.yqa()?(Pa={},Pa.xlenoJson=Na,this.$.eBa(Ie.a.bfl,Pa,!1)):K.ULS.sendTraceTag(388776782,0,50,Na);Na=this.w5h();na.a.yqa()?(Pa={},Pa.xlencJson=Na,this.$.eBa(Ie.a.$el,
Pa,!1)):K.ULS.sendTraceTag(388776770,0,50,Na);this.Ark()}DJc(){this.everConnectedToOcs=this.$.ea.mpb||this.everConnectedToOcs;ub.Health.instance&&ub.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}Hm(){const Na=new Xe.a;let Pa="";const Oc=!this.$.isAnonymousUser(),ge=Na.zl();if(ge){if(Oc){Na.r7b("UMI_Linkable","true");return}Pa=Na.RZa("UMI_Linkable")}Oc||K.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${ge}, UMIIsLinkable:${!!Pa}`)}lvb(){this.wue=
!0}bqk(Na){this.dirtySessionOnLastRecordedRequest=Na}xGh(Na){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Na.coauthorsCount);ub.Health.instance&&ub.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}dwh(Na){if(!(Na.requestName in this.RGb)){const Pa=new ef(Na.requestName);this.RGb[Na.requestName]=Pa}this.RGb[Na.requestName].Mqk(Na)}cwh(Na){if(!(Na.name in this.QGb)){const Pa=new tf(Na.name,Na.isUserOperation);this.QGb[Na.name]=Pa}this.QGb[Na.name].Aj(Na)}O3(Na){this.nAd[Na.reportName]=
Na}Ark(){this.dirtySessionOnLastRecordedRequest=this.wue=!1;this.E7f=this.$.ea.l2d;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.RGb={};this.QGb={};this.nAd={}}gai(){const Na=new Sf(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.wue,this.dirtySessionOnLastRecordedRequest,this.$.ea.l2d-this.E7f,this.maxCoauthorsCount,this.everConnectedToOcs,this.RGb);return Sys.Serialization.JavaScriptSerializer.serialize(Na)}hai(){var Na=new bc.a;const Pa=this.QGb;for(const Oc in Pa){const ge=
Pa[Oc];ge.BGd();Na.add(ge.data)}Na=Na.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Na)}w5h(){return Sys.Serialization.JavaScriptSerializer.serialize(this.nAd)}}Object(w.a)(zf,"SessionStatistics",null,[]);class sf extends Wb.a{constructor(Na){super();this.MAa=this.Zza=null;this.mnf=Array(1);this.mfd=this.I3d=null;this.xp=(Pa,Oc)=>{M.EwaSettings.Ra(39)&&(this.MAa=this.MAa||new Ee(this.$,this.$S,this.vza),this.MAa.xp(Pa,Oc))};this.Sy=(Pa,Oc)=>{M.EwaSettings.Ra(39)&&(this.MAa=this.MAa||
new Ee(this.$,this.$S,this.vza),this.MAa.Sy(Pa,Oc))};this.ej=(Pa,Oc)=>{M.EwaSettings.Ra(39)&&this.$S.ej(Pa,Oc)};this.Hm=()=>{M.EwaSettings.Ra(39)&&this.$S.Hm()};this.DJc=(Pa,Oc)=>{M.EwaSettings.Ra(39)&&this.$S.DJc(Pa,Oc)};this.$=Na;M.EwaSettings.Ra(39)&&(kd.a.HUf(this.$),this.GY=new zc(this.$),this.p7h(),M.EwaSettings.Ra(505)&&this.Cqb&&(this.I3d=new re(this.$,this.Cqb)),this.$S=new zf(this.$),this.vza=new Ve(this.$),this.$.fq(this.ej),this.$.pa.yI(this.xp),this.$.pa.pX(this.Sy),this.$.ea.p4e(this.DJc),
M.EwaSettings.vl()?this.$.ea.Yq(this.Hm):this.$.ea.jr(this.Hm))}get Cqb(){return this.mfd}dispose(){this.$&&M.EwaSettings.Ra(39)&&(this.$.Wu(this.ej),this.$.pa.hL(this.xp),this.$.pa.pZ(this.Sy),this.$.ea.nFg(this.DJc),M.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.yv(this.Hm));l.a.dh(this.vza);l.a.dh(this.Cqb);this.mfd=null;l.a.dh(this.GY);this.GY=null;l.a.dh(this.I3d);this.$=this.I3d=null;super.dispose()}lvb(){M.EwaSettings.Ra(39)&&this.$S.lvb()}yVc(Na,Pa,Oc,ge,Ae,
Ye,Bf,Pf,mg,Jf,$f,Yf,ng,eg){M.EwaSettings.Ra(39)&&(this.MAa=this.MAa||new Ee(this.$,this.$S,this.vza),this.MAa.yVc(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf,mg,Jf,$f,Yf,ng,eg))}g5b(Na,Pa){M.EwaSettings.Ra(39)&&(this.Zza=this.Zza||new Uc(this.$,this.$S,this,this.GY),this.Zza.g5b(Na,Pa))}lVc(){M.EwaSettings.Ra(39)&&(this.Zza=this.Zza||new Uc(this.$,this.$S,this,this.GY),this.Zza.lVc())}uVc(){M.EwaSettings.Ra(39)&&(this.Zza=this.Zza||new Uc(this.$,this.$S,this,this.GY),this.Zza.uVc())}O3(Na){M.EwaSettings.Ra(39)&&this.$S.O3(Na)}GKd(Na){return M.EwaSettings.Ra(39)?
this.mnf[Na]:null}EOg(Na){Na&&(this.mnf[Na.type]=Na)}PJa(){return this.vza.PJa()}p7h(){Ka.a.Vv&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.mfd=new cd(this.$,this.GY))}}Object(w.a)(sf,"SessionStatisticsManager",Wb.a,[20]);var lf=a(122),Ra=a(1213),Lb=a(146);class Nc{constructor(Na,Pa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=
0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Na;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=
!1;this.wacSessionId=Pa}lxe(){return of.a.Ci(this)}}Object(w.a)(Nc,"AppUnloadInfo",null,[]);var Ed=a(908),Wd=a(119),$d=a(663);class se{constructor(Na){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Na.Cgf+Na.H3g;this.dataLossReason=Na.Bcf;this.PRh(Na.dBe)}PRh(Na){const Pa=new Ed.a($d.a.RU());let Oc=0,ge=0;for(const Ae of Na)Pa.kh(Ae)||Pa.ga(Ae,0),Na=Pa.ga(Ae,Pa.na(Ae)+1),Na>Oc&&(Oc=Na,ge=Ae);Oc>this.mostCommonOperationCount&&
(this.mostCommonOperationName=Wd.a(ge),this.mostCommonOperationCount=Oc)}}Object(w.a)(se,"DataLossInfo",null,[]);var Fa=a(70);class lb{constructor(Na){this.Cqd="AppUnloadInfo";this.au=this.$=this.workbookHashedId=this.zI=null;this.ZGe=this.tKe=!1;this.Il=null;this.aUf=0;this.qpa=(Pa,Oc)=>{this.aUf=Oc.o1c};this.gsg=(Pa,Oc)=>{Oc.dBe.length&&this.$.XU&&(this.zI.dataLossInfo=new se(Oc),this.zI.wasDataLostDuringUnload=!0,this.Vvb())};this.Hm=()=>{this.C6b();this.$.ea.yv(this.Hm)};this.gr=()=>{this.C6b();
this.$.ea.JA(this.gr)};this.X3a=()=>{this.zI.wasUpdatedOnBeforeUnload=!0;this.zI.inactivityDurationBeforeUnloadSeconds=this.Il.xyb<lb.qFj?this.aUf:this.Il.xyb;this.z6g()};this.F1b=()=>{this.zI.wasUpdatedOnUnload=!0;this.z6g();Sys.Application.remove_unload(this.F1b)};this.fQc=()=>{this.zI.lastSilentReopenStartTime=A.a.ih.si;this.zI.lastSilentReopenEndTime=null;this.Vvb();this.$.kr(this.v1b)};this.v1b=()=>{this.zI.lastSilentReopenEndTime=A.a.ih.si;this.Vvb();this.$.Wr(this.v1b)};this.localStorage=new Xe.a;
this.localStorage.zl()&&(this.$=Na,this.workbookHashedId=Fa.a(this.$),this.zI=new Nc(this.workbookHashedId,this.$.ua.UserSessionId),this.au=E.a.instance.tU(),this.au.Ba("beforeunload",this.X3a),this.$.userOperationManager.bFh(this.gsg),M.EwaSettings.isChangeGateEnabled("OfficeVSO:8779648_AppVisuallyReadyMigration-AppUnloadTelemetryManager")?Na.ea.jn?this.C6b():this.$.ea.jw(this.gr):Na.ea.lm?this.C6b():M.EwaSettings.vl()?this.$.ea.Yq(this.C6b):this.$.ea.jr(this.Hm),this.Il=this.$.ea.Il,this.Il.YFa(this.qpa),
Sys.Application.add_unload(this.F1b),this.$.ea.cIb(this.fQc))}get dialogPromptedOnUnload(){return this.tKe}set dialogPromptedOnUnload(Na){this.tKe=Na;this.zI?(this.zI.dialogPromptedOnUnload=Na,this.Vvb()):this.localStorage.zl()&&K.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.zl()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.ZGe}set apiBeforeCloseNotificationEnabledOnUnload(Na){this.ZGe=
Na;this.zI?(this.zI.apiBeforeCloseNotificationEnabledOnUnload=Na,this.Vvb()):this.localStorage.zl()&&K.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.zl()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.Cok(this.gsg);this.Il&&(this.Il.AOa(this.qpa),this.Il=null);this.au.TO();this.$=this.au=null}z6g(){this.cHk();this.Vvb()}cHk(){this.zI.wasOfflineDuringUnload=this.$.jm.hha;
this.zI.timeFromLastConnectivity=Lb.a(A.a.ih,this.$.jm.p6f);this.zI.timeFromLastDisconnectionStart=Lb.a(A.a.ih,this.$.jm.Wuj);this.zI.disconnectionSource=Enum.toString(Ra.a,this.$.jm.disconnectionSource);this.zI.hadConnectivityIssuesDuringUnload=this.$.jm.iya;this.zI.timeFromLastStatusCode0=Lb.a(A.a.ih,this.$.jm.o6f)}Vvb(){this.zI.timestamp=Date.now();this.localStorage.r7b(this.Cqd,this.zI.lxe())}C6b(){const Na=this.localStorage.RZa(this.Cqd);if(Na)try{const Pa=of.a.Rp(Na);this.localStorage.ZDg(this.Cqd);
const Oc=this.vDj(Pa);K.ULS.sendTraceTag(574677456,0,50,Oc)}catch(Pa){K.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Pa.message}`)}else K.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}vDj(Na){const Pa={};Pa.WACSessionID=Na.wacSessionId;Pa.wasRefreshed=this.qWh(Na,this.$.ua.MaxAppReloadDurationIndicatingRefresh);Pa.closedWithDialogConfirmation=Na.dialogPromptedOnUnload;
Pa.wasOfflineDuringUnload=Na.wasOfflineDuringUnload;Pa.TimeFromLastConnectivityMs=Na.timeFromLastConnectivity;Pa.TimeFromLastDisconnectionStart=Na.timeFromLastDisconnectionStart;Pa.wasDataLostDuringUnload=Na.wasDataLostDuringUnload;Pa.DataLossInfo=Na.dataLossInfo;Pa.flushedOnUnload=Na.wasUpdatedOnUnload;Pa.flushedOnBeforeUnload=Na.wasUpdatedOnBeforeUnload;Pa.InactivityDurationBeforeUnload=Na.inactivityDurationBeforeUnloadSeconds;Pa.DisconnectionSource=Na.disconnectionSource;Pa.hadConnectivityIssuesDuringUnload=
Na.hadConnectivityIssuesDuringUnload;Pa.TimeFromLastStatusCode0=Na.timeFromLastStatusCode0;Pa.LastSilentReopenStartTime=Na.lastSilentReopenStartTime;Pa.LastSilentReopenEndTime=Na.lastSilentReopenEndTime;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Pa.ApiBeforeCloseNotificationEnabledOnUnload=Na.apiBeforeCloseNotificationEnabledOnUnload);return Ja.c(Pa)}qWh(Na,Pa){const Oc=window.performance.timing.navigationStart-Na.timestamp;(Na=this.workbookHashedId===
Na.workbookHashedId&&Oc<Pa)&&K.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Na}static Ba(Na){Na.ea.Kh.inWebPart||Na.la.Hh(410,new lb(Na))}}lb.qFj=10;Object(w.a)(lb,"AppUnloadTelemetryManager",null,[582,2]);var d=a(12),H=a(29),ha=a(325);class Ta{constructor(Na){this.Znf=!1;this.aof=null;this.Jj=()=>{this.mvk();O.f(this.$).ha&&O.f(this.$).ha.hca(this.Jj)};this.vq=(Pa,Oc)=>{Oc.ma&&!this.Fwe.has(Oc.ma.name)&&(this.Fwe.add(Oc.ma.name),O.f(this.$).ha&&
(O.f(this.$).ha.hca(this.Jj),O.f(this.$).ha.R9(this.Jj)))};this.$=Na;this.R_g=new Set;this.Fwe=new Set;this.$.sa&&this.$.sa.ma&&this.Fwe.add(this.$.sa.ma.name);O.f(this.$).ha.R9(this.Jj);this.$.sa.pn(this.vq)}dispose(){this.$=null}mvk(){this.aof||this.$Rh();var Na=O.f(this.$);const Pa=[];for(var Oc of Na.iaa()){Na=Oc.domElement.getElementsByClassName(H.wb);for(let Ae=Na.length-1;0<=Ae;Ae--){var ge=Na[Ae].firstChild;(ge=ge?ha.b(ge.currentStyle):"")&&!Pa.includes(ge)&&Pa.push(ge)}}this.Znf||(Oc=d.a.instance.Ea(281).split(","),
Pa.push(...Oc),this.Znf=!0);for(const Ae of Pa)Ae&&!this.R_g.has(Ae)&&(this.Pzj(Ae),this.R_g.add(Ae))}Pzj(Na){this.xTh(Na)}$Rh(){this.aof=Ta.HJa("monospace");Ta.HJa("sans-serif");Ta.HJa("serif")}xTh(Na){Ta.HJa(`${Na},${"monospace"}`);Ta.HJa(`${Na},${"sans-serif"}`);Ta.HJa(`${Na},${"serif"}`)}static Ba(Na){if(M.EwaSettings.Ra(61)){const Pa=new Ta(Na);Na.la.Hh(210,Pa)}}static HJa(Na){const Pa=document.createElement("div"),Oc=document.createElement("div");Pa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";
Ta.OGk(Oc,Na);document.body.appendChild(Pa);Pa.appendChild(Oc);Oc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Na=Oc.offsetWidth+"x"+Oc.offsetHeight;document.body.removeChild(Oc.parentNode);return Na}static OGk(Na,Pa){Na.style.cssText="display: inline; visibility: hidden;";Na.style.fontSize="100px";Na.style.fontWeight="normal";Na.style.fontStyle="normal";Na.style.letterSpacing="normal";Na.style.lineHeight="normal";Na.style.whiteSpace="nowrap";Na.style.fontFamily=
Pa}}Object(w.a)(Ta,"FontTelemetryManager",null,[2]);var Mb=a(261),W=a(168),eb;(function(Na){Na[Na.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Na[Na.reactSingleLineRibbon=1]="reactSingleLineRibbon";Na[Na.reactMultiLineRibbon=2]="reactMultiLineRibbon";Na[Na.invalid=3]="invalid"})(eb||(eb={}));Object(w.b)("RibbonMode",eb);var Ib=a(133);class nc{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;
this.maxLongFrameDuration=-1}}Object(w.a)(nc,"FramePerformanceData",null,[]);class ta{constructor(Na){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new nc;this.l2FramePerformanceData=new nc;this.l3FramePerformanceData=new nc;this.name=Na}}Object(w.a)(ta,"FramePerformanceDataGroup",null,[]);class ob{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(w.a)(ob,"FramePerformanceSessionEndsReport",
null,[154]);class cc{constructor(Na){this.jbe={};this.$ta=null;this.szb=(Pa,Oc)=>{Pa.longFramesOverThresholdOps++;Pa.maxLongFrameDuration=Math.max(Pa.maxLongFrameDuration,Oc)};this.Tk=new ob;this.f8h();Na.la.fi(276,()=>{Lc.a(Na).O3(this.Tk)})}f8h(){this.$ta=new ta("AllGridOperationsData");this.Tk.operationsGroups.push(this.$ta);this.qMb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.qMb("DragScroll",["DragScroll"]);this.qMb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.qMb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.qMb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}Cqk(Na,Pa,Oc,ge){const Ae=this.yMi(Na);Ae&&(this.Tk.operationsGroups.some(Ye=>ja.a.equals(Ye.name,Ae.name,!1))||this.Tk.operationsGroups.push(Ae),Ae.count++,this.z3c(Pa,Ae),this.v3c(Oc,Ae),this.$ta.count++,
this.z3c(Pa,this.$ta),this.v3c(Oc,this.$ta),0<ge&&this.D8k(ge,Ae),0<=Pa&&this.N7k(Pa,Ae))}i9k(){for(const Na of this.Tk.operationsGroups)cc.V7k(Na)}qMb(Na,Pa){Na=new ta(Na);for(const Oc of Pa)this.jbe[Oc]=Na}yMi(Na){return Na in this.jbe?this.jbe[Na]:null}N7k(Na,Pa){30>Na&&this.tze(Oc=>{Oc.l1FramePerformanceData.fpsUnderThresholdOps++},Pa);15>Na&&this.tze(Oc=>{Oc.l2FramePerformanceData.fpsUnderThresholdOps++},Pa);5>Na&&this.tze(Oc=>{Oc.l3FramePerformanceData.fpsUnderThresholdOps++},Pa)}D8k(Na,Pa){100<=
Na&&(this.tzb(Pa.l1FramePerformanceData,Na,this.szb),this.tzb(this.$ta.l1FramePerformanceData,Na,this.szb));300<=Na&&(this.tzb(Pa.l2FramePerformanceData,Na,this.szb),this.tzb(this.$ta.l2FramePerformanceData,Na,this.szb));600<=Na&&(this.tzb(Pa.l3FramePerformanceData,Na,this.szb),this.tzb(this.$ta.l3FramePerformanceData,Na,this.szb))}tze(Na,Pa){Pa&&(Na(Pa),Na(this.$ta))}tzb(Na,Pa,Oc){Na&&Oc(Na,Pa)}z3c(Na,Pa){Pa.minFPS=-1===Pa.minFPS?Na:Math.min(Pa.minFPS,Na)}v3c(Na,Pa){Pa.maxFPS=Math.max(Pa.maxFPS,
Na)}static V7k(Na){cc.Zze(Na.l1FramePerformanceData,Na.count);cc.Zze(Na.l2FramePerformanceData,Na.count);cc.Zze(Na.l3FramePerformanceData,Na.count)}static Zze(Na,Pa){Na.fpsUnderThresholdOpsPercentage=100*Na.fpsUnderThresholdOps/Pa;Na.longFramesOverThresholdOpsPercentage=100*Na.longFramesOverThresholdOps/Pa}}Object(w.a)(cc,"FramePerformanceSessionEndsReportManager",null,[]);class qc{constructor(){this.f=null}}Object(w.a)(qc,"FpsDataWrapper",null,[]);class Wc{constructor(Na,Pa){this.duration=this.startSecond=
0;this.startSecond=void 0===Na?-1:Na;this.duration=void 0===Pa?-1:Pa}}Object(w.a)(Wc,"LongFrameData",null,[]);var id=a(395);class Bd{constructor(Na,Pa,Oc,ge,Ae,Ye,Bf,Pf,mg,Jf){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===Na?null:Na;this.count=void 0===Pa?0:Pa;this.start=void 0===Oc?-1:Oc;this.end=void 0===ge?-1:ge;this.Avg=void 0===Ae?0:Ae;this.Max=void 0===Ye?-1:Ye;this.Min=
id.a.dch;this.longFrameCount=void 0===Bf?0:Bf;this.coauth=(void 0===Pf?-1:Pf)||1;this.tfAppInt=void 0===mg?-1:mg;this.Props=void 0===Jf?null:Jf;this.LFrame=null}}Object(w.a)(Bd,"OperationFPSData",null,[]);var ke=a(976);class He extends Wb.a{constructor(Na,Pa){super();this.AIb=-1;this.U0d=0;this.XLa=new Date(0);this.j$=null;this.tva={};this.oIa=new bc.a;this.Kle=this.Qpb=!1;this.vkb=null;this.e1c=this.yza=0;this.isSynthetic=!1;this.bCf=()=>{const Oc=new Date;var ge=Oc.getMinutes();const Ae=Oc.getSeconds();
this.wYb&&Oc.getTime()-this.wYb.getTime()>this.IYk?(this.stop(),this.wHd(Oc)):(ge!==this.U0d&&(this.wHd(Oc),this.U0d=ge),this.Qpb&&(this.tk.un?this.j$[Ae]=He.Puc:(this.Kpf(Ae),this.Qpb=!1,this.oIa.clear(),this.tva={})),this.j$[Ae]!==He.Puc&&(this.j$[Ae]++,ge=Oc.getTime()-this.XLa.getTime(),ge>this.q$f&&this.mAj(this.XLa,ge)),this.AIb=window.requestAnimationFrame(this.bCf),this.XLa=Oc)};this.JP=()=>{this.Qpb=!0};this.Wgg=()=>{this.pause()};this.Xgg=()=>{this.Kle&&this.resume()};this.vp=()=>{this.za.a6()&&
this.M8k()};this.zoom=Pa;this.wYb=new Date;this.tk=new U;this.tk.Q9(this.JP);S.AFrameworkApplication.sod(this.Wgg);S.AFrameworkApplication.tod(this.Xgg);this.$=Na;this.q$f=Na.ua.LongFrameThresholdMs;this.hCj="MoreThan_"+this.q$f.toString()+"_Ms";this.HYk=Na.ua.ThresholdToEndOperationTrackingSeconds;this.IYk=Na.ua.ThresholdToStopFPSTrackingMS;this.za=O.f(this.$).za;S.AFrameworkApplication.hi&&S.AFrameworkApplication.hi.IsSynthetic&&(this.isSynthetic=ja.a.compare(S.AFrameworkApplication.hi[cb.a.isSynthetic],
"True",!0)?!1:!0);this.za.iy(this.vp);this.cle()}get zoomManager(){return this.zoom.zoomManager}start(){this.Kle=!0;this.resume()}stop(){this.Kle=!1;this.pause()}dispose(){this.stop();this.tk.w6a(this.JP);S.AFrameworkApplication.JEg(this.Wgg);S.AFrameworkApplication.KEg(this.Xgg);l.a.dh(this.tk);this.za.px(this.vp);super.dispose()}uUk(Na,Pa){const Oc=Na in this.tva?this.tva[Na]:null;this.wYb=new Date;this.start();const ge=this.wYb.getSeconds(),Ae=ge+this.HYk;Oc&&ge<=Oc.end?(Oc.count++,Oc.end=Ae):
(Oc&&ge>Oc.end&&this.oIa.add(Oc),this.tva[Na]=new Bd(Na,1,ge,Ae,void 0,void 0,void 0,this.$.ea.Ut.length,Qa.a.instance.vga(this.wYb),Pa))}q6h(){this.vkb||(this.wHd(new Date),this.vkb=new cc(this.$))}resume(){this.nZf()||!this.za.qZ||this.isSynthetic||(this.Qpb=this.tk.un,this.XLa=new Date,this.U0d=this.XLa.getMinutes(),this.cle(),this.Kpf(this.XLa.getSeconds()),this.AIb=window.requestAnimationFrame(this.bCf))}nZf(){return 0<=this.AIb}pause(){this.nZf()&&(this.Qpb||(this.Lpf((new Date).getSeconds()),
K.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.j$.toString()}`)),window.cancelAnimationFrame(this.AIb),this.AIb=-1)}wHd(Na){if(Na.getTime()-this.XLa.getTime()<He.kGj&&(this.Qpb&&this.Lpf(this.XLa.getSeconds()),this.Wki(),0<this.oIa.count&&(Na={},Na.NonEmptyCellsCount=this.yza,Na.TextCellsCount=this.e1c,Na.xlfpsJson=Object(qa.a)(new qc,{f:this.oIa.toArray()}),Na.memoryInfo=this.FFj(),Na.zoom=this.zoomManager?this.zoomManager.zoom:1,Na.RibbonMode=W.a(this.$)?eb[W.a(this.$).MS]:He.invalid,Na.deviceMemory=
navigator.deviceMemory||0,Na.hardwareConcurrency=navigator.hardwareConcurrency||0,Na=JSON.stringify(Na),K.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.j$.toString()}`),!this.isSynthetic))){if(na.a.yqa()){var Pa={};Pa.xlfpsJson=Na;this.$.eBa(Ie.a.cfl,Pa,!1)}else K.ULS.sendTraceTag(388781010,0,50,`${Na}`);for(const Oc of this.oIa){Pa=1E3>=this.yza?"0_1000":3E3>=this.yza?"1000_3000":"3000_inf";const ge=new Map;ge.set("Operation",Oc.Op);ge.set("BucketOfRenderedCells",Pa);ub.Health.instance.recordKpiUsage(Qe.a.longFrame,
Vb.b.FailureBased,Le.a.canvas,ge);0<Oc.longFrameCount&&ub.Health.instance.recordKpiFailure(Qe.a.longFrame,"LongFrame",!1,!0,{extendedProperties:ge});3E4<Oc.tfAppInt&&(0<Oc.longFrameCount?Kd.b().YGg(0,this.hCj,ge):Kd.b().ZGg(0,ge))}K.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${Na.length}`)}this.reset()}FFj(){const Na={};if(window.performance){const Pa=window.performance.memory;Pa&&(Na.jsHeapSizeLimit=Pa.jsHeapSizeLimit,Na.usedJSHeapSize=Pa.usedJSHeapSize,Na.totalJSHeapSize=Pa.totalJSHeapSize)}return Na}reset(){this.oIa.clear();
this.tva={};this.cle()}Wki(){var Na=!0;Na=void 0===Na?!0:Na;if(this.j$){for(const Pa of ke.a(this.tva)){const Oc=this.tva[Pa];Oc.end=Math.min(this.j$.length-1,Oc.end);this.oIa.add(Oc)}this.xSh(this.oIa,this.j$,Na)}}xSh(Na,Pa,Oc){Oc=void 0===Oc?!0:Oc;for(const ge of Na){let Ae=Na=0;if(ge.end<Pa.length){for(let Ye=ge.start;Ye<=ge.end;Ye++){const Bf=Pa[Ye];0<=Bf&&(ge.Max=Math.round(Math.max(ge.Max,Bf)),ge.Min=Math.round(Math.min(ge.Min,Bf)),Na+=Bf,Ae++)}0<Ae&&(ge.Avg=Math.round(Na/Ae));Oc&&this.vkb&&
this.vkb.Cqk(ge.Op,ge.Min,ge.Max,ge.LFrame?ge.LFrame.duration:-1);ge.Props&&(this.h3k(ge),ge.Props=null)}}Oc&&this.vkb&&this.vkb.i9k()}cle(){this.j$=Array(60).fill(0)}Kpf(Na){Na++;for(let Pa=0;Pa<Na;Pa++)this.j$[Pa]=He.Puc}Lpf(Na){for(;60>Na;Na++)this.j$[Na]=He.Puc}mAj(Na,Pa){Na=Na.getSeconds();var Oc=ke.a(this.tva);if(0<Oc.length)for(const ge of Oc)if(Oc=this.tva[ge],Na>=Oc.start&&Na<Oc.end)Oc.LFrame?Oc.LFrame.duration<Pa&&(Oc.LFrame.startSecond=Na,Oc.LFrame.duration=Pa,Oc.longFrameCount++):(Oc.LFrame=
new Wc(Na,Pa),Oc.longFrameCount++)}M8k(){this.e1c=this.yza=0;for(const Na of O.f(this.$).Uu){const Pa=Na.bRa;for(const Oc in Pa){const ge=this.za.Wn(Pa[Oc].hashCode);if(null===ge||void 0===ge?0:ge.jq)this.yza+=ge.Pj.NonEmptyCellsCount,this.e1c+=ge.Pj.TextValueCellsCount}}}h3k(Na){const Pa=Na.Props;if(Zc.a.$7b in Pa&&Pa[Zc.a.$7b]&&Zc.a.e$b in Pa){let Oc;(Oc=Object(hb.a)(Mb.a,Pa[Zc.a.e$b]))&&Oc.continueWith(ge=>{Ib.TextEditorTelemetry.instance.zyh(Na.Op,Na.Min,!!Na.LFrame,Na.LFrame?Na.LFrame.duration:
0,ge.result)})}}}He.Puc=-1;He.kGj=6E4;He.invalid="Invalid";Object(w.a)(He,"FramePerformanceTracker",Wb.a,[595,2]);class Tb extends tc.a{constructor(Na){super();this.$=Na;this.gm()}create(){let Na=this.$.la.lh(263);void D.a.resolve(N.ah).then(Pa=>{Na||(Na=this.$.la.Hh(263,new He(this.$,Pa)));this.Bk(Na)})}static Ba(Na){M.EwaSettings.isChangeGateEnabled("OfficeVSO:8759538_removeXLFPSTag")||Na.la.Hh(264,new Tb(Na))}}Object(w.a)(Tb,"FramePerformanceTrackerFactory",tc.a,[]);var Xc=a(1068);class Od{em(Na,
Pa){return new Xc.a(Na,Pa)}Li(Na,Pa){Na=this.em(Na,Pa);Na.start();return Na}}Object(w.a)(Od,"DefaultStopwatchBuilder",null,[826]);class ie{constructor(){this.UDa=new Od}em(Na,Pa){return this.UDa.em(Na,Pa)}Li(Na,Pa){return this.UDa.Li(Na,Pa)}}Object(w.a)(ie,"StopwatchBuilder",null,[826]);var Oe=a(355),Re=a(1092),hf=a(1221),Af;(function(Na){Na[Na.actions=0]="actions";Na[Na.correlationStart=1]="correlationStart";Na[Na.reorderSheetOp=2]="reorderSheetOp";Na[Na.formatCellOp=3]="formatCellOp";Na[Na.copyOp=
4]="copyOp";Na[Na.pasteOp=5]="pasteOp";Na[Na.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Na[Na.instantaneousSetData=7]="instantaneousSetData";Na[Na.immediateSetData=8]="immediateSetData";Na[Na.dependentCellsCalc=9]="dependentCellsCalc";Na[Na.dependentCellsGraphStat=10]="dependentCellsGraphStat";Na[Na.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Na[Na.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Na[Na.gridBlockUpdates=13]="gridBlockUpdates";
Na[Na.browserAppStart=14]="browserAppStart";Na[Na.linkedObjects=15]="linkedObjects";Na[Na.longFrames=16]="longFrames";Na[Na.task=17]="task";Na[Na.conflictInEditing=18]="conflictInEditing";Na[Na.incomingPresenceData=19]="incomingPresenceData";Na[Na.editorTableDelay=20]="editorTableDelay";Na[Na.presenceStartup=21]="presenceStartup";Na[Na.presenceDelete=22]="presenceDelete";Na[Na.editorEvent=23]="editorEvent";Na[Na.editorTime=24]="editorTime";Na[Na.gridScreenReaderOps=25]="gridScreenReaderOps";Na[Na.sendPresenceToService=
26]="sendPresenceToService";Na[Na.IME=27]="IME";Na[Na.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Na[Na.customizeStatusBar=29]="customizeStatusBar";Na[Na.clientWebRequests=30]="clientWebRequests";Na[Na.showCommentTaskPane=31]="showCommentTaskPane";Na[Na.applyThreadedCommentChange=32]="applyThreadedCommentChange";Na[Na.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Na[Na.findNextOrPreviousComment=34]="findNextOrPreviousComment";Na[Na.goto=35]="goto";Na[Na.launchOfficeAddInDialog=
36]="launchOfficeAddInDialog";Na[Na.richApiInvocation=37]="richApiInvocation";Na[Na.fxLibrary=38]="fxLibrary";Na[Na.embeddedApiSession=39]="embeddedApiSession";Na[Na.numberFormattingCalculator=40]="numberFormattingCalculator";Na[Na.requestDataAfterSend=41]="requestDataAfterSend";Na[Na.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Na[Na.copy=43]="copy";Na[Na.paste=44]="paste";Na[Na.dragDrop=45]="dragDrop";Na[Na.clearCopyState=46]="clearCopyState";Na[Na.webWorkerRecalcStats=47]="webWorkerRecalcStats";
Na[Na.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";Na[Na.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Na[Na.customSort=50]="customSort";Na[Na.namedSheetViewUserAction=51]="namedSheetViewUserAction";Na[Na.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Na[Na.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Na[Na.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Na[Na.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";
Na[Na.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";Na[Na.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";Na[Na.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";Na[Na.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(Af||(Af={}));Object(w.b)("UsageTable",Af);var ig=a(485),xg=a(546),jg=a(711),Wf=a(775),gg=a(311);class Eg extends Sys.EventArgs{constructor(){super();this.yJj=0;this.operation="DOMUpdate";this.sender=this.target=null}}
Object(w.a)(Eg,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Og{constructor(Na,Pa){this.Eme=void 0===Pa?1:Pa;this.total=Na}get average(){return this.total/this.Eme}yZh(Na){return new Og(this.total+Na.total,this.Eme+Na.Eme)}static iPh(Na,Pa){return`${Na}_${Pa}`}}Object(w.a)(Og,"StopwatchAverage",null,[]);var Yg;(function(Na){Na[Na.longFrame=0]="longFrame";Na[Na.longGetRange=1]="longGetRange";Na[Na.longJsTask=2]="longJsTask";Na[Na.viewportCalculationLoops=3]="viewportCalculationLoops"})(Yg||
(Yg={}));Object(w.b)("UtrKpiVeto",Yg);class uf{static Plb(Na){return Enum.toString(Yg,Na)}}uf.WQa="UTR";Object(w.a)(uf,"KpiConstants",null,[]);class Mf{}Mf.s8g="UTRVetoName";Mf.k8g="UTRErrorName";Mf.o8g="UTROperationName";Mf.k4c="UTRDuration";Mf.q8g="UTREndedInPhase";Mf.gBe="UTRMessage";Mf.r8g="UtrUnavailabilityType";Mf.operationName="OperationName";Mf.duration="Duration";Mf.message="Message";Object(w.a)(Mf,"UtrAdditionalData",null,[]);class og{}og.Xcl="VetoLike";og.Vrf="E2EOperationPerf";og.mrk=
"RequestPerf";og.g4k="UnavailabilityDurations";Object(w.a)(og,"UtrTypes",null,[]);class ih{e5b(Na,Pa,Oc){Oc=void 0===Oc?null:Oc;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Oc=Oc?{extendedProperties:Oc}:null,Na=uf.Plb(Na),ub.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Na,Pa,!1,!0,"",Oc))}K6b(Na,Pa,Oc,ge,Ae,Ye){Ye[uf.WQa]=og.Xcl;Ye[Mf.s8g]=uf.Plb(ge);Ye[Mf.k8g]=Ae;K.ULS.sendTraceTag(Na,Pa,Oc,of.a.Ci(Ye));delete Ye[uf.WQa];delete Ye[Mf.s8g];delete Ye[Mf.k8g]}}Object(w.a)(ih,
"UtrKpiVetoReporter",null,[]);class tg{Bke(Na,Pa){Pa=void 0===Pa?null:Pa;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||ub.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+uf.Plb(Na),Vb.b.FailureBased,"",Pa)}e5b(Na,Pa,Oc){Oc=void 0===Oc?null:Oc;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Na=uf.Plb(Na),ub.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Na,Pa,!1,!0,this.uyd(Oc)))}pqk(Na,Pa){Pa=void 0===Pa?null:Pa;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
ub.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+uf.Plb(Na),"",this.uyd(Pa))}oqk(Na,Pa,Oc){Oc=void 0===Oc?null:Oc;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Na=uf.Plb(Na),ub.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Na,Pa,!1,!0,"",this.uyd(Oc)))}uyd(Na){return Na?{extendedProperties:Na}:null}}Object(w.a)(tg,"UtrKpiVetoUsageReporter",null,[]);class Pg{mVc(Na,Pa,Oc){Oc=void 0===Oc?null:Oc;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
ub.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Na,"",{extendedProperties:Oc,durationMs:Pa})}vVc(Na,Pa,Oc){Oc=void 0===Oc?null:Oc;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Pa?ub.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+Na,"",{extendedProperties:Oc}):ub.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Na,"",!1,!1,"",{extendedProperties:Oc}))}H6b(Na,Pa,Oc,ge,Ae,Ye,Bf,...Pf){Bf=String.format(Bf,...Pf);Pf={};Pf[uf.WQa]=
og.Vrf;Pf[Mf.o8g]=ge;Pf[Mf.q8g]=Ae;Pf[Mf.k4c]=Ye;Pf[Mf.gBe]=Bf;K.ULS.sendTraceTag(Na,Pa,Oc,of.a.Ci(Pf))}tXc(Na,Pa,Oc,ge,Ae,Ye,Bf){const Pf={};Pf[uf.WQa]=og.Vrf;Pf[Mf.o8g]=ge;Pf[Mf.q8g]=Ae;Pf[Mf.k4c]=Ye;Pf[Mf.gBe]=Bf;K.ULS.sendTraceTag(Na,Pa,Oc,of.a.Ci(Pf))}J6b(Na,Pa,Oc,ge,Ae,Ye){this.dRg(Ye,ge,Ae);K.ULS.sendTraceTag(Na,Pa,Oc,of.a.Ci(Ye));this.vdi(Ye)}I6b(Na,Pa,Oc,ge,Ae,Ye,...Bf){Ye=String.format(Ye,...Bf);Bf={};this.dRg(Bf,ge,Ae,Ye);K.ULS.sendTraceTag(Na,Pa,Oc,of.a.Ci(Bf))}uXc(Na,Pa,Oc,ge){ge[uf.WQa]=
og.mrk;K.ULS.sendTraceTag(Na,Pa,Oc,of.a.Ci(ge));delete ge[uf.WQa]}dRg(Na,Pa,Oc,ge){ge=void 0===ge?null:ge;Na[uf.WQa]=og.g4k;Na[Mf.r8g]=Pa;Na[Mf.k4c]=Oc;ge&&(Na[Mf.gBe]=ge)}vdi(Na){delete Na[uf.WQa];delete Na[Mf.r8g];delete Na[Mf.k4c]}}Object(w.a)(Pg,"UtrOperationPerfReporter",null,[]);class qg extends y.a{constructor(Na,Pa,Oc,ge,Ae,Ye){Oc=void 0===Oc?null:Oc;ge=void 0===ge?null:ge;Ae=void 0===Ae?null:Ae;Ye=void 0===Ye?!1:Ye;super();this.Ksi=[Zc.a.raf,Zc.a.Yuf,Zc.a.Zuf,Zc.a.MEc,Zc.a.qLc,Zc.a.fyj,Zc.a.renderCachedContent,
Zc.a.renderServerContent,Zc.a.Ysc,Zc.a.twk,Zc.a.qLg,Zc.a.rLg,Zc.a.EAk];this.xFb=this.kSa=this.Iac=this.Izb=this.PRe=this.x$e=this.scb=this.$Ye=null;this.xug=this.paf=!1;this.n8g=this.m8g=this.p8g=this.Qke=this.M9g=null;this.upg=(Bf,Pf)=>{for(Bf=0;Bf<Pf.entries.length;Bf++){const Yf=Pf.entries[Bf];Yf.url=zb.a.removeParameter(Yf.url,S.AFrameworkApplication.UL);var mg=zb.a.fca(Yf.url);!M.EwaSettings.Ra(426)&&this.Jpj(Yf.url,mg)&&(Yf.behavior=1);if("img"===Yf.Qz.initiatorType&&mg.endsWith(Re.a.SCd)){var Jf=
zb.a.qga(Yf.url,Re.a.RCd),$f=zb.a.qga(Yf.url,Re.a.TCd);Yf.I4=`${Yf.I4}imageID=${Jf}, imgStateID=${$f}`}"css"===Yf.Qz.initiatorType&&"responseStatus"in Yf.Qz&&(Jf=`responseStatus=${Yf.Qz.responseStatus}`,Yf.I4=Yf.I4?`${Yf.I4},${Jf}`:Jf);Jf=Yf.Qz.transferSize;let ng;$f=Yf.Qz.decodedBodySize;void 0!==Jf&&null!==Jf&&void 0!==$f&&null!==$f?ng=0===Jf&&0<$f:void 0!==Jf&&null!==Jf&&(ng=0===Jf);Qa.a.instance.Jzh(mg,Math.round(Yf.Qz.fetchStart),Math.round(Yf.Qz.responseEnd),ng,this.trj);ja.a.contains(mg,Zc.a.richTextEditor,
!0)&&(mg=Ib.TextEditorTelemetry.instance,mg.gO(Zc.a.Usk,Math.round(Yf.Qz.fetchStart)),mg.gO(Zc.a.Wsk,Math.round(Yf.Qz.responseEnd)))}};this.JP=()=>{const Bf=this.eja;for(const Pf in Bf)Bf[Pf].h=!0};this.userSessionId=Na;this.zhb=Oc=Oc||new jg.a;this.Yp=ge||A.a.ih;this.nVk=Ae||this;this.trj=Ye;this.Snf=Oc.Oqb();M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void D.a.resolve(N.Cb).then(Bf=>{this.tk=Bf;this.tk.Q9(this.JP)}):(this.tk=new U,this.tk.Q9(this.JP),
Pa.Hh(291,this.tk))}get eja(){return this.$Ye||(this.$Ye={})}get Vmf(){return this.Izb||this.Snf}get fnf(){return this.kSa||qg.Zeg}get jve(){return this.x$e=this.x$e||{}}get nRc(){return this.scb||"undefined"===typeof Stw?this.scb:this.scb=Stw.swpc}get k$f(){return this.PRe=this.PRe||{}}get JOa(){return this.xFb||(this.xFb=C.a.instance.fj("Common.NetworkTiming.IResourceTimingLogger"))}get l8g(){return this.m8g||(this.m8g=new ih)}get j$a(){return this.p8g||(this.p8g=new Pg)}get l4c(){return this.n8g||
(this.n8g=new tg)}J_c(Na,Pa,Oc,ge,Ae){Ae=void 0===Ae?null:Ae;if(this.eja[Oc])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.eja[Oc]=this.tmf(Na,Pa,Oc,ge,Ae)}ewc(Na,Pa){const Oc=this.eja[Na];Oc&&(this.Thf(Oc,Pa),this.g6k(Oc),delete this.eja[Na])}wEg(Na){delete this.eja[Na]}cYg(Na,Pa){this.Izb||this.SXg(Na,Pa)}LXg(){this.cYg(qg.MPd,this.Yp.$j)}Dtf(Na,Pa){Pa=void 0===Pa?!1:Pa;if(this.Izb){if(this.kSa===qg.Bbe||this.kSa===qg.MPd){const Oc=kb.a.instance;Oc.userSessionId=
this.userSessionId;if(this.kSa===qg.Bbe){this.paf||(this.Poa(Na.m,Object(xd.a)(Oc,Oc.Afk,"recordContentFetchEnd")),this.paf=!0);if(Pa){this.xug||(this.Poa(Na.m,Object(xd.a)(Oc,Oc.Pfk,"recordPerceivedContentDisplayed")),this.xug=!0);return}this.Poa(Na.m,Object(xd.a)(Oc,Oc.zfk,"recordContentDisplayed"))}else this.kSa===qg.MPd&&(Pa=this.eja[this.Iac])&&this.Poa(gg.a(Na,Pa.s),Object(xd.a)(Oc,Oc.Jfk,"recordInteractivityContentDisplayed"),!1)}this.ewc(this.Iac,Na);this.Iac=this.kSa=this.Izb=null}}Poa(Na,
Pa,Oc){Oc=void 0===Oc?!0:Oc;kb.a.i4&&Object(Oe.a)(Wf.PerformanceClock,A.a.ih)&&Oc&&(Na+=window.performance.timing.navigationStart);Pa(Na)}zp(Na){return ig.a(Na)}Ll(Na,Pa,Oc){Oc=void 0===Oc?!1:Oc;try{if(this.k$f[Af[Na]]=!0,Oc){var ge=K.ULS,Ae=ge.sendTraceTag;const Hd={};let rg=null;switch(Na){case 0:rg="Actions";var Ye=Pa.a;null!=Ye&&(Hd.Id=Ye);var Bf=null==Pa.b?null:Pa.b;null!=Bf&&(Hd.Operation=Bf);var Pf=Pa.c;null!=Pf&&(Hd.Target=Pf);var mg=null==Pa.d?null:Pa.d.toString();null!=mg&&(Hd.StartTime=
mg);var Jf=null==Pa.e?null:Pa.e.toString();null!=Jf&&(Hd.Duration=Jf);var $f=Pa.f;null!=$f&&(Hd.CorrelationId=$f);var Yf=Pa.g;null!=Yf&&(Hd.ParentAction=Yf);var ng=null==Pa.h?null:Pa.h.toString();null!=ng&&(Hd.DocumentHidden=ng);break;case 1:rg="CorrelationStart";var eg=Pa.a;null!=eg&&(Hd.CorrelationId=eg);var Ig=Pa.b;null!=Ig&&(Hd.UserSessionId=Ig);var Ug=Pa.c;null!=Ug&&(Hd.UserAction=Ug);break;case 2:rg="ReorderSheetOp";var Cg=Pa.a;null!=Cg&&(Hd.UserSessionId=Cg);var eh=null==Pa.b?null:Pa.b.toString();
null!=eh&&(Hd.IsDragReorder=eh);var Fh=null==Pa.c?null:Pa.c.toString();null!=Fh&&(Hd.DocumentUp=Fh);var bh=null==Pa.d?null:Pa.d.toString();null!=bh&&(Hd.OldIndex=bh);var Rg=null==Pa.e?null:Pa.e.toString();null!=Rg&&(Hd.NewIndex=Rg);var Vg=null==Pa.f?null:Pa.f.toString();null!=Vg&&(Hd.TotalSheets=Vg);break;case 3:rg="FormatCellOp";var fh=Pa.a;null!=fh&&(Hd.UserSessionId=fh);var hh=null==Pa.b?null:Pa.b.toString();null!=hh&&(Hd.TaskId=hh);var Gh=null==Pa.c?null:Pa.c.toString();null!=Gh&&(Hd.NumberOfRanges=
Gh);var vh=Pa.d;null!=vh&&(Hd.Ranges=vh);var Hh=Pa.e;null!=Hh&&(Hd.ActiveCell=Hh);var Zg=null==Pa.f?null:Pa.f.toString();null!=Zg&&(Hd.ActionId=Zg);var pg=Pa.g;null!=pg&&(Hd.CommandParameters=pg);var $g=Pa.h;null!=$g&&(Hd.UserActionStopwatchId=$g);break;case 4:rg="CopyOp";var Sg=Pa.a;null!=Sg&&(Hd.UserSessionId=Sg);var di=null==Pa.b?null:Pa.b.toString();null!=di&&(Hd.IsChrome=di);var Wg=null==Pa.c?null:Pa.c.toString();null!=Wg&&(Hd.IsIE=Wg);var Fg=null==Pa.d?null:Pa.d.toString();null!=Fg&&(Hd.IsFromUI=
Fg);var zg=null==Pa.e?null:Pa.e.toString();null!=zg&&(Hd.IsCopyInLoadedRange=zg);var Ma=null==Pa.f?null:Pa.f.toString();null!=Ma&&(Hd.IsRepeatedCopy=Ma);var Pb=null==Pa.g?null:Pa.g.toString();null!=Pb&&(Hd.IsClipboarAccessSupported=Pb);var wc=null==Pa.h?null:Pa.h.toString();null!=wc&&(Hd.IsClipboarAccessInstallationSupported=wc);var Pc=null==Pa.i?null:Pa.i.toString();null!=Pc&&(Hd.RibbonCommand=Pc);var md=null==Pa.j?null:Pa.j.toString();null!=md&&(Hd.CutCopyPasteFlags=md);var Yd=null==Pa.k?null:Pa.k.toString();
null!=Yd&&(Hd.IsDrag=Yd);var oe=null==Pa.l?null:Pa.l.toString();null!=oe&&(Hd.IsIeBeforeAlowDenyPopUp=oe);var ca=Pa.m;null!=ca&&(Hd.IsPasteMatchCopy=ca);var Eb=Pa.n;null!=Eb&&(Hd.WaitMessageInClipboard=Eb);var Fc=null==Pa.o?null:Pa.o.toString();null!=Fc&&(Hd.CallCount=Fc);break;case 5:rg="PasteOp";var nd=Pa.a;null!=nd&&(Hd.UserSessionId=nd);var he=null==Pa.b?null:Pa.b.toString();null!=he&&(Hd.IsChrome=he);var Xd=null==Pa.c?null:Pa.c.toString();null!=Xd&&(Hd.IsIE=Xd);var Fe=null==Pa.d?null:Pa.d.toString();
null!=Fe&&(Hd.IsCopyActive=Fe);var jf=null==Pa.e?null:Pa.e.toString();null!=jf&&(Hd.IsFromUI=jf);var cf=null==Pa.f?null:Pa.f.toString();null!=cf&&(Hd.IsClipboarAccessSupported=cf);var wf=null==Pa.g?null:Pa.g.toString();null!=wf&&(Hd.IsClipboarAccessInstallationSupported=wf);var ag=null==Pa.h?null:Pa.h.toString();null!=ag&&(Hd.RibbonCommand=ag);var ug=null==Pa.i?null:Pa.i.toString();null!=ug&&(Hd.CutCopyPasteFlags=ug);var vg=Pa.j;null!=vg&&(Hd.WaitMessageInClipboard=vg);var ah=Pa.k;null!=ah&&(Hd.PopupDialog=
ah);var Hg=Pa.l;null!=Hg&&(Hd.SimplePopupMessage=Hg);var We=Pa.m;null!=We&&(Hd.DialogCloseButton=We);var Q=Pa.n;null!=Q&&(Hd.UserPressedInstallLink=Q);var Ca=null==Pa.o?null:Pa.o.toString();null!=Ca&&(Hd.CallCount=Ca);break;case 6:rg="GetNumberViewModelDataOp";var ib=Pa.a;null!=ib&&(Hd.UserSessionId=ib);var kc=Pa.b;null!=kc&&(Hd.NumberFormatOptionsPreviousOutputJson=kc);var Sc=Pa.c;null!=Sc&&(Hd.NumberFormatOptionsNewInputJson=Sc);break;case 7:rg="InstantaneousSetData";var ld=Pa.a;null!=ld&&(Hd.Id=
ld);var vd=null==Pa.b?null:Pa.b.toString();null!=vd&&(Hd.WasEmpty=vd);var Y=null==Pa.c?null:Pa.c.toString();null!=Y&&(Hd.ValueNotChanged=Y);var Ha=Pa.d;null!=Ha&&(Hd.Source=Ha);var Hb=null==Pa.e?null:Pa.e.toString();null!=Hb&&(Hd.ProcessingCompleted=Hb);break;case 8:rg="ImmediateSetData";var Zb=Pa.a;null!=Zb&&(Hd.ClientStopwatchId=Zb);var dd=Pa.b;null!=dd&&(Hd.Operation=dd);var Pd=Pa.c;null!=Pd&&(Hd.Parameters=Pd);var de=null==Pa.d?null:Pa.d.toString();null!=de&&(Hd.WasUpdatedByImmediate=de);var xe=
null==Pa.e?null:Pa.e.toString();null!=xe&&(Hd.areHtmlElementsEqualClientComparison=xe);var Pe=null==Pa.f?null:Pa.f.toString();null!=Pe&&(Hd.WasDecisionMadeByHtmlComparison=Pe);var Ne=null==Pa.g?null:Pa.g.toString();null!=Ne&&(Hd.IsNumeric=Ne);var gf=null==Pa.h?null:Pa.h.toString();null!=gf&&(Hd.IsDateTime=gf);var Lf=null==Pa.i?null:Pa.i.toString();null!=Lf&&(Hd.HasCurrencySymbol=Lf);var Uf=null==Pa.j?null:Pa.j.toString();null!=Uf&&(Hd.HasPercentSymbol=Uf);var dg=null==Pa.k?null:Pa.k.toString();null!=
dg&&(Hd.IsFunc=dg);var df=null==Pa.l?null:Pa.l.toString();null!=df&&(Hd.DiffInWrappingWhitespace=df);var Ff=Pa.m;null!=Ff&&(Hd.ImmediatePattern=Ff);var Vf=null==Pa.n?null:Pa.n.toString();null!=Vf&&(Hd.TextAlignmentMatch=Vf);var Xf=null==Pa.o?null:Pa.o.toString();null!=Xf&&(Hd.FontColorMatch=Xf);var Ag=null==Pa.p?null:Pa.p.toString();null!=Ag&&(Hd.FormulaTextMatch=Ag);var ch=null==Pa.q?null:Pa.q.toString();null!=ch&&(Hd.isFormula=ch);var vf=Pa.r;null!=vf&&(Hd.FormulaText=vf);var wh=Pa.s;null!=wh&&
(Hd.InstantaneousPattern=wh);var mh=null==Pa.t?null:Pa.t.toString();null!=mh&&(Hd.AreHtmlInnerTextElementsEqualClientComparison=mh);var Ih=Pa.u;null!=Ih&&(Hd.HtmlComparisonDecision=Ih);break;case 9:rg="DependentCellsCalc";var ph=Pa.a;null!=ph&&(Hd.CalcStatus=ph);var Xh=null==Pa.b?null:Pa.b.toString();null!=Xh&&(Hd.SuccessfullyCalculatedRanges=Xh);var Di=null==Pa.c?null:Pa.c.toString();null!=Di&&(Hd.RangesSkipped=Di);var Oi=null==Pa.d?null:Pa.d.toString();null!=Oi&&(Hd.TotalErrors=Oi);var Yh=null==
Pa.e?null:Pa.e.toString();null!=Yh&&(Hd.Partial=Yh);var Ei=null==Pa.f?null:Pa.f.toString();null!=Ei&&(Hd.Canceled=Ei);var Fi=null==Pa.g?null:Pa.g.toString();null!=Fi&&(Hd.Aggregate=Fi);var sh=null==Pa.h?null:Pa.h.toString();null!=sh&&(Hd.Unknown=sh);var Gi=null==Pa.i?null:Pa.i.toString();null!=Gi&&(Hd.UnavailableData=Gi);var mi=null==Pa.j?null:Pa.j.toString();null!=mi&&(Hd.Cycle=mi);var Ti=null==Pa.k?null:Pa.k.toString();null!=Ti&&(Hd.NotImplemented=Ti);var ri=null==Pa.l?null:Pa.l.toString();null!=
ri&&(Hd.InvalidInput=ri);var ei=null==Pa.m?null:Pa.m.toString();null!=ei&&(Hd.AreDepCells=ei);break;case 10:rg="DependentCellsGraphStat";var nh=null==Pa.a?null:Pa.a.toString();null!=nh&&(Hd.ParsedFormulas=nh);var vi=null==Pa.b?null:Pa.b.toString();null!=vi&&(Hd.GraphNodes=vi);var wi=null==Pa.c?null:Pa.c.toString();null!=wi&&(Hd.GraphArcs=wi);var Hi=null==Pa.d?null:Pa.d.toString();null!=Hi&&(Hd.AnalyzedBlocks=Hi);var Ph=null==Pa.e?null:Pa.e.toString();null!=Ph&&(Hd.IterationId=Ph);var bg=Pa.f;null!=
bg&&(Hd.UniqueId=bg);var Mg=null==Pa.g?null:Pa.g.toString();null!=Mg&&(Hd.Aborted=Mg);break;case 11:rg="DependentCellsGraphSectionStat";var Qh=null==Pa.a?null:Pa.a.toString();null!=Qh&&(Hd.IterationId=Qh);var jh=Pa.b;null!=jh&&(Hd.BlockHash=jh);var Kh=Pa.c;null!=Kh&&(Hd.Functions=Kh);var Lh=Pa.d;null!=Lh&&(Hd.Operators=Lh);var xi=null==Pa.e?null:Pa.e.toString();null!=xi&&(Hd.CrossDocRefs=xi);var oh=null==Pa.f?null:Pa.f.toString();null!=oh&&(Hd.CrossSheetRefs=oh);var Qd=null==Pa.g?null:Pa.g.toString();
null!=Qd&&(Hd.ErrRefs=Qd);var we=null==Pa.h?null:Pa.h.toString();null!=we&&(Hd.LargeRanges=we);var qh=null==Pa.i?null:Pa.i.toString();null!=qh&&(Hd.NameRefs=qh);var Jg=null==Pa.j?null:Pa.j.toString();null!=Jg&&(Hd.ParserErrors=Jg);var Ii=null==Pa.k?null:Pa.k.toString();null!=Ii&&(Hd.RowRefs=Ii);var yi=null==Pa.l?null:Pa.l.toString();null!=yi&&(Hd.ColumnRefs=yi);var Bh=null==Pa.m?null:Pa.m.toString();null!=Bh&&(Hd.TableRefs=Bh);var Ji=Pa.n;null!=Ji&&(Hd.UniqueId=Ji);var Mh=null==Pa.o?null:Pa.o.toString();
null!=Mh&&(Hd.UnreachableReferences=Mh);break;case 12:rg="GetRangeContentPrefetchFailures";var Ki=Pa.a;null!=Ki&&(Hd.UserSessionId=Ki);var Zh=Pa.b;null!=Zh&&(Hd.ClientStopwatchId=Zh);var th=null==Pa.c?null:Pa.c.toString();null!=th&&(Hd.StateId=th);break;case 13:rg="GridBlockUpdates";var lj=Pa.a;null!=lj&&(Hd.UserSessionId=lj);var Qi=Pa.b;null!=Qi&&(Hd.CorrelationId=Qi);var hi=Pa.c;null!=hi&&(Hd.Operation=hi);var Lg=null==Pa.d?null:Pa.d.toString();null!=Lg&&(Hd.PerformanceType=Lg);var xh=Pa.e;null!=
xh&&(Hd.BlockHash=xh);var bj=null==Pa.f?null:Pa.f.toString();null!=bj&&(Hd.DurationInMs=bj);break;case 14:rg="BrowserAppStart";var yh=null==Pa.a?null:hf.a.oXa(Pa.a.getTime());null!=yh&&(Hd.ScriptExecutionStart=yh);var zi=Pa.b;null!=zi&&(Hd.UserSessionId=zi);var Ch=Pa.c;null!=Ch&&(Hd.ClockMechanism=Ch);var zh=null==Pa.d?null:Pa.d.toString();null!=zh&&(Hd.ScreenDPI=zh);var Th=null==Pa.e?null:Pa.e.toString();null!=Th&&(Hd.NavigationToScriptExecutionDelta=Th);break;case 15:rg="LinkedObjects";var Rh=Pa.a;
null!=Rh&&(Hd.ChildId=Rh);var mj=Pa.b;null!=mj&&(Hd.ParentId=mj);var Rf=Pa.c;null!=Rf&&(Hd.ChildTable=Rf);var ii=Pa.d;null!=ii&&(Hd.ParentTable=ii);break;case 16:rg="LongFrames";var Xg=null==Pa.a?null:hf.a.oXa(Pa.a.getTime());null!=Xg&&(Hd.StartTime=Xg);var dh=null==Pa.b?null:Pa.b.toString();null!=dh&&(Hd.DurationInMs=dh);break;case 17:rg="Task";var kh=Pa.a;null!=kh&&(Hd.StopwatchId=kh);var ni=null==Pa.b?null:Pa.b.toString();null!=ni&&(Hd.Status=ni);var Uh=null==Pa.c?null:Pa.c.toString();null!=Uh&&
(Hd.CreateTime=Uh);var Ui=null==Pa.d?null:Pa.d.toString();null!=Ui&&(Hd.TaskId=Ui);break;case 18:rg="ConflictInEditing";var ji=Pa.a;null!=ji&&(Hd.OtherUserState=ji);var Vi=Pa.b;null!=Vi&&(Hd.UserSessionId=Vi);var cj=null==Pa.c?null:hf.a.oXa(Pa.c.getTime());null!=cj&&(Hd.ConflictTime=cj);break;case 19:rg="IncomingPresenceData";var oi=Pa.a;null!=oi&&(Hd.UserSessionId=oi);var $h=Pa.b;null!=$h&&(Hd.UserId=$h);var nj=null==Pa.c?null:Pa.c.toString();null!=nj&&(Hd.Disconnected=nj);var dj=null==Pa.d?null:
hf.a.oXa(Pa.d.getTime());null!=dj&&(Hd.ReceivedTime=dj);break;case 20:rg="EditorTableDelay";var Ai=Pa.a;null!=Ai&&(Hd.UserSessionId=Ai);var ai=Pa.b;null!=ai&&(Hd.UserId=ai);var ej=null==Pa.c?null:Pa.c.toString();null!=ej&&(Hd.Received=ej);var Wi=null==Pa.d?null:Pa.d.toString();null!=Wi&&(Hd.DurationInMs=Wi);var $e=null==Pa.e?null:Pa.e.toString();null!=$e&&(Hd.NotAloneAtLogTime=$e);var uh=null==Pa.f?null:hf.a.oXa(Pa.f.getTime());null!=uh&&(Hd.Time=uh);break;case 21:rg="PresenceStartup";var fj=Pa.a;
null!=fj&&(Hd.UserSessionId=fj);var oj=null==Pa.b?null:Pa.b.toString();null!=oj&&(Hd.EverReceived=oj);var Xi=null==Pa.c?null:Pa.c.toString();null!=Xi&&(Hd.NotAloneOnOpen=Xi);var si=null==Pa.d?null:Pa.d.toString();null!=si&&(Hd.NotAloneAtLogTime=si);var nf=null==Pa.e?null:Pa.e.toString();null!=nf&&(Hd.EditorCount=nf);var gj=null==Pa.f?null:Pa.f.toString();null!=gj&&(Hd.WorkbookOpenToFirstReceivedInMs=gj);break;case 22:rg="PresenceDelete";var Bi=Pa.a;null!=Bi&&(Hd.UserSessionId=Bi);var sj=Pa.b;null!=
sj&&(Hd.UserId=sj);var yg=Pa.c;null!=yg&&(Hd.Context=yg);var ti=Pa.d;null!=ti&&(Hd.Reason=ti);var hj=null==Pa.e?null:hf.a.oXa(Pa.e.getTime());null!=hj&&(Hd.Time=hj);break;case 23:rg="EditorEvent";var Dg=Pa.a;null!=Dg&&(Hd.UserSessionId=Dg);var Dh=Pa.b;null!=Dh&&(Hd.UserId=Dh);var Li=Pa.c;null!=Li&&(Hd.Context=Li);var Ci=null==Pa.d?null:hf.a.oXa(Pa.d.getTime());null!=Ci&&(Hd.Time=Ci);break;case 24:rg="EditorTime";var Mi=Pa.a;null!=Mi&&(Hd.UserSessionId=Mi);var Nh=Pa.b;null!=Nh&&(Hd.UserId=Nh);var pi=
null==Pa.c?null:Pa.c.toString();null!=pi&&(Hd.DurationInMs=pi);break;case 25:rg="GridScreenReaderOps";var bi=Pa.a;null!=bi&&(Hd.UserSessionId=bi);var Oh=Pa.b;null!=Oh&&(Hd.CommandTaskId=Oh);var Ah=null==Pa.c?null:Pa.c.toString();null!=Ah&&(Hd.CommandId=Ah);var qi=null==Pa.d?null:Pa.d.toString();null!=qi&&(Hd.ClientSideOnly=qi);var P=null==Pa.e?null:Pa.e.toString();null!=P&&(Hd.DurationInMS=P);var pa=null==Pa.f?null:Pa.f.toString();null!=pa&&(Hd.ReachedMaxReadoutCells=pa);var Wa=null==Pa.g?null:Pa.g.toString();
null!=Wa&&(Hd.RequstedCellCount=Wa);var Sb=null==Pa.h?null:Pa.h.toString();null!=Sb&&(Hd.NonEmptyCellCount=Sb);var ec=null==Pa.i?null:Pa.i.toString();null!=ec&&(Hd.Succeeded=ec);var Jc=null==Pa.j?null:Pa.j.toString();null!=Jc&&(Hd.Canceled=Jc);var td=Pa.k;null!=td&&(Hd.ErrorType=td);break;case 26:rg="SendPresenceToService";var Jd=Pa.a;null!=Jd&&(Hd.UserSessionId=Jd);var le=null==Pa.b?null:Pa.b.toString();null!=le&&(Hd.TotalCount=le);var Be=null==Pa.c?null:Pa.c.toString();null!=Be&&(Hd.SendCount=Be);
break;case 27:rg="IME";var Te=Pa.a;null!=Te&&(Hd.UserSessionId=Te);break;case 28:rg="FreezePaneFloatingObjects";var kf=Pa.a;null!=kf&&(Hd.UserSessionId=kf);var yf=null==Pa.b?null:Pa.b.toString();null!=yf&&(Hd.ObjectType=yf);var Zf=Pa.c;null!=Zf&&(Hd.ObjectID=Zf);var kg=null==Pa.d?null:Pa.d.toString();null!=kg&&(Hd.SpannedPanesCount=kg);break;case 29:rg="CustomizeStatusBar";var Bg=Pa.a;null!=Bg&&(Hd.UserSessionId=Bg);var Ng=Pa.b;null!=Ng&&(Hd.UIControlName=Ng);var F=null==Pa.c?null:Pa.c.toString();
null!=F&&(Hd.IsControlVisible=F);break;case 30:rg="ClientWebRequests";var ua=Pa.a;null!=ua&&(Hd.Path=ua);var jb=Pa.b;null!=jb&&(Hd.ProxyStopwatchId=jb);var pc=Pa.c;null!=pc&&(Hd.RequestStatus=pc);var Vc=null==Pa.d?null:Pa.d.toString();null!=Vc&&(Hd.ResponseSizeInBytes=Vc);var pd=Pa.e;null!=pd&&(Hd.ClientRequestId=pd);var gd=null==Pa.f?null:Pa.f.toString();null!=gd&&(Hd.StateId=gd);break;case 31:rg="ShowCommentTaskPane";var Md=Pa.a;null!=Md&&(Hd.UserSessionId=Md);var ze=null==Pa.b?null:Pa.b.toString();
null!=ze&&(Hd.IsFromKeyboardShortcut=ze);var T=null==Pa.c?null:Pa.c.toString();null!=T&&(Hd.IsShowPane=T);var Za=null==Pa.d?null:Pa.d.toString();null!=Za&&(Hd.ShowForDeepLink=Za);var Bb=null==Pa.e?null:Pa.e.toString();null!=Bb&&(Hd.DeepLinkFound=Bb);break;case 32:rg="ApplyThreadedCommentChange";var Gc=Pa.a;null!=Gc&&(Hd.UserSessionId=Gc);var qd=null==Pa.b?null:Pa.b.toString();null!=qd&&(Hd.Operation=qd);var Rd=Pa.c;null!=Rd&&(Hd.CommentId=Rd);var je=null==Pa.d?null:Pa.d.toString();null!=je&&(Hd.CommentsCount=
je);break;case 33:rg="UpgradeLegacyCommentsChange";var Ge=Pa.a;null!=Ge&&(Hd.UserSessionId=Ge);var af=null==Pa.b?null:Pa.b.toString();null!=af&&(Hd.OperationSuccessful=af);break;case 34:rg="FindNextOrPreviousComment";var mf=Pa.a;null!=mf&&(Hd.UserSessionId=mf);var Tf=null==Pa.b?null:Pa.b.toString();null!=Tf&&(Hd.Succeeded=Tf);break;case 35:rg="Goto";var wg=Pa.a;null!=wg&&(Hd.UserSessionId=wg);var Gg=null==Pa.b?null:Pa.b.toString();null!=Gg&&(Hd.IsSucceeded=Gg);var Qg=null==Pa.c?null:Pa.c.toString();
null!=Qg&&(Hd.IsNOVMode=Qg);break;case 36:rg="LaunchOfficeAddInDialog";var fi=Pa.a;null!=fi&&(Hd.UserSessionId=fi);var Jh=Pa.b;null!=Jh&&(Hd.SourceId=Jh);var gi=Pa.c;null!=gi&&(Hd.SourceLabel=gi);var Pi=Pa.d;null!=Pi&&(Hd.Flight=Pi);var kj=Pa.e;null!=kj&&(Hd.Experiment=kj);var Yi=Pa.f;null!=Yi&&(Hd.UICultureTag=Yi);var xj=null==Pa.g?null:Pa.g.toString();null!=xj&&(Hd.UICultureTagLcid=xj);var ci=null==Pa.h?null:Pa.h.toString();null!=ci&&(Hd.WacHostId=ci);break;case 37:rg="RichApiInvocation";var Ni=
Pa.a;null!=Ni&&(Hd.UserSessionId=Ni);var Aj=null==Pa.b?null:Pa.b.toString();null!=Aj&&(Hd.Succeeded=Aj);var mk=Pa.c;null!=mk&&(Hd.ErrorType=mk);var nk=Pa.d;null!=nk&&(Hd.ResultInfo=nk);var Bk=Pa.e;null!=Bk&&(Hd.Source=Bk);break;case 38:rg="FxLibrary";var Bj=Pa.a;null!=Bj&&(Hd.EntityName=Bj);var Cj=null==Pa.b?null:Pa.b.toString();null!=Cj&&(Hd.EntryPoint=Cj);var pj=null==Pa.c?null:Pa.c.toString();null!=pj&&(Hd.Action=pj);var Mj=null==Pa.d?null:Pa.d.toString();null!=Mj&&(Hd.InsertLocation=Mj);break;
case 39:rg="EmbeddedApiSession";var Ck=Pa.a;null!=Ck&&(Hd.UserSessionId=Ck);break;case 40:rg="NumberFormattingCalculator";var Nj=Pa.a;null!=Nj&&(Hd.Id=Nj);var Dk=Pa.b;null!=Dk&&(Hd.CounterName=Dk);var ij=Pa.c;null!=ij&&(Hd.Values=ij);break;case 41:rg="RequestDataAfterSend";var Xj=Pa.a;null!=Xj&&(Hd.ClientStopwatchId=Xj);var tj=Pa.b;null!=tj&&(Hd.RequestStatus=tj);var Ek=null==Pa.c?null:Pa.c.toString();null!=Ek&&(Hd.SendDuration=Ek);var sg=null==Pa.d?null:Pa.d.toString();null!=sg&&(Hd.RequestId=sg);
break;case 42:rg="FloatingObjectsStopwatchData";var ok=Pa.a;null!=ok&&(Hd.StopMessage=ok);var pk=null==Pa.b?null:Pa.b.toString();null!=pk&&(Hd.Type=pk);var gh=Pa.c;null!=gh&&(Hd.GUID=gh);var fl=null==Pa.d?null:Pa.d.toString();null!=fl&&(Hd.Pane=fl);var vj=null==Pa.e?null:Pa.e.toString();null!=vj&&(Hd.IsAboveGrid=vj);var Fk=Pa.f;null!=Fk&&(Hd.StartCorrelation=Fk);var gl=Pa.g;null!=gl&&(Hd.LoadImageCorrelation=gl);var Zi=null==Pa.h?null:Pa.h.toString();null!=Zi&&(Hd.SkippedGetEffectsExtents=Zi);var lg=
null==Pa.i?null:Pa.i.toString();null!=lg&&(Hd.Version=lg);break;case 43:rg="Copy";var Yj=Pa.a;null!=Yj&&(Hd.UserSessionId=Yj);var qj=Pa.b;null!=qj&&(Hd.Trigger=qj);var Gk=Pa.c;null!=Gk&&(Hd.RibbonCommandName=Gk);var Hk=Pa.d;null!=Hk&&(Hd.SourceItem=Hk);var hl=null==Pa.e?null:Pa.e.toString();null!=hl&&(Hd.SourceRangeCellCount=hl);var Zj=Pa.f;null!=Zj&&(Hd.ClientSideStopwatchId=Zj);var ak=Pa.g;null!=ak&&(Hd.CopyOperationId=ak);var $i=null==Pa.h?null:Pa.h.toString();null!=$i&&(Hd.IsAsync=$i);var il=
null==Pa.i?null:Pa.i.toString();null!=il&&(Hd.IsFromCache=il);var Ik=null==Pa.j?null:Pa.j.toString();null!=Ik&&(Hd.IsSuccessiveCopy=Ik);var qk=null==Pa.k?null:Pa.k.toString();null!=qk&&(Hd.IsSelectionAllowed=qk);var rk=null==Pa.l?null:Pa.l.toString();null!=rk&&(Hd.IsSuccess=rk);var Oj=null==Pa.m?null:Pa.m.toString();null!=Oj&&(Hd.IsExpectedError=Oj);var ki=Pa.n;null!=ki&&(Hd.ExpectedErrorReason=ki);var sk=Pa.o;null!=sk&&(Hd.ErrorMessage=sk);var wj=null==Pa.p?null:Pa.p.toString();null!=wj&&(Hd.ClientSideCopyTimeInMs=
wj);var Pj=null==Pa.q?null:Pa.q.toString();null!=Pj&&(Hd.TotalTimeInMs=Pj);var yj=null==Pa.r?null:Pa.r.toString();null!=yj&&(Hd.PlainTextPayloadSize=yj);var Eh=Pa.s;null!=Eh&&(Hd.CopyPasteTargetType=Eh);var Qj=null==Pa.t?null:Pa.t.toString();null!=Qj&&(Hd.ShadowWorkbookPayloadSize=Qj);var Jk=null==Pa.u?null:Pa.u.toString();null!=Jk&&(Hd.HtmlPayloadSize=Jk);var tk=null==Pa.v?null:Pa.v.toString();null!=tk&&(Hd.HtmlSizeExceedsLimit=tk);var uk=null==Pa.w?null:Pa.w.toString();null!=uk&&(Hd.CopyTotalSizeExceedsLimit=
uk);var Dj=null==Pa.x?null:Pa.x.toString();null!=Dj&&(Hd.ErrorReason=Dj);var Ej=Pa.y;null!=Ej&&(Hd.ErrorName=Ej);var Kk=null==Pa.z?null:Pa.z.toString();null!=Kk&&(Hd.IsSucceededWithAlert=Kk);var Lk=null==Pa.ba?null:Pa.ba.toString();null!=Lk&&(Hd.EncounteredDeploymentErrors=Lk);var Rj=null==Pa.bb?null:Pa.bb.toString();null!=Rj&&(Hd.ShadowWorkbookSizeExceedsLimit=Rj);var bk=Pa.bc;null!=bk&&(Hd.CopyPasteTargetName=bk);var Fj=Pa.bd;null!=Fj&&(Hd.CCPSliceName=Fj);var zj=Pa.be;null!=zj&&(Hd.SyncClipboardItemsKeys=
zj);var Sj=Pa.bf;null!=Sj&&(Hd.AsyncClipboardItemsKeys=Sj);var Tj=Pa.bg;null!=Tj&&(Hd.CopyPasteHandlerName=Tj);var ck=Pa.bh;null!=ck&&(Hd.SucceededPopulatingSystemClipboardSync=ck);var Mk=Pa.bi;null!=Mk&&(Hd.SucceededPopulatingSystemClipboardAsync=Mk);var vk=Pa.bj;null!=vk&&(Hd.Location=vk);var wl=Pa.bk;null!=wl&&(Hd.CopyContextId=wl);var Nk=null==Pa.bl?null:Pa.bl.toString();null!=Nk&&(Hd.ServerRequestTimeInMs=Nk);var wk=null==Pa.bm?null:Pa.bm.toString();null!=wk&&(Hd.EcsOperationDuration=wk);var jl=
null==Pa.bn?null:Pa.bn.toString();null!=jl&&(Hd.EcsRequestDuration=jl);var kl=null==Pa.bo?null:Pa.bo.toString();null!=kl&&(Hd.WfeRequestDuration=kl);var Ok=null==Pa.bp?null:Pa.bp.toString();null!=Ok&&(Hd.OriginalSourceRangesCountExceedsLimit=Ok);var Pk=null==Pa.bq?null:Pa.bq.toString();null!=Pk&&(Hd.UploadToClipServiceAttempted=Pk);var ll=null==Pa.br?null:Pa.br.toString();null!=ll&&(Hd.FloatingObjectType=ll);var ml=null==Pa.bs?null:Pa.bs.toString();null!=ml&&(Hd.IsCopyWithAsyncClipboardAPI=ml);break;
case 44:rg="Paste";var nl=Pa.a;null!=nl&&(Hd.UserSessionId=nl);var ol=Pa.b;null!=ol&&(Hd.Trigger=ol);var Sh=Pa.c;null!=Sh&&(Hd.RibbonCommandName=Sh);var pl=null==Pa.d?null:Pa.d.toString();null!=pl&&(Hd.PasteTypeFlagValue=pl);var ql=Pa.e;null!=ql&&(Hd.PasteOperationId=ql);var rl=Pa.f;null!=rl&&(Hd.CopyOperationId=rl);var Qk=Pa.g;null!=Qk&&(Hd.ClientSideStopwatchId=Qk);var Rk=Pa.h;null!=Rk&&(Hd.OriginalDestinationRange=Rk);var Gj=Pa.i;null!=Gj&&(Hd.ExpandDestinationRange=Gj);var Vh=Pa.j;null!=Vh&&(Hd.SourceItem=
Vh);var dk=null==Pa.k?null:Pa.k.toString();null!=dk&&(Hd.SourceRangeCellCount=dk);var sl=null==Pa.l?null:Pa.l.toString();null!=sl&&(Hd.IsSuccess=sl);var xl=null==Pa.m?null:Pa.m.toString();null!=xl&&(Hd.IsExpectedError=xl);var xk=Pa.n;null!=xk&&(Hd.ClipboardFormatReadTimeInMs=xk);var Sk=Pa.o;null!=Sk&&(Hd.ClipboardFormatReadStatus=Sk);var ek=null==Pa.p?null:Pa.p.toString();null!=ek&&(Hd.ClipboardReadPermissionPromptShown=ek);var Tk=null==Pa.q?null:Pa.q.toString();null!=Tk&&(Hd.AsyncApiReadTimedOut=
Tk);var li=Pa.r;null!=li&&(Hd.ExpectedErrorReason=li);var yk=Pa.s;null!=yk&&(Hd.ErrorMessage=yk);var Uk=null==Pa.t?null:Pa.t.toString();null!=Uk&&(Hd.TotalTimeInMs=Uk);var fk=null==Pa.u?null:Pa.u.toString();null!=fk&&(Hd.PlainTextPayloadSize=fk);var Hj=null==Pa.v?null:Pa.v.toString();null!=Hj&&(Hd.ShadowWorkbookPayloadSize=Hj);var tl=null==Pa.w?null:Pa.w.toString();null!=tl&&(Hd.HtmlPayloadSize=tl);var Vk=Pa.x;null!=Vk&&(Hd.CopyPasteTargetType=Vk);var gk=null==Pa.y?null:Pa.y.toString();null!=gk&&
(Hd.IsLastCopyWasExternal=gk);var zk=null==Pa.z?null:Pa.z.toString();null!=zk&&(Hd.IsClipboardDataContainShadowWorkbook=zk);var Wk=null==Pa.ba?null:Pa.ba.toString();null!=Wk&&(Hd.IsShadowWorkbookParsedSuccessfully=Wk);var yl=Pa.bb;null!=yl&&(Hd.ActiveSelectionType=yl);var hk=Pa.bc;null!=hk&&(Hd.PasteResult=hk);var ik=null==Pa.bd?null:Pa.bd.toString();null!=ik&&(Hd.ErrorReason=ik);var jk=Pa.be;null!=jk&&(Hd.ErrorName=jk);var Xk=null==Pa.bf?null:Pa.bf.toString();null!=Xk&&(Hd.IsSucceededWithAlert=Xk);
var rj=null==Pa.bg?null:Pa.bg.toString();null!=rj&&(Hd.IsAfterCut=rj);var jj=null==Pa.bh?null:Pa.bh.toString();null!=jj&&(Hd.EncounteredDeploymentErrors=jj);var Ri=null==Pa.bi?null:Pa.bi.toString();null!=Ri&&(Hd.IsCrossSession=Ri);var Uj=null==Pa.bj?null:Pa.bj.toString();null!=Uj&&(Hd.ShadowWorkbookSizeExceedsLimit=Uj);var Yk=null==Pa.bk?null:Pa.bk.toString();null!=Yk&&(Hd.ClipboardContainXLOPayload=Yk);var Ij=Pa.bl;null!=Ij&&(Hd.CopyPasteTargetName=Ij);var zl=Pa.bm;null!=zl&&(Hd.ChromeExtensionId=
zl);var Ak=Pa.bn;null!=Ak&&(Hd.PayloadOrigin=Ak);var Vj=Pa.bo;null!=Vj&&(Hd.PayloadType=Vj);var Zk=Pa.bp;null!=Zk&&(Hd.CCPSliceName=Zk);var $k=Pa.bq;null!=$k&&(Hd.ClipboardItemsKeys=$k);var Jj=Pa.br;null!=Jj&&(Hd.CopyPasteHandlerName=Jj);var aj=null==Pa.bs?null:Pa.bs.toString();null!=aj&&(Hd.IsSourceItemOriginSameSession=aj);var ui=Pa.bt;null!=ui&&(Hd.Location=ui);var Kj=Pa.bu;null!=Kj&&(Hd.ExternalAppSource=Kj);var al=Pa.bv;null!=al&&(Hd.PasteContextId=al);var Wj=null==Pa.bw?null:Pa.bw.toString();
null!=Wj&&(Hd.ServerRequestTimeInMs=Wj);var ul=null==Pa.bx?null:Pa.bx.toString();null!=ul&&(Hd.IndicationDisplayScheduled=ul);var bl=Pa.by;null!=bl&&(Hd.PasteIndicationDisplayStatus=bl);var vl=null==Pa.bz?null:Pa.bz.toString();null!=vl&&(Hd.PasteRecoveryUIDisplayed=vl);var Si=null==Pa.ca?null:Pa.ca.toString();null!=Si&&(Hd.IsFromPasteRecoveryUI=Si);var Lj=null==Pa.cb?null:Pa.cb.toString();null!=Lj&&(Hd.EcsOperationDuration=Lj);var cl=null==Pa.cc?null:Pa.cc.toString();null!=cl&&(Hd.EcsRequestDuration=
cl);var kk=null==Pa.cd?null:Pa.cd.toString();null!=kk&&(Hd.WfeRequestDuration=kk);var dl=null==Pa.ce?null:Pa.ce.toString();null!=dl&&(Hd.OriginalSourceRangesCountExceedsLimit=dl);var el=Pa.cf;null!=el&&(Hd.PasteRecoveryUndoStopwatchId=el);var Al=null==Pa.cg?null:Pa.cg.toString();null!=Al&&(Hd.PasteRecoveryUndoTimeInMs=Al);var hg=null==Pa.ch?null:Pa.ch.toString();null!=hg&&(Hd.PasteCSEPerformed=hg);var lk=null==Pa.ci?null:Pa.ci.toString();null!=lk&&(Hd.CSEStatus=lk);var I=null==Pa.cj?null:Pa.cj.toString();
null!=I&&(Hd.IsFromEnterShortcut=I);var f=null==Pa.ck?null:Pa.ck.toString();null!=f&&(Hd.pasteDestinationHasMergedCells=f);var G=Pa.cl;null!=G&&(Hd.ArtSourceItemType=G);var fa=null==Pa.cm?null:Pa.cm.toString();null!=fa&&(Hd.IsPasteWithAsyncClipboardAPI=fa);var Ya=null==Pa.cn?null:Pa.cn.toString();null!=Ya&&(Hd.IsPasteWithChromiumExtension=Ya);break;case 45:rg="DragDrop";var Kb=Pa.a;null!=Kb&&(Hd.UserSessionId=Kb);var sc=Pa.b;null!=sc&&(Hd.Trigger=sc);var Tc=Pa.c;null!=Tc&&(Hd.RibbonCommandName=Tc);
var fd=Pa.d;null!=fd&&(Hd.OperationId=fd);var ud=Pa.e;null!=ud&&(Hd.ClientSideStopwatchId=ud);var Td=Pa.f;null!=Td&&(Hd.SourceRange=Td);var me=Pa.g;null!=me&&(Hd.DestinationRange=me);var ne=Pa.h;null!=ne&&(Hd.CutCopyType=ne);var Me=null==Pa.i?null:Pa.i.toString();null!=Me&&(Hd.IsShiftKeyDown=Me);var Df=null==Pa.j?null:Pa.j.toString();null!=Df&&(Hd.IsDragInsert=Df);var Gf=null==Pa.k?null:Pa.k.toString();null!=Gf&&(Hd.IsSuccess=Gf);var Cf=null==Pa.l?null:Pa.l.toString();null!=Cf&&(Hd.IsExpectedError=
Cf);var xf=Pa.m;null!=xf&&(Hd.ExpectedErrorReason=xf);var cg=Pa.n;null!=cg&&(Hd.ErrorMessage=cg);var Kg=null==Pa.o?null:Pa.o.toString();null!=Kg&&(Hd.TotalTimeInMs=Kg);var fg=Pa.p;null!=fg&&(Hd.ErrorName=fg);var Tg=null==Pa.q?null:Pa.q.toString();null!=Tg&&(Hd.IsSucceededWithAlert=Tg);var Wh=Pa.r;null!=Wh&&(Hd.CopyPasteTargetType=Wh);var lh=null==Pa.s?null:Pa.s.toString();null!=lh&&(Hd.EncounteredDeploymentErrors=lh);var uj=null==Pa.t?null:Pa.t.toString();null!=uj&&(Hd.IsHeaderDrag=uj);break;case 46:rg=
"ClearCopyState";var Cl=Pa.a;null!=Cl&&(Hd.UserSessionId=Cl);var Dl=Pa.b;null!=Dl&&(Hd.ClientSideStopwatchId=Dl);var El=Pa.c;null!=El&&(Hd.Trigger=El);var Fl=null==Pa.d?null:Pa.d.toString();null!=Fl&&(Hd.IsClearClipboard=Fl);var Gl=null==Pa.e?null:Pa.e.toString();null!=Gl&&(Hd.IsExplicit=Gl);var Hl=null==Pa.f?null:Pa.f.toString();null!=Hl&&(Hd.IsSuccess=Hl);var Il=Pa.g;null!=Il&&(Hd.ErrorMessage=Il);var Jl=Pa.h;null!=Jl&&(Hd.ErrorName=Jl);var Kl=null==Pa.i?null:Pa.i.toString();null!=Kl&&(Hd.TotalTimeInMs=
Kl);var Ll=Pa.j;null!=Ll&&(Hd.CopyPasteTargetType=Ll);break;case 47:rg="WebWorkerRecalcStats";var Ml=null==Pa.a?null:Pa.a.toString();null!=Ml&&(Hd.SuccessCount=Ml);var Nl=null==Pa.b?null:Pa.b.toString();null!=Nl&&(Hd.FailureCount=Nl);var Ol=null==Pa.c?null:Pa.c.toString();null!=Ol&&(Hd.ValueTypeMismatchCount=Ol);var Pl=null==Pa.d?null:Pa.d.toString();null!=Pl&&(Hd.CellValueMismatchCount=Pl);var Ql=null==Pa.e?null:Pa.e.toString();null!=Ql&&(Hd.IfmtMismatchCount=Ql);var Rl=null==Pa.f?null:Pa.f.toString();
null!=Rl&&(Hd.FormattedTextMismatchCount=Rl);var Sl=null==Pa.g?null:Pa.g.toString();null!=Sl&&(Hd.CellValueStringMismatchCount=Sl);var Tl=null==Pa.h?null:Pa.h.toString();null!=Tl&&(Hd.CellValueNumberMismatchCount=Tl);var Ul=null==Pa.i?null:Pa.i.toString();null!=Ul&&(Hd.CellValueBooleanMismatchCount=Ul);var Vl=null==Pa.j?null:Pa.j.toString();null!=Vl&&(Hd.CellValueBlankMismatchCount=Vl);var Wl=null==Pa.k?null:Pa.k.toString();null!=Wl&&(Hd.CellValueErrorMismatchCount=Wl);var Xl=null==Pa.l?null:Pa.l.toString();
null!=Xl&&(Hd.FormattedTextStringMismatchCount=Xl);var Yl=null==Pa.m?null:Pa.m.toString();null!=Yl&&(Hd.FormattedTextNumberMismatchCount=Yl);var Zl=null==Pa.n?null:Pa.n.toString();null!=Zl&&(Hd.FormattedTextBooleanMismatchCount=Zl);var $l=null==Pa.o?null:Pa.o.toString();null!=$l&&(Hd.FormattedTextBlankMismatchCount=$l);var am=null==Pa.p?null:Pa.p.toString();null!=am&&(Hd.FormattedTextErrorMismatchCount=am);var bm=null==Pa.q?null:Pa.q.toString();null!=bm&&(Hd.StringMismatchCount=bm);var cm=null==Pa.r?
null:Pa.r.toString();null!=cm&&(Hd.NumericMismatchCount=cm);var dm=null==Pa.s?null:Pa.s.toString();null!=dm&&(Hd.ErrorMismatchCount=dm);var em=null==Pa.t?null:Pa.t.toString();null!=em&&(Hd.StringValuesCount=em);var fm=null==Pa.u?null:Pa.u.toString();null!=fm&&(Hd.NumericValuesCount=fm);var gm=null==Pa.v?null:Pa.v.toString();null!=gm&&(Hd.BooleanValuesCount=gm);var hm=null==Pa.w?null:Pa.w.toString();null!=hm&&(Hd.BlankValuesCount=hm);var im=null==Pa.x?null:Pa.x.toString();null!=im&&(Hd.ErrorValuesCount=
im);var jm=null==Pa.y?null:Pa.y.toString();null!=jm&&(Hd.NumericValuesDiffAverage=jm);var km=Pa.z;null!=km&&(Hd.NumericEvaluatedValuesMismatchSamples=km);var lm=Pa.ba;null!=lm&&(Hd.NumericFormattedTextMismatchSamples=lm);var mm=Pa.bb;null!=mm&&(Hd.NumericMismatchSamples=mm);var nm=Pa.bc;null!=nm&&(Hd.CellValueTypeMismatchSamples=nm);var om=Pa.bd;null!=om&&(Hd.IfmtMismatchSamples=om);var pm=Pa.be;null!=pm&&(Hd.BlockHashCode=pm);break;case 48:rg="DataValidationEditOpenDialog";var qm=Pa.a;null!=qm&&
(Hd.ServerCommand=qm);var rm=null==Pa.b?null:Pa.b.toString();null!=rm&&(Hd.SubDialogOpened=rm);var sm=Pa.c;null!=sm&&(Hd.SubDialogButtonClicked=sm);var tm=null==Pa.d?null:Pa.d.toString();null!=tm&&(Hd.DialogOpened=tm);var um=Pa.e;null!=um&&(Hd.RuleType=um);var vm=Pa.f;null!=vm&&(Hd.ConditionType=vm);var wm=null==Pa.g?null:Pa.g.toString();null!=wm&&(Hd.LowerBoundaryFilled=wm);var xm=null==Pa.h?null:Pa.h.toString();null!=xm&&(Hd.UpperBoundaryFilled=xm);var ym=null==Pa.i?null:Pa.i.toString();null!=ym&&
(Hd.IgnoreBlank=ym);var zm=null==Pa.j?null:Pa.j.toString();null!=zm&&(Hd.InCellDropdown=zm);var Am=null==Pa.k?null:Pa.k.toString();null!=Am&&(Hd.ShowInputMessage=Am);var Bm=null==Pa.l?null:Pa.l.toString();null!=Bm&&(Hd.InputTitleFilled=Bm);var Cm=null==Pa.m?null:Pa.m.toString();null!=Cm&&(Hd.InputMessageFilled=Cm);var Dm=null==Pa.n?null:Pa.n.toString();null!=Dm&&(Hd.ShowErrorAlert=Dm);var Em=null==Pa.o?null:Pa.o.toString();null!=Em&&(Hd.AlertBlocking=Em);var Fm=null==Pa.p?null:Pa.p.toString();null!=
Fm&&(Hd.AlertTitleFilled=Fm);var Gm=null==Pa.q?null:Pa.q.toString();null!=Gm&&(Hd.AlertMessageFilled=Gm);var Hm=Pa.r;null!=Hm&&(Hd.StopWatchId=Hm);break;case 49:rg="DataValidationEditSubmitRule";var Im=Pa.a;null!=Im&&(Hd.RuleType=Im);var Jm=Pa.b;null!=Jm&&(Hd.ConditionType=Jm);var Km=null==Pa.c?null:Pa.c.toString();null!=Km&&(Hd.LowerBoundaryFilled=Km);var Lm=null==Pa.d?null:Pa.d.toString();null!=Lm&&(Hd.UpperBoundaryFilled=Lm);var Mm=null==Pa.e?null:Pa.e.toString();null!=Mm&&(Hd.IgnoreBlank=Mm);
var Nm=null==Pa.f?null:Pa.f.toString();null!=Nm&&(Hd.InCellDropdown=Nm);var Om=null==Pa.g?null:Pa.g.toString();null!=Om&&(Hd.ShowInputMessage=Om);var Pm=null==Pa.h?null:Pa.h.toString();null!=Pm&&(Hd.InputTitleFilled=Pm);var Qm=null==Pa.i?null:Pa.i.toString();null!=Qm&&(Hd.InputMessageFilled=Qm);var Rm=null==Pa.j?null:Pa.j.toString();null!=Rm&&(Hd.ShowErrorAlert=Rm);var Sm=null==Pa.k?null:Pa.k.toString();null!=Sm&&(Hd.AlertBlocking=Sm);var Tm=null==Pa.l?null:Pa.l.toString();null!=Tm&&(Hd.AlertTitleFilled=
Tm);var Um=null==Pa.m?null:Pa.m.toString();null!=Um&&(Hd.AlertMessageFilled=Um);var Vm=null==Pa.n?null:Pa.n.toString();null!=Vm&&(Hd.ClearAllPressed=Vm);var Wm=Pa.o;null!=Wm&&(Hd.ActionStatus=Wm);var Xm=Pa.p;null!=Xm&&(Hd.Error=Xm);var Ym=Pa.q;null!=Ym&&(Hd.StopWatchId=Ym);var Zm=null==Pa.r?null:Pa.r.toString();null!=Zm&&(Hd.InsertDropdownButton=Zm);break;case 50:rg="CustomSort";var $m=Pa.a;null!=$m&&(Hd.RangeType=$m);var an=null==Pa.b?null:Pa.b.toString();null!=an&&(Hd.HasHeaders=an);var bn=null==
Pa.c?null:Pa.c.toString();null!=bn&&(Hd.SortTopToBottom=bn);var cn=null==Pa.d?null:Pa.d.toString();null!=cn&&(Hd.ColumnCount=cn);var dn=null==Pa.e?null:Pa.e.toString();null!=dn&&(Hd.RowCount=dn);var en=null==Pa.f?null:Pa.f.toString();null!=en&&(Hd.RangeLimitExceeded=en);var fn=null==Pa.g?null:Pa.g.toString();null!=fn&&(Hd.CaseSensitive=fn);var gn=null==Pa.h?null:Pa.h.toString();null!=gn&&(Hd.GetSortInfoDuration=gn);var hn=null==Pa.i?null:Pa.i.toString();null!=hn&&(Hd.LevelCount=hn);var jn=null==Pa.j?
null:Pa.j.toString();null!=jn&&(Hd.SortOnValuesCount=jn);var kn=null==Pa.k?null:Pa.k.toString();null!=kn&&(Hd.SortOnCellColorCount=kn);var ln=null==Pa.l?null:Pa.l.toString();null!=ln&&(Hd.SortOnFontColorCount=ln);var mn=null==Pa.m?null:Pa.m.toString();null!=mn&&(Hd.SortOnIconCount=mn);var nn=null==Pa.n?null:Pa.n.toString();null!=nn&&(Hd.CustomOrderCount=nn);var on=null==Pa.o?null:Pa.o.toString();null!=on&&(Hd.AvgCellColorCount=on);var pn=null==Pa.p?null:Pa.p.toString();null!=pn&&(Hd.MaxCellColorCount=
pn);var qn=null==Pa.q?null:Pa.q.toString();null!=qn&&(Hd.AvgFontColorCount=qn);var rn=null==Pa.r?null:Pa.r.toString();null!=rn&&(Hd.MaxFontColorCount=rn);var sn=null==Pa.s?null:Pa.s.toString();null!=sn&&(Hd.AvgIconsCount=sn);var tn=null==Pa.t?null:Pa.t.toString();null!=tn&&(Hd.MaxIconsCount=tn);var un=null==Pa.u?null:Pa.u.toString();null!=un&&(Hd.Executed=un);break;case 51:rg="NamedSheetViewUserAction";var vn=Pa.a;null!=vn&&(Hd.UserSessionId=vn);var wn=Pa.b;null!=wn&&(Hd.UserActionName=wn);var xn=
null==Pa.c?null:Pa.c.toString();null!=xn&&(Hd.UserActionSource=xn);var yn=Pa.d;null!=yn&&(Hd.UserActionData=yn);var zn=Pa.e;null!=zn&&(Hd.OtherData=zn);break;case 52:rg="NamedSheetViewTeachingCallout";var An=Pa.a;null!=An&&(Hd.UserSessionId=An);var Bn=null==Pa.b?null:Pa.b.toString();null!=Bn&&(Hd.TeachingCalloutSequence=Bn);var Cn=null==Pa.c?null:Pa.c.toString();null!=Cn&&(Hd.TeachingCalloutIndex=Cn);var Dn=null==Pa.d?null:Pa.d.toString();null!=Dn&&(Hd.UserActionName=Dn);var En=Pa.e;null!=En&&(Hd.UserActionData=
En);var Fn=null==Pa.f?null:Pa.f.toString();null!=Fn&&(Hd.DurationInMs=Fn);break;case 53:rg="NamedSheetViewTeachingDialog";var Gn=Pa.a;null!=Gn&&(Hd.UserSessionId=Gn);var Hn=Pa.b;null!=Hn&&(Hd.UserActionName=Hn);var In=Pa.c;null!=In&&(Hd.ButtonClicked=In);var Jn=null==Pa.d?null:Pa.d.toString();null!=Jn&&(Hd.DurationInMs=Jn);var Kn=null==Pa.e?null:Pa.e.toString();null!=Kn&&(Hd.IsNewTeachingDialog=Kn);break;case 54:rg="NamedSheetViewOptionsDialog";var Ln=Pa.a;null!=Ln&&(Hd.UserSessionId=Ln);var Mn=null==
Pa.b?null:Pa.b.toString();null!=Mn&&(Hd.OptionsAction=Mn);var Nn=Pa.c;null!=Nn&&(Hd.OptionsActionData=Nn);var On=Pa.d;null!=On&&(Hd.OptionsOtherData=On);var Pn=null==Pa.e?null:Pa.e.toString();null!=Pn&&(Hd.DurationInMs=Pn);break;case 55:rg="NamedSheetViewTempViewSaveDialog";var Qn=Pa.a;null!=Qn&&(Hd.UserSessionId=Qn);var Rn=Pa.b;null!=Rn&&(Hd.TriggeredFrom=Rn);var Sn=Pa.c;null!=Sn&&(Hd.ButtonClicked=Sn);var Tn=null==Pa.d?null:Pa.d.toString();null!=Tn&&(Hd.NameUpdated=Tn);var Un=null==Pa.e?null:Pa.e.toString();
null!=Un&&(Hd.DurationInMs=Un);break;case 56:rg="TemporaryViewStartedDataRestore";var Vn=Pa.a;null!=Vn&&(Hd.UserSessionId=Vn);var Wn=null==Pa.b?null:Pa.b.toString();null!=Wn&&(Hd.CountOfTempViews=Wn);break;case 57:rg="TemporaryViewFetchedVersion";var Xn=Pa.a;null!=Xn&&(Hd.UserSessionId=Xn);var Yn=null==Pa.b?null:Pa.b.toString();null!=Yn&&(Hd.NumberOfBytes=Yn);break;case 58:rg="RaiseEventsAndGenerateBlockRequests";var Zn=null==Pa.a?null:Pa.a.toString();null!=Zn&&(Hd.ReturnContentStatus=Zn);var $n=
null==Pa.b?null:Pa.b.toString();null!=$n&&(Hd.CacheState=$n);var ao=null==Pa.c?null:Pa.c.toString();null!=ao&&(Hd.FromXhrCallback=ao);var bo=null==Pa.d?null:Pa.d.toString();null!=bo&&(Hd.AreGeneralErrorsPresent=bo);var co=Pa.e;null!=co&&(Hd.BlockCacheItemHash=co);var eo=Pa.f;null!=eo&&(Hd.StopwatchId=eo);var fo=Pa.g;null!=fo&&(Hd.BlockCacheItemProcessingStopwatchId=fo);var go=null==Pa.h?null:Pa.h.toString();null!=go&&(Hd.StateId=go);var ho=null==Pa.i?null:Pa.i.toString();null!=ho&&(Hd.IsHighPriority=
ho);var io=null==Pa.j?null:Pa.j.toString();null!=io&&(Hd.CalcComplete=io);var jo=null==Pa.k?null:Pa.k.toString();null!=jo&&(Hd.EditedCellsUpdatedByCse=jo);var ko=null==Pa.l?null:Pa.l.toString();null!=ko&&(Hd.DependentCellsUpdatedByCse=ko);var lo=null==Pa.m?null:Pa.m.toString();null!=lo&&(Hd.Revision=lo);var mo=null==Pa.n?null:Pa.n.toString();null!=mo&&(Hd.SheetProcessedDataVersion=mo);var no=null==Pa.o?null:Pa.o.toString();null!=no&&(Hd.RefCount=no);var oo=null==Pa.p?null:Pa.p.toString();null!=oo&&
(Hd.ExistsInView=oo);var po=null==Pa.q?null:Pa.q.toString();null!=po&&(Hd.ContentSource=po);break;case 59:rg="LaunchMakerCodeEditor";var qo=Pa.a;null!=qo&&(Hd.SessionId=qo);var ro=Pa.b;null!=ro&&(Hd.Command=ro);var so=null==Pa.c?null:Pa.c.toString();null!=so&&(Hd.IsPreviewGallery=so);var to=Pa.d;null!=to&&(Hd.MenuItemId=to);var uo=Pa.e;null!=uo&&(Hd.ScriptId=uo);var vo=Pa.f;null!=vo&&(Hd.ShareId=vo);var wo=null==Pa.g?null:Pa.g.toString();null!=wo&&(Hd.IsOwner=wo);var xo=null==Pa.h?null:Pa.h.toString();
null!=xo&&(Hd.PublishedScriptCount=xo);var yo=null==Pa.i?null:Pa.i.toString();null!=yo&&(Hd.RecentScriptCount=yo);var zo=null==Pa.j?null:Pa.j.toString();null!=zo&&(Hd.WorkbookScriptCount=zo)}Hd.Table=rg;var Bo=Sys.Serialization.JavaScriptSerializer.serialize(Hd);Ae.call(ge,3704927,0,50,Bo)}}catch(Hd){K.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${Na} exception: ${Hd}`)}}IDd(Na,Pa,Oc){if(this.nRc){const ge=this.scb[Na+Pa];ge&&(ge.e=Oc,this.CGd(ge));delete this.scb[Na+Pa]}}D2d(Na,
Pa){Af[Na]in this.k$f||this.Ll(Na,Pa)}M5j(){this.Yp.appStart&&this.SXg(qg.Bbe,this.Yp.appStart)}EBj(Na){const Pa={};Pa.a=Na.i;Pa.b=Na.o;Pa.c=Na.t;Pa.d=gg.a(Na.s,Na.p||this.Yp.appStart);Pa.e=gg.a(Na.e,Na.s);Pa.f=Na.c;Pa.g=Na.a;Pa.h=Na.h;this.Ll(0,Pa,this.koj(Pa.b,Pa.c))}koj(Na,Pa){return["CommandTask","QueuedTask","Task"].includes(Na)&&!this.Ksi.includes(Pa)?!1:!0}vI(Na,Pa,Oc,ge,Ae){if(Na&&Pa){const Ye={};Ye.a=Na;Ye.b=Pa;Ye.c=Oc.toString();Ye.d=ge.toString();this.Ll(15,Ye,void 0===Ae?!0:Ae)}}T9f(Na,
Pa,Oc,ge){const Ae={};Na&&(Ae.c=gg.a(Na,this.Yp.appStart));Ae.b=Pa;Ae.a=Oc;Ae.d=ge;this.Ll(17,Ae)}dispose(){this.JOa.execute(Na=>{Na.deactivate(!0);Na.Zlk(this.upg)});this.tk&&this.tk.w6a(this.JP);super.dispose()}FNf(){return this.M9g=this.M9g||new ie}tmf(Na,Pa,Oc,ge,Ae){const Ye={};Ye.o=Na;Ye.t=Pa;Ye.p=void 0===Ae?null:Ae;Ye.s=(void 0===ge?null:ge)||this.Yp.$j;this.vTd(Ye,void 0===Oc?null:Oc);return Ye}Thf(Na,Pa){Na&&(Na.e=(void 0===Pa?null:Pa)||this.Yp.$j,Na.i=Na.i||this.zhb.Oqb(),Na.c=Na.c||this.Vmf,
Na.a=Na.a||this.fnf,Na.h=void 0!==Na.h&&null!==Na.h?Na.h:this.tk?this.tk.un:!1,this.CGd(Na))}a$f(Na){const Pa=Na.context;Na.duration>qg.Dii&&(Pa.methodName===cb.a.fSb||Pa.methodName===cb.a.XJa)&&this.rVc(1,qg.WTi);if("GetSessionStatus"!==Pa.methodName){const Oc={};Oc.a=Pa.methodName;Oc.b=Pa.stopwatch.id;Oc.c=Na.EVc;Oc.d=Na.responseSize;Oc.e=Pa.LWa;Oc.f=Na.nk?Na.nk.StateId:cb.a.Rye;this.Ll(30,Oc,!0);this.vI(Oc.b,Na.nk.ServerCorrelationId,"clientWebRequests","ServerActions")}}FYg(){if(this.nRc){const Na=
this.scb.LoadingUIShownSplashScreen;Na&&Qa.a.instance.KEk(Na.s)}}rVc(Na,Pa){this.l8g.e5b(Na,Pa,null)}ZGg(Na,Pa){this.l4c.pqk(Na,void 0===Pa?null:Pa)}YGg(Na,Pa,Oc){this.l4c.oqk(Na,Pa,void 0===Oc?null:Oc)}$Gg(Na){this.l4c.Bke(Na,null)}aHg(Na,Pa){this.l4c.e5b(Na,Pa,null)}mVc(Na,Pa,Oc){this.j$a.mVc(Na,Pa,void 0===Oc?null:Oc)}vVc(Na,Pa,Oc){this.j$a.vVc(Na,Pa,void 0===Oc?null:Oc)}H6b(Na,Pa,Oc,ge,Ae,Ye,Bf,...Pf){this.j$a.H6b(Na,Pa,Oc,ge,Ae,Ye,Bf,...Pf)}tXc(Na,Pa,Oc,ge,Ae,Ye,Bf){this.j$a.tXc(Na,Pa,Oc,ge,
Ae,Ye,Bf)}J6b(Na,Pa,Oc,ge,Ae,Ye){this.j$a.J6b(Na,Pa,Oc,ge,Ae,Ye)}I6b(Na,Pa,Oc,ge,Ae,Ye,...Bf){this.j$a.I6b(Na,Pa,Oc,ge,Ae,Ye,...Bf)}K6b(Na,Pa,Oc,ge,Ae,Ye){this.l8g.K6b(Na,Pa,Oc,ge,Ae,Ye)}uXc(Na,Pa,Oc,ge){this.j$a.uXc(Na,Pa,Oc,ge)}CGd(Na){this.nVk.EBj(Na)}N5j(){if(this.nRc){Stw.swpc=null;const Na=this.nRc;for(const Pa in Na)this.vTd(Na[Pa])}}cwi(){const Na=window[xg.a.namespace];if(Na){const Pa=Na[xg.a.Ugf];Pa&&(delete Na[xg.a.Ugf],Pa.forEach(Oc=>{this.vTd(Oc);this.CGd(Oc)}))}}Jpj(Na,Pa){if("about:blank"===
Na||"renamehandler.ashx"===Pa&&"2"===zb.a.Bz(Na,"u"))return!0;for(Na=0;Na<this.Qke.length;Na++)if(Pa.endsWith(this.Qke[Na]))return!0;return!1}Uyj(){this.JOa.execute(Na=>{Na.$n(qg.uLh,0);Na.eCh(this.upg);Na.activate()})}Lyj(){const Na={};Na.a=new Date(If.EcmaDateClock.instance.appStart.m);Na.b=this.userSessionId;Na.c=this.Yp.L0g;Na.d=qg.Ubi*Db.devicePixelRatio;Na.e=A.a.ih.appStart.m;this.Ll(14,Na,!0);this.Poa(A.a.ih.appStart.m,Object(xd.a)(kb.a.instance,kb.a.instance.qfk,"recordAppInitStart"))}SXg(Na,
Pa){this.Izb=this.zhb.Oqb();this.Iac=this.zhb.Oqb();this.kSa=Na;this.J_c("UserAction",Na,this.Iac,Pa);this.F8f(Na,this.Izb)}GXk(){const Na=window[xg.a.namespace];Na&&!qg.ykf&&(Na[xg.a.oUk]=(Pa,Oc)=>this.tmf(Pa,Oc),Na[xg.a.Yki]=Pa=>{this.Thf(Pa)},qg.ykf=!0)}g6k(Na){const Pa=Og.iPh(Na.o,Na.t),Oc=new Og(gg.a(Na.e,Na.s)),ge=Pa in this.jve?this.jve[Pa].yZh(Oc):Oc;this.jve[Pa]=ge;if(Oc===ge||Oc.average!==ge.average)Na=Object(qa.a)(new Eg,{operation:Na.o,target:Na.t,yJj:ge.average,sender:this}),this.raiseEvent(Pa,
Na)}F8f(Na,Pa){const Oc={};Oc.a=Pa;Oc.b=this.userSessionId;Oc.c=Na;this.Ll(1,Oc,!0)}Lbj(){this.Qke=[cb.a.pjk,cb.a.getSessionStatus,cb.a.XJa,cb.a.iZh,cb.a.WVh,cb.a.yzb,cb.a.kBc,cb.a.getObjectMetadata,cb.a.qRi,cb.a.setRichTextCell,cb.a.dKa,cb.a.Y$k,cb.a.pollSessionStatus,cb.a.qXi,cb.a.eVi,cb.a.bOi]}vTd(Na,Pa){Na.i=(void 0===Pa?null:Pa)||this.zhb.Oqb();Na.a=this.fnf;Na.c=this.Vmf;Na.h=this.tk?this.tk.un:!1}static Ba(Na){const Pa=new qg(Na.ua.UserSessionId,Na.la,void 0,void 0,void 0,!0);Pa.F8f(qg.Zeg,
Pa.Snf);K.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Pa.Uyj();Pa.GXk();Pa.M5j();Pa.Lyj();Pa.cwi();Pa.N5j();Pa.Lbj();qg.jCk(Na);lf.a.Px.Hh(41,Pa)}static jCk(Na){const Pa=Db.devicePixelRatio;1<Pa&&Na.Kh.cF(!0,2<=Pa?8388608:4194304)}}qg.Zeg="UnassignedUserAction";qg.Bbe="PageLoad";qg.MPd="GridUpdateOperation";qg.Dii=5E3;qg.WTi="MoreThan_5000_Ms";qg.Ubi=96;qg.uLh=30;qg.ykf=!1;Object(w.a)(qg,"TelemetryManager",y.a,[18,19,578,579]);Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.BrowserInfoLogger");vc.main();Type.registerNamespace("CNT");jd.main();Type.registerNamespace("CACPU");ee.main();Type.registerNamespace("Common.App.EventsCacheManager");Ue.main();(()=>{jc.a.gh(Na=>{N.nd.Aa()||Na.la.Hh(137,new Kc(Na))})})();(()=>{jc.a.gh(Na=>{Na.la.Hh(37,new ue(Na))})})();(()=>{jc.a.gh(Na=>{Na.la.Hh(40,new Ub(Na,new oc.a(()=>N.nd.Aa()?Object(yc.d)(D.a.resolve(N.nd,{va:1})):De.GetServiceTaskFactory.create(Na.la,137,Na.ya,1))))})})();(()=>{jc.a.gh(Na=>
{Na.la.Hh(276,new sf(Na))})})();(()=>{jc.a.gh(Na=>{lf.a.Px.fi(135,()=>{qg.Ba(Na);Ta.Ba(Na);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")||Gb.Ba(Na);Tb.Ba(Na);lb.Ba(Na);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8680491_MigrateRenderingFidelityTracker")||oa.RenderingFidelityTracker.Ba(Na)})})})();String(h);String(r);String(e);String(k);String(m);String(oa);String(x);String(n);String(u);window.___1710439927710_closurehack=h;window.___1710439927710_closurehack=
r;window.___1710439927710_closurehack=e;window.___1710439927710_closurehack=k;window.___1710439927710_closurehack=m;window.___1710439927710_closurehack=oa;window.___1710439927710_closurehack=x;window.___1710439927710_closurehack=n;window.___1710439927710_closurehack=u},916:function(z,t,a){function c(e,k){k=void 0===k?{}:k;return b.AFrameworkApplication.fa.ka("IsWebpack5RibbonEnabled")?h.a.resolve(r.vf,k).then(m=>m.loadChunk(e)):h.a.resolve(r.Gb,k).then(m=>m(e))}a.d(t,"a",function(){return c});var b=
a(6),h=a(95),r=a(5)},941:function(z,t,a){a.d(t,"a",function(){return v});z=a(0);var c=a(6),b=a(79),h=a(35),r=a(33),e=a(189);class k{constructor(w,l){this.message=w;this.BYa=l}}Object(z.a)(k,"CrossDocumentEventArgs",null,[]);var m=a(980),x=a(394),n=a(295),u=a(1005);class v{constructor(w,l,y,B){this._name="";this.vQ={};this.rTa=null;this.ackMessageHandler=A=>{A=A.CorrelationId;""!==A&&A in this.vQ&&(u.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.vQ[A],A),this.vQ[A]=
"ACK_RECEIVED")};this.H5d=A=>{const E=this.GMd(A);if(!E)return!1;if(this.ZA[E.MessageId])return this.Lda.inb(this.ZA[E.MessageId],E),!0;if(this.mD[E.MessageId]){const N=this.mD[E.MessageId];A=new k(E,A);this.Lda.fUd(N,A);return!0}return!1};this.Wda=[];this.Dda=[];this.Eda=[];this.Sda=[];this.pGb=w;this.oGb=l;this.ZA={};this.mD={};this.Lda=y;v._id++;B&&B();this.Sz=this.enable()}get targetOrigin(){return this.oGb}get U9b(){return this.pGb}enable(){if(!n.a())return u.a.sendTraceTag(5018251,2,"Not supported for current browser."),
!1;this.WTd();u.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.Sz}WTd(){u.a.debugAssertTag(5018253,!!this.Lda,null);this.rTa=this.H5d;this.Lda.gJb(this.rTa,null)}disable(){this.Sz=!1;this.Wda=[];this.Dda=[];this.Eda=[];this.Sda=[];this.pGb=null;this.oGb="";this.Lda.ANb(this.rTa);this.ZA={};this.mD={}}dispose(){this.disable()}F1a(w){return!!this.Wda&&Array.contains(this.Wda,w)||this.BWb(w)}BWb(w){return!!this.Dda&&Array.contains(this.Dda,w)}$r(w){u.a.debugAssertTag(5018259,!!this.Wda,
null);Array.add(this.Wda,w);u.a.sendTraceTag(5018260,2,"Allow receiving : {0}",w)}Zdb(w){u.a.debugAssertTag(5018261,!!this.Dda,null);Array.add(this.Dda,w);u.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",w)}AXd(w){return!!this.Eda&&Array.contains(this.Eda,w)}w_(w){u.a.debugAssertTag(5018263,!!this.Eda,null);Array.add(this.Eda,w);u.a.sendTraceTag(5018264,2,"Allow free sending: {0}",w)}UXd(w){w=b.a.getOrigin(w);return!!w&&!!this.Sda&&Array.contains(this.Sda,w)}x_(w){u.a.debugAssertTag(5018265,
!!this.Sda,null);if(w===v.eU)return u.a.debugAssertTag(5018266,!1,null),!1;let l=b.a.getOrigin(w);if(!l)return u.a.sendTraceTag(5018267,4,"Get origin fail:{0}",w),!1;c.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(l=r.a.Xs(l));Array.add(this.Sda,l);u.a.sendTraceTag(5018268,2,"Add origin:{0}",l);return!0}send(w,l){l=void 0===l?null:l;let y=this.targetOrigin;if(l){l=b.a.getOrigin(l);if(!l)return!1;y=l}return this.hBa(w,this.U9b,
y)}sendMessage(w,l,y){y=(y=void 0===y?"":y)&&""!==y?y:e.a.create().toString();return this.send(this.P4a(w,l,y,c.AFrameworkApplication.userSessionId))}postMessage(w){const l=e.a.create().toString();if(!c.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!w.ABa)return this.send(this.P4a(w.messageId,w.values,l,w.userSessionId));this.ZA[w.HFa]||(this.$r(w.HFa),this.wq(w.HFa,this.ackMessageHandler));this.vQ[l]="";return this.L2b(w,l,1)}L2b(w,l,y){if(""!==l&&l in this.vQ&&"ACK_RECEIVED"===
this.vQ[l])return delete this.vQ[l],!0;if(y>w.rV)return u.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',w.HFa,l),delete this.vQ[l],!1;u.a.sendTraceTag(40716251,1<y?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',w.rV-y,w.messageId,l);y++;window.setTimeout(()=>{this.L2b(w,l,y)},w.L0e);w.values[x.a.K0e]=!0;return this.send(this.P4a(w.messageId,w.values,l,w.userSessionId))}P4a(w,l,y,B){w=new m.a(w);w.CorrelationId=
y;l&&(w.Values=l);w.Values.wdUserSession=B;return w}hBa(w,l,y){u.a.debugAssertTag(5018269,!!w,null);if(!this.Sz)return!1;u.a.debugAssertTag(5018270,!!l,null);u.a.debugAssertTag(5018271,!!y,null);if(!l||!y)return u.a.debugAssertTag(5018272,!1,null),!1;if(y===v.eU&&!this.AXd(w.MessageId))return u.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:w.MessageId}),!1;w.SendTime=(new Date).getTime();let B="";try{B=Sys.Serialization.JavaScriptSerializer.serialize(w)}catch(A){return u.a.sendTraceTag(5018274,
4,"JSON Ser failed {0}",{["Exception"]:A.message}),!1}l=v.sendMessage(l,B,y);u.a.sendTraceTag(5018275,2,"Send {0}. {1}",l?"succeeded":"failed",{["id"]:w.MessageId,["origin"]:y});return l}wq(w,l){u.a.debugAssertTag(5018304,!!l,null);u.a.debugAssertTag(5018305,!!this.ZA&&!!this.mD,null);if(!this.Sz)return!1;if(!this.F1a(w))return u.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:w}),!1;this.ZA[w]!==l&&(u.a.debugAssertTag(5018307,!this.ZA[w]&&!this.mD[w],null),this.ZA[w]=l,delete this.mD[w]);
return!0}registerEventCallback(w,l){u.a.debugAssertTag(40420062,!!l,null);u.a.debugAssertTag(40420063,!!this.mD&&!!this.ZA,null);if(!this.Sz)return!1;if(!this.F1a(w))return u.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:w}),!1;this.mD[w]!==l&&(u.a.debugAssertTag(40420065,!this.ZA[w]&&!this.mD[w],null),this.mD[w]=l,delete this.ZA[w]);return!0}wW(w){this.Sz&&(this.ZA[w]&&delete this.ZA[w],this.mD[w]&&delete this.mD[w])}GMd(w){const l=new Date;this.d3d(w);if(!w.origin||!w.source||void 0===
w.data||null===w.data)return u.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const y=this.l0d(w.data);if(!y)return null;if(!this.UXd(w.origin)){if(!this.BWb(y.MessageId))return u.a.sendTraceTag(5018309,1,"{0}",{["id"]:y.MessageId}),null;if(!h.a.Raa&&w.source!==this.U9b)return u.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}u.a.debugAssertTag(5018311,!!y.Values,null);y.Values.m_Source=w.source;y.Values.m_Origin=w.origin;
y.Values.m_ReceivedTime=l.getTime();return y}l0d(w){if(!w)return null;let l=null;try{l=Sys.Serialization.JavaScriptSerializer.deserialize(w,!0)}catch(A){return 2>v.OBb&&(u.a.sendTraceTag(5018312,2,"Deser failed"),v.OBb++),null}if(!l)return u.a.debugAssertTag(5018313,!1,null),null;for(w=0;w<v.pva.length;w++)if(!l[v.pva[w]])return"MessageId"!==v.pva[w]&&u.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",v.pva[w]),null;if(l.Values)try{l.Values}catch(A){return u.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",A.message),null}else u.a.sendTraceTag(41502556,2,"No values in message");w=l.MessageId;if(!this.F1a(w))return u.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:w}),null;const y=l.SendTime,B=(new Date).getTime()-y;if(0>y)return u.a.sendTraceTag(520435660,2,"{0}",{["t"]:y,["id"]:w}),null;6E4<B&&u.a.sendTraceTag(520435659,2,"{0}",{["t"]:y,["delta"]:B,["id"]:w});-300>B&&u.a.sendTraceTag(520435658,2,"{0}",{["t"]:y,["delta"]:B,["id"]:w});w=new m.a;w.MessageId=l.MessageId;
w.SendTime=l.SendTime;w.CorrelationId=l.CorrelationId;l.Values&&(w.Values=l.Values);u.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",w.MessageId,w.SendTime,w.CorrelationId);return w}d3d(w){u.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:w.origin,["data"]:w.data,["source"]:w.source}))}static sendMessage(w,l,y){if(!n.a())return u.a.debugAssertTag(5018319,!1,null),!1;try{return w.postMessage(l,y),!0}catch(B){u.a.sendTraceTag(5018320,
4,"{0}",{["exception"]:B.message})}return!1}}v.pva=["MessageId","SendTime"];v.eU="*";v._id=0;v.OBb=0;Object(z.a)(v,"CrossDocumentMessenger",null,[2,333])},943:function(z,t,a){a.d(t,"a",function(){return r});z=a(0);var c=a(1),b=a(95),h=a(5);class r{static HUf(e){r.$=e;c.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void b.a.resolve(h.Cb).then(k=>{r.tk=k}):r.$.la.fi(291,k=>{r.tk=k})}static Pwa(e,k){return e[Math.round((e.length-1)*k/100)]}static PM(e){return r.tk?
r.tk.PM(e):!1}}r.tk=null;r.$=null;Object(z.a)(r,"SessionStatisticsManagerHelper",null,[])},976:function(z,t,a){a.d(t,"a",function(){return c});const c=b=>{if(Object.keys)b=Object.keys(b);else{const h=[];for(const r in b)h.push(r);b=h}return b}},980:function(z,t,a){a.d(t,"a",function(){return c});z=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(z.a)(c,"CrossDocumentMessage",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/6a074c044f5f482b4bad19686c9855e7/EwaTS.tm.js.map