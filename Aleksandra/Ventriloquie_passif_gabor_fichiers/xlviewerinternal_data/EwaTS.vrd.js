'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1160:function(z,t,a){a.r(t);a.d(t,"FormulaBar",function(){return tb});z=a(0);var c=a(15),b=a(98),h=a(6),r=a(158),e=a(17),k=a(94),m=a(904),x=a(35),n=a(416),u=a(99),v=a(19),w=a(7),l=a(305),y=a(730),B=a(728),A=a(558),E=a(178),N=a(154);t=a(78);var D=a(105);class U extends D.a{constructor(ab,La,pb,ia,kb,fb){super(ab);this.XY=()=>{this.domElement.disabled||(this.irc.className=this.Wtc+" "+this.odg)};this.WY=()=>{this.domElement.disabled||
(this.irc.className=this.Wtc+" "+this.dHj)};this.nng=hb=>{if(!this.domElement.disabled){const Jb=hb.keyCode;if("mousedown"===hb.type||13===Jb||32===Jb)this.irc.className=this.Wtc+" "+this.K9j}};this.ong=()=>{this.domElement.disabled||(this.irc.className=this.Wtc+" "+this.odg)};this.Wtc=pb;this.odg=ia;this.dHj=kb;this.K9j=fb;this.oj.Ba("mouseover",this.XY);this.oj.Ba("mouseout",this.WY);this.oj.Ba("focus",this.XY);this.oj.Ba("blur",this.WY);this.oj.Ba("mousedown",this.nng);this.oj.Ba("keydown",this.nng);
this.oj.Ba("mouseup",this.ong);this.oj.Ba("keyup",this.ong);this.irc=La}}Object(z.a)(U,"PseudoClassBehavior",D.a,[]);var K=a(16);class M extends t.a{constructor(ab){super();this.instances=[];this.$=ab}dispose(){k.a.gj(this.instances);this.instances.length=0;this.$=null;super.dispose()}hoc(ab,La,pb,ia,kb){const fb=K.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+ab);ab=ab===La?fb:K.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+La);if(!fb)return null;pb=new U(fb,ab,
pb,ia,"",kb);this.instances.push(pb);return pb}}M.VQh="ewa-menu-btn-hover";M.XQh="ewa-menu-btn-pressed";Object(z.a)(M,"InitializePseudoClasses",t.a,[]);var O=a(25),R=a(283),J=a(205),aa=a(139),S=a(39),C=a(23);class L{constructor(ab,La){this.$=ab;this.Zi=La;l.a(this.$).Tq(this)}get hj(){return this.Zi.Wa.Yl}get $o(){return C.f(this.$).isEditing&&C.f(this.$).vA}get hl(){return R.a.PBf}Up(ab,La){La||K.DOMElementExtensions.setFocus(this.hj);return!La}sq(ab){return K.DOMElementExtensions.eo(this.hj,ab)}Js(){}lu(){}dispose(){l.a(this.$).WH(this)}}
Object(z.a)(L,"FormulaBarFocusManager",null,[52,2]);var V=a(290),X=a(306),la=a(60),Va=a(83),na=a(922),db=a(169);class ja extends t.a{constructor(ab=null,La,pb,ia=null){super();this.q5a=this.Nmb=this.Akb=this.HSc=null;this.JId=O.a.Fz()?16:13;this.KId=O.a.Fz()?16:13;this.Hkg=()=>{const kb=new Va.a(753860909,2,this.$.ii,2,null);this.$.Ma.qh(kb);return!0};this.Ikg=kb=>kb.La.keyCode===b.a.wu?(kb=new Va.a(753860909,1,this.$.ii,2,null),this.$.Ma.qh(kb),!0):!1;this.Jkg=()=>{this.da.isEditing&&this.da.Bp.Wa.Ioc();
return!1};this.$=pb;this.da=C.f(pb);this.Vq=La;this.svgIconProvider=ia;O.a.Fz()?this.Akb=K.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+w.a.pQb):(this.AAi=La.ia(1035),this.HSc=ab.hoc(w.a.pQb,w.a.pQb,v.a.wCf+" "+v.a.i0,v.a.G0i,""),this.Akb=this.HSc.domElement);this.Z$i(this.Akb)}Z$i(ab){ab.role="button";ab.title=this.Vq.ia(1035);this.Nmb=this.svgIconProvider?this.svgIconProvider.Mna(na.a.zAi,this.JId,this.KId,ab,void 0,void 0,void 0,this.Vq.ia(1035)):db.b(this.KId,this.JId,v.a.jqi,
la.a.An(0),null,null,!0,this.Vq.ia(1035));ab.appendChild(this.Nmb);V.a.instance.xa(e.a.click,ab,this.Hkg);r.a.instance.xa(e.a.Ui,ab,this.Ikg);X.a.instance.xa(e.a.qj,ab,this.Jkg)}dispose(){this.O9a(this.Akb);this.Akb=null;O.a.Fz()||(k.a.dh(this.HSc),this.HSc=null);K.DOMElementExtensions.$m(this.Nmb);this.q5a=this.Nmb=null;super.dispose()}O9a(ab){ab&&(V.a.instance.Qa(e.a.click,ab,this.Hkg),r.a.instance.Qa(e.a.Ui,ab,this.Ikg),X.a.instance.Qa(e.a.qj,ab,this.Jkg))}K7k(ab){!this.q5a&&this.svgIconProvider&&
(this.q5a=this.svgIconProvider.Mna(na.a.FAi,this.JId,this.KId,this.Akb,void 0,void 0,void 0,this.AAi))&&this.q5a.classList.add("ewa-fb-function-button-img");this.Nmb&&this.q5a&&(K.DOMElementExtensions.setVisible(this.Nmb,!ab),K.DOMElementExtensions.setVisible(this.q5a,ab))}}Object(z.a)(ja,"FormulaBarFunctionControl",t.a,[]);var ea=a(327),Z=a(193),ba=a(53),ya=a(10),Qa=a(174),va=a(159),Ia=a(13),Sa=a(1);const Xa=O.a.Fz()?1:2;class da{constructor(ab){this.aIa=this.expandButton=this.aJa=this.Fad=this.Ead=
this.Dad=null;this.YIc=this.XVd=this.Maa=!1;this.Wbf=this.xIg=0;this.VDb=O.a.Fz()?16:0;this.pWe=0;this.Iyc=O.a.Fz()?24:Qa.c;this.Xga=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.GOc=La=>{this.jyf();La.La.rawEvent.preventDefault();return!0};this.COc=La=>{this.XVd=!0;this.xIg=La.clientPoint.y;document.body.classList.add(v.a.lvf);this.Maa||(this.G6a=0);this.Oib.Ba("mousemove",this.Bjg,!0);this.Oib.Ba("touchmove",this.Bjg);this.Oib.Ba("mouseup",this.t9d);this.Oib.Ba("touchend",
this.t9d);this.Oib.Ba("mouseleave",this.t9d);return!0};this.t9d=()=>{this.XVd=!1;this.G6a=O.a.Fz()?this.Maa?this.aJa.clientHeight-this.Iyc:0:this.Pv.clientHeight-this.Iyc;document.body.classList.remove(v.a.lvf);this.Oib.TO();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Pv.clientHeight} pixel`)};this.Bjg=La=>{this.XVd?(La=Ia.HelperMethods.XQb(La).y,La=this.kJf(this.G6a+Math.min(La,this.$.domElement.clientHeight-75)-this.xIg),
this.Maa=La>=this.lineHeight,K.DOMElementExtensions.toggleCssClass(this.Pv,v.a.mvf,this.Maa),La=this.Iyc+Math.round(Math.max(La-Xa,0)),(O.a.Fz()?this.aJa.clientHeight:this.Pv.clientHeight)!==La&&(this.Pv.style.height=La+"px",this.$.F6a())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.ZY=La=>{this.Maa&&(this.hZa=Math.round((Math.round(this.hZa/this.lineHeight)+(0<La.TCa?1:-1))*this.lineHeight));La.La.preventDefault();
return!1};this.LP=()=>{this.fsk();this.YIc&&(ea.a.instance.Qa(e.a.pS,document.body,this.LP),ea.a.instance.Qa(e.a.BMa,document.body,this.LP),Z.a.instance.Qa(e.a.ml,document.body,this.LP),this.YIc=!1);return!1};this.onActiveCellChanged=()=>{this.hZa=0};this.Lpg=La=>{this.YIc||(ea.a.instance.xa(e.a.pS,document.body,this.LP),ea.a.instance.xa(e.a.BMa,document.body,this.LP),Z.a.instance.xa(e.a.ml,document.body,this.LP),this.YIc=!0);La.preventDefault()};this.onScroll=La=>pb=>{La.onScroll();this.Lpg(pb)};
this.W_j=La=>{this.hZa=this.Wbf;La.preventDefault()};this.$=ab;this.Oib=va.a.instance.uXa(document.body.ownerDocument)}get lineHeight(){return this.VDb?this.VDb:ya.a.QBf}set lineHeight(ab){this.VDb=ab}get Pv(){const {FormulaBar:ab}=a(1160);this.Dad||(this.Dad=ab.aHf(this.$));return this.Dad}get Jyc(){this.Ead||(this.Ead=document.getElementById(w.a.qQb));return this.Ead}get B0(){this.Fad||(this.Fad=document.getElementById(w.a.qQb+"_"+w.a.Nwe));return this.Fad}get hZa(){return this.B0.scrollTop}set hZa(ab){this.Wbf=
ab;this.B0.scrollTop!==ab&&(this.B0.scrollTop=ab)}get uzi(){return 2*this.lineHeight-Xa}get G6a(){return this.pWe}set G6a(ab){this.pWe=ab}jyf(){this.Maa=!this.Maa;K.DOMElementExtensions.toggleCssClass(this.Pv,v.a.mvf,this.Maa);this.Maa&&!this.G6a&&(this.G6a=this.uzi);this.Pv.style.height=this.Iyc+(this.Maa?this.G6a:0)+"px";this.expandButton.setAttribute(w.a.rD,this.Maa?"Collapse the formula bar":"Expand the formula bar");this.$.F6a();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.Maa?
"expanded":"collapsed"}`)}v$h(ab){this.aJa=document.createElement("div");this.aJa.id=this.$.xi+w.a.nId;this.aJa.className=v.a.Eoi;this.expandButton=da.o6h(this.$.xi,ab);this.aJa.appendChild(this.expandButton);this.aIa=da.O5h(this.$.xi);this.aJa.appendChild(this.aIa);return this.aJa}yik(){ea.a.instance.xa(e.a.Py,this.expandButton,this.GOc);Z.a.instance.xa(e.a.Jm,this.expandButton,this.GOc);ea.a.instance.xa(e.a.Py,this.aIa,this.COc);Z.a.instance.xa(e.a.Jm,this.aIa,this.COc)}Bik(ab){ea.a.instance.xa(e.a.fN,
this.Jyc,this.ZY);ba.a.addHandler(this.B0,e.a.scroll,this.Xga?this.onScroll(ab):this.Lpg);O.a.Fz()&&ba.a.addHandler(this.B0,e.a.scrollEnd,this.LP);ba.a.addHandler(this.B0,e.a.focus,this.W_j);C.f(this.$).ha.add_activeCellChanged(this.onActiveCellChanged)}m5k(){void 0!==this.expandButton&&null!==this.expandButton&&(ea.a.instance.Qa(e.a.Py,this.expandButton,this.GOc),Z.a.instance.Qa(e.a.Jm,this.expandButton,this.GOc));void 0!==this.aIa&&null!==this.aIa&&(ea.a.instance.Qa(e.a.Py,this.aIa,this.COc),Z.a.instance.Qa(e.a.Jm,
this.aIa,this.COc));void 0!==this.Jyc&&null!==this.Jyc&&ea.a.instance.Qa(e.a.fN,this.Jyc,this.ZY);C.f(this.$).ha.remove_activeCellChanged(this.onActiveCellChanged)}fsk(){this.hZa=Math.round(this.kJf(this.hZa))}kJf(ab){return Math.round(ab/this.lineHeight)*this.lineHeight}static o6h(ab,La){const pb=document.createElement("a");pb.id=ab+w.a.xzi;pb.classList.add(v.a.voi);K.DOMElementExtensions.oL(pb,w.a.FF);pb.setAttribute(w.a.rD,"Expand the formula bar");La.Mna(na.a.o_h,12,12,pb,O.a.Fz()?20:null,O.a.Fz()?
20:null).classList.add(v.a.woi);return pb}static O5h(ab){const La=document.createElement("div");La.id=ab+w.a.vzi;La.className=v.a.uoi;return La}}Object(z.a)(da,"FormulaBarResizeControl",null,[]);D=a(265);var Ea=a(46),qa=a(683),za=a(190),ma=a(103),Da=a(44),Ua=a(1360);class ka{}ka.disabled="disabled";ka.KTk="stale";ka.text="text";ka.D9j="presentationMode";ka.viewMode="viewMode";Object(z.a)(ka,"NameBoxStateUpdateKey",null,[]);var xa=a(152),Fb=a(171);class bb extends D.a{constructor(ab,La){super(document.createElement("div"));
this.$=ab;this.hm=null;this.Mwe="";this.S1k=()=>{this.$.Ma.VSb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.U9d=()=>{this.YV(this.da.ha.GKf())};this.vq=(pb,ia)=>{this.Vpa(pb,ia);this.U6b(pb,ia)};this.U6b=()=>{let pb=Ua.c(this.$,this.da);qa.c(pb,!0)||(this.hm&&(pb=this.$.Yh.getItemByName(this.hm))&&pb.deactivate(),this.YV(this.da.ha.qa.activeCell.toString()))};this.n0b=(pb,ia)=>{var kb,fb,hb,Jb,ub;!(pb=ia.ma)||Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")&&
(null===(kb=ia.IB)||void 0===kb?void 0:kb.name)===(null===pb||void 0===pb?void 0:pb.name)&&(null===(fb=ia.IB)||void 0===fb?void 0:fb.usedRange.top)===(null===pb||void 0===pb?void 0:pb.usedRange.top)&&(null===(hb=ia.IB)||void 0===hb?void 0:hb.usedRange.bottom)===(null===pb||void 0===pb?void 0:pb.usedRange.bottom)&&(null===(Jb=ia.IB)||void 0===Jb?void 0:Jb.usedRange.left)===(null===pb||void 0===pb?void 0:pb.usedRange.left)&&(null===(ub=ia.IB)||void 0===ub?void 0:ub.usedRange.right)===(null===pb||void 0===
pb?void 0:pb.usedRange.right)||(kb=pb.usedRange,2===pb.type&&(kb=za.a(pb)),fb=this.da.ha.qa.Bn,hb=this.da.inRangePicker||this.da.kq,Jb=!1,2===pb.type&&fb&&!hb&&(fb=this.da.ha.qa.activeRange,Jb=pb.sheetName===this.$.sa.ma.name&&!!fb&&fb.top===kb.top&&fb.left===kb.left&&fb.bottom===kb.bottom&&fb.right===kb.right),kb=Ea.x(kb,this.$),kb.NamedObjectName=pb.name,kb.SheetName=pb.sheetName,this.da.np(kb,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,ia.disableAutoFocusOnGrid),
ia=qa.a(pb.name),this.YV(ia.name,ia.fullName))};this.Tu=()=>{const pb=Ua.b(this.da);null!=pb&&this.YV(pb.name)};this.vkg=(pb,ia)=>{this.U9d(pb,ia)};this.L1b=()=>{this.Nuc(!0)};this.K1b=()=>{this.Nuc(!1)};this.mx=()=>{Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)?this.H7k(!this.$.isEditMode):this.Nuc(!this.$.isEditMode)};this.kng=()=>{Da.a(this.$).eL(xa.a.yzi,Fb.a.vj)};this.$Y=(pb,ia)=>{this.XPg(ia.YT)};this.onKeyDown=pb=>pb.La.keyCode===b.a.XQa?(this.da.focus(),
!0):!1;this.Vpa=()=>{this.B3c({[ka.KTk]:!0})};this.da=C.f(ab);this.kbj(La);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")||(this.YV(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?this.da.ha.ENd():this.da.ha.qa.activeCell.toString(),"",!0),this.Nuc(!Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)&&!this.$.isEditMode));this.XPg(Da.a(this.$).tv());this.Hp();r.a.instance.xa(e.a.Ui,
this.domElement,this.onKeyDown.bind(this))}get text(){return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8654931_readNameBoxTextFromReact")?appChrome.getNameBoxText():this.Mwe}dispose(){if(this.$){this.$.vh.YFg(this.L1b.bind(this));this.$.vh.XFg(this.K1b.bind(this));var ab=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8768614_FixNameBoxNullReferences");ab&&!this.$.ea||this.$.ea.nZ(this.mx.bind(this));var La=ma.a(this.$);if(!ab||La)La.AUc(this.vkg.bind(this)),La.mje(this.Tu.bind(this));La=Da.a(this.$);
ab&&!La||La.Tm.HAa(this.$Y.bind(this));ab&&!this.$.ea||!this.$.Yh||(this.$.Yh.Gn(this.n0b.bind(this)),this.$.Yh.EUc(this.U6b.bind(this)),this.$.Yh.EUc(this.XBg.bind(this)),this.$.Yh.gca(this.Vpa.bind(this)),this.$.Yh.FAa(this.Vpa.bind(this)),this.$.Yh.GAa(this.Vpa.bind(this)),this.$.Yh.H4b(this.Vpa.bind(this)));this.$.sa&&this.$.sa.Gn(this.vq.bind(this))}this.da&&(ab=this.da.ha,ab.D7(this.U6b.bind(this)),ab.hca(this.U9d.bind(this)),ab.$e.NV(this.Tu.bind(this)));super.dispose()}G7k(ab){this.B3c({[ka.D9j]:ab})}H7k(ab){this.B3c({[ka.viewMode]:ab})}kbj(ab){const La=
document.getElementById(this.$.xi+w.a.RBf);void 0!==La&&null!==La&&ab.removeChild(La);appChrome.renderNameBoxUI(this.domElement,this.wQi(),this.S1k.bind(this));ab.insertBefore(this.domElement,ab.firstChild)}wQi(){return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")?{[ka.disabled]:Da.a(this.$).tv()||!Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)&&!this.$.isEditMode,[ka.text]:Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?
this.da.ha.ENd():this.da.ha.qa.activeCell.toString()}:{}}Hp(){this.$.vh.g5e(this.L1b.bind(this));this.$.vh.f5e(this.K1b.bind(this));this.$.ea.nX(this.mx.bind(this));const ab=this.da.ha;this.$.Yh.pn(this.n0b.bind(this));this.$.sa.pn(this.vq.bind(this));ab.T3(this.U6b.bind(this));ab.R9(this.U9d.bind(this));ab.$e.jO(this.Tu.bind(this));ma.a(this.$).qpd(this.Tu.bind(this));ma.a(this.$).fmc(this.vkg.bind(this));Da.a(this.$).Tm.Wta(this.$Y.bind(this));this.$.Yh.jmc(this.U6b.bind(this));this.$.Yh.jmc(this.XBg.bind(this));
this.$.Yh.S3(this.Vpa.bind(this));this.$.Yh.Tta(this.Vpa.bind(this));this.$.Yh.Uta(this.Vpa.bind(this));this.$.Yh.oeb(this.Vpa.bind(this))}XPg(ab){ab?this.domElement.addEventListener("pointerdown",this.kng):this.domElement.removeEventListener("pointerdown",this.kng);this.C_k(ab)}C_k(ab){for(let La=0;La<this.domElement.children.length;La++)this.domElement.children[La].style.pointerEvents=ab?"none":""}YV(ab,La="",pb=!1){this.Mwe=ab;this.hm=""!==La?La:this.hm;appChrome.setNamedObjectOrActiveCellRange(La,
ab,pb)}Nuc(ab){this.B3c({[ka.disabled]:ab})}XBg(ab,La){Ua.a(this.$,!0);this.Vpa(ab,La)}B3c(ab){appChrome.updateNameBoxState(ab)}}Object(z.a)(bb,"NameBox",D.a,[2]);var Ja=a(176),mb=a(156);const sa=v.a.Bgg+" "+v.a.i0,oa=v.a.Adf+" "+v.a.i0;class cb extends t.a{constructor(ab=null,La,pb,ia){super();this.qKb=this.j0b=this.rKb=this.k0b=this.sO=this.IP=null;this.XR=this.FIc=!1;this.SCg=()=>{this.da.uU.Fv(this.Cn);this.da.uU.jy(this.Rl);this.FIc=!0};this.Cn=()=>{this.f1g(!0)};this.Rl=()=>{this.f1g(!1)};this.Vng=
fb=>this.kOc(!0,`OkCancelEditControl.OnOkClick: ${fb.Dh}`,Ia.HelperMethods.oA(fb));this.Wng=fb=>this.kOc(!0,`OkCancelEditControl.OnOkKeyDown: ${fb.Dh}`);this.Ohg=fb=>this.kOc(!1,`OkCancelEditControl.OnCancelClick: ${fb.Dh}`,Ia.HelperMethods.oA(fb));this.Rhg=fb=>this.kOc(!1,`OkCancelEditControl.OnCancelKeyDown: ${fb.Dh}`);this.lJ=()=>{this.B_k(!this.$.isEditMode)};this.onPointerDown=()=>{this.da.isEditing&&(this.da.Bp.Wa.LM=!0);return!1};const {FormulaBar:kb}=a(1160);this.$=pb;this.da=C.f(pb);this.XR=
O.a.XR();ia?(this.k0b=ia.m_a(na.a.cff,16),this.rKb=ia.m_a(na.a.kdi,16),O.a.Fz()||(this.j0b=ia.m_a(na.a.EWh,16),this.qKb=ia.m_a(na.a.ldi,16),this.k0b.style.display="none",this.rKb.style.display="none")):(this.k0b=db.b(16,16,v.a.Zpi,la.a.An(1),null,null,!0,La.ia(1041)),this.rKb=db.b(16,16,v.a.dqi,la.a.An(1),null,null,!0,La.ia(1042)));O.a.Fz()?(this.IP=K.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+kb.VNc),this.sO=K.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+kb.Ipc)):
(this.p8d=ab.hoc(kb.VNc,kb.VNc,sa,"",""),this.IP=this.p8d.domElement,this.pud=ab.hoc(kb.Ipc,kb.Ipc,oa,"",""),this.sO=this.pud.domElement);this.IP.appendChild(this.k0b);this.sO.appendChild(this.rKb);O.a.Fz()?(this.IP.classList.add(v.a.Gua),this.sO.classList.add(v.a.Gua),K.DOMElementExtensions.toggleCssClass(this.IP,v.a.xjb,!this.$.isEditMode),K.DOMElementExtensions.toggleCssClass(this.sO,v.a.xjb,!this.$.isEditMode)):(this.IP.appendChild(this.j0b),this.sO.appendChild(this.qKb));this.da.cellTextEditBox.Fv(this.Cn);
this.da.cellTextEditBox.jy(this.Rl);O.a.Fz()&&pb.ea.cK(this.lJ);V.a.instance.xa(e.a.click,this.IP,this.Vng);r.a.instance.xa(e.a.Ui,this.IP,this.Wng);X.a.instance.xa(e.a.qj,this.IP,this.onPointerDown);V.a.instance.xa(e.a.click,this.sO,this.Ohg);r.a.instance.xa(e.a.Ui,this.sO,this.Rhg);X.a.instance.xa(e.a.qj,this.sO,this.onPointerDown);this.XR&&this.da.WBh(this.SCg)}dispose(){this.da&&this.da.cellTextEditBox&&(this.da.cellTextEditBox.zv(this.Cn),this.da.cellTextEditBox.qx(this.Rl));this.da&&this.XR&&
(this.da.Slk(this.SCg),this.FIc&&(this.da.uU.zv(this.Cn),this.da.uU.qx(this.Rl),this.FIc=!1));this.IP&&(V.a.instance.Qa(e.a.click,this.IP,this.Vng),r.a.instance.Qa(e.a.Ui,this.IP,this.Wng),X.a.instance.Qa(e.a.qj,this.IP,this.onPointerDown),this.IP=null);this.sO&&(V.a.instance.Qa(e.a.click,this.sO,this.Ohg),r.a.instance.Qa(e.a.Ui,this.sO,this.Rhg),X.a.instance.Qa(e.a.qj,this.sO,this.onPointerDown),this.sO=null);O.a.Fz()||(k.a.dh(this.p8d),this.p8d=null,k.a.dh(this.pud),this.pud=null);O.a.Fz()&&this.$&&
this.$.ea.XH(this.lJ);O.a.Fz()||(K.DOMElementExtensions.$m(this.qKb),this.qKb=null,K.DOMElementExtensions.$m(this.j0b),this.j0b=null);super.dispose()}B_k(ab){Object(mb.c)(()=>{this.IP&&this.sO&&(K.DOMElementExtensions.toggleCssClass(this.IP,v.a.xjb,ab),K.DOMElementExtensions.toggleCssClass(this.sO,v.a.xjb,ab))},this.$.ya)}kOc(ab,La,pb=null){const ia=this.da.Bp;if(pb){const kb=this.da.vA?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let fb;fb=[Object(Ja.a)(this.da.cellTextEditBox.Wa.jQa)];
Ja.b(this.$).SA(pb.rawEvent,kb,fb)}this.FIc&&this.da.uU.OO?this.da.uU.endEdit(ab,La,0):ia.endEdit(ab,La,0);this.da.focus();return!0}f1g(ab){if(O.a.Fz())ab?(this.IP.classList.remove(v.a.Gua),this.sO.classList.remove(v.a.Gua)):(this.IP.classList.add(v.a.Gua),this.sO.classList.add(v.a.Gua));else{const La=ab?"block":"none";ab=ab?"none":"block";this.k0b.style.display=La;this.rKb.style.display=La;this.j0b.style.display=ab;this.qKb.style.display=ab}}}Object(z.a)(cb,"OkCancelEditControl",t.a,[]);var Ka=a(329),
Oa=a(338),gb=a(69),bc=a(211),Dc=a(12),ad=a(325),Ac=a(234),mc=a(328),Gb=a(155),Ba=a(162),Xb=a(45),Ab=a(433),Db=a(243),xc=a(161),vc=a(383),zb=a(746);class tb extends n.a{constructor(ab,La,pb=null){super(C.f(ab));this.LBa=La;this.tMe=this.PF=this.clearContentNotifier=this.nameBox=this.Pv=this.p0g=null;this.hCe=!1;this.B0=null;this.PTg=this.X0f=this.tGc=this.Zbf=this.nDc=!1;this.Xga=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.xoj=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8614675_partialInteractivityFormulaBar");
this.a2f=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8704306_RemoveRegionHeightAfterFormulaBarVisible");this.Cn=()=>{this.hCe=!1;this.Xpe();this.tGc&&this.u$b(!this.SZf)};this.Rl=()=>{this.Xpe();this.tGc&&this.u$b(!1)};this.u$b=(ia,kb=!1)=>{if(tb.Cwa&&this.Zbf!==ia){if(O.a.Fz()){const fb=()=>{tb.Cwa&&(K.DOMElementExtensions.toggleCssClass(tb.Cwa,v.a.xjb,ia),K.DOMElementExtensions.toggleCssClass(tb.Cwa,v.a.Gua,ia))};kb?fb():Object(mb.c)(()=>{fb()},this.$.ya)}else K.DOMElementExtensions.toggleCssClass(tb.Cwa,
v.a.Gua,ia);this.Zbf=ia}};this.nrg=()=>{this.isEditing||this.Wa.disabled||this.startEdit(!0,!1,null)};this.Zv=()=>{this.wPa()};this.$Y=(ia,kb)=>{this.wPa();tb.Cwa&&(kb.YT?this.xoj?this.u$b(!0):tb.Cwa.classList.add(v.a.Gua):this.Omc())};this.FA=(ia,kb)=>{ia=this.grid;this.hCe=!0;this.isEditing?(this.pWb||(kb.xGc||this.TZ(null),this.raiseEvent(n.a.zKb,kb)),this.pWb||ia.cellTextEditBox.Wa.isCursorAttached()&&!this.Wa.isCursorAttached()&&ia.cellTextEditBox.Wa.clearCursorFormatLocation()):ia.isEditing&&
this.wPa()};this.onBlockCacheItemChanged=(ia,kb)=>{(ia=this.grid.ha.qa.activeCell)&&(kb=this.grid.AL(kb.mj.hash))&&ia.Xi(kb.yj)&&this.wPa()};this.N$d=(ia,kb)=>{-185374993===kb.command&&this.wPa()};this.onActiveItemChanged=()=>{this.wPa();S.TaskExtensions.Xa(J.a(this.$.la),()=>{this.pPg()},this.ya,11)};this.SY=()=>{this.pPg();O.a.n1a()?this.LBa.o3k(this.tMi()):(Xb.a.instance.Y1(w.a.r5,vc.a.c$b),Xb.a.instance.sZ(w.a.r5,vc.a.c$b));Xb.a.instance.jca(w.a.r5,vc.a.Gbf)};this.onKeyDown=ia=>{if(ia.La.keyCode===
b.a.CG){var kb=this.GJa();const fb=K.DOMElementExtensions.DE(kb);kb=K.DOMElementExtensions.jaa(kb);return K.DOMElementExtensions.F7a(ia.La,fb,kb)}return!1};this.lJ=()=>{this.Omc()};this.Ucj=()=>{this.Pv?(this.nameBox=new bb(this.$,this.Pv),this.yqk()):this.dHg()};pb||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");O.a.n1a()&&(La||c.ULS.sendTraceTag(507609984,0,10,"FormulaBar.ctor: SkeletonManager must always exist."));this.tMe=new da(ab);this.initialize(this.qpe(ab,
pb));this.gZa.yik();!this.a2f&&h.AFrameworkApplication.ra.$g.el&&(La=document.getElementById("AdditionalBarsRegion"))&&(La.style.height="");this.CVd=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.aM=new Ka.a(this.Pv,1);this.dlj=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");O.a.Fz()&&Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8773064_FormulabarRemovePseudoClass")?(this.lId=new ja(void 0,Dc.a.instance,ab,
pb),this.Agg=new cb(void 0,Dc.a.instance,ab,pb)):(this.XEc=new M(ab),this.XEc.hoc(w.a.d1g,w.a.d1g,w.a.y_k+" cui-TabRowRight",M.VQh,M.XQh),this.lId=new ja(this.XEc,Dc.a.instance,ab,pb),this.Agg=new cb(this.XEc,Dc.a.instance,ab,pb));this.p0g=Db.b(()=>{this.XQg()},1,this.$.ya,"FormulaBar.setTextBoxForActiveItem",!0);ab.sa.pn(this.onActiveItemChanged);pb=this.grid;pb.cellTextEditBox.Fv(this.Cn);pb.cellTextEditBox.jy(this.Rl);pb.cellTextEditBox.aVa(this.FA);pb.hO(this.Zv);pb.za.kz(this.onBlockCacheItemChanged);
pb.za.Sta(this.onBlockCacheItemChanged);pb.tmc(this.N$d);Da.a(ab).Tm.Wta(this.$Y);ab.ea.cK(this.lJ);ma.a(ab).qpd(this.Zv);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&ab.la.fi(313,ia=>{this.clearContentNotifier=ia;this.clearContentNotifier.uod(this.FA)});r.a.instance.xa(e.a.Ui,this.hj,this.onKeyDown);pb=this.Wa.style;ad.c(pb,ab.isChromeRtl,"0px");pb.textAlign=this.kXf?"right":"left";this.isVisible=!1;this.CVd&&(this.Wa.isVisible=!1);pb=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8654712_PopulateFBTextBoxBeforeCommandUIAttach");
pb||(E.a(this.$).WFa(this.SY),this.$.ea.eya&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.SY(null,null)));Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8605252_FormulaBarInitStateFix")?this.XQg():this.wPa();Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8740111_setDisabledModeSyncInFormulaBarInit")?this.Omc(!0):this.Omc();this.Wa.jTg=!0;this.Ecj();l.a(ab).Tq(this);this.Wa.i4e(this.nrg);this.pWb=!1;this.PF=new L(this.$,
this);this.Raj();pb&&this.ovk();this.Wa.Qea(()=>{Xb.a.instance.jca(w.a.r5,vc.a.T_g);this.toggleEditingEvents(!1)});this.tGc=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(ab){this.isEditing?this.Wa.setPlainText(ab):super.text=ab}get isEditing(){return super.isEditing}set isEditing(ab){super.isEditing=ab;this.toggleEditingEvents(ab)}get SZf(){return this.yEc||0>=this.text.length}get F9b(){return!0}get formattedText(){return this.Wa.getFormattedText()}set formattedText(ab){this.Wa.setFormattedText(ab)}get MVb(){return this.isEditing}get isVisible(){return K.DOMElementExtensions.isVisible(this.Pv)}set isVisible(ab){this.CVd?
K.DOMElementExtensions.setVisible(this.Pv,ab):(K.DOMElementExtensions.setVisible(this.Pv,ab),this.Wa.isVisible=ab)}get hj(){return this.Pv}get $o(){return this.isVisible}get hl(){return R.a.mId}get gZa(){return this.tMe}Up(ab,La){ab=!1;La||(ab=this.Hyi());return ab}dispose(){const ab=this.$;if(ab){ab.sa.Gn(this.onActiveItemChanged);var La=this.grid;La.cellTextEditBox.zv(this.Cn);La.cellTextEditBox.qx(this.Rl);La.cellTextEditBox.t6a(this.FA);La.VP(this.Zv);La.za.Vy(this.onBlockCacheItemChanged);La.za.Tub(this.onBlockCacheItemChanged);
Da.a(this.$).Tm.HAa(this.$Y);ab.ea.XH(this.lJ);ma.a(ab).mje(this.Zv);La=E.a(this.$);r.a.instance.Qa(e.a.Ui,this.hj,this.onKeyDown);this.gZa.m5k();La&&La.x6a(this.SY);l.a(ab).WH(this);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.tUc(this.FA),ab.la.wma(313))}this.Wa&&this.Wa.hFg(this.nrg);k.a.gj([this.aM,this.lId,this.Agg,this.XEc,this.nameBox]);k.a.dh(this.PF);this.Pv&&(K.DOMElementExtensions.jM(this.Pv),
this.Pv.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.Pv=null;super.dispose()}endEdit(ab,La,pb,ia=null){this.Wa.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:ab,["Caller"]:La});this.dyb(!1);if(this.isEditing){var kb=null;ia&&(kb=this.$.shortcutKeyManager.ED(ia));var fb=this.grid.Fh;this.isEditing=!1;this.tO(!0);this.epb()&&this.grid.NI&&this.grid.NI.rkb&&this.grid.NI.owb(w.a.fUb);if(ab){var hb=new y.a(this.grid.ha.qa.activeCell,
fb.text,fb.text,!1,this.grid.$.sa.ma);this.izg(hb);null!==hb&&(fb.text=hb.newValue)}else this.Wa.setPlainText(this.text);hb=new B.a(this.grid.ha.qa.activeCell,fb.text,ab,ia);this.qfe(hb);fb.endEdit(ab,`${La}->FormulaBar.EndEdit`,pb,ia);this.n3f(kb)||fb.Wa.focus();this.Wa.v9b("FormulaBar.EndEdit")}else this.Wa.v9b("FormulaBar.EndEdit",{["IsEditing"]:"false"})}Zma(ab,La,pb,ia=!0,kb=!0){super.Zma(ab,La,pb,ia,kb);this.grid.Fh.Zma(ab,La,pb,ia,kb)}axg(ab){const La=this.grid.Fh,pb=this.Wa.selection;pb.length&&
La.Zma(pb.index,pb.length,ab,!1,!1)}sq(ab){return K.DOMElementExtensions.eo(this.Pv,ab)}Js(){h.AFrameworkApplication.ra.Im.Av(this.hl)}lu(){}W5g(ab){this.nameBox.G7k(ab);this.lId.K7k(ab)}BAe(){if(this.B0){var ab=Object(xc.g)(this.text);this.nDc!==ab&&(this.YQg(ab),this.nDc=ab)}}D8d(){this.Wa.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const ab=this.grid.Fh;ab.isEditing&&this.isEditing&&(ab.formattedText=this.formattedText,ab.setCaretPosition(this.Wa.caretPosition))}A1b(ab){this.Wa.disabled||
(this.grid.cellTextEditBox.Wa.LM=!0,this.isEditing||this.startEdit(!1,!0,ab),this.Nua())}xsb(){this.lZ&&(this.bX=this.Wa.caretPosition,this.t3=this.Wa.vqa.length);this.TZ(null);this.LAa();this.u3g()}Vza(ab){var La=this.$.shortcutKeyManager.ED(ab);const pb=this.pWb;1872288872===La||125627505===La||267796030===La?super.Vza(ab):pb?gb.g(ab):this.isEditing&&this.grid.Fh.isEditing&&(La=this.grid.Fh,La.formattedText=this.formattedText,La.setCaretPosition(this.Wa.caretPosition),this.d3c(),0===this.Wa.selection.length&&
this.TZ(null,null),this.dlj&&this.inRangePicker&&this.Hue(),super.Vza(ab))}Jj(ab,La){this.isEditing&&super.Jj(ab,La)}Ry(ab,La){this.isEditing&&super.Ry(ab,La)}ovk(){this.$.ea.eya?(c.ULS.sendTraceTag(507585433,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.SY(null,null)):E.a(this.$).WFa(this.SY)}Raj(){const ab=this.grid.zh(void 0);ab?(this.nDc=ab.DC||Object(xc.g)(ab.text),this.YQg(this.nDc)):c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}YQg(ab){K.DOMElementExtensions.toggleCssClass(this.B0,
v.a.AEd,ab)}qpe(ab,La){this.Pv=tb.aHf(ab);this.Pv.classList.add(v.a.zoi);this.Pv.classList.add(v.a.Aoi);O.a.Fz()&&this.Pv.classList.add(v.a.xoi);Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentStylingEnabled",!1)&&this.Pv.classList.add("ewa-fb-fluent-border-highlight");Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentHighLightsEnabled",!1)&&this.Pv.classList.add("ewa-fb-fluent-formula-highlight");const pb=this.gZa.v$h(La);La=tb.Kzd();pb.appendChild(La);
tb.Cwa=tb.u6h(ab.xi);const ia=tb.n6h(),kb=tb.d8h(ab.xi),fb=tb.c8h(ab.xi),hb=tb.O4h(ab.xi);fb.tabIndex=-1;hb.tabIndex=-1;kb.appendChild(hb);kb.appendChild(fb);kb.appendChild(tb.Cwa);ia.appendChild(kb);ia.appendChild(pb);ab=tb.G7h(ab.xi);this.Pv.appendChild(ab);this.Pv.appendChild(ia);const Jb=new mc.a(La,!0,!1);this.B0=La;this.gZa.lineHeight=Jb.uMi();Jb.Qea(()=>{Ab.c(Jb.Yl,m.a.ariaLabel,"formula bar")});Jb.Qea(()=>{this.gZa.Bik(this.Xga?{onScroll:()=>this.sfe()}:{})});Jb.isVisible=!1;return Jb}B4a(ab){this.WSc(ab);
super.B4a(ab);Gb.b(this.$).Aj(N.a.Fzi,{["Location"]:"canvas"});x.a.oo&&window.focus();const La=this.$.shortcutKeyManager.ED(ab);this.R9j(ab,La);this.Wa.disabled||this.isEditing||this.startEdit(!0,!1,ab);let pb;pb={};pb.wasEditing=this.isEditing;pb.formulaBar=!0;let ia=this.Cq(ab,La);!ia&&bc.d(La,this.sob,!0)&&(ia=this.n3f(La)?!0:this.grid.ha.Cq(ab,La,pb));ia||Ba.a(this.$).s3d(ab,0,7)}startEdit(ab,La,pb){const ia=this.grid;if(!this.isEditing||!ia.isEditing){this.Wa.v9b("FormulaBar.StartEdit");this.Wa.addEventLogRecord("FormulaBar.StartEdit",
{["SetCaretPositionToEnd"]:ab,["IsOnMouseDown"]:La});Gb.b(ia.$).Aj(N.a.Ezi,{["Location"]:"canvas"});this.isEditing=this.pWb=!0;ia.KB&&ia.KB.QXc(this);ia.cellTextEditBox.tO(!1);ia.cellTextEditBox.Wke();this.Ipe(!1);var kb=()=>{var fb=ia.$.sa.ma;const hb=ia.zh(null);fb=new A.a(hb,fb,void 0,void 0,void 0,this.dMd(hb));this.rfe(fb);this.e7b(ia.cellTextEditBox.Wa.QO);fb=()=>{if(this.isEditing&&ia.isEditing){ia.isEditing&&ia.cellTextEditBox.Wa.detachCursorFormat();if(!this.TZ(null)){const ub=ia.cellTextEditBox.formattedText;
var Jb=this.Wa.caretPosition;const nb=ub.Text.length;Jb=this.Wa.text.length!==nb?nb:Jb;this.formattedText=ub;this.Wa.caretPosition=Jb}this.pWb=!1;this.Wa.clearHistory()}else this.isEditing=!1};Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePostTaskHelperInFormulaBarStartEdit",!1)?void Object(mb.b)(fb):setTimeout(fb,0);ia.cellTextEditBox.eIg()};if(ia.isEditing)ia.xM=1,kb();else if(this.Wa.LM=!0,S.TaskExtensions.Xa(ia.startEdit(!1,1,pb,!1,void 0,La,1),fb=>{fb.result?(ia.isEditing||
(this.Wa.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.isEditing&&ia.isEditing?(ia.cellTextEditBox.Wa.LM=!0,fb=ia.zh(null),this.Wa.nBf(Number.NaN,this.dMd(fb)),ab&&this.Wa.setCaretPositionToEnd(),kb()):this.isEditing=!1):this.isEditing=!1},this.ya,11),this.Wa.LM=!1,La=ia.zh(null),null===La||void 0===La?0:La.jXd)this.Wa.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),
this.text=Ia.HelperMethods.VYg(this.text)}}dQd(ab){super.dQd(ab);this.tGc&&this.grid&&this.grid.isEditing&&2===ab&&this.u$b(!this.SZf)}onActiveCellChanged(ab,La){super.onActiveCellChanged(ab,La);this.Xpe()}S7a(ab){Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!ab}`);super.S7a(ab)}Xpe(){const ab=this.grid;ab.isEditing&&2===ab.xM||this.wPa()}sm(){var ab=
this.grid;this.isEditing&&ab.isEditing&&(ab=ab.Fh,ab.text=this.text,ab.setCaretPosition(this.Wa.caretPosition),this.inRangePicker&&this.Wa.focus())}wPa(){this.p0g()}WGk(){if(this.Wa){var ab=this.grid;this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Wa.initialized,["Grid.IsEditing"]:ab.isEditing});if(!this.isEditing){var La=Da.a(this.$).tv();this.Pv.disabled=La||!this.$.isEditMode;var pb=(La=this.$.JX===ab)&&1===ab.ha.Ck;
this.Wa.initialized&&(this.Wa.disabled=this.Pv.disabled||La&&!pb);La=new Ac.a(this.Wa.style);var ia=!1;if(pb)if(ab.isEditing)this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),pb=ab.cellTextEditBox.text;else{ia=ab.zh(null);pb=new aa.a(this.$.sa);if(!ia||!pb.Zob(ia.range,ab))return;ab=pb.wn;pb=ia.un;var kb=ia.formulaBarText;const fb=ia.text;this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",
{["sheetProtection.IsLocked"]:ab,["activeCell.IsHidden"]:pb,["activeCell.FormulaBarText"]:!!kb,["activeCell.Text"]:!!fb});pb=ab&&pb?"":kb||fb;ia=ia.cte}else pb="",kb=ab.ha.$e.Lh,kb=(null===kb||void 0===kb?0:kb.floatingObject)?kb.floatingObject.Ch:null,64===ab.ha.Ck&&kb&&kb.IsShapeFormulaPresent&&((ab=(ab=kb.ShapeText)?ab.substring(ab.indexOf(zb.a.Kyc)+zb.a.Kyc.length,ab.indexOf(zb.a.$Bf)):null)?(this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),
pb="="+ab):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Ipe(ia);this.jDb=this.wpc();La.hF.direction=this.d6?u.a.rtl:u.a.g3a;La.hF.textAlign=this.d6?u.a.right:u.a.left;O.a.Fz()&&K.DOMElementExtensions.toggleCssClass(this.B0,v.a.Dwc,this.d6);La.Y9();this.text=pb}}}XQg(){if(!Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8759863_SetTextBoxForActiveItemInternalRefactor"))this.WGk();else if(this.Wa){var ab=
this.grid;this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Wa.initialized,["Grid.IsEditing"]:ab.isEditing});if(!this.isEditing){var La=Da.a(this.$).tv();this.Pv.disabled=La||!this.$.isEditMode;La=this.$.JX===ab;this.Wa.initialized&&(this.Wa.disabled=this.Pv.disabled||La&&!ab.bXd);if(ab=zb.a.dcf(ab))this.VGk(ab.$Ia),this.Ipe(ab.$ia),this.jDb=this.wpc(),La=new Ac.a(this.Wa.style),La.hF.direction=this.d6?u.a.rtl:u.a.g3a,
La.hF.textAlign=this.d6?u.a.right:u.a.left,O.a.Fz()&&K.DOMElementExtensions.toggleCssClass(this.B0,v.a.Dwc,this.d6),La.Y9(),this.text=ab.$Ia}}}VGk(ab){if(this.grid.bXd)if(this.grid.isEditing)this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"});else{ab=new aa.a(this.$.sa);const La=this.grid.zh(null);this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:ab.wn,
["activeCell.IsHidden"]:La.un,["activeCell.FormulaBarText"]:!!La.formulaBarText,["activeCell.Text"]:!!La.text})}else ab&&64===this.grid.ha.Ck&&this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"})}tMi(){return{formulaBarText:this.text,Z0:this.Z0(),o2a:this.d6,$ia:this.PTg}}pPg(){var ab=this.$.JX;if(this.CVd){var La=!!this.grid.uU&&this.grid.uU.OO;this.isVisible=ab=!!ab&&this.$.oId&&!this.$.ea.Kh.inEmbedView;La||(this.Wa.isVisible=
ab)}else this.isVisible=!!ab&&this.$.oId&&!this.$.ea.Kh.inEmbedView;this.a2f&&h.AFrameworkApplication.ra.$g.el&&(La=document.getElementById("AdditionalBarsRegion"))&&(La.style.height="",this.$.S0()&&(La=document.getElementById("RibbonRegion"),!this.X0f&&La&&(La.style.height="",this.$.NOb(),this.X0f=!0)));Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")&&O.a.n1a()?this.LBa.IM(w.a.w8a):this.$.kP(w.a.w8a);O.a.n1a()&&this.LBa.X4k();this.$.XP()}Ipe(ab){this.PTg=ab;K.DOMElementExtensions.toggleCssClass(this.Wa.domElement,
v.a.nvf,ab)}GJa(){return this.Pv.querySelectorAll(K.DOMElementExtensions.RI+", div[tabindex]")}DE(){return K.DOMElementExtensions.DE(this.GJa())}Hyi(){const ab=this.DE();return ab?(K.DOMElementExtensions.setFocus(ab),!0):!1}R9j(ab,La){La=-287251124===La||-1925065947===La||1764140053===La;Oa.a.ipb()&&La&&ab.preventDefault()}Omc(ab=!1){this.u$b(!this.$.isEditMode,ab);if(O.a.Fz()){const La=()=>{this.B0&&K.DOMElementExtensions.toggleCssClass(this.B0,v.a.xjb,!this.$.isEditMode)};ab?La():Object(mb.c)(()=>
{La()},this.$.ya)}}e7b(ab){this.Wa.QO=ab}toggleEditingEvents(ab){this.Wa.toggleEditingEvents(ab)}Ecj(){this.Pv?this.Ucj():this.dHg()}yqk(){O.a.n1a()?this.LBa.p3k(this.xQi()):(Xb.a.instance.Y1(w.a.r5,vc.a.mrb),Xb.a.instance.sZ(w.a.r5,vc.a.mrb));Xb.a.instance.jca(w.a.r5,vc.a.mrb)}xQi(){return{w_b:this.nameBox.text}}dHg(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}n3f(ab){return!this.hCe&&(125627505===ab||706199415===ab)}get text(){return super.text}static aHf(ab){return document.getElementById(ab.xi+
w.a.eib)}static n6h(){const ab=document.createElement("div");ab.className=v.a.toi;ab.classList.add(v.a.i0);return ab}static d8h(ab){const La=document.createElement("div");La.id=ab+tb.BMj;La.className=v.a.AMj;La.classList.add(v.a.i0);return La}static Kzd(){const ab=Oa.a.ipb(),La=document.createElement(ab?"div":"textarea");La.className=v.a.Boi;O.a.G0f()&&La.classList.add(v.a.Doi);La.classList.add(v.a.Coi);La.classList.add(v.a.xKj);ab?La.id=w.a.qQb:(La.cols=20,La.rows=2);return La}static u6h(ab){const La=
document.createElement("div");La.id=ab+w.a.pQb;La.className=v.a.wCf;K.DOMElementExtensions.oL(La,w.a.FF);La.setAttribute(w.a.rD,"insert function");La.tabIndex=0;La.classList.add(v.a.i0);return La}static c8h(ab){const La=document.createElement("div");La.id=ab+tb.VNc;La.className=v.a.Bgg;K.DOMElementExtensions.oL(La,w.a.FF);La.setAttribute(w.a.rD,"commit edit");La.tabIndex=0;La.classList.add(v.a.i0);return La}static O4h(ab){const La=document.createElement("div");La.id=ab+tb.Ipc;La.className=v.a.Adf;
K.DOMElementExtensions.oL(La,w.a.FF);La.setAttribute(w.a.rD,"cancel edit");La.tabIndex=0;La.classList.add(v.a.i0);return La}static G7h(ab){const La=document.createElement("div");La.id=ab+w.a.RBf;La.className=v.a.yoi;return La}}tb.BMj="okCancelButtonContainer";tb.VNc="okboxButton";tb.Ipc="cancelboxButton";tb.Cwa=null;Object(z.a)(tb,"FormulaBar",n.a,[52])},1360:function(z,t,a){a.d(t,"d",function(){return m});a.d(t,"c",function(){return x});a.d(t,"b",function(){return n});a.d(t,"a",function(){return u});
var c=a(28),b=a(683),h=a(1361),r=a(129),e=a(143),k=a(665);const m=w=>255<w.length||!v(w)||c.a.cI(w,"_xl")?!1:!0,x=(w,l)=>{var y=l.ha;l=y.qa.Bn;y=y.qa.activeRange;return w.sa.ma&&l?b.b(w.Yh,y,w.sa.ma.name):null},n=w=>{let l=null;w=w.ha.$e;w.isFloatingObjectSelected&&(l=w.Lh.floatingObject);return l},u=(w,l=!0)=>{const y=h.a.getInstance(w),B=y.LQi();B&&!w.Yh.Lq(B)&&k.a(e.a.hZh,[r.a.Vdg],!0,!0,!1,!1,null);y.stop(l)},v=w=>{if(!w.length)return!1;for(let l=0;l<w.length;l++){const y=w.charAt(l),B=w.charCodeAt(l);
if(!l){if("\\"!==y&&"_"!==y&&!c.a.isLetter(B))return!1}else if("_"!==y&&"."!==y&&!c.a.a0f(B)&&!c.a.isNumeral(B))return!1}return!0}},1361:function(z,t,a){z=a(0);var c=a(15);class b{constructor(h){this.start=r=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):(this.Jp.start(),this.inProgress=!0,this.Qeg=r)};this.stop=(r=!0)=>{this.inProgress&&(this.Jp.stop(),r&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.Jp.zi}}`),
this.inProgress=!1,this.Qeg=void 0)};this.LQi=()=>this.Qeg;this.Jp=h.Eh.em("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=h=>{void 0===b.instance&&(b.instance=new b(h));return b.instance};t.a=b;Object(z.a)(b,"NameBoxTelemetry",null,[])},1496:function(z,t,a){t=a(483);a=a(1497);a=a.Mw?a.default:a;"string"===typeof a&&(a=[[z.i,a,""]]);t(a,{insert:"head",bD:!1});z.exports=a.FH||{}},1497:function(z,t,a){t=a(484)(!1);t.push([z.i,'.ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-presence-cover,.ewa-fb-text-box{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment,.ewa-fb-text-box-new-theme{overflow:hidden;border:1px solid #e6e7e8;outline:0;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-presence-cover,.ewa-root-ltr .ewa-fb-text-box{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107C41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0!important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit!important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000!important;border:1px solid #000!important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on .ewa-fb .okbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb .cancelbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor ::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130!important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886!important}.ewr-presentMode-transition .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition .functionbox.button-disabled,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#F5F5F5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #D1D1D1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .okbox:hover{background-color:#F5F5F5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .okbox:focus{background-color:#E0E0E0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled{pointer-events:none;background-color:#FFF!important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path{fill:#BDBDBD}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #D1D1D1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie.no-scrollbar-gutter-support .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:grey;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within{outline:0;border:1px solid #D1D1D1;border-bottom-style:none}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:4px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:3px solid #107c41;clip-path:inset(calc(100%-3px) 0 0)}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-disabled{border:1px solid #D1D1D1;border-radius:4px;background-color:#F5F5F5}.ewa-fb-fluent .cancelbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .functionbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .okbox.button-disabled.ewa-fb-disabled{background-color:#F5F5F5!important}.ewa-root-ltr .ewa-fb-rtl .ewa-rteLine{padding-right:20px!important}.ewa-fb-fluent .ql-editor ::selection{background:#616161;color:#FFF}.skel-fb-namebox-wrapper{height:24px;width:124px;line-height:22px;padding:0 16px 0 0;border-color:#d1d1d1;position:relative;background-color:#fff;border-width:1px;border-style:solid;overflow:hidden;white-space:nowrap;box-sizing:border-box;border-radius:4px}.skel-fb-namebox-wrapper.skel-legacy-namebox{border-radius:0;line-height:16px;border-color:#e1dfdd;margin:4px}.skel-fb-namebox-button{position:absolute;border:none;padding:0;background-color:transparent;color:#797775;min-width:16px;right:-1px;display:flex;height:24px;justify-content:center;align-items:center}.skel-fb-namebox-rtl{left:-1px;right:auto}.skel-fb-namebox-icon{display:flex;width:12px;fill:#252423;align-items:center;justify-content:center}.skel-legacy-namebox .skel-fb-namebox-icon{font-size:12px;margin:0;height:8px;line-height:8px;text-align:center;flex-shrink:0;display:flex;width:8px;align-items:center}.skel-fb-namebox-disabled{background-color:#f5f5f5}.skel-fb-namebox-disabled .skel-fb-namebox-span{color:#c8c6c4}.skel-fb-namebox-disabled .skel-svg-disabled{fill:#939393}.skel-fb-namebox-disabled svg{opacity:.4}.skel-fb-namebox-span{color:#252423;float:left;margin-right:4px;height:16px;line-height:16px;background-color:transparent;box-sizing:border-box;width:100px;border-style:none;outline:0;text-overflow:ellipsis;font-size:12px;padding:4px}.skel-fb-namebox-span.skel-fb-namebox-v9{font-family:"Aptos Narrow","Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;font-size:11pt;line-height:15px}',
""]);z.exports=t},867:function(z,t,a){a.r(t);z={};a.r(z);a.d(z,"FormulaBarCommandHandler",function(){return Ia});var c=a(135);t=a(0);a(210);var b=a(15),h=a(149),r=a(599),e=a(73),k=a(154),m=a(140),x=a(10),n=a(27),u=a(46),v=a(683),w=a(123),l=a(268),y;(function(ka){ka[ka.NONE=0]="NONE";ka[ka.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";ka[ka.PRINT_AREA=2]="PRINT_AREA";ka[ka.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";ka[ka.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";ka[ka.INVALID_NAME=5]="INVALID_NAME";
ka[ka.EMPTY_RANGE=6]="EMPTY_RANGE";ka[ka.GENERIC_ERROR=7]="GENERIC_ERROR";ka[ka.VIEW_MODE=8]="VIEW_MODE"})(y||(y={}));Object(t.b)("NameBoxInvalidOperation",y);var B=a(36),A=a(28),E=a(12),N=a(129),D=a(143),U=a(665),K=a(106);class M extends l.a{constructor(ka,xa){super(ka,xa);this.dw()}get Di(){return"NameBoxErrorDialog"}dw(){super.dw();const ka=this.error.Caption,xa=this.PKi(this.error),Fb=this.OKi(this.error);this.Ph=0;this.Hta(Fb);this.Oo(ka,xa,2,this.r2)}PKi(ka){return A.a.equals(ka.MessageIdName,
M.E2c,!0)?String.format(ka.Description):A.a.equals(ka.MessageIdName,M.PUb,!0)?"":ka.Description}OKi(ka){const xa=[];A.a.equals(ka.MessageIdName,M.PUb,!0)&&(ka=String.format(E.a.instance.ia(2253)),xa.push(...ka.split("-").map(Fb=>Fb.trim())));return xa}static o1(ka,xa=null){if(ka.MessageIdName===M.PUb)b.ULS.sendTraceTag(528053385,0,50,ka.Caption);else{let Fb=ka.Caption;ka.MessageIdName===M.E2c&&(Fb=`Unsupported Operation: ${y[xa]}`);ka=new K.a;ka.ga("errorCaption",Fb);U.a(D.a.Bti,[N.a.Vdg],!0,!0,!1,
!1,ka)}}static nj(ka){switch(ka){case 3:case 1:case 2:return B.a.nj(1,0,2254,2255,0,-1280789630,M.E2c);case 5:case 4:return B.a.nj(1,0,2252,2253,0,875859818,M.PUb);case 8:case 7:return B.a.nj(1,0,0,1,0,424201999,M.PUb);case 6:return B.a.nj(1,0,2256,2257,0,-1280789630,M.E2c);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}M.E2c="NameBoxUnsupportedOperation";M.PUb="NameBoxInvalidName";Object(t.a)(M,"NameBoxErrorDialog",l.a,[]);const O=
(ka,xa,Fb,bb,Ja,mb,sa)=>{a:switch(sa){case 2:sa="Table";break a;case 3:sa=A.a.DOb(xa,"Print_Area")?"Print Area":"Named Range";break a;default:sa="Unknown"}return{key:ka,name:xa,sheetName:Fb,topLeft:bb,bottomRight:Ja,location:mb,type:sa}};var R=a(1360),J=a(1),aa=a(23),S=a(155),C=a(1361);class L{constructor(ka,xa){this.printArea="Print_Area";this.Puk="R";this.uZh="C";this.EIj="Value";this.$=ka;this.da=aa.f(this.$);this.FMa=xa;this.FIj=C.a.getInstance(this.$)}p7j(){var ka=this.$.Yh.items,xa=this.$.ma.name;
const Fb={};for(var bb of ka){ka=v.a(bb.name);var Ja=ka.dxb;if(e.h(bb)&&(!Ja||A.a.equals(ka.scope,xa,!1))){var mb=ka.name in Fb;if(!mb||mb&&Ja)Fb[ka.name]={["namedObjectDetails"]:ka,["namedObjectItem"]:bb}}}xa=[];for(const sa in Fb)ka=Fb[sa],bb=ka.namedObjectItem,ka=ka.namedObjectDetails,Ja=`${bb.sheetName}!${bb.usedRange.topLeft.FE(!1)}:${bb.usedRange.bottomRight.FE(!1)}`,mb=bb.type,xa.push(O(bb.name,ka.name,bb.sheetName,bb.usedRange.topLeft.FE(!1),bb.usedRange.bottomRight.FE(!1),Ja,mb));xa.sort((sa,
oa)=>sa.name.localeCompare(oa.name));this.FMa.q7j(xa);R.a(this.$,!1);this.bHg(xa.length)}A3i(ka){ka=v.a(ka[this.EIj].toString());const xa=ka.name,Fb=ka.scope.length?ka.scope:null;var bb=this.wWh(ka);this.Eyk(ka)||(this.kzj(ka),0!==bb?(this.FMa.lqf(this.$,bb),this.hJg()):R.d(xa)?(bb=u.t(aa.f(this.$).ha.qa.selectedRanges,this.$),this.FMa.H7h(this.$,xa,bb,Fb,L.PMj,L.OMj),this.FIj.start(ka.name)):(this.FMa.lqf(this.$,5),this.hJg()))}JHd(){this.FMa.JHd()}Eyk(ka){const xa=ka.fullName,Fb=ka.name,bb=ka.scope;
let Ja,mb,sa=!1;!({sheetName:Ja,range:mb}=u.jb(xa,this.$.sa)).returnValue||!mb.xB&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?A.a.equals(Fb,this.Puk,!0)?(this.Fyk(bb),this.A6a(2)):A.a.equals(Fb,this.uZh,!0)?(this.wyk(bb),this.A6a(2)):this.$.Yh.Lq(xa)?(this.BMg(xa),this.A6a(ka.dxb?1:0)):this.$.Yh.Lq(Fb)?(this.BMg(Fb),this.A6a(0)):sa=!0:(this.zyk(Ja,mb),this.A6a(3));return!sa}zyk(ka,xa){ka=ka||this.$.sa.ma.name;var Fb=v.b(this.$.Yh,xa,ka);v.c(Fb)||
(Fb=u.x(xa,this.$),Fb.SheetName=ka,aa.f(this.$).np(Fb,xa.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.da.focus())}Fyk(ka=null){const xa=this.da.ha.qa.activeCell;this.jef(ka)&&(ka=new n.Range(xa.top,0,xa.bottom,x.a.Nk,!0,!1),this.da.ha.uN([ka],0,ka,0))}wyk(ka=null){const xa=this.da.ha.qa.activeCell;this.jef(ka)&&(ka=new n.Range(0,xa.left,x.a.fl,xa.right,!0,!1),this.da.ha.uN([ka],0,ka,0))}jef(ka){return ka?(ka=this.$.sa.getItemByName(ka),(null===ka||void 0===ka?0:ka.visible)?
(ka.activate({scenario:"namedObject"}),!0):!1):!0}BMg(ka){ka=this.$.Yh.getItemByName(ka);v.c(ka);this.da.focus()}wWh(ka){return this.$.isEditMode?this.Pkj()?1:A.a.equals(ka.name,this.printArea,!0)?2:this.Jfi()?3:this.p9i(ka)?4:this.Pjj()?6:0:8}hJg(){var ka=R.b(this.da);null!=ka?this.FMa.$ud("",ka.name):(ka=R.c(this.$,this.da))?this.FMa.$ud(ka.name,ka.name):this.FMa.$ud("",this.da.ha.qa.activeCell.toString())}Pkj(){return!!this.da.ha.$e.activeFloatingObjectControlId}Jfi(){return 1<this.da.ha.qa.selectedRanges.length}p9i(ka){return ka.dxb&&
!this.$.fV(ka.scope)}Pjj(){return this.da.oh.qLa(this.da.ha.qa.selectedRanges[0])}static PMj(ka){return xa=>{B.a.jl(xa.Errors)&&(M.o1(xa.Errors[0]),new M(ka,xa.Errors[0]),C.a.getInstance(ka).stop(!1))}}static OMj(ka){return xa=>{(xa=w.a.kk(xa.data))&&0<xa.length?(M.o1(xa[0]),new M(ka,xa[0])):(M.o1(M.nj(7)),new M(ka,M.nj(7)));C.a.getInstance(ka).stop(!1)}}kzj(ka){const xa=null!=R.c(this.$,this.da);ka.dxb?this.A6a(xa?7:6):this.A6a(xa?5:4)}A6a(ka){S.b(this.$).Aj(k.a.TVk,{type:ka.toString()},null,!0)}bHg(ka){S.b(this.$).Aj(k.a.Gvg,
{wil:ka},null,!0)}}Object(t.a)(L,"NameBoxCommandHandler",null,[]);var V=a(427),X=a(216),la=a(64);const Va=(ka,xa,Fb,bb,Ja,mb,sa,oa,cb,Ka,Oa=null)=>{Oa=ka.$a(9,Oa);Oa.name=xa;Oa.selectedRanges=Fb;Oa.sheetName=bb;Oa.formula=Ja;Oa.comment=mb;return la.h(ka,"AddDefinedName",Oa,sa,oa,cb,Ka,0)};var na=a(264),db=a(117),ja;(function(ka){ka[ka.EMPTY_RANGE=0]="EMPTY_RANGE";ka[ka.RANGE_CREATED=1]="RANGE_CREATED"})(ja||(ja={}));Object(t.b)("NameBoxStatusCalloutType",ja);class ea{dgi(){this.smf();appChrome.renderNameBoxStatusCallout(ea.R_c,
ja.EMPTY_RANGE)}kgi(ka,xa){this.smf();const Fb=Object(u.F)(xa.Ranges[0]);appChrome.renderNameBoxStatusCallout(ea.R_c,ja.RANGE_CREATED,ka,xa.SheetName,`${Fb.topLeft.toString()}:${Fb.bottomRight.toString()}`)}smf(){null==ea.R_c&&(ea.R_c=document.createElement("div"))}q7j(ka){db.c()&&appChrome.populateNameBoxMenu(ka)}H7h(ka,xa,Fb,bb,Ja,mb){const sa=()=>this.kgi(xa,Fb);V.a(ka.userOperationManager,(oa,cb,Ka)=>Va(ka.pa.ta,xa,Fb,bb,"","",na.c(oa,Ja(ka),J.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")?
sa:void 0),na.b(cb,mb(ka)),Ka,ka),oa=>new X.a(1020,0,oa),null)}lqf(ka,xa){M.o1(M.nj(xa),xa);8!==xa&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")&&6===xa?this.dgi():new M(ka,M.nj(xa)))}JHd(){appChrome.updateNameBoxState({["focus"]:!0})}$ud(ka,xa){appChrome.setNamedObjectOrActiveCellRange(ka,xa)}}ea.R_c=null;Object(t.a)(ea,"NamedObjectsService",null,[250]);var Z=a(211),ba=a(67),ya=a(7),Qa=a(5),va=a(95);let Ia=class{constructor(ka,xa){this.$=ka;this.da=aa.f(this.$);
this.Ya=xa;this.v6d=new L(ka,new ea)}Ri(){return!1}executeCommand(ka,xa,Fb){xa=xa.command;ka=null;switch(xa){case 1726517890:this.v6d.A3i(Fb);break;case 2045896573:Fb=m.a(this.$);(null===Fb||void 0===Fb?0:Fb.gZa)?Fb.gZa.jyf():b.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.v6d.JHd();break;case -1790328692:Fb=m.a(this.$);xa=!this.$.$Vb;Fb.isVisible=xa;Fb.Wa.isVisible=xa;this.$.$Vb=
xa;this.$.Dm();try{h.a.xG(ya.a.QZf,xa.toString(),r.AFrame.BCa)}catch(bb){b.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${bb.message}`)}break;default:ka=Z.a(xa)}return ka||ba.Task.Ua(!0)}Gi(ka,xa,Fb){ka=!1;switch(xa.command){case 1726517890:ka=!!Fb;break;case -1003645154:case 2045896573:ka=!0;break;case -1790328692:ka=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8235335_DisplaySettings")}return ka}dj(ka,xa){if("PopulateNameBoxMenu"!==xa)return!1;ka=
this.$.Eh.Li("UserAction","PopulateNameBoxMenuTimer");this.v6d.p7j();ka.stop();return!0}bHg(ka){ka={["NamedObjectsCount"]:ka};S.b(this.$).Aj(k.a.Gvg,ka,null,!0)}};Ia=Object(c.__decorate)([Object(va.d)(Qa.Jc),Object(c.__param)(0,Object(Qa.Nb)()),Object(c.__param)(1,Object(Qa.uf)())],Ia);Object(t.a)(Ia,"FormulaBarCommandHandler",null,[43]);var Sa=a(9);c=a(428);var Xa=a(77),da=a(39),Ea=a(1160),qa=a(45),za=a(921),ma=a(25),Da=a(91);class Ua extends c.a{constructor(ka){super();this.$=ka;this.gm()}create(){qa.a.instance.ACa(ya.a.r5);
const ka=Xa.GetServiceTaskFactory.Tj(this.$.la,388,387,this.xh),xa=ma.a.n1a()?Object(Da.d)(va.a.resolve(Qa.cg)):ba.Task.Ua(null);da.TaskExtensions.Xa(da.TaskExtensions.Wo([ka,xa],this.ya),()=>{this.Bk(Object(za.a)(this.$.la,172,()=>new Ea.FormulaBar(this.$,xa.result,ka.result)))},this.$.ya,3)}}Object(t.a)(Ua,"FormulaBarFactory",c.a,[]);(()=>{Sa.a.gh(ka=>{J.EwaSettings.isChangeGateEnabled("OfficeVSO:8704628_importFBLessAsCoreCss")||a(1496);ka.la.Hh(186,new Ua(ka))})})();String(z);window.___1710439927750_closurehack=
z}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/f8be0943933542bb16590c2b39f4f614/EwaTS.vrd.js.map