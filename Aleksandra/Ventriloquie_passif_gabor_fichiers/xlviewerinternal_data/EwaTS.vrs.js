'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1265:function(z,t,a){t=a(483);a=a(1455);a=a.Mw?a.default:a;"string"===typeof a&&(a=[[z.i,a,""]]);t(a,{insert:"head",bD:!1});z.exports=a.FH||{}},1455:function(z,t,a){t=a(484)(!1);t.push([z.i,".ewa-svg-icon{height:100%;width:100%}",""]);z.exports=t},1456:function(z,t,a){t=a(483);a=a(1457);a=a.Mw?a.default:a;"string"===typeof a&&(a=[[z.i,a,""]]);t(a,{insert:"head",bD:!1});z.exports=a.FH||{}},1457:function(z,t,
a){t=a(484)(!1);t.push([z.i,'.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-invalid-sheetname-container{position:fixed;top:0;right:0;bottom:0;left:0;z-index:-1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media (prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}.ewa-stb-uir .rename-textbox-active{background-color:#e0e0e0!important}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:transparent;border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width .4s cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-uir .tab-active.rename-textbox-active .tab-content-container::before{width:calc(100%)}.ewa-stb-tabs .tab-content-container,.ewa-stb-tabs .tab-text{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px!important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0!important;margin-right:4px!important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar ::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px!important;height:13px!important;width:12px!important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0!important;margin-left:4px!important}.ewa-stb-rename-textbox{position:relative;display:none;border:none;outline:0;font-family:inherit;font-size:inherit;background:0 0}.ewa-stb-rename-textbox::selection{color:#fff;background-color:#616161}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover,.ewr-presentMode-on .ewa-stb-uir .tab-hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39!important;border:1px solid #e5e5e5!important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}',
""]);z.exports=t},399:function(z,t,a){a.r(t);var c={};a.r(c);a.d(c,"IndexedDB",function(){return M});var b={};a.r(b);a.d(b,"MoreColorsHelper",function(){return ma});var h={};a.r(h);var r={};a.r(r);a.d(r,"OAuthManagerWrapper",function(){return xa});var e={};a.r(e);a.d(e,"PopulateDynamicHelper",function(){return tb});var k={};a.r(k);a.d(k,"RibbonControlsManager",function(){return ae});var m={};a.r(m);a.d(m,"SheetDropdownMenuCommandHandler",function(){return fc});var x={};a.r(x);a.d(x,"SheetTabBarFactory",
function(){return Yb});var n=a(135),u=a(0),v=a(15),w=a(35),l=a(183),y=a(233),B=a(39),A=a(32),E=a(1);class N{constructor(Ra){this.keyPath=Ra}}Object(u.a)(N,"KeyPathClass",null,[]);var D=a(67),U=a(95),K=a(5);let M=class extends y.a{constructor(Ra){super();this.Yxb=this.zAd=null;this.Cnf=1;this.rbb=null;this.VKa=!1;this.$=Ra;this.VKa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:8787787_AddPerfTelemetryForIndexedDbOps")}get indexedDBFactory(){this.rbb||(window.indexedDB?this.rbb=window.indexedDB:window.webkitIndexedDB?
this.rbb=window.webkitIndexedDB:window.mozIndexedDB?this.rbb=window.mozIndexedDB:window.msIndexedDB&&(this.rbb=window.msIndexedDB));return this.rbb}get initialized(){return!!this.zAd&&!!this.Yxb}initialize(Ra,Lb,Nc){this.zAd=Ra;this.Yxb=Lb;this.Cnf=Nc}zl(){try{return E.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&w.a.uoa||w.a.Am&&91===w.a.WGd?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(Ra){return v.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${Ra.message}`),
!1}}WAa(Ra){if(!this.zl()||!this.initialized)return v.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),D.Task.Ua(!1);const Lb=A.a.ih.$j.m;return B.TaskExtensions.lXa(this.abe(),Nc=>{if(void 0===Nc.result)return!1;var Ed=Nc.result;this.Fsc(Ed);Nc=A.a.ih.$j.m;this.sOd(Ed,!1).put(Ra);Ed=A.a.ih.$j.m;this.VKa?v.ULS.sendTraceTag(507363798,0,50,`IndexedDB.saveToIndexedDB takes ${Ed-Lb} Millisecond.`):v.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${Ed-
Nc} Millisecond.`);return!0},this.ya)}kBd(Ra){if(!this.zl()||!this.initialized)return v.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),D.Task.Ua(!1);const Lb=A.a.ih.$j.m;return B.TaskExtensions.lXa(this.abe(),Nc=>{if(void 0===Nc.result&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;var Ed=Nc.result;this.Fsc(Ed);Nc=A.a.ih.$j.m;this.sOd(Ed,!1)["delete"](Ra);Ed=A.a.ih.$j.m;this.VKa?v.ULS.sendTraceTag(507363797,
0,50,`IndexedDB.DeleteFromIndexedDB takes ${Ed-Lb} Millisecond.`):v.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${Ed-Nc} Millisecond.`);return!0},this.ya)}Twa(Ra){if(!this.zl()||!this.initialized)return v.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),D.Task.Ua("");const Lb=A.a.ih.$j.m;return B.TaskExtensions.X1h(this.abe(),Nc=>{if(void 0===Nc.result&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return D.Task.Ua("");
Nc=Nc.result;return this.VKa?(Nc=this.hHf(Nc,Ra),v.ULS.sendTraceTag(507363796,0,50,`IndexedDB.getFromIndexedDB takes ${A.a.ih.$j.m-Lb} Millisecond.`),Nc):this.hHf(Nc,Ra)},this.ya)}deleteDatabase(Ra){if(!this.zl())return v.ULS.sendTraceTag(507872215,0,15,"IndexedDB.deleteDatabase: not supported."),D.Task.Ua(!1);const Lb=A.a.ih.$j.m,Nc=new l.a;Ra=this.indexedDBFactory.deleteDatabase(Ra);Ra.onsuccess=()=>{Nc.setResult(!0);this.VKa&&v.ULS.sendTraceTag(507363795,0,50,`IndexedDB.deleteDatabase takes ${A.a.ih.$j.m-
Lb} Millisecond.`)};Ra.onerror=()=>{Nc.setResult(!1)};return Nc.task}Fsc(Ra){if(!Ra.objectStoreNames.contains(this.Yxb)){const Lb=A.a.ih.$j.m;Ra.createObjectStore(this.Yxb,new N("key"));this.VKa&&v.ULS.sendTraceTag(507363794,0,50,`IndexedDB.createDBObjectStore takes ${A.a.ih.$j.m-Lb} Millisecond.`)}}abe(){const Ra=A.a.ih.$j.m,Lb=new l.a,Nc=this.indexedDBFactory.open(this.zAd,this.Cnf);Nc.onsuccess=()=>{const Ed=Nc.result;v.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${Ed.name} success`);Lb.setResult(Ed)};
Nc.onupgradeneeded=()=>{const Ed=Nc.result;v.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${Ed.name} upgrade needed`);try{this.Fsc(Ed),v.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${Ed.name} upgrade done`),this.VKa&&v.ULS.sendTraceTag(507363793,0,50,`IndexedDB.openIndexedDB takes ${A.a.ih.$j.m-Ra} Millisecond.`)}catch(Wd){v.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${Wd}`),E.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?Lb.setResult(void 0):Lb.setException(Error.create("Failed to upgrade IndexedDB"))}};
Nc.onerror=Ed=>{v.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${Ed} failed`);Lb.setResult(void 0)};return Lb.task}sOd(Ra,Lb){return Ra.transaction([this.Yxb],Lb?"readonly":"readwrite").objectStore(this.Yxb)}hHf(Ra,Lb){const Nc=A.a.ih.$j.m,Ed=new l.a;this.Fsc(Ra);const Wd=A.a.ih.$j.m,$d=this.sOd(Ra,!0).get(Lb);$d.onsuccess=se=>{(se=se.target.result)?(Ed.setResult(se.value),se=A.a.ih.$j.m,this.VKa?v.ULS.sendTraceTag(507363792,0,50,`IndexedDB.getFromDB takes ${se-Nc} Millisecond.`):v.ULS.sendTraceTag(537157633,
0,50,`IndexedDB.GetFromIndexedDB takes ${se-Wd} Millisecond.`)):Ed.setResult("")};$d.onerror=()=>{Ed.setException(Error.create($d.error?$d.error.message:"DB error"))};return Ed.task}};M=Object(n.__decorate)([Object(U.d)(K.vd,{Ek:"transient"}),Object(n.__param)(0,Object(K.Nb)())],M);Object(u.a)(M,"IndexedDB",y.a,[219]);var O=a(33),R=a(366),J=a(367),aa=a(210),S=a(83),C=a(395),L=a(154),V=a(427),X=a(216),la=a(228),Va=a(197),na=a(36),db=a(254),ja=a(264),ea=a(155);class Z{constructor(Ra,Lb,Nc,Ed){this.red=
Ra;this.green=Lb;this.blue=Nc;this.alpha=Ed}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(u.a)(Z,"ColorObject",null,[]);class ba{constructor(Ra){this.E9=this.LQ=null;this.tud=Ra}get head(){return this.LQ}get jwe(){return this.E9}Dof(Ra){this.head&&(Ra.pre?Ra.next?(Ra.pre.next=Ra.next,Ra.next.pre=Ra.pre):(this.E9=Ra.pre,this.jwe.next=null):Ra.next?(this.LQ=Ra.next,this.head.pre=null):this.E9=this.LQ=null,Ra.next=null,Ra.pre=null)}wAh(Ra){this.head?
(Ra.next=this.head,this.LQ=Ra,Ra.next.pre=this.head):this.E9=this.LQ=Ra}getItems(){if(!this.head)return null;const Ra=new aa.a;let Lb=this.head;for(;Lb;)if(Ra.add(Lb.value),Lb=Lb.next,Ra.count>this.tud){v.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return Ra}}Object(u.a)(ba,"CustomLinkedList",null,[]);class ya{constructor(Ra){this.pre=this.next=null;this.value=Ra}}Object(u.a)(ya,"CustomLinkedListNode",null,[]);class Qa{constructor(Ra){this.tud=
Ra;this.hNc={};this.kqb=new ba(Ra);this.count=0}add(Ra,Lb){Ra&&Lb?(Lb=new ya(Lb),this.contains(Ra)?this.kqb.Dof(this.hNc[Ra]):this.count<this.tud?this.count++:(delete this.hNc[this.kqb.jwe.value.toString()],this.kqb.Dof(this.kqb.jwe)),this.kqb.wAh(Lb),this.hNc[Ra]=Lb):v.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${Ra} or Value ${Lb} is null.`)}getItems(){return this.kqb.getItems()}contains(Ra){return Ra?Ra in this.hNc:!1}}Object(u.a)(Qa,"MRUCache",null,[]);var va=a(240),Ia=a(12);class Sa extends va.a{constructor(Ra,
Lb,Nc,Ed){Ed=void 0===Ed?null:Ed;super(!1,!1,!0);this.fm=null;this.lZh=(Wd,$d)=>{this.Xgf(Wd,$d)};this.$=Ra;this.G$i=Lb;this.nUf=Nc;this.Ygf=Ed}Ym(){const Ra=Ia.a.instance.ia(1346),Lb={};Lb[Sa.Uch]=this.G$i;Lb[Sa.pah]=Sa.Pbc;Lb[Sa.Pch]=Sa.Pbc;Lb[Sa.cfh]=Sa.Pbc;Lb[Sa.Beh]=Sa.Pbc;Lb[Sa.$dh]=Ia.a.instance.ia(2105);Lb[Sa.Gch]=Ia.a.instance.ia(2089);Lb[Sa.Nah]=Ia.a.instance.ia(2076);Lb[Sa.Mch]=Ia.a.instance.ia(1347);Lb[Sa.qah]=Ia.a.instance.ia(1348);this.nUf!==Sa.rah&&(Lb[Sa.sah]=Sa.ALPHA,Lb[Sa.ALPHA]=
this.nUf);this.initializeAndShow(Ra,this.lZh,{[Sa.ach]:Sa.nbh,[Sa.Oah]:Lb})}Xgf(Ra,Lb){Lb=Lb[Sa.Z5c];1===Ra&&this.yfg(Va.a.zia(Lb));this.Ygf&&this.Ygf(1===Ra,1===Ra?Lb:null)}yfg(Ra){this.fm||(this.fm=U.a.nh(K.Td));Ra=la.a.GM(Va.a.dP(Ra,!1));this.fm.AWc(Ra.r,Ra.g,Ra.b,C.a.Obc)}}Sa.Uch="initColor";Sa.ach="id";Sa.nbh="ColorPickerDialog";Sa.Oah="bodyControls";Sa.Z5c="selectedColorText";Sa.Pch="hueAriaLabel";Sa.cfh="transparencyAriaLabel";Sa.Beh="svAriaLabel";Sa.Pbc="Use left & right arrows keys to change values in color picker & hue slider";
Sa.ALPHA="alpha";Sa.q5c="alphaValue";Sa.pah="alphaAriaLabel";Sa.sah="alphaSliderType";Sa.rah=-1;Sa.tdh=100;Sa.$dh="redLabel";Sa.Nah="blueLabel";Sa.Gch="greenLabel";Sa.Mch="hexLabel";Sa.qah="alphaLabel";Object(u.a)(Sa,"MoreColorsDialog",va.a,[]);var Xa=a(7),da=a(606),Ea=a(62);class qa extends Sa{constructor(Ra,Lb,Nc,Ed,Wd){super(Ra,Ed,Wd);this.commandName=null;this.XWf=!1;this.command=Lb;this.Nh=Nc;this.y$i=Wd}Ym(){super.Ym();this.commandName=Ea.b().zp(this.Nh.command);v.ULS.sendTraceTag(545051016,
0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Nh.ik}`)}Xgf(Ra,Lb){if(1===Ra)if(Ra=this.$.Eh.em("UserAction",this.commandName),Ra.start(),da.a(Ra),Lb)if(Sa.Z5c in Lb){var Nc=Lb[Sa.Z5c];if(Ra=Va.a.zia(Nc)){Nc=new S.a(this.command,this.Nh.method,this.Nh.mode,this.Nh.ik,this.Nh.tabName?this.Nh.tabName:1378078823===this.command||-400966242===this.command?Xa.a.eOa:Xa.a.HS);var Ed={};Ed.Color=Ra;Ed.UILocation=this.Nh.ik;Sa.q5c in Lb&&(this.y$i!==
Lb[Sa.q5c]&&(this.XWf=!0),Ed.Alpha=(Lb[Sa.q5c]/Sa.tdh).toString(),v.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ma.qh(Nc,Ed);this.$.Dm();this.yfg(Ra);Lb={["Command"]:this.commandName,["Location"]:this.Nh.ik};Lb.AlphaApplied=this.XWf.toString();ea.b(this.$).Aj(L.a.YGj,Lb,null,!0)}else this.hide(),v.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Nc}, Command: ${this.commandName}`)}else this.hide(),
v.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),v.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(u.a)(qa,"MoreColorsRibbonDialog",Sa,[]);var za=a(64);Object(U.b)(K.Td,{Ek:"singleton"})(Ra=>Lo(function*(){const Lb=yield U.a.resolve(K.Nb,Ra),Nc=(yield U.a.resolve(K.hf,Ra)).v7f();return new ma(Lb,Nc)}));class ma{constructor(Ra,Lb){this.YVe="00FFFF";this.ZVe="0000FF";this.sBg="00FFFF";this.tBg=
"BF7000";this.R5a=null;this.LIf=!1;this.zRe=null;this.tA=E.EwaSettings.Qp("MoreColorsHelper");this.qwd=()=>{var Nc;null===(Nc=this.smd)||void 0===Nc?void 0:Nc.abort()};this.hPf=Nc=>{Nc&&Nc.key&&(1===Nc.key.length||"Backspace"===Nc.key||"Delete"===Nc.key||"Enter"===Nc.key?(Nc.preventDefault(),Nc.stopImmediatePropagation()):this.qwd())};this.zTj=Nc=>{if(!db.a(Nc)){Nc=Nc.Result;this.R5a=new Qa(10);for(let Wd=Nc.length-1;0<=Wd;Wd--){var Ed=Nc[Wd];Ed=new Z(Ed.Red,Ed.Green,Ed.Blue,Ed.Alpha);this.R5a.add(Ed.toString(),
Ed)}this.svg();v.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.yTj=()=>{v.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.iJ=()=>{this.Cxc()};this.gr=()=>{this.Cxc()};this.$=Ra;this.TYb=Lb;this.tA?this.$.ea.jn?this.gr():this.$.ea.jw(this.gr):this.$.ea.lm?this.Cxc():E.EwaSettings.vl()?this.$.ea.Yq(this.iJ):this.$.ea.jr(this.iJ)}get SYb(){return this.zRe}get S5a(){return this.YVe}set S5a(Ra){this.YVe=
Ra}get yub(){return this.ZVe}set yub(Ra){this.ZVe=Ra}get oTc(){return this.sBg}set oTc(Ra){this.sBg=Ra}get pTc(){return this.tBg}set pTc(Ra){this.tBg=Ra}bqb(Ra,Lb,Nc,Ed){Ed=void 0===Ed?-1:Ed;return this.TYb?B.TaskExtensions.Xa(this.TYb,()=>{(new qa(this.$,Ra,Lb,Nc,Ed)).Ym()},this.$.ya):null}launchEyedropper(Ra,Lb,Nc){const Ed=window.EyeDropper,Wd=new Ed;if(!Ed||!Wd||!(null!=Nc||Ra&&Lb))return D.Task.Ua(!1);let $d=null;if(!Nc)switch(Ra){case 1188510340:$d=1650812936;break;case -1828502776:$d=1970784898;
break;case -1252156667:$d=1378078823;break;case -2063061844:$d=-400966242;break;case -260488795:$d=-236759591;break;case -605730035:$d=467002767;break;case -984702347:$d=409031041;break;default:return v.ULS.shipAssertTag(508063765,0,!1,`MoreColorsHelper.launchEyedropper: Invalid eyedropper command ${Ra}`),D.Task.Ua(!1)}this.smd=new AbortController;const se=Lb?Ea.b().zp(Lb.command):"EyedropperConditionalFormatting";Wd.open({signal:this.smd.signal}).then(Fa=>{var lb=this.$.Eh.em("UserAction",se);lb.start();
da.a(lb);lb=Va.a.zia(Fa.sRGBHex);if(!lb)return v.ULS.shipAssertTag(508065669,0,!1,"MoreColorsHelper.launchEyedropper: Failed to return the color in expected format BBGGRR."),D.Task.Ua(!1);null!=Nc&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")?(v.ULS.sendTraceTag(507774978,0,50,"MoreColorsHelper.launchEyedropper: Eyedropper is used for Conditional Formatting."),Nc(Fa.sRGBHex?!0:!1,Fa.sRGBHex.substring(1))):(Fa=new S.a($d,Lb.method,Lb.mode,Lb.ik,Lb.tabName),
this.$.Ma.qh(Fa,{["Color"]:lb,["UILocation"]:Lb.ik}),this.$.Dm());Fa=la.a.GM(Va.a.dP(lb,!1));null!=Fa&&this.AWc(Fa.r,Fa.g,Fa.b,C.a.Obc);Fa=$d?{["Command"]:Ea.b().zp(Lb.command),["Location"]:Lb.ik}:{["IsCommand"]:!1,["Location"]:12};ea.b(this.$).Aj(L.a.cui,Fa,null,!0);return D.Task.Ua(!0)}).catch(Fa=>{v.ULS.sendTraceTag(508065668,0,10,"MoreColorsHelper.launchEyedropper: Failed to apply eyedropper color. Exception: {0}",Fa.toString());return D.Task.Ua(!1)}).finally(()=>{window.removeEventListener("blur",
this.qwd);window.removeEventListener("keydown",this.hPf,!0);this.smd=null});window.addEventListener("blur",this.qwd);window.addEventListener("keydown",this.hPf,!0);return D.Task.Ua(!0)}Pvj(Ra,Lb){var Nc=void 0;Nc=void 0===Nc?-1:Nc;Lb=void 0===Lb?null:Lb;this.TYb&&B.TaskExtensions.Xa(this.TYb,()=>{(new Sa(this.$,Ra,Nc,Lb)).Ym()},this.$.ya)}nUi(Ra){let Lb=null;switch(Ra){case "QueryRecentFillColor":Lb=this.S5a;break;case "QueryRecentFontColor":Lb=this.yub;break;case "QueryRecentShapesFillColor":Lb=
this.oTc;break;case "QueryRecentShapesOutlineColor":Lb=this.pTc}return Lb?O.a.Elb(Lb):null}dispose(){this.TYb=null;this.$&&(this.tA?this.$.ea.JA(this.gr):E.EwaSettings.vl()||this.$.ea.yv(this.iJ))}Cxc(){if(this.$.isEditMode)if(this.R5a)this.svg();else{this.LIf&&v.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var Ra=this.$.pa.ta;this.$.userOperationManager.enqueueOperation(new X.a(1009,0,(Lb,Nc,Ed)=>
{Lb=ja.c.call(null,Lb,this.zTj);Nc=ja.b.call(null,Nc,this.yTj);const Wd=Ra.$a(1,null);return za.h(Ra,"GetMRUColors",Wd,Lb,Nc,Ed,null,4)},80),null);this.LIf=!0}}svg(){var Ra=this.R5a.getItems();if(Ra){this.zRe=new aa.a;for(const Lb of Ra)Ra=Lb,Ra=new la.a(Ra.red,Ra.green,Ra.blue),this.SYb.add(Va.a.DJ(Ra))}}AWc(Ra,Lb,Nc,Ed){this.R5a||(this.R5a=new Qa(10));const Wd=new Z(Ra,Lb,Nc,Ed);this.R5a.add(Wd.toString(),Wd);this.saveMRUColor(null,Ra,Lb,Nc,Ed)}xAa(Ra,Lb,Nc){(Ra||this.$.isEditMode)&&this.wTg(Ra.SqmControlId)&&
(Ra=la.a.GM(Va.a.dP(Lb,!1)))&&(this.AWc(Ra.r,Ra.g,Ra.b,C.a.Obc),Nc={["Command"]:Ea.b().zp(Nc.command),["Location"]:R.a[Nc.ik],["InputMethod"]:J.a[Nc.method]},ea.b(this.$).Aj(L.a.xAa,Nc,null,!0))}wTg(Ra){return!!Ra&&Ra.startsWith("RecentColorPicker")}saveMRUColor(Ra,Lb,Nc,Ed,Wd){return V.a(this.$.userOperationManager,($d,se,Fa)=>{var lb=this.$.pa.ta;$d=ja.c($d,ma.ZYj());se=ja.b(se,ma.YYj());const d=lb.$a(9,null);d.bRed=Lb;d.bGreen=Nc;d.bBlue=Ed;d.bAlpha=Wd;return za.h(lb,"SaveMRUColor",d,$d,se,Fa,
null,0)},$d=>new X.a(1008,0,$d,E.EwaSettings.isChangeGateEnabled("OfficeVSO:8546775_SaveMRUColor_NonBlockingOperation")?64:null),Ra)}static ZYj(){return Ra=>{na.a.jl(Ra.Errors)?v.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):v.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static YYj(){return()=>{v.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}
Object(u.a)(ma,"MoreColorsHelper",null,[732,2]);var Da=a(42);Object(U.b)(K.je)(()=>Da.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var Ua=a(2),ka=a(1052);let xa=class{constructor(Ra){this.PMa=Ra}hE(Ra,Lb){return this.PMa?this.PMa.hE(Ra,Lb).then(Nc=>{Nc.IsSuccess||v.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+Nc.ErrorMessage+" Error code: "+Nc.ErrorCode+" App name: "+Ra);return Object(Ua.a)(new ka.a,{IsSuccess:Nc.IsSuccess,Token:Nc.Token,ErrorCode:Nc.ErrorCode,
ErrorMessage:Nc.ErrorMessage})}):(v.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(Ua.a)(new ka.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}F0a(){return this.PMa?this.PMa.F0a():null}};xa=Object(n.__decorate)([Object(U.d)(K.ke),Object(n.__param)(0,Object(K.je)())],xa);Object(u.a)(xa,"OAuthManagerWrapper",null,[728]);var Fb=a(488),bb=a(6),Ja=a(432),mb=a(289),sa=a(712);class oa{constructor(){this.Alt=
this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(u.a)(oa,"ColorCellProps",null,[]);var cb=a(355),Ka=a(19),Oa=a(60),gb=a(245),bc=a(153),Dc=a(244),ad=a(335),Ac=a(13),mc=a(397),Gb=a(28),Ba=a(23);class Xb{constructor(Ra){this.a8c=null;this.$=Ra;this.grid=Ba.f(this.$)}get borderFormatManager(){this.a8c||(this.a8c=this.$.la.lh(296));return this.a8c}xNi(Ra){var Lb=null;switch(Ra){case 467002767:Lb={};this.$.dr(Lb);Lb=Object(bc.a)(mc.a,this.$.sa).SLf(Lb.SheetName,!0);break;case -236759591:Lb=this.CFi();
break;case 1970784898:Lb=this.ALd(0);break;case 1650812936:case 1378078823:Lb=this.ALd(1);break;case -400966242:Lb=this.getShapeOutlineColor();break;case 1597684571:E.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&this.grid.ha.$e&&this.grid.ha.$e.Lh&&(Ra=this.grid.ha.$e.Lh.floatingObject,0===Ra.type&&Ra.Ti&&(Lb=this.ALd(1)));break;case 409031041:E.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&(Lb=this.TEf(Ra));break;default:v.ULS.sendTraceTag(537154460,
0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${Ra}'`)}return Lb}CFi(){let Ra=null;this.borderFormatManager&&(Ra=this.borderFormatManager.ofa);(Ra="black"===Ra?"000000":Ra)&&(Ra=O.a.Elb(Ra));return Ra}getShapeOutlineColor(){let Ra=null;if(this.grid.ha.$e&&this.grid.ha.$e.Lh){const Lb=this.grid.ha.$e.Lh.floatingObject;5===Lb.type&&Lb.Ch&&-1!==Lb.Ch.ShapeOutlineColor&&(Ra=Va.a.w2(Lb.Ch.ShapeOutlineColor),Ra=Ra.toUpperCase())}return Ra}TEf(Ra){let Lb=
null;if(this.grid.ha.$e&&this.grid.ha.$e.Lh){const Nc=this.grid.ha.$e.Lh,Ed=Nc.floatingObject;0===Ed.type&&Ed.Ti&&(Lb=Nc.lSb(Ra))}return Lb}ALd(Ra){let Lb=null;if(this.grid.ha.$e&&this.grid.ha.$e.Lh){var Nc=this.grid.ha.$e.Lh.floatingObject;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&0===Nc.type&&Nc.Ti){if(0===Ra||1===Ra)Lb=this.TEf(0===Ra?1970784898:1597684571);return Lb}5===Nc.type&&Nc.Ch?1===Ra&&-1!==Nc.Ch.ShapeFillColor?(Lb=Va.a.w2(Nc.Ch.ShapeFillColor),
Lb=Lb.toUpperCase()):v.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):v.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return Lb}Nc=this.grid.lfa("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.qa.selectedRanges,1,!0);try{for(Nc.$$rst();Nc.$$mn();){const Ed=Nc.$$cu().cell;
if(!Ed)continue;let Wd="#000000";if(0===Ra){Wd=Ed.color;if(this.grid.isEditing)return this.eMi();Ed.hasRichText&&(Wd=this.fMi(Ed))}else if(1===Ra){const $d=Ed.backgroundColor;Wd=Gb.a.compare($d,"transparent",!0)&&$d?Ed.backgroundColor:null}if(!Lb)Lb=Wd;else if(Lb!==Wd){Lb=null;break}}}finally{Nc&&Nc.dispose()}return Lb}eMi(){var Ra=null,Lb=this.grid.Fh,Nc=this.grid.cellTextEditBox.formattedText;if(Nc){Ra=Nc.TextRuns;const Ed=gb.a.map(Ra,Wd=>Wd.StartIndex);Nc=Nc.Fonts;Lb=Lb.Wa.caretPosition;Lb=Ac.HelperMethods.Mzf(new Dc.a(Ed),
Ed.length,Lb,Ac.HelperMethods.uS);Ra=Nc[Ra[Lb].FontID].Color}return Ra?Ra.toUpperCase():null}fMi(Ra){Ra=ad.a(Ra.formattedText.Fonts);if(ad.e(Ra,32))(Ra=Va.a.zia(Va.a.w2(Ra.FontColor)))&&(Ra="#"+Ra.toUpperCase());else return null;return Ra}}Object(u.a)(Xb,"ColorHighlighterHelper",null,[768]);var Ab=a(227),Db=a(25),xc=a(664);class vc{constructor(Ra,Lb,Nc){this.mTc=this.k9b=this.j1c=null;this.NMg="-1";this.pij=bb.AFrameworkApplication.fa.ka("IsO365ConsumerHost");this.$=Ra;this.fm=Lb;this.Kw=Nc;this.Vgf=
new Xb(Ra)}SIf(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H){Lb=void 0===Lb?null:Lb;Nc=void 0===Nc?null:Nc;Ed=void 0===Ed?null:Ed;Fa=void 0===Fa?null:Fa;lb=void 0===lb?null:lb;return this.a0(null!=Lb,null!=Nc,null!=Ed,null!=Fa,null!=lb,!0,void 0===d?!1:d,Ra,Lb,Nc,Ed,void 0===Wd?null:Wd,void 0===$d?null:$d,void 0===se?null:se,Fa,lb,void 0===H?null:H)}hXi(Ra,Lb,Nc,Ed,Wd){return this.a0(Ra,Lb,Nc,Ed,Wd,!1)}TIf(Ra,Lb,Nc,Ed,Wd,$d,se){const Fa=[];Ra=this.SIf(Ra,void 0===Lb?null:Lb,void 0===Nc?null:Nc,void 0===Ed?null:
Ed,void 0,void 0,void 0,void 0===Wd?null:Wd,void 0===$d?null:$d,!1,void 0===se?null:se);for(let lb=0,d=Ra.length;lb<d;lb++)Fa.push(Ab.r(Ra[lb]));return Fa}a0(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H,ha,Ta,Mb,W,eb,Ib){se=void 0===se?!1:se;Fa=void 0===Fa?null:Fa;lb=void 0===lb?null:lb;d=void 0===d?null:d;H=void 0===H?null:H;ha=void 0===ha?null:ha;Ta=void 0===Ta?null:Ta;Mb=void 0===Mb?null:Mb;W=void 0===W?null:W;eb=void 0===eb?null:eb;Ib=void 0===Ib?null:Ib;v.ULS.shipAssertTag(537154456,0,!$d||null!=Fa,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");
const nc=[];let ta=null,ob=3,cc=null,qc=null,Wc=null;this.nmi();if(this.$&&this.$.isEditMode&&!this.D7j(Ib))return v.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${Ib} menu opening`),nc;se&&E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&Db.a.$U()&&Db.a.JGc()&&(se=Ia.a.instance.ia(2501),nc.push(this.fxa(vc.Bjf,this.fBi(vc.Bjf,se))));Ra&&($d&&null==lb?v.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):
nc.push(this.fxa(vc.CLh,this.aBi(vc.t$e,lb,Mb,Ta))));$d&&null!=Fa&&this.Vgf&&(qc=cc="-1",ta=this.Vgf.xNi(Fa))&&(v.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${Fa} is not null .`),ta=Va.a.zia(ta),ob=this.HHf(ta),cc=this.WNd(ta,ob,0,!0),qc=this.WNd(ta,ob,1,!1));nc.push(this.fxa(vc.CYk,this.XId(vc.g0g,cc,this.j1c,Fa,ha,Ta),1341));nc.push(this.fxa(vc.PTk,this.XId(vc.OTk,qc,this.k9b,Fa,ha,Ta),1342));this.$&&this.$.isEditMode&&this.fm&&(this.A7j(),$d&&(Wc="-1",
ta&&(Wc=this.WNd(ta,ob,2,!0))),this.fm&&this.fm.SYb&&0<this.fm.SYb.count&&nc.push(this.fxa(vc.jfk,this.XId(vc.ifk,Wc,this.mTc,Fa,ha,Ta),1349)));Lb&&($d&&null==d?v.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):nc.push(this.fxa(vc.$Jj,this.bBi(vc.Aff,d,this.eHi(d),Mb,Ta))));!Nc||E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode||!this.pij&&!E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ColorPickerHighlightWhenEnabled",
!1)||($d&&!H?v.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):nc.push(this.fxa(vc.j8i,this.KBi(vc.ESf,H))));Ed&&($d&&null==W?v.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):nc.push(this.fxa(vc.ZGj,this.kCi(vc.mdg,W,this.eQi(W)))));Db.a.LK()&&Wd&&nc.push(this.fxa(vc.$Fd,this.wBi(vc.$Fd,eb)));return nc}WNd(Ra,Lb,Nc,Ed){3===Lb&&(Lb=this.HHf(Ra));
return 0===Nc&&Lb===Nc?this.NMg.toLowerCase():Lb===Nc?Ed?Ra.toLowerCase():Ra:"-1"}HHf(Ra){if(!Ra)return 3;const Lb=Ra.toLowerCase();return this.j1c&&this.jsj(Lb,this.j1c)?0:this.k9b&&this.OXf(Ra,this.k9b)?1:this.mTc&&this.OXf(Lb,this.mTc)?2:3}fxa(Ra,Lb,Nc){Nc=void 0===Nc?null:Nc;Ra=Object(Ua.a)(new Ja.a,{Id:Ra,Title:null!=Nc?Ia.a.instance.ia(Nc):"",ControlList:[],ControlsId:Ra+".Controls"});Ra.ControlList.push(Lb);return Ra}bBi(Ra,Lb,Nc,Ed,Wd){return this.HCf(Ra,Lb,Nc,Ka.a.Lvf,"transparent",void 0===
Ed?null:Ed,void 0===Wd?null:Wd)}KBi(Ra,Lb){return Object(Ua.a)(new mb.a,{Command:null!=Lb?Lb.toString():null,LabelText:Ia.a.instance.ia(1433),Id:Ra,ExternalId:this.fna(Ra,Lb),ExternalImageId:"ConditionalFormatting_20"})}aBi(Ra,Lb,Nc,Ed){return this.HCf(Ra,Lb,542,Ka.a.Kvf,"000000",void 0===Nc?null:Nc,void 0===Ed?null:Ed)}HCf(Ra,Lb,Nc,Ed,Wd,$d,se){$d=void 0===$d?null:$d;se=void 0===se?null:se;return Object(Ua.a)(new mb.a,{Command:null!=Lb?Lb.toString():null,CommandPreviewId:null!=$d?$d.toString():null,
CommandRevertId:null!=se?se.toString():null,MenuItemsStatefulData:this.LPi(Ra,Lb,Wd),LabelText:Ia.a.instance.ia(Nc),Id:Ra,ExternalId:this.fna(Ra,Lb),Image16by16:Oa.a.An(1),Image16by16Class:Ed})}LPi(Ra,Lb,Nc){const Ed={};Ra=this.fna(Ra,Lb);Ed[Ra]={};Ed[Ra].iconColor=Nc;return Ed}OXf(Ra,Lb){for(let Nc=0;Nc<Lb.length;Nc++)if(Ra===Lb[Nc].Color)return!0;return!1}vqj(Ra,Lb){Ra=Va.a.Mu(Ra);Lb=Va.a.Mu(Lb);return 1>=Math.abs(Ra.r-Lb.r)&&1>=Math.abs(Ra.g-Lb.g)&&1>=Math.abs(Ra.b-Lb.b)?!0:!1}jsj(Ra,Lb){for(let Nc=
0;Nc<Lb.length;Nc++){const Ed=Lb[Nc].Color;if(this.vqj(Ra,Ed))return this.NMg=Ed.toLowerCase(),!0}return!1}XId(Ra,Lb,Nc,Ed,Wd,$d){Wd=void 0===Wd?null:Wd;$d=void 0===$d?null:$d;return Object(Ua.a)(new sa.a,{McuLayout:!0,Command:null!=Ed?Ed.toString():null,CommandPreviewId:null!=Wd?Wd.toString():null,CommandRevertId:null!=$d?$d.toString():null,Width:10,Id:`${Ra}.ColorPicker`,SelectedColorId:Lb,Colors:Nc,Stateful:!0,ExternalId:this.fna(Ra,Ed),McuExternalId:`${this.fna(Ra,Ed)}.MCU`})}fna(Ra,Lb){return`${Ra}.${null!=
Lb?Lb.toString():""}`}WId(...Ra){const Lb=[];for(let Nc=0,Ed=Ra.length;Nc<Ed;Nc+=2)Lb.push(Object(Ua.a)(new oa,{Color:Ra[Nc],DisplayColor:Va.a.DJ(la.a.GM(parseInt(String("0x"+Ra[Nc]),16))),Alt:Object(cb.a)(String,Ra[Nc+1])&&this.$?Ra[Nc+1]:Ia.a.instance.ia(Ra[Nc+1])}));return Lb}kCi(Ra,Lb,Nc){const Ed=Ka.a.$vf;Ra=Object(Ua.a)(new mb.a,{Command:null!=Lb?Lb.toString():null,LabelText:Ia.a.instance.ia(Nc),Id:Ra,ExternalId:this.fna(Ra,Lb),Image16by16:Oa.a.An(1),Image16by16Class:Ed});Ra.ShouldTakeFocus=
!1;return Ra}LOh(){const Ra=[2502,2503,2504,2505].map(Lb=>{Lb=Ia.a.instance.ia(Lb);return Object(Ua.a)(new mb.a,{Command:(-1997160483).toString(),LabelText:Lb,Id:Lb,MenuItemId:Lb,ExternalId:this.fna(Lb,-1997160483)})});return Object(Ua.a)(new Ja.a,{ControlList:Ra})}iOh(){var Ra=Ia.a.instance.ia(2506);Ra=[Object(Ua.a)(new mb.a,{Command:(1485761473).toString(),LabelText:Ra,Id:vc.LJh,ExternalId:this.fna(Ra,1485761473),ExternalImageId:"ChatSparkle_20"})];return Object(Ua.a)(new Ja.a,{ControlList:Ra})}fBi(Ra,
Lb){const Nc=Object(Ua.a)(new Fb.a,{MenuSectionList:[],UpdateDynamically:!0});Nc.MenuSectionList.push(this.LOh());Nc.MenuSectionList.push(this.iOh());return Object(Ua.a)(new xc.a,{Command:(1485761473).toString(),LabelText:Lb,ImageIsVisible:!0,Id:Ra,ExternalId:this.fna(Ra,1485761473),ExternalImageId:"M365Excel_20",Menu:Nc})}wBi(Ra,Lb){Ra=Object(Ua.a)(new mb.a,{Command:null!=Lb?Lb.toString():null,LabelText:Ia.a.instance.ia(2401),Id:Ra,ExternalId:this.fna(Ra,Lb),Image16by16:Oa.a.An(1),ExternalImageId:"EyedropperFillColor_20"});
Ra.ShouldTakeFocus=!1;return Ra}nmi(){this.k9b||(this.k9b=this.WId("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}A7j(){this.fm.Cxc();if(this.fm.SYb){var Ra=this.fm.SYb;const Lb=[];for(const Nc of Ra)Ra=Va.a.zia(Nc.substr(1)),Lb.push(Ra,Nc);this.mTc=this.WId(...Lb)}}D7j(Ra){this.Kw.FIa(Ra);if(this.Kw.ryb&&this.Kw.h0g&&!this.Kw.D3f){Ra=this.Kw.ryb;const Lb=this.Kw.h0g,Nc=[];for(let Ed=0;Ed<Ra.count;Ed++)Nc.push(Ra.na(Ed),
Lb.na(Ed));this.j1c=this.WId(...Nc);return!0}return!1}eQi(Ra){switch(Ra){case -458147525:Ra=1344;break;case 1610379174:Ra=1345;break;default:Ra=1343}return Ra}eHi(Ra){switch(Ra){case 1549407384:Ra=541;break;case -1744769642:Ra=539;break;default:Ra=540}return Ra}}vc.$Jj="NoColor";vc.CLh="Automatic";vc.CYk="ThemeColors";vc.PTk="StandardColors";vc.jfk="RecentColors";vc.Aff="ClearColor";vc.j8i="HighlightWhen";vc.ESf="HighlightWhen";vc.t$e="AutomaticColor";vc.g0g="ThemeColorPicker";vc.OTk="StandardColorPicker";
vc.ZGj="MoreColors";vc.mdg="MoreColors";vc.ifk="RecentColorPicker";vc.$Fd="Eyedropper";vc.Bjf="CopilotSuggestions";vc.LJh="AskCopilot";Object(u.a)(vc,"ColorPickerBuilder",null,[]);class zb{constructor(Ra,Lb,Nc,Ed){this.$=Ra;this.HB=Lb;this.fm=Nc;this.Kw=Ed}getColorPickerButtonMenuProps(Ra){Ra=this.HB.gMf(Ra.automaticColor,Ra.clearColor,Ra.highlightWhen,Ra.moreColors,Ra.eyedropper);return{sections:this.gUi(Ra)}}showMoreColorsDialog(Ra,Lb){this.fm.Pvj(Ra,Lb)}onColorUsed(Ra){Ra=la.a.GM(Va.a.dP(Va.a.zia(Ra),
!1));this.fm.AWc(Ra.r,Ra.g,Ra.b,C.a.Obc)}getThemeColor(Ra){const Lb=Va.a.zia(Ra);let Nc,Ed;return(()=>{let Wd=this.Kw.getThemeColor(Lb);({themeIndex:Nc,nQa:Ed}=Wd);return Wd})().returnValue?{index:Nc,row:Ed}:(v.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null)}launchEyedropper(Ra){E.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")&&this.fm.launchEyedropper(null,null,Ra)}gUi(Ra){const Lb=[];for(let Ed=
0;Ed<Ra.length;Ed++){var Nc=Object(bc.a)(Ja.a,Ra[Ed]);const Wd={type:0};Wd.title=Nc.Title;const $d=Object(bc.a)(sa.a,Nc.ControlList[0]);$d?(Wd.type=1,Wd.colorSwatchProps=this.rHi($d),Lb.push(Wd)):(Nc=Object(bc.a)(mb.a,Nc.ControlList[0]))&&null!=this.iFf(Nc.Id)?(Wd.type=2,Wd.buttonProps={type:this.iFf(Nc.Id),label:Nc.LabelText},Lb.push(Wd)):v.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return Lb}rHi(Ra){const Lb=Ra.Colors;Ra={colors:Array(Ra.Colors.length),
notifyOnColorUsed:this.fm.wTg(Ra.ExternalId),isThemeColorSection:!!Ra.ExternalId&&Ra.ExternalId.includes(vc.g0g)};for(let Nc=0;Nc<Lb.length;Nc++)Ra.colors[Nc]={id:Lb[Nc].DisplayColor,color:Lb[Nc].DisplayColor,label:Lb[Nc].Alt,index:Nc};return Ra}iFf(Ra){switch(Ra){case vc.mdg:return 1;case vc.Aff:return 2;case vc.t$e:return 3;case vc.ESf:return 4;case vc.$Fd:return 5}return null}}Object(u.a)(zb,"ColorPickerButtonController",null,[]);Object(U.b)(K.Ne,{Ek:"singleton"})(Ra=>Lo(function*(){const Lb=yield U.a.resolve(K.Nb,
Ra),Nc=yield U.a.resolve(K.Td,Ra),Ed=yield U.a.resolve(K.Dg,Ra);return new tb(Lb,Nc,Ed)}));class tb{constructor(Ra,Lb,Nc){this.Ny=this.hr=null;this.$=Ra;this.fm=Lb;this.BQh();this.AQh();this.Kw=Nc;this.erc=new vc(Ra,Lb,Nc)}BQh(){this.hr={};this.hr.style0=1535;this.hr.style1=1536;this.hr.style2=1537;this.hr.style3=1538;this.hr.style4=1539;this.hr.style5=1540;this.hr.style6=1541;this.hr.style7=1542;this.hr.style8=1543;this.hr.style9=1544;this.hr.style10=1545;this.hr.style11=1546;this.hr.style12=1547;
this.hr.style13=1548;this.hr.style14=1549;this.hr.style15=1550;this.hr.style16=1551;this.hr.style17=1552;this.hr.style18=1553;this.hr.style19=1554;this.hr.style20=1555;this.hr.style21=1556;this.hr.style22=1557;this.hr.style23=1558;this.hr.style24=1559;this.hr.style25=1560;this.hr.style26=1561;this.hr.style27=1562;this.hr.style28=1563;this.hr.style29=1564;this.hr.style30=1565;this.hr.style31=1566;this.hr.style32=1567;this.hr.style33=1568;this.hr.style34=1569;this.hr.style35=1570;this.hr.style36=1571;
this.hr.style37=1572;this.hr.style38=1573;this.hr.style39=1574;this.hr.style40=1575;this.hr.style41=1576}AQh(){this.Ny={};this.Ny.style0=1507;this.Ny.style1=1508;this.Ny.style2=1509;this.Ny.style3=1510;this.Ny.style4=1511;this.Ny.style5=1512;this.Ny.style6=1513;this.Ny.style7=1514;this.Ny.style8=1515;this.Ny.style9=1516;this.Ny.style10=1517;this.Ny.style11=1518;this.Ny.style12=1519;this.Ny.style13=1520;this.Ny.style14=1521;this.Ny.style15=1522;this.Ny.style16=1523;this.Ny.style17=1524;this.Ny.style18=
1525;this.Ny.style19=1526;this.Ny.style20=1527;this.Ny.style21=1528;this.Ny.style22=1529;this.Ny.style23=1530;this.Ny.style24=1531;this.Ny.style25=1532;this.Ny.style26=1533;this.Ny.style27=1534}jFf(Ra){return Ab.i(this.erc.TIf(Ra,null,null,null,null,null,null))}Ozc(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H){Lb=void 0===Lb?null:Lb;Nc=void 0===Nc?null:Nc;Ed=void 0===Ed?null:Ed;Wd=void 0===Wd?null:Wd;$d=void 0===$d?null:$d;se=void 0===se?null:se;Fa=void 0===Fa?null:Fa;lb=void 0===lb?null:lb;d=void 0===d?!1:d;H=
void 0===H?null:H;return Object(Ua.a)(new Fb.a,{MenuSectionList:this.erc.SIf(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H),UpdateDynamically:!0})}gMf(Ra,Lb,Nc,Ed,Wd){return this.erc.hXi(Ra,Lb,Nc,Ed,Wd)}sHi(Ra,Lb,Nc,Ed,Wd,$d,se){return this.erc.TIf(Ra,void 0===Lb?null:Lb,void 0===Nc?null:Nc,void 0===Ed?null:Ed,void 0===Wd?null:Wd,void 0===$d?null:$d,void 0===se?null:se)}vOd(Ra,Lb){return(void 0===Lb?0:Lb)?this.Ny[Ra]:this.hr[Ra]}X4h(){return new zb(this.$,this,this.fm,this.Kw)}QU(Ra){var Lb;const Nc=null===(Lb=
this.$.shortcutKeyManager)||void 0===Lb?void 0:Lb.Pk(Ra);return Nc?Nc.substring(1,Nc.length-1):null}}Object(u.a)(tb,"PopulateDynamicHelper",null,[731]);var ab=a(41),La=a(1123);class pb{constructor(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d){this.m8e=Lb;this.s$e=void 0===Nc?null:Nc;this.zff=void 0===Wd?null:Wd;this.DSf=void 0===$d?null:$d;this.ldg=void 0===Fa?null:Fa;this.HB=Ra;this.Kyf=void 0===lb?null:lb;this.menuId=void 0===d?null:d}h$(){let Ra="";const Lb=this.HB.sHi(this.m8e,this.s$e,this.zff,this.DSf,this.ldg,
this.Kyf,this.menuId);for(const Nc of Lb)Ra+=Nc;return Ra}bM(){return this.HB.Ozc(this.m8e,this.s$e,this.zff,this.DSf,void 0,void 0,void 0,this.ldg,this.Kyf,!1,this.menuId)}}Object(u.a)(pb,"RibbonColorPicker",null,[344]);var ia=a(670);class kb{constructor(Ra,Lb){this._id=Ra;this.TL=void 0===Lb?"":Lb}get id(){return this._id}get text(){return this.TL}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(Ra){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");
}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}h$(){return`<Label id="${this._id}" LabelText="${this.TL}" />`}l2(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}d7b(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}j2(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");
}zqc(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}Eua(){return Object(Ua.a)(new ia.a,{Id:this.id,LabelText:this.text})}}Object(u.a)(kb,"RibbonLabel",null,[745,343,344]);class fb{constructor(Ra){this.vph=[];this.id=Ra}get Mh(){return this.vph}h$(){return Ab.q(this.bM())}bM(){const Ra=Object(Ua.a)(new Fb.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const Lb of this.Mh)Object(cb.a)(pb,Lb)?Ra.MenuSectionList.push(...Object(bc.a)(pb,Lb).bM().MenuSectionList):
Ra.MenuSectionList.push(Lb.Xoc());return Ra}}Object(u.a)(fb,"RibbonMenu",null,[744,344]);class hb{constructor(){this.title=null;this.U8=[];this.xz="Menu16";this.M0g=this.eWg=this.fWg=!0}get buttons(){return this.U8}h$(){return Ab.r(this.Xoc())}Xoc(){const Ra=Object(Ua.a)(new Ja.a,{ControlList:[]});if(1===this.buttons.length&&Object(cb.a)(743,this.buttons[0]))Ra.ControlList.push(this.buttons[0].Woc());else{let Nc="";for(let Ed=0;Ed<this.buttons.length;Ed++){var Lb=Object(bc.a)(343,this.buttons[Ed]);
Lb&&(Lb=Lb.Eua(),Ra.ControlList.push(Lb),Nc+=Lb.Id)}Ra.ControlsId=Nc+".Controls"}Ra.Title=this.title;Ra.DisplayMode=this.xz;Ra.ShowMenuSectionTitleIcon=this.fWg;Ra.ShowMenuSectionTitleBackground=this.eWg;Ra.MenuSectionTitleFocusable=this.M0g;return Ra}}Object(u.a)(hb,"RibbonMenuSection",null,[297,344]);class Jb{constructor(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H,ha,Ta){Ta=void 0===Ta?null:Ta;this.id=Ra;this.command=Nc;this.yvg=Ed;this.populateOnlyOnce=Wd;this.A5a=$d;this.x7j=se;this.alt=Fa;this.anc=lb;this.width=
d;this.OGh=H;this.autoComplete=ha;this.GEa=new fb(Lb);this.i9e=Ta;Ed&&se&&(Ra=new hb,Ra.xz="MenuLoading",Lb=new kb(Lb+"LoadingLabel"),Ra.buttons.push(Lb),this.menu.Mh.push(Ra))}h$(){return this.GOh()}get menu(){return this.GEa}GOh(){let Ra=Ab.d(this.id,this.command,this.yvg,this.populateOnlyOnce,this.A5a,this.x7j,this.alt,this.anc,this.width);const Lb=Ra.indexOf(" />");Ra=Ra.substring(0,Lb);Ra+=` ${"AllowDefaultContent"}="${this.OGh.toString()}"`;Ra+=` ${"AutoComplete"}="${this.autoComplete?"true":
"false"}"`;this.i9e&&(Ra+=` ${"ArrowImgId"}="${this.i9e}"`);Ra=Ra+">"+this.menu.h$();return Ra+"</ComboBox>"}}Object(u.a)(Jb,"RibbonComboBox",null,[822,344]);var ub=a(627),nb=a(1124);class Aa extends nb.a{constructor(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H,ha,Ta){ha=void 0===ha?null:ha;Ta=void 0===Ta?null:Ta;super(Ra,Lb,Nc,Wd,$d,se,Fa,H,0);this.HCb=null;this.Wra=0===lb?null:Ia.a.instance.ia(lb);this.Efd=d;this.Lhd=Ed;this.Lth=ha;this.gv=Ta}get description(){return this.Wra}get CQb(){return this.HCb}get menuItemId(){return this.Efd}get A5a(){return this.Lhd}get styles(){return this.Lth}get data(){return this.gv}h$(){return Ab.n(this.Eua())}Yoe(Ra){this.Wra=
Ra}toString(){this.CQb||(this.HCb=this.h$());return this.CQb}Eua(){const Ra=new ub.a;this.Nxc(Ra);Ra.MenuItemId=this.menuItemId;Ra.QueryCommand=this.A5a;Ra.Description=this.description;Ra.Styles=this.styles;Ra.Data=this.data;return Ra}}Object(u.a)(Aa,"RibbonComboBoxItem",nb.a,[298,343,344]);class ra extends nb.a{constructor(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb){super(Ra,Nc,Ed,Wd,$d,se,Fa,!1,0);this.populateOnlyOnce=!1;this.gYb=this.menuCloseCommand=this.menuOpenCommand=this.VD=null;this.GEa=new fb(Lb);this.RTf=
!0;this.Kkd=lb}get menu(){return this.GEa}h$(){return Ab.o(this.Eua())}Eua(){const Ra=new xc.a;this.Nxc(Ra);Ra.PopulateOnlyOnce=this.populateOnlyOnce;Ra.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();Ra.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();Ra.PopulateQueryCommand=this.VD;Ra.KeyTip=this.gYb;Ra.Menu=this.menu.bM();Ra.ImageIsVisible=this.RTf;Ra.ExternalImageId=this.Kkd;return Ra}}Object(u.a)(ra,"RibbonFlyoutAnchor",nb.a,[299,
343,344]);var vb=a(1207),rb=a(669);class Nb{constructor(){this.Dkb=[];this.id=null;this.width=0;this.title=this.Rva=null}h$(){return Ab.p(this.Woc())}pD(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H){Ed=void 0===Ed?0:Ed;Wd=void 0===Wd?null:Wd;$d=void 0===$d?null:$d;se=void 0===se?null:se;Fa=void 0===Fa?null:Fa;lb=void 0===lb?null:lb;d=void 0===d?null:d;H=(H=void 0===H?null:H)?Ia.a.instance.ia(Ed)+Ac.HelperMethods.Mdf+H:Ia.a.instance.ia(Ed);this.FVf(this.Dkb.length,Ra,Lb,Nc,0===Ed?lb:H,Wd,$d,se,Fa,d)}FVf(Ra,Lb,Nc,
Ed,Wd,$d,se,Fa,lb,d){$d=void 0===$d?null:$d;se=void 0===se?null:se;Fa=void 0===Fa?null:Fa;lb=void 0===lb?null:lb;d=void 0===d?null:d;(Ra>this.Dkb.length||0>Ra)&&Error.argumentOutOfRange("Invalid Index");this.Dkb.splice(Ra,0,Object(Ua.a)(new vb.a,{Id:Lb,Command:Nc.toString(),QueryCommand:null!==Ed&&void 0!==Ed?Ed:null,Alt:Wd,MenuItemId:$d,Icon:se,Image:Fa?Oa.a.An(Fa):null,ImageClass:lb,LabelText:d}))}Woc(Ra){Ra=void 0===Ra?!1:Ra;let Lb=null,Nc=null;switch(this.Rva){case "Size120by20":Lb=this.MJb(120,
20,Ra);Nc=this.KJb(130,30,Ra);break;case "Size90by21":Lb=this.MJb(90,21,Ra);Nc=this.KJb(100,33,Ra);break;case "Size24by24With7Options":Lb=this.MJb(24,24,Ra);Nc=this.KJb(34,34,Ra);break;case "Size24by24":Lb=this.MJb(28,28,Ra);Nc=this.KJb(38,38,Ra);break;case "Size112by64":Lb=this.MJb(24,24,Ra),Nc=this.KJb(112,64,Ra)}for(Ra=0;Ra<this.Dkb.length;Ra++)this.Dkb[Ra].FullIconStyle=Lb;return Object(Ua.a)(new rb.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.Rva,
GalleryItems:this.Dkb,GalleryStyle:Nc})}MJb(Ra,Lb,Nc){const Ed={},Wd={};Wd.width=Ra;Wd.height=Lb;Nc&&(Wd.alignSelf="center",Wd.marginBottom="4px");Ed.root=Wd;return Ed}KJb(Ra,Lb,Nc){const Ed={},Wd={},$d={};$d.width=Ra;$d.height=Lb;Wd.root=$d;Nc&&(Wd.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});Ed.galleryButtonInExpanded=Wd;return Ed}}Object(u.a)(Nb,"RibbonGallery",null,[743,344]);var Qc=a(1266),jd=a(922),xd;let ae=xd=class{constructor(Ra){this.HB=void 0===Ra?null:Ra}get xBc(){return this.HB}mw(Ra){return new fb(void 0===
Ra?null:Ra)}ji(){return new hb}jh(Ra){var Lb=ab.a.wj(xd.bgb,Ra.toString());if(Lb)return Lb;switch(Ra){case 249:return this.gi(Ra,"ContextMenu.Show.ChartTaskPane",1221897806,Ka.a.bxf,4,983);case 287:return this.gi(Ra,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.Mp(Ra,"DataLabels.None.BoxWhisker",374300079,Ka.a.Kwf,929,930,1600);case 0:return this.Mp(Ra,"DataLabels.None.Column",374300079,Ka.a.Jwf,929,930,1600);case 1:return this.Mp(Ra,
"DataLabels.None.Line",374300079,Ka.a.Lwf,929,930,1600);case 2:return this.Mp(Ra,"DataLabels.None.Pie",374300079,Ka.a.Mwf,929,930,1600);case 3:return this.Mp(Ra,"DataLabels.Show.Column",-1809877936,Ka.a.Twc,931,932,1601);case 143:return this.Mp(Ra,"DataLabels.Show.Funnel",-1809877936,Ka.a.Twc,931,934,1601);case 144:return this.Mp(Ra,"DataLabels.Show.Treemap",-1809877936,Ka.a.bFd,931,938,1601);case 145:return this.Mp(Ra,"DataLabels.Show.Sunburst",-1809877936,Ka.a.aFd,931,934,1601);case 4:return this.Mp(Ra,
"DataLabels.Center.Column",-1996266048,Ka.a.Twc,933,934,1602);case 5:return this.Mp(Ra,"DataLabels.Center.Line",-1996266048,Ka.a.Ewf,933,934,1602);case 6:return this.Mp(Ra,"DataLabels.Center.Pie",-1996266048,Ka.a.aFd,933,934,1602);case 7:return this.Mp(Ra,"DataLabels.InsideEnd.Column",493396546,Ka.a.Fwf,935,936,1603);case 8:return this.Mp(Ra,"DataLabels.InsideEnd.Pie",493396546,Ka.a.Gwf,935,936,1603);case 9:return this.Mp(Ra,"DataLabels.InsideBase.Column",1599247052,Ka.a.bFd,937,938,1604);case 10:return this.Mp(Ra,
"DataLabels.OutsideEnd.Column",342855531,Ka.a.Nwf,939,940,1605);case 11:return this.Mp(Ra,"DataLabels.OutsideEnd.Pie",342855531,Ka.a.Owf,939,940,1605);case 140:return this.Mp(Ra,"DataLabels.Left.BoxWhisker",-472675112,Ka.a.Iwf,941,942,1606);case 12:return this.Mp(Ra,"DataLabels.Left.Line",-472675112,Ka.a.Hwf,941,942,1606);case 142:return this.Mp(Ra,"DataLabels.Right.BoxWhisker",-1774499423,Ka.a.Qwf,943,944,1607);case 13:return this.Mp(Ra,"DataLabels.Right.Line",-1774499423,Ka.a.Pwf,943,944,1607);
case 138:return this.Mp(Ra,"DataLabels.Above.BoxWhisker",-204160914,Ka.a.Awf,945,946,1608);case 14:return this.Mp(Ra,"DataLabels.Above.Line",-204160914,Ka.a.Rwf,945,946,1608);case 139:return this.Mp(Ra,"DataLabels.Below.BoxWhisker",-87783054,Ka.a.Bwf,947,948,1609);case 15:return this.Mp(Ra,"DataLabels.Below.Line",-87783054,Ka.a.Dwf,947,948,1609);case 16:return this.Mp(Ra,"DataLabels.BestFit.Pie",1650379138,Ka.a.Cwf,949,950,1610);case 17:return this.Mp(Ra,"Axes.Horizontal.None",895828731,Ka.a.pwf,
929,951,1613);case 18:return this.Mp(Ra,"Axes.Horizontal.ShowLTR",683614408,Ka.a.ZEd,952,953,1614);case 19:return this.Mp(Ra,"Axes.Horizontal.NoLabels",-1612014670,Ka.a.owf,956,957,1615);case 20:return this.Mp(Ra,"Axes.Horizontal.ShowRTL",1259259728,Ka.a.qwf,958,959,1616);case 21:return this.Mp(Ra,"Axes.Horizontal.Default",683614408,Ka.a.ZEd,954,955,1617);case 22:return this.Mp(Ra,"Axes.Horizontal.Thousands",-220179662,Ka.a.rwf,960,961,1618);case 23:return this.Mp(Ra,"Axes.Horizontal.Millions",1534680966,
Ka.a.nwf,962,963,1619);case 24:return this.Mp(Ra,"Axes.Horizontal.Billions",-238895611,Ka.a.lwf,964,965,1620);case 25:return this.Mp(Ra,"Axes.Horizontal.LogScale",-892714755,Ka.a.mwf,966,967,1621);case 26:return this.Mp(Ra,"Axes.Vertical.None",2006508979,Ka.a.wwf,929,951,1613);case 27:return this.Mp(Ra,"Axes.Vertical.Default",252405382,Ka.a.ywf,954,955,1617);case 28:return this.Mp(Ra,"Axes.Vertical.Thousands",670842692,Ka.a.zwf,960,961,1618);case 29:return this.Mp(Ra,"Axes.Vertical.Millions",-572426128,
Ka.a.uwf,962,963,1619);case 30:return this.Mp(Ra,"Axes.Vertical.Billions",-806496391,Ka.a.swf,964,965,1620);case 31:return this.Mp(Ra,"Axes.Vertical.LogScale",-1700998151,Ka.a.twf,966,967,1621);case 32:return this.Mp(Ra,"Axes.Vertical.NoLabels",2104548628,Ka.a.vwf,956,957,1615);case 33:return this.Mp(Ra,"Axes.Vertical.ShowRTL",1717508862,Ka.a.xwf,958,959,1616);case 34:return this.Mp(Ra,"Gridlines.Horizontal.None",80515665,Ka.a.Wwf,929,970,1624);case 35:return this.Mp(Ra,"Gridlines.Horizontal.Major",
-306129902,Ka.a.Twf,972,973,1625);case 36:return this.Mp(Ra,"Gridlines.Horizontal.Minor",2147076534,Ka.a.Uwf,975,976,1626);case 37:return this.Mp(Ra,"Gridlines.Horizontal.MajorMinor",-1253752845,Ka.a.Vwf,978,979,1627);case 38:return this.Mp(Ra,"Gridlines.Vertical.None",1711257557,Ka.a.axf,929,971,1624);case 39:return this.Mp(Ra,"Gridlines.Vertical.Major",-1772953364,Ka.a.Ywf,972,974,1625);case 40:return this.Mp(Ra,"Gridlines.Vertical.Minor",680253336,Ka.a.Zwf,975,977,1626);case 41:return this.Mp(Ra,
"Gridlines.Vertical.MajorMinor",-215161981,Ka.a.$wf,978,980,1627);case 135:return this.gi(Ra,"ContextMenu.NumberFormating",2105621672,Ka.a.OEd,1,476,135!==Ra,null,null,this.HB.QU(406));case 300:return this.gi(Ra,"ContextMenu.FormatCells",2055979337,null,1,477,300!==Ra,void 0,"PaintBrushandBucket_20",this.HB.QU(406));case 361:return this.gi(Ra,"ContextMenu.FormatCellsNumberFormatTaskPane",-395879625,null,1,477,361!==Ra,void 0,"PaintBrushandBucket_20",this.HB.QU(406));case 362:return this.gi(Ra,"ContextMenu.FontTaskPane",
456320978,null,1,477,362!==Ra,void 0,"PaintBrushandBucket_20",this.HB.QU(406));case 136:return this.gi(Ra,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,Ka.a.OEd,1,476,136!==Ra);case 42:return this.gi(Ra,"ContextMenu.Cut",-1985798686,Ka.a.Ovf,1,12,!1,null,null,this.HB.QU(172));case 43:return this.gi(Ra,"ContextMenu.Copy",-911352779,Ka.a.Mwc,1,11,!1,null,null,this.HB.QU(174));case 212:return this.gi(Ra,"ContextMenu.InsertCopiedCells",-160032004,Ka.a.Ywc,3,15);case 213:return this.gi(Ra,
"ContextMenu.InsertCutCells",-1065525230,Ka.a.Ywc,3,21);case 354:return this.gi(Ra,"ContextMenu.PasteValues",-185374993,Ka.a.cwf,8,1149,null,null,"PasteValues_20",this.HB.QU(178));case 355:return this.gi(Ra,"ContextMenu.PasteFormulas",1766348718,Ka.a.cwf,8,1150,null,null,"PasteFormulas_20");case 356:return this.gi(Ra,"ContextMenu.PasteFormatting",1804571062,Ka.a.pqi,3,1152,null,null,"PasteFormatting_20");case 357:return this.gi(Ra,"ContextMenu.PasteLink",42074747,Ka.a.sqi,3,1153,null,null,"PasteLink_20");
case 358:return this.gi(Ra,"ContextMenu.PasteWithColumnWidths",264209770,null,3,2299,null,null,"PasteWithColumnWidths_20");case 359:return this.gi(Ra,"ContextMenu.PasteTranspose",-958589048,Ka.a.uqi,3,1151,null,null,"PasteTranspose_20");case 44:case 57:return this.gi(Ra,"ContextMenu.Paste",237279923,Ka.a.Rwc,1,13,44!==Ra,"Paste",null,this.HB.QU(176));case 248:return this.gi(Ra,"PasteAdvancedOptionsGallery",237279923,Ka.a.Rwc,1,13,44!==Ra,"Paste");case 45:case 120:return this.gi(Ra,"ContextMenu.EditHyperlink",
-1583422759,Ka.a.Vwc,8,1140,45!==Ra,"EditHyperlink");case 46:case 121:return this.gi(Ra,"ContextMenu.InsertHyperlink",-1583422759,Ka.a.Vwc,8,1141,46!==Ra,"InsertHyperlink",null,this.HB.QU(156));case 47:case 122:return this.gi(Ra,"ContextMenu.RemoveHyperlink",-1253126584,Ka.a.iFd,8,1142,47!==Ra,"RemoveHyperlink");case 48:case 123:return this.gi(Ra,"ContextMenu.RemoveHyperlinks",-1253126584,Ka.a.iFd,8,1143,48!==Ra,"RemoveHyperlinks");case 250:return this.Jq(Ra,"ContextMenu.ContextMenuSmartLookup",-983891024,
1810);case 187:case 188:case 165:case 173:return this.gi(Ra,"ContextMenu.InsertCellsShiftRight",1035996630,Ka.a.Xvf,1,165===Ra||173===Ra?E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341:E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?19:342,173===Ra||188===Ra,"InsertCellsShiftRight");case 166:case 174:return this.gi(Ra,"ContextMenu.InsertCellsShiftDown",1035996630,Ka.a.Wvf,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?20:344,166!==Ra,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.gi(Ra,"ContextMenu.DeleteCellsShiftLeft",1035996630,Ka.a.Svf,1,167===Ra||175===Ra?E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?19:342:E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341,175===Ra||190===Ra,"DeleteCellsShiftLeft");case 168:case 176:return this.gi(Ra,"ContextMenu.DeleteCellsShiftUp",1035996630,
Ka.a.Tvf,1,343,168!==Ra,"DeleteCellsShiftUp");case 177:case 181:return this.gi(Ra,"ContextMenu.InsertRowsSheet",-1113896058,Ka.a.PEd,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?430:429,177!==Ra,"InsertRows");case 363:case 364:return this.gi(Ra,"ContextMenu.InsertRowsAfterSheet",75170472,null,1,2526,363!==Ra,"InsertRowsAfter");case 49:case 116:return this.gi(Ra,
"ContextMenu.InsertRows",-1113896058,Ka.a.PEd,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2420:346,49!==Ra,"InsertRows");case 365:case 366:return this.gi(Ra,"ContextMenu.InsertRowsAfter",75170472,null,1,2531,365!==Ra,"InsertRowsAfter");case 161:case 169:return this.gi(Ra,"ContextMenu.InsertRowsTable",942362098,Ka.a.Zvf,1,421,161!==Ra,"InsertRowsTable");
case 50:case 117:return this.gi(Ra,"ContextMenu.InsertColumns",1415868706,Ka.a.dwa,1,406,50!==Ra,"InsertColumns");case 336:case 337:return this.gi(Ra,"ContextMenu.InsertColumnsToTheLeft",1415868706,Ka.a.dwa,1,407,336!==Ra,"InsertColumns");case 369:case 370:return this.gi(Ra,"ContextMenu.InsertColumnsToTheLeft",-612877076,Ka.a.dwa,1,407,369!==Ra,"InsertColumns");case 288:case 289:return this.gi(Ra,"ContextMenu.contextMenuInsertColumnsToTheRight",1415868706,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?null:Ka.a.dwa,1,408,288!==Ra,"InsertColumns");case 367:case 368:return this.gi(Ra,"ContextMenu.contextMenuInsertColumnsAfterToTheRight",-612877076,null,1,408,367!==Ra,"InsertColumnsAfter");case 178:case 182:return this.gi(Ra,"ContextMenu.InsertColumnsSheet",1415868706,Ka.a.dwa,1,426,178!==Ra,"InsertColumns");case 334:case 335:return this.gi(Ra,"ContextMenu.InsertColumnsSheetToTheLeft",1415868706,Ka.a.dwa,1,427,334!==Ra,"InsertColumns");case 371:case 372:return this.gi(Ra,"ContextMenu.InsertColumnsAfterSheetToTheLeft",
-612877076,Ka.a.dwa,1,427,371!==Ra,"InsertColumnsAfter");case 290:case 291:return this.gi(Ra,"ContextMenu.InsertColumnsSheet",1415868706,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?null:Ka.a.dwa,1,428,290!==Ra,"InsertColumns");case 373:case 374:return this.gi(Ra,"ContextMenu.InsertColumnsAfterSheetToTheRight",-612877076,null,1,428,373!==Ra,"InsertColumnsAfter");case 191:case 192:case 162:case 170:return this.gi(Ra,"ContextMenu.InsertColumnsTable",
622604322,Ka.a.Yvf,1,162===Ra||170===Ra?419:420,170===Ra||192===Ra,"InsertColumnsTable");case 179:case 183:return this.gi(Ra,"ContextMenu.DeleteRowsSheet",1554436520,Ka.a.Pwc,1,429,179!==Ra,"DeleteRows");case 51:case 118:return this.gi(Ra,"ContextMenu.DeleteRows",1554436520,Ka.a.Pwc,1,410,51!==Ra,"DeleteRows");case 163:case 171:return this.gi(Ra,"ContextMenu.DeleteRowsTable",1405456548,Ka.a.Pwc,1,418,163!==Ra,"DeleteRowsTable");case 180:case 184:return this.gi(Ra,"ContextMenu.DeleteColumnsSheet",
674605324,Ka.a.Owc,1,426,180!==Ra,"DeleteColumns");case 52:case 119:return this.gi(Ra,"ContextMenu.DeleteColumns",674605324,Ka.a.Owc,1,411,52!==Ra,"DeleteColumns");case 164:case 172:return this.gi(Ra,"ContextMenu.DeleteColumnsTable",284490184,Ka.a.Owc,1,417,164!==Ra,"DeleteColumnsTable");case 53:case 124:return this.Jq(Ra,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==Ra,"OpenHyperlink",this.HB.QU(101));case 263:return this.gi(Ra,"SheetOpsContextMenu.ShowChanges",1834994092,Ka.a.jFd,8,443,void 0,
Xa.a.eOk);case 264:return this.gi(Ra,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.gi(Ra,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.gi(Ra,"GridContextMenu.ShowChanges",1834994092,Ka.a.jFd,8,443,void 0,Xa.a.kUg);case 54:return this.gi(Ra,"ContextMenu.InsertSheet",-1935155518,Ka.a.QEd,1,514);case 360:return this.gi(Ra,"ContextMenu.AppendSheet",-546331179,Ka.a.QEd,1,
514);case 56:case 127:return this.gi(Ra,"ContextMenu.DeleteSheet",1880294140,Ka.a.Uvf,1,515,56!==Ra,"DeleteSheet");case 55:return this.Jq(Ra,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Jq(Ra,"ContextMenu.ReorderSheet",-383100692,517,125!==Ra,"ReorderSheet");case 158:return this.Jq(Ra,"ContextMenu.DuplicateSheet",-1254662242,441);case 338:case 339:return Lb=338!==Ra,this.gi(Ra,Lb?"ContextMenu.FullSheetCopyDisabled":"ContextMenu.FullSheetCopy",-207190267,Ka.a.Mwc,1,2431,Lb,
null);case 340:case 341:return Lb=340!==Ra,this.gi(Ra,Lb?"ContextMenu.FullSheetPasteDisabled":"ContextMenu.FullSheetPaste",440556491,Ka.a.Rwc,1,2430,Lb,null);case 112:case 114:return this.Jq(Ra,"ContextMenu.HideSheet",1458540255,519,112!==Ra,"HideSheet");case 113:case 115:return this.Jq(Ra,"ContextMenu.UnhideSheet",1129633328,520,113!==Ra,"UnhideSheet");case 277:return this.gi(Ra,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.gi(Ra,"ContextMenu.PauseProtection",
-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.gi(Ra,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Jq(Ra,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.gi(Ra,"ContextMenu.PivotExpand",-1687560254,Ka.a.UEd,9,1168);case 244:return this.gi(Ra,"ContextMenu.PivotCollapse",1176256599,Ka.a.TEd,9,1169);case 245:return this.gi(Ra,"ContextMenu.PivotExpandEntireField",-1751201991,Ka.a.UEd,9,1170);
case 246:return this.gi(Ra,"ContextMenu.PivotCollapseEntireField",-232434744,Ka.a.TEd,9,1171);case 247:return this.gi(Ra,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");case 301:return this.gi(Ra,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,jd.a.e6j);case 306:return this.gi(Ra,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.gi(Ra,"ContextMenu.ManualGroup",660506187,null,17,2346,void 0,void 0);
case 59:return this.gi(Ra,"ContextMenu.PivotFieldListShow",2140436015,Ka.a.VEd,9,1173);case 58:return this.gi(Ra,"ContextMenu.PivotFieldListHide",-1006032470,Ka.a.VEd,9,1174);case 258:return this.gi(Ra,"ContextMenu.PivotSettingsPaneShow",1529441790,Ka.a.gPb,17,636);case 257:return this.gi(Ra,"ContextMenu.PivotSettingsPaneHide",1529441790,Ka.a.gPb,17,637);case 259:return this.Jq(Ra,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.Jq(Ra,"ContextMenu.PivotTableSubtotalOnTop",
671485366,639);case 261:return this.Jq(Ra,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return Lb=60!==Ra,this.Jq(Ra,Lb?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,Lb,null);case 61:case 65:return Lb=61!==Ra,this.Jq(Ra,Lb?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,Lb,null);case 62:case 66:return Lb=62!==Ra,this.Jq(Ra,Lb?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",
389774337,1091,Lb,null);case 63:case 67:return Lb=63!==Ra,this.Jq(Ra,Lb?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,Lb,null);case 68:case 72:return Lb=68!==Ra,this.gi(Ra,Lb?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,Ka.a.Jwc,9,1093,Lb,null);case 69:case 73:return Lb=69!==Ra,this.gi(Ra,Lb?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,Ka.a.Ajb,9,1094,
Lb,null);case 70:case 74:return Lb=70!==Ra,this.gi(Ra,Lb?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,Ka.a.zjb,9,1095,Lb,null);case 71:case 75:return Lb=71!==Ra,this.gi(Ra,Lb?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,Ka.a.Kwc,9,1098,Lb,null);case 76:return this.gi(Ra,"ContextMenu.FieldWellRemoveField",-1092351914,Ka.a.Qvf,9,1099);case 77:return this.gi(Ra,"ContextMenu.FieldWellValueFieldSettings",
-2141589616,Ka.a.kwf,9,1100);case 79:case 83:return this.gi(Ra,"ContextMenu.FieldListMoveToReportFilter",359279088,Ka.a.Jwc,9,1082,79!==Ra,null);case 80:case 84:return this.gi(Ra,"ContextMenu.FieldListMoveToRowLabels",-67292059,Ka.a.Ajb,9,1083,80!==Ra,null);case 81:case 85:return this.gi(Ra,"ContextMenu.FieldListMoveToColumnsLabels",745182485,Ka.a.zjb,9,1084,81!==Ra,null);case 82:case 86:return this.gi(Ra,"ContextMenu.FieldListMoveToValues",926905850,Ka.a.Kwc,9,1087,82!==Ra,null);case 95:case 97:return Lb=
95!==Ra,this.gi(Ra,Lb?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,Ka.a.Ajb,9,1096,Lb,null);case 96:case 98:return Lb=96!==Ra,this.gi(Ra,Lb?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,Ka.a.zjb,9,1097,Lb,null);case 78:return this.gi(Ra,"ContextMenu.FieldListAddAsSlicer",547535945,Ka.a.LEd,9,1088);case 332:case 333:return this.gi(Ra,"ContextMenu.FieldListAddAsTimeline",-2108836646,
null,9,2393,333===Ra,void 0,"TimeSlicerInsert_20");case 91:case 93:return this.gi(Ra,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,Ka.a.Ajb,9,1085,91!==Ra,null);case 92:case 94:return this.gi(Ra,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,Ka.a.zjb,9,1086,92!==Ra,null);case 99:return this.gi(Ra,"ContextMenu.BIExploreShowCallout",1529658657,Ka.a.Lwc,9,1193);case 100:return this.gi(Ra,"ContextMenu.ContextMenuRefresh",2054778433,Ka.a.fwf,9,1181);case 102:return this.gi(Ra,"ContextMenu.EditCell",
324156914,Ka.a.hFd,8,579);case 101:return this.gi(Ra,"Contextenu.DeleteChart",2045211913,Ka.a.Uwc,8,578);case 308:return this.gi(Ra,"Contextmenu.DeleteChartElement",2045211913,Ka.a.Uwc,8,2358);case 321:return this.Jq(Ra,"Contextmenu.AddDataLabels",1849330294,2359,!1);case 350:return this.Jq(Ra,"Contextmenu.AddErrorBarX",-873142594,2367,!1);case 351:return this.Jq(Ra,"Contextmenu.AddErrorBarY",1855740761,2367,!1);case 352:return this.Jq(Ra,"Contextmenu.AddErrorBarHz",-873142594,2438,!1);case 353:return this.Jq(Ra,
"Contextmenu.AddErrorBarVt",1855740761,2440,!1);case 322:return this.Jq(Ra,"Contextmenu.AddTrendline",2117491830,2363,!1);case 323:return this.Jq(Ra,"Contextmenu.AddTrendlineTitle",2107851680,2365,!1);case 324:return this.Jq(Ra,"Contextmenu.AddAxisTitle",-1986737526,2386,!1);case 325:return this.Jq(Ra,"Contextmenu.AddMajorGridlines",119706583,2370,!1);case 326:return this.Jq(Ra,"Contextmenu.AddMinorGridlines",-1741941813,2372,!1);case 342:return this.Jq(Ra,"Contextmenu.EditTextChartTitle",419803868,
818,!1);case 343:return this.Jq(Ra,"Contextmenu.EditTextAxisTitleHorizontal",-2011789595,818,!1);case 344:return this.Jq(Ra,"Contextmenu.EditTextAxisTitleVertical",-1513952223,818,!1);case 146:return this.gi(Ra,"Contextenu.AltText",1804967129,Ka.a.fFd,8,817);case 302:return this.gi(Ra,"ContextMenu.CellImageAltText",1516436924,Ka.a.fFd,8,817);case 147:return this.gi(Ra,"ContextMenu.EditShapeText",-445658892,Ka.a.kxf,8,818);case 186:return this.gi(Ra,"ContextMenu.ExitEditShapeText",1166778132,null,
8,819);case 281:return this.gi(Ra,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",jd.a.bringForward);case 282:return this.gi(Ra,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",jd.a.bringToFront);case 283:return this.gi(Ra,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",jd.a.sendBackward);case 284:return this.gi(Ra,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",jd.a.sendToBack);
case 273:return this.gi(Ra,"ContextMenu.OfficeScriptsViewScript",-585097204,Ka.a.Jvf,8,2151);case 160:return this.gi(Ra,"ContextMenu.InsertComment",-1667294294,Ka.a.mxf,8,1146,!1,null,null,this.HB.QU(351));case 221:return this.gi(Ra,"ContextMenu.DeleteComment",467845448,Ka.a.jxf,8,1162);case 159:return this.gi(Ra,"ContextMenu.InsertReply",-1667294294,Ka.a.nxf,8,1145);case 226:return this.gi(Ra,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20",this.HB.QU(348));case 227:return this.gi(Ra,
"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.gi(Ra,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.gi(Ra,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Jq(Ra,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.v4(Ra,"Form.InsertForm",1305810481,Ka.a.SEd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.v4(Ra,"Form.ViewForm",
330035228,Ka.a.SEd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.v4(Ra,"Form.EditForm",1305810481,Ka.a.Vvf,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.v4(Ra,"Form.DeleteForm",-509039657,Ka.a.Rvf,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.v4(Ra,"Form.ShareForm",1334518759,Ka.a.gwf,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Ra,"ContextMenu.ClearContent",
-848953656,Ka.a.aqi,1,445,148!==Ra,null,"Clear_20"):this.Jq(Ra,"ContextMenu.ClearContent",-848953656,445,148!==Ra);case 150:case 151:return this.gi(Ra,"ContextMenu.RowHeight",2040891415,Ka.a.oxf,8,434,151===Ra);case 152:case 153:return this.gi(Ra,"ContextMenu.ColumnWidth",957527587,Ka.a.ixf,8,433,153===Ra);case 108:case 154:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Ra,"ContextMenu.HideRows",1051390410,null,1,432,154===Ra,null,
"RowHideTouch_20"):this.Jq(Ra,"ContextMenu.HideRows",1051390410,432,154===Ra);case 110:case 156:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Ra,"ContextMenu.UnhideRows",1542466017,null,1,439,156===Ra,null,"RowUnhideTouch_20"):this.Jq(Ra,"ContextMenu.UnhideRows",1542466017,439,156===Ra);case 109:case 155:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Ra,"ContextMenu.HideColumns",
-706918724,null,1,438,155===Ra,null,"ColumnHideTouch_20"):this.Jq(Ra,"ContextMenu.HideColumns",-706918724,438,155===Ra);case 111:case 157:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Ra,"ContextMenu.UnhideColumns",369708605,null,1,440,157===Ra,null,"ColumnUnhideTouch_20"):this.Jq(Ra,"ContextMenu.UnhideColumns",369708605,440,157===Ra);case 216:return this.Jq(Ra,"ContextMenu.ShowCard",-843616717,1786,216!==Ra);case 217:return this.Jq(Ra,
"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.gi(Ra,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.gi(Ra,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.gi(Ra,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Jq(Ra,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===Ra);case 218:case 269:return this.Jq(Ra,
"ContextMenu.RefreshLinkedEntities",439914789,1788,269===Ra);case 220:case 271:return this.Jq(Ra,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===Ra);case 219:case 270:return this.Jq(Ra,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===Ra);case 234:return this.gi(Ra,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.gi(Ra,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.gi(Ra,
"ContextMenu.FilterByValue",1803952894,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2522:222);case 313:return this.gi(Ra,"ContextMenu.FilterByCellColor",486423932,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2523:2375);case 314:return this.gi(Ra,"ContextMenu.FilterByCellFontColor",-652157481,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?2524:2376);case 315:return this.gi(Ra,"ContextMenu.FilterByCellIcon",-1656122924,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2525:2377);case 223:return this.gi(Ra,"ContextMenu.SortAscending",-1010737776,Ka.a.iwf,1,228);case 292:return this.Jq(Ra,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2518:230);case 293:return this.Jq(Ra,"ContextMenu.PutSelectedFontColorOnTop",
-764711886,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2519:231);case 294:return this.Jq(Ra,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2520:232);case 224:return this.gi(Ra,"ContextMenu.SortDescending",2123420468,Ka.a.jwf,1,229);case 225:return this.gi(Ra,"ContextMenu.SortCustom",-207540907,Ka.a.Swc,1,233);case 232:return this.gi(Ra,
"ContextMenu.ConvertToRange",323142015,Ka.a.Nvf,1,740);case 272:return this.gi(Ra,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,Ka.a.hFd,8,661);case 239:return this.gi(Ra,"ContextMenu.IgnoreError",886009118,Ka.a.gFd,8,2112,239!==Ra);case 240:return this.gi(Ra,"ContextMenu.IgnoreErrors",886009118,Ka.a.gFd,8,2113,240!==Ra);case 241:return this.Jq(Ra,"ContextMenu.ShowError",-1779556985,2114,241!==Ra);case 251:return this.gi(Ra,"ContextMenu.SlicerRefresh",-231711729,Ka.a.ewf,0,2177,251!==Ra);case 252:return this.gi(Ra,
"ContextMenu.SlicerClearFilter",-1909381757,Ka.a.MEd,0,2178,252!==Ra);case 375:return this.gi(Ra,"ContextMenu.AutoToggleFilter",368460465,null,1,2538,375!==Ra,null,"Filter_20");case 376:return this.gi(Ra,"ContextMenu.RemoveAutoToggleFilter",368460465,null,1,2533,void 0,void 0,"DeleteFilter_20");case 345:return this.gi(Ra,"ContextMenu.TimeSlicerClearFilter",-741340954,Ka.a.MEd,0,2178,345!==Ra);case 254:return this.Jq(Ra,"ContextMenu.SlicerDelete",2045211913,2181,254!==Ra);case 253:return this.gi(Ra,
"ContextMenu.SlicerMultiSelect",2108047455,Ka.a.REd,0,2180,253!==Ra);case 255:return this.gi(Ra,"ContextMenu.SlicerSortAscending",-923375148,Ka.a.Wwc,8,2183,255!==Ra);case 256:return this.gi(Ra,"ContextMenu.SlicerSortDescending",1164937340,Ka.a.Xwc,8,2182,256!==Ra);case 267:return this.gi(Ra,"ContextMenu.SlicerSettingsPaneShow",522377926,Ka.a.gPb,17,636);case 266:return this.gi(Ra,"ContextMenu.SlicerSettingsPaneHide",522377926,Ka.a.gPb,17,637);case 128:return this.kHa(Ra,-619033944,1,1438);case 129:return this.kHa(Ra,
-619033944,2,1440);case 130:return this.kHa(Ra,-619033944,3,1442);case 131:return this.kHa(Ra,-619033944,4,1443);case 132:return this.ifa(Ra,-1736601456,7,1447);case 133:return this.ifa(Ra,-1736601456,8,1449);case 134:return this.ifa(Ra,-1736601456,0,1450);case 196:return this.kHa(Ra,-2136556471,1,1438);case 198:return this.kHa(Ra,-2136556471,2,1440);case 200:return this.kHa(Ra,-2136556471,3,1442);case 201:return this.kHa(Ra,-2136556471,4,1443);case 204:return this.ifa(Ra,1201641489,0,1447);case 205:return this.ifa(Ra,
1201641489,1,1448);case 206:return this.ifa(Ra,1201641489,7,1449);case 207:return this.ifa(Ra,1201641489,2,1450);case 208:return this.ifa(Ra,1201641489,4,1451);case 209:return this.ifa(Ra,1201641489,3,1452);case 210:return this.ifa(Ra,1201641489,5,1453);case 211:return this.ifa(Ra,1201641489,6,1454);case 274:return this.gi(Ra,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,Db.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":
"ShareSectionEntry_20");case 275:return this.gi(Ra,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,Db.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 276:return this.gi(Ra,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,Db.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 317:return this.gi(Ra,
"ContextMenu.ShareNamedSheetView",-1592351768,null,1,2382,void 0,void 0,Db.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 319:return this.gi(Ra,"ContextMenu.ExitNamedSheetView",1690118309,null,3,2381,void 0,void 0,"ExitSheetView_20");case 299:return this.gi(Ra,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,Db.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?
"LinkToSection_20":"ShareSectionEntry_20");case 312:return this.gi(Ra,"ContextMenu.ShareSheet",783415632,null,1,2374,void 0,void 0,Db.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 309:return this.gi(Ra,"ContextMenu.FlyoutShareSheet",783415632,null,1,2355,void 0,void 0);case 310:return this.gi(Ra,"ContextMenu.FlyoutShareRange",-1099009678,null,1,2356,void 0,void 0);case 311:return this.gi(Ra,"ContextMenu.FlyoutShareTable",
192430811,null,1,2357,void 0,void 0);case 285:return this.gi(Ra,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.gi(Ra,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20");case 330:return this.gi(Ra,"ContextMenu.CopyHyperlink",-1257360929,Ka.a.Mwc,1,2410,330!==Ra);case 331:return this.gi(Ra,"ContextMenu.ShowLinkPreview",1915212877,null,1,2411,331!==Ra)}return null}v4(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d,H,ha,Ta){Lb=
new La.RibbonButtonObject(Lb,se,Nc,null,Wd,Ed,$d,se,Fa,lb,d,H,!0,void 0===ha?null:ha,void 0===Ta?null:Ta);return xd.bgb[Ra.toString()]=Lb}gi(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d){lb=void 0===lb?null:lb;return this.v4(Ra,Lb,Nc,lb?null:Ed,Wd,"Image16by16",$d,0,void 0===Fa?null:Fa,void 0===se?!1:se,0,lb,void 0===d?null:d)}FMb(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d){return new Aa(Ra,$d,Lb,null,Ed,Nc,Wd,$d,se,Fa,!1,void 0===lb?null:lb,void 0===d?null:d)}plf(Ra,Lb){return new kb(Ra,void 0===Lb?"":Lb)}Z3h(Ra,Lb,Nc,Ed){return new Qc.RibbonToggleButton(Ra,
0,Lb,null,8,null,"None",0,0,null,!1,0,Nc,Ed)}tXa(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb){Fa=void 0===Fa?null:Fa;lb=void 0===lb?!1:lb;let d=ab.a.wj(xd.bgb,Ra);if(d)return d;d=new La.RibbonButtonObject(Ra,0,Nc,null,3,null,"None",0,0,$d,se,0);d.j2(Lb);d.label=Lb;d.Yoe(lb?null:Lb);d.d7b(Wd,Ed,Fa);return xd.bgb[Ra]=d}Uhe(Ra){this.QUd(Ra)&&delete xd.bgb[Ra]}QUd(Ra){return Ra in xd.bgb}uz(Ra,Lb,Nc,Ed){Ra=new ra(Ra,Lb,0,Ed,3,null,"None",0);Ra.j2(Nc);Ra.label=Nc;return Ra}kma(Ra,Lb,Nc,Ed,Wd,$d,se){Ra=new ra(Ra,Lb,0,Ed,
Wd,se?null:$d,"Image16by16",0,se);Ra.j2(Nc);Ra.label=Nc;return Ra}kMb(Ra,Lb,Nc,Ed,Wd,$d){return new pb(this.HB,Ra,null,null,void 0===Lb?null:Lb,null,void 0===Nc?null:Nc,void 0===Ed?null:Ed,void 0===Wd?null:Wd,void 0===$d?null:$d)}sM(Ra,Lb,Nc,Ed){Nc=void 0===Nc?null:Nc;Ed=void 0===Ed?null:Ed;return Object(Ua.a)(new Nb,{id:Ra,width:Lb,Rva:Nc,title:Ed})}Mp(Ra,Lb,Nc,Ed,Wd,$d,se){return this.v4(Ra,Lb,Nc,Ed,4,"Image32by32",Wd,$d,null,!1,se)}Jq(Ra,Lb,Nc,Ed,Wd,$d,se){return this.v4(Ra,Lb,Nc,null,1,"None",
Ed,0,void 0===$d?null:$d,void 0===Wd?!1:Wd,0,null,void 0===se?null:se)}ckf(Ra,Lb,Nc,Ed,Wd,$d){return this.v4(Ra,Lb,Nc,Ed,4,"Image16by16",Wd,0,$d.toString(),!1,0)}ifa(Ra,Lb,Nc,Ed){return this.ckf(Ra,"OutlineDashStylePresent,"+Nc,Lb,Ka.a.Nwc,Ed,Nc)}kHa(Ra,Lb,Nc,Ed){return this.ckf(Ra,"OutlineWidthPresent,"+Nc,Lb,Ka.a.Qwc,Ed,Nc)}};ae.bgb={};ae=xd=Object(n.__decorate)([Object(U.d)(K.uf),Object(n.__param)(0,Object(K.Ne)()),Object(n.__param)(1,Object(K.cb)())],ae);Object(u.a)(ae,"RibbonControlsManager",
null,[727]);var Sd=a(211);let fc=class{constructor(Ra){this.sii=Ra.dJk}Ri(){return!1}executeCommand(Ra,Lb){Ra=Lb.command;Lb=null;switch(Ra){case 1243860697:this.sii.F_k();break;default:Lb=Sd.a(Ra)}return Lb||D.Task.Ua(!0)}Gi(Ra,Lb){return 1243860697===Lb.command}dj(){return!1}};fc=Object(n.__decorate)([Object(U.d)(K.Rf),Object(n.__param)(0,Object(K.Yf)()),Object(n.__param)(1,Object(K.gf)())],fc);Object(u.a)(fc,"SheetDropdownMenuCommandHandler",null,[43]);var uc=a(428),hc=a(87),Ec=a(77),yd=a(327),
Ad=a(17),$b=a(406),Ob=a(94),Yc=a(53),zd=a(306),Dd=a(193),oc=a(158),$c=a(59),yb=a(198);class qb{constructor(){this.Upf=new ab.a(!0);this.l$c=0}get NBd(){return this.l$c}get navigationButtonsDisabled(){return!!(this.NBd&1)}get operationButtonsDisabled(){return!!(this.NBd&2)}yIh(Ra,Lb){this.Upf.add(Ra,Lb);this.C2()}C2(){this.l$c=0;ab.a.forEach(this.Upf.zB,Ra=>{this.l$c=this.NBd|Ra.value})}}Object(u.a)(qb,"SheetTabBarDisabledStateManager",null,[]);var Cb=a(265),gc=a(29),Mc=a(975),bd=a(305),Id=a(93),Vd=
a(283),ce=a(54),ee=a(329),Je=a(16),Ue=a(69),jc=a(243),tc=a(118),Kc=a(176),wd=a(431),Rb=a(423),dc=a(44),$a=a(290),Wb=a(98);class rc extends Cb.a{constructor(Ra,Lb,Nc){Nc=void 0===Nc?!1:Nc;super(Ra);this.W2b=this.fWa=null;this.$=Lb;this.vQb=this.d9=Nc}get disabled(){return this.d9}dispose(){this.W2b=this.fWa=this.$=null;super.dispose()}x2(Ra){this.d9=Ra;this.domElement.setAttribute(Xa.a.EVa,Ra.toString());Je.DOMElementExtensions.toggleCssClass(this.domElement,Mc.a.tHa,Ra)}z1c(Ra){this.vQb=Ra}ZQa(Ra,
Lb){return this.disabled?!1:this.vQb&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")?(dc.a(this.$).eL(Ra,Lb),!1):!0}}Object(u.a)(rc,"SheetBarButton",Cb.a,[]);var xb=a(940),ic=a(171),Rc=a(152),Zc=a(635);class Kd extends rc{constructor(Ra,Lb,Nc,Ed){Ed=void 0===Ed?!1:Ed;super(document.createElement("a"),Lb,Ed);this.vj=Wd=>{var $d;if(!this.ZQa(Rc.a.sheetTabBar,ic.a.pJk))return!0;null===($d=U.a.nh(K.Sg))||void 0===$d?void 0:$d.oxa(xb.a.insertSheet);this.$.ti(-1935155518,
Wd.Dh,30,null);return!0};this.Cn=()=>{this.x2(!0)};this.Rl=()=>{Ba.f(this.$).cellTextEditBox.isEditing||this.x2(!1)};this.fWa=Nc.jh(this.domElement,Ia.a.instance.ia(509),0,Kd.gWa,Ia.a.instance.ia(510),jd.a.bxd,Ed);Ra.appendChild(this.domElement);this.oj.Ba("contextmenu",Wd=>{Ue.g(Wd)});$a.a.instance.xa(Ad.a.click,this.domElement,this.vj);this.y2a=oc.a.instance.T1(this.domElement,this.vj,Wb.a.wu,Wb.a.PCa);Ba.f(this.$).cellTextEditBox.Fv(this.Cn);Ba.f(this.$).cellTextEditBox.bU(this.Rl)}dispose(){$a.a.instance.Qa(Ad.a.click,
this.domElement,this.vj);oc.a.instance.A2(this.domElement,this.y2a);Ba.f(this.$)&&Ba.f(this.$).cellTextEditBox&&(Ba.f(this.$).cellTextEditBox.zv(this.Cn),Ba.f(this.$).cellTextEditBox.mZ(this.Rl));super.dispose()}x2(Ra){const Lb=Kd.OSg(this.$);super.x2(Ra||Lb)}static OSg(Ra){return Zc.a.Are(Ra)}}Kd.gWa=Ka.a.KEd;Object(u.a)(Kd,"InsertSheetButton",rc,[]);class fe extends rc{constructor(Ra,Lb,Nc){super(document.createElement("a"),Lb);this.vj=Ed=>{if(!this.ZQa(Rc.a.sheetTabBar,ic.a.qJk))return!0;this.$.ti(-684145703,
Ed.Dh,0,null);return!0};this.mng=Ed=>{Ac.HelperMethods.u_k(this.Cbf,fe.gWa,fe.gWa+Xa.a.bTf,("mouseover"===Ed.type||"focus"===Ed.type)&&!Ba.f(this.$).inRangePicker)};this.$=Lb;this.Cbf=Nc.jh(this.domElement,Ia.a.instance.ia(511),0,fe.gWa,Ia.a.instance.ia(512),jd.a.bxd);Ra.appendChild(this.domElement);this.oj.Ba("contextmenu",Ed=>{Ue.g(Ed)});this.oj.Ba("mouseover",this.mng);this.oj.Ba("mouseout",this.mng);$a.a.instance.xa(Ad.a.click,this.domElement,this.vj);this.y2a=oc.a.instance.T1(this.domElement,
this.vj,Wb.a.wu,Wb.a.PCa)}dispose(){$a.a.instance.Qa(Ad.a.click,this.domElement,this.vj);oc.a.instance.A2(this.domElement,this.y2a);this.Cbf=null;super.dispose()}}fe.gWa=Ka.a.KEd;Object(u.a)(fe,"InsertTemplateButton",rc,[]);class Ld{constructor(Ra,Lb){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Ra;this.newSheetIndex=Lb}getSheetName(){return this.sheetName}}Object(u.a)(Ld,"MacroRecorderSheetReorderedPayload",null,[146]);class Gd extends Cb.a{constructor(Ra,Lb){super(document.createElement("div"));
this.G1=()=>{v.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.uGg(!1,"OnSheetsChanged")};this.PQj=()=>{this.Hp()};this.OQj=()=>{this.to()};this.$=Ra;this.HXk=Lb;this.h5=!1;this.y$b=0}dispose(){this.to();super.dispose()}F_k(){this.uGg(!0,"TogglerSheetDropdownMenu")}uGg(Ra,Lb){v.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${Lb}, toggle: ${Ra}, toggleStateId: ${this.y$b}`);Ra&&(this.y$b+=1);const Nc=this.$.Eh.Li("UserAction",
`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${Lb}, toggle: ${Ra}, toggleStateId: ${this.y$b}, sheetCount: ${this.$.sa.count}`);Ra=this.T9h();appChrome.renderSheetDropdownMenu(this.domElement,this.HXk,Ra,this.y$b,this.PQj,this.OQj,()=>{Nc.stop()},wd.a(this.$))}T9h(){const Ra=this.$.sa,Lb=[];for(let Ed=0;Ed<Ra.count;Ed++){var Nc=Object(bc.a)(tc.a,Ra.getItem(Ed));0===Nc.zJ&&(Nc=this.S9h(Nc),Lb.push(Nc))}return Lb}S9h(Ra){const Lb={};Lb.key=Ra.name;Lb.text=Ra.name;Lb.onClick=this.U9h(Ra);Ra.active&&
(Lb.className=wd.a(this.$)?"ewa-active-sheet-menu-item-present-mode":"ewa-active-sheet-menu-item");return Lb}U9h(Ra){return()=>{const Lb=new S.a(-1876836819,0,this.$.ii,30,null);this.$.Ma.qh(Lb,{[Xa.a.$qe]:Ra.name})}}Hp(){if(!this.h5){const Ra=this.$.sa;Ra.pn(this.G1);Ra.vod(this.G1);Ra.S3(this.G1);Ra.Tta(this.G1);Ra.Uta(this.G1);Ra.s4e(this.G1);Ra.oeb(this.G1);this.h5=!0}}to(){if(this.h5){const Ra=this.$.sa;Ra.Gn(this.G1);Ra.Bie(this.G1);Ra.gca(this.G1);Ra.FAa(this.G1);Ra.GAa(this.G1);Ra.qFg(this.G1);
Ra.H4b(this.G1);this.h5=!1}}}Object(u.a)(Gd,"SheetDropdownMenu",Cb.a,[332,2]);class Zd extends rc{constructor(Ra,Lb,Nc){super(document.createElement("a"),Ra,!E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled"));this.Hm=()=>{this.x2(!1);E.EwaSettings.vl()||this.$.ea.yv(this.Hm)};this.vj=Ed=>{if(!this.ZQa(Rc.a.sheetTabBar,ic.a.tJk))return!0;this.c1g(Ed.Dh);return!0};this.onKeyDown=Ed=>13===Ed.La.keyCode||32===Ed.La.keyCode?(this.c1g(Ed.Dh),!0):!1;this.fWa=Lb.jh(this.domElement,
Ia.a.instance.ia(513),0,Ka.a.Cpi,Ia.a.instance.ia(513),jd.a.k1i,this.disabled);this.domElement.classList.add("ewa-stb-dropdown-menu-button");Nc.appendChild(this.domElement);E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")||this.Eki();this.lhk()}dispose(){this.W4k();super.dispose()}x2(Ra){super.x2(Ra||!this.$.ea.eya)}Eki(){const Ra=this.$.ea;Ra.lm?this.x2(!1):E.EwaSettings.vl()?this.$.ea.Yq(this.Hm):Ra.jr(this.Hm)}c1g(Ra){this.disabled||(v.ULS.sendTraceTag(537153793,
0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${J.a[Ra]}`),this.$.Ma.qh(new S.a(1243860697,Ra,this.$.ii,30,null)))}lhk(){$a.a.instance.xa(Ad.a.click,this.domElement,this.vj);oc.a.instance.xa(Ad.a.Ui,this.domElement,this.onKeyDown)}W4k(){$a.a.instance.Qa(Ad.a.click,this.domElement,this.vj);oc.a.instance.Qa(Ad.a.Ui,this.domElement,this.onKeyDown)}}Object(u.a)(Zd,"SheetDropdownMenuAnchor",rc,[]);var Bc=a(182),Lc=a(149),Cd=a(63),Fd=a(194);class te{constructor(Ra){this.sheet=Ra;this.altText=Ia.a.instance.ia(1994)}fV(){return this.sheet.active}qya(){return this.sheet.isLockPausedInSession}WBa(){return this.sheet.wn?
jd.a.vyg:jd.a.I4k}Tve(){return 16}PGa(){return null}QGa(){return"ewa-stb-locked-sheet-svg-16px"}Exe(){return null}RA(){return null}Dqd(){return!0}}Object(u.a)(te,"LockPausedSheetIconDataSource",null,[345]);class ye{constructor(Ra){this.sheet=Ra;this.altText=Ia.a.instance.ia(1993)}fV(){return this.sheet.active}qya(){return this.sheet.wn}WBa(){return jd.a.vyg}Tve(){return 16}PGa(){return null}QGa(){return"ewa-stb-locked-sheet-svg-16px"}Exe(){return null}RA(){return null}Dqd(){return!0}}Object(u.a)(ye,
"LockedSheetIconDataSource",null,[345]);class ue{constructor(Ra,Lb,Nc){this.sheet=Ra;this.altText=Ia.a.instance.ia(1908);this.U_k=Lb;this.yNk=Nc}fV(){return this.sheet.active}qya(){return this.sheet.dk.dx}PGa(){return this.fV()?"ewa-stb-nsv-active-svg":"ewa-stb-nsv-inactive-svg"}WBa(){return!this.fV()&&this.yNk()?jd.a.HJk:jd.a.GJk}Tve(){return 14}QGa(){return"ewa_nsv_margin"}Exe(){return this.sheet.dk.cHb}RA(){return this.U_k}Dqd(){return!1}}Object(u.a)(ue,"NamedSeetViewSheetIconDataSource",null,
[345]);var De=a(159);class Ke{constructor(Ra,Lb){this.Yed=this.wda=this.eQa=this.qA=null;this.E1f=!1;this.okd=this.WBa=this.QGa=this.PGa=null;this.XY=()=>{this.dataSource.fV()&&B.TaskExtensions.Xa(this.O7f,()=>{dialogControls.renderToolTip(this.dataSource.RA(),"SheetIconTooltip",this.dataSource.Exe(),this.q2,10,!1,!1,1)},this.$.ya,3)};this.WY=()=>{this.dataSource.fV()&&this.clearToolTip()};this.$=Ra;this.dataSource=Lb}get oj(){return this.wda||(this.wda=De.a.instance.$k(this.q2))}get O7f(){if(this.Yed)return this.Yed;
const Ra=new l.a;this.$.C5(Lb=>{B.TaskExtensions.Xa(Lb.v7f(),()=>{Ra.setResult(!0)},this.$.ya,3)});return this.Yed=Ra.task}get q2(){return this.okd}e6g(){if(this.q2&&(this.qA||this.eQa)){var Ra=this.dataSource.WBa();this.WBa!==Ra&&(this.eQa&&this.eQa.parentNode.removeChild(this.eQa),this.DVf(),this.WBa=Ra);Ra=this.dataSource.PGa();this.PGa!==Ra&&(this.tpk(this.eQa,this.PGa,Ra),this.PGa=Ra);Ra=this.dataSource.QGa();this.QGa!==Ra&&(this.spk(this.q2,this.QGa,Ra),this.QGa=Ra);this.dataSource.RA()&&!this.dataSource.fV()&&
this.clearToolTip()}}aPk(Ra,Lb,Nc){this.ldj(Ra,Lb,Nc);Je.DOMElementExtensions.setVisible(this.q2,this.dataSource.qya())}clearToolTip(){B.TaskExtensions.Xa(this.O7f,()=>{dialogControls.clearToolTip(this.dataSource.RA())},this.$.ya,3)}ldj(Ra,Lb,Nc){this.q2&&this.E1f!==Ra&&(this.q2.parentNode.removeChild(this.q2),this.QGa=this.PGa=this.WBa=this.okd=null,this.dataSource.RA()&&(this.oj.detach("mouseover",!0),this.oj.detach("mouseout",!0)));this.q2||(this.okd=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.q2,
Mc.a.ctc),Sys.UI.DomElement.addCssClass(this.q2,Ka.a.o4),Ra===this.dataSource.Dqd()?Lb.appendChild(this.q2):Lb.insertBefore(this.q2,Nc),this.DVf(),this.dataSource.RA()&&(this.oj.Ba("mouseover",this.XY,!0),this.oj.Ba("mouseout",this.WY,!0)),this.E1f=Ra)}tpk(Ra,Lb,Nc){Ra&&(Sys.UI.DomElement.removeCssClass(Ra,Lb),Sys.UI.DomElement.addCssClass(Ra,Nc))}spk(Ra,Lb,Nc){Lb&&Sys.UI.DomElement.removeCssClass(Ra,Lb);Nc&&Sys.UI.DomElement.addCssClass(Ra,Nc)}dispose(){Ob.a.dh(this.wda)}DVf(){const Ra=this.$.la.lh(388);
Ra?(this.eQa=Ra.m_a(this.dataSource.WBa(),this.dataSource.Tve()))?this.q2.appendChild(this.eQa):v.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.WBa()} was not found.`):v.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to receive SvgIconProvider service.")}}Object(u.a)(Ke,"SheetIcon",null,[2]);var pe=a(105);class pf extends pe.a{constructor(Ra,Lb){super(Ra.domElement);this.onKeyDown=Nc=>{121===Nc.keyCode&&Nc.shiftKey&&!this.vu.disabled&&
(this.showContextMenu(new Sys.UI.Point(0,0),1,this.vu.anchor),Ue.g(Nc))};this.R6=Nc=>{if(!this.$.isEditMode||this.vu.disabled)return!0;this.rename(!1,Nc.Dh);return!0};this.Ep=Nc=>{if(this.vu.disabled)return!0;E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncSheetOpsContextMenu",!1)&&Kc.b(this.$).SA(Nc.La.rawEvent,"context_menu_sheet_ops",null,["context-menu"]);return this.showContextMenu(Nc.clientPoint,Nc.Dh,Nc.li)};this.eYe=Ra;this.$=Lb;$a.a.instance.xa(Ad.a.Nr,Ra.domElement,
this.R6);$b.a.instance.xa(Ra.domElement,this.Ep);this.oj.Ba("keydown",this.onKeyDown)}get vu(){return this.eYe}dispose(){this.vu&&($a.a.instance.Qa(Ad.a.Nr,this.vu.domElement,this.R6),$b.a.instance.Qa(this.vu.domElement,this.Ep),this.eYe=null);this.$=null;super.dispose()}showContextMenu(Ra,Lb,Nc){if(!this.vu.ZQa(Rc.a.sheetTabBar,ic.a.uJk))return!0;this.vu.activate("showContextMenu",Lb,Db.a.m3f());Lb=new S.a(-1075099431,Lb,this.$.ii,30,null);let Ed;return!yb.a(Ed=this.$.Ma.qh(Lb,{[Xa.a.are]:Ra,[pf.eJk]:this.vu.sheet,
[Xa.a.bre]:Nc}))&&(6!==Ed.status||Ed.result)}rename(Ra,Lb){this.$.ti(817296323,Lb,Ra?19:0,null)}}pf.eJk="Sheet";Object(u.a)(pf,"SheetOpsSheetClickHelper",pe.a,[]);var qf=a(47),of=a(120);class Ef extends rc{constructor(Ra,Lb,Nc,Ed,Wd){super(document.createElement("li"),Ra);this.bJk=100;this.cJk=500;this.$mf=Ac.HelperMethods.ere;this.h5=this.Yqe=!1;this.color=this.$9c=this.x9c=this.x_b=this.bld=null;this.tIc=this.d0f=!1;this.ytc="#BEBBB8";this.n7c=null;this.onKeyDown=$d=>13===$d.La.keyCode&&this.ZQa(Rc.a.sheetTabBar,
ic.a.zJk)?(this.activateSheet(1),!0):!1;this.RE=$d=>32===$d.La.charCode&&this.ZQa(Rc.a.sheetTabBar,ic.a.AJk)?(this.activateSheet(1),!0):!1;this.XY=()=>{this.disabled||this.vQb||this.yJ.e1||this.sBa(!0,void 0,"OnMouseOver")};this.WY=()=>{this.disabled||this.vQb||this.sBa(!1,void 0,"OnMouseOut")};this.Z0b=()=>{if(!this.yJ.e1){this.fUk();const $d=this.sheet.sheetProcessedData;this.disabled||this.vQb||Object(of.d)($d)||"PartialResult"===(null===$d||void 0===$d?void 0:$d.reason)||Ba.f(this.$).EOa(this.sheet.sheetName,
"sheetTabButton.onMouseEnter",!0)}return!1};this.Qha=()=>{this.utf(!1);return!1};this.vj=$d=>{if(!this.ZQa(Rc.a.sheetTabBar,ic.a.xJk))return!0;const se=Ba.f(this.$);this.sheet.active||3!==$d.Dh||!Db.a.q2a()&&!this.QXb||se.isEditing||se.kq||se.MNb();this.activateSheet($d.Dh);return 3!==$d.Dh};this.onPointerDown=$d=>{if(!this.ZQa(Rc.a.sheetTabBar,ic.a.yJk))return!0;this.utf(!0);Ba.f(this.$).inRangePicker&&v.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var se=3===$d.Dh;if(2===$d.Dh||se&&this.uLa)this.sBa(!0,!se,"OnPointerDown"),se=D.Task.delay(se?this.cJk:this.bJk).kB(()=>!0),this.cXb&&(this.tIc=!0,this.yJ.gVc=B.TaskExtensions.Xa(se,()=>{this.tIc&&this.yJ.WZj(this,$d)},this.ya,11));return!1};this.Bo=$d=>{if(this.disabled||!this.cXb&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.tIc=!1;this.sBa(2===$d.Dh,void 0,"OnPointerUp");this.yJ.gVc&&(B.TaskExtensions.Xa(this.yJ.gVc,()=>{this.yJ.VZj()},
this.ya,11),this.yJ.gVc=null);return!1};this.bZ=()=>{this.tIc=!1;this.Yqe||this.sBa(!1,void 0,"OnTouchMove");return!1};this.Yff=new pf(this,Ra);this.QXb=Db.a.QXb();this.$=Ra;this.ljc=Ed;this.yJ=Wd;this.cXb=Wd.m6e();this.f$h();this.T3h();this.dSd=Ra.Eh.em("UserAction",this.name);this.VWd=!1;Je.DOMElementExtensions.oL(this.domElement,Xa.a.nz,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.pU);this.wBa=new aa.a;Ra=new ye(this.sheet);this.wBa.add(new Ke(this.$,Ra));this.$.ea.M7b&&
(Ra=new te(this.sheet),this.wBa.add(new Ke(this.$,Ra)));Ra=new ue(this.sheet,this.yJ.RYc,()=>this.color?Ef.Dse(this.color):!1);this.x_b=new Ke(this.$,Ra);this.wBa.add(this.x_b);this.uLa=this.yJ.uLa;this.Czb();this.Iik();this.Haf=new ee.a(this.domElement,1);Lb.insertBefore(this.domElement,Nc);wd.a(this.$)&&this.a7g(!0);v.ULS.sendTraceTag(507643663,0,50,`SheetTabButton.ctor: index=${Ed.index}, navigationButtonsDisabled=${Wd.navigationButtonsDisabled}, operationButtonsDisabled=${Wd.operationButtonsDisabled}`)}get cBd(){return this.$9c||
(this.$9c=Va.a.Mu("#F5F5F5"))}get name(){return this.kQ.innerText}set name(Ra){this.kQ&&(this.kQ.innerText=Ra,this.M2c(),this.b7g())}get sheet(){return this.ljc}get anchor(){return this.n7c}get kQ(){return this.bld}get pU(){return this.x9c}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Ra){this.anchor.tabIndex=Ra}VGf(){return Je.DOMElementExtensions.$o(this.anchor)?this.anchor:null}dispose(){if(this.h5){zd.a.instance.Qa(Ad.a.qj,this.domElement,this.onPointerDown);oc.a.instance.Qa(Ad.a.Ui,
this.domElement,this.onKeyDown);oc.a.instance.Qa(Ad.a.gx,this.domElement,this.RE);$a.a.instance.Qa(Ad.a.click,this.domElement,this.vj);zd.a.instance.Qa(Ad.a.o7,this.domElement,this.Z0b);zd.a.instance.Qa(Ad.a.aL,this.domElement,this.Qha);if(this.cXb||E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))zd.a.instance.Qa(Ad.a.Co,this.domElement,this.Bo),this.uLa&&(Dd.a.instance.Qa(Ad.a.ml,this.domElement,this.Bo),Dd.a.instance.Qa(Ad.a.Jn,this.domElement,this.bZ));this.h5=
!1;this.ytc="#BEBBB8"}Ob.a.gj([this.Yff,this.Haf]);this.bld=this.x9c=this.n7c=this.yJ=this.Haf=this.Yff=null;if(this.wBa){for(const Ra of this.wBa)Ra.dispose();this.wBa=null}this.color=this.ljc=null;super.dispose()}x2(Ra){Ra&&this.sBa(!1,!1);super.x2(Ra)}lVg(Ra){Cd.a.Wl.xY&&(this.dqf(),void U.a.resolve(K.ae,{va:1}).then(Lb=>{Bc.a.VI().then(Nc=>{Lb.$Ek(Nc);Lb.show(Ra);return null},Nc=>{v.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Nc}`);
return null})}))}Ezh(){if(this.sheet.active&&this.$.Xw){var Ra=this.$.Xw,Lb=Ba.f(this.$),Nc=Lb.fp;if(this.sheet.dk.dx){if(!this.x_b){const Ed=new ue(this.sheet,this.yJ.RYc,()=>this.color?Ef.Dse(this.color):!1);this.x_b=new Ke(this.$,Ed);this.wBa.add(this.x_b)}Nc&&Lb.pzb(1);Ra.classList.add(Ka.a.txf);Ra=Ef.hJf(Xa.a.feg);Lb=Ef.hJf(Xa.a.z6d);"true"===Ra&&"true"===Lb?this.$.ea.ose&&this.$.ea.g8b&&(this.sheet.dk.YM?(Ra=1,Lc.a.xG(Xa.a.z6d,"false",Lc.a.tba),this.$.ea.g8b=!1):Ra=0,Lc.a.xG(Xa.a.feg,"false",
Lc.a.tba),this.$.ea.ose=!1,this.lVg(Ra)):this.sheet.dk.YM&&"true"===Lb&&this.$.ea.g8b&&(Lc.a.xG(Xa.a.z6d,"false",Lc.a.tba),this.$.ea.g8b=!1,this.lVg(2))}else this.dqf(),Nc&&Lb.pzb(0),Ra.classList.remove(Ka.a.txf)}}dqf(){const Ra=U.a.nh(K.ae);Ra&&Ra.dismiss()}Czb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.wob()?"tab-active":"tab-inactive";E.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.kQ.parentNode.classList.add("leave-size-fixed-on-tab-hover"):
this.kQ.parentNode.classList.add("leave-size-fixed-on-tab-hover-old");this.b7g();this.bPk();this.i7g();this.M2c();this.Ezh()}UZj(){this.Yqe=!0;this.sBa(!0,!0,"OnSheetReorderStarted")}TZj(){this.Yqe=!1;this.sBa(!1,void 0,"OnSheetReorderEnded")}activate(Ra,Lb,Nc){Lb=void 0===Lb?0:Lb;Nc=void 0===Nc?!1:Nc;this.iqc()||(this.sheet.activate({scenario:Ra}),Nc&&Ba.f(this.$).focus(),Ra={["InputMethod"]:J.a[Lb],["AppMode"]:this.$.ii,["Location"]:"canvas"},ea.b(this.$).Aj(L.a.ZIk,Ra))}a7g(Ra){this.ytc=Ra?"#797775":
"#BEBBB8";this.$mf=Ra?-.5:Ac.HelperMethods.ere;this.$9c=Ra?Va.a.Mu("#3B3A39"):Va.a.Mu("#F5F5F5");this.i7g()}vBk(Ra){this.cXb=Ra}J_h(Ra){var Lb;const Nc=[];this.name!==Ra.SheetName&&Nc.push(`SheetName. CachedSheetName null or empty: ${null==Ra.SheetName||""===Ra.SheetName}`);if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8625911_addStbSheetColorSsr")){const Ed=null!==(Lb=Ra.TabColor)&&void 0!==Lb?Lb:Va.a.DJ(this.cBd);Va.a.DJ(this.color).toLowerCase()!==Ed.toLowerCase()&&Nc.push("TabColor")}else this.color.jCa()!==
this.cBd.jCa()&&Nc.push("TabColor");E.EwaSettings.isChangeGateEnabled("OfficeVSO:8654274_addLockedSheetSsr")?this.sheet.PK(128)!==Ac.HelperMethods.YR(Ra.SheetOptions,128)&&Nc.push("Locked"):this.sheet.wn&&Nc.push("Locked");return Nc}hVh(Ra){Ra.ghb();this.sheet.activate({scenario:"switchSheet"})}ywh(Ra){Ra=new S.a(-1876836819,Ra,this.$.ii,30,null);return this.$.Ma.qh(Ra,{[Xa.a.$qe]:this.sheet.name})}b7g(){this.kQ.parentNode.setAttribute("sheet-title",this.kQ.innerText)}M2c(){const Ra=this.JEi();this.anchor.setAttribute(Xa.a.rD,
Ra);this.anchor.setAttribute(Xa.a.ula,this.sheet.active.toString())}JEi(){const Ra=this.sheet.dk.dx,Lb=this.sheet.dk.cHb,Nc=this.sheet.wn,Ed=this.sheet.isLockPausedInSession;return Ra&&Nc?String.format(Ia.a.instance.sh(20),this.name,Lb):Ra&&Ed?String.format(Ia.a.instance.sh(22),this.name,Lb):Ra?String.format(Ia.a.instance.sh(19),this.name,Lb):Nc?String.format(Ia.a.instance.sh(18),this.name):Ed?String.format(Ia.a.instance.sh(21),this.name):this.name}activateSheet(Ra){Ra=void 0===Ra?0:Ra;var Lb;if(Db.a.m3f()){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.iqc())return D.Task.Ua(!1);Fd.a.current.yZ="ActivateSheet";null===(Lb=U.a.nh(K.Sg))||void 0===Lb?void 0:Lb.oxa(xb.a.switchSheet);this.sheet.activate({scenario:"switchSheet"});return D.Task.Ua(!0)}return this.ywh(Ra)}i7g(){const Ra=this.sheet.tabColor;this.color=Ra?Va.a.Mu(Ra):this.cBd;this.d0f=Ef.Dse(this.color);this.sBa(!1,void 0,"UpdateTabColor")}sBa(Ra,Lb,Nc){Lb=void 0===Lb?!1:Lb;Nc=void 0===Nc?null:Nc;if(this.sheet){Nc=this.sheet.active;var Ed=this.wob(),Wd=!!this.sheet.tabColor,$d=Va.a.DJ(Nc||
Ed?la.a.kRa:this.color);this.pU.style.background="";Nc||Ed?(Wd&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.Fxa?this.RGk():this.QGk()),this.pU.style.height=Ac.HelperMethods.lSg.toString()+"px"):(this.pU.style.filter="",this.pU.style.backgroundColor=$d,this.pU.style.height=Ac.HelperMethods.mSg.toString()+"px");this.kQ.className=Nc?"tab-active-text":Ed?"dark":this.d0f?"light":"dark";for(const se of this.wBa)se.e6g();Ra&&!Wd&&(this.pU.style.backgroundColor=
"#E1DFDD");Je.DOMElementExtensions.toggleCssClass(this.domElement,"tab-hover",Ra);Lb?(Wd||(this.pU.style.backgroundColor=this.ytc),this.domElement.style.backgroundColor=this.ytc):(Wd||(this.pU.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.kQ.style.fontWeight=Nc||Ed?"600":""}else v.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, which means its not rendered. caller: ${Nc}`)}QGk(){const Ra=this.pU.style,Lb=Va.a.DJ(Va.a.fef(this.color,
this.$mf));Ra.background=Lb}RGk(){this.pU.style.background="transparent"}T3h(){this.n7c=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className="tab-anchor-text";Je.DOMElementExtensions.oL(this.anchor,Xa.a.WIb,null,null);this.tabIndex=-1}f$h(){this.x9c=document.createElement("span");this.pU.className="tab-content-container";this.bld=document.createElement("span");this.kQ.className="tab-text";this.kQ.dir=this.sheet.rtlName?"rtl":"ltr";this.pU.appendChild(this.kQ)}bPk(){const Ra=
this.$.kX;for(const Lb of this.wBa)Lb.aPk(Ra,this.pU,this.kQ)}wob(){return Ba.f(this.$).wob(this.sheet)}fUk(){this.dSd.start();this.VWd=!0}utf(Ra){this.VWd&&(this.dSd.stop(),v.ULS.sendTraceTag(537153686,0,50,qf.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.dSd.zi,["Has been clicked"]:Ra})),this.VWd=!1)}Iik(){zd.a.instance.xa(Ad.a.qj,this.domElement,this.onPointerDown);oc.a.instance.xa(Ad.a.Ui,this.domElement,this.onKeyDown);oc.a.instance.xa(Ad.a.gx,
this.domElement,this.RE);this.oj.Ba("mouseover",this.XY);this.oj.Ba("mouseout",this.WY);zd.a.instance.xa(Ad.a.o7,this.domElement,this.Z0b);zd.a.instance.xa(Ad.a.aL,this.domElement,this.Qha);if(this.cXb||E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))zd.a.instance.xa(Ad.a.Co,this.domElement,this.Bo),this.uLa&&(Dd.a.instance.xa(Ad.a.ml,this.domElement,this.Bo),Dd.a.instance.xa(Ad.a.Jn,this.domElement,this.bZ));$a.a.instance.xa(Ad.a.click,this.domElement,this.vj);
this.h5=!0}iqc(){const Ra=K.Qb.Aa()?U.a.nh(K.Qb):this.$.la.lh(65);return Ra&&Ra.fya()?(Ra.yWc(),this.hVh(Ra),!0):!1}static hJf(Ra){let Lb=Lc.a.get(Ra);Lb||(Lc.a.xG(Ra,"true",Lc.a.tba),Lb=Lc.a.get(Ra));return Lb}static Dse(Ra){return 128>=(222*Ra.r+707*Ra.g+71*Ra.b)/1E3}}Object(u.a)(Ef,"SheetTabButton",rc,[]);class Nf extends rc{constructor(Ra,Lb,Nc){super(document.createElement("a"),Lb);this.gWa=Ka.a.KEd;Nc.jh(this.domElement,Ia.a.instance.ia(713),0,this.gWa,Ia.a.instance.ia(713),jd.a.bxd,!0);Ra.appendChild(this.domElement);
this.oj.Ba("contextmenu",Ed=>{Ue.g(Ed)})}}Object(u.a)(Nf,"WorkbookProtectionButton",rc,[]);var Kf=a(45),Qf=a(70),Hf=a(651);class If extends Cb.a{constructor(Ra,Lb,Nc,Ed){Ed=void 0===Ed?null:Ed;super(Lb);this.LBa=Nc;this.sheetTabActivatePreviousHidden=Ia.a.instance.ia(722);this.sheetTabActivateNextHidden=Ia.a.instance.ia(724);this.svgIconProvider=null;this.To=[];this.KY=Array(6);this.I6d=Array(6);this.exb=this.hre=this.gre=this.av=null;this.nHg=!1;this.T7a=this.GUb=this.U0=null;this.isRtl=!1;this.Ioa=
this.aP=0;this.tvc=this.fVc=!1;this.aBa=0;this.dFc=!0;this.FRc=0;this.MX=this.Efa=this.Ema=this.Cvc=null;this.ACc=this.HM=0;this.L9b=null;this.oYb=-1;this.rfa=null;this.KQc=0;this.K_c=-1;this.sAa=0;this.THa=new qb;this.Cdd=!1;this.gVc=this.EPa=this.DPa=this.cYe=this.yba=null;this.HPe=!1;this.bYe=null;this.sUf=()=>{this.rUf("onWorkbookOpened");this.$.Wr(this.sUf)};this.MH=(Wd,$d)=>{this.Eqg($d.item)};this.E1=(Wd,$d)=>{Wd=this.$.sa.ma.index;for(let se=0,Fa=this.To.length;se<Fa;se++){const lb=this.maa(se);
if(lb.name===$d.oldName){lb.name=$d.newName;this.bca();se===Wd&&this.qqa(6);break}}};this.Hqg=(Wd,$d)=>{(Wd=this.Xjb($d.item))&&Wd.Czb()};this.Iqg=(Wd,$d)=>{$d.visible?(this.O7a(!1),this.Fqg($d.item)):this.Eqg($d.item)};this.e4a=Wd=>{this.e1?(this.rfa=Wd,this.eac()):(this.rfa&&(this.FRc+=this.rfa.clientPoint.x-Wd.clientPoint.x),this.rfa=Wd,Math.abs(this.FRc)>=this.kii&&this.eac());return!0};this.bZ=Wd=>{Wd.La.preventDefault();return!1};this.nMg=Wd=>{this.kMg(Wd,!0)};this.mMg=Wd=>{this.kMg(Wd,!1)};
this.f4a=Wd=>{if(this.e1){this.tvc=this.dkj(Wd);let $d;Wd=($d=this.maa(this.HM+1))?$d.sheet:null;this.reorderSheets(Wd,this.HM+1===this.N7b,!0)}this.c5();return!0};this.vq=(Wd,$d)=>{$d.IB&&this.EAe($d.IB);this.YXc(!1);this.bca();$d.ma&&(this.EAe($d.ma),this.qqa(6),this.ea.uNa())};this.Jgg=(Wd,$d)=>{this.O3c($d.item)};this.Kgg=(Wd,$d)=>{this.O3c($d.item)};this.Lgg=(Wd,$d)=>{this.O3c($d.item)};this.m4a=(Wd,$d)=>{this.O3c($d.item)};this.aNa=()=>{this.Tvd()};this.Dj=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;
this.Tvd();this.Czd();E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)||!Qf.d(this.$)&&!Qf.e(this.$)||this.mHg();this.kzd();this.bca();this.O7a(!0);this.qqa(6);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(Qf.d(this.$)||Qf.e(this.$))&&this.mHg()};this.mq=()=>{this.isVisible&&(this.bca(),this.qqa(6))};this.Fl=()=>{Object(cb.a)(Kd,this.U0)===Id.l(this.$.Xk)&&this.kzd();for(const Wd of this.To)Wd.vBk(!Id.l(this.$.Xk))};
this.Gqg=(Wd,$d)=>{this.gpk($d.item,$d.isUserOperation)};this.p1b=(Wd,$d)=>{this.Fqg($d.item)};this.onKeyDown=Wd=>{switch(Wd.keyCode){case 9:var $d=this.domElement.querySelectorAll(Je.DOMElementExtensions.RI);const se=Je.DOMElementExtensions.DE($d);$d=Je.DOMElementExtensions.jaa($d);Je.DOMElementExtensions.F7a(Wd,se,$d);break;case 39:case 37:Je.DOMElementExtensions.nPg(Wd,this.domElement.querySelectorAll(Je.DOMElementExtensions.RI),39===Wd.keyCode?!this.isRtl:this.isRtl)}v.ULS.sendTraceTag(537153691,
0,50,`SheetTabBarControl.OnKeyDown: Press on ${Wd.keyCode}`)};this.onScroll=()=>{this.av.scrollLeft!==this.aBa&&this.NYk()};this.ZY=Wd=>{if(Wd.ctrlKey||Wd.efa)return!1;this.av.scrollLeft+=Math.floor(30*Wd.TCa);if(this.e1){const $d=this.mHf("OnMouseWheel");$d&&this.Vve(0<Wd.TCa,$d.x+$d.width/2)}return!0};this.Ep=Wd=>{if(!Hf.a.bWb)return!1;v.ULS.sendTraceTag(507363731,0,50,"SheetTabBarControl.onContextMenu: Context menu opened from sheet tab bar.");const $d=new S.a(-1075099431,Wd.Dh,this.$.ii,30,null);
let se;return!yb.a(se=this.$.Ma.qh($d,{[Xa.a.are]:Wd.clientPoint,[Xa.a.bre]:Wd.li,[Xa.a.fSg]:!0}))&&(6!==se.status||se.result)};this.$Y=(Wd,$d)=>{if(this.THa)v.ULS.sendTraceTag(507847647,0,50,`SheetTabBarControl.onPartialInteractivityStatusChanged: sender=${!!Wd}, activated=${$d.YT}, swappedPIType=${$d.ara}`),this.YPf("PartialInteractivity",$d.YT?3:0);else if(this.c5(!1),this.Ape($d.YT),E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const se of this.noc)se&&
se.z1c($d.YT);for(const se of this.To)se&&se.z1c($d.YT)}else{for(const se of this.noc)se&&se.x2($d.YT);for(const se of this.To)se&&se.x2($d.YT)}};this.y0b=(Wd,$d)=>{Wd=0|($d.ind?2:0);Wd|=$d.ind&&$d.fJk?1:0;this.YPf("ComponentRangePicker",Wd)};this.$=Ra;this.svgIconProvider=Ed;this.$.sa?this.rUf("ctor"):this.$.kr(this.sUf);Nc||v.ULS.sendTraceTag(507536514,0,10,"SheetTabBarControl.ctor: SkeletonManager must always exist.")}rUf(Ra){v.ULS.sendTraceTag(507847648,0,50,`SheetTabBarControl.initComponent: caller=${Ra}`);
this.ea=this.$.ea;this.Jvc=!E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.Zqj=E.EwaSettings.isChangeGateEnabled("OfficeVSO:8749006_EnrichSTBSkeleton");this.S2f=!this.$.IC;this.HPe=!w.a.ZR;this.rmj=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.aJj=this.$.ua.SheetTabNavigateButtonLongKeyPressPeriodMS;this.$Ij=this.$.ua.SheetTabNavigateButtonIntervalPeriodMS;this.kii=this.$.ua.SheetTabDragStartPixelThreshold;
this.g5a=this.h5a=-1;this.Kxd=!1;this.aM=new ee.a(this.domElement,3);this.domElement.classList.add("ewa-stb-uir");this.K7h();this.i5h();this.L7h();document.getElementById(Xa.a.Gga)||this.T8h();this.YXc(!0);this.Dj(null,null);Ra=this.$.sa;Ra.pn(this.vq);Ra.vod(this.aNa);Ra.S3(this.MH);Ra.Tta(this.p1b);Ra.Uta(this.E1);Ra.s4e(this.Gqg);Ra.oeb(this.Iqg);Ra.RCh(this.Hqg);Ra.Qod(this.Jgg);Ra.q4e(this.Kgg);Ra.Rod(this.Lgg);Ra.r4e(this.m4a);this.$.kr(this.Dj);this.$.xI(this.mq);bd.a(this.$).Tq(this);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||this.$.la.Hh(32,this);E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.mz(this.Fl);this.TYc=this.pl.$k(this.domElement);this.TYc.Ba("keydown",this.onKeyDown);dc.a(this.$).tv()&&this.$Y(null,new Rb.a(!0));dc.a(this.$).Tm.Wta(this.$Y);Ba.f(this.$).T3e(this.y0b);this.TYc.Ba("mousedown",Lb=>{Lb.preventDefault()});yd.a.instance.xa(Ad.a.fN,this.domElement,this.ZY);$b.a.instance.xa(this.domElement,this.Ep);this.fre=this.pl.$k(this.av);this.fre.Ba("scroll",
this.onScroll);this.NYk=jc.b(()=>{this.bca()},200,this.$.ya,ce.a.nJk,!0);E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")?this.LBa.IM(Xa.a.W8b):this.$.kP(Xa.a.W8b);this.S2f&&(this.bYe=new Gd(this.$,this.T7a.domElement))}ybh(){if(!this.Zqj)return!1;Kf.a.instance.uL("SheetTabBarPromotion");const Ra=this.y_h(this.LBa.MWg);Kf.a.instance.mH("SheetTabBarPromotion");const Lb=0===Ra.length;v.ULS.sendTraceTag(507839499,0,15,`SheetTabBar Skeleton Model Comparison ${Lb?"Succeeded":"Failed"}.${Lb?
"":` Mismatches: ${Ra.join(", ")}.`}`);Lb&&Kf.a.instance.Nm("SheetTabBarTTVRPromoted");return Lb}get hj(){return this.domElement}get $o(){return this.isVisible}get hl(){return Vd.a.dre}get e1(){return this.Cdd}get N7b(){return this.To.length}get RYc(){return this.cYe}get uLa(){return this.HPe}get navigationButtonsDisabled(){return!!this.THa&&this.THa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.THa&&this.THa.operationButtonsDisabled}get lJj(){return this.$.kX?[Ka.a.Fvf,Ka.a.Gvf,
Ka.a.Hvf,Ka.a.Evf,Ka.a.Iwc,Ka.a.Iwc]:[Ka.a.Evf,Ka.a.Hvf,Ka.a.Gvf,Ka.a.Fvf,Ka.a.Iwc,Ka.a.Iwc]}get J6d(){return this.$.kX?[null,jd.a.Ehf,jd.a.Chf]:[null,jd.a.Chf,jd.a.Ehf]}get Lwg(){return this.$.kX?[null,jd.a.Fhf,jd.a.Dhf]:[null,jd.a.Dhf,jd.a.Fhf]}get MYb(){if(this.isRtl){if(w.a.aJ)return 0;if(w.a.Am)return-1*(this.av.scrollWidth-this.av.clientWidth);if(w.a.ZR)return this.av.scrollWidth-this.av.clientWidth;v.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get M5b(){if(this.isRtl){if(w.a.aJ)return this.av.scrollWidth-
this.av.clientWidth;if(w.a.Am||w.a.ZR)return 0;v.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.av.scrollWidth-this.av.clientWidth}get noc(){return this.THa?[this.U0,this.GUb]:[this.U0,this.GUb,this.T7a]}get c_g(){return this.To.concat(this.T7a)}get Sfe(){return!this.aP}get Tfe(){return this.Ioa===this.To.length-1}get dJk(){return this.bYe}jh(Ra,Lb,Nc,Ed,Wd,$d,se){se=void 0===se?!1:se;Ra.removeAttribute("Href");Ra.setAttribute(Xa.a.hk,Xa.a.FF);
Ra.className="ewa-stb-navbutton";Ra.title=Lb;Ra.tabIndex=0;$d?Nc=this.svgIconProvider.Mna($d,12,12,Ra,24,24):(Lb=document.createElement("span"),Lb.className=Ka.a.cYh,Lb.classList.add(Mc.a.ctc),Lb.tabIndex=-1,Ra.appendChild(Lb),$d=document.createElement("img"),$d.src=Oa.a.An(Nc),$d.className=Ed,$d.alt=Wd,$d.tabIndex=-1,Lb.appendChild($d),Nc=$d);se&&Ra.classList.add(Mc.a.tHa);return Nc}dispose(){if(this.$){var Ra=this.$.sa;Ra.Gn(this.vq);Ra.Bie(this.aNa);Ra.gca(this.MH);Ra.FAa(this.p1b);Ra.GAa(this.E1);
Ra.qFg(this.Gqg);Ra.H4b(this.Iqg);Ra.Fmk(this.Hqg);Ra.Uie(this.Jgg);Ra.oFg(this.Kgg);Ra.Vie(this.Lgg);Ra.pFg(this.m4a);this.$.Wr(this.Dj);this.$.fL(this.mq);dc.a(this.$)&&dc.a(this.$).Tm.HAa(this.$Y);this.THa&&Ba.f(this.$).UEg(this.y0b);yd.a.instance.Qa(Ad.a.fN,this.domElement,this.ZY);$b.a.instance.Qa(this.domElement,this.Ep)}Ob.a.gj(this.I6d);this.I6d=null;if(this.KY)for(Ra=0;Ra<this.KY.length;Ra++){const Lb=Je.DOMElementExtensions.fP(this.KY[Ra],this.domElement,!1,"a");Lb&&Yc.a.tOa(Lb)}Ob.a.dh(this.aM);
Ob.a.dh(this.TYc);Ob.a.dh(this.fre);this.fre=this.TYc=this.GUb=this.U0=this.aM=null;this.$&&this.c5(!1);this.Ema=null;this.Zoe(null,"Dispose");this.L9b=this.MX=this.Cvc=null;this.Tvd();this.exb=this.hre=this.gre=this.av=this.KY=this.$=this.ea=null;super.dispose()}y_h(Ra){var Lb,Nc;const Ed=[],Wd=[];if(null==Ra)Ed.push("WorkbookCacheItem was null, no cached state to compare");else if(Ra.fxb&&0!==Ra.fxb.length)if(this.N7b!==Ra.fxb.length)Ed.push(`SheetTab visible sheet number mismatch. Cached: ${Ra.fxb.length} Actual: ${this.N7b}`);
else{var $d=Ra.fxb;for(let se=0;se<this.To.length;se++){const Fa=this.To[se].J_h($d[se]);0<Fa.length&&Wd.push(`Button position ${se}: ${Fa.join(", ")}`)}($d=null===(Nc=null===(Lb=this.$.sa)||void 0===Lb?void 0:Lb.ma)||void 0===Nc?void 0:Nc.name)&&$d===Ra.activeSheetName||Ed.push(`Active sheet mismatch. Cached value is null: ${!(null===Ra||void 0===Ra?0:Ra.activeSheetName)} Actual value is null: ${!$d}`);this.isRtl!==Ra.EYf&&Ed.push(`Rtl: isRtl: ${this.isRtl} cacheDisplayRtl: ${Ra.EYf}`);this.x_h(Ed,
Ra)}else Ed.push(`No cached sheet tabs, sheetTabs null: ${!Ra.fxb}`);0<Wd.length&&Ed.push(`SheetTabButton: [${Wd.join(", ")}]`);return Ed}Up(Ra,Lb){if(!Lb){v.ULS.shipAssertTag(537153760,0,0<this.To.length,"There is no sheet tab button.");if(!this.To.length)return!1;Ra=null;for(const Nc of this.To)if(Ra=Nc.VGf())break;if(!Ra)return v.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Je.DOMElementExtensions.setFocus(Ra)}return!Lb}sq(Ra){return Je.DOMElementExtensions.eo(this.hj,
Ra)}Js(){}lu(){}reorderSheets(Ra,Lb,Nc){if(this.yba&&this.yba!==Ra){const Ed=this.yba.index;this.fpk(this.yba,Ra,Lb);Ra=Ra?Ra.index-1:Lb?this.$.sa.count-1:0;Ed!==Ra&&(this.jBj(Ed,Ra,Nc),this.nli(this.yba.name,Ra))}}v_i(Ra){Ra=this.nwa(Ra);return-1!==Ra&&this.aP<=Ra&&Ra<=this.Ioa?this.To[Ra].domElement:null}$6g(Ra){for(var Lb=0;Lb<this.KY.length;Lb++){const Nc=this.KY[Lb];if(Nc&&this.svgIconProvider){const Ed=Nc.parentNode;this.xEg(Nc);Ed&&(this.KY[Lb]=this.svgIconProvider.Mna(Ra?this.Lwg[Lb]:this.J6d[Lb],
12,12,Ed,24,24))}}for(Lb=0;Lb<this.To.length;Lb++)this.To[Lb].a7g(Ra);this.T7a&&this.T7a.fWa&&this.Z6g(jd.a.l1i,this.T7a,Ra);this.U0&&this.U0.fWa&&this.Z6g(jd.a.p_h,this.U0,Ra)}Z6g(Ra,Lb,Nc){Lb.W2b||(Lb.W2b=this.svgIconProvider.Mna(Ra,12,12,Lb.fWa.parentNode,24,24));Lb.W2b&&(Je.DOMElementExtensions.setVisible(Lb.fWa,!Nc),Je.DOMElementExtensions.setVisible(Lb.W2b,Nc))}WZj(Ra,Lb){var Nc=Ba.f(this.$);const Ed=Nc.inRangePicker,Wd=Ac.HelperMethods.oA(Lb);if(Nc.isEditing&&!Ed){const $d=Nc.vA?"formulaBar_end_edit_sheet_changed":
"cell_text_end_edit_sheet_changed";let se;se=[Object(Kc.a)(Nc.cellTextEditBox.Wa.jQa)];Kc.b(this.$).SA(Wd.rawEvent,$d,se);Nc.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Nc=this.uLa&&3===Lb.Dh;!(2===Lb.Dh&&Wd.button===Sys.UI.MouseButton.leftButton||Nc)||Ed||this.e1||dc.a(this.$).tv()||(Nc&&Ra.UZj(),this.oYb=Lb.clientPoint.x,this.rfa=Lb,this.pMh(Ra))}VZj(){this.bca()}m6e(){return this.$.isEditMode&&!Id.l(this.$.Xk)}bca(){const Ra=Ac.HelperMethods.eN(()=>{this.u7k();this.uGk();this.Ape()});v.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Ra}`)}uGk(){const Ra=this.Tfe;Je.DOMElementExtensions.toggleCssClass(this.exb,this.$.kX?"ewa-stb-right-scrollable":"ewa-stb-left-scrollable",!this.Sfe);Je.DOMElementExtensions.toggleCssClass(this.exb,this.$.kX?"ewa-stb-left-scrollable":"ewa-stb-right-scrollable",!Ra)}Ape(Ra){Ra=void 0===Ra?!1:Ra;const Lb=this.Sfe,Nc=this.Tfe;this.YPg(4,this.sheetTabActivatePreviousHidden,!Lb);this.YPg(5,this.sheetTabActivateNextHidden,!Nc);
this.mYc(0,Lb||Ra);this.mYc(1,Lb||Ra);this.mYc(2,Nc||Ra);this.mYc(3,Nc||Ra)}YPg(Ra,Lb,Nc){if(Ra=this.KY[Ra]){Je.DOMElementExtensions.setVisible(Ra,Nc);var Ed=this.jJf(Ra);Ed.title="img"===Ra.nodeName?Ra.alt=0<this.To.length&&Nc?Lb:"":Ra.title=0<this.To.length&&Nc?Lb:"";Ed.tabIndex=Nc?0:-1}}jJf(Ra){return Ra.parentNode}mYc(Ra,Lb){if(Ra=this.KY[Ra])Ra=this.jJf(Ra),void 0!==Ra&&null!==Ra&&(!this.To.length||Lb?(Ra.classList.add(Mc.a.tHa),Ra.setAttribute(Xa.a.EVa,"true")):(Ra.classList.remove(Mc.a.tHa),
Ra.setAttribute(Xa.a.EVa,"false")))}O7a(Ra){const Lb=this.$.kX?this.To.length-1:0;let Nc=this.RLf(this.$.kX?0:this.To.length-1);Nc&&(Nc.borderRightWidth=Ra?"1px":"0");this.aP!==this.Ioa&&(Nc=this.RLf(Lb))&&(Nc.borderRightWidth="0")}n3e(Ra,Lb){this.To||(this.To=[]);-1===Lb?this.To.push(Ra):this.To.splice(Lb,0,Ra)}Vsc(Ra,Lb){let Nc=-1,Ed=null;Lb||(Nc=this.VQi(Ra.index),-1!==Nc&&(Ed=this.k_a(Nc)));Ra=new Ef(this.$,this.av,Ed,Ra,this);this.n3e(Ra,Nc);Je.DOMElementExtensions.setVisible(Ra.domElement,!0)}qqa(Ra){const Lb=
Ac.HelperMethods.eN(()=>{switch(Ra){case 0:this.PWc(0);break;case 1:this.PWc(this.aP-1);break;case 2:this.PWc(this.aP+1);break;case 3:this.scrollIntoView(this.To.length-1);break;case 6:this.Hxk()}});this.Jvc&&this.e1&&this.eac();v.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Ra}, duration = ${Lb}`)}Swi(Ra){if(0===Ra.zJ){const Lb=this.$.sa;let Nc=0;for(let Ed=0,Wd=Lb.count;Ed<Wd;Ed++){const $d=Object(bc.a)(tc.a,Lb.getItem(Ed));if($d===Ra)return Nc;0===$d.zJ&&Nc++}}return-1}Fwi(Ra){const Lb=
this.$.sa;for(let Nc=Ra.index+1,Ed=Lb.count;Nc<Ed;Nc++)if(Ra=Object(bc.a)(tc.a,Lb.getItem(Nc)),0===Ra.zJ)return Ra;return null}nwa(Ra){for(let Lb=0;Lb<this.To.length;Lb++){const Nc=this.maa(Lb);if(!Nc)v.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${Lb}] is null even though index is not out of bounds!`);else if(Nc.sheet===Ra)return Lb}return-1}Xjb(Ra){Ra=this.nwa(Ra);return this.maa(Ra)}jBj(Ra,Lb,Nc){const Ed={};Ed.a=this.$.ua.UserSessionId;Ed.b=Nc;
Ed.c=this.tvc;Ed.d=Ra;Ed.e=Lb;Ed.f=this.$.sa.count;Ea.b().Ll(2,Ed,Nc)}fpk(Ra,Lb,Nc){const Ed=Object(bc.a)(mc.a,this.$.sa);Lb?(Lb=Lb.index,Lb=Ra.index<Lb?Lb-1:Lb):Lb=Nc?Ed.count-1:0;Ed.reorderSheet(Ra,Lb,!0)}SDk(Ra){Ba.f(this.$).co.OA(Ra)}pMh(Ra){if(!this.fVc){const Lb=this.domElement.ownerDocument.body;zd.a.instance.xa(Ad.a.wv,document.documentElement,this.e4a);this.uLa&&(Dd.a.instance.xa(Ad.a.Jn,document.documentElement,this.e4a),Dd.a.instance.xa(Ad.a.Jn,this.domElement,this.bZ));zd.a.instance.xa(Ad.a.Co,
document.documentElement,this.f4a);Dd.a.instance.xa(Ad.a.ml,Lb,this.f4a);this.fVc=!0}this.yba=Ra.sheet;this.tvc=!1;this.MX=null;this.Cvc=Ra;this.Ema=Ra.domElement;this.Zoe(Je.DOMElementExtensions.getBoundingClientRect(this.Ema),"BeginSheetTabButtonDrag")}c5(Ra){Ra=void 0===Ra?!0:Ra;if(this.fVc){this.SDk(Xa.a.raa);const Lb=this.domElement.ownerDocument.body;zd.a.instance.Qa(Ad.a.wv,document.documentElement,this.e4a);this.uLa&&(Dd.a.instance.Qa(Ad.a.Jn,document.documentElement,this.e4a),Dd.a.instance.Qa(Ad.a.Jn,
this.domElement,this.bZ));zd.a.instance.Qa(Ad.a.Co,document.documentElement,this.f4a);Dd.a.instance.Qa(Ad.a.ml,Lb,this.f4a);this.Cdd=this.fVc=!1}this.FRc=0;this.tvc=!1;this.yba=null;this.Ema&&(this.Ema.style.visibility="visible",this.Ema=null);this.Cvc=null;this.Zoe(null,"EndSheetTabButtonDrag");this.MX&&(this.MX.parentNode&&this.MX.parentNode.removeChild(this.MX),this.MX=null);this.Prk(Ra)}Prk(Ra){this.hve(Ra);this.HM=this.oYb=-1}nli(Ra,Lb){const Nc=this.$.pa,Ed=Nc?Nc.ta:null;this.$.userOperationManager.enqueueOperation(new X.a(557,
0,(Wd,$d,se)=>{const Fa=Ed.$a(9,null);Fa.sheetName=Ra;Fa.newSheetIndex=Lb;return za.h(Ed,"ReorderSheets",Fa,Wd,$d,se,null,0)},64,()=>new Ld(Ra,Lb)),null)}maa(Ra){return 0<=Ra&&Ra<this.To.length?this.To[Ra]:null}DWi(Ra){return(Ra=this.maa(Ra))?Ra.sheet:null}k_a(Ra){return(Ra=this.maa(Ra))?Ra.domElement:null}RLf(Ra){return(Ra=this.k_a(Ra))?Ra.style:null}VQi(Ra){const Lb=this.$.sa;Ra+=1;let Nc=-1;const Ed=this.To?this.To.length:0;for(;Ra<Lb.count;){const Wd=Object(bc.a)(tc.a,Lb.getItem(Ra));if(0===Wd.zJ){for(Nc=
0;Nc<Ed&&this.DWi(Nc)!==Wd;Nc++);break}Ra++}return-1===Nc||Nc===Ed?-1:Nc}Eqg(Ra){var Lb=this.Xjb(Ra);Lb&&(this.e1&&(v.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.c5()),this.av.removeChild(Lb.domElement),Lb=Array.indexOf(this.To,Lb),this.To.splice(Lb,1),this.bca(),(!this.isRtl&&Lb===this.To.length||
this.isRtl&&!Lb)&&this.O7a(!0),this.Jvc&&this.e1?Ra===this.yba?(this.c5(),this.qqa(6)):this.eac():this.qqa(6))}Fqg(Ra){const Lb=Object(bc.a)(tc.a,Ra);this.e1&&(v.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.c5());if(0===Lb.zJ){this.O7a(!1);var Nc=this.nwa(Ra);-1===Nc&&(v.ULS.sendTraceTag(537153749,
0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.Vsc(Lb,!1),Nc=this.nwa(Ra));this.gQf(Nc,!0)}}gpk(Ra,Lb){const Nc=this.Xjb(Ra);Nc&&(this.e1&&!Lb&&(v.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.c5()),Ra=this.$Wk(Ra,Nc),!E.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&
Ra&&Lb&&Ra.TZj())}$Wk(Ra,Lb){var Nc=Array.indexOf(this.To,Lb);const Ed=this.Swi(Object(bc.a)(tc.a,Ra));if(-1===Ed||-1===Nc)return null;this.O7a(!1);({wxi:this.aP,evj:this.Ioa}=If.cpk(Nc,Ed,this.aP,this.Ioa));Lb&&Lb.domElement.parentNode===this.av&&(this.av.removeChild(Lb.domElement),this.To.splice(Nc,1));Lb=this.Fwi(Ra);Lb=this.nwa(Lb);Nc=new Ef(this.$,this.av,this.k_a(Lb),Object(bc.a)(tc.a,Ra),this);this.n3e(Nc,Lb);Lb=this.nwa(Ra);this.gQf(Lb,!1);return Nc}mmi(){const Ra=this.To?this.To.length:0,
Lb=this.aP,Nc=this.Ioa;for(let Ed=0;Ed<Ra;Ed++){const Wd=this.maa(Ed),$d=Ed>=Lb;Wd&&(Wd.tabIndex=$d&&Ed<=Nc?0:-1)}}a6k(){const Ra=this.To?this.To.length:0;for(let Lb=0;Lb<Ra;Lb++){const Nc=this.maa(Lb);Nc&&Nc.Czb()}}gQf(Ra,Lb){Lb&&Ra<=this.aP&&this.aP++;this.mmi();this.O7a(!0);this.bca();this.Jvc&&this.e1&&this.eac()}YXc(Ra){const Lb=this.$.kX;if(Ra||this.isRtl!==Lb)this.isRtl=Lb,this.domElement.classList.remove(this.isRtl?Ka.a.cPb:Ka.a.dPb),this.domElement.classList.add(this.isRtl?Ka.a.dPb:Ka.a.cPb),
this.domElement.dir=this.isRtl?"rtl":"ltr",this.a6k();Ra||this.O7a(!0);for(Ra=0;Ra<this.KY.length;Ra++)0!==Ra&&3!==Ra&&4!==Ra&&5!==Ra&&this.ZPg(Ra)}K7h(){const Ra=this.gre=document.createElement("div");Ra.className="ewa-stb-navarea";Ra.classList.add("ewa-stb-navarea-dimensions");this.domElement.appendChild(Ra);this.zlf(Ra,1,717,716);this.zlf(Ra,2,719,718);this.S2f&&(this.T7a=new Zd(this.$,this,Ra))}L7h(){const Ra=this.hre=document.createElement("div");Ra.className="ewa-stb-navareaextra";this.domElement.appendChild(Ra);
this.kzd()}T8h(){const Ra=document.getElementById(Xa.a.$Ik),Lb=document.getElementById(Xa.a.aJk);Ra&&!Lb&&v.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Ra.parentNode.id}. progressBar div has child: ${!!Ra.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(Xa.a.QYc)}`);const Nc=Db.a.FZd(this.$);if(Nc&&Ra&&Lb)this.domElement.appendChild(Ra),this.DPa=Ra.firstChild,this.EPa=document.getElementById(Xa.a.QYc),
Lb.style.visibility="visible";else{const Ed=document.createElement("div"),Wd=document.createElement("div");Ed.className=Ka.a.Jpi;Wd.className=Ka.a.Hpi;Wd.id=Xa.a.Wqe;Wd.style.display="none";const $d=document.createElement("div");$d.className=Ka.a.Lpi;const se=document.createElement("div");se.className=Ka.a.Ipi;const Fa=document.createElement("div");Fa.className=Ka.a.Gpi;Wd.appendChild($d);Wd.appendChild(se);Wd.appendChild(Fa);Ed.appendChild(Wd);this.domElement.appendChild(Ed);this.DPa=Wd;this.EPa=
se;v.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Nc,Ra,Lb)}}ZPg(Ra){var Lb=this.KY[Ra];if(Lb){const Nc=Lb.parentNode;this.xEg(Lb);Lb=wd.a(this.$)?this.Lwg[Ra]:this.J6d[Ra];this.KY[Ra]=this.svgIconProvider.Mna(Lb,12,12,Nc,24,24)}}xEg(Ra){(null===Ra||void 0===Ra?0:Ra.parentNode)&&Ra.parentNode.removeChild(Ra)}i5h(){const Ra=
this.exb=document.createElement("div");Ra.className="ewa-stb-contentarea";this.domElement.appendChild(Ra);this.V9h(Ra)}V9h(Ra){const Lb=document.createElement("div");Lb.className="ewa-stb-tabarea";Lb.classList.add("ewa-stb-disable-scrollbar");this.$.printingEnabled||Lb.classList.add(gc.Vb);Ra.appendChild(Lb);this.av=document.createElement("ul");Je.DOMElementExtensions.oL(this.av,Xa.a.ord,null,null);this.av.className=gc.mb;Lb.appendChild(this.av);this.C7h();this.cYe=document.createElement("div");this.RYc.id=
"SheetIconTooltipContainer";Lb.appendChild(this.RYc)}C7h(){const Ra=document.createElement("div"),Lb=document.createElement("div"),Nc=Oa.a.gFf(Ka.a.Cqi);Lb.className=Ka.a.gYh;Lb.appendChild(Nc);Ra.appendChild(Lb);Ra.className="ewa-stb-sheettabmoveindicator";Je.DOMElementExtensions.setVisible(Ra,!1);this.av.appendChild(Ra)}Czd(){const Ra=this.$.sa;for(let Lb=0,Nc=Ra.count;Lb<Nc;Lb++){const Ed=Object(bc.a)(tc.a,Ra.getItem(Lb));0===Ed.zJ&&(this.Vsc(Ed,!0),Ed.active&&Ed.activate({scenario:"createSheetTabs"}))}}Tvd(){Ob.a.gj(this.To);
this.To=[];this.Ioa=this.aP=0}zlf(Ra,Lb,Nc,Ed){const Wd=document.createElement("a");Ra.appendChild(Wd);Ra=this.J6d[Lb];this.KY[Lb]=this.jh(Wd,Ia.a.instance.ia(Ed),0,this.lJj[Lb],Ia.a.instance.ia(Nc),Ra);if(5===Lb||4===Lb)Je.DOMElementExtensions.fP(this.KY[Lb],Wd,!1,"span").style.marginTop="10px";this.ZPg(Lb);Nc=this.I6d[Lb]=this.pl.$k(Wd);zd.a.instance.xa(Ad.a.qj,Wd,se=>se.ctrlKey&&this.ZPj(Lb)?!0:this.Fng(Lb));zd.a.instance.xa(Ad.a.Co,Wd,()=>this.Gng());Dd.a.instance.xa(Ad.a.ml,Wd,()=>this.Gng());
zd.a.instance.xa(Ad.a.GB,Wd,()=>this.Mvd());oc.a.instance.xa(Ad.a.Ui,Wd,se=>13!==se.La.keyCode&&32!==se.La.keyCode||this.Kxd?!1:(this.Kxd=!0,this.Fng(Lb)));oc.a.instance.xa(Ad.a.rk,Wd,se=>13===se.La.keyCode||32===se.La.keyCode?(this.Kxd=!1,this.Mvd()):!1);const $d=this.m6e();Ed=se=>{"mouseup"===se.type&&this.e1||Ue.g(se);!Wd.classList.contains(Mc.a.tHa)&&$d&&this.BWj(se,Lb)};Nc.Ba("mouseover",Ed);Nc.Ba("mouseout",Ed);Nc.Ba("focus",Ed);Nc.Ba("blur",Ed);$d&&Nc.Ba("mouseup",Ed)}dkj(Ra){let Lb=!1;const Nc=
this.$.Cl;Nc&&(Lb=$c.a.uY(Je.DOMElementExtensions.getBoundingClientRect(Nc),Ra.clientPoint));return Lb}eac(){if(!this.MX){v.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.MX=this.Ema.cloneNode(!0);if(!this.FKg(this.MX,this.Ema,!0,"UpdateDragAndDropState"))return;this.Ema.style.visibility="hidden";this.MX.classList.add("ewa-stb-tabs-ghost");this.MX.style.borderRightWidth="";this.ACc=this.rfa.clientPoint.x-this.Efa.width/2;
this.MX.style.left=this.ACc+"px";this.HM=this.nwa(this.yba);0>this.HM&&v.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Jvc&&(this.HM=this.nwa(this.yba));var Ra=Je.DOMElementExtensions.getBoundingClientRect(this.av);const Lb=Ra.x;Ra=Ra.x+Ra.width;let Nc=this.rfa.clientPoint.x-this.Efa.width/2;Nc=Math.min(Nc,Ra-this.Efa.width);Nc=Math.max(Nc,Lb);this.MX.style.transform="translateX("+Math.abs(Nc-this.ACc)*(this.ACc<Nc?1:-1)+"px)";const Ed=this.rfa.clientPoint.x>
this.oYb;let Wd=this.rfa.clientPoint.x;Nc>=Ra-this.Efa.width?(Wd=Ra-this.Efa.width/2,this.fne()||this.sAa||(v.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.KQc=this.av.scrollLeft,this.sAa=window.requestAnimationFrame(this.nMg))):Nc<=Lb?(Wd=Lb+this.Efa.width/2,this.ene()||this.sAa||(v.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.KQc=this.av.scrollLeft,this.sAa=window.requestAnimationFrame(this.mMg))):this.sAa&&(v.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.hve());this.rfa.clientPoint.x!==this.oYb&&(this.Vve(Ed,Wd),this.oYb=this.rfa.clientPoint.x);this.Cdd=!0}Vve(Ra,Lb){let Nc;for(;(()=>{let Ed=this.lii(Lb,Ra);({Ppc:Nc}=Ed);return Ed})().returnValue;)this.L9b=Nc,this.kHh(Ra)}kHh(Ra){if(this.L9b){var Lb=(Ra?1:-1)*this.Efa.width;
if(Ra&&!this.$.kX||!Ra&&this.$.kX){var Nc=this.Ema;var Ed=this.HM+1;var Wd=!0}else Nc=(Ed=this.maa(this.HM+1))?Ed.domElement:null,Ed=this.HM-1,Wd=!1;if(this.FKg(this.L9b,Nc,Wd,"AnimateSheetSwap")){v.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.HM} and other sheet-index ${Ed}. amount of sheets in the bar: ${this.N7b} isMovingRight: ${Ra}`);0<=this.HM&&this.HM<this.To.length&&0<=Ed&&Ed<this.To.length?(Ra=this.To[Ed],this.To[Ed]=this.To[this.HM],
this.To[this.HM]=Ra):(v.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.To.length}, ghostIndex: ${this.HM}, swappedSheetIndex: ${Ed}`),this.c5());this.HM=Ed;var $d=this.L9b;$d.style.transform="translateX("+Lb+"px)";window.requestAnimationFrame(()=>{$d.style.transform="translateX(0px)"})}}}FKg(Ra,Lb,Nc,Ed){const Wd=$d=>$d?`Node ID: ${$d.id} , Node class: ${$d.className}, Node name: ${$d.nodeName},`:null;try{return this.av.insertBefore(Ra,
Lb),!0}catch($d){return Ra=this.Xjb(this.yba),v.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Ra?Ra!==this.Cvc?"Changed":"NoChange":"Removed",Ed,Wd(Lb),Wd(Lb.parentNode),Wd(this.av),Nc,
this.HM,this.N7b,$d),this.c5(),!1}}lii(Ra,Lb){var Nc=this.$.kX===Lb?this.maa(this.HM-1):this.maa(this.HM+1);if(!Nc)return{returnValue:!1,Ppc:null};Nc=Nc.domElement;const Ed=Je.DOMElementExtensions.getBoundingClientRect(Nc);return this.Efa?Lb?{returnValue:Ra+this.Efa.width/2>=Ed.x+.5*Ed.width,Ppc:Nc}:{returnValue:Ra-this.Efa.width/2<=Ed.x+.5*Ed.width,Ppc:Nc}:(v.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.c5(),{returnValue:!1,Ppc:Nc})}kMg(Ra,Lb){let Nc;Nc=Lb?this.nMg:this.mMg;if(-1===this.K_c)this.K_c=Ra,this.sAa=window.requestAnimationFrame(Nc);else{Ra=Math.floor((Ra-this.K_c)/1E3*300);var Ed=this.M5b>this.MYb?1:-1;this.scrollLeft(Math.abs(this.av.scrollLeft-(Lb?this.KQc+Ra*Ed:this.KQc-Ra*Ed))*(Lb?-1:1));if(Ra=this.mHf("ScrollStep"))this.Vve(Lb,Ra.x+Ra.width/2),Lb&&!this.fne()||!Lb&&!this.ene()?this.sAa=window.requestAnimationFrame(Nc):(v.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.hve())}}fne(){const Ra=this.M5b>this.MYb;return Ra&&this.aBa>=this.M5b||!Ra&&this.aBa<=this.M5b}ene(){const Ra=this.M5b>this.MYb;return Ra&&this.aBa<=this.MYb||!Ra&&this.aBa>=this.MYb}hve(Ra){Ra=void 0===Ra?!0:Ra;this.av&&(this.aBa=this.av.scrollLeft);window.cancelAnimationFrame(this.sAa);this.sAa=0;this.K_c=-1;Ra&&this.bca()}Zoe(Ra,Lb){Ra||v.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${Lb}`);this.Efa=Ra}ZPj(Ra){return 2===
Ra?(this.qqa(3),!0):1===Ra?(this.qqa(0),!0):!1}Fng(Ra){v.ULS.shipAssertTag(537153732,0,-1===this.h5a&&-1===this.g5a,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.h5a&&(window.clearTimeout(this.h5a),this.h5a=-1);-1!==this.g5a&&(window.clearInterval(this.g5a),this.g5a=-1);this.qqa(Ra);this.h5a=window.setTimeout(()=>{this.wUk(Ra)},this.aJj);return!0}wUk(Ra){this.g5a=window.setInterval(()=>{this.qqa(Ra)},
this.$Ij)}Gng(){this.Mvd();return!this.e1}Mvd(){window.clearTimeout(this.h5a);window.clearInterval(this.g5a);this.g5a=this.h5a=-1;return!0}BWj(Ra,Lb){const Nc=this.lWb(Lb),Ed=5===Lb;"mouseup"!==Ra.type||!Ed&&4!==Lb||(Nc||this.reorderSheets(null,Ed,!1),this.c5())}lWb(Ra){return!!Je.DOMElementExtensions.IGf(this.KY[Ra],"a").title}O3c(Ra){this.EAe(Ra);this.bca()}EAe(Ra){(Ra=this.Xjb(Ra))&&Ra.Czb()}Hxk(){var Ra=this.$.sa;if(Ra.ma&&(!Qf.e(this.$)||Ra.count))if(Ra=this.nwa(Ra.ma),-1===Ra)v.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var Lb=this.k_a(Ra);Ra<this.aP?this.PWc(Ra):Ra>this.aP&&!this.PZd(Lb)&&this.scrollIntoView(Ra)}}u7k(){this.aP=0;this.Ioa=this.To.length-1;let Ra=!1;for(let Lb=0;Lb<this.To.length;Lb++){const Nc=this.maa(Lb);if(!Nc)break;const Ed=this.PZd(Nc.domElement);Nc.tabIndex=Ed?0:-1;if(!Ra&&Ed)this.aP=Lb,Ra=!0;else if(Ra&&!Ed){this.Ioa=Lb-1;break}}}PWc(Ra){this.$.sa.count&&(this.To.length||this.Czd(),this.bOg(this.k_a(Math.max(0,
Math.min(Ra,this.To.length-1)))),this.bca())}scrollIntoView(Ra){v.ULS.shipAssertTag(537153697,0,Ra>=this.aP,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.sa.count){this.To.length||this.Czd();var Lb=this.k_a(Math.max(0,Math.min(Ra,this.To.length-1))),Nc=this.k_a(this.aP);if(!this.PZd(Lb)){Lb=Je.DOMElementExtensions.getBoundingClientRect(Lb);var Ed=Je.DOMElementExtensions.getBoundingClientRect(this.exb);Lb=this.isRtl?Ed.x-Lb.x:
Lb.x+Lb.width-(Ed.x+Ed.width);for(Ed=0;Nc&&Ed<Lb;){const Wd=Je.DOMElementExtensions.getBoundingClientRect(Nc);Ed+=Wd.width;Nc=Nc.nextSibling}Nc?this.bOg(Nc):v.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.aP}, lastVisibleSheetTabIndex = ${this.Ioa}, scroll to index: ${Ra}`)}this.bca()}}bOg(Ra){const Lb=Je.DOMElementExtensions.getBoundingClientRect(this.av);Ra=Je.DOMElementExtensions.getBoundingClientRect(Ra);this.isRtl?
this.scrollLeft(Math.floor(Lb.x+Lb.width-(Ra.x+Ra.width+.5))):this.scrollLeft(Math.ceil(Lb.x-Ra.x-.5))}scrollLeft(Ra){(0>Ra&&this.fne()||0<Ra&&this.ene())&&v.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const Lb=this.av.scrollLeft;if(this.isRtl){if(w.a.aJ||w.a.Am){this.av.scrollLeft=this.aBa=Lb-Ra;return}if(w.a.sP){this.av.scrollLeft=this.aBa=Lb+Ra;return}v.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.av.scrollLeft=
this.aBa=Lb-Ra}PZd(Ra){Ra=Je.DOMElementExtensions.getBoundingClientRect(Ra);const Lb=Je.DOMElementExtensions.getBoundingClientRect(this.exb);return Ra&&Lb?Ra.x>=Lb.x-1&&Ra.x+Ra.width<=Lb.x+Lb.width+1:(v.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}h8h(){const Ra=this.hre;Kd.OSg(this.$)?(Ob.a.dh(this.U0),this.U0=new Kd(Ra,this.$,this,!0),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",
!1)&&(this.dFc=!1)):(Ob.a.dh(this.U0),Id.l(this.$.Xk)?this.U0=new Nf(Ra,this.$,this):this.U0=new Kd(Ra,this.$,this),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(this.dFc=!0))}Ilf(Ra,Lb){var Nc=this.$.sa;if(!this.$.isEditMode||!Nc.count)Ob.a.dh(Lb),Lb=null;else if(!Lb)if(Nc=this.gre,Id.l(this.$.Xk))Lb=new Nf(Nc,this.$,this);else switch(Ra){case 0:Lb=new Kd(Nc,this.$,this);break;case 1:Lb=new fe(Nc,this.$,this);break;default:v.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Lb}mHg(){this.nHg||(this.ybh()?Kf.a.instance.aub(Xa.a.m2,["sheetTabBar"]):(this.LBa.MWg||Kf.a.instance.Y1(Xa.a.m2,["sheetTabBar"]),this.LBa.fXh(),Kf.a.instance.sZ(Xa.a.m2,["sheetTabBar"])),Kf.a.instance.jca(Xa.a.m2,["sheetTabBar"]),this.nHg=!0)}kzd(){this.rmj?(this.U0=this.Ilf(0,this.U0),this.GUb=this.Ilf(1,
this.GUb)):this.h8h()}mHf(Ra){const Lb=Je.DOMElementExtensions.getBoundingClientRect(this.MX);Lb||(v.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Ra}: GetBoundingClientRect returned null for the dragged sheet.`),this.c5());return Lb}YPf(Ra,Lb){v.ULS.sendTraceTag(507646810,0,50,`SheetTabBarControl.handleRequestToChangeDisabledState: requestId=${Ra}, requestedState=${Lb}`);this.THa.yIh(Ra,Lb);this.c5(!1);this.Ape(this.navigationButtonsDisabled);if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const Nc of this.c_g)Nc&&
Nc.z1c(this.navigationButtonsDisabled);for(const Nc of this.noc)Nc&&Nc.z1c(this.operationButtonsDisabled)}else{for(const Nc of this.c_g)Nc&&Nc.x2(this.navigationButtonsDisabled);for(const Nc of this.noc)Nc&&Nc.x2(this.operationButtonsDisabled)}}x_h(Ra,Lb){if(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetTabCompareButtonsState",!1)){var Nc=!this.Sfe,Ed=!this.Tfe;Nc===Lb.Wwg&&Ed===Lb.Teg||Ra.push(`Sheet scroll buttons enabled mismatch. prevNavButtonEnabled: ${Nc} nextNavButtonEnabled: ${Ed}, cached prevNavButtonEnabled: ${Lb.Wwg} cached nextNavButtonEnabled: ${Lb.Teg}`);
this.dFc!==Lb.cFc&&Ra.push(`New sheet button mismatch. insertSheetButtonEnabled: ${this.dFc}, skeletonNewSheetEnabled: ${Lb.cFc}`)}}static cpk(Ra,Lb,Nc,Ed){Ra<Nc?(Lb>Nc&&Nc--,Lb>Ed&&Ed--):Ra>Ed?(Lb<Nc&&Nc++,Lb<Ed&&Ed++):Lb<Nc&&Nc++;return{wxi:Nc,evj:Ed}}}Object(u.a)(If,"SheetTabBarControl",Cb.a,[315,2,52]);var ac=a(91);Object(U.b)(K.Yf,{Ek:"singleton"})(Ra=>Lo(function*(){const Lb=yield U.a.resolve(K.Nb,Ra);var Nc=Lb.xi;if(hc.a(Lb.ua,1))return Kf.a.instance.C6a(Xa.a.m2,["sheetTabBar"]),null;Nc=document.getElementById(Nc+
Xa.a.Otc);if(!Nc)return Kf.a.instance.C6a(Xa.a.m2,["sheetTabBar"]),null;Kf.a.instance.ACa(Xa.a.m2);const Ed=Object(ac.e)(Ec.GetServiceTaskFactory.Tj(Lb.la,388,387,null===Ra||void 0===Ra?void 0:Ra.va)),Wd=U.a.resolve(K.cg),[$d,se]=yield Promise.all([Ed,Wd]);return new If(Lb,Nc,se,$d)}));class Yb extends uc.a{constructor(Ra){super();this.$=Ra;this.gm()}create(){var Ra=this.$.xi;if(hc.a(this.$.ua,1))Kf.a.instance.C6a(Xa.a.m2,["sheetTabBar"]);else{var Lb=document.getElementById(Ra+Xa.a.Otc);if(Lb){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8494154_FixSheetTabBarInitTime")&&
(Ra=this.$.la.lh(32))){this.Bk(Ra);return}Kf.a.instance.ACa(Xa.a.m2);var Nc=Ec.GetServiceTaskFactory.Tj(this.$.la,388,387,this.xh),Ed=Object(ac.d)(U.a.resolve(K.cg));B.TaskExtensions.Xa(B.TaskExtensions.Wo([Nc,Ed],this.$.ya),()=>{this.Bk(this.$.la.lh(32)||new If(this.$,Lb,Ed.result,Nc.result))},this.$.ya,3)}else Kf.a.instance.C6a(Xa.a.m2,["sheetTabBar"])}}static Ba(Ra){Ra.la.Hh(33,new Yb(Ra))}}Object(u.a)(Yb,"SheetTabBarFactory",uc.a,[]);var Cc=a(1121),Of=a(1561),Qb;(function(Ra){Ra[Ra.unknown=0]=
"unknown";Ra[Ra.supported=1]="supported";Ra[Ra.kvl=2]="userUnsupportedAnonymous";Ra[Ra.lvl=3]="userUnsupportedNoLoginHint";Ra[Ra.mml=4]="hostUnsupported";Ra[Ra.stl=5]="perfAutomation"})(Qb||(Qb={}));Object(u.b)("SupportStatus",Qb);var Ic;(function(Ra){Ra[Ra.external=0]="external";Ra[Ra.rnl=1]="msa";Ra[Ra.ikl=2]="aad"})(Ic||(Ic={}));Object(u.b)("AuthorityType",Ic);var hd=a(967);class Ga{constructor(Ra){this.yph=Ra}initialize(){return Promise.resolve(0)}nLc(){return Promise.resolve(0)}hE(){v.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new hd.a,{IsSuccess:!0,Token:this.yph}))}c2c(){return Promise.resolve(Object.assign(new hd.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}PDc(){}x0c(){return!1}sSb(){return"MockAuthTokenStrategy"}}Object(u.a)(Ga,"MockAuthTokenStrategy",null,[781]);var Ub=a(1173);class yc{static get(Ra,Lb,Nc){if(!Nc)return Ra;
let Ed=0;return Promise.race([Ra,new Promise(Wd=>{Ed=window.setTimeout(()=>{Wd(Lb)},Nc)})]).then(Wd=>{window.clearTimeout(Ed);return Promise.resolve(Wd)}).catch(()=>{window.clearTimeout(Ed);return Promise.resolve(Lb)})}}Object(u.a)(yc,"PromiseWithTimeout",null,[]);var kd=a(602);class Nd{constructor(Ra,Lb,Nc,Ed,Wd){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=Ra;this.scope=Lb;this.silentLogin=Nc;this.options=Ed;this.correlationId=Wd}}Object(u.a)(Nd,
"TokenRequestParameters",null,[798]);class wa{constructor(){this.n0e=null;let Ra=bb.AFrameworkApplication.fa.Za(bb.AFrameworkApplication.UZ),Lb=bb.AFrameworkApplication.fa.Za(bb.AFrameworkApplication.D3g);this.idb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Ra&&""!==Ra?Ra:"Unspecified",Lb&&""!==Lb?Lb:"Unspecified")}initialize(){return new Promise(Ra=>{Da.a.instance.fj("Common.App.WopiIdentity.IWopiIdentity").execute(Lb=>{this.n0e=Lb;Ra(0)})})}cr(Ra){const Lb=["HTTPS:",
"API:"];let Nc=!1;const Ed=Ra.toLocaleUpperCase();for(const Wd of Lb)if(Ed.startsWith(Wd)){Nc=!0;break}return Nc||this.Jlj(Ra)?Ra+"/.default":Ra}Jlj(Ra){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Ra)}nLc(){return Promise.resolve(0)}hE(Ra,Lb,Nc,Ed,Wd,$d,se){if(w.a.BLa){Wd=kd.a.Cdl;if(!Wd)return Lb=Object.assign(new hd.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Lb);if(!Array.contains(Wd,
Ra))return Lb=Object.assign(new hd.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Ra}),Promise.resolve(Lb)}Ra=this.cr(Nc);Nc=new Nd(Nc,Ra,!Ed,null,bb.AFrameworkApplication.userSessionId);return this.n0e.getAccessToken(Nc,Lb,se).then(Fa=>Object.assign(new hd.a,{IsSuccess:!0,Token:Fa.accessToken}),Fa=>Object.assign(new hd.a,{IsSuccess:!1,ErrorCode:Fa}))}c2c(){return Promise.resolve(Object.assign(new hd.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}PDc(){}x0c(){return!1}sSb(){return this.idb}}Object(u.a)(wa,"ParentFrameTokenStrategy",null,[781]);var wb=a(1174);class zc{constructor(){this.reject=this.resolve=null;this.startTime=0;this.pyg=this.poc=null}}Object(u.a)(zc,"PromiseWrapper",null,[]);class Hc{constructor(Ra){Ra=void 0===Ra?0:Ra;this.IL=0;this.UEb=!1;this.hw=new aa.a;this._timeout=Ra}enqueue(Ra){return new Promise((Lb,Nc)=>{this.hw.add(Object.assign(new zc,
{pyg:Ra,resolve:Lb,reject:Nc}));this.process()})}process(){if(this.UEb||this.IL===this.hw.count)return!1;const Ra=this.hw.na(this.IL++);try{this.UEb=!0,Ra.pyg().then(Lb=>{this.UEb=!1;this.ixd(Ra,Lb,null,!0)}).catch(Lb=>{this.UEb=!1;this.ixd(Ra,null,Lb,!1)})}catch(Lb){this.UEb=!1,this.ixd(Ra,null,Lb,!1)}return!0}ixd(Ra,Lb,Nc,Ed){if(Ed){const Wd=()=>{Ra.resolve(Lb);this.process()};0<this._timeout?window.setTimeout(()=>{Wd()},this._timeout):Wd()}else{const Wd=()=>{Ra.reject(Nc);this.process()};0<this._timeout?
window.setTimeout(()=>{Wd()},this._timeout):Wd()}}}Object(u.a)(Hc,"PromiseQueue",null,[]);class ed{constructor(){this.correlationId=this.resolve=null}}Object(u.a)(ed,"ResolveWithCorrelation",null,[]);var rd=a(980),ve=a(144),Le=a(22);class Qe extends va.a{constructor(Ra,Lb,Nc,Ed,Wd,$d,se){se=void 0===se?!1:se;super(!1,!1,!0);this.vKe=this.sda=null;this.PZj=()=>{this.ABf()};this.p6h=()=>this.oD;this.QIk=Fa=>{0===Fa&&(this.Suh.reject(Object.assign(new hd.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),
this.ZSa(null))};this.B3=Ra;this.brh=Nc;this.tF=Ed;this.Suh=Wd;this.ZSa=$d;this.oD=document.createElement("iframe");this.oD.id="SharedAuthInteractiveFrame";this.oD.setAttribute("name","SharedAuthInteractiveFrame");this.oD.setAttribute("title","SharedAuthInteractiveFrame");this.oD.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.oD.style.border="0";this.oD.style.height="48px";this.oD.style.width="190px";$addHandler(this.oD,"error",this.PZj);Ra=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",
this.B3,Lb,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",se?"&msalv3=1":"","&WacUserType=",bb.AFrameworkApplication.userType);this.oD.src=Ra;this.skh=new Promise(Fa=>{this.vKe=Fa});this.wKe=!1}Lse(){this.sda={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.brh,["errorText"]:Object(Le.a)("InternalError"),["rtl"]:bb.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.p6h,["resolveDialogStyles"]:this.vKe}};this.Ph=5;this.initializeAndShow(Object(Le.a)("SignIn"),
this.QIk,this.sda)}X9a(Ra,Lb,Nc){Ra=void 0===Ra?!1:Ra;Lb=void 0===Lb?!1:Lb;Nc=void 0===Nc?5:Nc;this.sda&&this.sda.bodyControls&&(Ra!==Object(bc.a)(Object,this.sda.bodyControls).frameLoaded&&(Object(bc.a)(Object,this.sda.bodyControls).frameLoaded=Ra),Lb!==Object(bc.a)(Object,this.sda.bodyControls).frameLoadSuccess&&(Object(bc.a)(Object,this.sda.bodyControls).frameLoadSuccess=Lb),Nc!==this.sda.dialogButtonsOption&&(this.sda.dialogButtonsOption=null,this.Ph=Nc),this.update(this.sda))}HQk(Ra,Lb){const Nc=
new rd.a(ve.a.UIk);Ra={["signInLabel"]:Object(Le.a)("SignIn"),["cancelLabel"]:Object(Le.a)("DialogCancel"),["rtl"]:bb.AFrameworkApplication.isRtl,["messageCorrelationId"]:Ra,["dialogStyles"]:Lb};Nc.Values=Ra;this.tF.hBa(Nc,this.oD.contentWindow,this.B3)}ABf(){this.X9a(!0,!1,6)}get RRg(){return this.oD}get afi(){return this.skh.then(Ra=>{this.wKe=!0;return Ra})}get bfi(){return this.wKe}}Object(u.a)(Qe,"SharedAuthConsentDialog",va.a,[799]);var Vb=a(1169),cd=a(107),Ud=a(202),re=a(189);class qe{}qe.Cw=
"OAuthManager";Object(u.a)(qe,"OAuthManagerConstants",null,[]);class Se{constructor(){this.oD=null;this.yfc=0;this.n3=this.zdb=this.F7c=this.ZSa=this.fX=this.d_e=null;this.QUj=()=>{const Ra=$c.a.Ej()-this.yfc;v.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Ra)};this.XOc=Ra=>{const Lb=$c.a.Ej()-this.yfc,Nc=Object.assign({},{durationMs:Lb});cd.Health.instance.recordKpiFailure(qe.Cw,"SharedAuthWACOAuthAspxFrameError",!1,!0,Nc);v.ULS.sendTraceTag(572346567,3E3,
10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Lb,this.mLe?JSON.stringify(Ra):"")};this.jZj=Ra=>{const Lb=this.Vda.loadFrame;var Nc=$c.a.Ej()-Lb.startTime,Ed=Ra.Values.AuthLibrary.toString();Ra=Ra.Values.Success.toString();v.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Ra,Ed,Nc);Ed&&(this.idb="SharedAuthTokenStrategy "+Ed);Ed=Boolean.parse(Ra);Ed||(Ra=Ud.a.sy(),void 0!==Ra&&null!==Ra&&(Ra.set("AuthLibrary",this.sSb()),
Nc=Object.assign({},{durationMs:Nc,extendedProperties:Ra}),cd.Health.instance.recordKpiFailure(qe.Cw,"SharedAuthStrategyInitFailed",!1,!0,Nc)));Lb.resolve(Ed?0:1)};this.iZj=Ra=>{if(Ra.Values.interactive&&this.zdb&&this.zdb.Values.messageCorrelationId){const Nc=this.zdb.Values.messageCorrelationId.toString();if(Ra.Values.interactive&&this.fX){this.fX.afi.then(Ed=>{this.tF.hBa(this.zdb,this.fX.RRg.contentWindow,this.B3);this.fX.HQk(Nc,Ed);this.fX.X9a(!0,!0);this.zdb=null});return}}Ra=this.Vda.initFrame;
const Lb=$c.a.Ej()-Ra.startTime;v.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Lb);Ra.resolve(0)};this.rUj=Ra=>{if(Ra.Values.messageCorrelationId&&Ra.Values.messageCorrelationId.toString()){var Lb=Ra.Values.messageCorrelationId.toString(),Nc=this.Vda[Lb];if(Nc){var Ed=$c.a.Ej()-Nc.startTime;v.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Ed);Ra.Values.isSuccess&&Ra.Values.isSuccess?Nc.resolve(Ra.Values.response):
Nc.reject(Ra.Values.response);this.h3g(Lb)}else v.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else v.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.mVj=()=>{if(this.fX.bfi)this.fX.ABf();else if(this.F7c&&this.fX){const Ra=new rd.a(ve.a.URg);Ra.Values=this.$9e(this.F7c,!0);this.tF.hBa(Ra,this.fX.RRg.contentWindow,this.B3)}};this.KUj=()=>
{this.fX&&this.fX.vmb()};this.XOj=Ra=>{if(Ra.Values.cancelled&&Ra.Values.cancelled&&Ra.Values.messageCorrelationId){Ra=Ra.Values.messageCorrelationId.toString();const Lb=this.Vda[Ra];if(Lb){const Nc=new hd.a;Nc.ErrorCode="UserCancelled";Nc.ErrorMessage="The interactive flow was cancelled by the user";Lb.reject(Nc)}this.h3g(Ra)}this.fX&&this.fX.hide()};this.bWj=Ra=>{if(Ra.Values.messageCorrelationId&&Ra.Values.messageCorrelationId.toString()){var Lb=this.Vda[Ra.Values.messageCorrelationId.toString()];
if(Lb){var Nc=$c.a.Ej()-Lb.startTime;v.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",Nc);Ra.Values.isSuccess&&Ra.Values.isSuccess?Lb.resolve(Ra.Values.response):Lb.reject(Ra.Values.response)}else v.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else v.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.tF=
new Vb.a(null,null);this.idb="SharedAuthTokenStrategy Unloaded";this.B3=kd.a.SIk;this.YXe=kd.a.RIk;kd.a.Cqe&&""!==kd.a.Cqe&&(this.ZXe=this.B3+kd.a.Cqe);this.mLe=kd.a.enableConsoleLogging;this.Pkh=bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.mth=bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.A_e=bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedMsalV3Enabled",
!1);this.Vda={};this.mnh=new Hc(1500)}sSb(){return this.idb}initialize(){if("loadFrame"in this.Vda)return this.Vda.loadFrame.poc;if(!this.B3)return cd.Health.instance.recordKpiFailure(qe.Cw,"SharedAuthFrameOriginNotSet",!1,!1,null),v.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const Ra=this.c0c("loadFrame");this.yfc=$c.a.Ej();var Lb=this.B3+this.YXe+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+
bb.AFrameworkApplication.userSessionId+"&WacUserType="+bb.AFrameworkApplication.userType;this.A_e&&(Lb+="&msalv3=1");this.oD=document.createElement("iframe");this.Oxa(this.oD);this.oD.style.cssText="height:0;width:0;display:none;";this.oD.id="SharedAuthFrame";this.oD.setAttribute("name","SharedAuthFrame");this.oD.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.oD.src=Lb;document.body.appendChild(this.oD);Lb=$c.a.Ej()-this.yfc;v.ULS.sendTraceTag(573112899,3E3,
50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}.",Lb,this.oD.src);return Ra}nLc(Ra){this.F7c=Ra;const Lb=new rd.a(ve.a.URg);Lb.Values=this.$9e(Ra);Ra=this.c0c("initFrame");this.tF.hBa(Lb,this.oD.contentWindow,this.B3);v.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Ra}hE(Ra,Lb,Nc,Ed,Wd,$d){const se=new rd.a(ve.a.VIk),Fa=this.XKf();se.Values=this.Y2g(Ra,Lb,Nc,Ed,Wd,$d,Fa);Ra=this.c0c(Fa);Ed?($d&&
0!=$d.length||($d=Object(Le.a)("WAC_OAuth_CompleteSignIn_Body")),this.mnh.enqueue(()=>new Promise(lb=>{this.$2k($d,se,lb,Fa)}))):(this.tF.hBa(se,this.oD.contentWindow,this.B3),v.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Lb));return Ra}$2k(Ra,Lb,Nc,Ed){const Wd=this.Vda[Ed];Wd&&(this.zdb=Lb,this.ZSa=Object.assign(new ed,{resolve:Nc,correlationId:Ed}),this.fX=new Qe(this.B3,this.YXe,Ra,this.tF,Wd,Nc,this.A_e),this.fX.Lse())}XKf(){return re.a.create().toString()}Y2g(Ra,
Lb,Nc,Ed,Wd,$d,se){const Fa={};Fa.appName=Ra;Fa.appId=Lb;Fa.target=Nc;Fa.withPopup=Ed;Fa.claims=Wd;Fa.promptMessage=$d;Fa.messageCorrelationId=se;return Fa}Oxa(Ra){$addHandler(Ra,"load",this.QUj);$addHandler(Ra,"error",this.XOc);this.tF.x_(this.B3);this.tF.$r(ve.a.XRg);this.tF.wq(ve.a.XRg,this.jZj);this.tF.$r(ve.a.WRg);this.tF.wq(ve.a.WRg,this.iZj);this.tF.$r(ve.a.SRg);this.tF.wq(ve.a.SRg,this.rUj);this.tF.$r(ve.a.YRg);this.tF.wq(ve.a.YRg,this.bWj);this.tF.$r(ve.a.VRg);this.tF.wq(ve.a.VRg,this.mVj);
this.tF.$r(ve.a.TRg);this.tF.wq(ve.a.TRg,this.KUj);this.tF.$r(ve.a.QRg);this.tF.wq(ve.a.QRg,this.XOj)}c0c(Ra){const Lb=new zc;Lb.startTime=$c.a.Ej();const Nc=new Promise((Ed,Wd)=>{Lb.resolve=Ed;Lb.reject=Wd});Lb.poc=Nc;this.Vda[Ra]=Lb;return Nc}$9e(Ra,Lb){Lb=void 0===Lb?!1:Lb;const Nc={};Nc.appIds=this.zEi();Nc.upn=Ra.loginHint;Nc.authority=Ra.authority;Nc.authorityType=Object(Of.a)(Ic,Ra.authorityType);Nc.tenantId=Ra.tenantId;Nc.correlationId=bb.AFrameworkApplication.userSessionId;Nc.enableConsoleLogging=
this.mLe;Nc.enablePopupFlash=this.Pkh;Nc.skipUpnCheck=this.mth;Nc.interactive=Lb;this.ZXe&&(Nc.redirectUri=this.ZXe);return Nc}zEi(){const Ra=[],Lb=kd.a.Aqd;for(const Ed in Lb){var Nc=Lb[Ed];Array.contains(Ra,Nc)||Array.add(Ra,Nc)}return Ra}c2c(Ra,Lb,Nc,Ed,Wd,$d){const se=new rd.a(ve.a.TIk),Fa=this.XKf();se.Values=this.Y2g(Ra,Lb,Nc,Ed,Wd,$d,Fa);this.d_e=se;Ra=this.c0c(Fa);v.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Lb);this.VNk(Fa);return Ra}x0c(){return!0}PDc(){var Ra;
this.n3&&(null===(Ra=bb.AFrameworkApplication.ra.businessBar)||void 0===Ra?void 0:Ra.removeEntry(this.n3))}VNk(Ra){if(!this.n3){this.n3=new wb.a(Object(Le.a)("WAC_OAuth_CompleteSignIn_Title"),Object(Le.a)("WAC_OAuth_CompleteSignIn_Body"),null);this.n3.id=16;this.n3.FXd=!1;this.n3.msd=0;this.n3.closeable=!0;var Lb=!1;this.n3.EX=()=>{if(!Lb){const Nc=this.Vda[Ra];if(Nc){const Ed=new hd.a;Ed.ErrorCode="UserCancelled";Ed.ErrorMessage="The interactive flow was cancelled by the user";Nc.reject(Ed)}}};this.n3.addButton(Object(Le.a)("WAC_OAuth_CompleteSignIn_Button"),
()=>{v.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");Lb=!0;this.tF.hBa(this.d_e,this.oD.contentWindow,this.B3);this.n3=void 0},Object(Le.a)("WAC_OAuth_CompleteSignIn_Button"),!0);if(!bb.AFrameworkApplication.ra.$g.ulc(this.n3)){v.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user.");this.n3=void 0;const Nc=this.Vda[Ra];if(Nc){const Ed=new hd.a;Ed.ErrorCode="Cookies Disabled";Ed.ErrorMessage="Interaction Required - Current App Context does not support Business Bar";
Nc.reject(Ed)}}}}h3g(Ra){this.ZSa&&this.ZSa.correlationId===Ra&&(this.ZSa.resolve(null),this.ZSa=null)}}Object(u.a)(Se,"SharedAuthTokenStrategy",null,[781]);class Ve{constructor(Ra){this.Yhd=Ra;this.idb="UnsupportedAuthTokenStrategy Reason="+Qb[this.Yhd]}initialize(){return Promise.resolve(0)}nLc(){return Promise.resolve(0)}hE(){return Promise.resolve(Object.assign(new hd.a,{IsSuccess:!1,ErrorCode:Qb[this.Yhd],ErrorMessage:"Unable to get a token. Reason: ["+Qb[this.Yhd]+"]"}))}c2c(){return Promise.resolve(Object.assign(new hd.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}PDc(){}x0c(){return!1}sSb(){return this.idb}}Object(u.a)(Ve,"UnsupportedAuthTokenStrategy",null,[781]);var rf=a(928),sb=a(357);class lc{constructor(Ra){Ra=void 0===Ra?null:Ra;this.zQ=0;this.wT=null;this.Jrh=0;this.xPe=!!window.location.search.match(RegExp("wdpa=1","gi"));const Lb=$c.a.Ej();var Nc=new hd.a;Nc.ErrorCode=lc.L5c;this.qid=Promise.resolve(Nc);
const Ed=new zc;Ed.startTime=$c.a.Ej();Nc=new Promise((Wd,$d)=>{Ed.resolve=Wd;Ed.reject=$d});Ed.poc=Nc;this.eVe=Ed;this.bnh=this.rei(Ra).then(Wd=>Wd?this.D$i():(v.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.pB(),Math.floor($c.a.Ej()-Lb)),Wd=Ud.a.sy(),void 0!==Wd&&null!==Wd&&(Wd.set("AuthLibrary",this.pB()),Wd=Object.assign({},{durationMs:Math.floor($c.a.Ej()-Lb),extendedProperties:Wd}),cd.Health.instance.recordKpiFailure(qe.Cw,
"StrategyPickFailed",!1,!0,Wd)),Promise.resolve(1))).then(Wd=>0!==Wd?Promise.resolve(Wd):this.jxj())}sei(){if(this.xPe)this.zQ=5,this.wT=new Ve(this.zQ);else{var Ra=kd.a.MGj;Ra&&0<Ra.length?(this.zQ=1,this.wT=new Ga(Ra)):bb.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||bb.AFrameworkApplication.fa.ka("IsO365CommercialHost")?bb.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.zQ=2,this.wT=new Ve(this.zQ)):(Ra=Ub.a.getAuthContext().loginHint)&&Ra.length?kd.a.MTb?(this.zQ=1,this.wT=new wa):(this.zQ=
1,this.wT=new Se):(this.zQ=3,this.wT=new Ve(this.zQ)):(this.zQ=4,this.wT=new Ve(this.zQ))}}pB(){return this.wT?this.wT.sSb()||"Unknown":"None"}rei(Ra){Ra=void 0===Ra?null:Ra;v.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Lb=$c.a.Ej();return bb.AFrameworkApplication.fa.ILd().then(Nc=>{Nc?(this.sei(),Ra&&(this.wT=Ra),v.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",kd.a.clientVersion,
kd.a.appVersion,kd.a.rhi,this.pB(),Math.floor($c.a.Ej()-Lb))):v.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor($c.a.Ej()-Lb));return Promise.resolve(Nc)},()=>{v.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor($c.a.Ej()-Lb));return Promise.resolve(!1)})}D$i(){v.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.pB());const Ra=$c.a.Ej();return yc.get(this.wT.initialize(),2,kd.a.See).then(Lb=>{if(0===Lb)v.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.pB(),Math.floor($c.a.Ej()-Ra));else if(1===Lb){v.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.pB(),Math.floor($c.a.Ej()-Ra));var Nc=Ud.a.sy();void 0!==Nc&&null!==Nc&&(Nc.set("AuthLibrary",this.pB()),Nc=Object.assign({},
{durationMs:Math.floor($c.a.Ej()-Ra),extendedProperties:Nc}),cd.Health.instance.recordKpiFailure(qe.Cw,"StrategyInitFailed",!1,!0,Nc))}else 2===Lb&&(v.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.pB(),Math.floor($c.a.Ej()-Ra)),Nc=Ud.a.sy(),void 0!==Nc&&null!==Nc&&(Nc.set("AuthLibrary",this.pB()),Nc=Object.assign({},{durationMs:Math.floor($c.a.Ej()-Ra),extendedProperties:Nc}),cd.Health.instance.recordKpiFailure(qe.Cw,
"StrategyInitTimedOut",!1,!0,Nc)));return Promise.resolve(Lb)},()=>{v.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pB(),Math.floor($c.a.Ej()-Ra));return Promise.resolve(1)})}jxj(){v.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.pB());const Ra=$c.a.Ej();return yc.get(this.wT.nLc(Ub.a.getAuthContext()),2,kd.a.See).then(Lb=>{if(0===Lb)v.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.pB(),
Math.floor($c.a.Ej()-Ra));else if(1===Lb){v.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pB(),Math.floor($c.a.Ej()-Ra));var Nc=Ud.a.sy();void 0!==Nc&&null!==Nc&&(Nc.set("AuthLibrary",this.pB()),Nc=Object.assign({},{durationMs:Math.floor($c.a.Ej()-Ra),extendedProperties:Nc}),cd.Health.instance.recordKpiFailure(qe.Cw,"StrategyLoadFailed",!1,!0,Nc))}else 2===Lb&&(v.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.pB(),Math.floor($c.a.Ej()-Ra)),Nc=Ud.a.sy(),void 0!==Nc&&null!==Nc&&(Nc.set("AuthLibrary",this.pB()),Nc=Object.assign({},{durationMs:Math.floor($c.a.Ej()-Ra),extendedProperties:Nc}),cd.Health.instance.recordKpiFailure(qe.Cw,"StrategyLoadTimedOut",!1,!0,Nc)));return Promise.resolve(Lb)},()=>{v.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.pB(),Math.floor($c.a.Ej()-Ra));return Promise.resolve(1)})}hE(Ra,Lb,Nc,Ed){return this.CQa(Ra,
Lb,!1,Ed,"",void 0===Nc?null:Nc)}a2c(Ra,Lb,Nc,Ed,Wd){return this.CQa(Ra,Lb,!0,Nc,Ed,void 0===Wd?null:Wd)}CQa(Ra,Lb,Nc,Ed,Wd,$d,se,Fa){se=void 0===se?0:se;Fa=void 0===Fa?0:Fa;se+=1;v.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Ra,this.d7a(Ra,Lb),this.pB(),se);var lb=Ud.a.sy();void 0!==lb&&null!==lb&&(lb.set("AuthLibrary",this.pB()),lb.set("AppName",Ra),lb.set("Target",this.d7a(Ra,Lb)),cd.Health.instance.recordKpiUsage(qe.Cw,
sb.b.FailureBased,"WacOAuthFC",lb));if(!kd.a.isEnabled||this.xPe){var d;return this.J2d((d=new hd.a,d.IsSuccess=!1,d.Token=null,d.ErrorCode="NotEnabled",d.ErrorMessage="OAuthManager is disabled.",d),Ra)}const H=kd.a.Aqd[Ra];if(void 0===H||null===H){v.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Ra);var ha;return this.J2d((ha=new hd.a,ha.IsSuccess=!1,ha.Token=null,ha.ErrorCode="DisallowedApp",ha.ErrorMessage=
"Disallowed appName: "+Ra,ha),Ra)}const Ta=$c.a.Ej();let Mb=Ta;const W=this;lb=this.bnh.then(ta=>{Mb=$c.a.Ej();return W.Qfj(Ra,H,Lb,1==se?!1:Nc,Ed,Wd,$d,ta)});d=Nc?0:kd.a.See;let eb;ha=(eb=new hd.a,eb.IsSuccess=!1,eb.Token=null,eb.ErrorCode="authTokenStrategy_timeout",eb.ErrorMessage="Auth Strategy timed out after ["+d+"] ms when fetching token",eb);const Ib=this,nc=this;return yc.get(lb,ha,d).then(ta=>{if(se<=lc.mFj&&(ta.ErrorCode===lc.lFe||ta.ErrorCode===lc.eLh))return v.ULS.sendTraceTag(573175516,
3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",se,Math.floor($c.a.Ej()-Ta)),Ib.CQa(Ra,Lb,Nc,Ed,Wd,$d,se,Fa|4);if(ta.ErrorCode===lc.j6c||ta.ErrorCode===lc.Xbc){v.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken failed with ITP error.  Fallback Flow Enabled: [{0}], Popup Requested [{1}]",lc.dtf,Nc);if(Nc)return Ib.CQa(Ra,Lb,!0,Ed,Wd,$d,se,Fa|32);if(lc.Qej(H))return this.qid=this.qid.then(ob=>{if(ob.IsSuccess)return Ib.CQa(Ra,Lb,Nc,Ed,Wd,$d,se,Fa|8);if(ob.ErrorCode===lc.L5c||ob.ErrorCode===
lc.j6c)return Ib.zWf(Ra,H,Lb,Nc,Ed,Wd,$d,Ta,Mb,Fa|16).then(cc=>cc.ErrorCode===lc.Xbc?Ib.CQa(Ra,Lb,!0,Ed,Wd,$d,se,Fa|32):cc);if(ob.ErrorCode===lc.Xbc)return Ib.CQa(Ra,Lb,!0,Ed,Wd,$d,se,Fa|32);if(ob.ErrorCode===lc.qFe)return ob}).catch(()=>Ib.zWf(Ra,H,Lb,Nc,Ed,Wd,$d,Ta,Mb,Fa))}return Promise.resolve(Ib.ILc(ta,Ra,Lb,H,Ta,Mb,Fa,se))}).catch(()=>{let ta;const ob=(ta=new hd.a,ta.IsSuccess=!1,ta.Token=null,ta.ErrorCode="authTokenStrategy_failure",ta.ErrorMessage="Auth Strategy failed with an unknown error",
ta);return Promise.resolve(nc.ILc(ob,Ra,Lb,H,Ta,Mb,Fa,se))})}zWf(Ra,Lb,Nc,Ed,Wd,$d,se,Fa,lb,d){const H=new hd.a;H.IsSuccess=!1;if(!this.wT.x0c())return H.ErrorCode="authTokenStrategy_loginNotSupported",H.ErrorMessage="This Token Strategy does not support login flow, TryLogin could not be completed",Promise.resolve(H);const ha=this.wT.c2c(Ra,Lb,Nc,Ed,Wd,$d).then(Mb=>Promise.resolve(this.ENc(Mb,!0,Ra))).catch(Mb=>Promise.resolve(this.ENc(Mb,!1,Ra))).then(Mb=>{d|=16;return Promise.resolve(this.ILc(Mb,
Ra,Nc,Lb,Fa,lb,d))}).catch(()=>{H.ErrorCode="authTokenStrategy_failure";H.ErrorMessage="LoginPopup failed, GetToken could not be called";d|=16;return Promise.resolve(this.ILc(H,Ra,Nc,Lb,Fa,lb,d))}),Ta=this.eVe.poc.then(()=>this.CQa(Ra,Nc,Ed,Wd,$d,se,0,d|8));return Promise.race([Ta,ha])}Qfj(Ra,Lb,Nc,Ed,Wd,$d,se,Fa){return 1===Fa||2===Fa?this.J2d(Object.assign(new hd.a,{IsSuccess:!1,Token:null,ErrorCode:1===Fa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Ra):this.wT.hE(Ra,
Lb,Nc,Ed,Wd,$d,se).then(lb=>{if(Ed){const d=new hd.a;d.IsSuccess=!0;this.wT.PDc();this.eVe.resolve(d)}return Promise.resolve(this.ENc(lb,!0,Ra))}).catch(lb=>Promise.resolve(this.ENc(lb,!1,Ra)))}ILc(Ra,Lb,Nc,Ed,Wd,$d,se,Fa){se=void 0===se?0:se;Fa=void 0===Fa?0:Fa;var lb;const d={},H=$c.a.Ej()-$d;d.IsSuccess=Ra.IsSuccess;d.ErrorCode=Ra.IsSuccess?"Success":Ra.ErrorCode||"";d.ErrorMessage=Ra.IsSuccess?"Success":this.d7a(Lb,Ra.ErrorMessage||"");d.Target=this.d7a(Lb,Nc||"");d.TimeInMS=Math.floor(H);d.LoadTimeInMS=
Math.floor($d-Wd);d.AuthLibrary=this.pB();d.AppName=Lb;d.AuthorityType=Object(Of.a)(Ic,Ub.a.pzc());d.UserType=this.XZi(Ub.a.getAuthContext());d.IsAuthSupportedInSession=Qb[this.zQ];d.RequestCount=++this.Jrh;d.AppId=Ed;d.RetryCount=Fa;Ra.IsSuccess&&(se=(null===(lb=Ra.Telemetry)||void 0===lb?0:lb.fromCache)?se|1:se|2);d.Type=se;v.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(d));Nc=Ud.a.sy();Ra.IsSuccess?void 0!==Nc&&null!==Nc&&(Nc.set("AppName",Lb),Nc.set("AuthLibrary",this.pB()),Nc.set("RetryCount",
Fa.toString()),Nc.set("Type",se.toString()),Lb=Object.assign({},{durationMs:H,extendedProperties:Nc}),cd.Health.instance.recordKpiSuccess(qe.Cw,Lb)):void 0!==Nc&&null!==Nc&&(Nc.set("AppName",Lb),Nc.set("AuthLibrary",this.pB()),Nc.set("ErrorCode",Ra.ErrorCode),Nc.set("ErrorMessage",this.d7a(Lb,Ra.ErrorMessage)),Nc.set("Type",se.toString()),Lb=Object.assign({},{durationMs:H,extendedProperties:Nc}),cd.Health.instance.recordKpiFailure(qe.Cw,"TryGetTokenFailure",!1,!0,Lb));return Ra}J2d(Ra,Lb){v.ULS.sendTraceTag(578435090,
3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Lb,this.d7a(Lb,Ra.ErrorMessage));const Nc=Ud.a.sy();void 0!==Nc&&null!==Nc&&(Nc.set("AppName",Lb),Nc.set("AuthLibrary",this.pB()),Nc.set("ErrorCode",Ra.ErrorCode),Nc.set("ErrorMessage",this.d7a(Lb,Ra.ErrorMessage)),Lb=Object.assign({},{extendedProperties:Nc}),cd.Health.instance.recordKpiFailure(qe.Cw,"FailureBeforeGetToken",!1,!0,Lb));return Promise.resolve(Ra)}KZf(Ra){return Ra===rf.a.tyb}d7a(Ra,Lb){return this.KZf(Ra)&&
Lb?"REDACTED":Lb}XZi(Ra){return bb.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!Ra.loginHint||1>Ra.loginHint.length?"empty":-1<Ra.loginHint.indexOf("guest#")?"guest":-1<Ra.loginHint.indexOf("ext#")?"external":0>Ra.upn.indexOf("@")?"no-at":"supported"}F0a(){return 1===this.zQ}ENc(Ra,Lb,Nc){let Ed=null,Wd=null,$d=null,se=null;Ra?Ra.ErrorCode||Ra.ErrorMessage?(Wd=Ra.ErrorCode?Ra.ErrorCode:lc.z5c,$d=Ra.ErrorMessage?Ra.ErrorMessage:"No message"):Ra.errorCode||Ra.errorMessage?(Wd=Ra.errorCode?
Ra.errorCode:lc.z5c,$d=Ra.errorMessage?Ra.errorMessage:"No message"):Ra.Token?Lb?Ed=Ra.Token:(Wd=lc.feh,$d="A rejected promise returned a token."):(Wd=lc.z5c,$d=JSON.stringify(Ra)):(Wd=lc.L5c,$d="No result came from Auth Token Strategy");Ra&&Ra.Telemetry&&!this.KZf(Nc)&&(se=Ra.Telemetry,v.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(se)));if(Wd===lc.aLh||Wd===lc.cLh)Wd=lc.lFe,$d="Auth Library Timed Out";Wd===lc.ZKh&&(Wd=lc.j6c);if(Wd===lc.bLh||Wd===lc.YKh||Wd===lc.$Kh)Wd=lc.Xbc;Wd===lc.dLh&&(Wd=
lc.qFe);if(Wd||$d)Ed=null;return Object.assign(new hd.a,{IsSuccess:!!Ed,Token:Ed,ErrorCode:Wd,ErrorMessage:$d,Telemetry:se})}static Qej(Ra){return lc.dtf&&"243c63a3-247d-41c5-9d83-7788c43f1c43"===Ra}static get dtf(){return bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}}lc.cLh="token_renewal_error";lc.aLh="monitor_window_timeout";lc.ZKh="login_required";lc.bLh="popup_window_error";lc.YKh="consent_required";lc.$Kh="invalid_grant";
lc.dLh="user_cancelled";lc.eLh="authTokenStrategy_timeout";lc.lFe="Timeout";lc.j6c="Cookies Disabled";lc.Xbc="UserInteractionRequired";lc.z5c="Exception";lc.L5c="NoResult";lc.feh="RejectToken";lc.qFe="UserCancelled";lc.mFj=2;Object(u.a)(lc,"OAuthManager",null,[741]);var Uc=a(282),od=a(79),sd=a(92),be=a(106);class Ee{P3k(Ra){if(Ra&&bb.AFrameworkApplication.fa&&bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacTokenValidation",!1)){Ra=Ra.startsWith("Bearer ")?Ra:"Bearer "+
Ra;var Lb=kd.a.sXa.Endpoint;if(Lb){var Nc=$c.a.Ej();Ra={["Authorization"]:Ra};var Ed=new be.a;Ed.add("IsSpoWacToken","1");Lb=od.a.S2e(Lb,Ed);bb.AFrameworkApplication.sj.VUa(Lb,1,null,Ra,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Wd=>{var $d=Math.floor($c.a.Ej()-Nc),se=null;Wd.mo?Wd="Canceled":Wd.Fm?Wd="Faulted":(se=Wd.result,Wd=se.succeeded?"Completed":"Failed");$d={["TaskResult"]:Wd,["BrowserValidationDurationMS"]:$d};se&&($d.HttpStatus=se.wo.data.httpStatus,se.succeeded&&
(se=qf.a(se.wo.data.responseData),$d.ServerValidationDurationMS=se.ElapsedMilliseconds,$d.ServerValidationResult=se.ValidatedToken,$d.KMSI=se.KMSI,$d.Scopes=se.Scopes,$d.TokenExpiration=Math.floor(parseInt(se.Expiration)-(new Date).getTime()/1E3)));v.ULS.sendTraceTag(507639839,3E3,"Completed"===Wd?20:15,sd.a.toJSON($d))})}}}}Object(u.a)(Ee,"WacTokenValidator",null,[742]);class Ie{zgk(Ra,Lb){let Nc=Ie.oEe;Lb&&(Nc=1E3*Lb-Date.now()-Ie.oEe);v.ULS.sendTraceTag(507524500,3E3,50,"Core Token Refresh: Scheduling Refresh in {0} ms",
Nc);setTimeout(()=>{this.DFf(Ra)},Nc)}DFf(Ra){return Ra.hE("Core",Ie.LDe).then(Lb=>{var Nc,Ed;const Wd=Lb.IsSuccess,$d=null===(Nc=Lb.Telemetry)||void 0===Nc?void 0:Nc.expiresOn;Nc=!1;if(Lb.IsSuccess){const se="Bearer "+Lb.Token;Nc=bb.AFrameworkApplication.sj.eda!==se;bb.AFrameworkApplication.sj.eda=se}v.ULS.sendTraceTag(507524499,3E3,50,"Core Token Fetch: Success={0}, ExpirationTime={1}, FetchedNewToken={2}",Wd,$d,Nc);this.zgk(Ra,null===(Ed=Lb.Telemetry)||void 0===Ed?void 0:Ed.expiresOn);return Lb})}get name(){return"Common.App.OAuth.OAuthPackage"}$n(Ra){Ra.register(741,
"Common.App.OAuth.IOAuthManager").yi().Ei(()=>new lc);Ra.register(742,"Common.App.OAuth.IWacTokenValidator").yi().Ei(()=>new Ee)}init(){const Ra=Object(Cc.a)();Da.a.instance.resolve("Common.App.OAuth.IWacTokenValidator");this.M3k(Ra);this.L3k(Ra)}L3k(Ra){if(bb.AFrameworkApplication.fa&&bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Lb=bb.AFrameworkApplication.fa.Za("FileSource");if(bb.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||
bb.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===Lb){var Nc=kd.a.sXa;if(Nc&&Nc.IsEnabled){var Ed=Nc.Application,Wd=kd.a.authority;if(void 0!==Ed&&null!==Ed&&Ed.length&&void 0!==Wd&&null!==Wd&&Wd.length){var $d=Qb[Ra.zQ],se=w.a.g$,Fa=Ra.pB();Wd=JSON.stringify({kkl:{["xms_cc"]:{values:["cp1"]}}});var lb=$c.a.Ej();Ra.hE("CAETest",Ed,null,Wd).then(d=>{const H=Math.floor($c.a.Ej()-lb);$d=Qb[Ra.zQ];se=w.a.g$;Fa=Ra.pB();v.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
H,d.IsSuccess,$d,d.ErrorCode,Lb,se,Fa);if(d.IsSuccess){d="Bearer "+d.Token;var ha=Nc.Endpoint;if(ha){var Ta=$c.a.Ej();d={["Authorization"]:d};var Mb=new be.a;Mb.add("EnforceCAE","1");Mb.add("IsCAEToken","1");ha=od.a.S2e(ha,Mb);bb.AFrameworkApplication.sj.VUa(ha,1,null,d,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(W=>{var eb,Ib=Math.floor($c.a.Ej()-Ta),nc=null;W.mo?W="Canceled":W.Fm?W="Faulted":(nc=W.result,W=nc.succeeded?"Completed":"Failed");Ib={["TaskResult"]:W,["BrowserTokenDurationMS"]:H,
["BrowserValidationDurationMS"]:Ib};nc&&(Ib.HttpStatus=nc.wo.data.httpStatus,nc.succeeded&&(nc=qf.a(nc.wo.data.responseData),Ib.ServerValidationDurationMS=nc.ElapsedMilliseconds,Ib.ServerValidationResult=nc.ValidatedToken,Ib.KMSI=nc.KMSI,Ib.Scopes=nc.Scopes,Ib.TokenExpirationS=Math.floor(parseInt(nc.Expiration)-(new Date).getTime()/1E3),Ib.ClaimChallenge=null===(eb=nc.ClaimChallenge)||void 0===eb?void 0:eb.length));v.ULS.sendTraceTag(508950354,3E3,"Completed"===W?50:15,sd.a.toJSON(Ib))})}}else v.ULS.sendTraceTag(508950353,
3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",d.ErrorCode,d.ErrorMessage)}).catch(d=>{const H=Math.floor($c.a.Ej()-lb);v.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",d.toString(),H)})}}}}}M3k(Ra){const Lb=bb.AFrameworkApplication.fa.Za("FileSource");if(bb.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||bb.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===Lb){var Nc=kd.a.sXa;if(Nc&&Nc.IsEnabled){var Ed=Nc.Application,Wd=kd.a.authority;
if(void 0!==Ed&&null!==Ed&&Ed.length&&void 0!==Wd&&null!==Wd&&Wd.length){Ie.LDe=Ed;var $d=Qb[Ra.zQ],se=w.a.g$,Fa=Ra.pB();try{var lb=new Map;void 0!==lb&&null!==lb?(lb.set("SupportStatus",$d),lb.set("Browser",se),lb.set("AuthStrategy",Fa)):lb=null}catch(H){lb=null}cd.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",lb);var d=$c.a.Ej();(bb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthCorePFTRefreshEnabled",!0)?this.DFf(Ra):Ra.hE("Core",Ed)).then(H=>
{const ha=Math.floor($c.a.Ej()-d);$d=Qb[Ra.zQ];se=w.a.g$;Fa=Ra.pB();v.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',ha,H.IsSuccess,$d,H.ErrorCode,Lb,se,Fa);lb&&(lb.set("SupportStatus",$d),lb.set("Browser",se),lb.set("AuthStrategy",Fa));var Ta=Object.assign({},{durationMs:ha,extendedProperties:lb});if(H.IsSuccess){if(cd.Health.instance.recordKpiSuccess("WacCorePFT",
Ta),H="Bearer "+H.Token,bb.AFrameworkApplication.sj.eda=H,Ta=Nc.Endpoint){var Mb=$c.a.Ej();bb.AFrameworkApplication.sj.VUa(Ta,1,null,{["Authorization"]:H},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(W=>{var eb=Math.floor($c.a.Ej()-Mb),Ib=null;W.mo?W="Canceled":W.Fm?W="Faulted":(Ib=W.result,W=Ib.succeeded?"Completed":"Failed");eb={["TaskResult"]:W,["BrowserTokenDurationMS"]:ha,["BrowserValidationDurationMS"]:eb};Ib&&(eb.HttpStatus=Ib.wo.data.httpStatus,Ib.succeeded&&(Ib=qf.a(Ib.wo.data.responseData),
eb.ServerValidationDurationMS=Ib.ElapsedMilliseconds,eb.ServerValidationResult=Ib.ValidatedToken,eb.KMSI=Ib.KMSI,eb.Scopes=Ib.Scopes,eb.TokenExpirationS=Math.floor(parseInt(Ib.Expiration)-(new Date).getTime()/1E3)));v.ULS.sendTraceTag(520632322,3E3,"Completed"===W?50:15,sd.a.toJSON(eb))})}}else cd.Health.instance.recordKpiFailure("WacCorePFT",H.ErrorCode,!1,!1,Ta)}).catch(H=>{var ha=Math.floor($c.a.Ej()-d);ha=Object.assign({},{durationMs:ha,extendedProperties:lb});cd.Health.instance.recordKpiFailure("WacCorePFT",
"UNEXPECTED CATCH: "+H.toString(),!1,!1,ha)})}}}}dispose(){}static main(){Uc.a.instance.Do(new Ie)}}Ie.LDe="";Ie.oEe=3E5;Object(u.a)(Ie,"OAuthPackage",null,[12,13]);var bf=a(9),Xe=a(220),Ze=a(248),tf=a(433),ff=a(916),ef=a(1265);class Sf{constructor(Ra){this.Hm=()=>{this.t7f(Db.a.RFa("excel-uiSlice20-sprite"));E.EwaSettings.vl()||this.$.ea.yv(this.Hm)};this.$=Ra;this.RZg={};this.Uve={};const Lb=this.RHf("excelInitialAppSprite");Lb?(this.r3e(Lb),this.$.ea.lm?this.t7f(Db.a.RFa("excel-uiSlice20-sprite")):
E.EwaSettings.vl()?Ra.ea.Yq(this.Hm):Ra.ea.jr(this.Hm),this.$.la.Hh(388,this)):v.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.Uve=null;E.EwaSettings.vl()||this.$.ea.yv(this.Hm)}m_a(Ra,Lb,Nc,Ed){Nc=void 0===Nc?null:Nc;Ed=void 0===Ed?null:Ed;let Wd;(Wd=this.Uve[Ra])||(this.Uve[Ra]=Wd=this.F4j(this.RZg[Ra]));if(!Wd)return v.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${Ra} was not found in loaded SVG sprites.`),null;const $d=
Wd.cloneNode(!0);if(!$d.style){const se=tf.b(Wd),Fa=tf.b($d),lb={};lb.iconId=Ra;lb.isOriginalNodeStyleNull=void 0===Wd.style||null===Wd.style;lb.isOriginalNodeCurrentStyleNull=void 0===Wd.currentStyle||null===Wd.currentStyle;lb.isClonedNodeCurrentStyleNull=void 0===$d.currentStyle||null===$d.currentStyle;lb.originalNode=se.substring(0,se.indexOf(">")+1);lb.clonedNode=Fa.substring(0,Fa.indexOf(">")+1);v.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(lb)}`)}$d.setAttribute("style",
`height: ${Lb}px; width: ${Lb}px;`);Ed&&(Ra=document.createElement("title"),Ra.textContent=Ed,$d.insertBefore(Ra,$d.childNodes[0]));if(Nc)for(const se of Nc)E.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?$d.classList.add(se):Sys.UI.DomElement.addCssClass($d,se);return $d}Mna(Ra,Lb,Nc,Ed,Wd,$d,se,Fa){Wd=void 0===Wd?0:Wd;$d=void 0===$d?0:$d;se=void 0===se?null:se;Fa=void 0===Fa?null:Fa;Wd&&$d||($d=Je.DOMElementExtensions.getBoundingClientRect(Ed),Wd=$d.height,$d=$d.width);if(se=
this.m_a(Ra,Lb,se,Fa))Ed.appendChild(se),(Ed=Je.DOMElementExtensions.hga(se,"style",null))?se.setAttribute("style",Ed+` margin: ${(Wd-Lb)/2}px ${($d-Nc)/2}px;`):v.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${Ra}`);return se}t7f(Ra){void Object(ff.a)(Ra,{va:0}).then(()=>this.kAh())}kAh(){const Ra=this.RHf("excelUiSlice20Sprite");Ra?this.r3e(Ra):v.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}r3e(Ra){for(const Lb of Ra)Lb.type===
Ze.a.Sve&&(this.RZg[Lb.id]=Lb)}F4j(Ra){if(!Ra)return null;const Lb=Ra.viewBox;Ra=Ra.children;const Nc=document.createElementNS(Xe.a.XBa,Ze.a.Sve);E.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?Nc.classList.add("ewa-svg-icon"):Sys.UI.DomElement.addCssClass(Nc,"ewa-svg-icon");Nc.setAttribute("focusable","false");Nc.setAttribute("viewBox",Lb);this.lAh(Nc,Ra);return Nc}lAh(Ra,Lb){for(const Ed of Lb){const Wd=document.createElementNS(Xe.a.XBa,Ed.type);for(const $d in Ed){Lb=$d;
var Nc=Ed[$d];"className"===Lb?Wd.setAttribute("class",Nc):Wd.setAttribute(Lb,Nc)}Ra.appendChild(Wd)}}RHf(Ra){return(Ra=window[Ra])?Ra.icons:null}}Object(u.a)(Sf,"SvgIconProvider",null,[263,2]);String(ef);window.___1710439900813_closurehack=ef;class zf extends uc.a{constructor(Ra){super();this.$=Ra;this.gm()}create(){const Ra=[this.rxj()];B.TaskExtensions.Xa(B.TaskExtensions.Wo(Ra,this.$.ya),()=>{window.excelInitialAppSprite?this.Bk(this.$.la.lh(388)||new Sf(this.$)):v.ULS.sendTraceTag(537151258,
0,50,"window.[excelInitialAppSprite] returned null.")},this.ya,3)}rxj(){let Ra=Xa.a.GIb;bb.AFrameworkApplication.fa.ka("IsStringExperimentEnabled")&&(Ra=Xa.a.onc);Ra=Db.a.RFa(Ra);return Object(ac.d)(Object(ff.a)(Ra,{va:this.xh}))}static Ba(Ra){Ra.la.Hh(387,new zf(Ra))}}Object(u.a)(zf,"SvgIconProviderFactory",uc.a,[]);var sf=a(914);class lf extends sf.a{constructor(Ra){super(Ra)}Gt(){void U.a.resolve(K.gf,{va:this.xh}).then(()=>{B.TaskExtensions.Xa(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)?Object(ac.d)(U.a.resolve(K.Yf,{va:this.xh})):Ec.GetServiceTaskFactory.Tj(this.$.la,32,33,this.xh),Ra=>{this.Qr([new fc(Ra.result)])},this.$.ya)})}static Ba(Ra){sf.a.my(392,new lf(Ra))}}Object(u.a)(lf,"SheetDropdownMenuCommandHandlerFactory",sf.a,[]);Type.registerNamespace("Common.App.OAuth");Ie.main();E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1265);bf.a.gh(zf.Ba);(()=>{bf.a.gh(Ra=>{a(1456);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||Yb.Ba(Ra);K.Rf.Aa()||lf.Ba(Ra)})})();String(c);String(b);String(h);String(r);String(e);String(k);String(m);String(x);window.___1710439927751_closurehack=c;window.___1710439927751_closurehack=b;window.___1710439927751_closurehack=h;window.___1710439927751_closurehack=r;window.___1710439927751_closurehack=e;window.___1710439927751_closurehack=k;window.___1710439927751_closurehack=m;window.___1710439927751_closurehack=x}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/508412830cd5fbe595a00fa2e4effac9/EwaTS.vrs.js.map